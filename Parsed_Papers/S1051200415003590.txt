@&#MAIN-TITLE@&#Essential secret image sharing scheme with the same size of shadows

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           An essential secret image sharing scheme is proposed based on derivative polynomial.


                        
                        
                           
                           The essential shadows are more important than non-essential shadows.


                        
                        
                           
                           All shadows have the same size.


                        
                        
                           
                           No concatenation operation is needed in generation of shadows.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Secret image sharing

Threshold secret sharing

Essential shadow

Derivative polynomial

Birkhoff interpolation

@&#ABSTRACT@&#


               
               
                  Secret image sharing is a method to decompose a secret image into shadow images (shadows) so that only qualified subset of shadows can be used to reconstruct the secret image. Usually all shadows have the same importance. Recently, an essential SIS (ESIS) scheme with different importance of shadows was proposed. All shadows are divided into two group: essential shadows and non-essential shadows. In reconstruction, the involved shadows should contain at least a required number of shadows, including at least a required number of essential shadows. However, there are two problems in previous ESIS scheme: unequal size of shadows and concatenation of sub-shadow images. These two problems may lead to security vulnerability and complicate the reconstruction. In this paper, we propose a novel ESIS scheme based on derivative polynomial and Birkhoff interpolation. A single shadow with the same-size is generated for each essential and non-essential participant. The experimental results demonstrate that our scheme can avoid above two problems effectively.
               
            

@&#INTRODUCTION@&#

Secret image sharing (SIS) is a technique for image protection using mechanism of secret sharing [1–3]. It encrypts a secret image into multiple shadows and then distributes them to the corresponding participants. In the revealing process, only qualified subsets of participants can cooperate to reveal the secret image with their shadows. Usually, SIS scheme is implemented as a threshold 
                        (
                        k
                        ,
                        n
                        )
                     -SIS scheme, where 
                        k
                        ≤
                        n
                     , that divides a secret image into n shadows. Any k shadows can be used for reconstructing the secret image, while any 
                        (
                        k
                        −
                        1
                        )
                      or fewer shadows cannot obtain any secret information. Image steganography can also protect secret information from unauthorized parties. However, the secret information cannot be recovered when the stego-image is modified or lost. SIS can avoid this problem when the shadows are transmitted by different channels [4,5]. In 1979, Shamir [1] proposed a novel 
                        (
                        k
                        ,
                        n
                        )
                      secret sharing scheme to hide a secret data in the constant term of a 
                        (
                        k
                        −
                        1
                        )
                     -degree polynomial. Thien and Lin [2] extended Shamir's work and first proposed a 
                        (
                        k
                        ,
                        n
                        )
                     -SIS scheme by embedding secret pixels into all coefficients of a 
                        (
                        k
                        −
                        1
                        )
                     -degree polynomial. The shadow size of Thien and Lin's 
                        (
                        k
                        ,
                        n
                        )
                     -SIS scheme is 
                        1
                        /
                        k
                      times of the secret image. In [3], the shadow size was further reduced by using Huffman code.

SIS schemes have been exploited in many applications as a means to protect secret image, and various SIS schemes with specific functions are introduced subsequently. For example, shadows in [2,3] are noise-like and suspected to censorships. Various 
                        (
                        k
                        ,
                        n
                        )
                     -SIS schemes were proposed by using steganography and shadows reveal meaningful images [6–10]. By adding the detection of the modification of shadows, this scheme is called as a steganographic and authenticated image sharing (SAIS) scheme. SIS schemes and SAIS schemes have the threshold property that recovers either the entire image or nothing. Researchers introduced scalable SIS (SSIS) schemes [11–15], which provide progressive decoding. In SSIS scheme, the information amount of reconstructed image is proportional to the number of shadows involved in reconstruction. Additionally, another kind of SIS scheme with two decoding options was proposed [16–19]. This two-in-one SIS (TiOSIS) scheme combines SIS scheme and visual cryptographic scheme (VCS) [20]. In TiOSIS scheme, a vague secret image can be revealed by stacking shadows, while the original grayscale secret image can be decoded by computation.

All above schemes consider each participant has the same importance in reconstruction. However, there are many examples that some participants are accorded special privileges due to their status or importance, e.g., heads of government, managers of company, …, and etc. In fact, weighted SIS (WSIS) scheme [21–23] and essential SIS (ESIS) scheme [24–26] have different importance of shadows. WSIS scheme generates shadows with different weights according to priority of the participant. The secret image is recovered if and only if the value of total weights for the involved shadows achieves the threshold. Thus, WSIS scheme does not have the essentiality as in 
                        (
                        t
                        ,
                        s
                        ,
                        k
                        ,
                        n
                        )
                     -ESIS scheme. A 
                        (
                        t
                        ,
                        s
                        ,
                        k
                        ,
                        n
                        )
                     -ESIS scheme has s essential shadows and 
                        (
                        n
                        −
                        s
                        )
                      non-essential shadows. The so-called essentiality of 
                        (
                        t
                        ,
                        s
                        ,
                        k
                        ,
                        n
                        )
                     -ESIS scheme is that we need k shadows including at least t essential shadows for reconstruction.

In [27], Tassa proposed a hierarchical secret sharing by using derivative polynomial function and Birkhoff interpolation. Afterwards, Guo et al. [28] adopted Tassa's hierarchical secret sharing to propose a hierarchical SIS scheme. However, Guo et al.'s [28] SIS scheme embedded secret pixels into all coefficients of a polynomial. This compromises the secrecy that some non-authorized subsets of participants can recover parts of the secret image. Recently, Pakniat et al. [29] enhances Guo et al.'s scheme to propose a secure hierarchical SIS scheme. Although Pakniat et al.'s scheme also embeds secret pixels into all coefficients in polynomials, these coefficients are securely encrypted by using cellular automata and hash function. From the viewpoint of secret sharing, both Guo et al. and Pakniat et al.'s scheme use all coefficients of polynomial to embed secret pixels. Therefore, their schemes are not secure as the original Tassa's scheme.

Both WSIS scheme and ESIS scheme have the different importance of shadows, but only ESIS scheme has the essentiality. However, there are two problems in 
                        (
                        t
                        ,
                        s
                        ,
                        k
                        ,
                        n
                        )
                     -ESIS scheme: unequal size of shadows and concatenation of sub-shadows, which are ignored by the previous 
                        (
                        t
                        ,
                        s
                        ,
                        k
                        ,
                        n
                        )
                     -ESIS schemes [24,25]. If the sizes of essential shadows and non-essential shadows are different, attackers may detect the status of these shadows from their sizes. In this case, the size of shadows may leak some sensitive information. For the problem of concatenation of sub-shadows, we need not only to record the location of each sub-shadow, but also extra operation to extract each sub-shadow before revealing. In the practical use, the two problems may bring about security vulnerability and make the reconstruction more difficult. In this paper, we propose a 
                        (
                        t
                        ,
                        s
                        ,
                        k
                        ,
                        n
                        )
                     -ESIS scheme to solve the two problems based on derivative polynomial and Birkhoff interpolation. In our scheme, the secret pixels are embedded into partial coefficients of a polynomial. The remainder of this work is organized as follows. In Section 2, we review the first 
                        (
                        k
                        ,
                        n
                        )
                     -SIS scheme, Thien and Lin's [2] 
                     
                        (
                        k
                        ,
                        n
                        )
                     -SIS scheme, and two previous 
                        (
                        t
                        ,
                        s
                        ,
                        k
                        ,
                        n
                        )
                     -ESIS schemes [24,25]. Two critical problems in 
                        (
                        t
                        ,
                        s
                        ,
                        k
                        ,
                        n
                        )
                     -ESIS scheme are introduced in Section 3. In Section 4, we propose the improved 
                        (
                        t
                        ,
                        s
                        ,
                        k
                        ,
                        n
                        )
                     -ESIS with the same size of shadows. Experiment, comparison, and discussion are given in Section 5. Finally, the conclusion is provided in Section 6.

In 1979, Shamir [1] introduced a 
                           (
                           k
                           ,
                           n
                           )
                         secret sharing scheme to share a secret into n shares by using a 
                           (
                           k
                           −
                           1
                           )
                        -degree polynomial 
                           f
                           (
                           x
                           )
                           =
                           (
                           
                              
                                 a
                              
                              
                                 0
                              
                           
                           +
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           x
                           +
                           ⋯
                           +
                           
                              
                                 a
                              
                              
                                 k
                                 −
                                 1
                              
                           
                           
                              
                                 x
                              
                              
                                 k
                                 −
                                 1
                              
                           
                           )
                           
                           mod
                           
                           p
                        , in which p is a prime number and 
                           
                              
                                 a
                              
                              
                                 0
                              
                           
                         is the secret data. The dealer randomly selects this polynomial, and generates n shares 
                           (
                           i
                           ,
                           f
                           (
                           i
                           )
                           )
                        , 
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                        . Any k shares (say 
                           1
                           ,
                           2
                           ,
                           …
                        , and k) can be used to recover 
                           f
                           (
                           x
                           )
                         by Lagrange's interpolation 
                           f
                           (
                           x
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 k
                              
                           
                           f
                           (
                           i
                           )
                           
                              
                                 ∏
                              
                              
                                 j
                                 =
                                 1
                                 ,
                                 j
                                 ≠
                                 i
                              
                              
                                 k
                              
                           
                           
                              
                                 (
                                 x
                                 −
                                 j
                                 )
                              
                              
                                 (
                                 i
                                 −
                                 j
                                 )
                              
                           
                           
                           mod
                           
                           p
                        . Then, the secret is derived from 
                           
                              
                                 a
                              
                              
                                 0
                              
                           
                           =
                           f
                           (
                           0
                           )
                        . However, any 
                           k
                           −
                           1
                         or fewer shares cannot recover the polynomial 
                           f
                           (
                           x
                           )
                         and thus do not obtain any secret information.

Following Shamir's work, Thien and Lin embedded secret pixels into all k coefficients in a 
                           (
                           k
                           −
                           1
                           )
                        -degree polynomial to generate n random grayscale values of n noise-like shadows. The sharing process is briefly described as follows. A secret image is first divided into non-overlapping blocks, and every block has k pixels. Every block is then represented as a 
                           (
                           k
                           −
                           1
                           )
                        -degree polynomial 
                           f
                           (
                           x
                           )
                        . With each participant ID id, the shadow pixel is generated by 
                           f
                           (
                           
                              id
                           
                           )
                        . Since it embeds k pixels at each time, the shadow size is 
                           1
                           /
                           k
                         of the secret image. When sharing a grayscale secret image, the prime number p is often chosen as 251 (the largest prime number smaller than 255) so that the coefficients are between 0 and 250 and suitable to represent 8-bit grayscale. However, the grayscales (>250) have to be modified to 250 and has distortion in this case. Obviously, we can use Galois Field 
                           
                              GF
                           
                           (
                           
                              
                                 2
                              
                              
                                 8
                              
                           
                           )
                         instead of modulus 251 to achieve a distortion-less scheme. In previous literatures, some schemes simply adopt 
                           
                              GF
                           
                           (
                           251
                           )
                         while some schemes use 
                           
                              GF
                           
                           (
                           
                              
                                 2
                              
                              
                                 8
                              
                           
                           )
                         to obtain a distortion-less image.

In a 
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme, s out of n shadows are essential. A 
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme has not only the threshold property (i.e., k or more shadows should be involved in reconstruction) but also the essentiality property (i.e., there are at least t essential shadows in the k involved shadows). For example, k shadows including 
                           (
                           t
                           −
                           1
                           )
                         essential shadows and 
                           (
                           k
                           −
                           t
                           +
                           1
                           )
                         non-essential shadows cannot be used for reconstructing the secret. The essentiality property is not achieved in this case. Another example of k shadows including t essential shadows and 
                           (
                           k
                           −
                           t
                           )
                         non-essential shadows satisfies the conditions of the threshold and the essentiality simultaneously, and it can reconstruct the secret. The condition 
                           t
                           =
                           k
                         implies that we do not need non-essential shadows for reconstruction, and thus non-essential shadows do not have any contribution for reconstructing the secret. Regarding 
                           s
                           =
                           n
                        , all shadows are essential and the 
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme is reduced to a 
                           (
                           k
                           ,
                           n
                           )
                        -SIS scheme. For 
                           k
                           =
                           n
                        , a 
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme is also reduced to a 
                           (
                           n
                           ,
                           n
                           )
                        -SIS scheme. Therefore, for a non-trivial ESIS scheme, it is obvious that these values should satisfy 
                           t
                           ≤
                           s
                           <
                           n
                         and 
                           t
                           <
                           k
                           <
                           n
                        .

All shadows of the conventional 
                           (
                           k
                           ,
                           n
                           )
                        -SIS scheme have the same importance. In various applications of group hierarchical decision making, some participants are more important than others. For example, a group consisting of 2 monitors and 6 soldiers carries out missile launching, which is controlled by a launch password. This password is encoded into 8 noise-like shadows and distributed to 2 monitors and 6 soldiers. Because the launch of a missile is a key issue, the decision of launch requires the affirmative votes of 4 members (i.e., the threshold is 
                           k
                           =
                           4
                        ) including one monitor's agreement (i.e., 
                           t
                           =
                           1
                        ). There are total 8 members (
                           n
                           =
                           8
                        ) including 2 essential members (
                           s
                           =
                           2
                        ). Therefore, this scenario has the threshold property and the essentiality as 
                           (
                           1
                           ,
                           2
                           ,
                           4
                           ,
                           8
                           )
                        -ESIS scheme.

The threshold of reconstructing a secret image in 
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme is k, which is the same as that of the conventional 
                           (
                           k
                           ,
                           n
                           )
                        -SIS scheme. Let P be the set of all participants and Q be the set of participants involved in reconstruction, 
                           Q
                           ⊆
                           P
                        . And, let EP and NEP be the sets of essential participants and non-essential participants, respectively, where 
                           P
                           =
                           
                              EP
                           
                           ∪
                           
                              NEP
                           
                        . Participants in EP and NEP have the different importance of shadows, and the cardinalities of EP and NEP are 
                           |
                           
                              EP
                           
                           |
                           =
                           s
                         and 
                           |
                           
                              NEP
                           
                           |
                           =
                           (
                           n
                           −
                           s
                           )
                        . Let (
                           Q
                           \
                           
                              NEP
                           
                        ) denote the set having elements in Q but not in NEP. A qualified subset of participants in 
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme, should satisfy the threshold condition: 
                           |
                           Q
                           |
                           ≥
                           k
                        . Meanwhile, the set (
                           Q
                           \
                           
                              NEP
                           
                        ), has at least t essential participants (i.e., satisfy the essentiality condition). Both conditions allow any k participants (including at least t essential participants) can reconstruct the secret. The threshold condition and the essentiality condition of 
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme are formally defined as follows.
                           
                              (1)
                              
                                 
                                    {
                                    
                                       
                                          
                                             (
                                             i
                                             )
                                             
                                             Threshold condition:
                                             
                                             |
                                             Q
                                             |
                                             ≥
                                             k
                                             ,
                                          
                                       
                                       
                                          
                                             (
                                             ii
                                             )
                                             
                                             Essentiality condition:
                                             
                                             |
                                             Q
                                             \
                                             
                                                NEP
                                             
                                             |
                                             ≥
                                             t
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In this section, we briefly review Li et al.'s ESIS scheme [24] and Yang al.'s ESIS scheme [25]. In the first 
                           (
                           k
                           ,
                           n
                           )
                        -SIS scheme (Thien and Lin's 
                           (
                           k
                           ,
                           n
                           )
                        -SIS scheme), if we do not permute the secret image, shadows will not be completely noise-like. Some visible edges are revealed, and some information of the secret image is revealed on shadows. Therefore, the secret image I should be permuted to image 
                           
                              
                                 I
                              
                              
                                 ˆ
                              
                           
                         before sharing. In reconstruction phase, we can use the inverse process of permutation to obtain I from 
                           
                              
                                 I
                              
                              
                                 ˆ
                              
                           
                        . In this paper, we describe all ESIS schemes sharing the permuted image 
                           
                              
                                 I
                              
                              
                                 ˆ
                              
                           
                        . The importance of essential shadows in ESIS scheme is not demonstrated on their shadow size. Therefore, the size of essential shadow with higher importance is not necessarily larger than that of non-essential shadow. For example, Li et al.'s ESIS scheme [24] has the smaller essential shadow size than non-essential shadow size. On the contrary, Yang et al.'s ESIS schemes [25,26] have the larger essential shadow size than non-essential shadow size. However, Yang and Wu's scheme [26] has a serious security problem. In the reconstruction process, any t essential shadows (not k shadows) may decode the secret image when 
                           2
                           t
                           >
                           k
                        .

Li et al.'s [24] 
                        
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme adopts the conventional 
                           (
                           k
                           ,
                           s
                           +
                           k
                           −
                           t
                           )
                        -SIS scheme and the 
                           (
                           1
                           ,
                           k
                           −
                           t
                           ,
                           n
                           −
                           s
                           )
                        -SSIS scheme [13]. A 
                           (
                           1
                           ,
                           k
                           −
                           t
                           ,
                           n
                           −
                           s
                           )
                        -SSIS scheme gradually reveals the partial secret from any one or more shadows, and the whole secret can be recovered from n shadows. As shown in Fig. 1
                        (a), the permuted image 
                           
                              
                                 I
                              
                              
                                 ˆ
                              
                           
                         is first encrypted by 
                           (
                           k
                           ,
                           s
                           +
                           k
                           −
                           t
                           )
                        -SIS scheme to generate 
                           (
                           s
                           +
                           k
                           −
                           t
                           )
                         sub-shadows 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                                 +
                                 k
                                 −
                                 t
                              
                           
                         (denoted as small yellow-green square). Then, we use s sub-shadows 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 1
                              
                           
                           −
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                              
                           
                         as s essential shadows 
                           
                              
                                 O
                              
                              
                                 1
                              
                           
                           −
                           
                              
                                 O
                              
                              
                                 s
                              
                           
                         (denoted as yellow square). The remaining (
                           k
                           −
                           t
                        ) sub-shadows 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                              
                           
                           −
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                                 +
                                 k
                                 −
                                 t
                              
                           
                         are used as the inputs of 
                           (
                           1
                           ,
                           k
                           −
                           t
                           ,
                           n
                           −
                           s
                           )
                        -SSIS scheme to generate 
                           (
                           n
                           −
                           s
                           )
                         non-essential shadows 
                           
                              
                                 O
                              
                              
                                 s
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 O
                              
                              
                                 n
                              
                           
                         (denoted as green square). Fig. 1(b) illustrates Yang et al.'s [25] 
                        
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme, we use two SIS schemes in a two-layer hierarchical structure. In the 1-st layer, the permuted image 
                           
                              
                                 I
                              
                              
                                 ˆ
                              
                           
                         is used as the input of 
                           (
                           k
                           ,
                           s
                           +
                           k
                           −
                           t
                           )
                        -SIS scheme. Next, 
                           (
                           k
                           −
                           t
                           )
                         sub-shadows 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                                 +
                                 k
                                 −
                                 t
                              
                           
                         in the 1-st layer are encrypted by 
                           (
                           k
                           ,
                           n
                           )
                        -SIS scheme, respectively. By collecting every 
                           (
                           n
                           −
                           s
                           )
                         sub-shadows for each 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 j
                              
                           
                        , 
                           (
                           s
                           +
                           1
                           )
                           ≤
                           j
                           ≤
                           (
                           s
                           +
                           k
                           −
                           t
                           )
                        , we generate (
                           n
                           −
                           s
                        ) non-essential shadows 
                           
                              
                                 O
                              
                              
                                 s
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 O
                              
                              
                                 n
                              
                           
                         (denoted as green square). Other s sub-shadows for each 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 j
                              
                           
                        , 
                           (
                           s
                           +
                           1
                           )
                           ≤
                           j
                           ≤
                           (
                           s
                           +
                           k
                           −
                           t
                           )
                        , are together used with the s sub-shadows 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 1
                              
                           
                           −
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                              
                           
                         in the 1-st layer to create s essential shadows 
                           
                              
                                 O
                              
                              
                                 1
                              
                           
                           −
                           
                              
                                 O
                              
                              
                                 s
                              
                           
                         (denoted as yellow square).

There are two problems in 
                        (
                        t
                        ,
                        s
                        ,
                        k
                        ,
                        n
                        )
                     -ESIS scheme [24,25]: a) the unequal size of shadows, and b) the concatenation of sub-shadows. These two problems are ignored by Li et al.'s scheme and Yang et al.'s scheme [24,25]. However, in practice, problem a) may bring about the security vulnerability and problem b) complicates the reconstruction process.

A 
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme has s essential shadows (say 
                           
                              
                                 O
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 O
                              
                              
                                 2
                              
                           
                           ,
                           …
                        , and 
                           
                              
                                 O
                              
                              
                                 s
                              
                           
                        ) with the size SE and 
                           (
                           n
                           −
                           s
                           )
                         non-essential shadows (say 
                           
                              
                                 O
                              
                              
                                 s
                                 +
                                 1
                              
                           
                           ,
                           
                              
                                 O
                              
                              
                                 s
                                 +
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 O
                              
                              
                                 n
                              
                           
                        ) with the size SN. Essential shadows and non-essential shadows of previous 
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS schemes [24,25] have different sizes. Suppose the original secret image I has the size 
                           |
                           I
                           |
                        . The sizes of SE and SN for Li et al.'s [24] 
                        
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme are 
                           
                              
                                 SE
                              
                              
                                 L
                              
                           
                           =
                           |
                           I
                           |
                           /
                           k
                         and 
                           
                              
                                 SN
                              
                              
                                 L
                              
                           
                           =
                           
                              
                                 H
                              
                              
                                 k
                                 −
                                 t
                              
                           
                           ×
                           |
                           I
                           |
                           /
                           k
                        , where 
                           
                              
                                 H
                              
                              
                                 k
                                 −
                                 t
                              
                           
                           =
                           1
                           +
                           1
                           /
                           2
                           +
                           ⋯
                           +
                           1
                           /
                           (
                           k
                           −
                           t
                           )
                         is the harmonic number. Yang et al.'s [25] ESIS scheme has 
                           
                              
                                 SE
                              
                              
                                 Y
                              
                           
                           =
                           (
                           2
                           k
                           −
                           t
                           )
                           ×
                           |
                           I
                           |
                           /
                           
                              
                                 k
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 SN
                              
                              
                                 Y
                              
                           
                           =
                           (
                           k
                           −
                           t
                           )
                           ×
                           |
                           I
                           |
                           /
                           
                              
                                 k
                              
                              
                                 2
                              
                           
                        . For these two 
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS schemes, we have 
                           
                              
                                 SE
                              
                              
                                 L
                              
                           
                           <
                           
                              
                                 SN
                              
                              
                                 L
                              
                           
                         and 
                           
                              
                                 SE
                              
                              
                                 Y
                              
                           
                           >
                           
                              
                                 SN
                              
                              
                                 Y
                              
                           
                        . As shown in Fig. 1(a), Li et al.'s [24] ESIS scheme directly uses the output sub-shadows of 
                           (
                           k
                           ,
                           s
                           +
                           k
                           −
                           t
                           )
                        -SIS scheme 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 2
                              
                           
                           ,
                           …
                        , and 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                              
                           
                         as essential shadows 
                           
                              
                                 O
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 O
                              
                              
                                 2
                              
                           
                           ,
                           …
                        , and 
                           
                              
                                 O
                              
                              
                                 s
                              
                           
                        . However, Yang et al.'s [25] ESIS scheme adds extra output sub-shadows of 
                           (
                           k
                           ,
                           n
                           )
                        -SIS scheme (see Fig. 1(b)) into 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 2
                              
                           
                           ,
                           …
                        , and 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                              
                           
                         to create essential shadows 
                           
                              
                                 O
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 O
                              
                              
                                 2
                              
                           
                           ,
                           …
                        , and 
                           
                              
                                 O
                              
                              
                                 s
                              
                           
                        . Compared with Li et al.'s [24] scheme, Yang et al.'s [25] scheme has larger ES, smaller size of total shadows and smaller size of the required shadow images in reconstruction.

Since 
                           
                              
                                 SE
                              
                              
                                 L
                              
                           
                           ≠
                           
                              
                                 SN
                              
                              
                                 L
                              
                           
                         and 
                           
                              
                                 SE
                              
                              
                                 Y
                              
                           
                           ≠
                           
                              
                                 SN
                              
                              
                                 Y
                              
                           
                        , the outsiders (attackers) can perceive the differences of shadow size. This problem of unequal-size of shadows has security vulnerability. From the shadow size, attackers learn who essential participants are. Afterwards, attackers may advisedly attack the essential participants and prohibit them from involving in reconstruction. Because 
                           t
                           <
                           k
                        , it is easier to compromise the threshold property of a 
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme by attacking essential participant. Additionally, essential participants are often heads of government, leaders of company. Therefore, another flaw is that the status of a participant is exposed to public and it poses a threat to the privacy of personal information. From the above description, it is necessary to design a 
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme that has the same size of essential and non-essential shadows.

The 
                           (
                           1
                           ,
                           k
                           −
                           t
                           ,
                           n
                           −
                           s
                           )
                        -SSIS scheme in Li et al.'s [24] ESIS scheme is constructed from 
                           (
                           k
                           −
                           t
                           )
                         SIS schemes [13]. By using 
                           (
                           k
                           −
                           t
                           )
                         images 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                                 +
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                                 +
                                 2
                              
                           
                           ,
                           …
                        , and 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                                 +
                                 k
                                 −
                                 t
                              
                           
                         as the inputs of 
                           (
                           1
                           ,
                           n
                           −
                           s
                           )
                        -SIS scheme, 
                           (
                           2
                           ,
                           n
                           −
                           s
                           )
                        -SIS scheme, …, and 
                           (
                           k
                           −
                           t
                           ,
                           n
                           −
                           s
                           )
                        -SIS scheme, respectively, their output sub-shadows are 
                           
                              
                                 S
                              
                              
                                 s
                                 +
                                 1
                                 ,
                                 i
                              
                           
                           ,
                           
                              
                                 S
                              
                              
                                 s
                                 +
                                 2
                                 ,
                                 i
                              
                           
                           ,
                           …
                        , and 
                           
                              
                                 S
                              
                              
                                 s
                                 +
                                 k
                                 −
                                 t
                                 ,
                                 i
                              
                           
                        , 
                           1
                           ≤
                           i
                           ≤
                           (
                           n
                           −
                           s
                           )
                        . Then, Li et al.'s [24] 
                        
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme has non-essential shadows 
                           
                              
                                 O
                              
                              
                                 s
                                 +
                                 i
                              
                           
                           =
                           (
                           
                              
                                 S
                              
                              
                                 s
                                 +
                                 1
                                 ,
                                 i
                              
                           
                           |
                           |
                           
                              
                                 S
                              
                              
                                 s
                                 +
                                 2
                                 ,
                                 i
                              
                           
                           |
                           ⋯
                           |
                           |
                           
                              
                                 S
                              
                              
                                 s
                                 +
                                 k
                                 −
                                 t
                                 ,
                                 i
                              
                           
                           )
                        , where 
                           1
                           ≤
                           i
                           ≤
                           (
                           n
                           −
                           s
                           )
                         and ‘||’ denotes concatenation operation. In Yang et al.'s [25] 
                        
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme, suppose that 
                           (
                           k
                           −
                           t
                           )
                         
                        
                           (
                           k
                           ,
                           n
                           )
                        -SIS schemes with the input images 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                                 +
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                                 +
                                 2
                              
                           
                           ,
                           …
                        , and 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                                 +
                                 k
                                 −
                                 t
                              
                           
                        , respectively, have output sub-shadows 
                           
                              
                                 S
                              
                              
                                 s
                                 +
                                 1
                                 ,
                                 i
                              
                           
                           ,
                           
                              
                                 S
                              
                              
                                 s
                                 +
                                 2
                                 ,
                                 i
                              
                           
                           ,
                           …
                        , and 
                           
                              
                                 S
                              
                              
                                 s
                                 +
                                 k
                                 −
                                 t
                                 ,
                                 i
                              
                           
                        , 
                           1
                           ≤
                           i
                           ≤
                           n
                        . Then, Yang et al.'s [25] ESIS scheme has essential shadows 
                           
                              
                                 O
                              
                              
                                 i
                              
                           
                           =
                           (
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                              
                           
                           |
                           |
                           
                              
                                 S
                              
                              
                                 s
                                 +
                                 1
                                 ,
                                 i
                              
                           
                           |
                           |
                           
                              
                                 S
                              
                              
                                 s
                                 +
                                 2
                                 ,
                                 i
                              
                           
                           |
                           |
                           ⋯
                           |
                           |
                           
                              
                                 S
                              
                              
                                 s
                                 +
                                 k
                                 −
                                 t
                                 ,
                                 i
                              
                           
                           )
                         for 
                           1
                           ≤
                           i
                           ≤
                           s
                        , and non-essential shadows 
                           
                              
                                 O
                              
                              
                                 i
                              
                           
                           =
                           (
                           
                              
                                 S
                              
                              
                                 s
                                 +
                                 1
                                 ,
                                 i
                              
                           
                           |
                           |
                           
                              
                                 S
                              
                              
                                 s
                                 +
                                 2
                                 ,
                                 i
                              
                           
                           |
                           |
                           ⋯
                           |
                           |
                           
                              
                                 S
                              
                              
                                 s
                                 +
                                 k
                                 −
                                 t
                                 ,
                                 i
                              
                           
                           )
                         for 
                           (
                           s
                           +
                           1
                           )
                           ≤
                           i
                           ≤
                           n
                        .

Because the non-essential shadows of Li et al.'s [24] ESIS scheme and all shadows of Yang et al.'s [25] scheme are concatenated by sub-shadows of different SIS schemes. Thus, the locations of these sub-shadows in final shadows should be recorded so that we can extract the corresponding sub-shadows in reconstruction. Even though the locations are publicly announced in advance, we still need extra operations to extract sub-shadows from shadows. Therefore, it is necessary to design a 
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme, which generates single and same-sized sub-shadow for each shadow.

In this paper, we use differential of a polynomial to design a 
                        (
                        t
                        ,
                        s
                        ,
                        k
                        ,
                        n
                        )
                     -ESIS scheme. Unlike Guo et al.'s scheme [28], the secret pixels are only embedded into partial coefficients of polynomial. In the proposed scheme, essential and non-essential shadows have the same sizes. Additionally, every shadow is generated by a single SIS scheme so that we do not need extra extractions to obtain sub-shadows for reconstruction. Our ESIS scheme satisfies the threshold condition and the essentiality condition of 
                        (
                        t
                        ,
                        s
                        ,
                        k
                        ,
                        n
                        )
                     -ESIS scheme. Meanwhile, our scheme solves the problem of unequal sized shadows and the problem of concatenation of sub-shadows. Notations used in the proposed 
                        (
                        t
                        ,
                        s
                        ,
                        k
                        ,
                        n
                        )
                     -ESIS scheme and their descriptions are listed in Table 1
                     .

The original secret image should be permutated first to get the permuted image 
                        
                           
                              I
                           
                           
                              ˆ
                           
                        
                     . To avoid the leakage of information from shadows [2], all SIS schemes and ESIS schemes need this permutation phase to assure the randomness of shadow images. Fig. 2
                      shows the workflow diagram of the proposed 
                        (
                        t
                        ,
                        s
                        ,
                        k
                        ,
                        n
                        )
                     -ESIS scheme. The formal encryption and decryption of our 
                        (
                        t
                        ,
                        s
                        ,
                        k
                        ,
                        n
                        )
                     -ESIS scheme are described in Algorithm 1
                      and Algorithm 2
                     .

As shown in Algorithm 1, we embed t secret pixels into t coefficients (
                        
                           
                              a
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              a
                           
                           
                              1
                           
                        
                        ,
                        …
                     , and 
                        
                           
                              a
                           
                           
                              t
                              −
                              1
                           
                        
                     ) (partial coefficients of 
                        (
                        k
                        −
                        1
                        )
                     -degree polynomial 
                        f
                        (
                        x
                        )
                     ). Using (k, s)-SIS scheme based on 
                        f
                        (
                        x
                        )
                     , we generate s essential shadows 
                        
                           
                              O
                           
                           
                              1
                           
                        
                        −
                        
                           
                              O
                           
                           
                              s
                           
                        
                     . Afterwards, we calculate the t-th derivative of 
                        f
                        (
                        x
                        )
                      to get 
                        
                           
                              f
                           
                           
                              (
                              t
                              )
                           
                        
                        (
                        x
                        )
                     . Associate every 
                        (
                        k
                        −
                        t
                        )
                      coefficients of 
                        
                           
                              f
                           
                           
                              (
                              t
                              )
                           
                        
                        (
                        x
                        )
                      to form an intermediate image 
                        
                           
                              I
                           
                           
                              ˜
                           
                        
                     . Then, applying the 
                        (
                        k
                        −
                        t
                        ,
                        n
                        −
                        s
                        )
                     -SIS on 
                        
                           
                              I
                           
                           
                              ˜
                           
                        
                      to generate 
                        (
                        n
                        −
                        s
                        )
                      non-essential shadows 
                        
                           
                              O
                           
                           
                              s
                              +
                              1
                           
                        
                        −
                        
                           
                              O
                           
                           
                              n
                           
                        
                     . In the revealing process, we need employ Birkhoff interpolation to reveal the secret image.

Birkhoff interpolation is to find a polynomial 
                        f
                        (
                        x
                        )
                      of degree 
                        k
                        −
                        1
                      such that certain derivatives have specified values at specified points [30]. In our scheme, the specified points are the ID of each shadows, and the specified values are the pixels' values of each shadow. The incidence matrix 
                        
                           
                              E
                           
                           
                              n
                              ×
                              t
                           
                        
                        =
                        (
                        
                           
                              e
                           
                           
                              i
                              j
                           
                        
                        )
                      of the Birkhoff interpolation is defined with all entries are either 0 or 1. 
                        
                           
                              e
                           
                           
                              i
                              j
                           
                        
                        =
                        1
                      if and only if the i-th point's specified value is generated by the j-th derivative of the polynomial. Therefore we have 
                        
                           
                              ∑
                           
                           
                              i
                              ,
                              j
                           
                        
                        
                           
                              e
                           
                           
                              i
                              j
                           
                        
                        =
                        n
                     . Actually, a Birkhoff interpolation problem does not always have a unique solution. Whether a Birkhoff interpolation has a unique solution depends on the incidence matrix E and the specified points. The solution of Birkhoff interpolation can be also equivalently transformed to finding the solution of the corresponding linear equations. If and only if the rank of the coefficient matrix of the linear equations is equal to k, the linear equations have unique solution, which means the corresponding Birkhoff interpolation problem also has the same solution.

In the following theorem, we theoretically prove that our scheme satisfies the threshold condition and the essentiality condition in Eq. (1).


                     
                        Theorem 1
                        
                           The proposed scheme in 
                           
                              Algorithm 1
                            
                           is a 
                           
                              (
                              t
                              ,
                              s
                              ,
                              k
                              ,
                              n
                              )
                           
                           -ESIS scheme and has essential and non-essential shadows of the same size 
                           
                              |
                              I
                              |
                              /
                              t
                           
                           .
                        


                     
                        Proof
                        To prove the proposed scheme is a 
                              (
                              t
                              ,
                              s
                              ,
                              k
                              ,
                              n
                              )
                           -EISS scheme, we have to prove if and only if the threshold condition and the essentiality condition are satisfied, the permuted secret image can be recovered.

We first prove that the violation of any one condition cannot recover the permuted image. Consider the case that the threshold condition is not satisfied, i.e., 
                              l
                              <
                              k
                           . First, suppose 
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                              ≥
                              (
                              k
                              −
                              t
                              )
                           . We recover the intermediate image via 
                              
                                 
                                    I
                                 
                                 
                                    ˜
                                 
                              
                              =
                              
                                 
                                    D
                                 
                                 
                                    k
                                    −
                                    t
                                    ,
                                    n
                                    −
                                    s
                                 
                              
                              (
                              
                                 
                                    O
                                 
                                 
                                    s
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    O
                                 
                                 
                                    s
                                    +
                                    
                                       
                                          l
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              )
                            and obtain every 
                              
                                 
                                    f
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              
                              (
                              x
                              )
                            from 
                              
                                 
                                    I
                                 
                                 
                                    ˜
                                 
                              
                           . By integrating t times, we derive 
                              f
                              (
                              x
                              )
                            and determine (
                              k
                              −
                              t
                           ) coefficients (
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                           , 
                              
                                 
                                    a
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    a
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                           ) of 
                              f
                              (
                              x
                              )
                           . However, there are still t unknown coefficients 
                              (
                              
                                 
                                    a
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    a
                                 
                                 
                                    t
                                    −
                                    1
                                 
                              
                              )
                            of 
                              f
                              (
                              x
                              )
                           . Because 
                              l
                              <
                              k
                            and 
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                              ≥
                              (
                              k
                              −
                              t
                              )
                           , we only have 
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                              =
                              (
                              l
                              −
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                              )
                              <
                              t
                            equations for the polynomial 
                              f
                              (
                              x
                              )
                            with the information of 
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                            essential shadows 
                              
                                 
                                    O
                                 
                                 
                                    1
                                 
                              
                              −
                              
                                 
                                    O
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           . Thus, we cannot solve 
                              (
                              
                                 
                                    a
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    a
                                 
                                 
                                    t
                                    −
                                    1
                                 
                              
                              )
                            of 
                              f
                              (
                              x
                              )
                           . Second, suppose 
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                              <
                              (
                              k
                              −
                              t
                              )
                           . In this case, we cannot get the intermediate image by 
                              (
                              k
                              −
                              t
                              ,
                              n
                              −
                              s
                              )
                           -SIS scheme. Thus, we have 
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                            equations for 
                              
                                 
                                    f
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              
                              (
                              x
                              )
                            with the information of 
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                            non-essential shadows 
                              
                                 
                                    O
                                 
                                 
                                    s
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    O
                                 
                                 
                                    s
                                    +
                                    
                                       
                                          l
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           , which are equivalent to have 
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                            equations for 
                              f
                              (
                              x
                              )
                           . Meanwhile, we have 
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                            equations for 
                              f
                              (
                              x
                              )
                            with the information of 
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                            essential shadows 
                              
                                 
                                    O
                                 
                                 
                                    1
                                 
                              
                              −
                              
                                 
                                    O
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           . Because 
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                              =
                              l
                           , we have only 
                              l
                              (
                              <
                              k
                              )
                            equations to solve k unknowns 
                              (
                              
                                 
                                    a
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    a
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              )
                           . Thus, we cannot recover all coefficients of 
                              f
                              (
                              x
                              )
                           .

Then we prove that the violation of the essentiality condition cannot recover the secret image. Suppose 
                              l
                              ≥
                              k
                           , and 
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                              <
                              t
                           , which means 
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                              =
                              l
                              −
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                              >
                              (
                              k
                              −
                              t
                              )
                           . In this case, there are more than (
                              k
                              −
                              t
                           ) non-essential shadows, thus we can construct 
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                              >
                              (
                              k
                              −
                              t
                              )
                            equations to solve 
                              (
                              k
                              −
                              t
                              )
                            coefficients of 
                              
                                 
                                    f
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              
                              (
                              x
                              )
                           . Then we get (
                              k
                              −
                              t
                           ) coefficients 
                              (
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    a
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              )
                            of 
                              f
                              (
                              x
                              )
                           . However, we only have 
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                              <
                              t
                            essential shadows. Hence we can only construct 
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                            equations to solve the remain t coefficients of 
                              f
                              (
                              x
                              )
                           . Obviously, we cannot get the unique solution and recover the secret pixels 
                              (
                              
                                 
                                    a
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    a
                                 
                                 
                                    t
                                    −
                                    1
                                 
                              
                              )
                           .

We now prove that when the threshold condition and the essentiality condition are satisfied we can reconstruct the permuted image. Two cases in Algorithm 2 are considered.

Case 1: 
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                              =
                              t
                            and 
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                              =
                              (
                              k
                              −
                              t
                              )
                           
                        

For simplicity, suppose that the shadow IDs of 
                              
                                 
                                    O
                                 
                                 
                                    1
                                 
                              
                              −
                              
                                 
                                    O
                                 
                                 
                                    n
                                 
                              
                            are 
                              1
                              ,
                              2
                              ,
                              …
                           , and n. The reconstruction can be accomplished using Birkhoff interpolation with the shadow IDs 
                              X
                              =
                              {
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              t
                              ,
                              s
                              +
                              1
                              ,
                              …
                              ,
                              s
                              +
                              k
                              −
                              t
                              }
                           . Since we use 
                              f
                              (
                              x
                              )
                            and 
                              
                                 
                                    f
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              
                              (
                              x
                              )
                            to embed secret pixels, we have all-0 columns of E except for the first column and the t-th column. The incidence matrix E is generated as follows.
                              
                                 (2)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   X
                                                
                                             
                                          
                                          
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               1
                                                               ,
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               1
                                                               ,
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               1
                                                               ,
                                                               t
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               1
                                                               ,
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               t
                                                               ,
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               t
                                                               ,
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               t
                                                               ,
                                                               t
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               t
                                                               ,
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               t
                                                               +
                                                               1
                                                               ,
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               t
                                                               +
                                                               1
                                                               ,
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               t
                                                               +
                                                               1
                                                               ,
                                                               t
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               t
                                                               +
                                                               1
                                                               ,
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               1
                                                               ,
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               1
                                                               ,
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         ⋱
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               1
                                                               ,
                                                               t
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               1
                                                               ,
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               k
                                                               −
                                                               t
                                                               ,
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               k
                                                               −
                                                               t
                                                               ,
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               k
                                                               −
                                                               t
                                                               ,
                                                               t
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               k
                                                               −
                                                               t
                                                               ,
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               k
                                                               −
                                                               t
                                                               +
                                                               1
                                                               ,
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               k
                                                               −
                                                               t
                                                               +
                                                               1
                                                               ,
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               k
                                                               −
                                                               t
                                                               +
                                                               1
                                                               ,
                                                               t
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               k
                                                               −
                                                               t
                                                               +
                                                               1
                                                               ,
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               n
                                                               ,
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               n
                                                               ,
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               n
                                                               ,
                                                               t
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               n
                                                               ,
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋱
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                            The corresponding system of linear equations with k unknowns (
                              
                                 
                                    a
                                 
                                 
                                    0
                                 
                              
                           , 
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                           , …, 
                              
                                 
                                    a
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                           ) has the following coefficient matrix 
                              
                                 
                                    A
                                 
                                 
                                    X
                                 
                              
                           :
                              
                                 (3)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   X
                                                
                                             
                                          
                                          
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         
                                                      
                                                      
                                                         ⋯
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               t
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         
                                                      
                                                      
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               t
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                         
                                                      
                                                      
                                                         ⋮
                                                         
                                                      
                                                      
                                                         
                                                      
                                                      
                                                         ⋮
                                                         
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         
                                                      
                                                      
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               t
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                         
                                                      
                                                      
                                                         0
                                                         
                                                      
                                                      
                                                         ⋱
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               s
                                                               +
                                                               1
                                                               )
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         ×
                                                         t
                                                         !
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               s
                                                               +
                                                               1
                                                               )
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         ×
                                                         
                                                            
                                                               (
                                                               t
                                                               +
                                                               1
                                                               )
                                                               !
                                                            
                                                            
                                                               1
                                                               !
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                         
                                                      
                                                      
                                                         ⋮
                                                         
                                                      
                                                      
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               s
                                                               +
                                                               2
                                                               )
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         ×
                                                         t
                                                         !
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               s
                                                               +
                                                               2
                                                               )
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         ×
                                                         
                                                            
                                                               (
                                                               t
                                                               +
                                                               1
                                                               )
                                                               !
                                                            
                                                            
                                                               1
                                                               !
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                         
                                                      
                                                      
                                                         ⋮
                                                         
                                                      
                                                      
                                                         
                                                      
                                                      
                                                         ⋮
                                                         
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                         
                                                      
                                                      
                                                         0
                                                         
                                                      
                                                      
                                                         ⋯
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               s
                                                               +
                                                               k
                                                               −
                                                               t
                                                               )
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         ×
                                                         t
                                                         !
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               s
                                                               +
                                                               k
                                                               −
                                                               t
                                                               )
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         ×
                                                         
                                                            
                                                               (
                                                               t
                                                               +
                                                               1
                                                               )
                                                               !
                                                            
                                                            
                                                               1
                                                               !
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         ⋯
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋱
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               s
                                                               +
                                                               1
                                                               )
                                                            
                                                            
                                                               k
                                                               −
                                                               t
                                                               −
                                                               2
                                                            
                                                         
                                                         ×
                                                         
                                                            
                                                               (
                                                               k
                                                               −
                                                               1
                                                               )
                                                               !
                                                            
                                                            
                                                               (
                                                               k
                                                               −
                                                               t
                                                               −
                                                               1
                                                               )
                                                               !
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               s
                                                               +
                                                               2
                                                               )
                                                            
                                                            
                                                               k
                                                               −
                                                               t
                                                               −
                                                               2
                                                            
                                                         
                                                         ×
                                                         
                                                            
                                                               (
                                                               k
                                                               −
                                                               1
                                                               )
                                                               !
                                                            
                                                            
                                                               (
                                                               k
                                                               −
                                                               t
                                                               −
                                                               1
                                                               )
                                                               !
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         ⋯
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               s
                                                               +
                                                               k
                                                               −
                                                               t
                                                               )
                                                            
                                                            
                                                               k
                                                               −
                                                               t
                                                               −
                                                               2
                                                            
                                                         
                                                         ×
                                                         
                                                            
                                                               (
                                                               k
                                                               −
                                                               1
                                                               )
                                                               !
                                                            
                                                            
                                                               (
                                                               k
                                                               −
                                                               t
                                                               −
                                                               1
                                                               )
                                                               !
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The rank of 
                              
                                 
                                    A
                                 
                                 
                                    X
                                 
                              
                            in Eq. (3) is 
                              t
                              +
                              (
                              k
                              −
                              t
                              )
                              =
                              k
                           , and thus we have k linear independent equations to solve k unknowns (
                              
                                 
                                    a
                                 
                                 
                                    0
                                 
                              
                           , 
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                           , …, 
                              
                                 
                                    a
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                           ) in 
                              f
                              (
                              x
                              )
                           .

Case 2: 
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                              >
                              t
                            and 
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                              =
                              (
                              k
                              −
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                              )
                           
                        

Eqs. (4) and (5) show the incidence matrix 
                              
                                 
                                    E
                                 
                                 
                                    X
                                 
                              
                            and its corresponding coefficient matrix 
                              
                                 
                                    A
                                 
                                 
                                    X
                                 
                              
                           . The rank of 
                              
                                 
                                    A
                                 
                                 
                                    X
                                 
                              
                            in Eq. (5) is 
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                              +
                              (
                              k
                              −
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                              )
                              =
                              k
                           , and thus we can solve k unknowns 
                              (
                              
                                 
                                    a
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    a
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              )
                            in 
                              f
                              (
                              x
                              )
                           .
                              
                                 (4)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   X
                                                
                                             
                                          
                                          
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               1
                                                               ,
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               1
                                                               ,
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               1
                                                               ,
                                                               t
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               1
                                                               ,
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               t
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               +
                                                               1
                                                               ,
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               +
                                                               1
                                                               ,
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               +
                                                               1
                                                               ,
                                                               t
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               +
                                                               1
                                                               ,
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               1
                                                               ,
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               1
                                                               ,
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         ⋱
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               1
                                                               ,
                                                               t
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               1
                                                               ,
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               ,
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               ,
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               ,
                                                               t
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               ,
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               +
                                                               1
                                                               ,
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               +
                                                               1
                                                               ,
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               +
                                                               1
                                                               ,
                                                               t
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               s
                                                               +
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               +
                                                               1
                                                               ,
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               n
                                                               ,
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               n
                                                               ,
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               n
                                                               ,
                                                               t
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               n
                                                               ,
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋱
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (5)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   X
                                                
                                             
                                          
                                          
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         
                                                      
                                                      
                                                         ⋯
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               t
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         
                                                      
                                                      
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               t
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                         
                                                      
                                                      
                                                         ⋮
                                                         
                                                      
                                                      
                                                         
                                                      
                                                      
                                                         ⋮
                                                         
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         
                                                      
                                                      
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               t
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                         
                                                      
                                                      
                                                         0
                                                         
                                                      
                                                      
                                                         ⋱
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               s
                                                               +
                                                               1
                                                               )
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         ×
                                                         t
                                                         !
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               s
                                                               +
                                                               1
                                                               )
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         ×
                                                         
                                                            
                                                               (
                                                               t
                                                               +
                                                               1
                                                               )
                                                               !
                                                            
                                                            
                                                               1
                                                               !
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                         
                                                      
                                                      
                                                         ⋮
                                                         
                                                      
                                                      
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               s
                                                               +
                                                               2
                                                               )
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         ×
                                                         t
                                                         !
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               s
                                                               +
                                                               2
                                                               )
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         ×
                                                         
                                                            
                                                               (
                                                               t
                                                               +
                                                               1
                                                               )
                                                               !
                                                            
                                                            
                                                               1
                                                               !
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                         
                                                      
                                                      
                                                         ⋮
                                                         
                                                      
                                                      
                                                         
                                                      
                                                      
                                                         ⋮
                                                         
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                         
                                                      
                                                      
                                                         0
                                                         
                                                      
                                                      
                                                         ⋯
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               s
                                                               +
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         ×
                                                         t
                                                         !
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               s
                                                               +
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         ×
                                                         
                                                            
                                                               (
                                                               t
                                                               +
                                                               1
                                                               )
                                                               !
                                                            
                                                            
                                                               1
                                                               !
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         ⋯
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋱
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               s
                                                               +
                                                               1
                                                               )
                                                            
                                                            
                                                               k
                                                               −
                                                               t
                                                               −
                                                               2
                                                            
                                                         
                                                         ×
                                                         
                                                            
                                                               (
                                                               k
                                                               −
                                                               1
                                                               )
                                                               !
                                                            
                                                            
                                                               (
                                                               k
                                                               −
                                                               t
                                                               −
                                                               1
                                                               )
                                                               !
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               s
                                                               +
                                                               2
                                                               )
                                                            
                                                            
                                                               k
                                                               −
                                                               t
                                                               −
                                                               2
                                                            
                                                         
                                                         ×
                                                         
                                                            
                                                               (
                                                               k
                                                               −
                                                               1
                                                               )
                                                               !
                                                            
                                                            
                                                               (
                                                               k
                                                               −
                                                               t
                                                               −
                                                               1
                                                               )
                                                               !
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         ⋯
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               s
                                                               +
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               k
                                                               −
                                                               t
                                                               −
                                                               2
                                                            
                                                         
                                                         ×
                                                         
                                                            
                                                               (
                                                               k
                                                               −
                                                               1
                                                               )
                                                               !
                                                            
                                                            
                                                               (
                                                               k
                                                               −
                                                               t
                                                               −
                                                               1
                                                               )
                                                               !
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Let the sizes of essential and non-essential shadows for the proposed 
                              (
                              t
                              ,
                              s
                              ,
                              k
                              ,
                              n
                              )
                           -ESIS scheme be 
                              
                                 
                                    SE
                                 
                                 
                                    P
                                 
                              
                            and 
                              
                                 
                                    SN
                                 
                                 
                                    P
                                 
                              
                           , respectively. In step (A1-1), our essential shadows are generated by (k, s)-SIS scheme (
                              
                                 
                                    O
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    E
                                 
                                 
                                    k
                                    ,
                                    s
                                 
                              
                              (
                              
                                 
                                    I
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           , 
                              1
                              ≤
                              i
                              ≤
                              s
                           ), by embedding every t pixels into one shadow pixel. Thus, 
                              
                                 
                                    SE
                                 
                                 
                                    P
                                 
                              
                              =
                              |
                              
                                 
                                    I
                                 
                                 
                                    ˆ
                                 
                              
                              |
                              /
                              t
                              =
                              |
                              I
                              |
                              /
                              t
                           . In (A1-4), we use 
                              
                                 
                                    O
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    E
                                 
                                 
                                    k
                                    −
                                    t
                                    ,
                                    n
                                    −
                                    s
                                 
                              
                              (
                              
                                 
                                    I
                                 
                                 
                                    ˜
                                 
                              
                              )
                              ,
                              (
                              s
                              +
                              1
                              )
                              ≤
                              i
                              ≤
                              n
                           , and embed every (
                              k
                              −
                              t
                           ) secret pixels into one shadow pixel. The size of non-essential shadow is 
                              
                                 
                                    SN
                                 
                                 
                                    P
                                 
                              
                              =
                              |
                              
                                 
                                    I
                                 
                                 
                                    ˜
                                 
                              
                              |
                              /
                              (
                              k
                              −
                              t
                              )
                              =
                              (
                              |
                              I
                              |
                              ×
                              (
                              k
                              −
                              t
                              )
                              /
                              t
                              )
                              /
                              (
                              k
                              −
                              t
                              )
                              =
                              |
                              I
                              |
                              /
                              t
                           . Finally, essential shadows and non-essential shadows have the same size 
                              
                                 
                                    SE
                                 
                                 
                                    P
                                 
                              
                              =
                              
                                 
                                    SN
                                 
                                 
                                    P
                                 
                              
                              =
                              |
                              I
                              |
                              /
                              t
                           . □

As we proved in Theorem 1, the proposed scheme can achieve the same size of all shadows. In addition, our scheme generates shadows using derivative polynomial, and each shadow is generated by a single polynomial. Therefore, no concatenation operation is needed in our scheme. Obviously, our scheme can solve the two problems in schemes [24,25]: unequal size of shadows and the concatenation of sub-shadows.

@&#EXPERIMENTAL RESULTS@&#

In this section, we conduct three experiments to test the effectiveness of our scheme. The first example mainly focuses on the correctness of Algorithm 1 and Algorithm 2. The last two example is used to test the effect in real application.


                        
                           Example 1
                           For the proposed 
                                 (
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 ,
                                 5
                                 )
                              -ESIS scheme, we share 2 
                                 (
                                 =
                                 t
                                 )
                               secret pixels of the permuted image into one shadow pixel of each essential shadow 
                                 (
                                 
                                    
                                       O
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       O
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       O
                                    
                                    
                                       3
                                    
                                 
                                 )
                               and one shadow pixel of each non-essential shadow 
                                 (
                                 
                                    
                                       O
                                    
                                    
                                       4
                                    
                                 
                                 ,
                                 
                                    
                                       O
                                    
                                    
                                       5
                                    
                                 
                                 )
                              .

For simply showing the detailed calculation, we adopt the modular arithmetic modulus 251 in this example. Suppose two secret pixels are 28 and 13, and that IDs of five shadows are 
                           1
                           ,
                           2
                           ,
                           …
                        , and 5. By embedding the two pixels into two coefficients 
                           
                              
                                 a
                              
                              
                                 0
                              
                           
                           =
                           28
                         and 
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           =
                           13
                         of 
                           f
                           (
                           x
                           )
                         and randomly choosing 
                           
                              
                                 a
                              
                              
                                 2
                              
                           
                           =
                           5
                         and 
                           
                              
                                 a
                              
                              
                                 3
                              
                           
                           =
                           8
                        , we have the following 3-degree polynomial 
                           f
                           (
                           x
                           )
                        .
                           
                              (6)
                              
                                 f
                                 (
                                 x
                                 )
                                 =
                                 28
                                 +
                                 13
                                 x
                                 +
                                 5
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 8
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 
                                 (
                                 
                                    mod
                                 
                                 
                                 251
                                 )
                                 .
                              
                           
                         Then, we obtain three shadow pixels 54, 138, and 77 in 
                           
                              
                                 O
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 O
                              
                              
                                 2
                              
                           
                        , and 
                           
                              
                                 O
                              
                              
                                 3
                              
                           
                        , respectively, via Eq. (7).
                           
                              (7)
                              
                                 
                                    {
                                    
                                       
                                          
                                             f
                                             (
                                             1
                                             )
                                             =
                                             28
                                             +
                                             13
                                             ×
                                             1
                                             +
                                             5
                                             ×
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             8
                                             ×
                                             
                                                
                                                   1
                                                
                                                
                                                   3
                                                
                                             
                                             
                                             (
                                             mod
                                             
                                             251
                                             )
                                             =
                                             54
                                          
                                       
                                       
                                          
                                             f
                                             (
                                             2
                                             )
                                             =
                                             28
                                             +
                                             13
                                             ×
                                             2
                                             +
                                             5
                                             ×
                                             
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             8
                                             ×
                                             
                                                
                                                   2
                                                
                                                
                                                   3
                                                
                                             
                                             
                                             (
                                             mod
                                             
                                             251
                                             )
                                             =
                                             138
                                          
                                       
                                       
                                          
                                             f
                                             (
                                             3
                                             )
                                             =
                                             28
                                             +
                                             13
                                             ×
                                             3
                                             +
                                             5
                                             ×
                                             
                                                
                                                   3
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             8
                                             ×
                                             
                                                
                                                   3
                                                
                                                
                                                   3
                                                
                                             
                                             
                                             (
                                             mod
                                             
                                             251
                                             )
                                             =
                                             77
                                          
                                       
                                    
                                 
                              
                           
                         By 
                           f
                           (
                           x
                           )
                        , we obtain the 2-th derivative 
                           
                              
                                 f
                              
                              
                                 (
                                 2
                                 )
                              
                           
                           (
                           x
                           )
                           =
                           10
                           +
                           48
                           x
                         (mod 251). Then, we obtain two shadow pixels 202 and 250 in 
                           
                              
                                 O
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 O
                              
                              
                                 5
                              
                           
                         by Eq. (8).
                           
                              (8)
                              
                                 
                                    {
                                    
                                       
                                          
                                             f
                                             (
                                             4
                                             )
                                             =
                                             10
                                             +
                                             48
                                             ×
                                             4
                                             
                                             (
                                             mod
                                             
                                             251
                                             )
                                             =
                                             202
                                          
                                       
                                       
                                          
                                             f
                                             (
                                             5
                                             )
                                             =
                                             10
                                             +
                                             48
                                             ×
                                             5
                                             
                                             (
                                             mod
                                             
                                             251
                                             )
                                             =
                                             250
                                          
                                       
                                    
                                 
                              
                           
                        
                     

For decryption, we consider the following two cases.

Case 1: 2 essential shadows 
                           
                              
                                 O
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 O
                              
                              
                                 2
                              
                           
                        , and 2 non-essential shadows 
                           
                              
                                 O
                              
                              
                                 4
                              
                           
                        , 
                           
                              
                                 O
                              
                              
                                 5
                              
                           
                         (the number of essential shadows =t):

By Eq. (3), we derive the matrix 
                           
                              
                                 A
                              
                              
                                 X
                              
                           
                         for 4 coefficients (
                           
                              
                                 a
                              
                              
                                 0
                              
                           
                        , 
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 a
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 a
                              
                              
                                 3
                              
                           
                        ) as the following.
                           
                              (9)
                              
                                 
                                    
                                       A
                                    
                                    
                                       X
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   4
                                                
                                                
                                                   0
                                                
                                             
                                             ×
                                             2
                                             !
                                          
                                          
                                             
                                                
                                                   4
                                                
                                                
                                                   1
                                                
                                             
                                             ×
                                             3
                                             !
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   5
                                                
                                                
                                                   0
                                                
                                             
                                             ×
                                             2
                                             !
                                          
                                          
                                             
                                                
                                                   5
                                                
                                                
                                                   1
                                                
                                             
                                             ×
                                             3
                                             !
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             1
                                          
                                          
                                             1
                                          
                                          
                                             1
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                          
                                             4
                                          
                                          
                                             8
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             2
                                          
                                          
                                             24
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             2
                                          
                                          
                                             30
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        
                     

It's easy to verify that the rank of the matrix in Eq. (9) is 4. We have the following 4 equations in Eq. (10) with 
                           
                              
                                 A
                              
                              
                                 X
                              
                           
                         and 4 shadow pixels 
                           f
                           (
                           1
                           )
                           =
                           54
                        , 
                           f
                           (
                           2
                           )
                           =
                           138
                        , 
                           f
                           (
                           4
                           )
                           =
                           202
                        , and 
                           f
                           (
                           5
                           )
                           =
                           250
                        . Finally, we obtain 
                           
                              
                                 a
                              
                              
                                 0
                              
                           
                           =
                           28
                        , 
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           =
                           13
                        , 
                           
                              
                                 a
                              
                              
                                 2
                              
                           
                           =
                           5
                        , 
                           
                              
                                 a
                              
                              
                                 3
                              
                           
                           =
                           8
                        , and recover two secret pixels 
                           
                              
                                 a
                              
                              
                                 0
                              
                           
                           =
                           28
                         and 
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           =
                           13
                        .
                           
                              (10)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                X
                                             
                                          
                                          ×
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             (
                                             
                                                
                                                   
                                                      f
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                
                                                   
                                                      f
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                                
                                                   
                                                      f
                                                      (
                                                      3
                                                      )
                                                   
                                                
                                                
                                                   
                                                      f
                                                      (
                                                      4
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                          ⇒
                                          
                                             (
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      4
                                                   
                                                   
                                                      8
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      24
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      30
                                                   
                                                
                                             
                                             )
                                          
                                          ×
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          =
                                          
                                             (
                                             
                                                
                                                   
                                                      54
                                                   
                                                
                                                
                                                   
                                                      138
                                                   
                                                
                                                
                                                   
                                                      202
                                                   
                                                
                                                
                                                   
                                                      250
                                                   
                                                
                                             
                                             )
                                          
                                          ⇒
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      =
                                                      54
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      +
                                                      2
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      4
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      8
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      =
                                                      138
                                                   
                                                
                                                
                                                   
                                                      2
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      24
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      =
                                                      202
                                                   
                                                
                                                
                                                   
                                                      2
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      30
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      =
                                                      250
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Case 2: 3 essential shadows 
                           
                              
                                 O
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 O
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 O
                              
                              
                                 3
                              
                           
                        , and 1 non-essential shadow 
                           
                              
                                 O
                              
                              
                                 5
                              
                           
                         (the number of essential shadows >t):

By Eq. (5), we derive the matrix 
                           
                              
                                 A
                              
                              
                                 X
                              
                           
                         for 4 coefficients (
                           
                              
                                 a
                              
                              
                                 0
                              
                           
                        , 
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 a
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 a
                              
                              
                                 3
                              
                           
                        ) as the following.
                           
                              (11)
                              
                                 
                                    
                                       A
                                    
                                    
                                       X
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   3
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   3
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   3
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   3
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   5
                                                
                                                
                                                   0
                                                
                                             
                                             ×
                                             2
                                             !
                                          
                                          
                                             
                                                
                                                   5
                                                
                                                
                                                   1
                                                
                                             
                                             ×
                                             3
                                             !
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             1
                                          
                                          
                                             1
                                          
                                          
                                             1
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                          
                                             4
                                          
                                          
                                             8
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             3
                                          
                                          
                                             9
                                          
                                          
                                             27
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             2
                                          
                                          
                                             30
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        
                     

The rank of the matrix in Eq. (11) is 4. We have the following 4 equations in Eq. (12) with 
                           
                              
                                 A
                              
                              
                                 X
                              
                           
                         and 4 shadow pixels 
                           f
                           (
                           1
                           )
                           =
                           54
                        , 
                           f
                           (
                           2
                           )
                           =
                           138
                        , 
                           f
                           (
                           3
                           )
                           =
                           77
                        , and 
                           f
                           (
                           5
                           )
                           =
                           250
                        . Finally, we obtain 
                           
                              
                                 a
                              
                              
                                 0
                              
                           
                           =
                           28
                        , 
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           =
                           13
                        , 
                           
                              
                                 a
                              
                              
                                 2
                              
                           
                           =
                           5
                        , 
                           
                              
                                 a
                              
                              
                                 3
                              
                           
                           =
                           8
                        , and recover two pixels 
                           
                              
                                 a
                              
                              
                                 0
                              
                           
                           =
                           28
                         and 
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           =
                           13
                        .
                           
                              (12)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                (
                                                X
                                                ,
                                                E
                                                )
                                             
                                          
                                          ×
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             (
                                             
                                                
                                                   
                                                      f
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                
                                                   
                                                      f
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                                
                                                   
                                                      f
                                                      (
                                                      3
                                                      )
                                                   
                                                
                                                
                                                   
                                                      f
                                                      (
                                                      5
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                          ⇒
                                          
                                             (
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      4
                                                   
                                                   
                                                      8
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      9
                                                   
                                                   
                                                      27
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      30
                                                   
                                                
                                             
                                             )
                                          
                                          ×
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          =
                                          
                                             (
                                             
                                                
                                                   
                                                      54
                                                   
                                                
                                                
                                                   
                                                      138
                                                   
                                                
                                                
                                                   
                                                      77
                                                   
                                                
                                                
                                                   
                                                      250
                                                   
                                                
                                             
                                             )
                                          
                                          ⇒
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      =
                                                      54
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      +
                                                      2
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      4
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      8
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      =
                                                      138
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      +
                                                      3
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      9
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      27
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      =
                                                      77
                                                   
                                                
                                                
                                                   
                                                      2
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      30
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      =
                                                      250
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

When we “randomly” choose k out of n shadows in 
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme to reconstruct the secret image, the choice of k-out-of-n shadows has 
                           k
                           ×
                           (
                           s
                           /
                           n
                           )
                         essential shadows with the high probability. Therefore, choosing the percentage of 
                           t
                           =
                           k
                           ×
                           (
                           s
                           /
                           n
                           )
                         (i.e., 
                           t
                           /
                           k
                           =
                           s
                           /
                           n
                        ) is reasonable in a 
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme [25]. In the following experiment, we advisedly use 
                           (
                           2
                           ,
                           4
                           ,
                           4
                           ,
                           8
                           )
                        -ESIS scheme with 
                           t
                           /
                           k
                           =
                           s
                           /
                           n
                         for testing the effectiveness of the proposed 
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme.


                        
                           Example 2
                           Test the proposed (2, 4, 4, 8)-ESIS scheme by using Lena as the secret image.


                        
                           512
                           ×
                           512
                        -pixel Lena image is used as the secret image (see Fig. 3
                        (a)). In this experiment, we use a well-known permutation approach, Torus automorphism [29], to permute the secret image. Torus automorphism approach is briefly described as follows. Torus automorphism is defined as 
                           
                              (
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                              )
                           
                           =
                           
                              (
                              
                                 
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       h
                                       +
                                       1
                                    
                                 
                              
                              )
                           
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    
                                       y
                                    
                                 
                              
                              )
                           
                         (mod 512), where 
                           (
                           x
                           ,
                           y
                           )
                         and 
                           (
                           
                              
                                 x
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 ′
                              
                           
                           )
                         are the original coordinates and new coordinates, and h is a random number. We have the permuted image 
                           
                              
                                 I
                              
                              
                                 ˆ
                              
                           
                         (see Fig. 3(b)) generated with 
                           h
                           =
                           4
                         and 10 iterations on Lena. With this permuted image, we obtain 4 essential shadows (
                           
                              
                                 O
                              
                              
                                 1
                              
                           
                           −
                           
                              
                                 O
                              
                              
                                 4
                              
                           
                        ) and 4 non-essential shadows (
                           
                              
                                 O
                              
                              
                                 5
                              
                           
                           −
                           
                              
                                 O
                              
                              
                                 8
                              
                           
                        ) by Algorithm 1, as shown in Fig. 3(c) and (d). All these shadows are 
                           512
                           ×
                           256
                         pixels. Actually, for the schemes in [2,3,24,25] and our scheme, we cannot know whether the shadows are successfully generated. All shadows are noise-like and have no apparent difference among each other. In some applications, meaningful shadows are more convenient to recognize and easy to conceal information. For this case, we can use steganography and authentication image sharing (SAIS) schemes [6–10].

Thien and Lin's 
                           (
                           4
                           ,
                           8
                           )
                        -SIS scheme, adopted all coefficients in 
                           f
                           (
                           x
                           )
                         for embedding. A secret image is divided into non-overlapping 4-pixel blocks and then each block is encoded into one shadow pixel of each shadow. Thus, the shadow size is 1/4 of the secret image, i.e., all shadows have the same importance and the size of 
                           512
                           ×
                           128
                         pixels. Li et al.'s [24] 
                        
                           (
                           2
                           ,
                           4
                           ,
                           4
                           ,
                           8
                           )
                        -ESIS scheme has 
                           
                              
                                 SE
                              
                              
                                 L
                              
                           
                           =
                           512
                           ×
                           128
                         pixels and 
                           
                              
                                 SN
                              
                              
                                 L
                              
                           
                           =
                           512
                           ×
                           192
                         pixels, while Yang al.'s 
                           (
                           2
                           ,
                           4
                           ,
                           4
                           ,
                           8
                           )
                        -ESIS scheme has 
                           
                              
                                 SE
                              
                              
                                 Y
                              
                           
                           =
                           512
                           ×
                           192
                         pixels and 
                           
                              
                                 SN
                              
                              
                                 Y
                              
                           
                           =
                           512
                           ×
                           64
                         pixels. The size of total shadows for the proposed scheme, Thien and Lin's scheme, Li et al.'s [24] scheme, and Yang et al.' scheme are 
                           
                              
                                 ST
                              
                              
                                 P
                              
                           
                           =
                           1
                           M
                         pixels, 
                           
                              
                                 ST
                              
                              
                                 T
                              
                           
                           =
                           0.5
                           M
                         pixels, 
                           
                              
                                 ST
                              
                              
                                 L
                              
                           
                           =
                           0.625
                           M
                         pixels, and 
                           
                              
                                 ST
                              
                              
                                 Y
                              
                           
                           =
                           0.5
                           M
                         pixels, respectively. Regarding the reconstruction with the minimal capacity of shadows, except the proposed scheme, all schemes have 
                           
                              
                                 SR
                              
                              
                                 T
                              
                           
                           =
                           
                              
                                 SR
                              
                              
                                 L
                              
                           
                           =
                           
                              
                                 SR
                              
                              
                                 Y
                              
                           
                           =
                           0.25
                           M
                         pixels (i.e., the capacity of one 
                           |
                           I
                           |
                        ). Li et al.'s [24] ESIS scheme uses 4 essential shadows for reconstruction, while Yang et al.'s [25] ESIS scheme uses 2 essential shadows and 2 non-essential shadows in this case. Our scheme has 
                           
                              
                                 SR
                              
                              
                                 P
                              
                           
                           =
                           0.5
                           M
                         pixels (i.e., the capacity of two 
                           |
                           I
                           |
                        ).


                        
                           Example 3
                           Test the proposed 
                                 (
                                 3
                                 ,
                                 4
                                 ,
                                 6
                                 ,
                                 8
                                 )
                              -ESIS scheme by using Lena as the secret image.

In this experiment, we also use 
                           512
                           ×
                           512
                        -pixel Lena image as the secret image. Since our scheme is 
                           (
                           3
                           ,
                           4
                           ,
                           6
                           ,
                           8
                           )
                        -ESIS scheme, we will generate 8 shadows including 4 essential and 4 non-essential shadows. In the revealing process, we need 6 shadows including at least 3 essential shadows. In this experiment, the size of each shadow is 1/3 times of the secret image. We can also have 
                           
                              
                                 ST
                              
                              
                                 P
                              
                           
                           =
                           0.67
                           M
                         pixels and 
                           
                              
                                 SR
                              
                              
                                 P
                              
                           
                           =
                           0.34
                           M
                         pixels. Fig. 4
                         shows all the generated shadows, including four essential shadows (Fig. 4(a)) and four non-essential shadows (Fig. 4(b)).

The values of essential shadow size (SE), non-essential shadow size (SN), total shadow sizes (ST), the total sizes of required shadows for reconstruction (SR), and other properties (the importance of shadow, the same-size shadow, concatenation of sub-shadows) are illustrated in Table 2
                        . Thien and Lin's [2] 
                        
                           (
                           k
                           ,
                           n
                           )
                        -SIS scheme has the same importance of shadows and has the same shadow size. The proposed 
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS scheme provides the different importance of shadows with the same size. Therefore, the attackers can not get the statuses of participants (essential or non-essential) from their shadow size. Additionally, our shadow is composed of one sub-shadow. We do not need either recoding the locations of sub-shadows or extracting sub-shadows for reconstruction. Compared with two other 
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS schemes [24,25], although our scheme has the large SE, SN, ST, and SR, it does not have two critical problems in their 
                           (
                           t
                           ,
                           s
                           ,
                           k
                           ,
                           n
                           )
                        -ESIS schemes. Actually, the shadow size can be further reduced by using Huffman code [3].

In addition, our scheme generates all essential shadows by a 
                           (
                           k
                           −
                           1
                           )
                        -degree polynomial, and all non-essential shadows by the t-th derivative of this polynomial. Therefore, in the decoding process, we only need to reconstruct one polynomial to reveal the embedded pixels. However, in the previous ESIS scheme [24,25], the shadows are generated by using multiple SIS schemes. For example, Li et al.'s scheme uses (
                           k
                           ,
                           s
                           +
                           k
                           −
                           t
                        )-SIS scheme, 
                           (
                           1
                           ,
                           n
                           −
                           s
                           )
                        -SIS scheme, 
                           (
                           2
                           ,
                           n
                           −
                           s
                           )
                        -SIS scheme, …, and 
                           (
                           k
                           −
                           t
                           ,
                           n
                           −
                           s
                           )
                        -SIS scheme. Yang et al.'s scheme uses (k, 
                           s
                           +
                           k
                           −
                           t
                        )-SIS scheme and 
                           k
                           −
                           t
                         times of 
                           (
                           k
                           ,
                           n
                           )
                        -SIS schemes. Therefore, in the decoding process, both Li et al.'s scheme and Yang et al.'s scheme need to reconstruct 
                           k
                           −
                           t
                           +
                           1
                         polynomials to reveal the embedded pixels. Obviously, the encoding and decoding process of Li et al. and Yang et al.'s schemes are more complicated.

The first idea of hierarchical secret sharing is introduced by Tassa in [27]. It employed Birkhoff interpolation to recover the secret information. Actually, our ESIS scheme also uses Birkhoff interpolation to reveal the secret image. Compared with Tassa's scheme, the contributions of our scheme can be concluded as follows. First, Tassa's scheme is used to sharing a secret information with hierarchical structure, and our scheme is designed to share a single secret image. In the sharing process, both Tassa's scheme and our scheme need generating a randomly polynomial. In Tassa's scheme, only the constant term of the polynomial is used to embed the secret. However, in our scheme, we embed secret pixels into partial coefficients, i.e., t coefficients 
                           (
                           
                              
                                 a
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 a
                              
                              
                                 t
                                 −
                                 1
                              
                           
                           )
                         of 
                           f
                           (
                           x
                           )
                        . Hence our scheme generates one shadow pixel for each shadow when sharing t secret pixels. The shadow size is 
                           1
                           /
                           t
                         times of the secret image, whereas Tassa's scheme generates shadows with the same size as the original secret. Therefore, our scheme is more efficient in secret image sharing. Second, our ESIS scheme solved two serious problems in the previous ESIS schemes: unequal size of shadows and the concatenation of sub-shadows. These two problems may bring about the security vulnerability and make the reconstruction more difficult.

By a trivial approach, one can intentionally add dummy pixels into essential shadows of Li et al.'s [24] ESIS scheme to get the same 
                           
                              
                                 SE
                              
                              
                                 L
                              
                           
                           =
                           S
                           
                              
                                 N
                              
                              
                                 L
                              
                           
                           =
                           (
                           
                              
                                 H
                              
                              
                                 k
                                 −
                                 t
                              
                           
                           ×
                           |
                           I
                           |
                           )
                           /
                           k
                        . By the same argument, dummy pixels can also be added into non-essential shadows of Yang et al.'s [25] ESIS scheme to get the same 
                           
                              
                                 SE
                              
                              
                                 Y
                              
                           
                           =
                           S
                           
                              
                                 N
                              
                              
                                 Y
                              
                           
                           =
                           (
                           (
                           2
                           k
                           −
                           t
                           )
                           ×
                           |
                           I
                           |
                           )
                           /
                           
                              
                                 k
                              
                              
                                 2
                              
                           
                        . Although this simple approach (adding dummy pixels) can solve the problem a) and achieve the same shadow size. However, both schemes still need recording the locations of sub-shadows and dummy pixels, and extra extraction operations to get sub-shadows for reconstruction.

All shadows of Thien and Lin's scheme have the same importance. Thus, any k shadows can be used for recovering the secret. For Li et al.'s [24] ESIS scheme and Yang et al.'s [25] ESIS scheme, any k shadows (including t essential shadows) are required for reconstruction. In Li et al.'s [24] ESIS schemes, essential shadows are used to recover several sub-shadows in 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 1
                              
                           
                           −
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                              
                           
                        , while non-essential shadows are used to recover several sub-shadows in 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                                 +
                                 k
                                 −
                                 t
                              
                           
                        . Afterwards, with k or more sub-shadows in 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 1
                              
                           
                           −
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                                 +
                                 k
                                 −
                                 t
                              
                           
                        , the permuted image can be recovered from 
                           (
                           k
                           ,
                           s
                           +
                           k
                           −
                           t
                           )
                        -SIS scheme. Similar to Li et al.'s [24] ESIS scheme, Yang et al.'s [25] ESIS scheme and the proposed ESIS scheme should deal with essential shadow and non-essential shadows for reconstruction. In Li et al.'s [24] ESIS scheme and Yang et al.'s [25] ESIS scheme, since 
                           
                              SE
                           
                           ≠
                           
                              SN
                           
                        , the involved participants can be differentiated between essential and non-essential by the shadow size. Thus, in reconstruction, the involved participants can easily check whether they constitute a qualified set. However, the proposed ESIS scheme has the same size of essential shadow and non-essential shadow. Thus, participants cannot know the statuses of other participants from the shadow size. Therefore, in the proposed ESIS scheme, the dealer should inform all insiders (n participants) of the statuses of all participants. This does not compromise the privacy of personal information if only outsiders do not know the statuses of all participants.

Two previous schemes [24,25] and the proposed scheme are all ESIS schemes. Li et al.'s [24] scheme use conventional 
                           (
                           k
                           ,
                           n
                           )
                        -SIS scheme and scalable SIS scheme to generate shadows. Yang et al.'s [25] scheme use two SIS scheme in a two-layer hierarchical structure. Both schemes in [24,25] use polynomials to generate sub-shadows with different sizes, and then concatenate sub-shadows to get final shadows. However, our scheme is based on derivative polynomial. The essential shadows are generated by original polynomial, while the non-essential shadows are generated by the derivative polynomial. Our scheme can get all shadows with the same size and no concatenation operation is need in generating shadows. Although schemes in [24,25] can get smaller shadow size, they cannot achieve equal size of all shadows.

The proposed ESIS can be considered as a special case of hierarchical SIS with two levels [25], and they all employ differential polynomial to share secret image. The major different is that the proposed ESIS only embed secret pixels into partial coefficients of polynomial, while hierarchical SIS schemes [28,29] embed secret pixels into all coefficients. From the viewpoint of secret sharing, in hierarchical SIS schemes [28,29], the participants with low level may decode partial secret pixels without satisfying the security condition. Therefore, hierarchical SIS schemes have security problem. Although Pakniat et al.'s scheme [29] employs cellular automata to enhance the security, it is not guaranteed by the secret image sharing. However, the proposed ESIS scheme do not have this security problem. In addition, the previous hierarchical SIS schemes [28,29] focused on secret sharing and steganography. However, in this paper, we only consider the secret image sharing with essentiality.

@&#CONCLUSION@&#

In this paper, we discuss two critical problems: unequal size of shadows and concatenation of sub-shadows in previous 
                        (
                        t
                        ,
                        s
                        ,
                        k
                        ,
                        n
                        )
                     -ESIS schemes [24,25]. The first problem may bring about security vulnerability and the second problem makes the reconstruction more difficult. Based on differential polynomial and Birkhoff interpolation, we propose a 
                        (
                        t
                        ,
                        s
                        ,
                        k
                        ,
                        n
                        )
                     -ESIS to obtain essential shadow and non-essential shadow with the same size. Each shadow is generated by a single polynomial, and no concatenation operation is needed. Therefore, our scheme can simultaneously solve these two critical problems in [24,25]. Additionally, we theoretically prove that the proposed 
                        (
                        t
                        ,
                        s
                        ,
                        k
                        ,
                        n
                        )
                     -ESIS scheme satisfies the threshold condition and the essentiality condition. The experimental results also show the feasibility of our scheme.

@&#ACKNOWLEDGEMENTS@&#

This work was partially supported by Ministry of Science and Technology, under Grants 102-2221-E-259-009-MY2 and 103-2221-E-259-015, and the Natural Science Funds of Hebei (Grant No. F2015502014). Thanks for the anonymous reviewers' constructive comments and suggestions.

@&#REFERENCES@&#

