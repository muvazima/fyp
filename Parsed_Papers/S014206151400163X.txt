@&#MAIN-TITLE@&#An integrated simulation model for analysing electricity and gas systems

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           In this paper electricity and gas interdependencies are analysed.


                        
                        
                           
                           An integrated simulation model for electricity and gas systems is introduced.


                        
                        
                           
                           The proposed model is used for analysing the impacts of significant failures.


                        
                        
                           
                           Results show that proposed integrated simulation model is effective and efficient.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Electricity transmission network

Gas transmission network

Integrated modelling

Simulation model

@&#ABSTRACT@&#


               
               
                  This paper aims at analysing the impacts of interdependencies between electricity and natural gas systems in terms of security of energy supply. When analysing both systems several interdependencies can be observed, however, the most significant interdependencies are as follows: (1) gas dependency of gas fired power plants in electricity system and (2) electric dependency of electric-driven compressors in gas system. Since both systems depend on each other, it is of major interest from an energy security perspective to investigate how failures triggered in either of the systems propagate from one system to the other. We proposed an integrated simulation model that aims at reflecting the dynamics of the systems in case of disruptions and takes the cascading effects of these disruptions into account. While developing the integrated model, first electricity and gas systems are modelled separately and then linked by an (MATLAB-based) interface. The effectiveness of the proposed model is investigated using characteristic disruption scenarios. Computational results demonstrate that the integrated simulation model is very user-friendly and quite effective and efficient in analysing the interactions between electricity and gas systems.
               
            

@&#INTRODUCTION@&#

Critical energy infrastructures (CEIs) including electricity, natural gas and oil systems, provide fuel that is essential for the continuous and reliable functioning of national or regional security, economic operations, public health and safety. The disruption or loss of functionality of these infrastructures would have weakening impact on the defense and economic security and quality of life. CEI systems are not isolated but increasingly interconnected and interdependent with the development of modern technology. For instance reliable electricity supply is a necessity throughout the natural gas system in order to maintain the normal operation while natural gas delivery is a requirement to generate electricity in gas fired power plants (GFPPs). Higher interdependencies between CEI systems make the entire energy system more vulnerable than ever since a disruption occurring in one system (e.g. an unexpected failure) has consequences on the other dependent systems and possibly even back to the system where the disruption originated. These tight relations are increasing the potential risk for catastrophic events, triggered by cascading effects of intentional and unintentional types of disruptions. The growing importance of this risk is also realized by the governments and they focused on strengthening the national energy policy framework to provide sustainable energy supply with affordable services [1]. Several organizations have published reports providing key inputs into the development of energy policies [2–5]. The main aim of National Energy Security Assessment (NESA) analysis is to identify the key energy security issues. This takes the main factors challenging the adequate, reliable and competitive delivery of energy in each of the liquid fuels, natural gas and electricity sectors into consideration. European commission initiatives such as “Green Paper on A European Programme for Critical Infrastructure Protection/2005” [3] and “Council Directive 114/2008 on the Identification and Designation of European Critical Infrastructures and the Assessment of the Need to Improve Their Protection” [5] issued the identification of CEIs, analysing their interdependencies and improving the protection policies. Moreover recent studies in the energy security literature focused on introducing new approaches and trends on energy security to deal with its increased complex and multi-dimensioned nature [6–9]. In [6], the authors highlighted the need for focusing the entire energy system and developing an integrated approach in solving energy security challenges. The knowledge required for energy security is presented through three distinct perspectives derived from political and natural science, engineering, economics, and systems analysis. The first perspective, sovereignty mainly deals with strategic security, international relations and political science while the second perspective robustness, deals with physical vulnerabilities of dynamic, integrated energy systems and includes the concepts of engineering and natural science. The last perspective resilience, which originated from economics and complexity science, is based on increasing the withstanding ability of the energy system from various disruptions and protecting the system against threats by long term investments and technologies.

Electricity and gas are two important CEI systems and they both rely on networks operating at transmission (high current electricity grids or high pressure gas networks, respectively) and distribution level (low current electricity grids or low pressure gas networks, respectively) to deliver energy from generation points (electric power plants/gas wells) to end consumers. Traditionally, the operations and evaluation of both systems are handled separately; however electricity and gas systems are interdependent and each system has significant impacts on the performance and efficiency of each other. Gas system network consists of different components that depend on electrical power in order to operate the network (electric driven compressors, underground gas storage facilities, key valves, regulators, drilling rigs, etc.). Moreover, the usage of electric driven compressors is increasing due to lower installation and maintenance costs. In addition many regions require emission standards that oblige the use of electric driven compressors [10]. On the other hand electricity networks utilize gas as a safe and secure fossil fuel mainly due to its environmental friendliness and global occurrence. Shale gas production has already had a significant impact on the deployment of new infrastructures, especially in USA, where the installed capacity of GFPP has dramatically increased during the last years and is expected to continue increasing in the coming years, which has obviously increased the dependency of the electricity system on the gas system [11]. This could also be the case in other regions of the world, including Europe, especially under scenarios of abundant cheap shale gas and low carbon policies. Moreover, modern GFPPs can be also used flexibly, in most cases as a backup for intermittent renewable energy sources, mainly wind and solar energy. Current plans for an increased installation of renewable energy sources will further increase the role of gas as a backup for electricity generation. Because of the close interactions between electricity and gas systems, analysing the systems independently may not provide adequate information to ensure the proper functioning of the energy supply system. Besides, it is a quite insufficient approach in today’s world since the continuity of energy supply has become a major concern for most of the countries.

In this paper we aim at analysing the interdependent electricity and gas system network behaviours in terms of cascading failure effects from one system into another in the context of energy security. The consequences are investigated when the electricity or gas system has just experienced a disruption, like failure of a pipeline or a transmission line. According to the classifications in [6], this paper deals with robustness and resilience perspectives of energy security since it considers the technical failures of the components and evaluates the resilience of the entire system under these failure scenarios. An efficient and flexible modelling tool which considers bi-directional interactions is introduced and as far as the known literature, there is no work published on analysing the two systems in such a detail and aspects. Two types of basic dependencies are considered; (a) dependency of gas fired power plants (GFPP) in electricity network system on natural gas supply, and (b) dependency of electric driven compressors in gas network system on electricity supply. The modelling of interdependencies and their effects on failure propagation is carried out within the simulation framework of a failure cascade process. The developed integrated simulation model incorporates AC power flow model and a complete hydraulic gas model to represent real world applications accurately. Moreover, since the dynamics in a gas system network is slower than that observed in the electricity, the simulation time steps are considered to be different. Later on, the effectiveness of the proposed model is investigated under different disruption scenarios. The results of the simulations are used to identify the system’s contributions to cascading failures and feedback mechanisms among the systems. The results proof that analysing systems in an integrated manner provide a good knowledge on the vulnerabilities of the interdependent electricity and gas system, which could not be detected by analysing the systems individually.

The paper proceeds as follows: literature review is given in Section ‘Literature review’, the proposed integrated simulation model for the gas and electricity systems is described in Section ‘Proposed integrated simulation model’; computational analysis on test problems are discussed in Section ‘Computational results’ and conclusions are given in Section ‘Conclusions’.

@&#LITERATURE REVIEW@&#

While extensive research that considers the systems individually can be found in literature, an integrated analysis of electricity and gas systems is rare. Identifying the limitations of one system as a result of changes in the other has recently become an active research area, since it is the responsibility of the decision makers to ensure the system operability and resilience in case of disruptions in the systems. The research in integrated analysis of electricity and gas systems can be classified in terms of technical, economic and security aspects. Comprehensive reviews of the approaches can be found in [12–14].

In [13], authors classify the research on integrated electricity and gas systems in terms of various economic and technical perspectives. The first approach is essentially based on economic evaluations aiming at exploring the interactions between the mechanisms of pricing of each carrier. This can be achieved by means of economic models, where the influence of technical constraints is often ignored or taken into account in a simplified way. In this field, an important effort has been devoted to clearing price mechanisms for coupled gas and electricity markets, especially at a trans-national level [15–18]. Other works are related to the developing of procedures for optimizing different time scales of natural gas portfolio of an electric generation company owning gas-fired power plants under stochastic price scenarios [19–21]. Additionally in [22,23] market models have been proposed for analysing the behaviour that a single subject would take as a player in the two markets, where it may be a buyer of gas and an electricity producer. Network pricing of gas and electricity is defined as a key element for placing new generation plants in [24].

The technical analysis of integrated electricity and gas systems generally focuses on operational planning and the models can be classified according to the considered time horizons as; medium-term, short-term and snapshot models. While medium-term scales range from one month to a year and short-term applications deal with hours and days, snapshot models consider a single system configuration for operation planning. A generalized network flow model is proposed in [25] for integrated analysis of electricity, gas and coal systems for a multi-period analysis. The simulation studies of the network flow model in [25] are given in [26] for a configuration of the U.S.A. energy system with medium term operational optimization. A complete gas model and a DC power flow model are used for integrated analysis in [27] where gas storage is also considered. The methodology links the two systems through gas fired power plants and aims at minimizing the total operating costs for a monthly base, including the load shedding. For short term operation planning, a security constrained unit commitment (SCUC) of power generation plants considering natural gas prices is presented in [28] and the extension of the model by including natural gas contract costs is proposed in [29]. Additionally, the gas network constraints are incorporated as a network flow model and dual fuel units are modelled for analysing different fuel availability scenarios. In [30], the SCUC problem in [29] is considered using a more detailed gas model in which gas flow in pipelines is described through a quadratic function of pressure and the gas consumption of the compressors are also included. The transient analysis of gas flows is modelled in [31] for the unit commitment problem and steady state and transient models of gas system are compared.

Power flow optimization models are developed for a snapshot configuration of the integrated electricity and gas systems to analyse the combined network behaviour in detail [32–34].

The security perspective including the reliability and the adequacy of gas and electricity networks, along with the mutual influence of these aspects in combined studies is another important field of investigation. Such studies may include the effect of contingencies or events that reduce the performance of related networks [35–38]. The approach of “energy hub” for multiple energy carrier systems can help to analyse some of these aspects with different time scales and sizes [39–42]. An energy hub is a multi-generation system where multiple energy carriers input to the hub are converted, conditioned, stored and distributed by using several technologies. Particularly the conversion process is modelled through a matrix of coupling factors between input and output power [43].

Most of the works in the literature dealing with the interactions between electricity and gas systems are considering only the gas dependency of the electricity system. The electric dependency of gas systems are not studied enough. We believe this is because a large number of components in the gas transmission network use gas from pipelines as a power source and this make the system less dependent on electricity. However, the increasing number of electricity dependent components makes the gas system vulnerable to a disruption in the connected electricity grid. Recently some researchers have considered bi-directional dependencies of these systems [10,44–47]. In [44], a methodological approach to analyse structural and functional vulnerabilities of interdependent gas and electricity system is introduced. Different from our study the authors used simplified models for both systems; DC power flow model for electric systems which ignores voltage fluctuations during cascading effects of failures and a simplified gas model based on dynamic approach.

A tabulated summary of the relevant studies in the literature for integrated electricity and gas network systems is presented in Table 1
                     , which shows the scope of the analysis and modelling approach for interdependency effects. It should be noted that some studies appear in different cells of the table as they include more than one aspect. As regards to scope of the study, different perspectives described in the first paragraph of this section are as follows; economic perspective, technical perspective and security perspective. Technical perspectives are classified according to the time scale considered in the scope of the study: medium-term, short-term, and snapshot models. In terms of interdependency effects modelling, the four general categories provided in [48] are used: (1) agent-based, (2) economics theory, (3) network-based, and (4) empirical modelling approaches. In agent-based approaches, infrastructures are modelled as complex adaptive systems composed of agents interacting with both its environment and other agents of the infrastructure. The agent makes behaviour decisions based on a set of rules to represent the real world occupant. The second approach economics theory, mainly through the input–output modelling, has been used to analyse risk dependencies among different interdependent infrastructures. Network-based approach uses graph theory to exploit the network structure of infrastructures, where nodes represent the different components of the infrastructure and the edges represent the physical links between components. Network-based models can be classified as topological and functional according to the detail used to mimic the infrastructure. While the topological models consider only the topological description of the infrastructures the functional models deal with flow patterns and mathematical modelling of the interdependencies. Finally, empirical approach uses the outcomes of historical data and expert experiences to analyse the properties of infrastructures interdependencies.

According to Table 1, the integrated simulation model presented in this work, symbolized as ISM, deals with the security perspective and the modelling strategy of the interdependency effects falls in the functional network based approach. Different from our study the other models in this group ([35,36,38]) are mainly based on the operational planning of systems in case of contingencies and they do not analyse the system vulnerabilities in the context of cascading failure effects. Moreover, they consider only one system dependency on the other one, and the bi-directional dependencies are still in need of further research whereas this gap is addressed within this paper.

The modelling development carried out in this paper considers interdependent electricity and gas transmission systems networks. The interdependencies taken into account are gas usage of GFPP’s and power needs of compressors. The model architecture is based on an integrated simulation tool and is composed of (a) an electricity simulation tool based upon AC power flow model including failure effects analysis functions, (b) a gas simulation tool based on a hydraulic model using detailed physics of pipe and non-pipe elements that includes failure effects analysis functions, and (c) the interface module enabling data exchange between two individual simulation models by means of physical equations.

In order to develop the integrated simulation model, the definition of programming environment and the selection of correct tools and methods are essential. During the literature survey many software tools for electricity and gas that can be used to analyse both systems separately were found. However, there was no available software package that could run the two models with this detail together, which required a new solution and methodology to be applied within the scope of the work. Additionally, in order to perform a technical, realistic and reliable analysis, the models should be flexible for modifications and enable easy data importing/exporting.

In the scope of the above mentioned requirements, we modelled the electricity and gas systems using MATLAB based programs, which provide seamless integration of the separate models into a final integrated one. This approach is shown in Fig. 1
                     .

The “Electricity Model” uses AC power flow available in the MATLAB based “MATPOWER toolbox” for solving power flow equations. In parallel, the gas model uses a MATLAB based developed hydraulic model for pipeline flow equations. The schematics also depict the interactions between separate models and also include the inputs and outputs of each individual model. The failure effect analysis is also embedded in the integrated model within MATLAB.

Prior to identifying the proposed integrated simulation model, details of the individual models for electricity and gas systems are presented in the following sections.

Electricity systems are composed of three main subsystems; generation units, transmission and distribution networks, respectively. Generation units are responsible for the production of power. The generated power is then delivered to end consumers via transmission and distribution networks. Transmission networks transport high voltage power to distribution substations and distribution networks supply the low voltage energy to end users. This work will mainly focus on transmission network applications.

In a transmission network, power flows through different buses and lines connecting these buses. A bus is used to represent generation units and loads, whereas lines are defined as transmission lines. Power flow studies in such a network will provide solutions for the voltage at each bus of the network, active and reactive power flows through transmission lines, and power injections of generation units and loads under steady state conditions. Power flow analysis is also very important in addressing the operating conditions of the network. It will help the system operator to determine voltage violations on buses and overloading levels on transmission lines which can be observed in case of failures.

The electricity model developed in this work is designed to provide a realistic representation of the behaviour of a power system when a failure occurs in transmission lines in terms of cascading failure effects. Analysing cascading failures is very challenging due to large number of unexpected sequence of failures depending on the initial failure. To overcome this challenge serious of cascading failure models have been developed [49,50]. These models can be either network topology based or can include the power flows. In [51] the authors compared a power flow model with a complex network based model.

In this paper a power flow based failure cascading model including series of failure propagation functions is implemented. For example, bus isolation, overloading control and reloading functions have been implemented under failure effect analysis.

The flowchart of the developed electricity model with failure affect analysis is given in Fig. 2
                         and details of the processes are explained simultaneously.

As shown in Fig. 2, the system is initialized with an input data set which gives detailed information on characteristics and constraints related to buses (including loads and/or generation units) and transmission lines. In our implementation the readily available input data for IEEE 30 bus test case has been used. The details of this test case will be provided in computational results section.

Starting from normal operation up to the failure operation state, the system is drawn by some random failures. The initialization failures in electricity systems are considered only on transmission lines as they can often be encountered in real life applications. Transmission lines in power systems are highly vulnerable even to small failure events because they expand a large geographical area and they highly exposure to environment [9]. In the context of the proposed model generation unit failures can occur during the cascading effects of the initial failures. Detailed classification of threats in power systems can be found in [9].

For addressing the electricity transmission through the network the AC or DC power flow model can be used. DC power flow method simplifies the non-linear power flow problem to set of linear equations by making series of approximations, such as; ignoring node voltages and reactive power balance. However, voltage profile of buses and reactive power have significant impacts on the system conditions when perturbed by failure events and disregarding their effects may provide too optimistic results and could threaten the operation security [52]. While the DC power provides good and fast estimations of power flow equations it may be too optimistic regarding the impact of the system especially if the system is constrained by reactive generation limits and voltage limits. In this paper AC power flow method is adopted for evaluating the system behaviour under cascading failure effects. This level of detail is required since the system is constrained by voltage limits. The AC power flow model calculations have been implemented using MATPOWER 4.1., which is a free package of MATLAB m-files used for solving power flow and optimal power flow problems. For solving the AC power flow equations MATPOWER presents three solvers. The default power flow solver is based on a standard Newton’s Method [53] using a full Jacobian that is updated at each iteration. The other two power flow solvers are variations of the fast-decoupled method [54].

An important point here is that, most of the power flow solvers do not have the capability to identify disconnections, which occur during the failure of one or usually more transmission lines. In addition, similar to other solvers, MATPOWER does not check the topology before solving the equations, and if there are disconnections in the network, the model will not converge. To overcome this problem, a topological checking function is developed and before every run of AC power flow, it is run a priori, as the failures can lead to some disconnections in the network. The topological checking function is based on well-known spanning tree problem in the literature.

Given a connected graph, a spanning tree of that graph is a subgraph, which is a tree and connects all the vertices together. From a practical point of view, this algorithm has important applications in transportation, communications, distribution systems, etc. For a summary of its properties and algorithms for its solution, see Papadimitriou and Steiglitz [55]. In this work, the spanning tree algorithm is solved to identify the unconnected buses. An unconnected bus is excluded from the power flow equations. The algorithm for the topological checking is presented below;
                              
                                 
                                    
                                    
                                       
                                          
                                             Topological Checking Algorithm
                                          
                                       
                                       
                                          Let G
                                             =(V,
                                             E) be a connected, undirected graph with a real-valued weight function w defined on E. Let A be a subset of E that is included in some spanning tree for G, let (S,
                                             V
                                             −
                                             S) be any cut of G and (u,
                                             v) be an edge crossing the cut (S,
                                             V
                                             −
                                             S),
                                       
                                       
                                          
                                             
                                          
                                       
                                       
                                          
                                             Step1. Choose the root node r; Set S
                                             ={r} and A
                                             =∅.
                                       
                                       
                                          
                                             Step2. Find the minimum weighted edge such that one end point is in S and the other end point is in 
                                                
                                                   V
                                                   ⧹
                                                   S
                                                
                                             . Add this edge to A and its endpoint to S.
                                       
                                       
                                          
                                             Step3. If 
                                                
                                                   V
                                                   ⧹
                                                   S
                                                   =
                                                   ∅
                                                
                                             , then stop and output spanning tree (S,
                                             A). Otherwise go to Step 2.
                                       
                                    
                                 
                              
                           
                        

In case of failure analysis the cascading effects of these failures should also be considered. If the system has enough resilience for handling the initial failures, there will be no cascading effects and we can say that the system is preserving its normal operational conditions. However, the failure(s) can result in different situations (i.e. bus isolation, voltage or capacity violations). These are the cascading effects of the failures and all of them are handled in the model to reflect the real life applications.

For addressing the cascading effects, firstly, the capacity limitations of the transmission lines are checked and if the amount of power flow through that line exceeds the value of an upper limit (capacity×tolerance parameter (α)) the line is classified as failed element and is removed. This is defined as “overloading analysis” function. The removal of the lines can easily lead to voltage collapses. Therefore the voltage level of each bus is checked within the “voltage analysis” function since all buses have to satisfy a voltage profile. When the voltage level of a bus is violated, the load of the corresponding bus is reduced until the voltage constraint is satisfied. During this reduction process, if the amount of load is decreased more than 50% of its original load, then the node is assumed to be failed and the load value of the bus is set to “0”. This is called the “reloading” function and the algorithm for the reloading function is presented below:
                              
                                 
                                    
                                    
                                       
                                          
                                             Reloading Algorithm
                                          
                                       
                                       
                                          Let n be number of buses in the network and Vi and 
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         min
                                                      
                                                   
                                                
                                              is the nodal voltage and minimum nodal voltage level for the bus i respectively. Let CN is the critical nodes set, and Lop and Li
                                              are operational and real load levels for bus i, and finally let rp is the reduction percentage of the load,
                                       
                                       
                                          
                                             
                                          
                                       
                                       
                                          
                                             Step1. For i
                                             =1 to n, if 
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   <
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         min
                                                      
                                                   
                                                
                                              then, i
                                             ∊
                                             CN
                                          
                                       
                                       
                                          
                                             Step2. While CN
                                             =∅,
                                       
                                       
                                          
                                             
                                             
                                             
                                             for i
                                             =1 to n, Li
                                             
                                             =
                                             Li
                                             
                                             *
                                             rp
                                          
                                       
                                       
                                          
                                             
                                             
                                             
                                             if Li
                                             
                                             <
                                             Lop
                                             
                                             *0.50 then Li
                                             
                                             =0,
                                       
                                       
                                          
                                             
                                             
                                             
                                             run Power Flow
                                       
                                       
                                          
                                             Step3. Stop the algorithm
                                       
                                    
                                 
                              
                           
                        

As this work aims at analysing failures within the short interval of time, buses and transmission lines of the electricity network are considered to shut down irreversibly (i.e. once they are switched off during the simulation of a cascading failure (due to a failure being propagated) they are assumed to be failed for the remaining period of the simulation and the transition between simulation steps is assumed to be static). The AC failure model runs until the system goes into steady-state or in some cases if the system cannot reach a steady state then we can say that it has totally failed. The efficiency of the network is used as a performance measure, which is defined as the ratio of the total loading at the final stage to the initial amount of total loading.

In most of the natural gas systems, the geographical location of the gas deposit and the location where it is needed are many kilometres apart [56]. Therefore, there is a necessity to transport natural gas from its deposit and production site to its consumers, either by trucks and ships in the form of Liquefied Natural Gas (LNG) or through gas pipeline transmission networks.

Gas networks are generally distinguished according to their function and pressure levels in gas transmission and gas distribution networks. Gas transmission networks are high pressure networks and serve the purpose of transporting gas thousands of kilometres from its deposit and production site to locations where gas is needed for consumption or storage. Gas distribution networks, in contrast, are low pressure networks and in most cases directly connected to the gas transmission grid. Their function is to distribute natural gas coming from the transmission grid to end consumers, e.g. households, industries, etc. The scope of this work is mainly on gas transmission networks.

The transmission of gas through pipelines requires a certain pressure gradient. Due to friction between the transported gas and the inner walls of the pipelines and also heat transfer between the pipeline and its surroundings, the pressure and enthalpy of the gas drops significantly along the pipeline in flow direction. These pressure and enthalpy losses are compensated by compressor stations, whose function is to increase the pressure and enthalpy of the gas. Compressor stations can be either gas-driven or electric-driven. A failure in a compressor station, for instance due to lack of electric power, can cause a gas delivery pressure below the minimum delivery pressure or even a total loss of deliverability to end consumers. In addition, other facilities like regulators and valves are utilized to control and regulate the gas flow in the network. A gas transmission network, thus, consist of several different components which need to be considered when developing a numerical model of the network.

The gas model developed in this work is used for analysing the impact of failures on flows and pressures in the gas system network. The flowchart of the gas model with failure effect analysis is shown in Fig. 3
                         and the details of the functions are described in following.

The gas model starts with initial input data related to network components. The components of the gas system under study are nodes, pipelines and compressors. Nodes can have different purposes depending on their locations and connections with incident pipes. Each node i has a corresponding load Li
                        , which if positive is equal to the amount of gas extracted from the network or if negative, the amount of gas injected, respectively.

Similar to the electricity model initial failures in the gas model are simulated randomly on pipelines. As the developed gas model will be used in integrated analysis of gas and electricity the cascading effects of failures in the gas system are considered according to the time horizon in which electricity network is modelled. Therefore cascading pipeline failures as a result of overloading are neglected since a contingency on the gas system slightly affects the short-term transients. In case of an initial failure the pressure limitations can be violated and to overcome this problem same “reloading” algorithm in the electricity model is implemented. For the nodes which have pressures below the prespecified value the amount of loads are reduced until the pressures are all satisfied. If the new load value is below 50% of the initial load then the node is closed. An important assumption which would affect the results of the gas model is the direction of gas in the pipelines. In this paper all pipelines have been modelled as bidirectional. In case of failures, uni-directionality would most likely led to worse results in performance measures because of loss of flexibility in the gas model.

The equations describing the flow rate in pipelines at steady state are diverse, mainly due to difficulty in quantifying the effects of friction [57]. However, all equations have a common origin which is Bernoulli’s equation. The flow equations applied in the industry are very often in the following generalised form:
                           
                              (1)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       k
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             
                                                
                                                   p
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where Qk
                         is the flow rate in branch k, p
                        1 and p
                        2 the nodal pressures at the in- and outlet node of branch k, respectively, and Kk
                         the flow constant which depends on pipe and gas properties (e.g. pipe length and diameter, friction factor, gas compressibility, etc.). The flow exponent m
                        1 is between m
                        1
                        =1.848 and m
                        1
                        =2, depending on the pressure level of the network.

The pipe equation gives a solution for the flow rate in each individual pipe k for a given square 
                           
                              Δ
                              
                                 
                                    P
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    p
                                 
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              -
                              
                                 
                                    p
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                           
                        . However, additional equations a necessary in order to find a steady state solution for the entire network. These equations are derived from Kirchhof’s first law:
                           
                              (2)
                              
                                 
                                    
                                       L
                                    
                                    
                                       →
                                    
                                 
                                 =
                                 A
                                 ·
                                 
                                    
                                       Q
                                    
                                    
                                       →
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    L
                                 
                                 
                                    →
                                 
                              
                           
                         is the vector of nodal loads, A is the branch-nodal incidence matrix and 
                           
                              
                                 
                                    Q
                                 
                                 
                                    →
                                 
                              
                           
                         the vector of pipe flows. The previous explanations are mainly based on networks without non-pipe facilities like compressors, regulators or valves. However, for a more realistic analysis of the problem these facilities need to be integrated into the model. The following correlation between the nodal loads at the inlet (Lin
                        ) and outlet (Lout
                        ), and the flow through each non-pipe facility (f) is assumed:
                           
                              (3)
                              
                                 f
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       in
                                    
                                 
                                 =
                                 -
                                 
                                    
                                       L
                                    
                                    
                                       out
                                    
                                 
                              
                           
                        
                     

The integration of non-pipe facilities leads to a slight modification of Eq. (2). Taking Eq. (3) and the following relations
                           
                              (4)
                              
                                 Δ
                                 
                                    
                                       P
                                    
                                    
                                       →
                                    
                                 
                                 =
                                 -
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                                 ·
                                 
                                    
                                       P
                                    
                                    
                                       →
                                    
                                 
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       k
                                    
                                 
                                 ·
                                 |
                                 
                                    
                                       Q
                                    
                                    
                                       →
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             1
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 ·
                                 
                                    
                                       Q
                                    
                                    
                                       →
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 ∧
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       k
                                    
                                 
                                 ·
                                 |
                                 
                                    
                                       Q
                                    
                                    
                                       →
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             1
                                          
                                       
                                       -
                                       1
                                    
                                 
                              
                           
                        into account Eq. (5) is modified to
                           
                              (6)
                              
                                 A
                                 
                                    
                                       ∧
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                                 ·
                                 
                                    
                                       P
                                    
                                    
                                       →
                                    
                                 
                                 =
                                 -
                                 
                                    
                                       L
                                    
                                    
                                       →
                                    
                                 
                                 -
                                 K
                                 ·
                                 
                                    
                                       f
                                    
                                    
                                       →
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    P
                                 
                                 
                                    →
                                 
                              
                           
                         marks the vector of nodal square pressures, K the node unit-incidence matrix and 
                           
                              
                                 
                                    f
                                 
                                 
                                    →
                                 
                              
                           
                        , the vector of flows through each non-pipe facility and the nodal loads at each source node. The introduction of unit flows f is connected to an imbalance of equations and unknowns, which makes the entire problem infeasible. In order to balance the system one additional independent equation for each added non-pipe facility is inevitable. One way of achieving these equations is to assume a linear correlation between the nodal square pressures at the in-and outlet Pin
                         and Pout
                         respectively, and the gas flow rate f through each unit in the following form:
                           
                              (7)
                              
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 ·
                                 
                                    
                                       P
                                    
                                    
                                       in
                                    
                                 
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 ·
                                 
                                    
                                       P
                                    
                                    
                                       out
                                    
                                 
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       3
                                    
                                 
                                 ·
                                 f
                                 =
                                 d
                              
                           
                        where C
                        1, C
                        2, C
                        3 and d are constant coefficients of the respective variables. Thus, this is a linearization of the non-linear equations describing the physics of each non-pipe facility. Having developed the linearized equation system for non-pipe facilities the governing equation system describing the steady state of a gas transmission network with non-pipe facilities is as follows:
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               G
                                                            
                                                            
                                                               ^
                                                            
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         O
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         →
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         →
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    G
                                 
                                 
                                    N
                                 
                              
                              ,
                              
                                 
                                    G
                                 
                                 
                                    ^
                                 
                              
                           
                         and 
                           
                              
                                 
                                    G
                                 
                                 
                                    ̇
                                 
                              
                           
                         are matrices derived from the decomposition of matrix G:
                           
                              (9)
                              
                                 G
                                 =
                                 A
                                 
                                    
                                       ∧
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               G
                                                            
                                                            
                                                               ^
                                                            
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The equation system describing the steady state of gas transmission networks Eq. (8) is non-linear, and therefore unsolvable in an analytical manner. However, a solution with a marginal and acceptable deviation from the exact solution can be obtained by applying iterative methods such as the Newton-Methods. One of these is the Newton-Loop-Node Method, which is used in this paper to solve the system of equations. The first step in this method is the preconditioning of the system, meaning finding accurate initial approximations for the branch flows Qk
                        . This is obtained by the dendrite method which is based on the Breadth First Search (BFS) algorithm [57], and the assumption that all nodal loads in the dendrite are supplied by the nodes with a known pressure (mainly source and auxiliary nodes), which are also referred to as reference nodes. The BFS transfers the original network to a tree (dendrite) which in contrast to the original network is without any loops, and includes all nodes, but not all branches (branches not included in the dendrite are called chords) of the original network. The root(s) of the resulting dendrite coincides with the reference nodes. The first step after the preconditioning is to calculate the resulting loads Lin
                         and Lout
                         for each unit followed by solving the linear equation (Eq. (8)) for the square pressures 
                           
                              
                                 
                                    P
                                 
                                 
                                    →
                                 
                              
                           
                         and unit flows f using Cholesky’s method by substituting the matrix GN
                         from Eq. (8) with the lower L and upper U Cholesky matrices. The solution is then used to calculate a correction to the chord flows ΔQc
                         which is in turn used to calculate new pipe flow Qk
                        
                        +1. The last step is to calculate the errors and compare it against a specified tolerance. If the errors are less than the tolerance then an acceptable solution is obtained and the computation is stopped, otherwise the computation continues with the next iterations until an acceptable solution is achieved. The iteration is aborted if the iteration errors show a diverging character or if the errors are still greater than the tolerance after a specified number of iterations. The details of the method can be found in [57]. The method is implemented in MATLAB.

After modelling the two systems separately, the next step is to integrate them with an interface based on dependencies. As mentioned in the previous sections the interactions are defined as two-sided. The electricity network has different type of generation units and some of them are gas fired power plants (GFPPs) and the compressors in the gas network are assumed as electric-driven and need external power input to operate. The flowchart of the integrated model for one simulation time is given in Fig. 4
                        .

In order to analyse the effectiveness of the integrated model and the interactions between gas and electricity systems the following test cases are selected. The well-known IEEE 30 bus case is used for the electricity system whereas the gas network is taken from [57], whose size and complexity is at the level of a transmission grid of a medium-sized European country (e.g. Spain and Poland). The topological representations of the test cases are presented below (Figs. 5 and 6
                        
                        ). The input data for the test cases can be found in [58,57] respectively.

In order to determine if failures in either of the electricity or gas system have an effect on the other, random failure scenarios are implemented on either system, after which the result of the model is analysed. The dependent components between two networks are identified before conducting the analyses.

The assumptions for dependency assignments between two networks are given below;
                        
                           –
                           The electricity network is composed of 30 buses and 41 transmission lines. Among these 30 buses, 6 of them are generation units which serves 21 load nodes. As an initial scenario, 5 of 6 generation units are selected as GFPP and the total production capacity of the GFPP’s are set to 70% of the total generation capacity of the system. Gas consumptions of GFPP’s are related to power production by a linear coefficient.

The gas network is composed of 22 nodes and 35 pipelines. 18 of the nodes are load nodes and there is only one source node. There are 3 compressor stations and 3 of them are assumed as electric-driven. For simplicity the ratio of the compressor stations are calculated by a linear function of the power input.

Following the above assumptions several simulations of the integrated model for failure analyses has been conducted. Fig. 7
                      shows the resulting total loadings of the systems in case of failures at transmission lines 2–6 and 5–7.

The remarks below can be extracted following the analysis of the above scenario;

In order to determine the exact reasons for cascading effects of the failures, the electricity model is run independently with the same failure scenario and the results obtained are provided in Fig. 8
                     .


                     Fig. 8 shows that the integrated model and the independent model results for electricity loadings are same. We can conclude that the integrated model analysis is only beneficial in providing us the effects on the gas network in case of an initial transmission line failure. It should be noted that this assumption holds only for this specific scenario unless further simulations are implemented.

In order to understand the results when the initial failures occur at pipelines the following analysis is presented. The gas model is run with the pipeline 3–4 and 5–7 failures scenario and results are given in Fig. 9
                     .

The gas model is also run independently with the same pipeline failure scenario and the results are presented in the graph below (Fig. 10
                     ).

The results show that the electricity system has significant cascading effects on the gas system in case of initial pipeline failures. This is an expected result, because of the slow short term dynamics of a gas system. Accordingly, the cascading effects of an initial pipeline failure within the gas system are not observed during the short term analysis.

The analysis up to now has assumed single scenarios and the results were presented accordingly. In order to make a more reliable analysis, network efficiencies under different number of transmission line/pipeline failures are calculated. Simulation results presented for the network efficiencies are the average of 50 runs of random failures for each number of removed line scenario.

In Fig. 11
                     , gas system efficiencies under different number of pipeline removal scenarios are calculated using both independent and integrated models. It can be seen that, integrated analysis is very important for the gas system since the differences are big. The reasons for these are the fast dynamics of the electricity system and the effects of these dynamics on the gas system (e.g. in the independent case, a pipeline failure will never lead to a failure of a compressor, however, the electricity system may cause a compressor failure in the integrated analysis).

The situation is not the same for the electric system as seen in Fig. 12
                     . The electric system is analysed under different number of random transmission line failures using both independent and integrated models and the results for the two models in terms of network efficiencies are very close to each other. This result is caused by the slow dynamics of the gas system and its weak effect on the electricity system. For instance, although in one simulation step, several dynamic changes occur in the electric system due to a transmission line failure, the slow changing dynamics of the gas system will not make an effect on the electric system in most cases.

@&#CONCLUSIONS@&#

This study deals with identifying the physical interactions between electricity and gas systems in short term interval. Therefore, an integrated model composed of independent gas and electricity models with failure effect analysis function is developed. The results obtained show us that analysing two systems in an integrated manner provides us very important details in terms of system vulnerability.

The proposed integrated model uses the advantages of including the detailed physics equations of both systems, since more realistic results according to simplified network models can be achieved. In order to construct the integrated model, first an electricity model is developed and this model can also be used to analyse the cascading effects of electricity system failures in short term intervals individually. The model includes topological checking and isolation, overloading and voltage collapse analysis and reloading functions together with AC power flow model. Then a hydraulic gas model with compressors is developed and the reloading function is added to the model to further enhance the model capabilities to account for the effects of failures. The last effort carried out is for combining the electricity and gas models in the same software and it is achieved using the MATLAB environment. Different time scales of the systems are also considered to reflect the real situations.

The effectiveness of the integrated model has been tested on a simplified integrated network and found that, in terms of computational requirements and quality of the solution, the model proves to be very useful. According to the results in most cases one line failures do not affect neither the system itself nor the other system. Two or more line failure effects are more visible and they can draw the systems to disruptions. Due to physical interactions a failure initially occurring in an electricity system has an effect on the gas system and vice versa. However a very important finding is related with the dynamics of the systems. This is due to the different dynamics of gas and electricity systems involved. For instance, when a failure occurs in the electricity network this will eventually have an effect on the gas system as well. However, due to the slow dynamics of gas system, the cascaded effect created from within the gas system will not be as effective as the internal effects associated within the electricity system itself. This is an important finding, as we can say that in case of pipeline failures, the gas system operator also has to consider the electricity system to identify all type of contingencies in the gas system, however, for the electricity system operator, it is not necessary to analyse both systems together in case of transmission line failures in short term.

In the next future the model presented in this paper will be applied to large scale real electricity and gas networks to address the vulnerabilities of the both systems. Moreover, it will be improved by adding restoration and repairing operations for medium time intervals to make it more realistic and account for real operational activities not into account in this first modelling approach.

@&#ACKNOWLEDGEMENTS@&#

This study is a part of research project supported by Turkish Scientific and Technical Research Council, TUBITAK BIDEB 2214-2011. We are grateful for the constructive suggestions provided by the reviewers, which improved the paper.

@&#REFERENCES@&#

