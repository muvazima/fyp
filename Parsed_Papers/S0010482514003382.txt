@&#MAIN-TITLE@&#Automatic characterization of thoracic aortic aneurysms from CT images

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We have developed an automatic method for measuring the diameter at any point along the length of the thoracic aorta.


                        
                        
                           
                           The proposed method uses principal component analysis for determining the maximum diameter of the aorta.


                        
                        
                           
                           The method developed clearly reduces the time spent by any semi-automatic commercial method available in the market.


                        
                        
                           
                           The proposed method obtains reproducible results of the aortic diameters, contrary to what happens with semi-automatic methods.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Aneurysm

Aorta

Centerline

Level set

Computed tomography

@&#ABSTRACT@&#


               
               
                  Accurate determination of the diameter is an important step for diagnosis and follow-up of aortic abnormalities such as aneurysms, caused by dilation of the vessel lumen. In this work we focus on the development of an automatic method for measuring the calibre of the thoracic aorta. The method is based on the application of principal component analysis on normal planes extracted from the aorta to establish the main axis of each section of the vessel.
                  Two experiments were performed in order to test the accuracy and the rotational invariance of the developed method. Accuracy was determined by using a database of 15 clinical cases, where our method and a commercial software, which was considered as the gold standard, were compared. For the rotational invariance check, phantom images in different orientations were obtained and the diameter was measured with the proposed method.
                  For clinical cases, a good agreement was observed between our method and the gold standard. The Bland Altman plots indicated that all of the values were within the acceptable limits of agreement with a bias of 0.2mm between both methods. For phantom cases, an ANOVA test revealed that the results achieved for the data sets acquired for the different orientations were not statistically different (F=1.88, p=0.153), which demonstrates the robustness of the method for rotations.
                  The proposed method is applicable for measuring the diameter in all tested cases, and the results achieved underscored the capability of our approach for automatic characterization of thoracic aortic aneurysms.
               
            

@&#INTRODUCTION@&#

Aneurysms are the most common pathology affecting the thoracic aorta with an incidence of 6/100.000 persons. The risk of rupture for untreated large sized aneurysm is around 74% with a 90% mortality rate [1]. Therefore, this pathology often requires surgery and is potentially a serious life-threatening disorder. An aneurysm is a permanent localized dilatation of the diameter of an artery by at least 50% of its normal diameter [2]. Thoracic aortic aneurysm disease is usually asymptomatic. In many cases, the first symptom is a serious complication such as rupture or dissection, and can end up causing death. Aneurysms of the thoracic aorta grow slowly, this growth being faster in the descending aorta (3mm/year) than in the ascending aorta (1mm/year) [3]. Surgical intervention is indicated when the diameter of the aorta exceeds maximum of 5.5cm for the ascending aorta in most patients. For patients with additional symptoms as Marfan׳s disease, bicuspid aortic valve, or a family history of aortic dissection, this value drops to 5cm. For the descending aorta, the main criterion is a bit more relaxed (5.5–6.0cm), because the adverse effects are produced in larger sizes [4]. Hence, the precise description of the thoracic aorta is crucial for the diagnosis of this type of lesion, for planning treatment [5], and for clinical follow-up.

It is assumed that the shape of the aorta is circular or elliptic [6]. The manner in which the diameter of the aorta is calculated is widely agreed by the clinical community. The details of how this diameter should be calculated are described by Rousseau et al. in a recent paper [7]. According to Rousseau, if the shape of the cross section of the lumen is elliptical or even crescent rather than circular, to get the correct size of the aorta, the mean value between the maximum and the minimum diameters has to be calculated. In this model, maximum refers to the length of the maximum diameter of the aorta and minimum to the length of the diameter that is perpendicular to such diameter maximum. As seen in this description both diameters should be perpendicular.

Computed tomography (CT) is an imaging technique that enables the diagnosis of patients with thoracic pain [8] and the reconstruction of an aortic aneurysm from any projection, providing information of high relevance for diagnostic as well as instructional purposes. For patients with allergy to iodinated contrast, images of vasculature can be acquired using MRI. However, MRI has the disadvantage of acquiring images of lower quality than those obtained with CT. This is due to the lower spatial resolution as well as the worst properties of radiopaque contrast (gadolinium) employee. In addition, acquisition times are clearly superior (30s versus 30min).

To obtain quantitative data from CT slices, a central lumen line must be drawn on the basis of which normal planes can be calculated at specific locations and measurements taken. The methods described in the literature for calculating the centerline are primarily based on two approaches i.e., direct methods that measure the vessel with no prior segmentation, and the more common indirect methods that require prior vessel segmentation. The direct method proposed by Wink et al. [9] requires at least two user-initialized points on the vessel segment. Indirect methods are more robust to the presence of image noise [10] and tend to calculate the centerline of the vessel using thinning from a previous segmentation [11].

Once the normal planes are determined, successive estimates of the maximum diameters in each plane are conventionally calculated by undertaking a multi-directional analysis within each plane. Even though Boskmap et al. [12] undertook a multi-directional analysis in order to compute the maximum distance, directly, most authors previously made an approximation of each cross-section to a regular shape, usually circles or ellipses. This fitting is performed by either growing circles from the vessel center while integrating the image gradient along the circles until reaching a local maximum, or by directly fitting a circle or an ellipse to the already segmented cross-sections. So, Luboz et al. [13] describe an algorithm based on the growth of circles in the plane orthogonal to the centerline points. Xunlei et al. [14] developed a semi-automatic method to determine the size of vessels by adjusting circles or ellipses within each cross-section. Krissian et al. [15] have introduced an algorithm for fitting the aortic sections to an ellipse instead of a circle. The points belonging to the centerline were used as reference points for the adjustment and through an iterative method the algorithm is able to improve both the fitting of the ellipse and the position of the points that belong to the centerline. Additional smoothing of the circles or ellipses along the centerline can be applied in the reconstruction step. Thereby Shim et al. [16] described a user-initialized method whereby the ellipse is corrected to locate the vessel centerline.

The aim of this study is to develop an automatic method for calculating the diameters of the thoracic aorta along the whole arterial segment of interest, including ascending aorta, aortic arch and descending aorta, using CT images of patients with administered contrast medium. The proposed method is based on determining the centerline using B-Spline interpolation of the centers of mass of each CT slice following segmentation and successive volumetric erosion. Once the position of the centerline has been determined, the normal planes are calculated at specific point and principal component analysis is used to compute the minimal and maximal diameters in each cross-section.

In order to evaluate the robustness of the proposed method, two types of datasets were created i.e., phantom datasets and clinical datasets from real patients. All images were obtained using a 64-detector row multidetector CT scanner (Lightspeed VCT; GE Medical Systems, Milwaukee, Wisconsin). Injection of an intravenous radiopaque contrast medium was performed before the acquisition of the images in order to enhance lumen visibility. The resulting images were stored in DICOM file format of 512×512 pixels with a resolution of 0.7×0.7(mm/pixel). The energy used in this study was 120kVp, with a pitch factor of 0.98, and a distance between slices of 0.625mm.

The purpose of the dataset is to evaluate the rotation invariance of the developed algorithm. Thus, a phantom consisting of a constant tube section simulating the thoracic aorta with various curvatures in different planes along its length was designed (Fig. 1
                        ). The same CT scanner and the same parameters were set in terms of energy, pitch and distance between slices for both the phantom and the clinical cases. CT images of the phantom from different spatial projections corresponding to each of the three X, Y, and Z-axes were obtained. A total of 18 series of CT images were acquired, 6 for each rotational axis, with a 10° variation in range of [−30, 30]. Each series consisted of 980 images of a total series of 17,640 images. Moreover, the caliber of the phantom was manually gauged. A calibrator was used to take 97 homogeneous measurements along the length of the tube. Measurements were repeated three times to reduce error measurement with a total of 291 diameter values.

In order to evaluate the method in real clinical cases a database was created consisting of 6599 images of the thoracic aorta corresponding to 15 patients admitted to the Radiology Unit of the University Hospital of Santiago de Compostela (CHUS). Three patients were normal cases, 1 man and 2 women, with an average age of 62.5years; and 9 were male and 3 female patients with pathology, with an average age of 64years.

@&#METHOD@&#


                     Fig. 2
                      outlines the five basic steps of the proposed method. The first step, segmentation process, involves volumetric region growing to descending aorta and aortic arch, and level set active contour evolution to extract the region corresponding to the ascending aorta. From the segmentation, the centerline of the vessel is computed using two different techniques: the values of the center of mass of the segmented region of each slice (descending and ascending aorta) and the values obtained after successive erosion of the segmented volume in the aortic arch. Progressive volumetric erosion trimmed the edges of segmentation volume to obtain the centerline by gradually eliminating points from the external contour of the volume using a set of templates. Then, a B-Spline curve is computed from the interpolation of skeletal points to obtain a greater number of points, and subvoxel precision of the centerline coordinates. These points are used to obtain the vectors of the skeleton, and the coordinate system of normal planes of these vectors are calculated using the rotation matrices equations. Finally, these planes serve to define vessel diameters using principal component analysis (PCA). The proposed method involves the split of the aorta into three sections denoted as Z
                     11, Z
                     12 and Z
                     2 that delineate the approximate contour of each clinical region, and provide valuable data since each section is characterized in terms of a specific potential aneurysm size. Succinctly, Z
                     11 corresponds to the descending aorta, Z
                     12 to the aortic arch, and Z
                     2 to the ascending aorta (Fig. 3
                     ). The three regions are identified by a CT segmented slice. The slice that splits these three regions must meet two conditions: the axial slice must be characterized by an abrupt increase in the size of the segmented region and the slice must be located at the upper aorta. This double condition ensures that the plane that separates the three sections is delineated, avoiding elongations of the descending aorta. Thereafter, segmentation is used to detect the initial position of the supra-aortic trunks in order to exclude them from the successive computations of diameters. To accomplish this, from the first axial slice of the aortic arch, the number of regions in each slice is calculated. The beginning of the supra-aortic trunks is identified as the slice that contains more than one labelled region.

The segmentation of the thoracic aorta is undertaken using the inner wall as the reference border since the standard procedure for measuring artery diameter relies on its lumen, which is the criterion for defining the presence of a potential aneurysm [17]. The process of segmentation has been described elsewhere in more detail [18]. Briefly, the algorithm begins at the most caudal slice of the descending aorta. In this region, the approximate shape of the aorta is a circle. The Hough transform [19] enables pre-set shapes to be found in an image, therefore the aortic area is automatically detected in this slice by convolving the whole slice with a circle. The coordinates of the center of this circle are used as the seed point for the application of the volumetric region-growing technique to segment the sections Z
                        11 and Z
                        12. This technique consists of the use of the 17 pixel neighbours corresponding to the previous and current slices, for the calculation of the mean and variance. The criterion for adding a new point depends its gray value. This value must be in the range defined by the mean and the variance of points added. To exclude the heart from the segmented area, the remaining section of the ascending aorta, (section Z
                        2), is extracted with the level set algorithm proposed by Malladi et al. [20], allowing the active contour to stop at the aortic valve. For the application of this technique, a pre-processing stage must be previously applied. Three filters: anisotropic diffusion, gradient and threshold, are consecutively applied. The preprocessing parameters are pre-set at the same value for all images. The segmentation of section Z
                        2 assumes a smooth variation in shape between consecutive slices therefore the result obtained for each slice can be used to initialize the segmentation of the next slice. The basic idea underlying level set can be stated as follows: a set of closed curves can be represented as the zero-crossing of a 2D function intersected by a plane at a given height (Fig. 4
                        ). Thus, assuming that all possible variations corresponding to the evolution of the curve are captured by the function at different levels, the former would be completely defined by reference to the function. Mathematically, the curve 
                           γ
                           (
                           t
                           )
                         could be represented by the zero set of the associated 2D function, 
                           ψ
                           (
                           x
                           ,
                           t
                           )
                        , as follows:
                           
                              (1)
                              
                                 γ
                                 (
                                 t
                                 )
                                 =
                                 {
                                 x
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 /
                                 ψ
                                 (
                                 x
                                 ,
                                 t
                                 )
                                 =
                                 0
                                 }
                              
                           
                        
                     

Given an initial contour or model, 
                           ψ
                           (
                           x
                           ,
                           (
                           t
                           =
                           0
                           )
                        , 
                           ψ
                           (
                           x
                           ,
                           t
                           )
                           )
                        , the curve evolution is obtained by solving the following partial differential equation:
                           
                              (2)
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 +
                                 F
                                 ∣
                                 ∇
                                 
                                    
                                       ψ
                                    
                                    
                                       t
                                    
                                 
                                 ∣
                                 =
                                 0
                              
                           
                        where F is the speed function. The function F can have a number of terms:
                           
                              (3)
                              
                                 F
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 {
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                 
                                 ∇
                                 
                                    
                                       ψ
                                    
                                    
                                       x
                                       ,
                                       y
                                    
                                 
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       c
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ∇
                                 
                                    
                                       ψ
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 }
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       
                                          
                                             I
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

This equation, which describes the evolution of the curve 
                           γ
                           (
                           t
                           )
                         across time, includes: a curvature term F
                        
                           c
                         that lends greater or lesser rigidity to the curve; a translation term F
                        0 that allows for the curve׳s displacement across the plane in which it lies; and an energy term that contains the image obtained in the previous process, 
                           
                              
                                 I
                              
                              
                                 ′
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 ′
                              
                           
                           )
                        .

The centerline is extracted using two different techniques that are applied according to the type of section. In sections Z
                        2 and Z
                        11, the centerline is calculated using the center of mass of the segmented region on each slice. Calculating the centerline on the basis of the center of mass offers the advantage that it excludes lateral branching of the visceral branches unlike other processes such as thinning algorithms. This is achieved by giving more weight in the calculation to the central part of the aorta i.e. where there is a greater concentration of points.

The center of mass is calculated with the expressions:
                           
                              (4)
                              
                                 CMX
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             i
                                             =
                                             N
                                          
                                       
                                       
                                          
                                             GL
                                          
                                          
                                             i
                                          
                                       
                                       ·
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             GL
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 CMY
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             i
                                             =
                                             N
                                          
                                       
                                       
                                          
                                             GL
                                          
                                          
                                             i
                                          
                                       
                                       ·
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             GL
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        where GL
                        
                           i
                         is the grey scale of the ith component, x
                        
                           i
                         is the value of the x coordinate in i, y
                        
                           i
                         is the value of the y coordinate in the i position, CMX is the x coordinate of the center of mass,and CMY is the y coordinate of the center of mass.

In section Z
                        12, corresponding to the aortic arch, the center of mass technique failed to achieve good results in calculating the skeleton given that the position of this point did not coincide with the centerline. Thus, an alternative technique based on the iterative erosion of volumetric image data is applied to the result of previous segmentation. This erosion process involves four basic templates described by She et al. [21] (Fig. 5
                        ). The points on the templates represented by the black voxel symbol 
                           “
                           •
                           ”
                         are opaque objects to be eroded, and the points represented by the white voxel symbol 
                           “
                           ○
                           ”
                         represent the transparent background. The points not represented by either of these symbols are not entered into the calculation regardless to whether they belong to the object or the background. A series of transformations are performed on the template in order to generate the grid for eliminating spatial invariance.

First, all the surface points on the volume that are 26-adjacent to a background voxel are marked. Then the templates are applied to each of these candidates. If any of the points coincides with at least one of the templates, the point is a candidate to be eliminated. Finally, the candidate points are eliminated by converting them into background if they satisfy the following criteria:
                           
                              (i)
                              If any voxel object in the 26-neighbours of the object voxel currently investigated is 26-connected; if satisfied, the current voxel object was considered a simple point.

If the background voxel in the 18-neighbours of the voxel object currently investigated is connected and contains at least one background 6-neighbours, this voxel object is deleted:
                                    
                                       (5)
                                       
                                          V
                                          (
                                          18
                                          )
                                          =
                                          {
                                          p
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                3
                                             
                                          
                                          /
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                      x
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      0
                                                      x
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                      y
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      0
                                                      y
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                      z
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      0
                                                      z
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          ≤
                                          2
                                          }
                                       
                                    
                                 
                              

If the volume points coincide with the templates, and the aforementioned criteria are confirmed, the points are eliminated from the volume. The resulting line of points corresponds to the centerline of the thoracic aorta.

There may appear abrupt variations in the positions of the points obtained in the former step due to the presence of other vessels such as the supra-aortic trunks or stretches of the aorta itself. In order to accurately determine the positions of the skeleton, the points are interpolated to smooth any irregularities between the consecutive positioning of points of the skeleton. The interpolation of skeleton data increases the number of points under analysis, which reduces the dispersion between the angles of the consecutive positions, and thus minimizes the measurement error.

Interpolation of skeleton data has been implemented using B-Spline. This method, first proposed by Frangi et al. [22], has been considered the state of the art for modeling the central vessel axis. Spline implementations may need dense control points for extracting complex vascular centerline or even multiple executions. However, spline modeling of a vessel centerline can achieve subvoxel accuracy. Thereby, as each case has a large number of points calculated in previous stage, B-Spline can be considered a good approach for smoothing the transitions between consecutive points of the centerline.

B-Spline adjustment [23] is characterized by the degree of the curve to be adjusted, which in this study has been set to 5 degree 5. The degree 5 polynomial function representing the 
                           B
                           -
                           Spline
                         
                        s(u) over the m previously computed real values u
                        
                           i
                        , that are the points representing the skeleton (knot points) of the aorta are represented by the following expression:
                           
                              (6)
                              
                                 s
                                 (
                                 u
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       m
                                       −
                                       n
                                       −
                                       2
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 u
                                 )
                                 ,
                                 
                                 u
                                 ϵ
                                 [
                                 
                                    
                                       u
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       m
                                       −
                                       n
                                    
                                 
                                 ]
                              
                           
                        where m is the number of real values u, n is the degree of 
                           B
                           -
                           Spline
                        , P
                        
                           i
                         denotes the selected control points coinciding with the skeleton of the aorta, and 
                           
                              
                                 N
                              
                              
                                 i
                              
                              
                                 n
                              
                           
                           (
                           t
                           )
                         denotes the piecewise polynomial functions defined by the Cox–de Bor recursion formula:
                           
                              (7)
                              
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 u
                                 )
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             if
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   j
                                                
                                             
                                             ≤
                                             u
                                             ≤
                                             
                                                
                                                   u
                                                
                                                
                                                   j
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             otherwise
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 u
                                 )
                                 =
                                 
                                    
                                       u
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             j
                                             +
                                             n
                                          
                                       
                                       −
                                       uj
                                    
                                 
                                 ·
                                 
                                    
                                       N
                                    
                                    
                                       j
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 (
                                 u
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             j
                                             +
                                             n
                                             +
                                             1
                                          
                                       
                                       −
                                       u
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             j
                                             +
                                             n
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       N
                                    
                                    
                                       j
                                       +
                                       1
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 (
                                 u
                                 )
                                 .
                              
                           
                        
                     

Once the skeleton has been extracted and the data interpolated, the coordinates are used to determine the normal vectors corresponding to the cross-sections at each point on the line (Fig. 6
                        ). The components of the normal vectors at each point are computed from the difference between the coordinates of two consecutive points:
                           
                              (9)
                              
                                 
                                    
                                       N
                                    
                                    
                                       →
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       P
                                    
                                    
                                       nx
                                    
                                 
                                 −
                                 
                                    
                                       P
                                    
                                    
                                       (
                                       n
                                       +
                                       1
                                       )
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ny
                                    
                                 
                                 −
                                 
                                    
                                       P
                                    
                                    
                                       (
                                       n
                                       +
                                       1
                                       )
                                       y
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       nz
                                    
                                 
                                 −
                                 
                                    
                                       P
                                    
                                    
                                       (
                                       n
                                       +
                                       1
                                       )
                                       z
                                    
                                 
                                 }
                              
                           
                        
                     

Once these values have been obtained, the slope of each cross-section in relation to the X and Y-axes, represented by α
                        
                           x
                         and α
                        
                           y
                         (Fig. 7
                        ), is computed using the following expressions:
                           
                              (10)
                              
                                 
                                    
                                       α
                                    
                                    
                                       x
                                    
                                 
                                 =
                                 arcsin
                                 
                                 
                                    
                                       |
                                       
                                          
                                             u
                                          
                                          
                                             x
                                          
                                       
                                       ·
                                       
                                          
                                             N
                                          
                                          
                                             x
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   N
                                                
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   N
                                                
                                                
                                                   z
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       α
                                    
                                    
                                       y
                                    
                                 
                                 =
                                 arcsin
                                 
                                 
                                    
                                       |
                                       
                                          
                                             u
                                          
                                          
                                             y
                                          
                                       
                                       ·
                                       
                                          
                                             N
                                          
                                          
                                             y
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   N
                                                
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   N
                                                
                                                
                                                   z
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 u
                              
                              
                                 →
                              
                           
                           =
                           (
                           
                              
                                 u
                              
                              
                                 x
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 y
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 z
                              
                           
                           )
                         is the unitary vector in the direction of the axis, and 
                           
                              
                                 N
                              
                              
                                 →
                              
                           
                           =
                           (
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                           ,
                           
                              
                                 N
                              
                              
                                 y
                              
                           
                           ,
                           
                              
                                 N
                              
                              
                                 z
                              
                           
                           )
                         is the normal vector.

In the reference system used, the coordinates of the set of V points of the vasculature are formally described as
                           
                              (12)
                              
                                 V
                                 (
                                 p
                                 )
                                 =
                                 {
                                 p
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 /
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 ≥
                                 0
                                 }
                              
                           
                        
                     

To determine the coordinates of the points on the normal plane of the vessel an additional plane of size A is used:
                           
                              (13)
                              
                                 ψ
                                 =
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 0
                                 )
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 /
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                                 ,
                                 −
                                 A
                                 <
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                                 <
                                 +
                                 A
                                 ,
                                 −
                                 A
                                 <
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 <
                                 +
                                 A
                                 }
                              
                           
                        
                     

The previous mid-point of the plane defined above corresponds to the origin of the reference system. The previously calculated inclination angles, the defined ψ plane, and the rotation and translation matrices are used to obtain the cross sections of each vessel. This is performed by rotating each point on the ψ plane, resulting from the product matrices:
                           
                              (14)
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       x
                                    
                                 
                                 ·
                                 
                                    
                                       R
                                    
                                    
                                       y
                                    
                                 
                                 ·
                                 
                                    
                                       R
                                    
                                    
                                       z
                                    
                                 
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        where R
                        
                           x
                        , R
                        
                           y
                         and R
                        
                           z
                         are the rotation matrices about the X-, Y- and Z-axes. As the Z-axis is rotation invariant 
                           
                              
                                 α
                              
                              
                                 z
                              
                           
                           =
                           0
                        , 
                           sin
                           (
                           
                              
                                 α
                              
                              
                                 z
                              
                           
                           )
                           =
                           0
                         and 
                           cos
                           (
                           
                              
                                 α
                              
                              
                                 z
                              
                           
                           )
                           =
                           1
                        , the rotation matrix is expressed as:
                           
                              (15)
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                                 =
                                 [
                                 
                                    
                                       
                                          
                                             cos
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   y
                                                
                                             
                                             )
                                             ·
                                             cos
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   x
                                                
                                             
                                             )
                                          
                                          
                                             −
                                             sin
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   y
                                                
                                             
                                             )
                                             ·
                                             sin
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   x
                                                
                                             
                                             )
                                          
                                          
                                             −
                                             sin
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   y
                                                
                                             
                                             )
                                             ·
                                             cos
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   x
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             cos
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   x
                                                
                                             
                                             )
                                          
                                          
                                             −
                                             sin
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   x
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             sin
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   y
                                                
                                             
                                             )
                                          
                                          
                                             sin
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   x
                                                
                                             
                                             )
                                             ·
                                             cos
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   y
                                                
                                             
                                             )
                                          
                                          
                                             cos
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   y
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 ]
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        
                     

The correct application of this expression requires a detailed analysis of the value of the sign for each angle and the correct application of conventional signs. The angle is positive when the rotational axis is clockwise. Thus, the values of the sign of the α
                        
                           x
                         and α
                        
                           y
                         angles depend on the value of the components of the normal vector 
                           
                              
                                 N
                              
                              
                                 →
                              
                           
                        , by calculating the difference between the coordinates of two consecutive points of the skeleton, given that this normal vector determines whether the rotation of the plane should be counterclockwise or anticlockwise around each X- and Y-axes.

After rotating the ψ plane, the coordinates of the plane are transformed to the 
                           p
                           =
                           (
                           x
                           ,
                           y
                           ,
                           z
                           )
                         points of the skeleton. Consequently, the transformed coordinates of the ψ plane are
                           
                              (16)
                              
                                 x
                                 ″
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 x
                                 y
                                 ″
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 y
                                 z
                                 ″
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 z
                              
                           
                        where 
                           p
                           (
                           x
                           ″
                           ,
                           y
                           ″
                           ,
                           z
                           ″
                           )
                         the points obtained are the points of the normal plane of the vessel wall.

The maximum and minimum diameters for each cross section are calculated. Given the elliptic approximation of the vessel, both diameters are orthogonal. Principal component analysis [24] of the points in each section is performed to determine the diameters. It is well known that the covariance matrix of a cloud of points provides data on its dispersion point value (variance) and its distribution (covariance). This shape tend to be circular or elliptic depending of the value of the covariance. The principal axes of the cloud of points are obtained by calculating the eigenvalues of such variances matrix.

In two-dimensional terms, the result of principal component analysis provides a new system of coordinates for a two-dimensional distribution, the dataset with the greatest variance is captured on the first axis, and the minimum variance on the second one. The vectors that indicate the orientation of the principal axes are calculated from the eigenvalues of the matrix. After obtaining the values of the eigenvectors, the directions of the maximum and minimum variance are known. Thus, to obtain the value of maximum and minimum diameters, we compute the size of segmentation in these directions.

A further drawback is related to the spatial orientations of the planes used to calculate the diameter, the distance between the slices of the acquisition system used and the width of each slices. The diameters calculated by PCA refer to the XY plane, thus they are two-dimensionally expressed as follows:
                           
                              (17)
                              
                                 
                                    
                                       v
                                       ″
                                    
                                    
                                       →
                                    
                                 
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       x
                                    
                                    
                                       ″
                                    
                                 
                                 
                                    
                                       x
                                       ″
                                    
                                    
                                       ^
                                    
                                 
                                 +
                                 
                                    
                                       v
                                    
                                    
                                       y
                                    
                                    
                                       ″
                                    
                                 
                                 
                                    
                                       y
                                       ″
                                    
                                    
                                       ^
                                    
                                 
                              
                           
                        
                     

To determine real dimensions of a vessel diameter, they must be transformed to 
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         space. Thus, the vectors indicating the direction of the maximum and minimum diameter are expressed as
                           
                              (18)
                              
                                 
                                    
                                       v
                                    
                                    
                                       →
                                    
                                 
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ^
                                    
                                 
                                 +
                                 
                                    
                                       v
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ^
                                    
                                 
                                 +
                                 
                                    
                                       v
                                    
                                    
                                       z
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ^
                                    
                                 
                              
                           
                        
                     

Hence, the need for rotation of the previously computed diameters is performed using the rotation equation matrices [15]. The rotation of these diameters is determined by the values of the angles computed in the previous analysis i.e., α
                        
                           x
                         and α
                        
                           y
                        , that represent the slope of the normal planes of the vessel wall in relation to the X and Y-axes. Finally the real value of each 
                           
                              
                                 v
                              
                              
                                 →
                              
                           
                         vector component is obtained by multiplying each component by the pixel size in X, Y, and Z, taking into account the possible separation between consecutive slices. The distance value between consecutive slices is obtained from the expression:
                           
                              (19)
                              
                                 Separation
                                 =
                                 p
                                 ·
                                 ST
                              
                           
                        where p is the pitch factor that is related with the shift of the table for a full rotation (360°), the number of slices per full rotation and the slice thickness (ST). Both parameters, pitch and ST, are obtained from the DICOM header. Once the scale factor is computed, the previously computed diameter values are corrected to obtain the real values of the diameter of the aorta at each point on the centerline.

@&#RESULTS@&#

Applying the method on the images corresponding to the phantom resulted in a mean diameter value of 11.65mm with a 95% confidence interval (11.64–11.65). In order to assess the robustness of the proposed method in relation to changes in the spatial orientation of the object to be measured, we splitted the set of values obtained for the diameter into three subsets (D
                        
                           x
                        , D
                        
                           y
                        , and D
                        
                           z
                        ) corresponding to the diameter measures for each of the three rotation axis (Fig. 8
                        ). Thus, the set D
                        
                           x
                         consists of six measures of the diameter obtained from images acquired at different rotations of the phantom around the axis X, from −30° to +30° at an interval of 10°, excluding 0° (no rotation). Likewise, D
                        
                           y
                         and D
                        
                           z
                         will include the measures of the diameter around the Y- and Z-axes, respectively. Mean diameter values for the tube and their confidence intervals are shown in Table 1
                        . An ANOVA test found no statistically significant differences F=18,803 
                           (
                           p
                           =
                           0
                           ,
                           1526
                           >
                           0
                           ,
                           05
                           )
                         between the three subsets.

There is no possibility of directly measuring the diameter of the aorta of each patient. Therefore we choose the measures of the maximum diameter obtained by using a commercial software, as gold standard. In this way, the developed algorithm was tested on 15 real cases to assess its accuracy in clinical settings and comparisons were made based on the measurements of the diameters obtained for each patient using the VessellQ Xpress X-Ray (General Electric. Milwaukee, USA). The software performs semi-automatic segmentation of the aorta, and user interaction is necessary to select several points over the image. Two user-initialized points are placed on the descending aorta, three on the aortic arch, and two on the ascending aorta. Once segmentation of the aorta has been completed, the software provides a graph with the values of the diameter along the aorta.


                        Fig. 9
                         shows the results of our algorithm applied to a clinical case. The figure illustrates the volumetric reconstruction, segmentation, and a graph with the diameter along the length of the vessel. The result was achieved after running the algorithm on a single core of a 2.8GHz CPU for less than 8min.


                        Table 2
                         shows the results of measuring the maximum diameters of the aorta by both methods for each patient. Differences less than 5% can be observed between both methods. Fig. 10
                         shows the measurement of the aorta using the commercial method plotted against the automatic method. The graph includes the line of equality i.e., the line all points would lie on if the two methods gave exactly the same result. We can observe that the linearity of the distribution of the points is very high, demonstrating the high degree of agreement reached by the two methods in measuring the diameter of the aorta.

To better display the agreement between both methods the plot of the differences between the measurements by the two methods for each measure against the aortic diameter is included (Fig. 11
                        ). We have included the 95% limits of agreement to the plot. The mean difference (automatic minus commercial) is 
                           
                              
                                 d
                              
                              
                                 ¯
                              
                           
                           =
                           0.2
                           
                           mm
                        . and the standard deviation of the differences is sd=1.4mm. We have analyzed the value of the differences and we have observed that they are normally distributed, so we can expect that 95% of the differences to lie in the interval. In our case this means that the differences between both methods are in interval [−2.9, 2,5]mm.

@&#DISCUSSION AND CONCLUSIONS@&#

It is important to know the size of the aorta because certain key decisions relating to the management of aortic aneurysms depend on such size. However, to answer the question “How big is the aorta” is not always easy. Among the sources of error encountered regularly in clinical practice can highlight the following: the inherent level of resolution of the imaging technologies currently available, the inclusion or not of the aortic wall itself in a measurement, the limitations of specific imaging modalities to correctly display portions of the aorta and the complex geometry of the aorta itself [25]. Moreover, if a manual method is used, this implies the dedication of a specialist by a period of time that roughly takes 15min for each clinical case, depending on experience and skills of the physician.

Our approach reduces analysis time to about 8min. However, clinically, the most important issue is the time spent by the radiologist in each study. Furthermore, with a fully automatic method, the time spent by the radiologist is reduced to 0min. Therefore, the use of an automatic method involves not only to save time but also some inherent characteristics of any automatic method such as the possibility of running off-line the algorithm and the attainment of the reproducibility of the results, which in turn allows more exhaustive comparisons. On the other hand, during vessel segmentation, both the slice that separates the ascending aorta and the aortic arch, and the slice between the descending aorta and the aortic arch are determined. This allows the detection of a lesion such as an aneurysm with independence of its position, given that clinically the size of the lesion varies according to the region of the thoracic aorta in which it is located.

In this work we have developed an automatic method for measuring the diameter of the aorta. However, the complex shape of the ship implies the existence of many normal planes with different orientations, on which it is necessary to measure distances. Hence, the influence of the spatial resolution on the measurement of the diameter on the normal planes has to be analyzed. To see this issue, we have designed a simple phantom with a constant diameter along its length that mimics the morphology of the aorta, and the results show no statistically significant differences between the different orientations.

A key feature of our approach is the use of PCA for determining the diameter of the aorta. Some authors have proposed explicitly adjusting the sections of the aorta to some mathematically well defined shapes, such as circles or ellipses. However those kinds of methods are computationally expensive because such algorithms are based on the use of iterative methods. To minimize this cost, some authors have proposed solutions ad hoc. In that way, Fitzgibbon et al. [26] used a least-square fit, specific for ellipses that minimizes the sum of the squared distances on the points of the ellipse. Moreover, when the multi-directional analysis is performed, only two control points are used to calculate each diameter i.e., the center point of the structure and the point on its boundary, which makes it vulnerable to the presence of artifacts. In terms of the aorta, the presence of artifacts entails the presence of structures related to the visceral trunks. Thus, one cannot rule out that the calculation of the directions of the maximum diameters may be influenced by the presence of these lateral ramifications.


                     Fig. 12
                      shows an axial slice with visceral trunks connected to the aorta. We can notice that the determination of the diameters varies according to the type of method used i.e., the PCA (Fig. 12a) or multi-directional analysis (Fig. 12b). In the latter, the presence of the visceral trunk clearly diverted the direction of the maximum diameter and raised its value considerably as compared to the value obtained with PCA, which was slightly higher than the ideal value. As the algorithm based on PCA uses the complete set of points of the characterized object, it is more robust in calculating the value of the diameters, and reduces the effect of artifacts.

One of the drawbacks of the method described in this paper is that it is first necessary to obtain a precise delineation of the center line of the vessel. Several authors have dealt with this issue. Kang et al. [27] proposed a centerline deformation method using a region-based active tube model that can provide accurate results in vessel quantification. Frangi et al. [28] described an active B-Spline model, which has also been used to achieve an accurate centerline vessel axis. In our study, the calculations of cross-sections are obtained from consecutive points of the centerline after interpolation process. The interpolation of initial estimates improved the results obtained for two main reasons. First, greater precision was achieved due to greater number of points obtained by increasing the number of cross-section calculated. Second, the fluctuations associated to the computation of the position of each point on the central line were reduced. Thus, the values computed for the angles of cross-section of the aorta wall (α
                     
                        x
                      and α
                     
                        y
                     ) varied more persistently (Fig. 13
                     ) than the process prior to interpolation (Fig. 14
                     ), which entailed a smoother transition between consecutive positions on each cross-section.

Currently, there are commercial solutions available that provide radiologists data of estimated diameter values along the length of the aorta. Most of these applications, however, are not fully automated i.e., user-defined starting points have to be indicated to guide the software in the segmentation process, maximum diameters are manually measured on the graph, and the task of excluding the diameters of the supra-aortic trunks, the visceral trunks or any artifact is also performed manually. The proposed automatic method represents an attempt for eliminating such drawbacks in the computation of vessel diameters and we have demonstrated how the degree of agreement between both methods, automatic and commercial, is large enough (Fig. 11). However, although the differences achieved between both methods lie within the limits of agreement for all the cases, it would be important to demonstrate whether the two measurement methods are interchangeable for distinguishing between normal and pathological cases. The concept of normal aorta has not been clearly established in terms of the diameter. Factors such age, sex, height determine the maximum diameter of the normal aorta, but there is a consensus that when the aorta exceeds the critical value of 50mm in diameter, some kind of disease has been developed. In our case the differences of measuring such diameter by the two methods are within the interval [−2.9, 2,5]mm, that is one order of magnitude inferior to the critical diameter. So we can conclude that both automatic and commercial methods are interchangeable, not only to determine with a high degree of agreement the diameter of the aorta, but also to establish whether this is a pathological case or not.

As for the limitations of our system, even though calculating the diameter is correct with independence of the location of the aneurysm, the different regions of the aorta (ascending aorta, aortic arch and descending aorta) are approximations of the clinical boundaries established for such regions. So the location of the aneurysm in terms of clinical regions of the aorta could be slightly displaced. Moreover the calculation of vessel diameter is limited to the thoracic aorta and the diameter of the supra-aortic trunks and the visceral vessels cannot be calculated with this method.

In conclusion, a new method for automatically measuring the diameter of the aorta has been developed. The method highlights the potential of the PCA for determining the diameter of the aorta. The automatic calculation of this value is important for the development of computer applications for the diagnosis and follow-up of aortic disorders. The proposed method was applied for measuring the diameter in all cases of our database and the results achieved suggest the ability of our approach as a tool for automatic characterization of thoracic aortic aneurysms.

None declared.

@&#REFERENCES@&#

