@&#MAIN-TITLE@&#A local adaptive weighted interpolation for deinterlacing

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study local weighted interpolation method for intra-field deinterlacing (AWI).


                        
                        
                           
                           In AWI, a more accurate interpolation filter is used to estimate the center missing pixel.


                        
                        
                           
                           A center-independent interpolation method is proposed to replace the center-dependent interpolation strategy.


                        
                        
                           
                           An adaptive weighted interpolation method is used to improve the accuracy of interpolation.


                        
                        
                           
                           AWI provides good reconstruction performance and requires a low computational cost.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Deinterlacing

Adaptive weighted filter

Center-independent interpolation

Image quality

@&#ABSTRACT@&#


               
               
                  In this paper, a local weighted interpolation method for intra-field deinterlacing is proposed as an improved version of the DCS (deinterlacing with awareness of closeness and similarity) algorithm. The original DCS method is derived from bilateral filter which takes the local spatial closeness and pixel similarity into account when calculating the weight of interpolation. The proposed algorithm achieves three improvements: 1) instead of the line average, a more accurate interpolation filter is used to estimate the center missing pixel; 2) the center-independent interpolation method is proposed to replace the center-dependent interpolation strategy; 3) the adaptive weighted interpolation method is used to improve the accuracy of interpolation. Experimental results show that the proposed algorithm provides superior performance in terms of both objective and subjective image qualities when compared with other conventional benchmarks, including DCS algorithms with low complexity.
               
            

@&#INTRODUCTION@&#

Recently, high-resolution display systems such as HDTVs, LCDs, and 3DTVs have been rapidly developed and are in wide use. However, most current broadcasting systems still employ interlaced scanning to compromise between frame rate and transmission bandwidth requirements [1]. Due to the adoption of interlaced scanning, these display systems suffer from undesirable visual artifacts such as interline flickers, line crawling, and field aliasing. Consequently, interlaced-to-progressive conversion is required to reduce these artifacts [2]. Various deinterlacing methods have been previously proposed, and they can be roughly grouped into intra-field methods [3–9] and inter-field methods [10,11].

Inter-field methods exhibit better visual performance in that they exploit the motion information between neighboring frames. However, they require a great deal of calculation and memory for implementation. Furthermore, if the motion information cannot be estimated accurately using inter-field methods, the deinterlacing performance worsens in comparison with intra-field methods. However, intra-field methods have the advantage of lower complexity than inter-field methods because they only utilize the current frames, making them more suitable for real-time applications. Therefore, we mainly focus on the intra-field method in this paper.

The existing intra-field deinterlacing methods can be roughly classified into two groups – one group is edge-based methods including ELA [3], EELA [4], MELA [5], LCID [6] and FDD [7] which all interpolate a missing line linearly between centro-symmetric neighboring pixels with the minimum difference. However, these directional interpolation techniques often perform poorly because they incorrectly estimate the direction or use only limited-direction models in high spatial frequency regions such as irregular edges and texture details. Another group is weight-based method including MCAD [8] and DCS (deinterlacing with awareness of closeness and similarity) [9]. MCAD is based on the correspondence between high-resolution covariance and low-resolution covariance. DCS is derived from a bilateral filter that takes the local spatial closeness and pixel similarity into account when calculating the weight of interpolation. These methods generally improve the deinterlacing performance when compared with the “line average,” though the visual effects of the deinterlaced frames could be further developed.

In this paper, we apply an adaptive weighted interpolation filter on the basis of DCS to interpolate the missing pixels by exploring the correlations with the neighboring pixels. The proposed interpolation method is a center-independent interpolation (CII) method, which makes it more robust and reliable when compared with DCS. Additionally, by using an adaptive weighted strategy, the accuracy of the interpolation is improved. The proposed algorithm also has the merits of low complexity and good visual quality.

The remainder of the paper is organized as follows. The DCS method is reviewed in Section 2, and the proposed adaptive weighted interpolation method is explained in Section 3. Experimental results are then presented to evaluate the performance of the proposed method in Section 4. Finally, conclusions are given in Section 5.

The DCS method is based on the application of the bilateral filter [12] to deinterlacing. The idea of DCS is to combine gray levels based on both the geometric closeness and intensity similarity that is in favor of near values to distant values in both domain and range. Two weighting functions are designed to replace a pixel value with the average of similar and nearby pixel values in the sliding window in regards to space and intensity. Specifically, the closer the neighboring pixel is, the higher the weight that will be allocated. Similarly, if the neighboring pixel is more similar in gray level to the center pixel, the higher weight will be allocated. Two Gaussian kernels are used to measure the closeness and similarity of neighboring pixels.

The weighting functions using Gaussian kernel for the spatial and intensity components are defined respectively as
                        
                           (1)
                           
                              
                                 
                                    W
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    S
                                 
                              
                              =
                              exp
                              
                                 [
                                 −
                                 
                                    
                                       
                                          |
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          −
                                          (
                                          
                                             
                                                i
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             
                                                j
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ]
                              
                              ,
                           
                        
                      and
                        
                           (2)
                           
                              
                                 
                                    W
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    R
                                 
                              
                              =
                              exp
                              
                                 [
                                 −
                                 
                                    
                                       
                                          |
                                          I
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          −
                                          I
                                          (
                                          
                                             
                                                i
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             
                                                j
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ]
                              
                              ,
                           
                        
                      where 
                        I
                        (
                        i
                        ,
                        j
                        )
                      is the intensity value at the given position 
                        (
                        i
                        ,
                        j
                        )
                     , and 
                        I
                        (
                        
                           
                              i
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              j
                           
                           
                              0
                           
                        
                        )
                      is the pre-interpolated value by the line average (LA).

The ensemble weight in DCS is the product of the two weighting functions in Eq. (1) and Eq. (2):
                        
                           (3)
                           
                              
                                 
                                    W
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              =
                              
                                 
                                    W
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    S
                                 
                              
                              
                                 
                                    W
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    R
                                 
                              
                              .
                           
                        
                      Finally, each pixel is interpolated using normalized weights as
                        
                           (4)
                           
                              
                                 I
                                 ˜
                              
                              (
                              
                                 
                                    i
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    j
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                (
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          W
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    I
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                (
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          W
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                 
                              
                              ,
                           
                        
                      where 
                        
                           I
                           ˜
                        
                        (
                        
                           
                              i
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              j
                           
                           
                              0
                           
                        
                        )
                      is the interpolated pixel at location 
                        (
                        
                           
                              i
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              j
                           
                           
                              0
                           
                        
                        )
                     . 
                        
                           
                              N
                           
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    j
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        
                      represent the neighboring known pixels of 
                        I
                        (
                        
                           
                              i
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              j
                           
                           
                              0
                           
                        
                        )
                      in Fig. 1
                     (a). The parameters 
                        
                           
                              σ
                           
                           
                              R
                           
                        
                      and 
                        
                           
                              σ
                           
                           
                              S
                           
                        
                      are regularization factors used to adjust the influence of 
                        
                           
                              W
                           
                           
                              R
                           
                        
                      and 
                        
                           
                              W
                           
                           
                              S
                           
                        
                     , respectively. Because different images have different features, it is impractical to choose specialized 
                        
                           
                              σ
                           
                           
                              R
                           
                        
                      and 
                        
                           
                              σ
                           
                           
                              S
                           
                        
                      for each image, and they are generally chosen empirically. 
                        
                           
                              σ
                           
                           
                              R
                           
                        
                      and 
                        
                           
                              σ
                           
                           
                              S
                           
                        
                      are set as 23 and 0.6, respectively, after training with a set of nature images. Since the distance between the neighboring pixels and the center position 
                        (
                        
                           
                              i
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              j
                           
                           
                              0
                           
                        
                        )
                      are fixed, the spatial weight 
                        
                           
                              W
                           
                           
                              S
                           
                        
                      can be pre-calculated to reduce the complexity.

The drawback of DCS is that the interpolation accuracy is highly dependent on the pre-interpolation of the center pixel. If the center pixel is badly interpolated, the accuracy of interpolation will be notably degraded. In addition, the correlation of neighboring pixels is ignored in the DCS method even if they exhibit a strong correlation with the center pixel.

@&#PROPOSED METHOD@&#

After the introduction and analysis of the DCS method, we propose a new interpolation method to avoid the drawback of DCS with the goal to improve interpolation accuracy. First, instead of using the LA in DCS, a more precise interpolation filter is applied to estimate the missing center pixel. Secondly, a CII method is proposed to replace the center-dependent interpolation (CDI) method used in DCS. Finally, in order to robustly interpolate the missing pixel, a local adaptive weighted interpolation is proposed through the combination of the output of CII and the pre-interpolated center missing pixel. At the same time, to exhaust the advantage of DCS, the spatial closeness weighting function is preserved.

The accuracy of the pre-interpolation of the center missing pixel is crucial to the whole DCS deinterlacing procedure, because a more accurate estimation of 
                           I
                           (
                           
                              
                                 i
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 j
                              
                              
                                 0
                              
                           
                           )
                         shows more accurate correlations of the gray gradients between 
                           I
                           (
                           
                              
                                 i
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 j
                              
                              
                                 0
                              
                           
                           )
                         and its neighboring pixels. Thus, two efficient fixed coefficient Wiener filters are used to pre-interpolate the missing pixel instead of line average (LA) method. The coefficients 
                           
                              
                                 h
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 h
                              
                              
                                 2
                              
                           
                         of these two filters can be given as
                           
                              (5)
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          [
                                          1
                                          ,
                                          5
                                          ,
                                          5
                                          ,
                                          1
                                          ]
                                       
                                       8
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          [
                                          1
                                          ,
                                          −
                                          5
                                          ,
                                          20
                                          ,
                                          20
                                          ,
                                          −
                                          5
                                          ,
                                          1
                                          ]
                                       
                                       32
                                    
                                    .
                                 
                              
                           
                         These two four-tap (
                           
                              
                                 h
                              
                              
                                 1
                              
                           
                        ) and six-tap (
                           
                              
                                 h
                              
                              
                                 2
                              
                           
                        ) fixed coefficient Wiener filters originally introduced in [13] and [14], respectively, are usually used to interpolate the sub-pixels in video codecs such as MPEG-4 and H.264/AVC. Consequently, this filter can accurately interpolate pixels in the sub-pixel position. Hence, the pixel to be estimated at 
                           (
                           
                              
                                 i
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 j
                              
                              
                                 0
                              
                           
                           )
                         is interpolated using the pixels in positions A, B, C, D, E, and F, where A, B, C, D, E, and F are pixels at 
                           (
                           
                              
                                 i
                              
                              
                                 −
                                 5
                              
                           
                           ,
                           
                              
                                 j
                              
                              
                                 0
                              
                           
                           )
                        , 
                           (
                           
                              
                                 i
                              
                              
                                 −
                                 3
                              
                           
                           ,
                           
                              
                                 j
                              
                              
                                 0
                              
                           
                           )
                        , 
                           (
                           
                              
                                 i
                              
                              
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 j
                              
                              
                                 0
                              
                           
                           )
                        , 
                           (
                           
                              
                                 i
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 j
                              
                              
                                 0
                              
                           
                           )
                        , 
                           (
                           
                              
                                 i
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 j
                              
                              
                                 0
                              
                           
                           )
                        , and 
                           (
                           
                              
                                 i
                              
                              
                                 5
                              
                           
                           ,
                           
                              
                                 j
                              
                              
                                 0
                              
                           
                           )
                        , respectively. The interpolation equation can then be defined as follows:
                           
                              (6)
                              
                                 
                                    I
                                    ˜
                                 
                                 (
                                 
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       j
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       20
                                       (
                                       C
                                       +
                                       D
                                       )
                                       −
                                       5
                                       (
                                       B
                                       +
                                       E
                                       )
                                       +
                                       (
                                       A
                                       +
                                       F
                                       )
                                    
                                    32
                                 
                                 .
                              
                           
                         To examine the performance of the proposed six-tap filter, two other filters (two-tap and four-tap filters) were also used for comparison. Note that two-tap filter is used in line average (LA) method. We used six standard test images of size 
                           (
                           512
                           ×
                           512
                           )
                         to simulate the interpolation procedure and measured the interpolated image quality by peak signal-to-noise ratio (PSNR). The result is listed in Table 1
                        . It can be seen that the proposed interpolation improves the accuracy of interpolation.

Whereas the CDI method which considers the correlation of neighboring pixels and the center pixel, the CII method only takes into account the correlation of neighboring pixels. If the neighboring pixels in the centro-symmetric position have similar gray levels, they share a higher weight. Otherwise, they are allocated a lower weight. The weighting function to calculate the spatial closeness of neighboring pixels remains the same as the one used in CDI because the distance from neighboring pixels to the center is fixed. In the local sliding window shown in Fig. 1(b), the six neighboring pixels form three centro-symmetric pixel pairs in three directions: diagonal, vertical, and anti-diagonal. Correspondingly, the three similarity weights 
                           
                              
                                 W
                              
                              
                                 45
                                 °
                              
                              
                                 R
                              
                           
                        , 
                           
                              
                                 W
                              
                              
                                 90
                                 °
                              
                              
                                 R
                              
                           
                        , and 
                           
                              
                                 W
                              
                              
                                 135
                                 °
                              
                              
                                 R
                              
                           
                         are calculated in these directions. They are defined as
                           
                              (7)
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          45
                                          °
                                       
                                       
                                          R
                                       
                                    
                                    =
                                    exp
                                    
                                       [
                                       −
                                       
                                          
                                             
                                                |
                                                I
                                                (
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                −
                                                I
                                                (
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                )
                                                |
                                             
                                             
                                                2
                                             
                                          
                                          
                                             2
                                             
                                                
                                                   σ
                                                
                                                
                                                   R
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          90
                                          °
                                       
                                       
                                          R
                                       
                                    
                                    =
                                    exp
                                    
                                       [
                                       −
                                       
                                          
                                             
                                                |
                                                I
                                                (
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                                −
                                                I
                                                (
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                                |
                                             
                                             
                                                2
                                             
                                          
                                          
                                             2
                                             
                                                
                                                   σ
                                                
                                                
                                                   R
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          135
                                          °
                                       
                                       
                                          R
                                       
                                    
                                    =
                                    exp
                                    
                                       [
                                       −
                                       
                                          
                                             
                                                |
                                                I
                                                (
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                )
                                                −
                                                I
                                                (
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                |
                                             
                                             
                                                2
                                             
                                          
                                          
                                             2
                                             
                                                
                                                   σ
                                                
                                                
                                                   R
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                           
                         The spatial closeness weighting function of neighboring pixels can be pre-calculated, since the distances from neighboring pixels in these three directions to the center 
                           (
                           
                              
                                 i
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 j
                              
                              
                                 0
                              
                           
                           )
                         are fixed as 
                           
                              2
                           
                        , 1, and 
                           
                              2
                           
                        . They are calculated as
                           
                              (8)
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          45
                                          °
                                       
                                       
                                          S
                                       
                                    
                                    =
                                    exp
                                    
                                       [
                                       −
                                       
                                          
                                             
                                                |
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                −
                                                (
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                                |
                                             
                                             
                                                2
                                             
                                          
                                          
                                             2
                                             
                                                
                                                   σ
                                                
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    exp
                                    
                                       [
                                       −
                                       
                                          1
                                          
                                             
                                                σ
                                             
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          90
                                          °
                                       
                                       
                                          S
                                       
                                    
                                    =
                                    exp
                                    
                                       [
                                       −
                                       
                                          
                                             
                                                |
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                −
                                                (
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                                |
                                             
                                             
                                                2
                                             
                                          
                                          
                                             2
                                             
                                                
                                                   σ
                                                
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    exp
                                    
                                       [
                                       −
                                       
                                          1
                                          
                                             2
                                             
                                                
                                                   σ
                                                
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          135
                                          °
                                       
                                       
                                          S
                                       
                                    
                                    =
                                    exp
                                    
                                       [
                                       −
                                       
                                          
                                             
                                                |
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                −
                                                (
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                                |
                                             
                                             
                                                2
                                             
                                          
                                          
                                             2
                                             
                                                
                                                   σ
                                                
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    exp
                                    
                                       [
                                       −
                                       
                                          1
                                          
                                             
                                                σ
                                             
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                           
                         The ensemble weight in CII is the product of the two weighting functions in Eq. (7) and Eq. (8):
                           
                              (9)
                              
                                 
                                    
                                       W
                                    
                                    
                                       θ
                                    
                                 
                                 =
                                 
                                    
                                       W
                                    
                                    
                                       θ
                                    
                                    
                                       S
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       θ
                                    
                                    
                                       R
                                    
                                 
                                 ,
                              
                           
                         where 
                           θ
                           =
                           (
                           45
                           °
                           ,
                           90
                           °
                           ,
                           135
                           °
                           )
                        . As can be seen from Eq. (9), only three weights are calculated in CII and the weight is independent of the center unknown pixel. The output of CII is given as
                           
                              (10)
                              
                                 
                                    
                                       
                                          I
                                          ˜
                                       
                                    
                                    
                                       CII
                                    
                                 
                                 (
                                 
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       j
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             I
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   (
                                                   θ
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             θ
                                          
                                       
                                       I
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             I
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   (
                                                   θ
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             θ
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where, 
                           
                              
                                 N
                              
                              
                                 (
                                 θ
                                 )
                              
                           
                         represents the neighboring pixels in the direction of θ. For example, 
                           I
                           (
                           
                              
                                 i
                              
                              
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 j
                              
                              
                                 0
                              
                           
                           )
                         and 
                           I
                           (
                           
                              
                                 i
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 j
                              
                              
                                 0
                              
                           
                           )
                         are the neighboring pixels in the 90° direction.

In order to robustly interpolate the missing pixel, an adaptive weighted interpolation (AWI) method was proposed by combining the output of CII and the pre-interpolated center pixel. The need for this method is seen in case where entire neighboring pixels are uncorrelated with each other due to irregular texture or noise. In this situation, the pre-interpolated pixel occupies a higher weight than the output of CII. Assuming that the sum of the shared weight of CII is given as
                           
                              (11)
                              
                                 μ
                                 =
                                 
                                    ∑
                                    
                                       I
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             (
                                             θ
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       θ
                                    
                                 
                                 .
                              
                           
                         Then the adaptive weighted interpolation formula is defined as
                           
                              (12)
                              
                                 
                                    
                                       
                                          I
                                          ˜
                                       
                                    
                                    
                                       AWI
                                    
                                 
                                 (
                                 
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       j
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 (
                                 1
                                 −
                                 μ
                                 )
                                 I
                                 (
                                 
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       j
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 +
                                 
                                    ∑
                                    
                                       I
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             (
                                             θ
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       θ
                                    
                                 
                                 I
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 .
                              
                           
                         Using this adaptive weighted interpolation method, the center missing pixel can be finally interpolated.

@&#EXPERIMENTAL RESULTS@&#

In this section, the proposed algorithm is evaluated both objectively and subjectively using various images, and the computational complexity is also discussed. To conduct the experiments, we first separated the odd and even fields of an image, and then used different deinterlacing methods to reconstruct the interlaced image. Finally, we compared the proposed algorithm AWI algorithm with LA, ELA, EELA, MELA, FDD, LCID, MCAD, FDIF, and DCS. In order to show the importance of the accuracy of the center missing pixel interpolation method, a center enhanced DCS (CEDCS) method which uses the six-tap fixed coefficients interpolation filter, is proposed in this paper to replace the LA method to pre-interpolate the center missing pixel. CEDCS was also used as a comparison method. In DCS and CEDCS, the same 
                        
                           
                              σ
                           
                           
                              S
                           
                        
                      and 
                        
                           
                              σ
                           
                           
                              R
                           
                        
                      are adopted as 0.6 and 23, respectively, which were trained as the general optimal factors using DCS. However, we need to retrain these parameters in AWI, since CII is used to replace CDI. Using the same training image set of 24 Kodak images and the same training method, new general optimal factors of 
                        
                           
                              σ
                           
                           
                              S
                           
                        
                      and 
                        
                           
                              σ
                           
                           
                              R
                           
                        
                      are set to 0.58 and 15, respectively.

In these experiments, eight test images of various sizes (
                        352
                        ×
                        288
                      (Akiyo and News), 
                        512
                        ×
                        512
                      (Airplane, Barbara, Boat and Finger), 
                        1280
                        ×
                        720
                      (Raven), and 
                        1920
                        ×
                        1080
                      (Bluesky)) were used. To validate the proposed algorithm, we conducted simulations using MATLAB with a 2.53 GHz Intel(R) Core(TM) i5 CPU M460. It is necessary to explain that all of the measures in our experiments were computed after removing a nine-pixel-wide boundary around the border of the image.

In order to determine the sensitivity of the general optimal factors of 
                        
                           
                              σ
                           
                           
                              S
                           
                        
                      and 
                        
                           
                              σ
                           
                           
                              R
                           
                        
                     , we train each test images to get the optimal factors of 
                        
                           
                              σ
                           
                           
                              S
                           
                        
                      and 
                        
                           
                              σ
                           
                           
                              R
                           
                        
                      for each image. In Table 2
                     , the optimal parameters 
                        
                           
                              σ
                           
                           
                              
                                 
                                    S
                                 
                                 
                                    opt
                                 
                              
                           
                        
                      and 
                        
                           
                              σ
                           
                           
                              
                                 
                                    R
                                 
                                 
                                    opt
                                 
                              
                           
                        
                      are chosen when highest 
                        
                           
                              PSNR
                           
                           
                              opt
                           
                        
                      is gained. It can be seen from Table 2 that 
                        
                           
                              σ
                           
                           
                              S
                           
                        
                      is not sensitive within the range from the lowest value 0.5 to the highest value 0.6, however, 
                        
                           
                              σ
                           
                           
                              R
                           
                        
                      is more sensitive to the image content with a range from 9 to 19. We also compared the 
                        
                           
                              PSNR
                           
                           
                              opt
                           
                        
                      with the 
                        
                           
                              PSNR
                           
                           
                              g
                           
                        
                      gained using the general optimal factors. Due to using the optimal parameters 
                        
                           
                              σ
                           
                           
                              
                                 
                                    S
                                 
                                 
                                    opt
                                 
                              
                           
                        
                      and 
                        
                           
                              σ
                           
                           
                              
                                 
                                    R
                                 
                                 
                                    opt
                                 
                              
                           
                        
                     , the 
                        
                           
                              PSNR
                           
                           
                              opt
                           
                        
                      are overall higher than 
                        
                           
                              PSNR
                           
                           
                              g
                           
                        
                     , however, the improvement is unconspicuous with only 0.016 dB higher in general. Since it is impractical to get the optimal parameters 
                        
                           
                              σ
                           
                           
                              
                                 
                                    S
                                 
                                 
                                    opt
                                 
                              
                           
                        
                      and 
                        
                           
                              σ
                           
                           
                              
                                 
                                    R
                                 
                                 
                                    opt
                                 
                              
                           
                        
                      for each image, the general optimal parameters 
                        
                           
                              σ
                           
                           
                              S
                           
                        
                      and 
                        
                           
                              σ
                           
                           
                              R
                           
                        
                      from training is the best choice with hardly noticed degradation.

For subjective evaluation, we adopted two metrics to evaluate the objective image quality. First, the PSNR in decibels (dB) was used to measure the difference between the original and reconstructed images. Table 3
                      shows a comparison of the objective image quality measured by the average PSNR. Based on these results, we can conclude that the proposed algorithm exhibits the best image quality indexed by average PSNR. There was an improvement from 0.715 (CEDCS) to 4.02 (ELA) dB when compared with the other methods even though this value varied notably for each image. Particularly, after the center missing pixel is pre-interpolated using the six-tap fixed coefficients Wiener filter, the CEDCS outperforms DCS by 0.737 dB. By utilizing the CII method instead of CDI, AWI performs better than DCS by 1.452 dB.

In order to further evaluate the performance of the proposed method, we adopted another measure of structural similarity (SSIM) [15]. However, to effectively evaluate the quality of the entire image, the mean SSIM (MSSIM) index was used. Table 4
                      compares the MSSIM performance of the proposed deinterlacing method to the other methods. Note that when the value of the MSSIM approached 1, the reconstructed image was more similar to the original image. Consequently, the result of the AWI method had the highest MSSIM when compared with other methods, which implies that the image reconstructed using AWI had the most similar structure with the original image. Similar to the PSNR index, AWI had a higher MSSIM than CEDCS and DCS, which shows that our center missing pixel pre-interpolation method and CII method can effectively improve the image quality compared with DCS.

In order to prove that our proposed method has satisfactory subjective performance, a zoomed partial image (Fig. 2
                     (b) from the original Barbara image in Fig. 2(a)) was selected to determine the visual effects. It can be seen in Fig. 2(c) that after the simulation of interlacing, the image was severely degraded and had only half vertical resolution of the original. Using different deinterlacing methods, including the proposed methods, the complete image was reconstructed as can be seen in Fig. 2(d)–(k). By comparing the reconstructed images, it can be clearly observed that our proposed method had the best subjective performance with fewer artifacts in the texture detail part of Barbaraʼs trousers as seen in Fig. 2(k), which had the most natural texture similar to the original image. The textures of the images processed using the other methods were blurred or degraded to some degree, as seen in Fig. 2(d)–(j). Among them, MCAD had the worst effect on texture and caused severe visual artifacts. In order to observe the difference between the original image and the reconstructed image, we used a thresholding method to binarize the different images. The result is given in Fig. 2(d)–(k). It can be seen that the proposed method exhibits minimum differences from the original image. Itʼs necessary to explain that LA and ELA were not listed for subjective comparison for proverbial worse visual artifacts they caused.

Further subjective evaluation was conducted using an SSIM map, which is produced using SSIM. Fig. 3
                      shows the SSIM map of the proposed method and the other compared methods. In Fig. 3, a brighter SSIM map illustrates greater similarity to the original image. It can be observed that the proposed method has the brightest SSIM map, demonstrating that it has the greatest similarity to the original image. Additionally, the fact that CEDCS shows a brighter SSIM map compared with the DCS map demonstrates that CEDCS can improve the image quality of DCS.

The CPU time is presented here to verify the computational complexity since this can reflect the efficiency of the deinterlacing methods. From Table 5
                     , we can see that the proposed method had the second shortest CPU time on average consuming only 14% more CPU time than DCS, which had the shortest CPU time. In particular, when compared with MCAD, which had the longest CPU time, the proposed method reduced the average CPU time by up to 98.8%.

Besides CPU time, we counted the number of “arithmetic operators including +, −, × and /,” “absolute operator,” “logical operator,” “relational operator” and “exponent operator” used to interpolate per missing pixel. LA only uses 2 arithmetic operators, this is why LA need the least processing time. And ELA, EELA, MELA and LCID used the similar edge-based interpolation approaches with only 6 neighboring known pixels. However, in general, they need 3 logical operators, 3 relational operators and 3 absolute operators to find the most relevant edge direction. Besides, they need about 10 arithmetic operators on average to interpolate the missing pixel. That is the reason why they need more CPU time than AWI. The MCAD is a covariance based method which uses more than 48 neighboring pixels in a large sliding window to calculate the missing pixels. Besides, using Sobel operator to obtain the edge map also consumed high CPU usage. The FDD method consumed the second longest CPU time which used 45 to 229 operators and 28 adjacent pixels to interpolate a missing pixel. DCS is time-efficient method by only using 34 operators (only arithmetic operators and exponent operators) and 6 adjacent pixels. However, AWI needed only 36 operators (only arithmetic operators and exponent operators) and 10 adjacent pixels to interpolate a missing pixel. Using only 2 more operators, our proposed method still showed efficiency in CPU processing time as DCS.

@&#CONCLUSIONS@&#

In this paper, we proposed an efficient intra-field deinterlacing algorithm using a local adaptive weighted interpolation method. This method modified the DCS interpolation method by enhancing the accuracy of the center pixel estimation method and by using the center-independent interpolation method, which reflects the correlation of neighboring pixels, to replace the CDI method used in DCS. The proposed method is more robust and reliable than DCS since it is not dependent on the center pixel which cannot be altered. Furthermore, in CII, the correlation of neighboring pixels contains more local edge and intensity information than CDI. Consequently, the AWI interpolation method which combines the CII and the center enhanced interpolation method can preserve the smooth edges and details in the deinterlaced image. The experimental results showed that the AWI interpolation method produced better deinterlacing results than all other conventional intra-field deinterlacing methods tested. In addition, the method has an exceptionally low complexity, which makes it suitable for real-time application.

@&#REFERENCES@&#

