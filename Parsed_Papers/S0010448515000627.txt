@&#MAIN-TITLE@&#Combining volumetric dental CT and optical scan data for teeth modeling

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel teeth modeling framework by combining optical scan data and dental CT images is introduced.


                        
                        
                           
                           Co-segmentation between optical scan data and dental CT images is performed by the graph-cut method simultaneously.


                        
                        
                           
                           The proposed algorithm is automatic and time efficient, and shows high fidelity.


                        
                        
                           
                           Teeth data with defects such as metal artifacts can be completed successfully.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Teeth modeling

Teeth segmentation

Co-segmentation

Graph-cut

Advancing front method

@&#ABSTRACT@&#


               
               
                  Dental computer-aided design (CAD) systems have been intensively introduced to digital dentistry in recent years. As basic digital models, volumetric computed tomography (CT) images or optical surface scan data are used in most dental fields. In many fields, including orthodontics, complete teeth models are required for the diagnosis, planning and treatment purposes. In this research, we introduce a novel modeling approach combining dental CT images and an optically scanned surface to create complete individual teeth models. First, to classify crown and root regions for each set of data, corresponding pairs between two different data are determined based on their spatial relationship. The pairs are used to define the co-segmentation energy by introducing similarity and dissimilarity terms for each corresponding pair. Efficient global optimization can be performed by formulating a graph-cut problem to find the segmentation result that minimizes the energy. After classifying crown and root regions for each data set, complete individual teeth are obtained by merging the two different data sets. The advancing front method was successfully applied for merging purposes by considering the signed distance from the crown boundary of the surface mesh to the root surface of the CT. The teeth models which have detailed geometries obtained from the optically scanned surface and interstice regions recovered from volumetric data can be obtained using the proposed method. In addition, the suggested merging approach makes it possible to obtain complete teeth models from incomplete CT data with metal artifacts.
               
            

@&#INTRODUCTION@&#

Detailed digital models of individual teeth are required for many dental applications including orthodontic planning and simulation, dental implants, and jaw surgery. In the case of orthodontics, individual teeth models should be repositioned for diagnosis and planning purposes as well as simple visualization. Digital teeth models can be typically obtained by optical scanning or computed tomography (CT) scanning. One tooth is mainly composed of an exposed crown region and a root covered by gum or a jawbone. For the purpose of observing the morphology of each tooth, dental CT images are the best solution among current imaging modalities.

The importance of individual teeth segmentation has been raised and various approaches have been explored through various works. Gao et al.  [1] extracted individual tooth contours explicitly from dental CT images using 2D level sets for each slice. They divided their algorithm into two stages: a single level set and coupled level sets for roots and crown segmentation, respectively. They also suggested a visualization framework of individual teeth for orthodontics  [2]. Hosntalab et al.  [3] applied variational level sets to the 3D volume directly after generating panoramic images in the coronal view. In addition, there are several modeling services used by practitioners in commercial packages. One of the available commercial packages is Anatomodel of Anatomage Dental (Anatomage Inc., San Jose, CA, USA). However, these tools in dental services require many manual segmentation operations, and they require much time and human resources. In addition, the previous studies listed above, as well as commercial packages, are based only on dental CT images.

From a modeling point of view, using only CT images has several drawbacks. Dental CT images are, in general, obtained from cone-beam CT (CBCT) scanners with a low dose exposure and a small field-of-view (FOV) compared to general medical CT scanners. The image quality of CBCT scans has many artifacts and defects for various reasons. These artifacts make CBCT images insufficient in representing the detailed geometries, as shown in Fig. 1
                     (a), which are important for dental implants and prostheses. Another critical problem of automatic teeth modeling with CT images is metal artifacts, as shown in Fig. 1(c).

Another major branch of teeth segmentation and modeling has been performed with optical scan data. These data have much higher accuracy (about 0.01 mm) than dental CT images, in general, but only include the exposed area in the mouth without distinction between the teeth and gingival regions, as shown in Fig. 1(b). To classify teeth from the data, several approaches use curvature values as a preprocessing step  [4–7]. Because it is not a trivial task to separate teeth using only geometric information, one group used a training set to extract gingival contours by applying 3D statistical models  [8]. However, it is not enough to extract only gingival contours in many dental applications because there are missing regions such as the geometries of interstices by occlusion. To resolve this problem, another group attempted to recover the geometries of interstices after removing valley-shaped regions  [6]. Recently, Fan et al.  [9] introduced an approach to segment individual teeth in the surface mesh using two phases segmentation. The input surface mesh is divided into small patches by low-level segmentation first, and similar neighboring patches are clustered by comparing the shape compactness. Nevertheless, there are still limitations in recovering unscanned areas because the geometries are basically missing.

To resolve this problem, we introduce a novel approach to construct digital teeth models by combining an optically scanned surface and dental CT images. In this approach, we extract crown regions from scanned surfaces with higher accuracy and root parts from dental CT images simultaneously by applying a co-segmentation concept using a graph-cut. The two segmented results are then combined seamlessly by considering the boundary shapes and adjusting different resolutions.

Our main contributions can be summarized as the follows: 
                        
                           –
                           As we know, this is the first work for teeth modeling by combining dental CT images and an optically scanned surface data for the purpose of teeth modeling.

We developed a co-segmentation method using dental CT images and an optically scanned surface data together for better segmentation results.

The seamless merging of segmented regions from two different data types was developed to obtain each tooth model.

Co-segmentation schemes have been applied to general bitmap images obtained from digital cameras  [10,11] or medical images [12,13]. There has been little study on different data types. Our technical approach for co-segmentation is similar to  [10], but spatial irregularities of the surface mesh have led to a quite different formulation. In addition, we applied the classified results to merge them because our final goal was to obtain complete teeth models.

Before describing the technical details of our approach, we will explain the overall procedure first. Fig. 2
                      shows a conceptual diagram of the overall procedure. From the volumetric CT images 
                        Ω
                        ⊂
                        
                           
                              R
                           
                           
                              3
                           
                        
                     , we extract separate individual teeth 
                        V
                        =
                        
                           
                              V
                           
                           
                              1
                           
                        
                        +
                        ⋯
                        +
                        
                           
                              V
                           
                           
                              n
                           
                        
                        ⊂
                        Ω
                      where 
                        
                           
                              V
                           
                           
                              i
                           
                        
                      is a segmented tooth region, 
                        
                           
                              V
                           
                           
                              i
                           
                        
                        ∩
                        
                           
                              V
                           
                           
                              j
                           
                        
                        =
                        ϕ
                      and 
                        n
                      is the number of teeth. This procedure is performed in 2 steps: first, the initial teeth region is extracted via optimal global thresholding and region growing with local thresholding. For optimal global thresholding, the Otsu’s thresholding method is used to segment hard bone regions, including jaw bones and teeth. In the initial segmentation result, some of the teeth’s surfaces are adjacent to jaw bones. To separate the teeth region only, the seed points for each tooth are marked manually and extracted by region growing with local thresholding. Our local thresholding finds connected voxels that are statistically similar to voxels surrounding the user defined seed points (voxels). The neighboring voxels of the boundary of the current active region are selected if their intensity is within [mean ± SD] of the active region, where SD is the standard deviation. The statistics are updated each iteration. A single seed point may not be sufficient to select the entire tooth region in some cases. This can be simply compensated by multiple selections.

From the initially extracted teeth region, morphological erosion is then performed until each tooth is separated. The amount of erosion is dependent on the contact surface between teeth. To determine the size of erosion probe, we construct a Euclidean distance field 
                        D
                      of the teeth region 
                        V
                      from the teeth boundary 
                        ∂
                        V
                      as shown in Fig. 3
                     . In the distance field, saddle points 
                        
                           {
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                           }
                        
                      of 
                        D
                     , represented as blue dots in Fig. 3(c), are located on the tooth boundary and the maximum value of 
                        
                           {
                           D
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           }
                        
                      determines the total amount of erosion. Initial teeth region is eroded as amount of 
                        max
                        
                           {
                           D
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           }
                        
                     , then each tooth are separated as shown in Fig. 3(d). A cube kernel was used for erosion in our experiments for time efficiency, but a sphere can be also used. We mark the voxels in the separated region as visited and the other initial teeth region as unvisited. The separated regions are then expanded by searching its unvisited neighbor voxels whose distance values are less than or equal to the current voxel. A priority queue is used for the propagation by saving neighbor voxels in reverse order of 
                        D
                     , the distance from 
                        ∂
                        V
                     . Propagation is performed until all teeth regions fill the initial volume 
                        V
                     . Let us denote the boundary of teeth as 
                        ∂
                        V
                        =
                        ∂
                        
                           
                              V
                           
                           
                              1
                           
                        
                        +
                        ⋯
                        +
                        ∂
                        
                           
                              V
                           
                           
                              n
                           
                        
                     , where 
                        ∂
                        
                           
                              V
                           
                           
                              i
                           
                        
                      is the set of boundary voxels of 
                        
                           
                              V
                           
                           
                              i
                           
                        
                     .

We then align optical scan data 
                        
                           
                              S
                           
                           
                              0
                           
                        
                      to 
                        ∂
                        V
                      described in the volume coordinates by selecting several feature points from both data sets. The feature points used in the initial transformation are matched pairs selected from both data sets. They are manually selected in the same order from the scan data and CT volume in 3D. The points at the end of central incisors and cusps of molars at both ends are used in our experiments. This initial registration can be improved in an automatic manner by using the well-known iterative closest point (ICP) algorithm  [14]. From this, the data set is prepared for the main steps.

Let the registered scan surface be 
                        S
                        ⊂
                        
                           
                              R
                           
                           
                              3
                           
                        
                     . After obtaining 
                        ∂
                        V
                      and 
                        S
                      via preprocessing, we then perform the co-segmentation of 
                        ∂
                        V
                      and 
                        S
                      simultaneously into crown and non-crown regions by finding corresponding pairs. The co-segmentation result may be affected by the initial registration accuracy. To reduce the effect from initial registration, we repeat the registration and co-segmentation steps until the rigid transformation converges. The registration result of 
                        
                           
                              S
                           
                           
                              0
                           
                        
                      to 
                        ∂
                        V
                      may be improved by using only the crown regions obtained from co-segmentation as input for the ICP algorithm. From the co-segmentation results of 
                        S
                     , the crown region of each tooth is smoothly merged with the root region from the corresponding teeth boundary among 
                        ∂
                        
                           
                              V
                           
                           
                              i
                           
                        
                     .

By performing this merging step for all the teeth, we can obtain a complete teeth model combining the crown region from 
                        S
                      and the root region from 
                        ∂
                        V
                     . The details of each step are described in Sections  3–5.

The main goal of this step is to segment crown parts from two different data sets simultaneously. As described in Section  1, the teeth segmentation from each data set is not a trivial task, and there are limitations due to the acquisition method and the data’s characteristics. To solve this problem, we suggest a co-segmentation method to classify crown and non-crown regions from both data sets in this section.

Rother et al.  [11] introduced co-segmentation to classify similar objects lying on different backgrounds. They extended a single segmentation problem based on Markov random fields (MRF) by defining corresponding pairs and introducing an additional term to compare the similarities of histograms between them. Co-segmentation has since been applied to many applications, including medical images  [12,13], large data user-interactions  [15], multi-videos  [16], and 3D surface shapes  [17]. Global optimization of these approaches is efficiently solved by a graph-cut algorithm. Graph-cut algorithms have been extensively studied, especially in the computer vision area  [18]. The concept and various applications can be found in previous studies on images  [18–21] and 3D surface shapes  [12,22–26], even though we do not describe the details here. Graph-cut algorithms are appropriate for binary classification problems such as foreground segmentation from backgrounds and they give an efficient framework for global energy optimization. Co-segmentation can be modeled under the same framework as single model segmentation.

Our basic framework is conceptually similar to previous studies applied to a pair of images  [10,11]. In the image segmentation problem  [10], corresponding pairs can be defined as all pairs of the same foreground histogram buckets because the foreground (or object) in the two images are similar. So, similarity values between corresponding pairs can be used to encourage the corresponding pixel of one image to be segmented to the foreground if a pixel of the other image is segmented to the foreground. However, because our problem is to segment crown parts of similar geometric shapes from 3D surfaces and volume data, corresponding pairs can be defined by some geometric properties between them. Furthermore, not only the similarities but also dissimilarities between corresponding pairs can be helpful for classifying non-crown region (root or gum) to non-crown region because it is difficult to classify non-crown regions correctly near the gingival boundary if only optical scan data are used for segmentation (see Eq. (10), Fig. 7 and Section  5.2). As a result, the details of the optimization equation differ from those of the image segmentation problems and both geometric similarities and dissimilarities are used as the meaningful properties to compare two data sets. In addition, for our purposes, the framework should recover data defects of one data type by compensating mutually from the other data type. The details of our approach are explained in the following sections.

The first step of our co-segmentation technique is to find the set of corresponding pairs that has a neighboring relationship between two different types of data. 
                           S
                         includes interstices and gingival regions, which are not included in 
                           ∂
                           V
                        , as well as crowns. This means that there are no corresponding regions in 
                           ∂
                           V
                         for gingival or interstice regions. Similarly, there are no corresponding regions in 
                           S
                         for the root parts in 
                           ∂
                           V
                        . That is, only crown parts, which we want to extract, exist in both sides.

Because two data sets are registered in the preprocessing step, the same parts in both sides are closely located. We can determine which part has its corresponding pair by a simple distance comparison. However, this cannot be determined by a simple threshold value due to different spatial resolutions, artifacts, and registration errors. The main idea to construct corresponding pairs is conservative rejection; that is, we exclude the points from the pairs that are not expected to be classified as the crown region. For the region where correct classification cannot be determined only with distances, energy minimization is performed, as described in Section  3.2.

We denote the center position of the paired voxel of 
                           
                              p
                           
                           ∈
                           S
                         by 
                           
                              
                                 C
                              
                              
                                 S
                              
                           
                           
                              (
                              
                                 p
                              
                              )
                           
                           =
                           arg
                           
                              
                                 min
                              
                              
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       r
                                    
                                 
                                 ∈
                                 ∂
                                 V
                              
                           
                           
                              {
                              
                                 |
                                 
                                    p
                                 
                                 −
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       r
                                    
                                 
                                 |
                              
                              }
                           
                           =
                           
                              
                                 
                                    q
                                 
                              
                              
                                 t
                              
                           
                         and the corresponding vertex of 
                           
                              q
                           
                           ∈
                           ∂
                           V
                         by 
                           
                              
                                 C
                              
                              
                                 V
                              
                           
                           
                              (
                              
                                 q
                              
                              )
                           
                           =
                           arg
                           
                              
                                 min
                              
                              
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       j
                                    
                                 
                                 ∈
                                 S
                              
                           
                           
                              {
                              
                                 |
                                 
                                    q
                                 
                                 −
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       j
                                    
                                 
                                 |
                              
                              }
                           
                           =
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                              
                           
                        . Note that 
                           
                              
                                 C
                              
                              
                                 V
                              
                           
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    S
                                 
                              
                              
                                 (
                                 
                                    p
                                 
                                 )
                              
                              )
                           
                         does not always return 
                           
                              p
                           
                        . The ordered index set of corresponding pairs 
                           C
                         is then defined as Eq. (1). 
                           
                              (1)
                              
                                 C
                                 =
                                 
                                    {
                                    
                                       (
                                       j
                                       ,
                                       r
                                       )
                                    
                                    |
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          j
                                       
                                    
                                    ∈
                                    S
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          r
                                       
                                    
                                    ∈
                                    ∂
                                    V
                                    ,
                                    
                                       (
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             r
                                          
                                       
                                       =
                                       
                                          
                                             C
                                          
                                          
                                             S
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                         or  
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             C
                                          
                                          
                                             V
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                r
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    ,
                                    
                                       |
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             r
                                          
                                       
                                       |
                                    
                                    <
                                    ρ
                                    ,
                                    
                                       |
                                       
                                          |
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                j
                                             
                                          
                                          −
                                          
                                             
                                                C
                                             
                                             
                                                S
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                          |
                                       
                                       −
                                       
                                          |
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                r
                                             
                                          
                                          −
                                          
                                             
                                                C
                                             
                                             
                                                V
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                
                                                   r
                                                
                                             
                                             )
                                          
                                          |
                                       
                                       |
                                    
                                    <
                                    ε
                                    }
                                 
                              
                           
                         where 
                           ε
                        , 
                           ρ
                         are user-defined constants. As shown in Eq. (1), the corresponding pairs are determined by two criteria: one is the Euclidean distance and the other is the closeness between bidirectional mapping points. We set 
                           ρ
                           =
                           2.0
                           
                           
                              mm
                           
                        , which is large enough considering the initial registration errors, and 
                           ε
                         as the diagonal length of a voxel because the second criterion is affected by the resolution of the sparser data.

We denote a set of regions whose vertices are all included in the corresponding pairs defined in Eq. (1) as 
                           
                              
                                 S
                              
                              
                                 P
                              
                           
                         and voxels as 
                           ∂
                           
                              
                                 V
                              
                              
                                 P
                              
                           
                        . We then denote the complement of 
                           
                              
                                 S
                              
                              
                                 P
                              
                           
                         and 
                           ∂
                           
                              
                                 V
                              
                              
                                 P
                              
                           
                         as 
                           
                              
                                 S
                              
                              
                                 Q
                              
                           
                           ⊂
                           S
                         and 
                           ∂
                           
                              
                                 V
                              
                              
                                 Q
                              
                           
                           ⊂
                           ∂
                           V
                        , respectively, and these are the sets of regions that are not matched with any corresponding pairs. Fig. 4
                         shows each region.

We define binary random variables that compose the energy equation. There are two kinds of variables for single segmentation of 
                           S
                         and 
                           V
                        , respectively. The first type is described as 
                           
                              
                                 x
                              
                              
                                 j
                              
                              
                                 
                                    (
                                    S
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 x
                              
                              
                                 r
                              
                              
                                 
                                    (
                                    V
                                    )
                                 
                              
                           
                         which represent whether the corresponding vertex or voxel belongs to the crown region or not. 
                           
                              
                                 x
                              
                              
                                 j
                              
                              
                                 
                                    (
                                    S
                                    )
                                 
                              
                           
                        , corresponding to 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 j
                              
                           
                           ∈
                           S
                        , is defined as Eq. (2). Similarly, 
                           
                              
                                 x
                              
                              
                                 r
                              
                              
                                 
                                    (
                                    V
                                    )
                                 
                              
                           
                         for 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 r
                              
                           
                           ∈
                           ∂
                           V
                         is defined as Eq. (3).
                           
                              
                                 (2)
                                 
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                       
                                          
                                             (
                                             S
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if  
                                                
                                                   
                                                      
                                                         p
                                                      
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ∈
                                                S
                                                  is classified as crown region
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 (3)
                                 
                                    
                                       
                                          x
                                       
                                       
                                          r
                                       
                                       
                                          
                                             (
                                             V
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if  
                                                
                                                   
                                                      
                                                         q
                                                      
                                                   
                                                   
                                                      r
                                                   
                                                
                                                ∈
                                                ∂
                                                V
                                                  is classified as crown region
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The other type is introduced to compare the similarities between neighboring nodes of each data type. Here, we use a one-ring neighbor, denoted by 
                           
                              
                                 N
                              
                              
                                 
                                    (
                                    S
                                    )
                                 
                              
                           
                        , for 
                           S
                        , and a 6-neighborhood scheme, expressed as 
                           
                              
                                 N
                              
                              
                                 
                                    (
                                    V
                                    )
                                 
                              
                           
                        , 
                           ∂
                           V
                        .
                           
                              (4)
                              
                                 
                                    
                                       y
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                    
                                       
                                          (
                                          S
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                          
                                          
                                             if  
                                             
                                                
                                                   x
                                                
                                                
                                                   j
                                                
                                                
                                                   
                                                      (
                                                      S
                                                      )
                                                   
                                                
                                             
                                             ≠
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                                
                                                   
                                                      (
                                                      S
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             otherwise ,
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       y
                                    
                                    
                                       r
                                       ,
                                       t
                                    
                                    
                                       
                                          (
                                          V
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                          
                                          
                                             if  
                                             
                                                
                                                   x
                                                
                                                
                                                   r
                                                
                                                
                                                   
                                                      (
                                                      V
                                                      )
                                                   
                                                
                                             
                                             ≠
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                
                                                
                                                   
                                                      (
                                                      V
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             otherwise .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Using two types of random variables, the Markov random field formulation for the segmentation of 
                           S
                         and 
                           V
                         can be generally expressed as Eqs. (5) and (6), respectively  [18]. 
                           
                              
                                 (5)
                                 
                                    min
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                S
                                             
                                             
                                                I
                                             
                                          
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                       
                                          
                                             (
                                             S
                                             )
                                          
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             (
                                             j
                                             ,
                                             k
                                             )
                                          
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                S
                                             
                                             
                                                I
                                             
                                          
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          j
                                          ,
                                          k
                                       
                                       
                                          
                                             (
                                             S
                                             )
                                          
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          j
                                          ,
                                          k
                                       
                                       
                                          
                                             (
                                             S
                                             )
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    subject to  
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                       
                                          
                                             (
                                             S
                                             )
                                          
                                       
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                    for  
                                    j
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          I
                                       
                                    
                                    ,
                                    
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    m
                                 
                              
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          j
                                          ,
                                          k
                                       
                                       
                                          
                                             (
                                             S
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if  
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      
                                                         (
                                                         S
                                                         )
                                                      
                                                   
                                                
                                                ≠
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      
                                                         (
                                                         S
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 (6)
                                 
                                    min
                                    
                                       
                                          ∑
                                       
                                       
                                          r
                                          ∈
                                          ∂
                                          
                                             
                                                V
                                             
                                             
                                                I
                                             
                                          
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          r
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          r
                                       
                                       
                                          
                                             (
                                             V
                                             )
                                          
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             (
                                             r
                                             ,
                                             t
                                             )
                                          
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                V
                                             
                                             
                                                I
                                             
                                          
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          r
                                          ,
                                          t
                                       
                                       
                                          
                                             (
                                             V
                                             )
                                          
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          r
                                          ,
                                          t
                                       
                                       
                                          
                                             (
                                             V
                                             )
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    subject to  
                                    
                                       
                                          x
                                       
                                       
                                          r
                                       
                                       
                                          
                                             (
                                             V
                                             )
                                          
                                       
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                    for  
                                    r
                                    ∈
                                    ∂
                                    
                                       
                                          V
                                       
                                       
                                          I
                                       
                                    
                                    ,
                                    
                                    r
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    p
                                 
                              
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          r
                                          ,
                                          t
                                       
                                       
                                          
                                             (
                                             V
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if  
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      r
                                                   
                                                   
                                                      
                                                         (
                                                         V
                                                         )
                                                      
                                                   
                                                
                                                ≠
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      
                                                         (
                                                         V
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 S
                              
                              
                                 I
                              
                           
                         and 
                           ∂
                           
                              
                                 V
                              
                              
                                 I
                              
                           
                         represent the index set of vertices in 
                           S
                         and voxels of 
                           ∂
                           V
                        , respectively. Similarly, 
                           
                              
                                 N
                              
                              
                                 S
                              
                              
                                 I
                              
                           
                         and 
                           
                              
                                 N
                              
                              
                                 V
                              
                              
                                 I
                              
                           
                         represent the pairwise index set of the neighbors of 
                           S
                         and 
                           ∂
                           V
                        , respectively.

The coefficients of boundary terms, 
                           
                              
                                 B
                              
                              
                                 j
                                 ,
                                 k
                              
                              
                                 
                                    (
                                    S
                                    )
                                 
                              
                           
                         in Eq. (5) and 
                           
                              
                                 B
                              
                              
                                 r
                                 ,
                                 t
                              
                              
                                 
                                    (
                                    V
                                    )
                                 
                              
                           
                         in Eq. (6), are defined as Eq. (7) in our problem. Note that 
                           
                              
                                 B
                              
                              
                                 j
                                 ,
                                 k
                              
                              
                                 
                                    (
                                    S
                                    )
                                 
                              
                           
                         is defined by a geometric property, the angle between the normal vectors, because 
                           S
                         is a surface mesh. In the case of CT data, it is known that the intensity of the enamel region, which only crowns have, is slightly higher than that of the root bone. We can see this in our formulation of 
                           
                              
                                 B
                              
                              
                                 r
                                 ,
                                 t
                              
                              
                                 
                                    (
                                    V
                                    )
                                 
                              
                           
                        , but it is not meaningful to compute the intensity differences directly because it is hard to detect the exact boundary of the volume data. The intensities are also not consistent. For this reason, we define 
                           
                              
                                 B
                              
                              
                                 r
                                 ,
                                 t
                              
                              
                                 
                                    (
                                    V
                                    )
                                 
                              
                           
                         to compute the difference between the average intensities by using neighbor voxels within a certain thickness.
                           
                              
                                 (7)
                                 
                                    
                                       
                                          B
                                       
                                       
                                          j
                                          ,
                                          k
                                       
                                       
                                          
                                             (
                                             S
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      1
                                                      −
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            j
                                                            ,
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                if  
                                                
                                                   |
                                                   1
                                                   −
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                   |
                                                
                                                >
                                                ξ
                                             
                                          
                                          
                                             
                                                τ
                                                /
                                                ξ
                                             
                                             
                                                otherwise ,
                                             
                                          
                                       
                                    
                                    
                                    where  
                                    
                                       
                                          C
                                       
                                       
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    max
                                    
                                       (
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             j
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       0
                                       )
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          r
                                          ,
                                          t
                                       
                                       
                                          
                                             (
                                             V
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      max
                                                      
                                                         (
                                                         
                                                            
                                                               Δ
                                                            
                                                            
                                                               
                                                                  min
                                                               
                                                            
                                                         
                                                         ,
                                                         1
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               r
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               t
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         |
                                                      
                                                   
                                                
                                             
                                             
                                                if  
                                                
                                                   |
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         r
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   |
                                                
                                                >
                                                
                                                ξ
                                                ,
                                             
                                          
                                          
                                             
                                                1
                                                /
                                                ξ
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                    
                                    where  
                                    
                                       
                                          I
                                       
                                       
                                          r
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             |
                                             N
                                             |
                                          
                                          +
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             I
                                          
                                          
                                             r
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             :
                                             
                                                (
                                                r
                                                ,
                                                t
                                                )
                                             
                                             ∈
                                             N
                                          
                                       
                                       
                                          
                                             I
                                          
                                          
                                             t
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             min
                                          
                                       
                                    
                                    =
                                    
                                       
                                          min
                                       
                                       
                                          
                                             (
                                             r
                                             ,
                                             t
                                             )
                                          
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                
                                                   (
                                                   V
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       |
                                       
                                          
                                             I
                                          
                                          
                                             r
                                          
                                          
                                             ′
                                          
                                       
                                       −
                                       
                                          
                                             I
                                          
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    n
                                 
                              
                              
                                 j
                              
                           
                         is the normal vector of the 
                           j
                        th vertex in 
                           S
                        , 
                           τ
                         is a user-defined constant, and 
                           
                              
                                 I
                              
                              
                                 r
                              
                           
                         is the 
                           r
                        th voxel intensity in 
                           Ω
                        . 
                           ξ
                         is the tolerance to prevent the denominator from becoming zero, and we set 
                           τ
                           =
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 3
                              
                           
                         and 
                           ξ
                           =
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 5
                              
                           
                         in our experiments. If 
                           ξ
                         is small enough, its value does not affect the segmentation results.

In our co-segmentation problem, it was not useful to determine the probability that one vertex or a voxel belongs to the crown by using its own properties. Therefore, we did not determine the 
                           
                              
                                 K
                              
                              
                                 r
                              
                           
                         and 
                           
                              
                                 K
                              
                              
                                 j
                              
                           
                         values for a vertex or a voxel that belonged to the crown by using its own properties in the co-segmentation problem. Instead, we applied hard constraints (using 
                           K
                        ) to both data terms of the vertices and voxels in 
                           
                              
                                 S
                              
                              
                                 Q
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 Q
                              
                           
                         in order to classify them as non-crown regions. In this study, the value of 
                           K
                         is assigned as: 
                           
                              
                                 K
                                 =
                                 1
                                 +
                                 max
                                 
                                    (
                                    
                                       
                                          max
                                       
                                       
                                          j
                                          ∈
                                          S
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          :
                                          
                                             (
                                             j
                                             ,
                                             k
                                             )
                                          
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                
                                                   (
                                                   S
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          j
                                          ,
                                          k
                                       
                                       
                                          
                                             (
                                             S
                                             )
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          max
                                       
                                       
                                          r
                                          ∈
                                          V
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          :
                                          
                                             (
                                             r
                                             ,
                                             t
                                             )
                                          
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                
                                                   (
                                                   V
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          r
                                          ,
                                          t
                                       
                                       
                                          
                                             (
                                             V
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

For the co-segmentation, we can apply a similar concept to the single model segmentation. The two energy equations in Eqs. (5) and (6) can be considered as local regional terms for each data type. The co-segmentation model can be easily extended from Eq. (5) by adding a boundary term between corresponding pairs of 
                           S
                         and 
                           ∂
                           V
                           [10]. To compare the similarity between corresponding pairs of different data, we define additional binary variables as shown in Eq. (8). 
                           
                              
                                 (8)
                                 
                                    
                                       
                                          m
                                       
                                       
                                          j
                                          ,
                                          r
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if  
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      
                                                         (
                                                         S
                                                         )
                                                      
                                                   
                                                
                                                =
                                                1
                                                  and  
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      r
                                                   
                                                   
                                                      
                                                         (
                                                         V
                                                         )
                                                      
                                                   
                                                
                                                =
                                                1
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise ,
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          j
                                          ,
                                          r
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                0
                                             
                                             
                                                if  
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      
                                                         (
                                                         S
                                                         )
                                                      
                                                   
                                                
                                                =
                                                0
                                                  and  
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      r
                                                   
                                                   
                                                      
                                                         (
                                                         V
                                                         )
                                                      
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                otherwise .
                                             
                                          
                                       
                                    
                                 
                              
                           
                         Our final co-segmentation model is then composed of two regional terms for each data type, a similarity term and a dissimilarity term, as defined in Eq. (9). 
                           
                              
                                 (9)
                                 
                                    min
                                    K
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                S
                                             
                                             
                                                Q
                                             
                                             
                                                I
                                             
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                       
                                          
                                             (
                                             S
                                             )
                                          
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             (
                                             j
                                             ,
                                             k
                                             )
                                          
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                S
                                             
                                             
                                                I
                                             
                                          
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          j
                                          ,
                                          k
                                       
                                       
                                          
                                             (
                                             S
                                             )
                                          
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          j
                                          ,
                                          k
                                       
                                       
                                          
                                             (
                                             S
                                             )
                                          
                                       
                                    
                                    +
                                    K
                                    
                                       
                                          ∑
                                       
                                       
                                          r
                                          ∈
                                          ∂
                                          
                                             
                                                V
                                             
                                             
                                                Q
                                             
                                             
                                                I
                                             
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          r
                                       
                                       
                                          
                                             (
                                             V
                                             )
                                          
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             (
                                             r
                                             ,
                                             t
                                             )
                                          
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                V
                                             
                                             
                                                I
                                             
                                          
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          r
                                          ,
                                          t
                                       
                                       
                                          
                                             (
                                             V
                                             )
                                          
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          r
                                          ,
                                          t
                                       
                                       
                                          
                                             (
                                             V
                                             )
                                          
                                       
                                    
                                    −
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             (
                                             j
                                             ,
                                             r
                                             )
                                          
                                          ∈
                                          C
                                       
                                    
                                    
                                       
                                          η
                                       
                                       
                                          j
                                          ,
                                          r
                                       
                                    
                                    
                                       
                                          m
                                       
                                       
                                          j
                                          ,
                                          r
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             (
                                             j
                                             ,
                                             r
                                             )
                                          
                                          ∈
                                          C
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          j
                                          ,
                                          r
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          j
                                          ,
                                          r
                                       
                                    
                                 
                              
                              
                                 
                                    subject to  
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                       
                                          
                                             (
                                             S
                                             )
                                          
                                       
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       
                                       1
                                       }
                                    
                                    
                                    for  
                                    j
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          I
                                       
                                    
                                    ,
                                    
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    m
                                 
                              
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          r
                                       
                                       
                                          
                                             (
                                             V
                                             )
                                          
                                       
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       
                                       1
                                       }
                                    
                                    
                                    for  
                                    r
                                    ∈
                                    ∂
                                    
                                       
                                          V
                                       
                                       
                                          I
                                       
                                    
                                    ,
                                    
                                    r
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    p
                                 
                              
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          j
                                          ,
                                          k
                                       
                                       
                                          
                                             (
                                             S
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if  
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      
                                                         (
                                                         S
                                                         )
                                                      
                                                   
                                                
                                                ≠
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      
                                                         (
                                                         S
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          y
                                       
                                       
                                          r
                                          ,
                                          t
                                       
                                       
                                          
                                             (
                                             V
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if  
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      r
                                                   
                                                   
                                                      
                                                         (
                                                         V
                                                         )
                                                      
                                                   
                                                
                                                ≠
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      
                                                         (
                                                         V
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          j
                                          ,
                                          r
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if  
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      
                                                         (
                                                         S
                                                         )
                                                      
                                                   
                                                
                                                =
                                                1
                                                  and  
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      r
                                                   
                                                   
                                                      
                                                         (
                                                         V
                                                         )
                                                      
                                                   
                                                
                                                =
                                                1
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise ,
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          n
                                       
                                       
                                          j
                                          ,
                                          r
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                0
                                             
                                             
                                                if  
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      
                                                         (
                                                         S
                                                         )
                                                      
                                                   
                                                
                                                =
                                                0
                                                  and  
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      r
                                                   
                                                   
                                                      
                                                         (
                                                         V
                                                         )
                                                      
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 η
                              
                              
                                 j
                                 ,
                                 r
                              
                           
                         and 
                           
                              
                                 δ
                              
                              
                                 j
                                 ,
                                 r
                              
                           
                        , are the coefficients for similarity and dissimilarity, respectively. They are computed as defined in Eq. (10).
                           
                              
                                 (10)
                                 
                                    
                                       
                                          η
                                       
                                       
                                          j
                                          ,
                                          r
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                exp
                                                
                                                   (
                                                   
                                                      
                                                         −
                                                         α
                                                         
                                                            |
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     q
                                                                  
                                                               
                                                               
                                                                  r
                                                               
                                                            
                                                            |
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               ̄
                                                            
                                                         
                                                         −
                                                         
                                                            |
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     q
                                                                  
                                                               
                                                               
                                                                  r
                                                               
                                                            
                                                            |
                                                         
                                                      
                                                   
                                                   )
                                                
                                                exp
                                                
                                                   (
                                                   
                                                      
                                                         β
                                                         
                                                            (
                                                            
                                                               |
                                                               
                                                                  
                                                                     
                                                                        n
                                                                     
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               ⋅
                                                               
                                                                  
                                                                     ∇
                                                                  
                                                                  
                                                                     Ω
                                                                  
                                                               
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        
                                                                           q
                                                                        
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                                  )
                                                               
                                                               |
                                                            
                                                            −
                                                            1
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            ⋅
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  Ω
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        q
                                                                     
                                                                  
                                                                  
                                                                     r
                                                                  
                                                               
                                                               )
                                                            
                                                            |
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                if  
                                                
                                                   |
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   |
                                                
                                                <
                                                
                                                   
                                                      d
                                                   
                                                   ¯
                                                
                                                  and  
                                                
                                                   
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ⋅
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      Ω
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   )
                                                
                                                ≠
                                                0
                                             
                                          
                                          
                                             
                                                0
                                                
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          j
                                          ,
                                          r
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                exp
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         
                                                            |
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            ⋅
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  Ω
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        q
                                                                     
                                                                  
                                                                  
                                                                     r
                                                                  
                                                               
                                                               )
                                                            
                                                            |
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            ⋅
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  Ω
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        q
                                                                     
                                                                  
                                                                  
                                                                     r
                                                                  
                                                               
                                                               )
                                                            
                                                            |
                                                         
                                                         −
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                if  
                                                
                                                   |
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ⋅
                                                   
                                                      
                                                         ∇
                                                      
                                                      
                                                         Ω
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               q
                                                            
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      )
                                                   
                                                   |
                                                
                                                <
                                                1
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    n
                                 
                              
                              
                                 j
                              
                           
                         is the normal vector of 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 j
                              
                           
                           ∈
                           S
                         and 
                           
                              
                                 ∇
                              
                              
                                 Ω
                              
                           
                           
                              (
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    r
                                 
                              
                              )
                           
                         is the gradient vector of 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 r
                              
                           
                           ∈
                           ∂
                           V
                        .


                        
                           
                              
                                 d
                              
                              
                                 ̄
                              
                           
                         is the mean value of 
                           
                              |
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    j
                                 
                              
                              −
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    r
                                 
                              
                              |
                           
                         for all corresponding pairs 
                           
                              (
                              j
                              ,
                              r
                              )
                           
                         in 
                           C
                        . 
                           
                              
                                 γ
                              
                              
                                 j
                              
                           
                           =
                           
                              
                                 κ
                              
                              
                                 j
                              
                              
                                 
                                    max
                                 
                              
                           
                           /
                           
                              
                                 κ
                              
                              
                                 t
                              
                           
                         if (
                           
                              
                                 κ
                              
                              
                                 j
                              
                              
                                 
                                    max
                                 
                              
                           
                           >
                           
                              |
                              
                                 
                                    κ
                                 
                                 
                                    j
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                              |
                           
                         and 
                           
                              
                                 κ
                              
                              
                                 j
                              
                              
                                 
                                    max
                                 
                              
                           
                           >
                           
                              
                                 κ
                              
                              
                                 t
                              
                           
                        ) otherwise 
                           
                              
                                 γ
                              
                              
                                 j
                              
                           
                           =
                           1
                        . 
                           
                              
                                 κ
                              
                              
                                 j
                              
                              
                                 
                                    max
                                 
                              
                           
                         is the maximum normal curvature at 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 j
                              
                           
                           ∈
                           S
                        , 
                           
                              
                                 κ
                              
                              
                                 j
                              
                              
                                 
                                    min
                                 
                              
                           
                         is the minimum normal curvature, and 
                           
                              
                                 κ
                              
                              
                                 t
                              
                           
                         is a threshold value. 
                           
                              
                                 κ
                              
                              
                                 t
                              
                           
                           =
                           0.5
                         was used by experiments in our study. In the case of 
                           α
                         and 
                           β
                        , they are the parameters to adjust the sensitivity of sub-terms of 
                           
                              
                                 η
                              
                              
                                 j
                                 ,
                                 r
                              
                           
                        , which are based on the changes of 
                           
                              |
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    j
                                 
                              
                              −
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    r
                                 
                              
                              |
                           
                         and normal vector deviation. We select 
                           α
                           =
                           4.0
                         to make the first sub term almost zero around 
                           
                              
                                 d
                              
                              
                                 ̄
                              
                           
                           /
                           2
                        , and 
                           β
                           =
                           2.5
                         so that the second sub term becomes almost zero when the angular difference between two normal vectors is bigger than 65° from the experiments.

The dissimilarity term is determined by two observations: (1) A negative high curvature area tends to be a part of the boundary between the teeth and gum by the negative minima rule  [27]. (2) A positive high curvature area is usually presented in the crown area.

As shown in the 
                           
                              
                                 η
                              
                              
                                 j
                                 ,
                                 r
                              
                           
                         of Eq. (10), the coefficient of the similarity term is composed of two subparts. The first consideration is that the spatially close pairs may be considered as the same region. So the left term of Eq. (10) is assigned the larger value of the spatially close pairs as a similarity reward. However, it is not easy to distinguish gingival contours from crowns using only this term because the spatial distances of these regions are close to the root parts as shown in Fig. 5
                        (a). Corresponding pairs in the same crown region may have similar normal vectors. So, we compare geometric similarities simultaneously by comparing the normal vectors of corresponding pairs. The second term of 
                           
                              
                                 η
                              
                              
                                 j
                                 ,
                                 r
                              
                           
                         gives the larger value to pairs that have similar normal vectors. As shown in Fig. 5(b), in order to represent values of the second term, most of the corresponding pairs in the gingival contours have values close to zero. Fig. 5(c) of the figure shows the 
                           
                              
                                 η
                              
                              
                                 j
                                 ,
                                 r
                              
                           
                         values to multiply two terms. As shown in (c), most of the pairs in the gingival contours have values close to zero because the pairs in this region have larger normal vector deviation, even though the distance is very close. This works fine in that pairs with a positive high curvature in the gum region are segmented easily as non-crown regions. This is because both of the 
                           
                              
                                 δ
                              
                              
                                 j
                                 ,
                                 r
                              
                           
                         and 
                           
                              
                                 η
                              
                              
                                 j
                                 ,
                                 r
                              
                           
                         values are small and their segmentation results are then dependent on the neighbors by 
                           
                              
                                 B
                              
                              
                                 j
                                 ,
                                 k
                              
                              
                                 
                                    (
                                    S
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 B
                              
                              
                                 r
                                 ,
                                 t
                              
                              
                                 
                                    (
                                    V
                                    )
                                 
                              
                           
                        .


                        
                           
                              
                                 η
                              
                              
                                 j
                                 ,
                                 r
                              
                           
                         is a compensation value for crown pairs when they are close and have similar normal vectors. On the other hand, 
                           
                              
                                 δ
                              
                              
                                 j
                                 ,
                                 r
                              
                           
                         is the penalty term for the cases where one of them is classified as crowns even though the normal vectors are different. By introducing the additional dissimilarity term as well as similarity, we can classify non-crown regions more accurately. The differences are discussed in Section  5.

Our problem can further be converted to a minimum 
                           
                              (
                              s
                              ,
                              t
                              )
                           
                        -cut problem, the general graph-cut method, similar to the approach introduced in  [10]. Let 
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                           =
                           
                              
                                 N
                              
                              
                                 S
                              
                           
                           ∪
                           
                              
                                 N
                              
                              
                                 V
                              
                           
                         where 
                           
                              
                                 N
                              
                              
                                 S
                              
                           
                         is the set of nodes in the graph corresponding to 
                           
                              
                                 x
                              
                              
                                 j
                              
                              
                                 
                                    (
                                    S
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 N
                              
                              
                                 V
                              
                           
                         is the nodes corresponding to 
                           
                              
                                 x
                              
                              
                                 j
                              
                              
                                 
                                    (
                                    V
                                    )
                                 
                              
                           
                        . We also subdivide 
                           
                              
                                 N
                              
                              
                                 S
                              
                           
                         and 
                           
                              
                                 N
                              
                              
                                 V
                              
                           
                         into 
                           
                              
                                 N
                              
                              
                                 S
                              
                              
                                 +
                              
                           
                           ,
                           
                           
                              
                                 N
                              
                              
                                 S
                              
                              
                                 −
                              
                           
                           ,
                           
                           
                              
                                 N
                              
                              
                                 V
                              
                              
                                 +
                              
                           
                           ,
                           
                           
                              
                                 N
                              
                              
                                 V
                              
                              
                                 −
                              
                           
                        , which are the set of nodes from 
                           
                              
                                 S
                              
                              
                                 P
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 Q
                              
                           
                        , 
                           ∂
                           
                              
                                 V
                              
                              
                                 P
                              
                           
                        , and 
                           ∂
                           
                              
                                 V
                              
                              
                                 Q
                              
                           
                        , respectively. In addition, 
                           
                              
                                 N
                              
                              
                                 m
                              
                           
                         and 
                           
                              
                                 N
                              
                              
                                 n
                              
                           
                         are the sets of nodes corresponding to 
                           C
                        , where 
                           
                              |
                              C
                              |
                           
                           =
                           
                              |
                              
                                 
                                    N
                                 
                                 
                                    m
                                 
                              
                              |
                           
                           =
                           
                              |
                              
                                 
                                    N
                                 
                                 
                                    n
                                 
                              
                              |
                           
                        . They also represent similarity and dissimilarity nodes between 
                           
                              
                                 S
                              
                              
                                 P
                              
                           
                         and 
                           ∂
                           
                              
                                 V
                              
                              
                                 P
                              
                           
                         which correspond to the variables 
                           m
                         and 
                           n
                        , respectively. The constructed graph is 
                           G
                           =
                           
                              (
                              N
                              ∪
                              
                                 {
                                 s
                                 ,
                                 t
                                 }
                              
                              ,
                              A
                              )
                           
                        , where 
                           N
                           =
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                           ∪
                           
                              
                                 N
                              
                              
                                 m
                              
                           
                           ∪
                           
                              
                                 N
                              
                              
                                 n
                              
                           
                        . To convert our problem in Eq. (9) to a min-cut problem, we connect all the nodes corresponding to the vertices in 
                           
                              
                                 S
                              
                              
                                 Q
                              
                           
                         and voxels in 
                           
                              
                                 V
                              
                              
                                 Q
                              
                           
                         to sink node 
                           t
                         as arcs with the cost 
                           K
                        . All the similarity nodes in 
                           
                              
                                 N
                              
                              
                                 m
                              
                           
                         are connected to the source node 
                           s
                         as arcs with cost 
                           η
                         while the dissimilarity nodes in 
                           
                              
                                 N
                              
                              
                                 n
                              
                           
                         are connected to 
                           t
                         with cost 
                           δ
                        , which is different from  [10]. They are connected to/from the nodes in 
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                         with infinite capacity, as shown in Fig. 6
                        . The neighbor nodes of 
                           S
                         and 
                           ∂
                           V
                         are connected in both directions.

For a finite cut (
                           O
                           ∪
                           
                              {
                              s
                              }
                           
                           ,
                           T
                           ∪
                           
                              {
                              t
                              }
                           
                        ) of 
                           G
                        , we denote the set of nodes connected to the source node 
                           s
                         in 
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                         by 
                           
                              
                                 O
                              
                              
                                 x
                              
                           
                         and those in 
                           
                              
                                 N
                              
                              
                                 m
                              
                           
                         and 
                           
                              
                                 N
                              
                              
                                 n
                              
                           
                         by 
                           
                              
                                 O
                              
                              
                                 m
                                 
                              
                           
                         and 
                           
                              
                                 O
                              
                              
                                 n
                              
                           
                        , respectively. In the same way, the nodes that are connected to the sink node 
                           t
                         among 
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                        , 
                           
                              
                                 N
                              
                              
                                 m
                              
                           
                        , and 
                           
                              
                                 N
                              
                              
                                 n
                              
                           
                         are denoted by 
                           
                              
                                 T
                              
                              
                                 x
                              
                           
                        , 
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                        , and 
                           
                              
                                 T
                              
                              
                                 n
                              
                           
                         respectively. Eq. (9) can then be converted to a minimum 
                           
                              (
                              s
                              ,
                              t
                              )
                           
                        -cut problem by Theorem 1. 
                           Theorem 1
                           
                              The minimum 
                              
                                 
                                    (
                                    s
                                    ,
                                    t
                                    )
                                 
                              
                              -cut cost function of graph 
                              
                                 G
                                 =
                                 
                                    (
                                    N
                                    ∪
                                    
                                       {
                                       s
                                       ,
                                       t
                                       }
                                    
                                    ,
                                    A
                                    )
                                 
                               
                              gives the same solution of Eq.   (9)   by setting 
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                               
                              when the 
                              
                                 i
                              
                              th node of 
                              
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                               
                              is included in 
                              
                                 O
                              
                              that is connected to the source node 
                              
                                 s
                              
                              . 
                              
                                 
                                    
                                       m
                                    
                                    
                                       j
                                       ,
                                       r
                                    
                                 
                                 =
                                 1
                               
                              for each similarity node in 
                              
                                 
                                    
                                       N
                                    
                                    
                                       m
                                    
                                 
                               
                              is included in 
                              
                                 T
                               
                              connected to the sink node 
                              
                                 t
                              
                              , and 
                              
                                 
                                    
                                       n
                                    
                                    
                                       j
                                       ,
                                       r
                                    
                                 
                                 =
                                 1
                               
                              for each dissimilarity node in 
                              
                                 
                                    
                                       N
                                    
                                    
                                       n
                                    
                                 
                               
                              is included in 
                              
                                 O
                              
                              .
                           


                        
                           Proof
                           Let 
                                 
                                    (
                                    O
                                    ∪
                                    
                                       {
                                       s
                                       }
                                    
                                    ,
                                    T
                                    ∪
                                    
                                       {
                                       t
                                       }
                                    
                                    )
                                 
                               be a partition of 
                                 N
                                 ∪
                                 
                                    {
                                    s
                                    ,
                                    t
                                    }
                                 
                               forming a finite 
                                 
                                    (
                                    s
                                    ,
                                    t
                                    )
                                 
                              -cut in 
                                 G
                              . This cut corresponds to a feasible solution because if 
                                 
                                    
                                       m
                                    
                                    
                                       j
                                       ,
                                       r
                                    
                                 
                                 =
                                 1
                               then 
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 1
                               of 
                                 
                                    
                                       N
                                    
                                    
                                       S
                                    
                                 
                               and 
                                 
                                    
                                       x
                                    
                                    
                                       r
                                    
                                 
                                 =
                                 1
                               of 
                                 
                                    
                                       N
                                    
                                    
                                       V
                                    
                                 
                              . If 
                                 
                                    
                                       n
                                    
                                    
                                       j
                                       ,
                                       r
                                    
                                 
                                 =
                                 0
                               then 
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 0
                               and 
                                 
                                    
                                       x
                                    
                                    
                                       r
                                    
                                 
                                 =
                                 0
                              ; otherwise an infinite cost arc will contribute to the cut capacity which violates the finiteness of the cut. The cut capacity is: 
                                 
                                    
                                       C
                                       
                                          (
                                          O
                                          ∪
                                          
                                             {
                                             s
                                             }
                                          
                                          ,
                                          T
                                          ∪
                                          
                                             {
                                             t
                                             }
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   O
                                                
                                                
                                                   x
                                                
                                                
                                                   −
                                                
                                             
                                          
                                       
                                       K
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   O
                                                
                                                
                                                   x
                                                
                                             
                                             ,
                                             j
                                             ∈
                                             
                                                
                                                   T
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   T
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                       
                                          
                                             η
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   O
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             i
                                          
                                       
                                       .
                                    
                                 
                               Because 
                                 
                                    
                                       T
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       N
                                    
                                    
                                       m
                                    
                                 
                                 −
                                 
                                    
                                       O
                                    
                                    
                                       m
                                    
                                 
                              , the cut capacity can be reformulated as 
                                 K
                                 
                                    |
                                    
                                       
                                          O
                                       
                                       
                                          x
                                       
                                       
                                          −
                                       
                                    
                                    |
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             O
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       j
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 +
                                 
                                    (
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                    
                                       
                                          η
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                O
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                    
                                       
                                          η
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             O
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       i
                                    
                                 
                              . Since 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 
                                    
                                       η
                                    
                                    
                                       i
                                    
                                 
                               is constant, minimizing 
                                 C
                                 
                                    (
                                    O
                                    ∪
                                    
                                       {
                                       s
                                       }
                                    
                                    ,
                                    T
                                    ∪
                                    
                                       {
                                       t
                                       }
                                    
                                    )
                                 
                               becomes equivalent to minimizing 
                                 K
                                 
                                    |
                                    
                                       
                                          O
                                       
                                       
                                          x
                                       
                                       
                                          −
                                       
                                    
                                    |
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             O
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       j
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 −
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             O
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 
                                    
                                       η
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             O
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       i
                                    
                                 
                              , which is exactly the same as the objective value of Eq. (9).

After solving Eq. (9) with the min-cut/max-flow algorithm, we save a set of resulting faces whose vertices are 
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                    
                                       
                                          (
                                          S
                                          )
                                       
                                    
                                 
                                 =
                                 1
                               as 
                                 
                                    
                                       S
                                    
                                    
                                       C
                                    
                                 
                                 ⊂
                                 S
                               and a set of voxels where value 
                                 
                                    
                                       x
                                    
                                    
                                       r
                                    
                                    
                                       
                                          (
                                          V
                                          )
                                       
                                    
                                 
                                 =
                                 1
                               as 
                                 ∂
                                 
                                    
                                       V
                                    
                                    
                                       C
                                    
                                 
                                 ⊂
                                 ∂
                                 V
                              . The remaining regions 
                                 
                                    
                                       S
                                    
                                    
                                       N
                                    
                                 
                                 =
                                 S
                                 −
                                 
                                    
                                       S
                                    
                                    
                                       C
                                    
                                 
                               and 
                                 ∂
                                 
                                    
                                       V
                                    
                                    
                                       N
                                    
                                 
                                 =
                                 ∂
                                 V
                                 −
                                 ∂
                                 
                                    
                                       V
                                    
                                    
                                       C
                                    
                                 
                               are also saved, as shown in Fig. 7(b). We then merge 
                                 
                                    
                                       S
                                    
                                    
                                       C
                                    
                                 
                               and 
                                 ∂
                                 
                                    
                                       V
                                    
                                    
                                       N
                                    
                                 
                              , as described in Section  4.

In many cases of dental CT images, critical artifacts occur due to metallic materials such as implants or prostheses, as shown in Fig. 1(c). This makes it hard to separate teeth from each other and to obtain the geometries of teeth. While our corresponding pair scheme and Eq. (9) give good results for normal dental CT without metal artifacts, it is not enough for other cases. However, the main advantage of co-segmentation is here. We can simply resolve this by complementing undesirable effects in dental CT with scanned data.

Since the shape of teeth with metal artifacts are dissimilar between CT and optically scanned data, most of the artifact region do not have corresponding pairs or are classified to the non-crown region by a dissimilarity term if Eq. (9) is applied directly, as shown in Fig. 9(a). Therefore, we detect the artifact region first, 
                           
                              
                                 V
                              
                              
                                 A
                              
                           
                         in Fig. 8
                        (d), and then make a corresponding set for 
                           
                              
                                 V
                              
                              
                                 A
                              
                           
                         by finding the closest vertices from the optically scanned surface.

The artifact regions are generally included in 
                           ∂
                           
                              
                                 V
                              
                              
                                 Q
                              
                           
                        . In addition, the geometries of artifact regions are significantly different from neighboring regions. We use these two observations to detect artifact regions and perform segmentation.

Let the set of voxels be 
                           ∂
                           
                              
                                 V
                              
                              
                                 R
                              
                           
                        , which are collected from the 
                           z
                        -direction extreme point, an apex of the root, until meeting 
                           
                              
                                 V
                              
                              
                                 P
                              
                           
                        , as shown in Fig. 8(b). The seed regions of artifacts denoted by 
                           
                              
                                 V
                              
                              
                                 S
                              
                           
                         to find the area affected by metal artifacts 
                           
                              
                                 V
                              
                              
                                 A
                              
                           
                         are then determined by 
                           ∂
                           
                              
                                 V
                              
                              
                                 S
                              
                           
                           =
                           
                              
                                 V
                              
                              
                                 Q
                              
                           
                           −
                           ∂
                           
                              
                                 V
                              
                              
                                 R
                              
                           
                         in Fig. 8(c). 
                           
                              
                                 V
                              
                              
                                 A
                              
                           
                         can then be found by searching from 
                           
                              
                                 V
                              
                              
                                 S
                              
                           
                         to 
                           ∂
                           
                              
                                 V
                              
                              
                                 R
                              
                           
                         with a simple region growing method, as shown in Fig. 8(d).

When we apply Eq. (9) to the model with artifacts, the similarity term is only applied in the case of the corresponding pairs of 
                           
                              
                                 V
                              
                              
                                 A
                              
                           
                        , except for the dissimilarity term for co-segmentation. If the dissimilarity term is not applied to these corresponding pairs of 
                           
                              
                                 V
                              
                              
                                 A
                              
                           
                        , the crown is found from the optically scanned data and the matched crown regions in 
                           
                              
                                 V
                              
                              
                                 A
                              
                           
                         are classified by corresponding pairs. Fig. 9 shows our co-segmentation result of the model with metal artifacts.

The goal of this study is to obtain a combined teeth model by aggregating strengths of each data type. The selected regions are not generally smoothly connected to 
                        ∂
                        V
                     , as shown in Fig. 10
                     . For the vertices of 
                        
                           
                              S
                           
                           
                              C
                           
                        
                     , we assign the tooth index with an index of the closest voxel in 
                        ∂
                        V
                     . The merge step is performed for the separated tooth independently after dividing 
                        
                           
                              S
                           
                           
                              C
                           
                        
                      by 
                        
                           
                              ∪
                           
                           
                              i
                              =
                              1
                           
                           
                              n
                           
                        
                        
                           
                              S
                           
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                           
                        
                     .

The important point in this step is to maintain 
                        
                           
                              S
                           
                           
                              C
                           
                        
                      as much as possible, because the accuracy of the optical scan data is much higher than the accuracy of dental CT. In order to achieve our goal, we adopt an approach that creates triangles from the boundaries of 
                        
                           
                              S
                           
                           
                              C
                           
                        
                      while keeping the consistency of the surface normal vectors and triangle size. The overall procedure of this step is illustrated in Fig. 11
                     .

For our purpose, the concept of the marching triangle algorithm introduced by Hilton et al.  [28] is appropriate for determining new vertex positions and triangles from the boundary of 
                        
                           
                              S
                           
                           
                              C
                           
                        
                     . This approach gives a fine solution to generate iso-surfaces from the arbitrary volume data  [29] with an adaptive mesh size that considers curvature values while maintaining the aspect ratio of the triangles  [30–33] by considering a 3D Delaunay surface constraint  [28]. The difference is that our problem is not to create an iso-surface from a given implicit function or a scalar field, but to generate smoothly combined triangles to 
                        ∂
                        V
                      from the boundary of 
                        
                           
                              S
                           
                           
                              C
                           
                        
                     . Let us denote the set of boundary edges and vertices of 
                        
                           
                              S
                           
                           
                              C
                           
                        
                      by 
                        ∂
                        
                           
                              S
                           
                           
                              C
                           
                        
                     . The key idea in this step is to compute signed distances of 
                        ∂
                        
                           
                              S
                           
                           
                              C
                           
                        
                      from 
                        ∂
                        V
                      and assign them to the nearest voxels in 
                        ∂
                        V
                     . By propagating the values to 
                        ∂
                        
                           
                              V
                           
                           
                              N
                           
                        
                      by using a transition scheme that changes gradually, we are able to find the positions where new vertices lie. The details are described in this section.

To determine the vertex positions of the merged surface, we compute signed distance values of vertices in 
                        ∂
                        
                           
                              S
                           
                           
                              C
                           
                        
                      from 
                        ∂
                        V
                     . We then assign the values to the nearest voxels in 
                        ∂
                        V
                     . Let the distance value of an assigned voxel 
                        
                           q
                        
                      as 
                        
                           
                              h
                           
                           
                              0
                           
                        
                        
                           (
                           
                              q
                           
                           )
                        
                     . We propagate the signed distances to the non-visited neighbor cells in 
                        ∂
                        
                           
                              V
                           
                           
                              N
                           
                        
                     . The value of the newly selected voxel is determined by averaging the visited neighbor cells to generate a smooth surface. These values represent the distances to the target surface from 
                        ∂
                        V
                      and we can determine the position of a new vertex using them during the advancing front method (AFM) procedure.

Another consideration is to make the target surface more closely resemble 
                        ∂
                        V
                      moving away from 
                        ∂
                        
                           
                              S
                           
                           
                              C
                           
                        
                     . We define the modified distance function 
                        H
                        
                           (
                           
                              q
                           
                           )
                        
                      as Eq. (11) to apply this consideration by adopting the geodesic distance 
                        
                           
                              d
                           
                           
                              
                                 
                                    ∂
                                    V
                                 
                                 
                                    C
                                 
                              
                           
                        
                      from the nearest voxels of 
                        ∂
                        
                           
                              S
                           
                           
                              C
                           
                        
                     .
                        
                           (11)
                           
                              H
                              
                                 (
                                 
                                    q
                                 
                                 )
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                0
                                             
                                          
                                          
                                             (
                                             
                                                q
                                             
                                             )
                                          
                                          ×
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      t
                                                   
                                                
                                                −
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      q
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                       
                                          if  
                                          
                                             
                                                d
                                             
                                             
                                                ∂
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      C
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                q
                                             
                                             )
                                          
                                          <
                                          
                                             
                                                D
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          otherwise
                                       
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              D
                           
                           
                              t
                           
                        
                      is a user-defined constraint. We use the half value of the 
                        z
                     -directional height of 
                        
                           
                              S
                           
                           
                              C
                           
                        
                      as 
                        
                           
                              D
                           
                           
                              t
                           
                        
                      for each tooth. Note that 
                        H
                        
                           (
                           
                              q
                           
                           )
                        
                      is stored at 
                        
                           q
                        
                        ∈
                        ∂
                        V
                     , but the meaning is a target signed distance from 
                        ∂
                        V
                      indicating the position of the new vertex of the merged surface.

After computing the target signed distances as a preprocessing step, we then find a new vertex position through three steps. At each boundary face, 
                           f
                        , whose edge 
                           E
                           ∈
                           f
                         is included in 
                           ∂
                           
                              
                                 S
                              
                              
                                 C
                              
                           
                        , we can generate a new initial vertex 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 0
                              
                           
                         on the same plane with 
                           f
                         and in the opposite direction at the midpoint of 
                           E
                        , as shown in Fig. 12
                        (a).

The next step is to find the normal vector of 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 0
                              
                           
                        . We approximate a normal vector of 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 0
                              
                           
                         by comparing the 
                           k
                        -nearest voxel positions from 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 0
                              
                           
                        . We define 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         as shown in Fig. 12(b): 
                           
                              
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             1
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          |
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                1
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                i
                                             
                                          
                                          |
                                       
                                    
                                 
                                 .
                              
                           
                         The new position 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 
                                    new
                                 
                              
                           
                         is then created along the 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         direction from 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 0
                              
                           
                        . Finally we can determine the new vertex position using Eq. (13). Since computing an accurate distance value is very time-consuming and not necessary in this application, we approximate the distance by averaging the pre-calculated values at voxels. Rather than simply averaging 
                           
                              H
                           
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    r
                                 
                              
                              )
                           
                        , we consider the angular distributions of 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 r
                              
                           
                        . The weight of 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 r
                              
                           
                         is computed as an angular occupancy after projecting to the plane that passes 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 0
                              
                           
                         and has the normal vector as 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        . Let us denote the projected point of 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 r
                              
                           
                         as 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 r
                              
                           
                         and its circumcenter as 
                           
                              
                                 
                                    c
                                 
                              
                              
                                 r
                              
                           
                        . The weight of 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 r
                              
                           
                         is 
                           
                              
                                 λ
                              
                              
                                 r
                              
                           
                           
                              (
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        , as shown in Fig. 12(c).

The target distance to be maintained at 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 0
                              
                           
                         is then defined in Eq. (12). 
                           
                              (12)
                              
                                 
                                    
                                       h
                                    
                                    
                                       t
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       r
                                       ∈
                                       N
                                       
                                          (
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       r
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 ⋅
                                 H
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          r
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 where  
                                 
                                    
                                       λ
                                    
                                    
                                       r
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             r
                                          
                                       
                                    
                                    
                                       2
                                       π
                                    
                                 
                                 .
                              
                           
                         The distance at arbitrary position 
                           
                              v
                           
                         can be computed as Eq. (13) where 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 r
                              
                              
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         is the normal vector of 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 r
                              
                              
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        ; the new vertex position 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 
                                    new
                                 
                              
                           
                         is then determined by the condition 
                           h
                           
                              (
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    
                                       new
                                    
                                 
                              
                              )
                           
                           =
                           
                              
                                 h
                              
                              
                                 t
                              
                           
                           
                              (
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        . 
                           
                              (13)
                              
                                 h
                                 
                                    (
                                    
                                       v
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       r
                                       ∈
                                       N
                                       
                                          (
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       r
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       v
                                    
                                    −
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          r
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ⋅
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       r
                                    
                                    
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         From 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 0
                              
                           
                         as the initial value, 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 
                                    new
                                 
                              
                           
                         can be iteratively found along the projection direction 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         by a binary search. The practical experiments show that 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 
                                    new
                                 
                              
                           
                         is found in approximately five iterations within 0.001 mm tolerance.

As mentioned before, even though our approach is technically similar to marching triangles, we call our method AFM since we do not extract an iso-surface. There are two possible cases where we can create new triangles: one of them is to create a face with existing vertices and the other one is to connect an existing edge and a new vertex generated by the method introduced in Section  4.1. Fig. 13
                         shows the two cases. Fig. 13(a) shows the case involving connection with adjacent edges whose angle is less than 
                           
                              
                                 θ
                              
                              
                                 t
                              
                           
                        . If the angle with an adjacent edge in 
                           ∂
                           
                              
                                 S
                              
                              
                                 C
                              
                           
                         is larger than 
                           
                              
                                 θ
                              
                              
                                 t
                              
                           
                        , we check the 3D Delaunay surface constraint to prevent local folding or self-intersections. If there is a vertex 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 i
                              
                           
                         within the Delaunay sphere, then we connect it to the current edge 
                           
                              
                                 E
                              
                              
                                 f
                              
                           
                        . Otherwise, a new vertex is created.

The overall procedure of our AFM is described in Fig. 14
                        . First, we initialize the priority queue (PQ), which contains boundary active edges in the order of the angles to the next connected edges shown in Fig. 13(a) in ascending order. To compute angles efficiently and maintain PQ, the boundary edges are stored as a half edge structure. If 
                           θ
                           >
                           
                              
                                 θ
                              
                              
                                 t
                              
                           
                        , we compute the new vertex position 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 
                                    new
                                 
                              
                           
                         for the current active edge 
                           
                              
                                 E
                              
                              
                                 f
                              
                           
                        , and check the 3D Delaunay surface constraints. If the triangle 
                           T
                         satisfies the constraint, we add 
                           T
                         as a new face to the merge result.

The 3D Delaunay surface constraint is similar to the Delaunay constraint of 2D triangulation. With a triangular face, the meaning of the condition is that there should be no point inside the sphere, called a Delaunay sphere, whose center and radius are consistent with those of the circumcircle of the triangle  [28]. Fig. 15
                           (a) shows a conceptual diagram and Fig. 15(b),(c) describes cases where 
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    
                                       new
                                    
                                 
                              
                            does not satisfy this constraint. To maintain a good aspect ratio, we need to make a new triangle by using the existing vertex which satisfies this constraint.

If we only create a new triangle when it satisfies the 3D Delaunay surface constraint by checking the vertices as shown in Fig. 15, it may cause numerous cracks  [33]. In the case where the 3D Delaunay surface constraint is not satisfied, we can find candidate vertices 
                              
                                 {
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                            inside the Delaunay sphere. Among them, we select the vertex that satisfies the Delaunay surface constraint when a new triangle is created with it. Fig. 16
                            shows several cases of checking the validity of new triangles and the yellow color represents the solution of each case. Fig. 17
                            shows the result of the merging step suggested in this work. Two different regions are connected successfully while maintaining the details of crown features.

Because the resolution between surface meshes and dental CT images are different, we do not need to maintain the scanned surface mesh resolution in a root region higher than CT resolution. A large number of triangles may degrade the efficiency and usability in many applications. For efficiency, triangle sizes adopt the size of the propagated triangle and local curvature with a given error 
                              ε
                           . Eq. (14) shows the rule to determine the new edge length of the new triangle 
                              T
                              [31]. 
                              
                                 (14)
                                 
                                    L
                                    
                                       (
                                       T
                                       )
                                    
                                    =
                                    2
                                    ×
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               κ
                                                            
                                                            
                                                               
                                                                  |
                                                                  
                                                                     max
                                                                  
                                                                  |
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               κ
                                                            
                                                            
                                                               
                                                                  |
                                                                  
                                                                     max
                                                                  
                                                                  |
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   −
                                                   ε
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    κ
                                 
                                 
                                    
                                       |
                                       
                                          max
                                       
                                       |
                                    
                                 
                              
                              =
                              max
                              
                                 (
                                 
                                    |
                                    
                                       
                                          κ
                                       
                                       
                                          
                                             max
                                          
                                       
                                    
                                    |
                                 
                                 ,
                                 
                                    |
                                    
                                       
                                          κ
                                       
                                       
                                          
                                             min
                                          
                                       
                                    
                                    |
                                 
                                 )
                              
                            and 
                              
                                 
                                    κ
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                           , 
                              
                                 
                                    κ
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                            are the normal maximum curvature and minimum curvature of a voxel, respectively. The normal curvature of volume data can be computed by the method introduced in  [34], and we set 
                              ε
                              =
                              0.001
                            in our experiments. In Eq. (14), 
                              1
                              /
                              
                                 
                                    κ
                                 
                                 
                                    
                                       |
                                       
                                          max
                                       
                                       |
                                    
                                 
                              
                            is the radius of the smallest osculating circle at a tooth’s surface point as shown in Fig. 18
                           . The length of the target edge 
                              L
                              
                                 (
                                 T
                                 )
                              
                            is then calculated by Eq. (14).


                           Fig. 19
                            shows a comparison of the results considering the adaptive size (Fig. 19(c)) and otherwise (Fig. 19(b)) for the same tooth model.

To handle metal artifact data in this merging step, we simply remove the crowns that have artifacts from the merging area. Most of the crown surfaces are recovered from the scan data, and the missing part can be restored by smooth hole filling considering the boundary shapes  [6,35–37]. Fig. 20
                         shows the final tooth result with metal artifacts.

@&#EXPERIMENTAL RESULTS@&#

We selected three data sets for the experiments, as shown in Table 1
                        . Even though the number of data sets was not large, it was enough to test the usability and efficiency of our algorithm for various cases because each data set included more than 10 teeth. To test various kinds of data, different data sets from different regions were used.

The optical scan data for sets 1 and 3 were acquired from the iTero intraoral scanner of Align Technology Inc. (San Jose, CA, USA), and its manufacturer’s accuracy specification was 20 μm. Set 2 scan data was acquired from Dental Wings Inc.’ table scanner (Dental Wings Inc., Montreal, QC, Canada), whose accuracy specification was 15 μm.

@&#RESULTS@&#


                        Figs. 21
                        , 22
                        , and 23
                         show the co-segmentation and merging results for data sets 1, 2, and 3, respectively. As shown in these three examples, the proposed algorithm gives high quality results for various data sets regardless of the different shape of teeth without any training set.

We implemented our algorithm using Microsoft Visual C++ version 10.0. The testing platform is a personal computer composed of an Intel Core i7 3 GHz CPU and 8 GB main memory. The computation time with this platform is shown in Table 2
                        .


                        Table 2 shows the total time required for generating all the teeth models of each data set—15 teeth, 12 teeth, and 14 teeth for data sets 1, 2, and 3, respectively. The computation time of co-segmentation is affected by the number of corresponding pairs and the number of voxels and points classified as the crown region for each data type. In the case of the merging step, the computation time is mainly affected by the voxel resolution and the number of teeth in our implementation.

From the experiments, our approach shows reasonable time efficiency. This approach is much faster than manual work, and most applications of teeth model completion are in the diagnosis or planning stage and do not need to be performed in real time.

@&#EVALUATION@&#

In our problem, it is not simple to measure numerical accuracies of the segmentation results. Especially for volumetric data, accuracy is dependent on the spatial resolution of the volume and scanning position. In addition, for our problem, the co-segmentation result is more important than single segmentations. One of the valid methods is to compare the manual segmentation results obtained from specialists in this field by considering that manual segmentation is practically used in many dental applications. Therefore, we measured traditional sensitivity and specificity based on the manual segmentation results, widely used in medical image segmentation, to evaluate the proposed method for co-segmentation.

First, an expert who has been working for a dental solution company for more than 3 years manually classified the crown and non-crown regions with the scanned surface. We then compared the segmentation results to the manual classifications by considering the latter as ground-truths. To evaluate the proposed co-segmentation approach, we also tested single segmentation results using surface meshes only via graph-cut and co-segmentation results without a dissimilarity term. We only evaluated the co-segmentation results of the scanned surfaces except for the volume data and merging part, because it is difficult to obtain the ground-truth of the root region. Furthermore, it is not meaningful to compare the root regions due to their low resolution and artifacts such as partial volume effects. In addition, the exact boundary geometries of root regions are not important but the overall positions and directions are considered to be meaningful information in many dental applications.

To quantify the evaluation, we performed sensitivity-specificity analysis for the test sets. The positive region represents the crown region, and the negative region is mapped to the non-crown region in our problem. The sensitivity and specificity are defined as Eq. (15). TP means true positive, which means correctly identified as the crown region, the vertices classified as crowns on both sides of the co-segmentation result and the ground-truth. FN means false negative, which means incorrectly rejected vertices in the co-segmentation result even though they are classified as the crown region in the ground-truth. Similarly, FP means false positive, which means incorrectly identified, and TN means true negative, which means correctly rejected. The meaning of the symbol # is ‘the number of’. 
                           
                              (15)
                              
                                 Sensitivity
                                 =
                                 
                                    
                                       #
                                       
                                       
                                          TP
                                       
                                    
                                    
                                       
                                          (
                                          #
                                          
                                          
                                             TP
                                          
                                          )
                                       
                                       +
                                       
                                          (
                                          #
                                          
                                             FN
                                          
                                          )
                                       
                                    
                                 
                                 ,
                                 
                                 Specificity
                                 =
                                 
                                    
                                       #
                                       
                                       
                                          TN
                                       
                                    
                                    
                                       
                                          (
                                          #
                                          
                                          
                                             TN
                                          
                                          )
                                       
                                       +
                                       
                                          (
                                          #
                                          
                                          
                                             FP
                                          
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

From Table 3
                        , we can observe that the co-segmentation result with the additional dissimilarity term and similarity shows the highest specificity for the classification ability of non-crown regions. On the other hand, the sensitivity with the dissimilarity term is slightly lower than the segmentation using similarity only. This is because the co-segmentation method with only the similarity term determines the region close to gingival lines as the crown.

In our approach, the higher specificity gives more meaningful results because non-crown regions are extracted from the dental CT data and small missing crown regions also can be recovered from CT images smoothly. However, non-crown regions from the scanned surface may generate erroneous geometry because the segmented crown regions from 
                           S
                         are all used in the merging step.

The classification ability of our approach between teeth, interstices, and gingival regions is shown experimentally. Our method can be applied to dental CT containing metal artifacts with high accuracy on par with that of normal data.

@&#CONCLUSION@&#

We have developed a novel teeth modeling framework by combining optical scan data and dental CT images. The suggested approach can overcome difficulties in completing teeth models from each data type using existing approaches. This approach is more meaningful when one data set has defects such as metal artifacts in dental CT.

Dental computer-aided design (CAD) systems have been intensively introduced to digital dentistry in recent years. As basic digital models, individual teeth models with complete and accurate shapes are largely available in many dental fields including orthodontics, especially when planning treatments or surgeries. In addition, digitized planning data can be directly used for producing surgical guides or orthodontic appliances if we have a complete teeth model. Nevertheless, few cases have been practically used to date because it is difficult, expensive, and time-consuming to obtain an individual teeth model.

Our approach is robust and time efficient, and shows high fidelity. Because our method remedies the disadvantages and defects of one data set from another data type, it gives robust results regardless of data properties. It may lead to many related modules of dental CAD by significantly reducing the interventions of manual operations. In addition, we anticipate that our study may lead to the increased usability of digital teeth models in virtual surgery and planning and can also be used for diagnosis purposes in orthodontics. This method can also be helpful in reducing the time and cost involved fabricating orthodontic appliances.

@&#ACKNOWLEDGMENTS@&#

Our program was implemented on OnDemand3D system of Cybermed Inc. This research was partially supported by the Basic Science Research Program through the National Research Foundation of Korea (NRF) by the Ministry of Science, ICT and Future Planning (NRF-2012R1A1A3012995).

Supplementary material related to this article can be found online at http://dx.doi.org/10.1016/j.cad.2015.04.008.

The following is the Supplementary material related to this article. 
                        
                           Video S1
                           
                              Video showing the overall procedure to combine CT with surface scan.
                           
                           
                        
                     
                  

@&#REFERENCES@&#

