@&#MAIN-TITLE@&#Speech enhancement using Maximum A-Posteriori and Gaussian Mixture Models for speech and noise Periodogram estimation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We use Gaussian Mixture Modelling (GMM) to model Periodograms of speech and noise.


                        
                        
                           
                           A method to find the proper size of GMMs is discussed.


                        
                        
                           
                           We propose a Maximum A-Posteriori (MAP) Periodogram estimation using GMMs.


                        
                        
                           
                           The GMMs are used to enhance the noisy speech using Wiener filter.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Gaussian Mixture Model (GMM)

Maximum A-Posteriori (MAP)

Wiener filter

Speech enhancement

@&#ABSTRACT@&#


               
               
                  In speech enhancement, Gaussian Mixture Models (GMMs) can be used to model the Probability Density Function (PDF) of the Periodograms of speech and different noise types. These GMMs are created by applying the Estimate Maximization (EM) algorithm on large datasets of speech and different noise type Periodograms and hence classify them into a small number of clusters whose centroid Periodograms are the mean vectors of the GMMs. These GMMs are used to realize the Maximum A-Posteriori (MAP) estimation of the speech and noise Periodograms present in a noisy speech observation. To realize the MAP estimation, use of a constrained optimization algorithm is proposed in which relatively good enhancement results with high processing times are attained. Due to the use of constraints in the optimization algorithm, incorrect estimation results may arise due to possible local maxima. A simple analytic MAP algorithm is proposed to attain global maximums in lower calculation times. With the new method the complicated MAP formula is simplified as much as possible to find the maxima, through solving a set of equations and not through conventional numerical methods used in optimization. This method results in excellent speech enhancement with a relatively short processing time.
               
            

@&#INTRODUCTION@&#

Speech is the simplest, most efficient and most frequent way of communication among human beings. There are lots of applications that transmit, amplify and understand these signals such as mobile communication, hearing aids and speech recognition systems. Due to the modern requirement of portability of these applications, they must perform in differing environments with different background noise types and levels. The background noise will highly degrade the performance of these applications, specially the quality and intelligibility of the output speech signal and hence speech enhancement algorithms can play a critical role in these applications.

As discussed in Mohammadiha et al. (2013a), speech enhancement algorithms can be classified into two main categories: unsupervised and supervised algorithms. The simplest and most famous speech enhancement method is spectral subtraction (Boll, 1979) in which the spectral amplitude of noise is estimated from the spectral amplitude of noisy speech and subtracted from it to get to the spectral amplitude of clean speech. Since there are no considerations of the speech spectrum in spectral subtraction, it results in an artificial noise called musical noise. To reduce this musical noise some methods discussed in Sim et al. (1998) can be used which are simple but require an efficient Voice Activity Detector (VAD) to estimate the noise spectrum. In these methods the amplitude of the spectrum is used, but in Lu and Loizou (2008) the complex spectrum is considered. In Wiener filtering (Widrow and Mccool, 1975), speech and noise probabilistic properties are used and hence the enhanced speech suffers from less musical noise with respect to spectral subtraction methods. A method called Short Time Spectral Amplitude (STSA) is discussed in Ephraim and Malah (1984), which is based on Minimum Mean Square Error (MMSE) estimation with the assumption that the speech and noise spectral components are statistically independent and Gaussian random variables. The MMSE-STSA method is derived by minimizing a conditional mean square value of the short time spectral amplitude. As discussed in Wolfe and Godsil (2003), when PDFs of speech and noise spectrums are assumed to be Gaussian, the spectral gain will become the Wiener filter gain. This method is based on the a priori SNR estimation on a frame-by-frame basis by a decision directed approach and Maximum Likelihood (ML) estimator with the assumption that the noise variance is known or can be estimated during the silence intervals. There are different methods to calculate the a priori SNR. A decision directed method is discussed in Cappe (1994). A data driven approach to calculate a priori SNR is discussed in Suhadi et al. (2011) in which two trained artificial neural networks, one for speech and one for noise, is used. As confirmed in the literature, the MMSE spectral gain is superior to the spectral subtraction method but is computationally complicated to implement. To overcome this issue, a method discussed in Wolfe and Godsil (2003) called the Maximum A-Posteriori (MAP) method, which can result in relatively good enhancement results is used.

In supervised speech enhancement algorithms we use some additional information about noise and speech such as noise type, speaker identity etc. to improve the enhancement. In supervised methods we create some offline models for speech and noise which are trained using large observed samples of each signal. Some examples of this class of algorithms include the codebook based approaches as discussed in Sreenivas and Kirnapure (1996), where LPC codebooks of speech are used and in Srinivasan et al. (2006), AR coefficient codebooks of speech and noise are used which leads to ML estimates of clean speech. Another well-known and high performance supervised speech enhancement methods are Hidden Markov Model (HMM) based systems and the state-of-the-art approaches are discussed in references (Ephraim, 1992; Sameti et al., 1998; Zhao and Kleijn, 2007). In these methods, the waveform signal is modelled as an autoregressive (AR) process, and hence the waveforms of speech and noise signals are modelled by HMMs. In recent HMM based methods as discussed in Mohammadiha et al. (2013b), Mohammadiha and Leijon (2013) and Veisi and Sameti (2013), distribution of the power spectral coefficients of speech and noise are modelled using HMMs using Gamma distribution. There are also other methods that are based on modelling the spectral amplitude of speech using Gaussian Mixture Modelling (GMM) in which estimates of speech are attained using a MAP criterion as discussed in Hao et al. (2009, 2010) and Fodor and Fingscheidt (2011) and a minimum mean-square error (MMSE) criterion as discussed in Burshteinand and Gannot (2002). The advantage of the supervised approaches such as the HMM based denoising algorithm is that it produces high quality enhanced speech signals. The reason for this is that for each noise type, a system is trained a priori. This is a tedious task in practice and is addressed in Mohammadiha et al. (2013a).

In most supervised model based algorithms, GMM is used for the modelling of spectral amplitudes, log spectral amplitudes or Periodograms with their true power and some of these methods give excellent enhancement results. In this research we are going to use normalized Periodograms (with power equal to one) as the vectors to be modelled. In most Bayesian estimation criterions especially MAP estimation, due to the complexity of the estimation criterion formula, some mathematical distributions like Laplacian or Gamma are used to simplify the formula. Here we aim to use GMM to realize an explicit MAP estimate of speech signals. These are different methods from the previous work discussed in Wolfe and Godsil (2003) and Lotter and Vary (2005) (which use approximated distributions to simplify the MAP formula) and hence our aim is to realize the MAP with no approximations.

In our previous research we used model-based speech enhancement methods such as codebook constrained Wiener filtering and Bayesian estimation. In codebook constrained Wiener filtering, we used the K-means algorithm to classify the large datasets of speech and noise normalized Periodograms into some centroids. In this way the Periodograms are classified based on their variety and shape with normal power (Chehresa and Savoji, 2009, 2010). Despite the large sizes of codebooks, poor enhancement results were attained. Later we used Gaussian Mixture Modelling (GMM) in which we modelled the Probability Density Function (PDF) of speech and noise Periodograms (Chehresa and Savoji, 2011). In this way we assumed that the PDF of speech and noise Periodograms could be represented by the sum of some Gaussians and in this way, better enhancement results and lower processing times were attained (Chehresa and Savoji, 2012a). In those methods the number of centroids was much less than the codebook centroids in codebook constrained methods. We also used these GMMs to realize the Bayesian estimation of speech and noise Periodograms. In this way we used MMSE and MAP criterions and used an implicit method to implement these two criterions (Chehresa and Savoji, 2012b, 2014). Coping with the fast changes of speech Periodograms from silent frames to active ones and vice versa, the MAP criterion offered better enhancement results than MMSE and hence we are focusing on this method to find more practical ways to realize it and use better GMMs to increase the enhancement results. In our previously introduced methods, we used an implicit realization of MAP which was based on some approximations on the PDF formulation of speech and noise using GMM. Here we are going to implement the MAP criterion without any approximations and hence propose an explicit method to realize it. We also previously used some GMMs with 6 Gaussians for speech and 9 Gaussians for noise in which the number of Gaussians were calculated by trial and error. However, in this paper we will propose a rigorous method to find the reasonable number of mixtures in the GMMs.

In Section 2, we discuss the Gaussian Mixture Modelling of the PDF of Periodogram vectors. In Section 3, we realize explicit MAP using GMM with no approximation by means of an optimization algorithm. In Section 4, we discuss a method that could be used as a replacement of the optimization algorithm and gives an explicit formula for realization of MAP with no approximation. In Section 5, the proposed algorithms are tested and the enhancement results are reported.

We assume that the noisy speech in the time domain is the sum of speech and noise as in x(t)=
                     s(t)+
                     n(t) where x, s and n are noisy speech, speech and noise respectively and t represents the discrete time index. As discussed in Chehresa and Savoji (2010), all these time domain signals are divided into some short time overlapping windowed frames to preserve the stationarity assumption. By applying an FFT of size 2Ω on each frame we have X(ω′)=
                     S(ω′)+
                     N(ω′) in which X, S and N are the spectrums of noisy speech, speech and noise respectively and ω′∈{−
                     Ω
                     +1, …, Ω} is the discrete frequency index. Using these calculated spectrums, we can calculate the Periodograms of speech, noise and noisy speech as P
                     
                        s
                     (ω′)=
                     S(ω′)S*(ω′)=|S(ω′)|2, P
                     
                        n
                     (ω′)=
                     N(ω′)N*(ω′)=|N(ω′)|2 and P
                     
                        x
                     (ω′)=
                     X(ω′)X*(ω′)=|X(ω′)|2 in which * shows the complex conjugate and the | |2 operator calculates the squared amplitude of each spectrum. Under the assumption that speech and noise are uncorrelated which discussed in section 9.3.1.1 of Loizou (2013) and by taking half band plus zero frequencies (due to the symmetric nature of the Periodogram), we can approximately say P
                     
                        x
                     (ω)=
                     P
                     
                        s
                     (ω)+
                     P
                     
                        n
                     (ω) in which ω is the discrete frequency index as ω
                     ∈{0, 1, …, Ω}. In this way each Periodogram vector has Ω
                     +1 elements. As mentioned in Chehresa and Savoji (2011), we have some sample speech files of different speakers saying different sentences and sample noise signals to train the GMMs of speech and different noise types. To train the GMMs of speech and different noise types Periodograms, we need large datasets of their corresponding Periodograms. All these training files of speech and different noise types, are divided into overlapping frames in time domain and for each frame the Periodogram is calculated. The speech frames contain all active and silent frames of speech. The power of each Periodogram is normalized and made equal to 1 by dividing by the sum of its elements and inserted into corresponding Periodogram datasets. In this way we create large Periodogram datasets for clean speech and each noise type. Each Periodogram dataset can be considered as a matrix with Ω
                     +1 columns reflecting the size of each Periodogram vector and M rows which can be as large as hundred thousand. In each dataset, we will have a collection of Periodograms with their powers equal to 1 and different shapes and hence we can observe the changes in the shapes of Periodograms regardless of their powers. We can take each Periodogram (each row) of these datasets as a point in a Ω
                     +1 dimensional space as symbolically shown in Fig. 1
                      and each colony of Periodograms can be considered as a Gaussian distribution which are separated by circles. This figure not representing the real Periodogram clusters but an exaggerated symbolic illustration of the Periodogram distribution.

The centre of each colony can be taken as the mean vector of that Gaussian, and the number of vectors in each class with respect to the total number of vectors shows the probability of that class. In the training procedure we used 32ms frames for the time domain signals. Using the Periodograms of these frames, we can have some repeating patterns of Periodograms of utterances based on their shapes in different speech signals while building the Periodogram datasets. Hence Fig. 1 can be thought of as a reasonable illustration of the distribution of Periodograms in the Ω
                     +1 dimensional space.

In Vaseghi (2008), we applied the EM algorithm on these large datasets of speech and noise Periodograms to generate GMMs. By setting the desired number of GMM mixtures as K for the EM algorithm, which is an iterative algorithm, it will result in K scalar probabilities, K mean vectors of size 1×
                     Ω and K covariance matrixes of size Ω
                     ×
                     Ω for the final GMM. We can show the PDF of a Periodogram as 
                        P
                     
                     =
                     P(ω) as below:
                        
                           (1)
                           
                              
                                 f
                                 (
                                 
                                    P
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       π
                                       k
                                    
                                    
                                       G
                                       k
                                    
                                    (
                                    
                                       P
                                    
                                    ;
                                    
                                       
                                          μ
                                       
                                       k
                                    
                                    ,
                                    
                                       Σ
                                       k
                                    
                                    )
                                 
                                 ,
                                  
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       π
                                       k
                                    
                                 
                                 =
                                 1
                              
                           
                        
                     where f is the PDF and π
                     
                        k
                      is the probability of the kth mixture (Gaussian) of the GMM which means the number of Periodogram vectors in the kth cluster with respect to the total number of Periodograms that exist in the dataset. G
                     
                        k
                      is the kth Gaussian with mean vector of 
                        μ
                     
                     
                        k
                     
                     =
                     μ
                     
                        k
                     (ω) and covariance matrix of Σ
                     
                        k
                     . Also K is the total number of mixtures in the GMM. For simplicity of the formulas, the vector names with (ω) indexes are replaced with their bold version without frequency index. We can show G
                     
                        k
                     , which is a scalar, in terms of 
                        μ
                     
                     
                        k
                      and Σ
                     
                        k
                      as below:
                        
                           (2)
                           
                              
                                 
                                    G
                                    k
                                 
                                 (
                                 
                                    P
                                 
                                 ;
                                 
                                    
                                       μ
                                    
                                    k
                                 
                                 ,
                                 
                                    Σ
                                    k
                                 
                                 )
                                 =
                                 
                                    
                                       exp
                                       
                                          
                                             −
                                             
                                                1
                                                2
                                             
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            P
                                                         
                                                         /
                                                         
                                                            P
                                                            ¯
                                                         
                                                         )
                                                         −
                                                         
                                                            
                                                               μ
                                                            
                                                            k
                                                         
                                                      
                                                   
                                                
                                                T
                                             
                                             
                                                ∑
                                                k
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                (
                                                
                                                   P
                                                
                                                /
                                                
                                                   P
                                                   ¯
                                                
                                                )
                                                −
                                                
                                                   
                                                      μ
                                                   
                                                   k
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             2
                                             π
                                             )
                                          
                                          
                                             (
                                             Ω
                                             +
                                             1
                                             )
                                             /
                                             2
                                          
                                       
                                       |
                                       
                                          Σ
                                          k
                                       
                                       
                                          |
                                          
                                             1
                                             /
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     where |Σ
                     
                        k
                     | denotes the determinant of the covariance matrix and 
                        
                           
                              P
                              ¯
                           
                           =
                           
                              ∑
                              
                                 ω
                                 =
                                 0
                              
                              Ω
                           
                           
                              P
                              (
                              ω
                              )
                           
                        
                      is the power of P(ω). We divided P(ω) by its power since we are dealing with different powers for the input P(ω) while the power of 
                        μ
                     
                     
                        k
                      is equal to 1. To reduce the computational complexity, we assume that the covariance matrixes are diagonal. In this way, we can take 
                        σ
                     
                     
                        k
                     
                     =
                     σ
                     
                        k
                     (ω) as the elements of covariance matrix diagonal and take it as the variance vector. Rewriting (2) as we obtain:
                        
                           (3)
                           
                              
                                 
                                    G
                                    k
                                 
                                 (
                                 
                                    P
                                 
                                 ;
                                 
                                    
                                       μ
                                    
                                    k
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    k
                                 
                                 )
                                 =
                                 
                                    1
                                    
                                       
                                          
                                             (
                                             2
                                             π
                                             )
                                          
                                          
                                             (
                                             Ω
                                             +
                                             1
                                             )
                                             /
                                             2
                                          
                                       
                                       |
                                       
                                          
                                             σ
                                          
                                          k
                                       
                                       
                                          |
                                          
                                             1
                                             /
                                             2
                                          
                                       
                                    
                                 
                                 exp
                                 
                                    
                                       −
                                       
                                          1
                                          2
                                       
                                       
                                          ∑
                                          
                                             ω
                                             =
                                             0
                                          
                                          Ω
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      (
                                                      
                                                         P
                                                      
                                                      /
                                                      
                                                         P
                                                         ¯
                                                      
                                                      )
                                                      −
                                                      
                                                         
                                                            μ
                                                         
                                                         k
                                                      
                                                      )
                                                   
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           |
                           
                              
                                 σ
                              
                              k
                           
                           |
                           =
                           
                              ∏
                              
                                 ω
                                 =
                                 0
                              
                              Ω
                           
                           
                              
                                 σ
                                 k
                              
                              (
                              ω
                              )
                           
                        
                     . A critical parameter in GMM is the number of mixtures which is K in (1). We used the Bayesian Information Criterion (BIC) to find a reasonable number of mixtures as discussed in Fraley and Raftery (2002) and Dasgupta and Raftery (1998). We changed the number of mixtures (K) from 2 to 26 in the EM algorithm and created the corresponding GMMs. We used the EM algorithm in MATLAB using the gmdistribution.fit command in which one of its outputs in addition to probabilities, mean vectors and covariance matrixes is the BIC of the estimated GMM. As discussed in Dasgupta and Raftery (1998), the number of mixtures that represent the maximum BIC, is the best number of mixtures. Since the BIC values calculated for speech and different noise types are different and we are just looking for maximums, to show them in one figure we map the values between 0 and 1 (the actual BIC values are negative and hence we take the minimum value as 0 and the maximum value as 1). The mapped values of BIC with respect to the number of mixtures for speech and different noise types are shown in Fig. 2
                     .

As can be seen from Fig. 2, in our created GMMs, by increasing the number of mixtures from 2 to 26, the BIC values are decreasing constantly and we cannot find the best number of GMM mixtures. This behaviour could be due to the large dimension of the modelled Periodograms which here are vectors with 257 elements. As in Nylund et al. (2007), we tried to calculate the Log-Likelihood of these GMMs and plot them with respect to the number of mixtures. When we are dealing with a Periodogram dataset with M vectors we can calculate the likelihood of one Periodogram of this dataset as below:
                        
                           (4)
                           
                              
                                 L
                                 (
                                 
                                    P
                                    m
                                 
                                 (
                                 ω
                                 )
                                 ,
                                 m
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 M
                                 )
                                 =
                                 
                                    ∏
                                    
                                       m
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    f
                                    (
                                    
                                       P
                                       m
                                    
                                    (
                                    ω
                                    )
                                    )
                                 
                              
                           
                        
                     
                  

Since we are dealing with large Periodogram datasets, L may result in large values which most of the time are assumed as infinity in computer programming languages, hence in our calculations we use Log-Likelihood as below:
                        
                           (5)
                           
                              
                                 
                                    L
                                    
                                       log
                                    
                                 
                                 (
                                 
                                    P
                                    m
                                 
                                 (
                                 ω
                                 )
                                 ,
                                 m
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 M
                                 )
                                 =
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    log
                                    (
                                    f
                                    (
                                    
                                       P
                                       m
                                    
                                    (
                                    ω
                                    )
                                    )
                                    )
                                 
                              
                           
                        
                     
                  

In our previous research, we set the number of mixtures K in (1) as 6 for speech and 9 for noise and these numbers were calculated by trial and error (Chehresa and Savoji, 2012a, 2012b). The larger number of mixtures can result in more accurate estimation of speech and noise Periodograms, since we have more Periodogram varieties among the mean vectors of the GMM, whilst increasing the complexity of calculations. This results in higher processing times. Hence we need to get to a compromise between the accuracy of estimations and the complexity of calculations. For the BIC criterion we calculated L
                     log for each GMM with the number of mixtures changed from 2 to 26. Since the range of calculated Log-Likelihoods for speech and different noise types are different and we wanted to analyze them in one figure, we mapped their range of variation between 0 and 1. These Log-Likelihoods with respect to the number of mixtures for speech and different noise types are shown in Fig. 3
                     .

As discussed in Nylund et al. (2007) and could be seen in Fig. 3, for small numbers of mixtures, the curves are quite steep and with increasing number of mixtures the slope is reduced. In all the plots at around 10 mixtures the slopes decrease and hence we take 10 as a reasonable number of mixtures for our experiments, which is not too small to decrease the accuracy and is not too big to make calculations complicated. We therefore created GMMs with 10 mixtures for speech and different noise types. As discussed in Nylund et al. (2007), this is not a deterministic method for finding the number of mixtures in GMMs but a way to select the number of mixtures with a degree of rigour.

To attain MAP estimates of speech and noise Periodograms using GMMs, as discussed in section 5.6.2 of Vaseghi (2008) and by replacing the time domain noisy speech, speech and noise signals in equation (5.45) of Vaseghi (2008) with their corresponding Periodograms, we should solve the following equations:
                        
                           (6)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                s
                                                
                                                   M
                                                   A
                                                   P
                                                
                                             
                                             =
                                             
                                                
                                                   arg
                                                   max
                                                
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      s
                                                   
                                                
                                             
                                             [
                                             
                                                f
                                                n
                                             
                                             (
                                             
                                                
                                                   P
                                                
                                                x
                                             
                                             −
                                             
                                                
                                                   P
                                                
                                                s
                                             
                                             )
                                             
                                                f
                                                s
                                             
                                             (
                                             
                                                
                                                   P
                                                
                                                s
                                             
                                             )
                                             ]
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                n
                                                
                                                   M
                                                   A
                                                   P
                                                
                                             
                                             =
                                             
                                                
                                                   arg
                                                   max
                                                
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      n
                                                   
                                                
                                             
                                             [
                                             
                                                f
                                                s
                                             
                                             (
                                             
                                                
                                                   P
                                                
                                                x
                                             
                                             −
                                             
                                                
                                                   P
                                                
                                                n
                                             
                                             )
                                             
                                                f
                                                n
                                             
                                             (
                                             
                                                
                                                   P
                                                
                                                n
                                             
                                             )
                                             ]
                                          
                                       
                                    
                                 
                              
                           
                        
                     where f
                     
                        s
                     (
                        P
                     
                     
                        s
                     ) and f
                     
                        n
                     (
                        P
                     
                     
                        n
                     ) are calculated by substituting P
                     
                        s
                     (ω) and P
                     
                        n
                     (ω) in (1) and (2). In (6) and as mentioned in Vaseghi (2008), f
                     
                        s
                     (
                        P
                     
                     
                        s
                     ) and f
                     
                        n
                     (
                        P
                     
                     
                        n
                     ) are assumed as the prior probabilities of 
                        P
                     
                     s and 
                        P
                     
                     
                        n
                     , respectively and f
                     
                        n
                     (
                        P
                     
                     
                        x
                     
                     −
                     
                        P
                     
                     
                        s
                     ) and f
                     
                        n
                     (
                        P
                     
                     
                        x
                     
                     −
                     
                        P
                     
                     
                        s
                     ) as the corresponding likelihoods. Since we know that 
                        P
                     
                     
                        x
                     
                     =
                     
                        P
                     
                     
                        s
                     
                     +
                     
                        P
                     
                     
                        n
                     , we can merge the two equations in (6) and rewrite them as:
                        
                           (7)
                           
                              
                                 
                                    
                                       P
                                    
                                    s
                                    
                                       M
                                       A
                                       P
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    n
                                    
                                       M
                                       A
                                       P
                                    
                                 
                                 =
                                 
                                    
                                       arg
                                       max
                                    
                                    
                                       
                                          
                                             P
                                          
                                          s
                                       
                                       ,
                                       
                                          
                                             P
                                          
                                          n
                                       
                                    
                                 
                                 [
                                 
                                    f
                                    s
                                 
                                 (
                                 
                                    
                                       P
                                    
                                    s
                                 
                                 )
                                 
                                    f
                                    n
                                 
                                 (
                                 
                                    
                                       P
                                    
                                    n
                                 
                                 )
                                 ]
                              
                           
                        
                     
                  

Since there is no explicit solution for realization of this complicated algorithm (the sum of K
                     =10 exponentials for the speech PDF multiplied by the sum of K
                     =10 exponentials for the noise PDF, totally 100 exponential terms), we tried to use optimization algorithms to estimate 
                        
                           
                              
                                 P
                              
                              s
                              
                                 M
                                 A
                                 P
                              
                           
                        
                      and 
                        
                           
                              
                                 P
                              
                              n
                              
                                 M
                                 A
                                 P
                              
                           
                        
                      in a numerical basis. The optimization algorithms are classified as derivative based algorithms and genetic based algorithms in which no information about the optimum path is used. On the other hand, the derivative based algorithms can operate using the explicit derivative of the cost function or finding the best path by trial and error. The optimization algorithms can also be unconstrained or constrained. MATLAB software has a variety of optimization algorithms. The fmincon command in MATLAB is a derivative based algorithm to find the minimum of a cost function. It can input the explicit derivative equation and in the case of not having such an equation, it can calculate the best path using numerical methods. This algorithm performs within constraints which could be fed to it as simple equations. One of the disadvantages of this algorithm while dealing with large input vectors is long processing time. To use fmincon in MATLAB, an initial estimate of speech and noise Periodograms existing in the noisy speech Periodogram are entered to an iterative algorithm. Using predefined conditions, changes are made on these initial estimated Periodograms in such a way to maximize the multiplication of the PDFs of speech and noise Periodograms, which is actually done by minimization of a cost function, and then these new speech and noise Periodograms are entered into the next iteration. These iterations will continue while the changes made to the Periodograms are followed by PDF increase (which is actually the cost function decrease) and not violating the predefined constraints. The initial estimates of the noise Periodogram can be calculated using the Minimum Statistic (MS) method in which the minimums of smoothed noisy speech Periodogram in some successive frames is taken as the Periodogram of noise (Martin, 1994, 2001; Chang, 2013). By subtracting it from the noisy speech Periodogram, we can have an initial estimate of the speech Periodogram. Moreover, the estimated noise Periodogram resulting from the MS method is used to find the right noise codebook. The MS noise Periodogram is first normalized (making its power equal to 1) and then the distance between this noise Periodogram and all the mean vectors of different noise GMMs is calculated. The GMM that contains the mean vector that is the closest to the MS noise Periodogram, will be chosen as the appropriate GMM for the current noisy file. The MAP estimation using optimization is shown in Fig. 4
                     .

In Fig. 4, the resulted 
                        P
                     
                     
                        s0 and 
                        P
                     
                     
                        n0 from MS algorithm is fed to the optimization algorithm (fmincon). The i index represents the ith iteration and hence 
                        P
                     
                     
                        si
                      and 
                        P
                     
                     
                        ni
                      are the Periodograms of speech and noise estimated in the ith iteration. In the cost function, if the value of 1/(f
                     
                        s
                     (
                        P
                     
                     
                        s
                     )f
                     
                        n
                     (
                        P
                     
                     
                        n
                     )) is minimized, then it will result in the maximization of f
                     
                        s
                     (
                        P
                     
                     
                        s
                     )f
                     
                        n
                     (
                        P
                     
                     
                        n
                     ). Since the fmincon optimization algorithm can accept just one vector as the input and here we aim to estimate both 
                        
                           
                              
                                 P
                              
                              s
                              
                                 M
                                 A
                                 P
                              
                           
                        
                      and 
                        
                           
                              
                                 P
                              
                              n
                              
                                 M
                                 A
                                 P
                              
                           
                        
                     , we can concatenate the two Periodogram vectors 
                        
                           
                              
                                 P
                              
                              s
                              
                                 M
                                 A
                                 P
                              
                           
                        
                      and 
                        
                           
                              
                                 P
                              
                              n
                              
                                 M
                                 A
                                 P
                              
                           
                        
                      together as one vector. If we assume 
                        
                           
                              
                                 P
                              
                              s
                           
                           =
                           
                              P
                              s
                           
                           (
                           ω
                           )
                           =
                           [
                           
                              P
                              
                                 
                                    s
                                    0
                                 
                              
                           
                           ,
                           …
                           ,
                           
                              P
                              
                                 
                                    s
                                    Ω
                                 
                              
                           
                           ]
                        
                      and 
                        
                           
                              
                                 P
                              
                              n
                           
                           =
                           
                              P
                              n
                           
                           (
                           ω
                           )
                           =
                           [
                           
                              P
                              
                                 
                                    n
                                    0
                                 
                              
                           
                           ,
                           …
                           ,
                           
                              P
                              
                                 
                                    n
                                    Ω
                                 
                              
                           
                           ]
                        
                      where the number of frequency bins is Ω
                     +1, we can have 
                        
                           
                              
                                 P
                              
                              
                                 s
                                 n
                              
                           
                           =
                           
                              P
                              
                                 s
                                 n
                              
                           
                           (
                           ω
                           )
                           =
                           [
                           
                              P
                              s
                           
                           (
                           ω
                           )
                           ,
                           
                              P
                              n
                           
                           (
                           ω
                           )
                           ]
                           =
                           [
                           
                              P
                              
                                 
                                    s
                                    0
                                 
                              
                           
                           ,
                           …
                           ,
                           
                              P
                              
                                 
                                    s
                                    Ω
                                 
                              
                           
                           ,
                           
                              P
                              
                                 
                                    n
                                    0
                                 
                              
                           
                           ,
                           …
                           ,
                           
                              P
                              
                                 
                                    n
                                    Ω
                                 
                              
                           
                           ]
                        
                      and rewrite (7) as 
                        
                           
                              
                                 P
                              
                              
                                 s
                                 n
                              
                              
                                 M
                                 A
                                 P
                              
                           
                           =
                           [
                           
                              
                                 P
                              
                              s
                              
                                 M
                                 A
                                 P
                              
                           
                           ,
                           
                              
                                 P
                              
                              n
                              
                                 M
                                 A
                                 P
                              
                           
                           ]
                           =
                           
                              
                                 arg
                                 max
                              
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                       n
                                    
                                 
                              
                           
                           [
                           
                              f
                              s
                           
                           (
                           
                              
                                 P
                              
                              s
                           
                           )
                           
                              f
                              n
                           
                           (
                           
                              
                                 P
                              
                              n
                           
                           )
                           ]
                        
                      where 
                        
                           
                              
                                 P
                              
                              
                                 s
                                 n
                              
                              
                                 M
                                 A
                                 P
                              
                           
                        
                      is a vector made up of the two vectors 
                        
                           
                              
                                 P
                              
                              s
                              
                                 M
                                 A
                                 P
                              
                           
                        
                      and 
                        
                           
                              
                                 P
                              
                              n
                              
                                 M
                                 A
                                 P
                              
                           
                        
                     . We use some constraints with fmincon in the form of some input matrixes to the algorithm as below:
                        
                           (8)
                           
                              
                                 
                                    
                                       arg
                                       min
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             s
                                             n
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          1
                                          
                                             f
                                             (
                                             
                                                
                                                   P
                                                
                                                s
                                             
                                             )
                                             f
                                             (
                                             
                                                
                                                   P
                                                
                                                n
                                             
                                             )
                                          
                                       
                                    
                                 
                                  
                                 where
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         s
                                                         n
                                                      
                                                   
                                                   ≤
                                                   
                                                      b
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         e
                                                         q
                                                      
                                                   
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         s
                                                         n
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         e
                                                         q
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      lb
                                                   
                                                   ≤
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         s
                                                         n
                                                      
                                                   
                                                   ≤
                                                   
                                                      ub
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The matrix 
                        A
                      is used to keep the power of estimated speech and noise Periodograms within a range close to the estimated power using the MS method. We take 
                        
                           
                              
                                 P
                                 ¯
                              
                              n
                              
                                 M
                                 S
                              
                           
                           =
                           
                              ∑
                              
                                 ω
                                 =
                                 0
                              
                              Ω
                           
                           
                              
                                 P
                                 n
                                 
                                    M
                                    S
                                 
                              
                              (
                              ω
                              )
                           
                        
                      as noise power and 
                        
                           
                              
                                 P
                                 ¯
                              
                              s
                              
                                 M
                                 S
                              
                           
                           =
                           
                              
                                 P
                                 ¯
                              
                              x
                           
                           −
                           
                              
                                 P
                                 ¯
                              
                              n
                              
                                 M
                                 S
                              
                           
                        
                      as speech power in which the MS superscript stands for minimum statistics method and 
                        
                           
                              
                                 P
                                 ¯
                              
                              x
                           
                           =
                           
                              ∑
                              
                                 ω
                                 =
                                 0
                              
                              Ω
                           
                           
                              
                                 P
                                 x
                              
                              (
                              ω
                              )
                           
                        
                      is the power of noisy speech. We take 0<
                     α
                     <1 as a small permitted tolerance of these powers. Matrix 
                        A
                      is defined in a way that if it is multiplied by 
                        P
                     
                     
                        sn
                      results in the vector 
                        
                           
                              
                                 
                                    ∑
                                    
                                       ω
                                       =
                                       0
                                    
                                    Ω
                                 
                                 
                                    
                                       
                                          P
                                       
                                       s
                                    
                                 
                                 ,
                                 −
                                 
                                    ∑
                                    
                                       ω
                                       =
                                       0
                                    
                                    Ω
                                 
                                 
                                    
                                       
                                          P
                                       
                                       s
                                    
                                 
                                 ,
                                 
                                    ∑
                                    
                                       ω
                                       =
                                       0
                                    
                                    Ω
                                 
                                 
                                    
                                       
                                          P
                                       
                                       n
                                    
                                 
                                 ,
                                 −
                                 
                                    ∑
                                    
                                       ω
                                       =
                                       0
                                    
                                    Ω
                                 
                                 
                                    
                                       
                                          P
                                       
                                       n
                                    
                                 
                              
                           
                        
                      and hence the 
                        b
                      vector is 
                        
                           [
                           (
                           1
                           +
                           α
                           )
                           
                              
                                 P
                                 ¯
                              
                              s
                              
                                 M
                                 S
                              
                           
                           ,
                           −
                           (
                           1
                           −
                           α
                           )
                           
                              
                                 P
                                 ¯
                              
                              s
                              
                                 M
                                 S
                              
                           
                           ,
                           (
                           1
                           +
                           α
                           )
                           
                              
                                 P
                                 ¯
                              
                              n
                              
                                 M
                                 S
                              
                           
                           ,
                           −
                           (
                           1
                           −
                           α
                           )
                           
                              
                                 P
                                 ¯
                              
                              n
                              
                                 M
                                 S
                              
                           
                           ]
                        
                     . The 
                        A
                     
                     
                        eq
                      matrix is defined in a way that if it is multiplied by 
                        P
                     
                     
                        sn
                      results in 
                        P
                     
                     
                        s
                     
                     +
                     
                        P
                     
                     
                        n
                      and the 
                        b
                     
                     
                        eq
                      vector is taken as 
                        P
                     
                     
                        x
                     . Also the 
                        lb
                      vector has the same length of 
                        P
                     
                     
                        sn
                      and defines the lower bound on 
                        P
                     
                     
                        sn
                     . Since all the elements of the estimated Periodogram vectors cannot be negative, we set 
                        lb
                      as an all zero vector of the same length as 
                        P
                     
                     
                        sn
                     . There are some other conditions for the fmincon optimization algorithm such as input tolerance or TolX, output tolerance or TolFun and constraint tolerance or TolCon. The iterations of fmincon will stop if the difference of the output of cost function in two consecutive iterations is less than TolFun. TolCon determines the least change in limitations. TolX determines the least change in the input vector. In our experiments the suitable values for these parameters are calculated through trial and error. The resulting 
                        
                           
                              
                                 P
                              
                              s
                              
                                 M
                                 A
                                 P
                              
                           
                        
                      and 
                        
                           
                              
                                 P
                              
                              n
                              
                                 M
                                 A
                                 P
                              
                           
                        
                      are used to construct a Wiener filter to enhance the noisy frame as below:
                        
                           (9)
                           
                              
                                 
                                    
                                       
                                          
                                             W
                                             (
                                             ω
                                             )
                                             =
                                             
                                                
                                                   
                                                      P
                                                      s
                                                      
                                                         M
                                                         A
                                                         P
                                                      
                                                   
                                                   (
                                                   ω
                                                   )
                                                
                                                
                                                   
                                                      P
                                                      s
                                                      
                                                         M
                                                         A
                                                         P
                                                      
                                                   
                                                   (
                                                   ω
                                                   )
                                                   +
                                                   
                                                      P
                                                      n
                                                      
                                                         M
                                                         A
                                                         P
                                                      
                                                   
                                                   (
                                                   ω
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                S
                                                ˆ
                                             
                                             (
                                             ω
                                             )
                                             =
                                             W
                                             (
                                             ω
                                             )
                                             X
                                             (
                                             ω
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              S
                              ˆ
                           
                           
                              ω
                           
                        
                      is the estimated spectrum of clean speech in the noisy frame. By applying inverse FFT, the estimate of the clean speech signal in the time domain frame can be recovered. The enhancement results of this algorithm are shown in Fig. 5
                     .

Due to the complexity of PDF formulation, using optimization algorithms to calculate MAP estimates of speech and noise Periodograms is too computationally time consuming. Hence finding an explicit solution to maximize the multiplication of speech and noise PDFs is of great interest. To find such a solution at first we should simplify the multiplication of speech and noise PDFs. Since the PDFs represent positive values, the maximization of the multiplication of the PDFs is equivalent to the maximization of the logarithm of their product as below:
                        
                           (10)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                s
                                                
                                                   M
                                                   A
                                                   P
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                n
                                                
                                                   M
                                                   A
                                                   P
                                                
                                             
                                          
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   arg
                                                   max
                                                
                                                
                                                   
                                                      P
                                                      s
                                                   
                                                   ,
                                                   
                                                      P
                                                      n
                                                   
                                                
                                             
                                             [
                                             
                                                f
                                                s
                                             
                                             (
                                             
                                                
                                                   P
                                                
                                                s
                                             
                                             )
                                             
                                                f
                                                n
                                             
                                             (
                                             
                                                
                                                   P
                                                
                                                n
                                             
                                             )
                                             ]
                                          
                                       
                                    
                                    
                                       
                                           
                                       
                                       
                                          
                                             ≡
                                             
                                                
                                                   arg
                                                   max
                                                
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      s
                                                   
                                                   ,
                                                   
                                                      
                                                         P
                                                      
                                                      n
                                                   
                                                
                                             
                                             [
                                             ln
                                             (
                                             
                                                f
                                                s
                                             
                                             (
                                             
                                                
                                                   P
                                                
                                                s
                                             
                                             )
                                             
                                                f
                                                n
                                             
                                             (
                                             
                                                
                                                   P
                                                
                                                n
                                             
                                             )
                                             )
                                             ]
                                             =
                                             
                                                
                                                   arg
                                                   max
                                                
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      s
                                                   
                                                   ,
                                                   
                                                      
                                                         P
                                                      
                                                      n
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ln
                                                            (
                                                            
                                                               f
                                                               s
                                                            
                                                            (
                                                            
                                                               
                                                                  P
                                                               
                                                               s
                                                            
                                                            )
                                                            )
                                                            +
                                                            ln
                                                            (
                                                            
                                                               f
                                                               n
                                                            
                                                            (
                                                            
                                                               
                                                                  P
                                                               
                                                               n
                                                            
                                                            )
                                                            )
                                                         
                                                      
                                                   
                                                   ︸
                                                
                                                T
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

In this way the maximization of f
                     
                        s
                     (
                        P
                     
                     
                        s
                     )f
                     
                        n
                     (
                        P
                     
                     
                        n
                     ) could be replaced with the maximization of T
                     =ln(f
                     
                        s
                     (
                        P
                     
                     
                        s
                     ))+ln(f
                     
                        n
                     (
                        P
                     
                     
                        n
                     )). In (10) each PDF is the sum of 10 exponentials as in (1) and (2) and hence we can consider 
                        
                           
                              f
                              s
                           
                           (
                           
                              
                                 P
                              
                              s
                           
                           )
                           =
                           
                              f
                              
                                 
                                    s
                                    1
                                 
                              
                           
                           (
                           
                              
                                 P
                              
                              s
                           
                           )
                           +
                           ⋯
                           +
                           
                              f
                              
                                 
                                    s
                                    
                                       10
                                    
                                 
                              
                           
                           (
                           
                              
                                 P
                              
                              s
                           
                           )
                        
                      and 
                        
                           
                              f
                              n
                           
                           (
                           
                              
                                 P
                              
                              n
                           
                           )
                           =
                           
                              f
                              
                                 
                                    n
                                    1
                                 
                              
                           
                           (
                           
                              
                                 P
                              
                              n
                           
                           )
                           +
                           ⋯
                           +
                           
                              f
                              
                                 
                                    n
                                    
                                       10
                                    
                                 
                              
                           
                           (
                           
                              
                                 P
                              
                              n
                           
                           )
                        
                     . From Jensen's inequality we know that:
                        
                           (11)
                           
                              
                                 
                                    
                                       
                                          
                                             ln
                                             (
                                             
                                                f
                                                s
                                             
                                             (
                                             
                                                
                                                   P
                                                
                                                s
                                             
                                             )
                                             )
                                             ≥
                                             ln
                                             (
                                             
                                                f
                                                
                                                   
                                                      s
                                                      1
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   P
                                                
                                                s
                                             
                                             )
                                             )
                                             +
                                             ⋯
                                             +
                                             ln
                                             (
                                             
                                                f
                                                
                                                   
                                                      s
                                                      
                                                         10
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   P
                                                
                                                s
                                             
                                             )
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             ln
                                             (
                                             
                                                f
                                                n
                                             
                                             (
                                             
                                                
                                                   P
                                                
                                                n
                                             
                                             )
                                             )
                                             ≥
                                             ln
                                             (
                                             
                                                f
                                                
                                                   
                                                      s
                                                      n
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   P
                                                
                                                n
                                             
                                             )
                                             )
                                             +
                                             ⋯
                                             +
                                             ln
                                             (
                                             
                                                f
                                                
                                                   
                                                      n
                                                      
                                                         10
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   P
                                                
                                                n
                                             
                                             )
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                             ≥
                                             ln
                                             (
                                             
                                                f
                                                
                                                   
                                                      s
                                                      1
                                                   
                                                
                                             
                                             )
                                             +
                                             …
                                             +
                                             ln
                                             (
                                             
                                                f
                                                
                                                   
                                                      s
                                                      
                                                         10
                                                      
                                                   
                                                
                                             
                                             )
                                             +
                                             ln
                                             (
                                             
                                                f
                                                
                                                   
                                                      s
                                                      n
                                                   
                                                
                                             
                                             )
                                             +
                                             ⋯
                                             +
                                             ln
                                             (
                                             
                                                f
                                                
                                                   
                                                      n
                                                      
                                                         10
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     where in the last equation we eliminated the 
                        P
                     
                     
                        s
                      and 
                        P
                     
                     
                        n
                      variables for simplicity. As discussed in Beal and Ghahramani (2003), to maximize the T term in (10), we can maximize its lower bound as shown in the last equation of (11). Our experiments show that this maximization of the lower bound of T almost always results in the maximum of the T term. The exceptional cases can be considered as the estimation error. Hence, by the assumptions that we made, we can claim that the maximization of logarithm of sum of some positive exponentials in the PDF formula can be taken equivalent to the maximization of the sum of logarithms of those values. So we can insert the logarithm into the summations of exponentials of each PDF. In this way, by replacing the PDFs using (1) and (3), we can rewrite (10) as below:
                        
                           (12)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                s
                                                
                                                   M
                                                   A
                                                   P
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                n
                                                
                                                   M
                                                   A
                                                   P
                                                
                                             
                                          
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   arg
                                                   max
                                                
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      s
                                                   
                                                   ,
                                                   
                                                      
                                                         P
                                                      
                                                      n
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      K
                                                   
                                                   
                                                      [
                                                      ln
                                                      (
                                                      
                                                         π
                                                         
                                                            
                                                               s
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         G
                                                         
                                                            
                                                               s
                                                               k
                                                            
                                                         
                                                      
                                                      )
                                                      +
                                                      ln
                                                      (
                                                      
                                                         π
                                                         
                                                            
                                                               n
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         G
                                                         
                                                            
                                                               n
                                                               k
                                                            
                                                         
                                                      
                                                      )
                                                      ]
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                           
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   arg
                                                   max
                                                
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      s
                                                   
                                                   ,
                                                   
                                                      
                                                         P
                                                      
                                                      n
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      K
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               C
                                                               k
                                                            
                                                            −
                                                            
                                                               1
                                                               2
                                                            
                                                            
                                                               ∑
                                                               
                                                                  ω
                                                                  =
                                                                  0
                                                               
                                                               Ω
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 (
                                                                                 
                                                                                    
                                                                                       Q
                                                                                    
                                                                                    s
                                                                                 
                                                                                 −
                                                                                 
                                                                                    
                                                                                       μ
                                                                                    
                                                                                    
                                                                                       
                                                                                          s
                                                                                          k
                                                                                       
                                                                                    
                                                                                 
                                                                                 )
                                                                              
                                                                              2
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 σ
                                                                              
                                                                              
                                                                                 
                                                                                    s
                                                                                    k
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 (
                                                                                 
                                                                                    
                                                                                       Q
                                                                                    
                                                                                    n
                                                                                 
                                                                                 −
                                                                                 
                                                                                    
                                                                                       μ
                                                                                    
                                                                                    
                                                                                       
                                                                                          n
                                                                                          k
                                                                                       
                                                                                    
                                                                                 
                                                                                 )
                                                                              
                                                                              2
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 σ
                                                                              
                                                                              
                                                                                 
                                                                                    n
                                                                                    k
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 Q
                              
                              s
                           
                           =
                           
                              Q
                              s
                           
                           (
                           ω
                           )
                           =
                           
                              P
                              s
                           
                           (
                           ω
                           )
                           /
                           
                              ∑
                              
                                 ω
                                 =
                                 0
                              
                              Ω
                           
                           
                              
                                 P
                                 s
                              
                              (
                              ω
                              )
                           
                        
                      and 
                        
                           
                              
                                 Q
                              
                              n
                           
                           =
                           
                              Q
                              n
                           
                           (
                           ω
                           )
                           =
                           
                              P
                              n
                           
                           (
                           ω
                           )
                           /
                           
                              ∑
                              
                                 ω
                                 =
                                 0
                              
                              Ω
                           
                           
                              
                                 P
                                 n
                              
                              (
                              ω
                              )
                           
                        
                      and 
                        
                           
                              G
                              
                                 
                                    s
                                    k
                                 
                              
                           
                        
                      and 
                        
                           
                              G
                              
                                 
                                    n
                                    k
                                 
                              
                           
                        
                      are actually 
                        
                           
                              G
                              
                                 
                                    s
                                    k
                                 
                              
                           
                           (
                           
                              
                                 P
                              
                              s
                           
                           ;
                           
                              
                                 μ
                              
                              
                                 
                                    s
                                    k
                                 
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 
                                    s
                                    k
                                 
                              
                           
                           )
                        
                      and 
                        
                           
                              G
                              
                                 
                                    n
                                    k
                                 
                              
                           
                           (
                           
                              
                                 P
                              
                              n
                           
                           ;
                           
                              
                                 μ
                              
                              
                                 
                                    n
                                    k
                                 
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 
                                    n
                                    k
                                 
                              
                           
                           )
                        
                     . Also C
                     
                        k
                      is a constant as 
                        
                           
                              C
                              k
                           
                           =
                           ln
                           (
                           
                              π
                              
                                 
                                    s
                                    k
                                 
                              
                           
                           )
                           −
                           
                              
                                 Ω
                                 +
                                 1
                              
                              2
                           
                           ln
                           (
                           2
                           π
                           )
                           −
                           
                              1
                              2
                           
                           ln
                           
                              
                                 |
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          s
                                          k
                                       
                                    
                                 
                                 |
                              
                           
                           +
                           ln
                           (
                           
                              π
                              
                                 
                                    n
                                    k
                                 
                              
                           
                           )
                           −
                           
                              
                                 Ω
                                 +
                                 1
                              
                              2
                           
                           ln
                           (
                           2
                           π
                           )
                           −
                           
                              1
                              2
                           
                           ln
                           
                              
                                 |
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          n
                                          k
                                       
                                    
                                 
                                 |
                              
                           
                        
                     . Now to maximize the final extracted function in (12), we calculate its first derivatives with respect to 
                        Q
                     
                     
                        s
                      and 
                        Q
                     
                     
                        n
                      and we take them equal to zero and hence equal to each other.
                        
                           (13)
                           
                              
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       ∑
                                       
                                          ω
                                          =
                                          1
                                       
                                       Ω
                                    
                                    
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   
                                                      s
                                                      k
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   Q
                                                
                                                s
                                             
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      s
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       ∑
                                       
                                          ω
                                          =
                                          1
                                       
                                       Ω
                                    
                                    
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   
                                                      n
                                                      k
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   Q
                                                
                                                n
                                             
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      n
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 0
                              
                           
                        
                     
                  

One of our very basic considerations in getting to all these equations was P
                     
                        s
                     (ω)+
                     P
                     
                        n
                     (ω)=
                     P
                     
                        x
                     (ω) and as we know since they are all Periodogram vectors, their elements just can be positive or zero. In this way, when we write P
                     
                        s
                     (ω)=
                     P
                     
                        x
                     (ω)−
                     P
                     
                        n
                     (ω) or P
                     
                        n
                     (ω)=
                     P
                     
                        x
                     (ω)−
                     P
                     
                        s
                     (ω) as we used in getting from (6) to (7), we consider that there is no negative elements in the resulting P
                     
                        s
                     (ω) and P
                     
                        n
                     (ω) from the subtractions. In this way we are treating each frequency bin independently and we have this consideration almost everywhere in this paper. In (13), the two summations (one on speech variables and the other on noise) are equal to 0. So we can write 
                        
                           
                              ∑
                              
                                 k
                                 =
                                 1
                              
                              K
                           
                           
                              
                                 ∑
                                 
                                    ω
                                    =
                                    1
                                 
                                 Ω
                              
                              
                                 Z
                                 (
                                 ω
                                 ,
                                 k
                                 )
                              
                           
                           =
                           0
                        
                      where Z(ω, k) is a function of frequency and mixture number. With our assumption of independency of frequency bins we can say that for each specific frequency of ω
                     ∈{0, 1, …, Ω} we have 
                        
                           
                              ∑
                              
                                 k
                                 =
                                 1
                              
                              K
                           
                           
                              Z
                              (
                              ω
                              ,
                              k
                              )
                           
                           =
                           0
                        
                     . Hence we can say for each frequency, the value of Z(ω, k) is related to the same frequency from different mixtures. With this assumption, we can differentiate the two sides of (13) with respect to ω and get rid of the summations on ω and rewrite (13) as below:
                        
                           (14)
                           
                              
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                
                                                   s
                                                   k
                                                
                                             
                                          
                                          −
                                          
                                             
                                                Q
                                             
                                             s
                                          
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   s
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                
                                                   n
                                                   k
                                                
                                             
                                          
                                          −
                                          
                                             
                                                Q
                                             
                                             n
                                          
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   n
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 0
                              
                           
                        
                     
                  

In the same way as discussed in Section 3, the MS method is used to determine the proper noise GMM. As discussed in Section 3, we can also use the MS estimates of noise Periodogram to find the right power for the final MAP Periodograms of speech and noise. To solve (14), 
                        Q
                     
                     
                        s
                      and 
                        Q
                     
                     
                        n
                      are replaced with 
                        
                           
                              
                                 P
                              
                              s
                           
                           /
                           
                              
                                 P
                                 ¯
                              
                              s
                              
                                 M
                                 S
                              
                           
                        
                      and 
                        
                           
                              
                                 P
                              
                              n
                           
                           /
                           
                              
                                 P
                                 ¯
                              
                              n
                              
                                 M
                                 S
                              
                           
                        
                      and then 
                        P
                     
                     
                        n
                      is replaced with 
                        P
                     
                     
                        x
                     
                     −
                     
                        P
                     
                     
                        s
                     . We can then calculate the MAP estimate of the speech Periodogram as:
                        
                           (15)
                           
                              
                                 
                                    
                                       P
                                    
                                    s
                                    
                                       M
                                       A
                                       P
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          K
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         μ
                                                         
                                                            
                                                               s
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                         
                                                            
                                                               s
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         μ
                                                         
                                                            
                                                               n
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                         
                                                            
                                                               n
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                x
                                             
                                          
                                          
                                             
                                                
                                                   P
                                                   ¯
                                                
                                                n
                                                
                                                   M
                                                   S
                                                
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          K
                                       
                                       
                                          
                                             
                                                
                                                   1
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            
                                                               n
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          1
                                          
                                             
                                                
                                                   P
                                                   ¯
                                                
                                                s
                                                
                                                   M
                                                   S
                                                
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          K
                                       
                                       
                                          
                                             
                                                
                                                   1
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            
                                                               s
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          1
                                          
                                             
                                                
                                                   P
                                                   ¯
                                                
                                                n
                                                
                                                   M
                                                   S
                                                
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          K
                                       
                                       
                                          
                                             
                                                
                                                   1
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            
                                                               n
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

We can calculate 
                        
                           
                              
                                 P
                              
                              n
                              
                                 M
                                 A
                                 P
                              
                           
                        
                      through 
                        
                           
                              
                                 P
                              
                              n
                              
                                 M
                                 A
                                 P
                              
                           
                           =
                           
                              
                                 P
                              
                              x
                           
                           −
                           
                              
                                 P
                              
                              s
                              
                                 M
                                 A
                                 P
                              
                           
                        
                      and zero any resulting negative elements. Then using (9) we can enhance the noisy frame. The enhancement results of this algorithm are shown in Fig. 5.

@&#EXPERIMENTAL RESULTS@&#

We have formed 6 noise Periodogram datasets using long files of each noise type babble, white, pink, destroyer engine, factory and HF channel and each noise file contains more than 1.8 million samples. The noise files are converted from originally 16kHz to 8kHz from NOISEX dataset available on the Rice University Digital Signal Processing (DSP) group home page (TR University, 1995). We have also created a speech Periodogram dataset using training data obtained from the TIMIT dataset (Garofolo et al., 1993) with more than 4500 files and each speech file containing around 30,000–60,000 samples. The speech files are also quantized with 16 bit and converted from 16kHz originally to 8kHz. The test files of speech and noise (TIMIT has some test speech files and from each noise file some samples are not used in the Periodogram dataset collection and are used instead as test files) are used to create noisy observations at −5, 0, 5 and 10dB input SNRs. We set the parameters of fmincon function as Tol/Fun
                     =10, Tol/Con
                     =10−3 and TolX=10−3 which are calculated by trial and error. As we decrease these values, the number of iterations in the optimization algorithm will increase and will result in higher accuracy and hence higher processing time. We found that for values lower than these, the accuracy will not increase significantly. To analyze the performance of the simple MAP algorithm we compared our results with the NMF method discussed in Mohammadiha et al. (2013a) which has reported outstanding speech enhancement results, recently. To do so, we used the MATLAB files of the author of Mohammadiha et al. (2013a) which is available in Mohammadiha (2015) and trained it with the same training files that we used for our GMM training procedure. We used all different test sentences of different speakers from the TIMIT dataset (192 sentences) and all the measured performance criterions are averaged on these 192 files. To perform experiments, each noisy speech file is divided into some 75% overlapping Hamming windowed frames of length of 256 samples which for 8kHz sampling rate is equal to 32ms. For each noisy speech frame the Periodogram is calculated and using the defined algorithms in Sections 3 and 4, the MAP estimates of speech and noise Periodograms presenting in the noisy Periodogram frame are calculated. The appropriate Wiener filter is constructed using these Periodograms and multiplied by the noisy speech spectrum to suppress the noise. These resulted spectrums are recovered in the time-domain by using the inverse FFT and are put together with the neighbour overlapping frames in the same order of the input noisy speech. Hence the enhanced speech in the time domain is created. As discussed previously, we are using the MS method to have an initial estimate of speech and noise Periodograms and their power and also finding the right GMM of noise. We have also calculated all the performance criterions for the case that we just use the MS method as discussed in Martin (1994) for the estimation of noise and speech Periodograms and use them in Wiener filter construction. This method is compared to other results as an unsupervised speech enhancement method versus MAP and NMF which are supervised methods. All the tests are performed on a PC with Intel Core i5 3.2GHz processor and 16 GB RAM. We used MATLAB 2013b on 64 bit Windows 7 OS to implement the algorithms.

To compare the performance of these algorithms we calculate the segmental SNR and PESQ criterions on the output enhanced files of these algorithms (Chehresa and Savoji, 2012b). PESQ is a quantitative psycho-acoustic measure that is used to evaluate how the enhanced speech is appreciated. To calculate PESQ as explained in Hu and Loizou (2008), the routine available in Loizou (2015) is used. We also used Source to Distortion Ratio (SDR), Source to Interference Ratio (SIR) and Source to Artefact Ratio (SAR) criterions from the BSS-Eval toolbox to measure the performance of these algorithms (Vincent et al., 2006). SDR represents the overall quality of the enhanced speech while SIR and SAR represent the amount of noise reduction and are proportional to the inverse of the distortion (Mohammadiha et al., 2013a). To calculate the improvement of the criterions, they are calculated on the noisy and enhanced speeches, with respect to the corresponding clean speech, and are decreased from each other. For each noise type (totally 6), and each input SNR (−5, 0, 5 and 10dB), the performance criterions are averaged on the test files. All the criterions are averaged on the 6 noises and are shown with respect to the input SNRs in Fig. 5.

As can be seen from Fig. 5, in terms of segmental SNR, PESQ and SIR improvement, the simple MAP algorithm performs significantly better than the NMF method and the other ones too. This means that we have a higher degree of enhancement with the simple MAP algorithm than the optimization, NMF and MS methods. But in terms of SDR improvement and SAR we can see that NMF method has better performance. Since we are using limited GMMs for speech and noise and there are 10 mixtures (Periodograms) in each GMM, the resulted Wiener filters for enhancement of noisy frames will definitely cancel some frequency components of speech or keep some frequency components of noise within them and hence increase the distortion in the enhanced speech which results in less SDR improvement and SAR for the simple MAP method rather than the NMF method.

We also compared the two optimization MAP and simple MAP algorithms in terms of processing time. For input speech files of average length of 3.5sec, the processing time for the optimization method was about 200sec while it was just 1.9sec for the simple MAP method and 2.5sec for the NMF method. Hence, the optimization method is of no real use for real-time applications as compared with the simple MAP technique.

In Fig. 5, we have shown the performance of the MS algorithm which is an unsupervised speech enhancement method. We used the Periodogram power estimates resulting from MS with our MAP estimation method and proposed a supervised method which attained very good enhancement results regardless of just using MS, which has poor performance. The MS algorithm has also some error in the estimation of power. In this way we tried to implement the simple MAP algorithm using the true power of speech and noise in the analysing frame. Since we are creating the noisy observations from pure speech and pure noise files, in each analysing frame we can replace 
                        
                           
                              
                                 P
                                 ¯
                              
                              s
                              
                                 M
                                 S
                              
                           
                        
                      and 
                        
                           
                              
                                 P
                                 ¯
                              
                              n
                              
                                 M
                                 S
                              
                           
                        
                      in (15) with the real power of original speech and noise in that frame. The comparison of this method with the simple MAP method is shown in Fig. 6
                     .

As can be seen from Fig. 6, if we were able to correctly estimate the power of speech and noise in the analysing frame, we would have significantly increased the segmental SNR, PESQ and SIR. This is an ideal assumption and in practical use we are never able to estimate the true power of speech and noise only from the noisy observation. This experiment can give us the idea about the improvement of simple MAP results by improving the used power estimation method and it can be a motivation for future work. In terms of the SDR and SAR criterion we can see that there will not be a big difference for the case of improvement of the power estimation method, which can justify the poor SDR improvement of the SAR criterions when using the simple MAP method in Fig. 5. This is due to the nature of the Wiener filter and the high degree of enhancement in which we may suppress some frequency components of speech while removing the noise components. In terms of a SIR improvement criterion we can see that the simple MAP has a reverse relation with the one with true power. This is because of the poor performance of the MS algorithm in low input SNRs. The estimated speech Periodograms are not accurate and hence the constructed Wiener filter will remove most of the frequency components of the speech as well as noise.

@&#CONCLUSIONS@&#

Two different methods for the realization of explicit MAP estimates of speech and noise Periodograms using GMM, were proposed. One is based on optimization algorithms which due to the use of different constraints to control the algorithm, resulted in local maximums in the maximization process and hence poor enhancement results and long processing times. In another method called simple MAP, we try to simplify the MAP criterion as much as possible. Using this latter method can result to maximums equal or close to the global maximums in the MAP formula and hence better enhancement results. This method is suitable for many real-time applications. By creating GMMs for more noise types and using them and adding them to the enhancement algorithm we were able to improve the performance of the algorithm with a slight increase in the processing time.

@&#ACKNOWLEDGEMENT@&#

We would like to thank Prof. Mohammad Hasan Savoji from the Electrical and Computer Engineering faculty of Shahid Beheshti University of Iran for his kind consultation on this paper.

@&#REFERENCES@&#

