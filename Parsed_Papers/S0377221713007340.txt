@&#MAIN-TITLE@&#Modeling and solution of the joint quay crane and truck scheduling problem

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Both the unidirectional and bidirectional flow problems are researched in this paper.


                        
                        
                           
                           Several valid inequalities and a property of the optimal solutions of the problem are proposed.


                        
                        
                           
                           Two lower bounds are introduced.


                        
                        
                           
                           A new velocity updating strategy is incorporated into PSO algorithm to improve solution quality.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Container terminal

Quay cranes

Internal trucks

Joint scheduling problem

Particle swarm optimization

@&#ABSTRACT@&#


               
               
                  This paper addresses the joint quay crane and truck scheduling problem at a container terminal, considering the coordination of the two types of equipment to reduce their idle time between performing two successive tasks. For the unidirectional flow problem with only inbound containers, in which trucks go back to quayside without carrying outbound containers, a mixed-integer linear programming model is formulated to minimize the makespan. Several valid inequalities and a property of the optimal solutions for the problem are derived, and two lower bounds are obtained. An improved Particle Swarm Optimization (PSO) algorithm is then developed to solve this problem, in which a new velocity updating strategy is incorporated to improve the solution quality. For small sized problems, we have compared the solutions of the proposed PSO with the optimal solutions obtained by solving the model using the CPLEX software. The solutions of the proposed PSO for large sized problems are compared to the two lower bounds because CPLEX could not solve the problem optimally in reasonable time. For the more general situation considering both inbound and outbound containers, trucks may go back to quayside with outbound containers. The model is extended to handle this problem with bidirectional flow. Experiment shows that the improved PSO proposed in this paper is efficient to solve the joint quay crane and truck scheduling problem.
               
            

@&#INTRODUCTION@&#

Container terminals are crucial interfaces between land and sea transportation modes. Container ships carry inbound containers to a terminal and carry outbound containers away. At container terminals, containers are transferred from one mode to another (Vis & De Koster, 2003). Inbound containers are unloaded from container ships by quay cranes and then transported by internal trucks to storage yard where they are stacked by yard cranes to their allocated positions waiting for the consignees to pick up. Outbound containers are handled in the opposite direction. Shippers send the containers into the terminal and yard cranes store them in their allocated positions. Later they are retrieved by yard cranes and transported by trucks to quayside where they are loaded onto ships by quay cranes. Fig. 1
                      illustrates the handling processes for inbound and outbound containers.

As described above, the whole terminal operation is very complex and involves different types of equipments. The operations of the equipments need to be planned appropriately in order to ensure an efficient operation, especially for busy terminals with increasing throughputs.

Operations planning and scheduling at container terminals include berth allocation to incoming ships, quay crane scheduling, ground transport equipment scheduling, yard crane scheduling, storage space allocation, and so on. From the above brief description of terminal operations, we can see that quay cranes are the equipment directly unloading containers from and loading containers to ships. Trucks provide ground transportation of containers between the quay cranes and the storage yard. Effective quay crane scheduling and truck scheduling are both important in terminal management. The operations of quay cranes and trucks are closely linked and need good coordination to avoid efficiency loss due to waiting for each other. Therefore in this paper we study the problem of jointly scheduling quay cranes and trucks.

The paper is organized as follows. In the next section, we first briefly review related research in the existing literature. Then a detailed problem description is given in Section 3. A mixed-integer linear programming model is formulated in Section 4 for the problem with unidirectional flow. Section 5 provides one optimal property, four valid inequalities and two lower bounds for the unidirectional flow problem. A Particle Swarm Optimization (PSO) algorithm is proposed in Section 6 to solve the unidirectional flow problem. Section 7 considers the more general situation with ships involving both unloading and loading of containers. The model and the PSO algorithm are extended to solve this general problem with bidirectional flow. The lower bounds are also modified to suit the general situation. Experiment results are reported in Section 8 showing that the proposed PSO algorithm is effective and efficient in solving the joint quay crane and truck scheduling problem with unidirectional or bidirectional flow. Section 9 provides conclusions.

@&#LITERATURE REVIEW@&#

There has been little research on truck scheduling at container terminals. Nishimura, Imai, and Papadimitriou (2005) addressed a trailer routing problem at a container terminal. They formulated both the single-trailer and multi-trailer problems for pickup and delivery of containers in the terminal, and then employed genetic algorithm to solve them. Most previous work on this topic considered problems of scheduling other types of ground transport equipment, such as transfer cranes, straddle carriers, and automated guided vehicles (AGV). For example, Kim and Kim (1997) investigated the routing problem for a single transfer crane and focused on outbound containers to be loaded onto a ship. A straddle carrier routing problem was studied by Kim and Kim (1999), and a beam search algorithm was used for solutions. Vis, De Koster, Roodbergen, and Peeters (2001) determined the minimum number of AGVs at a semi-automated container terminal by a minimum flow algorithm. However, none of the previous ground transport equipment scheduling research considered the link with the quay crane scheduling.

Due to the practical importance of crane scheduling problem, it has received much research attention. Zhang, Wan, Liu, and Linn (2002) studied the dynamic Rubber Tired Gantry Cranes (RTGCs) deployment problem, and a mixed integer programming model has been formulated. In their paper, the objective is to minimize the total workload overflow. The multiple yard cranes scheduling problem with inter-crane interference was examined by Ng (2005), and a dynamic programming-based heuristic was proposed to solve the problem. Research on the quay crane (QC) scheduling problem started twenty years ago (Daganzo, 1989), and the problem received more attention recently. Lim, Rodrigues, Xiao, and Zhu (2004) discussed the quay crane scheduling problem with three particularly common constraints, which were the noncrossing constraint, the neighborhood constraint and the job-separation constraint, and three algorithms were proposed for obtaining solutions. In their study, a job was defined as a collection of cargo from a given area on a ship. Kim and Park (2004) studied the quay crane scheduling problem, in which a cluster of containers to load or unload was called as a task. A branch and bound (B & B) method and a greedy randomized adaptive search procedure (GRASP) were used to obtain solutions. Liu, Wan, and Wang (2006) modeled the quay crane assignment and scheduling problem considering noncrossing requirement and safety distance. The problem was then decomposed to two levels and solved efficiently using smaller models. The sequence for quay cranes to handle holds in one container vessel were decided by Lee, Wang, and Miao (2008), and a genetic algorithm was presented for solving the problem.

There have been also some papers discussing the integration of different decision problems in container terminals. For example, Bish, Leong, Li, Ng, and Simchi-Levi (2001) studied a problem of allocating storage locations for unloading containers as well as dispatching trucks to transport the containers. A heuristic algorithm was proposed to get solutions. A multiple-crane-constrained scheduling problem was also considered by Bish (2003), in which the unloading and loading containers were both contained. A formulation was presented by Imai, Chen, Nishimura, and Papadimitriou (2008) for the simultaneous berth and quay crane allocation problem, and a heuristic was proposed employing genetic algorithm to obtain near solutions. The problem of scheduling both trucks and quay cranes has rarely been studied. Li and Vairaktarakis (2004) proposed an optimal algorithm and some heuristic algorithms to solve the loading and unloading problem with one quay crane and several vehicles. Chen, Bostel, Dejax, Cai, and Xi (2007) considered the integrated scheduling problem of container handling systems including quay cranes, yard cranes and yard vehicles. They viewed the problem as a Hybrid Flow Shop Scheduling problem with precedence and blocking constraints (HFSS-B). Instead of detailed allocation and scheduling of quay cranes to perform the loading/unloading tasks, they assumed that each quay crane covers a given range of bays and that the ranges for different quay cranes are not overlapping to avoid potential collision. Though such a restriction simplifies the problem, it may make the optimal solution infeasible. In this paper we address the joint quay crane and truck scheduling problem and consider conflicts between quay cranes explicitly. We decide not only the assignment of containers to the quay cranes and trucks, but also the sequence of tasks to be performed by each quay crane and each truck.

When container ships berth at the terminal, the loading and unloading operations are carried out by quay cranes. The quay crane scheduling problem needs to decide the assignment of quay cranes to perform the tasks of handling individual containers and to determine the handling sequence of the containers assigned to each quay crane. The containers unloaded from the ships are to be transported by trucks to the yard for storage; while the containers to be loaded onto the ships need to be transported by trucks from the yard to the quay cranes for loading. The truck scheduling problem assigns the transport tasks to the trucks and decides the handling sequence of containers assigned to each truck. In this paper, we consider the integrated quay crane and truck scheduling problem and make all the above decisions jointly.

In the traditional terminal operation, quay cranes are often scheduled first to process coming ships, and then trucks are assigned to serve specific quay cranes. In this method, each working quay crane is teamed up with a fixed set of trucks. The quay crane and the trucks may often need to wait for each other. Take the unloading process as an example. If a container is unloaded by a quay crane, but none of the trucks has arrived, the quay crane has to hold the container and wait for a truck. On the other hand, if the quay crane has not completed the unloading of a container when a truck comes, the truck has to wait. Such waiting causes productivity loss and shows a need for better coordination between the operations of quay cranes and trucks. As shown in Fig. 2
                     , there are two ships berthed at the terminal. Quay crane 1 and Quay crane 2 are allocated to Ship 1 and Ship 2, respectively. Truck 1 and Truck 2 are both allocated to Quay crane 1 for transporting containers to the yard; Truck 3 is allocated to Quay crane 2. When there is no available truck to transport the container unloaded by Quay crane 2, Quay crane 2 has to hold the container and wait for a truck. At the same time, both Truck 1 and Truck 2 which have been allocated to Quay crane 1 have to wait in a queue for transporting containers unloaded by Quay crane 1. To avoid such a case, in this paper, we determine the quay crane scheduling and the truck scheduling jointly so as to minimize the turnaround time of the ships, which is shown in Fig. 3
                     . In Fig. 3, we can see that Truck 1 turns to serve Quay crane 2. As a result, Quay crane 2 does not have to wait, and thus the total productivity of the container terminal can be improved.

The decisions in our problem include the allocation of quay cranes and trucks for handling containers and the sequence for handling tasks allocated to each quay crane and each truck. A quay crane or a truck is assumed to handle at most one container at a time. Some quay cranes are able to unload two twenty-foot containers simultaneously and put them together on one truck. In this case the two containers can be considered as one. In our integrated scheduling problem we consider the following factors.
                        
                           (1)
                           Quay cranes are heavy equipment and their movements are slow. Hence once a quay crane starts the handling process in a bay, it will complete all the work in this bay before it can go to another bay. This requirement is practical in container terminals.

There are precedence relationships between containers. For example, during the unloading process in one bay, a container must be unloaded before the unloading of containers below it. These precedence relations are given and must be satisfied.

The quay cranes move along the same track and so cannot cross each other. In this paper, we do not assume any fixed range of bays for any quay crane. A quay crane may be allocated to any bay that it can reach so long as the quay cranes do not cross each other and keep a safety distance from each other. This will allow the quay cranes to realize their full potentials.

The two types of equipment may wait for each other when the coordination between them is poor, which will cause efficiency loss for the terminal. Therefore, the waiting time of quay cranes and trucks should be minimized.

In this section we present a mathematical model for integrated quay crane and truck scheduling to unload containers from ships. We assume that the yard cranes have sufficient handling capacity so that the trucks do not have to wait in the yard. Note that the berthing positions of the ships are known from the berth allocation plan. Each container to be unloaded has a known location on the ship and a known destination location in the yard. The quay crane for unloading this container must be at the bay where the container located. Therefore, the time for a truck to transport a container j from the quayside to the yard and return to the quayside is known in advance. We denote the time as Pj2
                     .
                        
                           
                              
                              
                              
                                 
                                    
                                       Notations:
                                    
                                 
                                 
                                    
                                       Pj
                                       
                                       1
                                    
                                    The quay crane time needed to unload container j
                                    
                                 
                                 
                                    
                                       Pj
                                       
                                       2
                                    
                                    The time for a truck to transport container j from the quay crane to the container’s destination in the yard and to return to the quay crane
                                 
                                 
                                    
                                       Q
                                    
                                    The set of quay cranes; Q
                                       ={1,2,…,|Q|}, the quay cranes are numbered sequentially along the quay from one end to the other
                                 
                                 
                                    
                                       T
                                    
                                    The set of trucks
                                 
                                 
                                    
                                       M
                                    
                                    A very large number
                                 
                                 
                                    
                                       Ω
                                    
                                    The set of containers to be unloaded from the ships
                                 
                                 
                                    
                                       Ω
                                       0
                                    
                                    
                                       Ω
                                       0
                                       =
                                       Ω
                                       ∪{0}, 0 represents the initial state of any equipment
                                 
                                 
                                    
                                       ΩF
                                       
                                    
                                    
                                       ΩF
                                       
                                       =
                                       Ω
                                       ∪{F}, F represents the final state of any equipment
                                 
                                 
                                    
                                       Ψ
                                    
                                    The set of container pairs (i,
                                       j) such that i must precede j in unloading
                                 
                                 
                                    
                                       E
                                    
                                    The set of bays in the ships to be unloaded; E
                                       ={1,2,…,|E|}, the bays are numbered sequentially along the quay in the same direction as for the quay cranes
                                 
                                 
                                    
                                       Bh
                                       
                                    
                                    The set of containers in bay h
                                    
                                 
                                 
                                    
                                       Li
                                       
                                    
                                    The bay which container i is in.
                                 
                                 
                                    
                                       Decision variables:
                                    
                                 
                                 
                                    
                                       Ci
                                       
                                       1
                                    
                                    The completing time of unloading container i
                                    
                                 
                                 
                                    
                                       Ci
                                       
                                       2
                                    
                                    The completing time of the round trip for transporting container i
                                    
                                 
                                 
                                    
                                       Ah
                                       
                                    
                                    The starting time of bay h
                                    
                                 
                                 
                                    
                                       Dh
                                       
                                    
                                    The completing time of bay h
                                    
                                 
                                 
                                    
                                       Zijq
                                       
                                    
                                    A binary variable. It equals 1 if container i is unloaded immediately before container j by quay crane q, 0 otherwise
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Z
                                                
                                                
                                                   iq
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    A binary variable. It equals 1 if container i is allocated to quay crane q for unloading, 0 otherwise
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Y
                                                
                                                
                                                   
                                                      
                                                         hh
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    A binary variable. It equals 1 if bay h is finished no later than bay h′ starts, 0 otherwise
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Y
                                                
                                                
                                                   hq
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    A binary variable. It equals 1 if bay h is handled by quay crane q, 0 otherwise
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   iu
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    A binary variable. It equals 1 if container i is allocated to truck u for transporting, 0 otherwise
                                 
                                 
                                    
                                       Xiju
                                       
                                    
                                    A binary variable. It equals 1 if container i is transported immediately before j on truck u, 0 otherwise
                                 
                              
                           
                        
                     
                  

Based on the above assumptions and notations, we formulated the problem as following mathematical model:
                        
                           (1)
                           
                              min
                              
                              
                                 
                                    
                                       max
                                    
                                    
                                       i
                                       ∈
                                       Ω
                                    
                                 
                              
                              
                                 
                                    C
                                 
                                 
                                    i
                                    2
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                    1
                                 
                              
                              +
                              
                                 
                                    P
                                 
                                 
                                    i
                                    2
                                 
                              
                              =
                              
                                 
                                    C
                                 
                                 
                                    i
                                    2
                                 
                              
                              
                              
                              i
                              ∈
                              Ω
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                    1
                                 
                              
                              +
                              
                                 
                                    P
                                 
                                 
                                    j
                                    1
                                 
                              
                              ⩽
                              
                                 
                                    C
                                 
                                 
                                    j
                                    1
                                 
                              
                              
                              
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              Ψ
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    A
                                 
                                 
                                    h
                                 
                              
                              +
                              
                                 
                                    P
                                 
                                 
                                    i
                                    1
                                 
                              
                              ⩽
                              
                                 
                                    C
                                 
                                 
                                    i
                                    1
                                 
                              
                              
                              
                              i
                              ∈
                              
                                 
                                    B
                                 
                                 
                                    h
                                 
                              
                              
                              
                              h
                              ∈
                              E
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              ⩾
                              
                                 
                                    C
                                 
                                 
                                    i
                                    1
                                 
                              
                              
                              
                              i
                              ∈
                              
                                 
                                    B
                                 
                                 
                                    h
                                 
                              
                              h
                              ∈
                              E
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              -
                              
                                 
                                    A
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    Y
                                 
                                 
                                    
                                       
                                          hh
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              M
                              ⩾
                              0
                              
                              
                              h
                              ,
                              
                              
                                 
                                    h
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              E
                           
                        
                     
                     
                        
                           (7)
                           
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              -
                              
                                 
                                    A
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              -
                              (
                              1
                              -
                              
                                 
                                    Y
                                 
                                 
                                    
                                       
                                          hh
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              )
                              M
                              ⩽
                              0
                              
                              
                              h
                              ,
                              
                                 
                                    h
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              E
                           
                        
                     
                     
                        
                           (8)
                           
                              M
                              (
                              
                                 
                                    Y
                                 
                                 
                                    
                                       
                                          hh
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    Y
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ′
                                       
                                    
                                    h
                                 
                              
                              )
                              ⩾
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       q
                                       ∈
                                       Q
                                    
                                 
                              
                              
                                 
                                    qY
                                 
                                 
                                    hq
                                 
                                 
                                    ′
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ∈
                                       Q
                                    
                                 
                              
                              
                                 
                                    kY
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ′
                                       
                                    
                                    k
                                 
                                 
                                    ′
                                 
                              
                              +
                              1
                              
                              
                              h
                              <
                              
                                 
                                    h
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              E
                           
                        
                     
                     
                        
                           (9)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       q
                                       ∈
                                       Q
                                    
                                 
                              
                              
                                 
                                    Y
                                 
                                 
                                    hq
                                 
                                 
                                    ′
                                 
                              
                              =
                              1
                              
                              
                              h
                              ∈
                              E
                           
                        
                     
                     
                        
                           (10)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             Ω
                                          
                                          
                                             F
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    Z
                                 
                                 
                                    0
                                    iq
                                 
                              
                              =
                              1
                              
                              
                              q
                              ∈
                              Q
                           
                        
                     
                     
                        
                           (11)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             Ω
                                          
                                          
                                             
                                             0
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    Z
                                 
                                 
                                    iFq
                                 
                              
                              =
                              1
                              
                              
                              q
                              ∈
                              Q
                           
                        
                     
                     
                        
                           (12)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       
                                          
                                             Ω
                                          
                                          
                                             F
                                          
                                       
                                       ,
                                       j
                                       ≠
                                       i
                                    
                                 
                              
                              
                                 
                                    Z
                                 
                                 
                                    ijq
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       
                                          
                                             Ω
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       j
                                       ≠
                                       i
                                    
                                 
                              
                              
                                 
                                    Z
                                 
                                 
                                    jiq
                                 
                              
                              =
                              0
                              
                              
                              i
                              ∈
                              Ω
                              ,
                              
                              q
                              ∈
                              Q
                           
                        
                     
                     
                        
                           (13)
                           
                              
                                 
                                    C
                                 
                                 
                                    j
                                    1
                                 
                              
                              -
                              
                                 
                                    P
                                 
                                 
                                    j
                                    1
                                 
                              
                              +
                              M
                              (
                              1
                              -
                              
                                 
                                    Z
                                 
                                 
                                    0
                                    jq
                                 
                              
                              )
                              ⩾
                              0
                              
                              
                              j
                              ∈
                              Ω
                              q
                              ∈
                              Q
                           
                        
                     
                     
                        
                           (14)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       q
                                       ∈
                                       Q
                                    
                                 
                              
                              
                                 
                                    Z
                                 
                                 
                                    iq
                                 
                                 
                                    ′
                                 
                              
                              =
                              1
                              
                              
                              i
                              ∈
                              Ω
                           
                        
                     
                     
                        
                           (15)
                           
                              
                                 
                                    Z
                                 
                                 
                                    iq
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       
                                          
                                             Ω
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       j
                                       ≠
                                       i
                                    
                                 
                              
                              
                                 
                                    Z
                                 
                                 
                                    jiq
                                 
                              
                              
                              
                              i
                              ∈
                              Ω
                              ,
                              
                              q
                              ∈
                              Q
                           
                        
                     
                     
                        
                           (16)
                           
                              
                                 
                                    C
                                 
                                 
                                    j
                                    1
                                 
                              
                              +
                              M
                              (
                              1
                              -
                              
                                 
                                    Z
                                 
                                 
                                    ijq
                                 
                              
                              )
                              ⩾
                              
                                 
                                    C
                                 
                                 
                                    i
                                    1
                                 
                              
                              +
                              
                                 
                                    P
                                 
                                 
                                    j
                                    1
                                 
                              
                              
                              
                              i
                              ,
                              j
                              ∈
                              Ω
                              ,
                              
                              q
                              ∈
                              Q
                           
                        
                     
                     
                        
                           (17)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             Ω
                                          
                                          
                                             F
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    0
                                    iu
                                 
                              
                              =
                              1
                              
                              
                              u
                              ∈
                              T
                           
                        
                     
                     
                        
                           (18)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             Ω
                                          
                                          
                                             
                                             0
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    iFu
                                 
                              
                              =
                              1
                              
                              
                              u
                              ∈
                              T
                           
                        
                     
                     
                        
                           (19)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       
                                          
                                             Ω
                                          
                                          
                                             F
                                          
                                       
                                       ,
                                       
                                       j
                                       ≠
                                       i
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    iju
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       
                                          
                                             Ω
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                       j
                                       ≠
                                       i
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    jiu
                                 
                              
                              =
                              0
                              
                              
                              i
                              ∈
                              Ω
                              ,
                              
                              u
                              ∈
                              T
                           
                        
                     
                     
                        
                           (20)
                           
                              
                                 
                                    C
                                 
                                 
                                    j
                                    2
                                 
                              
                              -
                              
                                 
                                    P
                                 
                                 
                                    j
                                    2
                                 
                              
                              +
                              M
                              (
                              1
                              -
                              
                                 
                                    X
                                 
                                 
                                    0
                                    ju
                                 
                              
                              )
                              ⩾
                              0
                              
                              
                              j
                              ∈
                              Ω
                              u
                              ∈
                              T
                           
                        
                     
                     
                        
                           (21)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       u
                                       ∈
                                       T
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    iu
                                 
                                 
                                    ′
                                 
                              
                              =
                              1
                              
                              
                              i
                              ∈
                              Ω
                           
                        
                     
                     
                        
                           (22)
                           
                              
                                 
                                    X
                                 
                                 
                                    iu
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       
                                          
                                             Ω
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                       j
                                       ≠
                                       i
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    jiu
                                 
                              
                              
                              
                              i
                              ∈
                              Ω
                              ,
                              
                              u
                              ∈
                              T
                           
                        
                     
                     
                        
                           (23)
                           
                              
                                 
                                    C
                                 
                                 
                                    j
                                    1
                                 
                              
                              +
                              M
                              (
                              1
                              -
                              
                                 
                                    X
                                 
                                 
                                    iju
                                 
                              
                              )
                              ⩾
                              
                                 
                                    C
                                 
                                 
                                    i
                                    2
                                 
                              
                              
                              
                              i
                              ,
                              j
                              ∈
                              Ω
                              ,
                              
                              u
                              ∈
                              T
                           
                        
                     
                     
                        
                           (24)
                           
                              
                                 
                                    Z
                                 
                                 
                                    iq
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    Y
                                 
                                 
                                    hq
                                 
                                 
                                    ′
                                 
                              
                              
                              
                              i
                              ∈
                              Ω
                              
                                 
                                    L
                                 
                                 
                                    i
                                 
                              
                              =
                              h
                              ,
                              
                              h
                              ∈
                              E
                              ,
                              
                              q
                              ∈
                              Q
                           
                        
                     
                     
                        
                           (25)
                           
                              
                                 
                                    Z
                                 
                                 
                                    ijq
                                 
                              
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    iq
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    Y
                                 
                                 
                                    hq
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    Y
                                 
                                 
                                    h
                                    ,
                                    
                                       
                                          h
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    iju
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    iu
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              
                              
                              i
                              ,
                              j
                              ∈
                              Ω
                              ,
                              
                              q
                              ∈
                              Q
                              ,
                              
                              u
                              ∈
                              T
                           
                        
                     
                     
                        
                           (26)
                           
                              
                                 
                                    A
                                 
                                 
                                    h
                                 
                              
                              ⩾
                              0
                              ,
                              
                                 
                                    C
                                 
                                 
                                    i
                                    1
                                 
                              
                              ⩾
                              
                                 
                                    P
                                 
                                 
                                    i
                                    1
                                 
                              
                              
                              
                              i
                              ∈
                              Ω
                              ,
                              
                              h
                              ∈
                              E
                           
                        
                     
                  

The objective (1) of the model is to minimize the makespan, i.e., the time to complete the unloading and transporting operations of all required containers. Constraints (2) ensure that there must be a required transport time between the completion of unloading a container and the completion of transporting it. Constraints (3) ensure that the unloading of containers must satisfy the precedence constraints. Constraints (4) state that the unloading of a bay starts once the unloading of any container in the bay starts. Similarly, constraints (5) guarantee that the unloading of a bay completes only when the unloading of every required container in the bay has completed. Constraints (6) define the variable 
                        
                           
                              
                                 Y
                              
                              
                                 
                                    
                                       hh
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                     , i.e., set 
                        
                           
                              
                                 Y
                              
                              
                                 
                                    
                                       hh
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           =
                           1
                        
                      if bay h′ starts after bay h finishes. Similarly, constraints (7) set 
                        
                           
                              
                                 Y
                              
                              
                                 
                                    
                                       hh
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           =
                           0
                        
                      when bay h finishes later than bay h′ starts. Constraints (8) avoid conflicts in the relative positions of different quay cranes. Note that quay cranes are numbered sequentially along the quay from one end to the other, and the bays are also numbered sequentially along the quay in the same direction as for the quay cranes. When h
                     <
                     h′ and if they are performed simultaneously, i.e., 
                        
                           
                              
                                 Y
                              
                              
                                 
                                    
                                       hh
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           +
                           
                              
                                 Y
                              
                              
                                 
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                                 h
                              
                           
                           =
                           0
                        
                     , constraints (8) become 
                        
                           
                              
                                 ∑
                              
                              
                                 q
                                 ∈
                                 Q
                              
                           
                           
                              
                                 qY
                              
                              
                                 hq
                              
                              
                                 ′
                              
                           
                           -
                           
                              
                                 ∑
                              
                              
                                 k
                                 ∈
                                 Q
                              
                           
                           
                              
                                 kY
                              
                              
                                 
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                                 k
                              
                              
                                 ′
                              
                           
                           <
                           0
                        
                     , meaning that the index of the crane performing h
                     <the index of the crane performing h′. Constraints (9) require that each bay is assigned to one and only one quay crane. Constraints (10) and (11) ensure that each quay crane starts at its initial state 0, and ends at its final state F, respectively. Constraints (12) ensure the flow balance for each quay crane before and after performing a container. Constraints (13) determine the completion time of unloading the first container by each quay crane q. Constraints (14) require that each container is assigned to one and only one quay crane. Constraints (15) mean that if quay crane q unloads container i, it must be in the initial state or have unloaded another container immediately before that. For each quay crane, constraints (16) relate the order of unloading the containers assigned to it and the completion times of unloading these containers. These constraints also effectively eliminate sub-tours in the unloading sequence. Constraints (17) and (18) ensure that every truck starts at its initial state 0, and ends at its final state F, respectively. Constraints (19) ensure the flow balance of each truck before and after transporting a container. Constraints (20) determine the completion time of transporting the first container by truck u. Constraints (21) require each container is assigned to one and only one truck. Constraints (22) and (23) have the same functions for trucks as constraints (15) and (16) for quay cranes, respectively. Note that constraints (23) should be understood considering the relations in constraints (2). Constraints (24) ensure that all the containers in a bay must be unloaded by the quay crane assigned to the bay. Constraints (25) and (26) specify the ranges of variable values.

In this section we describe several valid inequalities for the joint quay crane and truck scheduling problem. All the proposed valid inequalities are redundant for the model in Section 4, but the running time of CPLEX software can be reduced after added these valid inequalities to the model.
                           
                              (27)
                              
                                 Bay
                                 
                                 completion
                                 
                                 time
                                 
                                 inequality
                                 .
                                 
                                 
                                    
                                       D
                                    
                                    
                                       h
                                    
                                 
                                 ⩾
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                B
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       1
                                    
                                 
                              
                           
                        
                     

Inequality (27) ensures that each bay must be finished no earlier than the total processing time of all the containers in the bay. It is valid because each bay can only be processed by one quay crane, and the quay crane needs to unload containers one by one.
                           
                              (28)
                              
                                 The
                                 
                                 average
                                 
                                 workload
                                 
                                 of
                                 
                                 the
                                 
                                 quay
                                 
                                 cranes
                                 
                                 inequality
                                 .
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          Ω
                                       
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       1
                                    
                                 
                                 /
                                 |
                                 Q
                                 |
                                 )
                                 ⩽
                                 
                                    
                                       
                                          max
                                       
                                       
                                          i
                                          ∈
                                          Ω
                                       
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       i
                                       2
                                    
                                 
                              
                           
                        
                     

Inequality (28) ensures that the average workload of the quay cranes must not be greater than the makespan.
                           
                              (29)
                              
                                 Variable
                                 
                                 relationship
                                 
                                 inequality
                                 .
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       jiq
                                    
                                 
                                 ⩽
                                 
                                    
                                       Z
                                    
                                    
                                       iq
                                    
                                    
                                       ′
                                    
                                 
                                 
                                 i
                                 ,
                                 
                                 j
                                 ∈
                                 Ω
                                 ,
                                 
                                 q
                                 ∈
                                 Q
                              
                           
                        
                     

Inequality (29) ensures that if container i is not unloaded by quay crane q, then Zjiq
                        
                        =0. When container i is unloaded by quay crane q immediately before container j, then 
                           
                              
                                 
                                    Z
                                 
                                 
                                    iq
                                 
                                 
                                    ′
                                 
                              
                              =
                              1
                           
                        .
                           
                              (30)
                              
                                 Variable
                                 
                                 relationship
                                 
                                 inequality
                                 .
                                 
                                 
                                    
                                       X
                                    
                                    
                                       jiu
                                    
                                 
                                 ⩽
                                 
                                    
                                       X
                                    
                                    
                                       iu
                                    
                                    
                                       ′
                                    
                                 
                                 
                                 i
                                 ,
                                 
                                 j
                                 ∈
                                 Ω
                                 ,
                                 
                                 u
                                 ∈
                                 T
                              
                           
                        
                     

Inequality (30) ensures that if container i is not transported by truck u, then Xjiu
                        
                        =0. When container i is transported by truck u immediately before container j, then 
                           
                              
                                 
                                    X
                                 
                                 
                                    iu
                                 
                                 
                                    ′
                                 
                              
                              =
                              1
                           
                        .

For the above joint quay crane and truck scheduling problem, we observe a property for the optimal solutions, and the details are as follows.
                           Property 1
                           
                              Consider the problem of unloading containers in one bay. If (i, j)∉ψ for any container pair (i,j) in this bay and if there are sufficient trucks so that the quay crane never need to wait for trucks, then it is optimal to unload the containers in the bay in descending order of their transport times.
                           

Given any schedule of unloading this bay, if the containers in it are not sequenced in the above order, there must be two containers i and j in the schedule such that i is immediately before j and Pi
                              
                              2
                              ⩽
                              Pj
                              
                              2. Let Q denote the time at which the crane completes the unloading of the container immediately before i. The maximum completion time for transporting i and j in this schedule can be calculated as Q
                              1
                              =max{(Q
                              +
                              Pi
                              
                              1
                              +
                              Pi
                              
                              2), (Q
                              +
                              Pi
                              
                              1
                              +
                              Pj
                              
                              1
                              +
                              Pj
                              
                              2)}.

We can construct a new schedule by exchanging the unloading order of i and j. This will not affect the completion times of any container before them. The maximum completion time for transporting i and j in this new schedule will be Q
                        2
                        =max{(Q
                        +
                        Pj
                        
                        1
                        +
                        Pj
                        
                        2), (Q
                        +
                        Pj
                        
                        1
                        +
                        Pi
                        
                        1
                        +
                        Pi
                        
                        2)}. Clearly, neither of the two terms in Q
                        2 is larger than the second term in Q
                        1, and so Q
                        2
                        ⩽
                        Q
                        1. It is easy to see that the maximum completion time for unloading i and j keeps unchanged, and thus the completion times of the containers after them will not change. Therefore, the new schedule is not worse than the original one.

Continue such exchanges we can obtain a schedule in which containers are unloaded in descending order of their transport times and which is not worse than the original one. Since this can be done for any given schedule, this proves that it is optimal to unload the containers in the bay in descending order of their transport times.

Since each container needs to be unloaded and then transported, the optimal makespan of the unloading stage plus the minimum transporting time will be a lower bound of the original problem. We give two lower bounds below by minimizing the makespan of the first stage.

Because once a quay crane starts the unloading process in a bay, it will complete all the handling work in this bay before it can go to another bay, we can take all the containers in the same bay as one job. This will simplify the calculation.


                        Lower bound 1. The makespan of the optimal solution must not be less than the average workload of the quay cranes plus the minimum transporting time.

This is obviously a lower bound, because it considers the minimal possible completion time of the first stage under the perfect balance of crane workloads and the minimum transporting time of the last unloaded container. However, it does not consider the crane position restrictions and so it will not be tight. Lower bound 2 below considers such restrictions and the actual workload of each crane.


                        Lower bound 2. We define the following additional notation and use a small model to calculate lower bound 2.
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      h
                                                   
                                                
                                                =
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ∈
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            h
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      i
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       The total unloading time of all the containers in bay h
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      
                                                         
                                                            hh
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      q
                                                   
                                                
                                             
                                          
                                       
                                       If bay h′ is unloaded (or loaded) immediately after bay h on quay crane q, it equals to 1, otherwise, it equals to 0
                                    
                                    
                                       
                                          F1
                                       The earliest time at which the unloading of all bays completes
                                    
                                 
                              
                           
                        
                     

The lower bound model is as follows.
                           
                              (31)
                              
                                 Minimize
                                 
                                 F
                                 1
                                 +
                                 
                                    min
                                 
                                 {
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 |
                                 i
                                 ∈
                                 Ω
                                 }
                              
                           
                        
                     

Subject to constraints (6), (7), (8), (9), (25), (26) and
                           
                              (32)
                              
                                 F
                                 1
                                 ⩾
                                 
                                    
                                       D
                                    
                                    
                                       h
                                    
                                 
                                 
                                 
                                 h
                                 ∈
                                 E
                              
                           
                        
                        
                           
                              (33)
                              
                                 
                                    
                                       D
                                    
                                    
                                       h
                                    
                                 
                                 ⩾
                                 
                                    
                                       A
                                    
                                    
                                       h
                                    
                                 
                                 +
                                 
                                    
                                       S
                                    
                                    
                                       h
                                    
                                 
                                 
                                 
                                 h
                                 ∈
                                 E
                              
                           
                        
                        
                           
                              (34)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          h
                                          ∈
                                          E
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       0
                                       hq
                                    
                                 
                                 =
                                 1
                                 
                                 
                                 q
                                 ∈
                                 Q
                              
                           
                        
                        
                           
                              (35)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          h
                                          ∈
                                          E
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       hTq
                                    
                                 
                                 =
                                 1
                                 
                                 
                                 q
                                 ∈
                                 Q
                              
                           
                        
                        
                           
                              (36)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ′
                                             
                                          
                                          ∈
                                          
                                             
                                                E
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       
                                          
                                             hh
                                          
                                          
                                             ′
                                          
                                       
                                       q
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ′
                                             
                                          
                                          ∈
                                          
                                             
                                                E
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ′
                                          
                                       
                                       hq
                                    
                                 
                                 =
                                 0
                                 
                                 
                                 h
                                 ∈
                                 E
                                 ,
                                 
                                 q
                                 ∈
                                 Q
                              
                           
                        
                        
                           
                              (37)
                              
                                 
                                    
                                       D
                                    
                                    
                                       h
                                    
                                 
                                 -
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩽
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       w
                                    
                                    
                                       
                                          
                                             hh
                                          
                                          
                                             ′
                                          
                                       
                                       q
                                    
                                 
                                 )
                                 
                                 h
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 Eq
                                 ∈
                                 Q
                              
                           
                        
                        
                           
                              (38)
                              
                                 
                                    
                                       D
                                    
                                    
                                       h
                                    
                                 
                                 -
                                 
                                    
                                       S
                                    
                                    
                                       h
                                    
                                 
                                 +
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       w
                                    
                                    
                                       0
                                       hq
                                    
                                 
                                 )
                                 ⩾
                                 0
                                 
                                 
                                 h
                                 ∈
                                 Eq
                                 ∈
                                 Q
                              
                           
                        
                        
                           
                              (39)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ′
                                             
                                          
                                          ∈
                                          
                                             
                                                E
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ′
                                          
                                       
                                       hq
                                    
                                 
                                 =
                                 
                                    
                                       Y
                                    
                                    
                                       hq
                                    
                                    
                                       ′
                                    
                                 
                                 
                                 
                                 h
                                 ∈
                                 E
                                 ,
                                 
                                 q
                                 ∈
                                 Q
                              
                           
                        
                        
                           
                              (40)
                              
                                 
                                    
                                       w
                                    
                                    
                                       
                                          
                                             hh
                                          
                                          
                                             ′
                                          
                                       
                                       q
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 
                                 q
                                 ∈
                                 Q
                                 ,
                                 
                                 h
                                 ,
                                 
                                 
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 E
                              
                           
                        
                     

Constraints (32) define the decision variables F1. Constraints (33) ensure that a bay completes only when it has been processed for the required time. Because F1 is the earliest time at which the unloading stage can finish and the constant min {Pi
                        
                        2|i
                        ∊Ω} is the minimum transporting time needed for a container, the optimal objective of this model is a lower bound for our problem. Since the model treats each bay as one job and considers only the allocation of cranes, it is small in size and can be easily solved. Constraints (34) and (35) ensure that every quay crane starts at its initial state 0, and ends at its final state F, respectively. Constraints (36) ensure the flow balance for each quay crane before and after performing a bay. Constraints (37) determine the completion time of performing the first bay by each quay crane q. For each quay crane, constraints (38) relate the order of performing the bays assigned to it and the completion times of performing these bays. These constraints also effectively eliminate sub-tours in the unloading sequence. Constraints (39) mean that if quay crane q performs bay h, it must be in the initial state or have performed another bay immediately before that. Constraints (40) specify the ranges of variable values.

In practice the number of containers to be unloaded from a ship is often very large. For problems of practical size, the model in Section 4 cannot be solved using standard software within reasonable time. Therefore we have to consider heuristic solutions.

Particle Swarm Optimization (PSO) was first presented by Eberhart and Kennedy (1995), and they used it to optimize the continuous nonlinear functions. Liao, Tseng, and Luarn (2007) successfully applied a PSO algorithm to solve a discrete optimization problem, and Marinakis and Marinaki (2010) developed a PSO algorithm for traveling salesman problem. In this paper we propose an improved PSO algorithm to solve the joint quay crane and truck scheduling problem.

PSO is a population-based optimization algorithm in which each particle representing a solution has a position and a velocity at each iteration. While the position reflects the quality of the solution, the velocity determines where it will move in the next iteration. The ordinary updating formulae of velocity and position are as follows.
                        
                           (41)
                           
                              
                                 
                                    v
                                 
                                 
                                    ik
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    v
                                 
                                 
                                    ik
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          pbest
                                       
                                       
                                          ik
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    ik
                                 
                                 
                                    t
                                 
                              
                              )
                              +
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          gbest
                                       
                                       
                                          k
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    ik
                                 
                                 
                                    t
                                 
                              
                              )
                           
                        
                     
                     
                        
                           (42)
                           
                              
                                 
                                    x
                                 
                                 
                                    ik
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    x
                                 
                                 
                                    ik
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    v
                                 
                                 
                                    ik
                                 
                                 
                                    t
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 x
                              
                              
                                 ik
                              
                              
                                 t
                                 +
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 x
                              
                              
                                 ik
                              
                              
                                 t
                              
                           
                        
                      represent the current and previous position of particle i on dimension k, respectively. 
                        
                           
                              
                                 v
                              
                              
                                 ik
                              
                              
                                 t
                                 +
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 v
                              
                              
                                 ik
                              
                              
                                 t
                              
                           
                        
                      represent the current and previous velocity of particle i on dimension k, respectively. The acceleration weights c1 and c
                     2 are set to determine whether a particle flies toward the best position it has ever reached or the global best position of the whole swarm. r
                     1 and r
                     2 are random numbers generated in [0,1]. 
                        
                           
                              
                                 x
                              
                              
                                 
                                    
                                       pbest
                                    
                                    
                                       ik
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      and 
                        
                           
                              
                                 x
                              
                              
                                 
                                    
                                       gbest
                                    
                                    
                                       k
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      are the best position of particle i on dimension k up to iteration t, and the best position of the whole swarm on dimension k until iteration t.

The velocity in the basic PSO may grow unlimitedly and this affects the convergence around the optimal solution. To overcome this problem, Shi and Eberhart (1998), Shi and Eberhart (1999) modified the velocity updating formula as follows:
                        
                           (43)
                           
                              
                                 
                                    v
                                 
                                 
                                    ik
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    ik
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          pbest
                                       
                                       
                                          ik
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    ik
                                 
                                 
                                    t
                                 
                              
                              )
                              +
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          gbest
                                       
                                       
                                          k
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    ik
                                 
                                 
                                    t
                                 
                              
                              )
                           
                        
                     where 
                        
                           
                              
                                 w
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       max
                                    
                                 
                                 -
                                 t
                              
                              
                                 
                                    
                                       w
                                    
                                    
                                       max
                                    
                                 
                              
                           
                           (
                           
                              
                                 w
                              
                              
                                 max
                              
                           
                           -
                           
                              
                                 w
                              
                              
                                 min
                              
                           
                           )
                           +
                           
                              
                                 w
                              
                              
                                 min
                              
                           
                        
                     , which is the inertia weight. w
                     max and w
                     min represent the maximum and the minimum values of the inertia weight, respectively.

The scheduling problem in this paper has to decide quay crane and truck allocations and the sequence of containers handled by each quay crane and each truck. Therefore we need to encode the particles in terms of the problem, and decode them to get the solutions. Because the problem has two stages consisting of the unloading operations by quay cranes and the transporting operations by trucks, we encode quay crane allocation and the container sequence for each quay crane and then allocate the trucks to containers in terms of the quay crane scheduling sequence.

Let N
                        =|Ω|. We use a 2N-dimensional sequence to represent a solution. The first N dimensions indicate the quay crane allocation. The value in each of the dimensions is a real number between 0 and |Q|. The value in dimension i, Xi
                        , represents that container i is allocated to crane 
                           
                              ⌈
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              ⌉
                           
                        . The second N dimensions indicate the sequence on each crane. The values are real numbers between 0 and N. The value in dimension N
                        +
                        i is for container i. The unloading sequence for a quay crane is determined by the ascending order of the values in those dimensions corresponding to the containers allocated to this crane. For example, Table 1
                         shows the encoding of a solution for a problem with 5 (N
                        =5) containers and 2 quay cranes. The corresponding solution after decoding is in Table 2
                        . In this solution crane 1 unloads containers 4, 2 and 5 in this order, and crane 2 unloads container 1 and then container 3.

The initial particles are generated randomly. This will ensure the particle diversity. Our problem requires that the containers in the same bay must be unloaded by the same quay crane and the precedence relationships must be satisfied. Randomly generated dimension values may not satisfy these conditions. Therefore we proposed a method below to modify the infeasible dimension values.

For two containers i and j (i
                        <
                        j) in the same bay, if their crane allocations are different in the randomly generated particle, i.e., 
                           
                              ⌈
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              ⌉
                              
                              ≠
                              
                              ⌈
                              
                                 
                                    X
                                 
                                 
                                    j
                                 
                              
                              ⌉
                           
                        , we will change the integer part of Xj
                         so that the new Xj
                         satisfies 
                           
                              ⌈
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              ⌉
                              =
                              ⌈
                              
                                 
                                    X
                                 
                                 
                                    j
                                 
                              
                              ⌉
                           
                        . For two containers i and j in the same bay, if their sequence dimension values (XN+i
                         and XN+j
                        , respectively) in the randomly generated particle indicate an unloading order violating the precedence relationship, we will exchange the two values. Tables 3 and 4
                        
                         give an example of randomly generated particle for a problem being modified. In the problem, there is a precedence relationship requiring container 3 to be unloaded before container 5. Table 3 shows the first N dimensions in initially generated random particle and in the modified one. Table 4 shows the second N dimensions.

A major merit of PSO is that it converges very fast. But this is linked to a major drawback of it: it is easy to fall into local optima. This is because each particle always tends to fly towards the best position it has ever reached and the global best position of the whole swarm so far. To overcome this drawback, we propose to modify the velocity updating formula as follows.
                           
                              (44)
                              
                                 
                                    
                                       v
                                    
                                    
                                       ik
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 =
                                 ω
                                 
                                    
                                       v
                                    
                                    
                                       ik
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             pbest
                                          
                                          
                                             ik
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       ik
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             gbest
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       ik
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ak
                                    
                                    
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       bk
                                    
                                    
                                       t
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    x
                                 
                                 
                                    ak
                                 
                                 
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 
                                    x
                                 
                                 
                                    bk
                                 
                                 
                                    t
                                 
                              
                           
                         represent the positions on dimension k in iteration t of two randomly selected particles. With this modification, the direction a particle flies is determined not only by the best position of the global best particle and the best position this particle has ever reached, but also by the positions of two randomly selected particles. Therefore, the particle will be more likely to get out of local optima to search for better solutions.

Using the above components, we can present the complete PSO procedure for solving the multiple crane and truck scheduling problem.
                           
                              
                                 
                                    Step1.
                                  Initialize L particles as a swarm to obtain the quay crane allocation and the sequence of containers on each quay crane (as demonstrated in Tables 1 and 2). Set iteration number τ
                                 =1.


                                 
                                    Step2.
                                  For l
                                 =1, 2,…,
                                 L, make sure that the containers in the same bay must be serviced by the same quay crane in the initial solutions (as demonstrated in Table 3), and the precedence between containers must be satisfied (as demonstrated in Table 4).


                                 
                                    Step3.
                                  For l=
                                 1,2,…,
                                 L, if conflict occurs between quay crane i and quay crane j (i
                                 <
                                 j), quay crane i waits until quay crane j completes the unloading task in current bay. Continue this process until there is no conflict between any two quay cranes.


                                 
                                    Step4.
                                  For l
                                 =1,2,…,
                                 L, allocate the trucks to containers in terms of the quay crane scheduling sequence.


                                 
                                    Step4.1. Arrange all the containers based on the ascending order of their completion time on the allocated quay crane.


                                 
                                    Step4.2. Consider the containers one-by-one in the above order. Allocate the container to the truck with the earliest available time, and calculate the completion time of the container on this allocated truck, as well as the new earliest available time of this truck. Continue this process until all the containers have been allocated to trucks.


                                 
                                    Step5.
                                  For l
                                 =1,2,…,
                                 L, calculate the fitness value, which is equal to the objective value.


                                 
                                    Step6.
                                  Update the best position of every particle, pbest.


                                 
                                    Step7.
                                  Update the best position of the swarm, gbest.


                                 
                                    Step8.
                                  Update the velocity using formula (44) and update the position using formula (42) of each particle.


                                 
                                    Step9.
                                  If τ reaches the preset maximum iteration, stop; otherwise set τ
                                 =
                                 τ
                                 +1 and go to step 2.

The model for the unidirectional flow problem is only suitable for the situation where there are only containers to be unloaded from ships. The trucks in this case only carry containers from quay crane to storage yard and they are empty when returning to the quay cranes. In practice, during a planning period, there are both containers to be unloaded from the ships and containers to be loaded onto the ships. The unloaded containers are transported to the yard after unloading, while the loaded containers are transported from the yard to the quay cranes before being loaded onto the ships. The problem becomes bidirectional and the trucks may carry containers in both directions reducing the empty trips.

The MILP model needs to be modified for applying to the bidirectional flow case. To present the modified model, we first re-define some parameters. Because each unloaded or loaded container has a fixed original location and a known destination location, so the time for a truck to transport one container from the quayside (yard) to the yard (quayside) is known in advance, and we call the time 
                           
                              
                                 
                                    P
                                 
                                 
                                    j
                                    2
                                 
                                 
                                    ′
                                 
                              
                           
                        . The time for a truck goes to serve another container is determined by the destination location of the container it just finished and the original location of the next container it is going to transport.
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          Ω
                                          1
                                       
                                       The set of containers to be unloaded from the ships
                                    
                                    
                                       
                                          Ω
                                          2
                                       
                                       The set of containers to be loaded onto the ships
                                    
                                    
                                       
                                          Ω
                                       
                                       The set of all containers to be unloaded or loaded from or onto the ships, Ω
                                          =
                                          Ω
                                          1
                                          ∪
                                          Ω
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      j
                                                      1
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       The quay crane time needed to unload (or load) container j
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      j
                                                      2
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       The time for a truck to transport container j from the its original location to its destination location
                                    
                                    
                                       
                                          sij
                                          
                                       
                                       The travel time of a quay crane from the bay of container i to the bay of container j
                                       
                                    
                                    
                                       
                                          tij
                                          
                                       
                                       The transporting time of a truck from the destination location of container i to the original location of container j
                                       
                                    
                                 
                              
                           
                        
                     

Many constraints of the original model are still valid to the bidirectional flow situation. The modifications to the model are presented below.
                           
                              (45)
                              
                                 min
                                 
                                 
                                    
                                       
                                          max
                                       
                                       
                                          i
                                          ∈
                                          Ω
                                          ,
                                          j
                                          =
                                          1
                                          ,
                                          2
                                       
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       ij
                                    
                                 
                              
                           
                        
                     

Subject to constraints (3)–(12), (14), (15), (17)–(19), (21), (22), (24)–(26) and
                           
                              (46)
                              
                                 
                                    
                                       C
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       i
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 
                                 
                                 i
                                 ∈
                                 
                                    
                                       Ω
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                        
                           
                              (47)
                              
                                 
                                    
                                       C
                                    
                                    
                                       i
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       2
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 
                                 
                                 i
                                 ∈
                                 
                                    
                                       Ω
                                    
                                    
                                       1
                                    
                                 
                              
                           
                        
                        
                           
                              (48)
                              
                                 
                                    
                                       C
                                    
                                    
                                       j
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       P
                                    
                                    
                                       j
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       s
                                    
                                    
                                       0
                                       j
                                    
                                 
                                 +
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       Z
                                    
                                    
                                       0
                                       jq
                                    
                                 
                                 )
                                 ⩾
                                 0
                                 
                                 
                                 j
                                 ∈
                                 Ω
                                 ,
                                 
                                 q
                                 ∈
                                 Q
                              
                           
                        
                        
                           
                              (49)
                              
                                 
                                    
                                       C
                                    
                                    
                                       j
                                       1
                                    
                                 
                                 +
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       Z
                                    
                                    
                                       ijq
                                    
                                 
                                 )
                                 ⩾
                                 
                                    
                                       C
                                    
                                    
                                       i
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       s
                                    
                                    
                                       ij
                                    
                                 
                                 +
                                 
                                    
                                       P
                                    
                                    
                                       j
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 
                                 
                                 i
                                 ,
                                 
                                 j
                                 ∈
                                 Ω
                                 ,
                                 
                                 q
                                 ∈
                                 Q
                              
                           
                        
                        
                           
                              (50)
                              
                                 
                                    
                                       C
                                    
                                    
                                       j
                                       2
                                    
                                 
                                 -
                                 
                                    
                                       P
                                    
                                    
                                       j
                                       2
                                    
                                    
                                       ′
                                    
                                 
                                 -
                                 
                                    
                                       t
                                    
                                    
                                       0
                                       j
                                    
                                 
                                 +
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       X
                                    
                                    
                                       0
                                       ju
                                    
                                 
                                 )
                                 ⩾
                                 0
                                 
                                 
                                 j
                                 ∈
                                 Ω
                                 u
                                 ∈
                                 T
                              
                           
                        
                        
                           
                              (51)
                              
                                 
                                    
                                       C
                                    
                                    
                                       j
                                       1
                                    
                                 
                                 +
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       X
                                    
                                    
                                       iju
                                    
                                 
                                 )
                                 ⩾
                                 
                                    
                                       C
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       t
                                    
                                    
                                       ij
                                    
                                 
                                 
                                 
                                 i
                                 ∈
                                 Ω
                                 ,
                                 j
                                 ∈
                                 
                                    
                                       Ω
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 u
                                 ∈
                                 T
                              
                           
                        
                        
                           
                              (52)
                              
                                 
                                    
                                       C
                                    
                                    
                                       j
                                       1
                                    
                                 
                                 +
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       X
                                    
                                    
                                       iju
                                    
                                 
                                 )
                                 ⩾
                                 
                                    
                                       C
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       t
                                    
                                    
                                       ij
                                    
                                 
                                 +
                                 
                                    
                                       P
                                    
                                    
                                       j
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 
                                 
                                 i
                                 ∈
                                 Ω
                                 ,
                                 j
                                 ∈
                                 
                                    
                                       Ω
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 u
                                 ∈
                                 T
                              
                           
                        
                     

For the bidirectional flow problem, the objective function is modified as shown in formula (45). Constraints (46) and (52) are new constraints added to the model, and constraints (47), (48), (49), (50) and (51) are modified constraints to replace constraints (2), (13), (16), (20) and (23), respectively.

For the bidirectional flow problems, the last finished container may be a container to be loaded or unloaded. Therefore, there may not be a transporting time after the last crane operation. Accordingly we can remove the term 
                           
                              min
                              
                              {
                              
                                 
                                    P
                                 
                                 
                                    i
                                    2
                                 
                                 
                                    ′
                                 
                              
                              |
                              i
                              ∈
                              Ω
                              }
                           
                         from the objective of the model for lower bound 2 to make the lower bound applicable to the bidirectional flow problems.

We define the following additional notation and modify the model for lower bound 2 of the unidirectional flow problem, and then use the modified model to calculate the lower bound of the bidirectional flow problem.
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      
                                                         
                                                            hh
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       The moving time for a quay crane from bay h to bay h′
                                    
                                 
                              
                           
                        
                     

The lower bound model is as follows.
                           
                              (53)
                              
                                 Minimize
                                 
                                 F
                                 1
                              
                           
                        
                     

Subject to constraints (6)–(9), (25)–(26), (32)–(36), (39)–(40) and
                           
                              (54)
                              
                                 
                                    
                                       D
                                    
                                    
                                       h
                                    
                                 
                                 -
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       s
                                    
                                    
                                       
                                          
                                             hh
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩽
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       w
                                    
                                    
                                       
                                          
                                             hh
                                          
                                          
                                             ′
                                          
                                       
                                       q
                                    
                                 
                                 )
                                 
                                 
                                 h
                                 ,
                                 
                                 
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 E
                                 ,
                                 
                                 q
                                 ∈
                                 Q
                              
                           
                        
                        
                           
                              (55)
                              
                                 
                                    
                                       D
                                    
                                    
                                       h
                                    
                                 
                                 -
                                 
                                    
                                       S
                                    
                                    
                                       h
                                    
                                 
                                 -
                                 
                                    
                                       s
                                    
                                    
                                       0
                                       h
                                    
                                 
                                 +
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       w
                                    
                                    
                                       0
                                       hq
                                    
                                 
                                 )
                                 ⩾
                                 0
                                 
                                 
                                 h
                                 ∈
                                 E
                                 ,
                                 
                                 q
                                 ∈
                                 Q
                              
                           
                        
                     

For the bidirectional flow problem, two methods are proposed to improve the PSO algorithm. In our PSO algorithm, a disturbance method is presented to avoid the algorithm falling into local optima. The detailed process of the disturbance method is as follows: when the best solution in the swarm has not been updated during μ iterations, we re-initialize the particle that has the worst fitness value. This is the first improvement of the PSO, which is called DPSO.

In our algorithm, the fitness value is equal to the objective value. When the fitness value of a particle is not greater than the average fitness value of all the particles in the swarm, a new velocity updating formula is used to update the velocity of this particle, which is shown as formula (56). This is the second improvement of our PSO algorithm, which is called VPSO.
                           
                              (56)
                              
                                 
                                    
                                       v
                                    
                                    
                                       ik
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 =
                                 ω
                                 
                                    
                                       v
                                    
                                    
                                       ik
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             pbest
                                          
                                          
                                             ik
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       ik
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ak
                                    
                                    
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       bk
                                    
                                    
                                       t
                                    
                                 
                                 )
                              
                           
                        
                     

We call the PSO algorithm with the above two improvements IPSO, and the PSO algorithm with no improvement SPSO.

The complete PSO procedure for solving the bidirectional flow problem is as follows.
                           
                              
                                 
                                    Step1.
                                  Initialize L particles as a swarm to obtain a processing sequence of all the containers, and each particle has N dimensions, in which N denotes the number of containers. The encoding of the solutions is the same as Xi
                                  as demonstrated in Table 1. Set iteration number τ
                                 =1, l
                                 =1.


                                 
                                    Step2.
                                  Make sure that the containers in the same bay must be serviced by the same quay crane in the initial solutions (as demonstrated in Table 3). In addition, the precedence between containers must be satisfied (as demonstrated in Table 4). Set i
                                 =1.


                                 
                                    Step3.
                                  If container i is to be unloaded, go to step 4, else go to step 5.


                                 
                                    Step4.
                                  If container i is the first one in its bay to be unloaded, allocate the quay crane with the earliest available time to container i, else allocate the quay crane that has been allocated to serve this bay to container i. Allocate the truck with the earliest available time to container i. Go to step 6.


                                 
                                    Step5.
                                  Allocate the truck with the earliest available time to container i. If container i is the first one in its bay to be loaded, allocate the quay crane with the earliest available time to container i, else allocate the quay crane that has been allocate to serve this bay to container i. Go to step 6.


                                 
                                    Step6.
                                  Calculate the completion time of the container on the allocated quay crane and truck, and make sure there are no conflicts between different quay cranes. Then update the earliest available times of the allocated quay crane and truck.


                                 
                                    Step7.
                                  If i
                                 =
                                 N go to step 8, otherwise set i
                                 =
                                 i
                                 +1 and go to step 3.


                                 
                                    Step8.
                                  If l
                                 =
                                 L go to step 9, otherwise set l
                                 =
                                 l
                                 +1 and go to step 2.


                                 
                                    Step9.
                                  For l
                                 =1,2,…,
                                 L, calculate the fitness value, which is equal to the objective value.


                                 
                                    Step10.
                                  Update the best position of every particle, pbest.


                                 
                                    Step11.
                                  Update the best position of the swarm, gbest.


                                 
                                    Step12.
                                  If the best solution has not been updated during μ iterations, re-initialize the particle that has the worst fitness value. For l=
                                 1,2,…,
                                 L, if the fitness value of particle l is not bigger than the average fitness value of all the particles in the swarm, update the velocity using formulae (56); otherwise update the velocity using formula (43), and then update the position of each particle using formula (42).


                                 
                                    Step13.
                                  If τ reaches the setting maximal iteration, stop; otherwise set τ
                                 =
                                 τ
                                 +1, l
                                 =1 and go to step 2.

To test the performance of the proposed PSO algorithm, computational experiments have been carried out on both unidirectional flow problems and bidirectional flow problems. In the PSO algorithm, the maximum number of iterations and the population size are set as 500 and 30, respectively, for all the experiments. Based on the results of test runs, we set μ
                     =3, c1=2, c2=2. Similar to the original PSO algorithm, the value of c3 needs to be set by the user. We tested the PSO with c3=0 (the same as in the original PSO algorithm), 0.5, 1, 1.5 and 2 to solve some test problems. The results show that c3=1 performs the best. So we choose c3=1 for all the experiments. The results of the PSO algorithm are compared with the lower bounds and for small sized problems also with the optimal solutions obtained by solving the model. In addition, we have compared the PSO algorithm with another nature inspired algorithm as well. To the best of our knowledge, there has not been any nature inspired algorithm previously used to solve the problem studied in this paper. We choose the genetic algorithm (GA) presented by Lee et al. (2008) for comparison. A chromosome of the GA represents a sequence of containers which can be decoded in the same way as in the proposed PSO algorithm, i.e., a feasible solution is generated by scheduling the trucks based on the container sequence. We also use the adaptive crossover operator and the adaptive mutation operator in literature (Yan, 2010) to improve the GA. In the GA used in all the computational experiments, the maximum and minimum probability of crossover, the maximum and minimum probability of mutation, and the population size of the GA are set as 0.3, 0.2, 0.12, 0.08, and 200, respectively. The GA stops when the computation time reaches the same time spent by the proposed PSO for the problem instance.

All the experiments are performed on a computer with 2.83gigahertz Intel Core 2 CPU and 3.25gigabyte RAM. The algorithms are coded in C++, and the models are solved using CPLEX. In the two subsections below, we report the experiments for the unidirectional flow problem the bidirectional flow problem, respectively.

In this section, we first give the problem generation, and then test the contribution of the proposed valid inequalities to the performance of the model. The results of the proposed PSO algorithm are compared with the optimal solutions obtained by CPLEX, the proposed lower bounds, and the solutions obtained by the GA for all the small sized problems. For large sized problems, the results of the proposed PSO algorithm are compared with lower bounds and the solutions generated by the GA, because CPLEX cannot obtain good solutions within acceptable time.

For the experiments on the unidirectional flow problem, we randomly generated 2 types of problems - nine small sized problem instances and nine large sized problem instances. We consider the cases of 10, 15 and 20 containers for small sized problems; and 100, 200 and 300 containers for large sized problems. The problem data are randomly generated as follows.
                              
                                 (1)
                                 The time for unloading a container follows the uniform distribution, ranging from 140seconds to 190seconds (including the picking up time, dropping off time and traveling time of quay cranes).

The traveling speed of the trucks is 5meters per seconds.

In the unidirectional flow problem, the time for a truck to transport an unloaded container is determined by the distance from the original location (quayside) of the container to its destination (blocks in the yard), the distance from the destination of the container to the quayside, as well as the speed of the truck. We take a bay number of the ship as the original location of an unloaded container, and the destination of each unloaded container is expressed by a block number of the yard. In the experiments the destinations of all the unloaded containers are generated based on the layout of a container terminal.

The small sized unidirectional flow problems are first solved using the proposed model, and model with the valid inequalities (27) to (30) and the proposed PSO algorithm. The objective value results obtained by these methods and the computation time used are presented in Table 5
                           . In the table, N, c and t are the numbers of containers, cranes and trucks, respectively. M denotes the original model and M denotes the model with valid inequalities.

From Table 5, we can observe that models with and without the valid inequalities yield the same solution. However, the valid inequalities help to reduce computation time, from over 2.5minutes to less than 2minutes on average. The proposed PSO solve each of the small problems in only about half second on average.


                           Table 6
                            shows the two lower bounds calculated for the small sized unidirectional problems and the relative deviations of the PSO solution and the lower bounds from the optimal model solution (Opt). From the results we can see that the proposed PSO algorithm generates solutions very close to optimum with an average relative deviation of 1.89% from the optimum. Lower bound (LB) 2 is much tighter than LB 1. LB2 is only 2.5% below the optimum on average while LB1 is 7.17% below optimum. Therefore we will compare the PSO solution with LB2 in subsequent experiments. For the small unidirectional problems, the relative deviation of PSO solution from LB2 is 4.53% on average. This is larger than the relative deviation of PSO solution from optimum because LB2 is lower than optimum.

For large sized problems, the results of the proposed PSO algorithm are compared with lower bound 2 (LB2) as reported in Table 7
                           . From the results, we can observe that the average relative deviation of the PSO solution from LB2 is 5.18%. As the optimal solution is between the PSO solution and the lower bound, the PSO solution could be much closer to the optimum than 5.18%, as demonstrated for case of the small problems in Table 6. Table 7 also shows the computation time of the proposed PSO algorithm. While the model for the large problems cannot be solved in reasonable time, the PSO solve the problems in 74.56seconds on average. The results indicate that the proposed PSO algorithm is effective and efficient to solve this kind of scheduling problems.


                           Tables 8 and 9
                           
                            compare the results of the proposed PSO algorithm and the GA for unidirectional problems of small and large sizes, respectively. The last column in the tables shows the relative deviation of GA result from PSO result, with positive number meaning PSO solution is better and negative number meaning GA solution is better. From Table 8, we can see that the PSO solution is better than the GA solution for seven out of nine problem instances, and the average result of the proposed PSO algorithm is also better than that of the GA. Table 9 shows that the PSO solution is better than the GA solution on average and for all the tested large problems except two. Furthermore, the average relative deviation is larger than that for the small problems.

This section reports the experiment results on the bidirectional flow problems. Different versions of the PSO algorithm are tested. They are the standard PSO algorithm (SPSO), the PSO algorithm with disturbance method (DPSO), the PSO algorithm with the new velocity updating method (VPSO), and the PSO algorithm with both of the above improvements (IPSO). The results of proposed PSO algorithm are compared with the optimal solutions obtained by solving the model section 7 using CPLEX for small sized problems, and with the proposed lower bound for the large sized problems.

To demonstrate the effectiveness of the proposed PSO algorithm for the bidirectional flow problems, we test the algorithm on 2 types of randomly generated problems – ten small sized problems, and eight large sized problems. We consider the cases of container number from 7 to 11 for small sized problems; and 100, 200, 300 and 500 containers for large sized problems.

In this section the data in the experiments are generated as follows:
                              
                                 (1)
                                 The time of unloading or loading a container is generated follows the uniform distribution, ranging from 105seconds to 161seconds (including the picking up time, dropping off time of quay cranes, but including the traveling time of quay cranes).

The traveling speed of the trucks is 5meters per seconds.

For the bidirectional flow problems, the time for a truck to transport an inbound container is determined by the distance from the original location (bays) of the container to its destination (blocks in the yard) and the traveling speed of the truck. In practical operations at container terminals, the original locations of all the inbound containers are informed by the ships before their arrival and the destination locations of these containers are planned in storage allocation planning and so are also known.

The time for transporting an outbound container by a truck equals the distance from the original location (blocks in the yard) of the container to its destination location (bays) divided by the traveling speed of the truck. The original locations (block numbers in the yard) of all the outbound containers are known. The destination locations of the outbound containers are also known from the stowage plan of the ships.

In our experiment, the original (destination) locations of the inbound (outbound) containers are generated randomly considering the configuration of the ships, and the destinations (original) locations of the inbound (outbound) containers are generated based on the practical layout of a container terminal.

In order to understand the performance of the improvement strategies in the proposed PSO algorithm on the bidirectional flow problem, we first compare the standard PSO algorithm and the three versions of improved PSO algorithms. The results for small and large sized problems are reported in Table 10
                            and Table 11
                           , respectively. The best solution for each problem is shown in bold. From the results, we observe that the solution by the PSO algorithm with both improvement strategies (IPSO) is not worse than those of others for any of the small sized problems. For large sized problems, five in eight solutions obtained by IPSO are better than those by others. With almost the same computation time, IPSO generates better solution than the SPSO solution. In the subsequent comparisons we use IPSO to represent the proposed PSO algorithm.

The IPSO solution is compared with optimal solution (Opt) and lower bound (LB) for small sized problems in Table 12
                           . From the results, we can observe that the average relative deviation of the IPSO solution is only 0.22% from optimum. The computation time for CPLEX to solve the model optimally increases quickly as the problem size increases. The average computation time of CPLEX is about 5minutes for the small problems while IPSO only takes 0.17seconds on average.

The average relative deviation of LB from the optimal solution is 1.02% for the small sized problems. The relative deviation of IPSO solution from LB is 1.26% on average for the small problems. For large sized problems, the average relative deviation of IPSO solution from LB is 2.48% as shown in Table 13
                           . This demonstrates that our IPSO algorithm is effective for the joint quay crane and truck scheduling problem with bidirectional flow.


                           Tables 14
                            and 15
                            compare the IPSO and the GA for bidirectional problems with small and large sizes, respectively. IPSO shows better performance than the GA for all of the problems. The average relative differences between the results of IPSO and GA are 2.26% and 6.05% respectively for small and large sized problems.

In the unidirectional flow problem, the truck traveling time for each container is set as the time for a truck to transport the container from the quay crane to the container’s destination in the yard and to return to the quay crane. In cases where each truck serves a dedicated quay crane, the traveling time is accurate. Otherwise, if a truck can go to another quay crane after transporting a container to the yard, such a traveling time is only an estimation. In this case the model and algorithm for the bidirectional flow problem can be applied to solve the unidirectional problem, as the unidirectional problem is a special case of the bidirectional problem and different parts of the traveling time in the bidirectional flow model are more precisely calculated in detail.

@&#CONCLUSIONS@&#

In this paper, a mixed integer programming model was first formulated for the joint quay crane and truck scheduling problem with only inbound containers. A PSO algorithm with a modified update strategy was proposed for this unidirectional flow problem. The results of the proposed PSO algorithm were compared with the optimal solutions and two lower bounds. The model was then extended to the general situation with both inbound and outbound containers. For this bidirectional flow problem, a new velocity strategy and a disturbance method were added into the PSO algorithm, and the solutions were compared with the optimal solutions and a lower bound through computational experiments. The results demonstrated that the proposed PSO algorithm was very effective and efficient for the joint quay crane and truck scheduling problem with unidirectional or bidirectional flow.

@&#ACKNOWLEDGEMENTS@&#

This research is partly supported by State Key Program of National Natural Science Foundation of China (Grant No. 71032004) and the Foundation for Innovative Research Groups of the National Natural Science Foundation of China (Grant No. 71321001).

@&#REFERENCES@&#

