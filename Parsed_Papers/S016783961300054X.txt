@&#MAIN-TITLE@&#Splines and unsorted knot sequences

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The definition of a B-spline is extended to unordered knot sequences. The resulting smooth piecewise polynomial of minimal support is named U-spline.


                        
                        
                           
                           U-splines can be negative and locally linearly dependent.


                        
                        
                           
                           Yet, linear combinations of U-splines share many B-spline properties including smoothness, polynomial reproduction, and evaluation by recurrence.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Spline

Unsorted knot sequence

de Boor

Recurrence

Basic interval

@&#ABSTRACT@&#


               
               
                  The definition of a B-spline is extended to unordered knot sequences. The added flexibility implies that the resulting piecewise polynomials, named U-splines, can be negative and locally linearly dependent. It is therefore remarkable that linear combinations of U-splines retain many properties of splines in B-spline form including smoothness, polynomial reproduction, and evaluation by recurrence.
               
            

@&#INTRODUCTION@&#

A univariate spline of degree d consisting of 
                        n
                        +
                        d
                      polynomial pieces is defined by n B-spline coefficients and 
                        n
                        +
                        d
                        +
                        1
                      real-valued scalars 
                        
                           
                              t
                           
                           
                              j
                           
                        
                     , called knots. By convention, these knots are listed in non-decreasing order. It is natural to ask what advantages or drawbacks arise if we drop this convention and define splines using an unsorted knot sequence. Unsorted knot sequences appear, for example, as a special case of splines with complex knots (Goldman and Tsianos, 2011) and arise in interpolation problems for linear reproduction, as shown in Example 3.2 of this paper. One approach to splines, polar forms (Ramshaw, 1989), lists ordering-independence as one of its fundamental properties; however, all detailed discussions and lecture notes assume either sorted knots or non-repeated knots. Of the many interactive online illustrations of splines only a small number, four at current counting, allows manipulating the knots. Of these, all but one either block knots from passing one another or re-sort the knot sequence (e.g. the nice applet (Kilian et al., 2013)). Only one illustration (Kraus, 2013) allows for full flexibility of knots, but encounters singularities. Apart from applications, the motivation for exploring U-splines is to probe and re-enforce the notions, proofs and properties underlying splines.

The first hint of what splines for unordered knot sequences might look like arose from a Gedankenspiel by Carl de Boor, Malcolm Sabin and the author a decade ago, that, for 
                        
                           
                              t
                           
                           
                              j
                           
                        
                        >
                        
                           
                              t
                           
                           
                              j
                              +
                              1
                           
                        
                     , the analogue of a B-spline of degree 0 might be defined as the negative of the characteristic function of the interval 
                        [
                        
                           
                              t
                           
                           
                              j
                              +
                              1
                           
                        
                        .
                        .
                        
                           
                              t
                           
                           
                              j
                           
                        
                        ]
                     . Ten years on, this ansatz is substantiated by U-splines.


                     Overview. In Section 2, U-splines are defined for unsorted, but ‘collocated’ knot sequences. A collocated knot sequence repeats knot values only consecutively or sufficiently spaced apart. As is customary for B-splines, the ith U-spline of degree d is associated with the subsequence 
                        
                           
                              t
                           
                           
                              i
                              :
                              i
                              +
                              d
                              +
                              1
                           
                        
                        :
                        =
                        (
                        
                           
                              t
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              t
                           
                           
                              i
                              +
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              t
                           
                           
                              i
                              +
                              d
                              +
                              1
                           
                        
                        )
                     , but now of the unsorted knot sequence 
                        
                           
                              t
                           
                           
                              0
                              :
                              n
                              +
                              d
                           
                        
                     . A useful insight, Lemma 2.1, is that any U-spline can be expressed as a multiple of the B-spline with the same, but sorted subsequence of knots. Alternatively we derive, again for unsorted, collocated knot sequences, a U-spline of higher degree by recurrence from U-splines of lower degree. The recurrence is that of B-splines, but it starts from signed characteristic functions.

In Section 3 we characterize the space spanned by U-splines. To this end, we need to ‘complete’ finite knot sequences and clarify, for U-splines, the notion of ‘basic interval’. The notion appears, in deceptively simple form, when analyzing splines in B-spline form. On a basic interval, the U-splines form a partition of unity, Marsdenʼs identity holds, they have linear precision and we can compute derivatives via differences of coefficients. But since U-splines may take on negative values, they can be locally linearly dependent.

Section 4 shows that a slight variant of de Boorʼs algorithm evaluates splines with collocated, unsorted knots. Prior to evaluation, any U-spline whose first knot equals its last knot has to be removed and, in the final step of the modified algorithm, the values of multiple intervals containing the point of evaluation have to be summed. Knot insertion is well-defined but does not imply variation diminution as for B-splines. Finally, Section 5 gives an example of knots that are not collocated. For the example no two-term evaluation recurrence with convex weights can correctly evaluate the associated spline. This points to collocated sequences as a maximal practical generalization of non-decreasing knot sequences.

We start by characterizing an important sub-class of all unsorted knot sequences.


                     
                        Definition 2.1
                        Collocated knot sequence


                        Let 
                              
                                 
                                    t
                                 
                                 
                                    0
                                    :
                                    n
                                    +
                                    d
                                 
                              
                            be an unsorted sequence of real scalars called knots hereafter. This knot sequence is d-collocated if
                              
                                 (L)
                                 
                                    ∀
                                    0
                                    <
                                    j
                                    ⩽
                                    d
                                    ,
                                    
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          j
                                       
                                    
                                    
                                    ⇒
                                    
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    =
                                    ⋯
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          j
                                       
                                    
                                    .
                                 
                              
                           
                        

That is, if any knot of a collocated sequence is repeated after fewer than d entries then all intermediate knots must have the same value.

Whenever the degree d is clear from the context, we simply say that the knot sequence is collocated. A collocated sequence appears to be necessary to establish basic properties and apply algorithms that make splines useful (see (1), (9), (18), (21), Section 5 of this paper).

For collocated knot sequences, we define U-splines analogous to B-splines via a table of divided differences 
                     
                        
                           
                              
                           
                        
                        (
                        
                           
                              t
                           
                           
                              i
                              :
                              j
                           
                        
                        )
                     . For a sufficiently smooth univariate real-valued function h with kth derivative 
                        
                           
                              D
                           
                           
                              k
                           
                        
                        h
                     ,
                        
                           (1)
                           
                              
                                 
                                    
                                       
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 h
                                 :
                                 =
                                 h
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       :
                                       j
                                    
                                 
                                 )
                                 h
                                 :
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   :
                                                   j
                                                
                                             
                                             )
                                             h
                                             −
                                             
                                                
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   :
                                                   j
                                                   −
                                                   1
                                                
                                             
                                             )
                                             h
                                             )
                                             /
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   j
                                                
                                             
                                             −
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             ,
                                          
                                          
                                             if 
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             ≠
                                             
                                                
                                                   t
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         j
                                                         −
                                                         i
                                                      
                                                   
                                                   h
                                                
                                                
                                                   (
                                                   j
                                                   −
                                                   i
                                                   )
                                                   !
                                                
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             ,
                                          
                                          
                                             if 
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   t
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                                 
                                 j
                                 ∈
                                 {
                                 i
                                 +
                                 1
                                 ,
                                 …
                                 ,
                                 i
                                 +
                                 d
                                 +
                                 1
                                 }
                                 .
                              
                           
                        
                      Since for collocated knots, 
                        
                           
                              t
                           
                           
                              i
                           
                        
                        =
                        
                           
                              t
                           
                           
                              j
                           
                        
                      implies that 
                        
                           
                              t
                           
                           
                              i
                           
                        
                        =
                        
                           
                              t
                           
                           
                              i
                              +
                              1
                           
                        
                        =
                        ⋯
                        =
                        
                           
                              t
                           
                           
                              j
                           
                        
                     , the definition is consistent in that the second case of (1) is the limiting case of the first when 
                        
                           
                              t
                           
                           
                              i
                           
                        
                        →
                        
                           
                              t
                           
                           
                              j
                           
                        
                     .


                     
                        Definition 2.2
                        U-spline from divided differences


                        Let 
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    d
                                    +
                                    1
                                 
                              
                            be an unsorted, d-collocated knot sequence. Then the piecewise polynomial of degree d defined by
                              
                                 (2)
                                 
                                    U
                                    (
                                    x
                                    |
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          :
                                          i
                                          +
                                          d
                                          +
                                          1
                                       
                                    
                                    )
                                    :
                                    =
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          d
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    
                                    
                                       
                                          
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          :
                                          i
                                          +
                                          d
                                          +
                                          1
                                       
                                    
                                    )
                                    
                                       
                                          (
                                          max
                                          
                                             {
                                             (
                                             ⋅
                                             −
                                             x
                                             )
                                             ,
                                             0
                                             }
                                          
                                          )
                                       
                                       
                                          d
                                       
                                    
                                    ,
                                 
                              
                            is called a U-spline.

If 
                        
                           
                              t
                           
                           
                              i
                              :
                              j
                           
                        
                      is a non-decreasing sequence then its knots are automatically collocated and 
                        U
                        (
                        x
                        |
                        
                           
                              t
                           
                           
                              i
                              :
                              j
                           
                        
                        )
                      is a B-spline 
                        B
                        (
                        x
                        |
                        
                           
                              t
                           
                           
                              i
                              :
                              j
                           
                        
                        )
                      as defined in de Boor (2001, IX(2)).

The constructive definition of divided differences is typically arranged in the form of a divided difference table as in recurrence (1). An alternative is to define 
                        
                           
                              
                           
                        
                        (
                        
                           
                              t
                           
                           
                              i
                              :
                              j
                           
                        
                        )
                        h
                      as the leading coefficient of the polynomial that interpolates h at the knots 
                        
                           
                              t
                           
                           
                              i
                              :
                              j
                           
                        
                      (Conte and de Boor, 1980, p. 42). This equivalent definition is clearly invariant under re-ordering of 
                        
                           
                              t
                           
                           
                              i
                              :
                              j
                           
                        
                        :
                        =
                        (
                        
                           
                              t
                           
                           
                              i
                           
                        
                        ,
                        …
                        ,
                        
                           
                              t
                           
                           
                              j
                           
                        
                        )
                     . Therefore, together with (2), we have the following useful Lemma 2.1, first suggested in this form by Carl de Boor.


                     
                        Lemma 2.1
                        Re-ordering of knots


                        
                           If 
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                    :
                                    j
                                 
                              
                            
                           is any re-ordering of 
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    j
                                 
                              
                            
                           then
                           
                              
                                 (3)
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    U
                                    (
                                    x
                                    |
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          :
                                          j
                                       
                                    
                                    )
                                    =
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    U
                                    (
                                    x
                                    |
                                    
                                       
                                          s
                                       
                                       
                                          i
                                          :
                                          j
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        

In particular, for any re-ordering 
                        
                           
                              s
                           
                           
                              i
                              :
                              j
                           
                        
                      of 
                        
                           
                              t
                           
                           
                              i
                              :
                              j
                           
                        
                     , and end-knots p and q of the knot sequence,
                        
                           (4)
                           
                              U
                              (
                              x
                              |
                              p
                              ,
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    j
                                 
                              
                              ,
                              q
                              )
                              =
                              U
                              (
                              x
                              |
                              p
                              ,
                              
                                 
                                    s
                                 
                                 
                                    i
                                    :
                                    j
                                 
                              
                              ,
                              q
                              )
                              ,
                           
                        
                     
                     
                        
                           (5)
                           
                              U
                              (
                              x
                              |
                              p
                              ,
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    j
                                 
                              
                              ,
                              q
                              )
                              =
                              −
                              U
                              (
                              x
                              |
                              q
                              ,
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    j
                                 
                              
                              ,
                              p
                              )
                              ,
                           
                        
                     
                     
                        
                           (6)
                           
                              U
                              (
                              x
                              |
                              q
                              ,
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    j
                                 
                              
                              ,
                              q
                              )
                              =
                              0
                              .
                           
                        
                      Eq. (6) explains why property (L) need not rule out U-splines whose first and last knots are equal: when dealing with linear combinations of U-splines, the contributions of U-splines of the form 
                        U
                        (
                        x
                        |
                        p
                        ,
                        …
                        ,
                        q
                        )
                      with 
                        p
                        =
                        q
                      are anyhow zero.

Since a U-spline with a sorted, non-decreasing knot sequence is a B-spline with that sequence, Lemma 2.1 implies that we can express any U-spline with non-constant sequence 
                        
                           
                              t
                           
                           
                              i
                              :
                              j
                           
                        
                      as a B-spline
                        
                           (7)
                           
                              U
                              (
                              x
                              |
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    j
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              B
                              (
                              x
                              |
                              
                                 
                                    s
                                 
                                 
                                    i
                                    :
                                    j
                                 
                              
                              )
                              ,
                              
                              where 
                              
                                 
                                    s
                                 
                                 
                                    i
                                    :
                                    j
                                 
                              
                              :
                              =
                              
                                 sort
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    j
                                 
                              
                              )
                              .
                           
                        
                      Therefore, the space of U-splines is spanned by the B-splines 
                        B
                        (
                        x
                        |
                        
                           
                              s
                           
                           
                              i
                              :
                              j
                           
                        
                        )
                      and it inherits the piecewise polynomiality and continuity of these B-splines.

Sorting the whole knot sequence t of a spline can however introduce subsequences of length 
                        d
                        +
                        2
                      that do not occur when separately sorting the knot subsequences of t. Consider for example 
                        t
                        :
                        =
                        (
                        0
                        ,
                        1
                        ,
                        1
                        ,
                        0
                        )
                      and 
                        d
                        =
                        1
                     . All U-splines corresponding to t are a multiple of 
                        B
                        (
                        x
                        |
                        0
                        ,
                        1
                        ,
                        1
                        )
                     , while the sorted sequence 
                        s
                        :
                        =
                        
                           sort
                        
                        (
                        t
                        )
                        =
                        (
                        0
                        ,
                        0
                        ,
                        1
                        ,
                        1
                        )
                      gives rise to 
                        B
                        (
                        x
                        |
                        0
                        ,
                        0
                        ,
                        1
                        )
                      and 
                        B
                        (
                        x
                        |
                        0
                        ,
                        1
                        ,
                        1
                        )
                     . That is, global sorting of the knots changes the spline space. Lemma 3.3 will characterize the relation in more detail.


                     U-splines via recurrence. An alternative approach to B-splines is to construct higher-degree B-splines from lower degree ones. Since the recurrence relations for B-splines are based on the divided difference representation, the recurrence applies equally well to U-splines. Only the initialization differs. For a U-spline the initialization has to reflect property (5) that 
                        U
                        (
                        x
                        |
                        p
                        ,
                        q
                        )
                        =
                        −
                        U
                        (
                        x
                        |
                        q
                        ,
                        p
                        )
                     .


                     
                        Lemma 2.2
                        U-spline recurrence


                        
                           For a collocated knot sequence 
                           
                              
                                 
                                    t
                                 
                                 
                                    0
                                    :
                                    n
                                    +
                                    d
                                 
                              
                           
                           , 
                           
                              x
                              ∈
                              R
                            
                           and integers i, j, k,
                           
                              
                                 (8)
                                 
                                    U
                                    (
                                    x
                                    |
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          :
                                          i
                                          +
                                          1
                                       
                                    
                                    )
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   if 
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ⩽
                                                x
                                                <
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                −
                                                1
                                             
                                             
                                                
                                                   if 
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                ⩽
                                                x
                                                <
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   otherwise
                                                
                                                ;
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (9)
                                 
                                    U
                                    (
                                    x
                                    |
                                    
                                       
                                          t
                                       
                                       
                                          j
                                          −
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          j
                                          :
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                    :
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      −
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            j
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            j
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                
                                                U
                                                (
                                                x
                                                |
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      j
                                                      :
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   if 
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ≠
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   otherwise 
                                                
                                             
                                          
                                       
                                       }
                                    
                                    +
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      x
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                                U
                                                (
                                                x
                                                |
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      j
                                                      :
                                                      k
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   if 
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                ≠
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   otherwise 
                                                
                                             
                                          
                                       
                                       }
                                    
                                    .
                                 
                              
                           
                        

Property (L) ensures that setting summands to zero is the correct limiting behavior: the denominator and the leading linear factor of U in definition (2) cancel one another and the remaining divided difference is, by (L) and (1), well-defined as a derivative of order 
                        k
                        −
                        j
                        +
                        1
                      of a polynomial of degree at most 
                        k
                        −
                        j
                     . Irrespective of the case distinction at the recurrence start, the proof, that the recurrence (9) yields the U-splines defined in Definition 2.2, is identical to that for B-splines (de Boor, 2001, IX(13)), i.e., it is based on Leibnizʼ formula applied to the divided differences.

The support of 
                        U
                        (
                        x
                        |
                        
                           
                              t
                           
                           
                              i
                              :
                              i
                              +
                              k
                           
                        
                        )
                      is evidently 
                        [
                        min
                        (
                        
                           
                              t
                           
                           
                              i
                              :
                              i
                              +
                              k
                           
                        
                        )
                        .
                        .
                        max
                        (
                        
                           
                              t
                           
                           
                              i
                              :
                              i
                              +
                              k
                           
                        
                        )
                        ]
                     .

To analyze the space spanned by U-splines, we need to generalize some notions that are rarely emphasized for B-splines but that are crucial for the analysis of splines with non-decreasing knot sequences.


                     Complete knot sequences. When t is a non-decreasing sequence, then extending it to a biinfinite (non-decreasing) knot sequence avoids a specialized discussion of the first and last d intervals. Alternatively, one may repeat the first knot of the non-decreasing sequence k times and the last knot k times.

For unsorted knots, neither approach, making the knot sequence biinfinite or repeating knots, yields the same benefits. A biinfinite sequence may still jump back and forth and the repeated knots may lie anywhere in the original interval of support 
                        I
                        :
                        =
                        [
                        min
                        (
                        
                           
                              t
                           
                           
                              0
                              :
                              n
                           
                        
                        )
                        .
                        .
                        max
                        (
                        
                           
                              t
                           
                           
                              0
                              :
                              n
                           
                        
                        )
                        ]
                     . We therefore define an augmented knot sequence that encloses I as follows.


                     
                        Definition 3.1
                        
                           d-complete knot sequence


                        Given the unsorted knot sequence 
                              
                                 
                                    t
                                 
                                 
                                    0
                                    :
                                    n
                                 
                              
                           , 
                              n
                              ⩾
                              k
                              :
                              =
                              d
                              +
                              1
                              >
                              0
                            and its sorted re-ordering 
                              
                                 
                                    s
                                 
                                 
                                    0
                                    :
                                    n
                                 
                              
                           , let 
                              
                                 
                                    t
                                 
                                 
                                    <
                                    0
                                 
                              
                            and 
                              
                                 
                                    t
                                 
                                 
                                    >
                                    n
                                 
                              
                            be two sequences of k knots each such that 
                              max
                              (
                              
                                 
                                    t
                                 
                                 
                                    <
                                    0
                                 
                              
                              )
                              ⩽
                              
                                 
                                    s
                                 
                                 
                                    0
                                 
                              
                            and 
                              
                                 
                                    s
                                 
                                 
                                    n
                                 
                              
                              ⩽
                              min
                              (
                              
                                 
                                    t
                                 
                                 
                                    >
                                    n
                                 
                              
                              )
                           . Then 
                              (
                              
                                 
                                    t
                                 
                                 
                                    <
                                    0
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                    :
                                    n
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    >
                                    n
                                 
                              
                              )
                            is a complete knot sequence for the interval 
                              I
                              :
                              =
                              [
                              
                                 
                                    s
                                 
                                 
                                    0
                                 
                              
                              .
                              .
                              
                                 
                                    s
                                 
                                 
                                    n
                                 
                              
                              ]
                           .


                     Partition of 1. Traversing a complete knot sequence in its order on the real line implies that I is traversed one more time in increasing order, from 
                        
                           
                              s
                           
                           
                              0
                           
                        
                      to 
                        
                           
                              s
                           
                           
                              n
                           
                        
                     , than in decreasing order: all contributions of negative and positive characteristic functions due to reversals of traversal direction cancel one another, except for one non-decreasing sequence required to connect 
                        
                           
                              s
                           
                           
                              0
                           
                        
                      to 
                        
                           
                              s
                           
                           
                              n
                           
                        
                     . By (8), for 
                        d
                        =
                        0
                     , this implies on I that
                        
                           (10)
                           
                              
                                 ∑
                                 i
                              
                              U
                              (
                              x
                              |
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    1
                                 
                              
                              )
                              =
                              1
                              .
                           
                        
                      Expanding the sum of higher-degree splines in terms of lower-degree ones according to (9), as is well-defined for a complete, collocated sequence on I, we see that the resulting two sums add up to a sum of U-splines of one degree lower:
                        
                           
                              
                                 ∑
                                 i
                              
                              U
                              (
                              x
                              |
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    d
                                    +
                                    1
                                 
                              
                              )
                              =
                              
                                 ∑
                                 i
                              
                              
                                 (
                                 
                                    
                                       x
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             d
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             d
                                          
                                       
                                       −
                                       x
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             d
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 )
                              
                              U
                              (
                              x
                              |
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    d
                                 
                              
                              )
                              =
                              
                                 ∑
                                 i
                              
                              U
                              (
                              x
                              |
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    d
                                 
                              
                              )
                              .
                           
                        
                      Together with (10), this establishes that U-splines of a given fixed degree form a partition of 1. The partition of 1 property implies affine invariance,
                        
                           
                              A
                              
                                 ∑
                                 i
                              
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              U
                              (
                              x
                              |
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    k
                                 
                              
                              )
                              +
                              a
                              =
                              
                                 ∑
                                 i
                              
                              (
                              A
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              +
                              a
                              )
                              U
                              (
                              x
                              |
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    k
                                 
                              
                              )
                              ,
                              
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              ,
                              a
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    dim
                                 
                              
                              ,
                              
                              A
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    
                                       dim
                                    
                                    ×
                                    
                                       dim
                                    
                                 
                              
                              ,
                           
                        
                      for curves based on U-splines. However, since individual U-splines can be negative, the local convex hull property, 
                        
                           
                              ∑
                           
                           
                              j
                              ∈
                              J
                           
                        
                        
                           
                              c
                           
                           
                              j
                           
                        
                        U
                        (
                        x
                        |
                        
                           
                              t
                           
                           
                              j
                              :
                              j
                              +
                              k
                           
                        
                        )
                        =
                        
                           
                              ∑
                           
                           
                              j
                              ∈
                              J
                           
                        
                        
                           
                              c
                           
                           
                              j
                           
                        
                        
                           
                              α
                           
                           
                              j
                           
                        
                        (
                        x
                        )
                      for 
                        
                           
                              ∑
                           
                           
                              j
                              ∈
                              J
                           
                        
                        
                           
                              α
                           
                           
                              j
                           
                        
                        =
                        1
                     , 
                        
                           
                              α
                           
                           
                              j
                           
                        
                        ⩾
                        0
                     , 
                        #
                        J
                        =
                        k
                     , need not hold for x in the support of all 
                        U
                        (
                        x
                        |
                        
                           
                              t
                           
                           
                              j
                              :
                              j
                              +
                              k
                           
                        
                        )
                     . We can salvage some aspect of the property by allowing 
                        −
                        1
                        ⩽
                        
                           
                              α
                           
                           
                              j
                           
                        
                        ⩽
                        1
                      in place of 
                        0
                        ⩽
                        
                           
                              α
                           
                           
                              j
                           
                        
                        ⩽
                        1
                     .


                     Polynomial reproduction. For B-splines, Marsdenʼs identity implies that all polynomials of degree d or less are linear combinations of B-splines of degree at least d. The proof of Marsdenʼs identity (de Boor, 2001, IX(30)) requires only partition of 1 and valid recurrence relations (9) as implied by property (L). In particular, the proof does not depend on the knot ordering. We can therefore apply the argument of de Boor (2001, IX(30)) directly, starting with the signed characteristic functions (8) as the base case, to prove the following identity.


                     
                        Lemma 3.1
                        Marsdenʼs identity for U-splines


                        
                           Let 
                           
                              
                                 
                                    t
                                 
                                 
                                    0
                                    :
                                    n
                                 
                              
                            
                           be a d-collocated knot sequence and 
                           
                              (
                              
                                 
                                    t
                                 
                                 
                                    <
                                    0
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                    :
                                    n
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    >
                                    n
                                 
                              
                              )
                            
                           a d-complete knot sequence for 
                           
                              I
                              :
                              =
                              [
                              min
                              
                              
                                 
                                    t
                                 
                                 
                                    0
                                    :
                                    n
                                 
                              
                              .
                              .
                              max
                              
                              
                                 
                                    t
                                 
                                 
                                    0
                                    :
                                    n
                                 
                              
                              ]
                           
                           . For any 
                           
                              τ
                              ∈
                              R
                            
                           and 
                           
                              x
                              ∈
                              I
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          (
                                          x
                                          −
                                          τ
                                          )
                                       
                                       
                                          d
                                       
                                    
                                    =
                                    
                                       ∑
                                       i
                                    
                                    
                                       
                                          ψ
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                :
                                                i
                                                +
                                                d
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    (
                                    τ
                                    )
                                    U
                                    (
                                    x
                                    |
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          :
                                          i
                                          +
                                          d
                                          +
                                          1
                                       
                                    
                                    )
                                    ,
                                    
                                    
                                       
                                          ψ
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                :
                                                j
                                             
                                          
                                       
                                    
                                    (
                                    τ
                                    )
                                    :
                                    =
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    τ
                                    )
                                    ⋯
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          j
                                          −
                                          1
                                       
                                    
                                    −
                                    τ
                                    )
                                    .
                                 
                              
                           
                        


                     
                        Example 3.1
                        Reproduction requires complete knot sequences


                        To see that Lemma 3.1 fails when the knot sequence is not complete consider the incomplete knot sequence 
                              
                                 
                                    t
                                 
                                 
                                    0
                                    :
                                    4
                                 
                              
                              :
                              =
                              (
                              0
                              ,
                              1
                              ,
                              2
                              ,
                              0
                              ,
                              1
                              )
                            and 
                              d
                              =
                              1
                           . Then
                              
                                 (11)
                                 
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       2
                                    
                                    
                                       
                                          ψ
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                :
                                                i
                                                +
                                                2
                                             
                                          
                                       
                                    
                                    (
                                    τ
                                    )
                                    U
                                    (
                                    x
                                    |
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          :
                                          i
                                          +
                                          2
                                       
                                    
                                    )
                                    =
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    τ
                                    )
                                    B
                                    (
                                    x
                                    |
                                    0
                                    ,
                                    1
                                    ,
                                    2
                                    )
                                    +
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    τ
                                    )
                                    
                                       
                                          −
                                          1
                                       
                                       2
                                    
                                    B
                                    (
                                    x
                                    |
                                    0
                                    ,
                                    1
                                    ,
                                    2
                                    )
                                    +
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    τ
                                    )
                                    
                                       
                                          −
                                          1
                                       
                                       2
                                    
                                    B
                                    (
                                    x
                                    |
                                    0
                                    ,
                                    1
                                    ,
                                    2
                                    )
                                    =
                                    
                                       (
                                       1
                                       −
                                       τ
                                       −
                                       
                                          1
                                          2
                                       
                                       (
                                       2
                                       +
                                       0
                                       −
                                       2
                                       τ
                                       )
                                       )
                                    
                                    B
                                    (
                                    x
                                    |
                                    0
                                    ,
                                    1
                                    ,
                                    2
                                    )
                                    =
                                    0
                                    .
                                 
                              
                           
                        

On the other hand, for the completed sequence 
                              
                                 
                                    t
                                 
                                 
                                    −
                                    2
                                    :
                                    6
                                 
                              
                              :
                              =
                              (
                              −
                              2
                              ,
                              −
                              1
                              ,
                              0
                              ,
                              1
                              ,
                              2
                              ,
                              0
                              ,
                              1
                              ,
                              3
                              ,
                              4
                              )
                            and its non-decreasing subsequence 
                              
                                 t
                                 ˜
                              
                              :
                              =
                              (
                              −
                              2
                              ,
                              −
                              1
                              ,
                              0
                              ,
                              1
                              ,
                              3
                              ,
                              4
                              )
                           , as expected,
                              
                                 (12)
                                 
                                    
                                       ∑
                                       
                                          i
                                          =
                                          −
                                          2
                                       
                                       4
                                    
                                    
                                       
                                          ψ
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                :
                                                i
                                                +
                                                2
                                             
                                          
                                       
                                    
                                    (
                                    τ
                                    )
                                    U
                                    (
                                    x
                                    |
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          :
                                          i
                                          +
                                          2
                                       
                                    
                                    )
                                    =
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    −
                                    τ
                                    )
                                    B
                                    (
                                    x
                                    |
                                    −
                                    2
                                    ,
                                    −
                                    1
                                    ,
                                    0
                                    )
                                    +
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    τ
                                    )
                                    B
                                    (
                                    x
                                    |
                                    −
                                    1
                                    ,
                                    0
                                    ,
                                    1
                                    )
                                    +
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          4
                                       
                                    
                                    −
                                    τ
                                    )
                                    B
                                    (
                                    x
                                    |
                                    0
                                    ,
                                    1
                                    ,
                                    3
                                    )
                                    +
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          5
                                       
                                    
                                    −
                                    τ
                                    )
                                    B
                                    (
                                    x
                                    |
                                    1
                                    ,
                                    3
                                    ,
                                    4
                                    )
                                    =
                                    ∑
                                    
                                       
                                          ψ
                                       
                                       
                                          
                                             
                                                
                                                   t
                                                   ˜
                                                
                                             
                                             
                                                i
                                                :
                                                i
                                                +
                                                2
                                             
                                          
                                       
                                    
                                    (
                                    τ
                                    )
                                    B
                                    (
                                    x
                                    |
                                    
                                       
                                          
                                             t
                                             ˜
                                          
                                       
                                       
                                          i
                                          :
                                          i
                                          +
                                          2
                                       
                                    
                                    )
                                    =
                                    (
                                    ⋅
                                    −
                                    τ
                                    )
                                    ,
                                 
                              
                            where the first equality follows from Lemma 2.1 and (11), the second by definition, and the last from Marsdenʼs identity for B-splines.


                     Basic interval. To establish properties of linear combinations of B-splines of degree d, requires focus on intervals where a full complement of 
                        k
                        :
                        =
                        d
                        +
                        1
                      B-splines is supported. For non-decreasing knots 
                        t
                        :
                        =
                        
                           
                              t
                           
                           
                              0
                              :
                              n
                              +
                              d
                           
                        
                     , all but the first d and the last d intervals are automatically in the support of exactly 
                        k
                        :
                        =
                        d
                        +
                        1
                      B-splines. Therefore, for non-decreasing knots, it makes sense to define the basic interval as 
                        
                           
                              I
                           
                           
                              n
                           
                        
                        :
                        =
                        [
                        
                           
                              t
                           
                           
                              d
                           
                        
                        .
                        .
                        
                           
                              t
                           
                           
                              n
                           
                        
                        ]
                      and prove properties on this interval.

For establishing analogous properties of linear combinations of U-splines, the definition of 
                        
                           
                              I
                           
                           
                              n
                           
                        
                      above does not work. For example, the knot sequence 
                        t
                        :
                        =
                        (
                        0
                        ,
                        1
                        ,
                        2
                        ,
                        0
                        ,
                        1
                        )
                      of Example 3.1 and 
                        d
                        =
                        1
                      yields, according to interpretation, either 
                        
                           
                              I
                           
                           
                              n
                           
                        
                        =
                        [
                        
                           
                              t
                           
                           
                              1
                           
                        
                        .
                        .
                        
                           
                              t
                           
                           
                              3
                           
                        
                        ]
                        =
                        [
                        0
                        .
                        .
                        1
                        ]
                     , or, since 
                        
                           
                              t
                           
                           
                              2
                           
                        
                        =
                        2
                        >
                        
                           
                              t
                           
                           
                              3
                           
                        
                     , 
                        
                           
                              I
                           
                           
                              n
                           
                        
                        =
                        [
                        0
                        .
                        .
                        2
                        ]
                     . In either case, the three U-splines defined on 
                        
                           
                              I
                           
                           
                              n
                           
                        
                      before completion are by (3) each a multiple of just one B-spline 
                        B
                        (
                        x
                        |
                        0
                        ,
                        1
                        ,
                        2
                        )
                      (cf. (11)), i.e. do not span the space of piecewise polynomials of degree 
                        d
                        =
                        1
                      on 
                        
                           
                              I
                           
                           
                              n
                           
                        
                     . To obtain the necessary empty set as basic interval in this setting, we have to explicitly remove all support intervals of U-splines that are added by completion, namely 
                        B
                        (
                        x
                        |
                        −
                        2
                        ,
                        −
                        1
                        ,
                        0
                        )
                     , 
                        B
                        (
                        x
                        |
                        −
                        1
                        ,
                        0
                        ,
                        1
                        )
                     , 
                        B
                        (
                        x
                        |
                        0
                        ,
                        1
                        ,
                        3
                        )
                      and 
                        B
                        (
                        x
                        |
                        1
                        ,
                        3
                        ,
                        4
                        )
                     . Since all of 
                        
                           
                              I
                           
                           
                              n
                           
                        
                      is in the support of 
                        B
                        (
                        x
                        |
                        −
                        1
                        ,
                        0
                        ,
                        1
                        )
                      and 
                        B
                        (
                        x
                        |
                        0
                        ,
                        1
                        ,
                        3
                        )
                      the basic interval is empty.


                     
                        Definition 3.2
                        Basic interval


                        For 
                              n
                              ⩾
                              k
                              :
                              =
                              d
                              +
                              1
                              >
                              0
                           , let 
                              (
                              
                                 
                                    t
                                 
                                 
                                    −
                                    k
                                    :
                                    n
                                    +
                                    d
                                    +
                                    k
                                 
                              
                              )
                            be a completion of the unsorted, collocated knot sequence 
                              t
                              :
                              =
                              
                                 
                                    t
                                 
                                 
                                    0
                                    :
                                    n
                                    +
                                    d
                                 
                              
                           . Let 
                              
                                 
                                    s
                                 
                                 
                                    d
                                    :
                                    n
                                 
                              
                              :
                              =
                              
                                 sort
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    d
                                    :
                                    n
                                 
                              
                              )
                           . Then
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          b
                                       
                                    
                                    :
                                    =
                                    [
                                    
                                       
                                          s
                                       
                                       
                                          d
                                       
                                    
                                    .
                                    .
                                    
                                       
                                          s
                                       
                                       
                                          n
                                       
                                    
                                    ]
                                    \
                                    
                                       (
                                       
                                          [
                                          min
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                −
                                                k
                                                :
                                                d
                                             
                                          
                                          )
                                          .
                                          .
                                          max
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                −
                                                k
                                                :
                                                d
                                             
                                          
                                          )
                                          ]
                                       
                                       ∪
                                       
                                          [
                                          min
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                n
                                                :
                                                n
                                                +
                                                d
                                                +
                                                k
                                             
                                          
                                          )
                                          .
                                          .
                                          max
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                n
                                                :
                                                n
                                                +
                                                d
                                                +
                                                k
                                             
                                          
                                          )
                                          ]
                                       
                                       )
                                    
                                 
                              
                            is the basic interval of t.


                     
                        Lemma 3.2
                        B-splines per basic interval


                        
                           Let 
                           
                              n
                              ⩾
                              k
                              :
                              =
                              d
                              +
                              1
                              >
                              0
                            
                           and 
                           
                              t
                              :
                              =
                              
                                 
                                    t
                                 
                                 
                                    0
                                    :
                                    n
                                    +
                                    d
                                 
                              
                            
                           an unsorted, collocated knot sequence with basic interval 
                           
                              
                                 
                                    I
                                 
                                 
                                    b
                                 
                              
                           
                           . Then every interval 
                           
                              [
                              
                                 
                                    s
                                 
                                 
                                    j
                                    −
                                    1
                                 
                              
                              .
                              .
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                              ]
                              ⊆
                              
                                 
                                    I
                                 
                                 
                                    b
                                 
                              
                           
                           , 
                           
                              j
                              ∈
                              {
                              d
                              +
                              1
                              ,
                              …
                              ,
                              n
                              }
                           
                           , is in the support of k linearly independent B-splines with knots in 
                           t
                           .
                        


                     
                        Proof
                        For each interval 
                              [
                              
                                 
                                    s
                                 
                                 
                                    j
                                    −
                                    1
                                 
                              
                              .
                              .
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                              ]
                              ⊆
                              
                                 
                                    I
                                 
                                 
                                    b
                                 
                              
                           , we form a set 
                              
                                 
                                    T
                                 
                                 
                                    j
                                 
                              
                            of k knot subsequences by selecting for 
                              ℓ
                              =
                              1
                              ,
                              …
                              ,
                              k
                           , the subsequence 
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    k
                                 
                              
                            of t with least index i that contains exactly ℓ knots greater or equal to 
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                           . For 
                              ℓ
                              =
                              1
                           , such a subsequence exists since, by assumption, 
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          
                                       
                                       ¯
                                    
                                 
                              
                           , the first occurrence of 
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                           , is in 
                              
                                 
                                    I
                                 
                                 
                                    b
                                 
                              
                            and there exist k elements less than 
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                            and listed before 
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          
                                       
                                       ¯
                                    
                                 
                              
                            in t: if 
                              
                                 
                                    t
                                 
                                 
                                    a
                                 
                              
                              ⩾
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                            for some a, 
                              0
                              ⩽
                              a
                              ⩽
                              d
                           , then 
                              [
                              
                                 
                                    s
                                 
                                 
                                    j
                                    −
                                    1
                                 
                              
                              .
                              .
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                              ]
                              ⊆
                              [
                              min
                              (
                              
                                 
                                    t
                                 
                                 
                                    −
                                    k
                                    :
                                    d
                                 
                              
                              )
                              .
                              .
                              max
                              (
                              
                                 
                                    t
                                 
                                 
                                    −
                                    k
                                    :
                                    d
                                 
                              
                              )
                              ]
                            contradicting the definition of 
                              
                                 
                                    I
                                 
                                 
                                    b
                                 
                              
                           . For 
                              ℓ
                              >
                              1
                           , such a subsequence exists since k elements of 
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          
                                       
                                       ¯
                                    
                                    :
                                    n
                                    +
                                    d
                                 
                              
                            are greater or equal to 
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                           : if not then there exists a 
                              
                                 
                                    t
                                 
                                 
                                    
                                       n
                                       ¯
                                    
                                 
                              
                              ∈
                              
                                 
                                    t
                                 
                                 
                                    n
                                    :
                                    n
                                    +
                                    d
                                 
                              
                            such that 
                              
                                 
                                    t
                                 
                                 
                                    
                                       n
                                       ¯
                                    
                                 
                              
                              <
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                           , implying 
                              
                                 
                                    t
                                 
                                 
                                    
                                       n
                                       ¯
                                    
                                 
                              
                              ⩽
                              
                                 
                                    s
                                 
                                 
                                    j
                                    −
                                    1
                                 
                              
                            and hence 
                              [
                              
                                 
                                    s
                                 
                                 
                                    j
                                    −
                                    1
                                 
                              
                              .
                              .
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                              ]
                              ⊆
                              [
                              min
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                    :
                                    n
                                    +
                                    d
                                    +
                                    k
                                 
                              
                              )
                              .
                              .
                              max
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                    :
                                    n
                                    +
                                    d
                                    +
                                    k
                                 
                              
                              )
                              ]
                            contradicting the definition of 
                              
                                 
                                    I
                                 
                                 
                                    b
                                 
                              
                           .

Subsequences for different ℓ in 
                              
                                 
                                    T
                                 
                                 
                                    j
                                 
                              
                            have distinct, non-constant sorted re-orderings, possibly just differing by the multiplicity of knots. Therefore the B-splines obtained by (3) from the U-splines with knot sequences in 
                              
                                 
                                    T
                                 
                                 
                                    j
                                 
                              
                            are linearly independent.  □

By the same argument as for B-splines (de Boor, 2001, IX(34)), Marsdenʼs identity implies for the basic interval that for any polynomial p of degree d (or less) and any 
                        τ
                        ∈
                        R
                     ,
                        
                           (13)
                           
                              p
                              =
                              
                                 ∑
                                 i
                              
                              (
                              
                                 
                                    λ
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    d
                                    +
                                    1
                                 
                              
                              p
                              )
                              U
                              (
                              ⋅
                              |
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    d
                                    +
                                    1
                                 
                              
                              )
                           
                        
                     
                     
                        
                           (14)
                           
                              
                              with 
                              
                                 
                                    λ
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    d
                                    +
                                    1
                                 
                              
                              :
                              p
                              ↦
                              
                                 1
                                 
                                    d
                                    !
                                 
                              
                              
                                 ∑
                                 
                                    ν
                                    =
                                    0
                                 
                                 d
                              
                              
                                 
                                    (
                                    −
                                    D
                                    )
                                 
                                 
                                    ν
                                 
                              
                              
                                 
                                    ψ
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    d
                                    +
                                    1
                                 
                              
                              (
                              τ
                              )
                              
                                 
                                    D
                                 
                                 
                                    d
                                    −
                                    ν
                                 
                              
                              p
                              (
                              τ
                              )
                              .
                           
                        
                      We note that 
                        
                           
                              ψ
                           
                           
                              i
                              :
                              i
                              +
                              d
                              +
                              1
                           
                        
                      and hence 
                        
                           
                              λ
                           
                           
                              i
                              :
                              i
                              +
                              d
                              +
                              1
                           
                        
                      does not depend on the ordering of the indices and that 
                        
                           
                              λ
                           
                           
                              i
                              :
                              i
                              +
                              d
                              +
                              1
                           
                        
                      depends linearly on 
                        
                           
                              ψ
                           
                           
                              i
                              :
                              i
                              +
                              d
                              +
                              1
                           
                        
                     .


                     Knot averages. For any linear polynomial ℓ and 
                        d
                        >
                        0
                     , (13) implies that
                        
                           (15)
                           
                              ℓ
                              (
                              x
                              )
                              =
                              
                                 ∑
                                 i
                              
                              ℓ
                              
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       :
                                       i
                                       +
                                       d
                                       +
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                              
                              U
                              (
                              x
                              |
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    d
                                    +
                                    1
                                 
                              
                              )
                              ,
                              
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    d
                                    +
                                    1
                                 
                                 
                                    ⁎
                                 
                              
                              :
                              =
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    +
                                    ⋯
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          d
                                       
                                    
                                 
                                 d
                              
                           
                        
                      since 
                        
                           
                              D
                           
                           
                              k
                           
                        
                        ℓ
                        =
                        0
                      for 
                        k
                        >
                        1
                      and the linear polynomial 
                        (
                        
                           
                              D
                           
                           
                              d
                              −
                              1
                           
                        
                        
                           
                              ψ
                           
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    d
                                    +
                                    1
                                 
                              
                           
                        
                        )
                        (
                        τ
                        )
                        =
                        
                           
                              (
                              −
                              )
                           
                           
                              d
                           
                        
                        (
                        τ
                        d
                        −
                        ∑
                        
                           
                              t
                           
                           
                              i
                           
                        
                        )
                      vanishes at the Greville site 
                     
                        τ
                        =
                        
                           
                              t
                           
                           
                              i
                              :
                              i
                              +
                              d
                              +
                              1
                           
                           
                              ⁎
                           
                        
                     .


                     
                        Example 3.2
                        Linear representation of linear data


                        In Fig. 1
                           , 
                              n
                              =
                              4
                            points are marked on a straight line. Correspondingly, we might like the graph of a low-degree interpolating function f to have a linear segment. To linearly trace out this linear segment by the graph of a spline function f of degree 
                              d
                              >
                              1
                           , Eq. (15) suggests matching the points by the splineʼs control points 
                              (
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    d
                                    +
                                    1
                                 
                                 
                                    ⁎
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              )
                           . That is, we want to find knots 
                              
                                 
                                    t
                                 
                                 
                                    0
                                    :
                                    n
                                    +
                                    d
                                 
                              
                              :
                              =
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                    +
                                    d
                                 
                              
                              )
                            so that for given 
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    d
                                    +
                                    1
                                 
                                 
                                    ⁎
                                 
                              
                           
                           
                              
                                 (16)
                                 
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                          +
                                          ⋯
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                +
                                                d
                                             
                                          
                                       
                                       d
                                    
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          :
                                          i
                                          +
                                          d
                                          +
                                          1
                                       
                                       
                                          ⁎
                                       
                                    
                                    ,
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    .
                                 
                              
                            Since there are 
                              d
                              +
                              1
                            more knots than Greville abscissae, the system (16) of n equations is underconstrained and, by its structure, solvable.

But if we additionally require that the knots be non-decreasing, 
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              ⩽
                              
                                 
                                    t
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                           , then there may not exist a solution. In Fig. 1 the challenge is to fit a quadratic spline to the values 
                              
                                 
                                    y
                                 
                                 
                                    ⁎
                                 
                              
                              :
                              =
                              (
                              0
                              ,
                              1
                              ,
                              5
                              ,
                              6
                              )
                            at its Greville abscissae 
                              
                                 
                                    t
                                 
                                 
                                    ⁎
                                 
                              
                              =
                              
                                 
                                    y
                                 
                                 
                                    ⁎
                                 
                              
                           . That is, the challenge is to find knots 
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                            so that 
                              (
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              )
                              /
                              2
                              =
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                                 
                                    ⁎
                                 
                              
                           :
                              
                                 (17)
                                 
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    0
                                    ,
                                    
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    2
                                    ,
                                    
                                    
                                       
                                          t
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    10
                                    ,
                                    
                                    
                                       
                                          t
                                       
                                       
                                          4
                                       
                                    
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          5
                                       
                                    
                                    =
                                    12
                                    .
                                 
                              
                            If we assume non-decreasing knots then 
                              −
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              ⩾
                              0
                            and since 
                              
                                 
                                    t
                                 
                                 
                                    3
                                 
                              
                              =
                              2
                              −
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                            we have 
                              
                                 
                                    t
                                 
                                 
                                    4
                                 
                              
                              =
                              10
                              −
                              
                                 
                                    t
                                 
                                 
                                    3
                                 
                              
                              ⩾
                              8
                              +
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              ⩾
                              8
                            but also 
                              
                                 
                                    t
                                 
                                 
                                    5
                                 
                              
                              =
                              12
                              −
                              
                                 
                                    t
                                 
                                 
                                    4
                                 
                              
                              ⩽
                              4
                              −
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              ⩽
                              4
                           . But 
                              
                                 
                                    t
                                 
                                 
                                    4
                                 
                              
                              >
                              
                                 
                                    t
                                 
                                 
                                    5
                                 
                              
                            contradicts the assumption that the knot sequence is non-decreasing. Reparameterization 
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              ↦
                              α
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              +
                              β
                            does not change this outcome. So there is no choice of non-decreasing knots that yields the hoped-for ‘linear precision’. Fig. 1 shows a quadratic spline interpolant, made possible by unsorted knots. The interpolant is linear for 
                              x
                              ∈
                              [
                              0
                              .
                              .
                              6
                              ]
                            and, as expected, the graph is not linear outside this interval.


                     Differentiation. The (proof of the) differentiation formula
                        
                           (18)
                           
                              D
                              
                                 (
                                 
                                    ∑
                                    i
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       :
                                       i
                                       +
                                       d
                                       +
                                       1
                                    
                                 
                                 U
                                 (
                                 x
                                 |
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       :
                                       i
                                       +
                                       d
                                       +
                                       1
                                    
                                 
                                 )
                                 )
                              
                              =
                              d
                              
                                 ∑
                                 i
                              
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          :
                                          i
                                          +
                                          d
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          −
                                          1
                                          :
                                          i
                                          +
                                          d
                                       
                                    
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          d
                                       
                                    
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                 
                              
                              U
                              (
                              x
                              |
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    d
                                 
                              
                              )
                           
                        
                      does not depend on sorted knots, but does require a collocated knot sequence for the limit as 
                        
                           
                              t
                           
                           
                              i
                              +
                              d
                           
                        
                        →
                        
                           
                              t
                           
                           
                              i
                              −
                              1
                           
                        
                      to be well-defined. As an example of differentiation, the spline defined in Fig. 1 has two U-splines whose knot sequences 
                        
                           
                              t
                           
                           
                              j
                              :
                              j
                              +
                              3
                           
                        
                      cover 
                        x
                        =
                        3
                     . As expected for the example, the derivative at 
                        x
                        =
                        3
                      computes to
                        
                           
                              D
                              
                                 (
                                 U
                                 (
                                 ⋅
                                 |
                                 1
                                 ,
                                 −
                                 1
                                 ,
                                 3
                                 ,
                                 7
                                 )
                                 +
                                 5
                                 U
                                 (
                                 ⋅
                                 |
                                 −
                                 1
                                 ,
                                 3
                                 ,
                                 7
                                 ,
                                 5
                                 )
                                 )
                              
                              (
                              3
                              )
                              =
                              2
                              
                                 
                                    5
                                    −
                                    1
                                 
                                 
                                    7
                                    −
                                    (
                                    −
                                    1
                                    )
                                 
                              
                              U
                              (
                              3
                              |
                              −
                              1
                              ,
                              3
                              ,
                              7
                              )
                              =
                              1
                              .
                           
                        
                     
                  


                     Sorting and spline space. For a non-decreasing knot sequence 
                        t
                        :
                        =
                        
                           
                              t
                           
                           
                              0
                              :
                              n
                              +
                              d
                           
                        
                     , we denote by 
                        
                           
                              Π
                           
                           
                              d
                              ,
                              t
                           
                        
                      the space of piecewise polynomials of degree d partitioned by t and such that, at each knot of t, the polynomial pieces are connected with continuous derivatives at least d minus the consecutive multiplicity of that knot. We can retain this definition for unsorted, collocated knots t noting that the multiplicity of any knot and hence the removal of smoothness constraints between polynomial pieces is at most the maximum consecutive multiplicity in the sequence t. By construction, either by Definition 2.2 or Lemma 2.2, the space of U-splines over t is a sub-space of 
                        
                           
                              Π
                           
                           
                              d
                              ,
                              t
                           
                        
                     . The next lemma addresses globally sorting t.


                     
                        Lemma 3.3
                        U-splines as a sub-space of a B-spline space


                        
                           Let 
                           
                              s
                              :
                              =
                              
                                 sort
                              
                              (
                              t
                              )
                            
                           be a sorted, non-decreasing re-ordering of 
                           
                              t
                              :
                              =
                              
                                 
                                    t
                                 
                                 
                                    0
                                    :
                                    n
                                    +
                                    d
                                 
                              
                           
                           . A linear combination of U-splines over the knot sequence 
                           t 
                           can be represented as a linear combination of B-splines over the knot sequence 
                           s
                           .
                        


                     
                        Proof
                        Since s contains all knots of t, and since sorting can only increase the multiplicity of any knot in a knot subsequence of length 
                              d
                              +
                              1
                           , the space of U-splines over t is a sub-space of the less constrained space 
                              
                                 
                                    Π
                                 
                                 
                                    d
                                    ,
                                    s
                                 
                              
                           . By the Curry–Schoenberg theorem (de Boor, 2001, IX(44)), on the basic interval, 
                              
                                 
                                    Π
                                 
                                 
                                    d
                                    ,
                                    s
                                 
                              
                            equals the B-spline space over s.  □

While Lemma 3.2 hints that U-splines may span the piecewise polynomial space corresponding to a modified 
                        
                           sort
                        
                        (
                        t
                        )
                      where the multiplicity of any knot is at most the maximum multiplicity in t, the part of the Curry–Schoenberg theorem that states that the B-splines form a basis cannot hold for U-splines. The following example illustrates that U-splines, as opposed to B-splines, can be locally linearly dependent.


                     
                        Example 3.3
                        Local linear dependence


                        Let 
                              d
                              =
                              0
                           . Then 
                              t
                              =
                              (
                              −
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              2
                              )
                            is a collocated knot sequence complete for the interval 
                              [
                              0
                              .
                              .
                              1
                              ]
                            but
                              
                                 (19)
                                 
                                    f
                                    (
                                    x
                                    )
                                    :
                                    =
                                    U
                                    (
                                    x
                                    |
                                    −
                                    1
                                    ,
                                    1
                                    )
                                    +
                                    2
                                    U
                                    (
                                    x
                                    |
                                    1
                                    ,
                                    0
                                    )
                                    +
                                    U
                                    (
                                    x
                                    |
                                    0
                                    ,
                                    2
                                    )
                                 
                              
                            vanishes on the interval 
                              [
                              0
                              .
                              .
                              1
                              ]
                           .

The example can be daisy-chained as 
                        
                           
                              ∑
                           
                           
                              i
                           
                        
                        U
                        (
                        x
                        |
                        i
                        ,
                        i
                        +
                        2
                        )
                        +
                        2
                        U
                        (
                        x
                        |
                        i
                        +
                        1
                        ,
                        i
                        )
                      to show linear dependence on any subset of 
                        R
                     . (The simpler example 
                        
                           
                              ∑
                           
                           
                              i
                           
                        
                        U
                        (
                        x
                        |
                        0
                        ,
                        1
                        )
                        +
                        U
                        (
                        x
                        |
                        1
                        ,
                        0
                        )
                        =
                        0
                      does not cover much ground.)

Local linear dependence also implies that U-splines need not satisfy the inequality that establishes good condition of a basis.

A spline represented by a linear combination of U-splines can be evaluated by evaluating each U-spline separately. For example, we can use Lemma 2.1 to convert each U-spline to B-spline form, and then sum the terms. However, this is not very efficient. Famously, splines were made practical by providing a stable evaluation algorithm (de Boor, 1971, 1972; Cox, 1972) in terms of the coefficients of their representation in B-form,
                        
                           (20)
                           
                              
                                 ∑
                                 i
                              
                              
                                 
                                    c
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    d
                                    +
                                    1
                                 
                              
                              B
                              (
                              x
                              |
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    d
                                    +
                                    1
                                 
                              
                              )
                              .
                           
                        
                      Reversing the construction of higher-degree B-splines from lower ones (de Boor, 2001, Ch. X(26)) or applying Ramshawʼs blossoming approach (Ramshaw, 1989), yields the following recurrence relation for the B-spline coefficients.
                        
                           (21)
                           
                              For 
                              i
                              <
                              k
                               and 
                              x
                              ∈
                              [
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              .
                              .
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              ]
                              ,
                              
                              
                                 
                                    c
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          :
                                          k
                                       
                                    
                                 
                              
                              :
                              =
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    −
                                    x
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          −
                                          1
                                          :
                                          k
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    x
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          :
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                              .
                           
                        
                      Recurrence (21), the de Boor recurrence, is equally well-defined and has non-zero denominators for an unsorted knot sequence whenever the knot sequence is collocated. The only change in the case of unsorted sequences is in the final step. In the final step, potentially several contributions 
                        
                           
                              c
                           
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                    :
                                    i
                                    +
                                    1
                                 
                              
                           
                        
                      from intervals 
                        [
                        
                           
                              t
                           
                           
                              i
                           
                        
                        .
                        .
                        
                           
                              t
                           
                           
                              i
                              +
                              1
                           
                        
                        ]
                      covering x are summed with signs according to (8), i.e., negative if 
                        
                           
                              t
                           
                           
                              i
                              +
                              1
                           
                        
                        <
                        
                           
                              t
                           
                           
                              i
                           
                        
                     . Recurrence (21) is efficient for evaluation if we apply it only to coefficients whose associated U-spline is non-zero at the point x of evaluation. For sorted knots, at the recursion level associated with polynomials of degree d, exactly 
                        k
                        :
                        =
                        d
                        +
                        1
                      consecutive B-spline support intervals cover x; and the recurrence only forms convex combinations 
                        
                           
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              −
                              x
                           
                           
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              −
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           
                        
                     , 
                        
                           
                              x
                              −
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           
                           
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              −
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           
                        
                        ∈
                        [
                        0
                        .
                        .
                        1
                        ]
                     . For U-splines, the lack of knot ordering allows more than k intervals to cover and combinations are only affine: at the final recurrence level of constant U-splines, all coefficients need to be summed whose interval covers the evaluation point; and where 
                        x
                        <
                        
                           
                              t
                           
                           
                              i
                           
                        
                        <
                        
                           
                              t
                           
                           
                              k
                           
                        
                     , the fraction 
                        
                           
                              x
                              −
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           
                           
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              −
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           
                        
                      in (21) is negative.


                     
                        Example 4.1
                        Recurrence for U-spline coefficients


                        Consider the quadratic spline 
                              f
                              (
                              x
                              )
                              :
                              =
                              12
                              U
                              (
                              x
                              |
                              3
                              ,
                              4
                              ,
                              1
                              ,
                              5
                              )
                           , all of whose coefficients are zero except for 
                              
                                 
                                    c
                                 
                                 
                                    3
                                    ,
                                    4
                                    ,
                                    1
                                    ,
                                    5
                                 
                              
                              =
                              12
                           . To evaluate f at 
                              x
                              =
                              2
                            by recurrence, we compute
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          3
                                          ,
                                          4
                                          ,
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          2
                                          −
                                          3
                                       
                                       
                                          1
                                          −
                                          3
                                       
                                    
                                    12
                                    =
                                    6
                                    ,
                                    
                                    
                                       
                                          c
                                       
                                       
                                          4
                                          ,
                                          1
                                          ,
                                          5
                                       
                                    
                                    =
                                    
                                       
                                          5
                                          −
                                          2
                                       
                                       
                                          5
                                          −
                                          4
                                       
                                    
                                    12
                                    =
                                    36
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          3
                                          ,
                                          4
                                       
                                    
                                    =
                                    
                                       
                                          2
                                          −
                                          3
                                       
                                       
                                          4
                                          −
                                          3
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          3
                                          ,
                                          4
                                          ,
                                          1
                                       
                                    
                                    =
                                    −
                                    6
                                    ,
                                    
                                    
                                       
                                          c
                                       
                                       
                                          4
                                          ,
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          1
                                          −
                                          2
                                       
                                       
                                          1
                                          −
                                          4
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          3
                                          ,
                                          4
                                          ,
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          2
                                          −
                                          4
                                       
                                       
                                          1
                                          −
                                          4
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          4
                                          ,
                                          1
                                          ,
                                          5
                                       
                                    
                                    =
                                    2
                                    +
                                    24
                                    =
                                    26
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          1
                                          ,
                                          5
                                       
                                    
                                    =
                                    
                                       
                                          5
                                          −
                                          2
                                       
                                       
                                          5
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          4
                                          ,
                                          1
                                          ,
                                          5
                                       
                                    
                                    =
                                    27
                                    .
                                 
                              
                            Since x lies outside the interval 
                              [
                              3
                              ,
                              4
                              ]
                           , inside the decreasing interval 
                              [
                              4
                              ,
                              1
                              ]
                            and inside the increasing interval 
                              [
                              1
                              ,
                              5
                              ]
                           , the value of 
                              f
                              (
                              2
                              )
                              =
                              27
                              −
                              26
                              =
                              1
                           . Alternatively, by Lemma 2.1, 
                              12
                              U
                              (
                              x
                              =
                              2
                              |
                              3
                              ,
                              4
                              ,
                              1
                              ,
                              5
                              )
                              =
                              
                                 
                                    5
                                    −
                                    3
                                 
                                 
                                    5
                                    −
                                    1
                                 
                              
                              12
                              B
                              (
                              2
                              |
                              1
                              ,
                              3
                              ,
                              4
                              ,
                              5
                              )
                              =
                              6
                              /
                              6
                              =
                              1
                           .

The next example shows that, as assumed throughout, we need to remove all (coefficients of) U-splines with equal first and last knot at the outset, before evaluation via recursion (21).


                     
                        Example 4.2
                        Removal of zero-valued U-splines is necessary


                        First, we apply the recurrence (21), which only looks at subsequences, to the spline 
                              f
                              :
                              =
                              U
                              (
                              ⋅
                              |
                              0
                              ,
                              2
                              ,
                              2
                              ,
                              2
                              ,
                              0
                              )
                            with 
                              
                                 
                                    c
                                 
                                 
                                    0
                                    ,
                                    2
                                    ,
                                    2
                                    ,
                                    2
                                    ,
                                    0
                                 
                              
                              =
                              1
                            and all other coefficients zero. Evaluating f by recurrence at 
                              x
                              =
                              1
                            yields
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          0
                                          ,
                                          2
                                          ,
                                          2
                                          ,
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          1
                                          −
                                          0
                                       
                                       
                                          2
                                          −
                                          0
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          c
                                       
                                       
                                          2
                                          ,
                                          2
                                          ,
                                          2
                                          ,
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          0
                                          −
                                          1
                                       
                                       
                                          0
                                          −
                                          2
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          0
                                          ,
                                          2
                                          ,
                                          2
                                       
                                    
                                    =
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          1
                                          −
                                          0
                                       
                                       
                                          2
                                          −
                                          0
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          c
                                       
                                       
                                          2
                                          ,
                                          2
                                          ,
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          0
                                          −
                                          1
                                       
                                       
                                          0
                                          −
                                          2
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          0
                                          ,
                                          2
                                       
                                    
                                    =
                                    
                                       1
                                       4
                                    
                                    ,
                                    
                                    
                                       
                                          c
                                       
                                       
                                          2
                                          ,
                                          0
                                       
                                    
                                    =
                                    −
                                    
                                       1
                                       2
                                    
                                    .
                                 
                              
                            The summation of coefficients associated to intervals covering 
                              x
                              =
                              1
                            yields 
                              
                                 3
                                 4
                              
                           . However the correct value according to (6) is 
                              f
                              (
                              1
                              )
                              =
                              U
                              (
                              x
                              |
                              0
                              ,
                              2
                              ,
                              2
                              ,
                              2
                              ,
                              0
                              )
                              =
                              0
                           .

Each level of the recurrence corresponds to knot insertion. Let 
                        
                           t
                           ˇ
                        
                      be the knot sequence after inserting an extra knot into the sequence t. The relation (de Boor, 2001, XI(21)), between functionals 
                        
                           
                              λ
                           
                           
                              i
                              :
                              i
                              +
                              d
                              +
                              1
                           
                        
                      before and after knot insertion, does not depend on ordering and implies for 
                        
                           
                              ∑
                           
                           
                              j
                           
                        
                        
                           
                              c
                           
                           
                              j
                              :
                              j
                              +
                              d
                              +
                              1
                           
                        
                        U
                        (
                        ⋅
                        |
                        
                           
                              t
                           
                           
                              j
                              :
                              j
                              +
                              d
                              +
                              1
                           
                        
                        )
                        =
                        
                           
                              ∑
                           
                           
                              j
                           
                        
                        
                           
                              
                                 c
                                 ˇ
                              
                           
                           
                              j
                              :
                              j
                              +
                              d
                              +
                              1
                           
                        
                        U
                        (
                        ⋅
                        |
                        
                           
                              
                                 t
                                 ˇ
                              
                           
                           
                              j
                              :
                              j
                              +
                              d
                              +
                              1
                           
                        
                        )
                      that (de Boor, 2001, XI(23))
                        
                           (22)
                           
                              
                                 
                                    
                                       
                                          c
                                          ˇ
                                       
                                    
                                    
                                       j
                                       :
                                       j
                                       +
                                       d
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    (
                                    1
                                    −
                                    
                                       
                                          
                                             ω
                                             ˇ
                                          
                                       
                                       
                                          j
                                          d
                                       
                                    
                                    (
                                    x
                                    )
                                    )
                                 
                                 
                                    
                                       c
                                    
                                    
                                       j
                                       −
                                       1
                                       :
                                       j
                                       +
                                       d
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ω
                                          ˇ
                                       
                                    
                                    
                                       j
                                       d
                                    
                                 
                                 (
                                 x
                                 )
                                 
                                    
                                       c
                                    
                                    
                                       j
                                       :
                                       j
                                       +
                                       d
                                       +
                                       1
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       
                                          ω
                                          ˇ
                                       
                                    
                                    
                                       j
                                       d
                                    
                                 
                                 (
                                 x
                                 )
                                 :
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                             for 
                                             x
                                             ⩽
                                             
                                                
                                                   t
                                                
                                                
                                                   j
                                                
                                             
                                             ;
                                          
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                   −
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                          
                                             for 
                                             
                                                
                                                   t
                                                
                                                
                                                   j
                                                
                                             
                                             <
                                             x
                                             <
                                             
                                                
                                                   t
                                                
                                                
                                                   d
                                                
                                             
                                             ;
                                          
                                       
                                       
                                          
                                             1
                                             ,
                                          
                                          
                                             for 
                                             
                                                
                                                   t
                                                
                                                
                                                   j
                                                   +
                                                   d
                                                
                                             
                                             ⩽
                                             x
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                      But since the weights of knot insertion are not restricted to 
                        [
                        0
                        .
                        .
                        1
                        ]
                      as they are in the sorted case, the standard observation (de Boor, 2001, XI(28)) concerning variation diminution does not hold for U-splines. For example, the spline 
                        f
                        (
                        x
                        )
                        :
                        =
                        2
                        U
                        (
                        x
                        |
                        1
                        ,
                        2
                        ,
                        0
                        )
                        +
                        3
                        U
                        (
                        x
                        |
                        2
                        ,
                        0
                        ,
                        3
                        )
                        =
                        −
                        B
                        (
                        x
                        |
                        0
                        ,
                        1
                        ,
                        2
                        )
                        +
                        B
                        (
                        x
                        |
                        0
                        ,
                        2
                        ,
                        3
                        )
                      evaluates to 
                        (
                        f
                        (
                        0
                        )
                        ,
                        f
                        (
                        1
                        )
                        ,
                        f
                        (
                        2
                        )
                        ,
                        f
                        (
                        3
                        )
                        )
                        =
                        (
                        0
                        ,
                        −
                        1
                        /
                        2
                        ,
                        1
                        ,
                        0
                        )
                     , i.e. changes sign, even though the coefficient sequence 
                        (
                        2
                        ,
                        3
                        )
                      does not. Interestingly, Property xii, called variation diminution in de Boor (2001, XI(29)), holds for the example: 
                        f
                        (
                        1
                        )
                        f
                        (
                        2
                        )
                        <
                        0
                     , 
                        2
                        U
                        (
                        1
                        |
                        1
                        ,
                        2
                        ,
                        0
                        )
                        f
                        (
                        1
                        )
                        =
                        1
                        /
                        2
                        >
                        0
                      and 
                        3
                        U
                        (
                        2
                        |
                        2
                        ,
                        0
                        ,
                        3
                        )
                        f
                        (
                        2
                        )
                        =
                        1
                        >
                        0
                     .

At the outset, we stipulated that sequences have to be collocated. This was necessary to avoid division by zero in the relations of definition (2), Lemma 2.2 and (21). But divided differences need not be defined by recursion (1). What if we dropped the assumption that the sequence be collocated? The example below shows that this requires at the very least some rethinking of key algorithms such as de Boorʼs recurrence.


                     
                        Example 5.1
                        Convex recurrence requires collocated knots


                        We consider the spline f of degree 
                              d
                              =
                              4
                            that is a multiple of a U-spline with knots 
                              (
                              0
                              ,
                              0
                              ,
                              2
                              ,
                              2
                              ,
                              0
                              ,
                              2
                              )
                           . The knots are not 4-collocated. Let 
                              
                                 
                                    c
                                 
                                 
                                    0
                                    ,
                                    0
                                    ,
                                    2
                                    ,
                                    2
                                    ,
                                    0
                                    ,
                                    2
                                 
                              
                              =
                              8
                            and all other coefficients be zero. For the recursion, whenever the denominators in (21) are zero because the first and last knot agree, we choose an affine combination with as of yet undetermined weights 
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              ∈
                              R
                            and 
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              :
                              =
                              1
                              −
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                            in lieu of 
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          j
                                       
                                    
                                    −
                                    x
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    x
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           . Evaluation at 
                              x
                              =
                              1
                            yields the following recurrence:
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          0
                                          ,
                                          0
                                          ,
                                          2
                                          ,
                                          2
                                          ,
                                          0
                                       
                                    
                                    =
                                    8
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          c
                                       
                                       
                                          0
                                          ,
                                          2
                                          ,
                                          2
                                          ,
                                          0
                                          ,
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          2
                                          −
                                          1
                                       
                                       
                                          2
                                          −
                                          0
                                       
                                    
                                    8
                                    =
                                    4
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          0
                                          ,
                                          0
                                          ,
                                          2
                                          ,
                                          2
                                       
                                    
                                    =
                                    8
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          1
                                          −
                                          0
                                       
                                       
                                          2
                                          −
                                          0
                                       
                                    
                                    =
                                    4
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          c
                                       
                                       
                                          0
                                          ,
                                          2
                                          ,
                                          2
                                          ,
                                          0
                                       
                                    
                                    =
                                    8
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    4
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          c
                                       
                                       
                                          2
                                          ,
                                          2
                                          ,
                                          0
                                          ,
                                          2
                                       
                                    
                                    =
                                    4
                                    
                                       
                                          k
                                       
                                       
                                          3
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          0
                                          ,
                                          0
                                          ,
                                          2
                                       
                                    
                                    =
                                    4
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          1
                                          −
                                          0
                                       
                                       
                                          2
                                          −
                                          0
                                       
                                    
                                    =
                                    2
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          0
                                          ,
                                          2
                                          ,
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          2
                                          −
                                          1
                                       
                                       
                                          2
                                          −
                                          0
                                       
                                    
                                    
                                       (
                                       4
                                       
                                          
                                             k
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       8
                                       
                                          
                                             k
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             k
                                          
                                          
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          1
                                          −
                                          0
                                       
                                       
                                          2
                                          −
                                          0
                                       
                                    
                                    4
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    2
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    4
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          2
                                          ,
                                          2
                                          ,
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          0
                                          −
                                          1
                                       
                                       
                                          0
                                          −
                                          2
                                       
                                    
                                    
                                       (
                                       8
                                       
                                          
                                             k
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             k
                                          
                                          
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       4
                                       
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          1
                                          −
                                          2
                                       
                                       
                                          0
                                          −
                                          2
                                       
                                    
                                    4
                                    
                                       
                                          k
                                       
                                       
                                          3
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    4
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          k
                                       
                                       
                                          3
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          c
                                       
                                       
                                          2
                                          ,
                                          0
                                          ,
                                          2
                                       
                                    
                                    =
                                    4
                                    
                                       
                                          k
                                       
                                       
                                          3
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          4
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          0
                                          ,
                                          2
                                       
                                    
                                    =
                                    2
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          2
                                          −
                                          1
                                       
                                       
                                          2
                                          −
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          1
                                          −
                                          0
                                       
                                       
                                          2
                                          −
                                          0
                                       
                                    
                                    
                                       (
                                       2
                                       
                                          
                                             k
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       4
                                       
                                          
                                             k
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             k
                                          
                                          
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          2
                                          −
                                          1
                                       
                                       
                                          2
                                          −
                                          0
                                       
                                    
                                    4
                                    
                                       
                                          k
                                       
                                       
                                          3
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          4
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          k
                                       
                                       
                                          3
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          4
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          2
                                          ,
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          0
                                          −
                                          1
                                       
                                       
                                          0
                                          −
                                          2
                                       
                                    
                                    
                                       (
                                       4
                                       
                                          
                                             k
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             k
                                          
                                          
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             k
                                          
                                          
                                             3
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          1
                                          −
                                          2
                                       
                                       
                                          0
                                          −
                                          2
                                       
                                    
                                    4
                                    
                                       
                                          k
                                       
                                       
                                          3
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          4
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    2
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          k
                                       
                                       
                                          3
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          k
                                       
                                       
                                          3
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          4
                                       
                                       
                                          ′
                                       
                                    
                                    .
                                 
                              
                            For convex weights 
                              0
                              ⩽
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              ⩽
                              1
                           , the recurrence yields the value 
                              
                                 
                                    c
                                 
                                 
                                    0
                                    ,
                                    2
                                 
                              
                              −
                              
                                 
                                    c
                                 
                                 
                                    2
                                    ,
                                    0
                                 
                              
                              =
                              2
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              −
                              
                                 
                                    k
                                 
                                 
                                    3
                                 
                                 
                                    ′
                                 
                              
                              <
                              3
                           . But, by Lemma 2.1,
                              
                                 
                                    f
                                    (
                                    1
                                    )
                                    =
                                    8
                                    U
                                    (
                                    x
                                    =
                                    1
                                    |
                                    0
                                    ,
                                    0
                                    ,
                                    2
                                    ,
                                    2
                                    ,
                                    0
                                    ,
                                    2
                                    )
                                    =
                                    8
                                    U
                                    (
                                    1
                                    |
                                    0
                                    ,
                                    0
                                    ,
                                    0
                                    ,
                                    2
                                    ,
                                    2
                                    ,
                                    2
                                    )
                                    =
                                    3
                                    .
                                 
                              
                            That is, the recurrence cannot yield 
                              f
                              (
                              1
                              )
                            if all averages are convex.

A new notion, collocated knots, proved to be both necessary and sufficient to define splines for unsorted knot sequences. We saw, by a concrete example, that, if the knots are not collocated, no two-term recurrence with convex weights for stable evaluation is readily available. This points to collocated knot sequences as a maximal practical generalization of non-decreasing knot sequences.

U-splines were constructed both via divided difference tables and via recurrence. Given a collocated knot sequence, the paper proved that any individual U-spline can be represented as a multiple of a B-spline. Establishing properties of the space spanned by linear combinations of U-splines forced a fresh and detailed look at the notions by which Carl de Boor put B-splines on their solid foundation. For example, the deceptively simple definition of the basic interval for linear combinations of B-splines has to explicitly state the basic intervalʼs role of providing a spanning set.

From the outset, U-splines lacked positivity and local linear independence. It is therefore remarkable that linear combinations of U-splines retain so many useful properties familiar from B-splines and non-decreasing knot sequences.

@&#ACKNOWLEDGEMENT@&#

This work was supported in part by NSF grant CCF-1117695.

@&#REFERENCES@&#

