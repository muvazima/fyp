@&#MAIN-TITLE@&#Summarising the retinal vascular calibres in healthy, diabetic and diabetic retinopathy eyes

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           A novel and improved method for quantifying the retinal vessel calibres was presented.


                        
                        
                           
                           Junction exponents were experimentally derived for different groups, based on the fractal dimension and the branch exponent.


                        
                        
                           
                           New formulas were introduced for summarising the vessel calibres in healthy, diabetic and diabetic retinopathy eyes.


                        
                        
                           
                           The improvement in terms of the mean absolute percentage error ranged from 0.24% to 0.49%.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Gamma ratio

Diabetic retinopathy

Vessel calibres

Junction exponent

Arteriovenous ratio

@&#ABSTRACT@&#


               
               
                  Retinal vessel calibre has been found to be an important biomarker of several retinal diseases, including diabetic retinopathy (DR). Quantifying the retinal vessel calibres is an important step for estimating the central retinal artery and vein equivalents. In this study, an alternative method to the already established branching coefficient (BC) is proposed for summarising the vessel calibres in retinal junctions. This new method combines the mean diameter ratio with an alternative to Murray׳s cube law exponent, derived by the fractal dimension,experimentally, and the branch exponent of cerebral vessels, as has been suggested in previous studies with blood flow modelling. For the above calculations, retinal images from healthy, diabetic and DR subjects were used. In addition, the above method was compared with the BC and was also applied to the evaluation of arteriovenous ratio as a biomarker of progression from diabetes to DR in four consecutive years, i.e. three/two/one years before the onset of DR and the first year of DR. Moreover, the retinal arteries and veins around the optic nerve head were also evaluated. The new approach quantifies the vessels more accurately. The decrease in terms of the mean absolute percentage error was between 0.24% and 0.49%, extending at the same time the quantification beyond healthy subjects.
               
            

@&#INTRODUCTION@&#

@&#BACKGROUND@&#

The human retina is an important and non-invasive window for monitoring the blood vessels, being a part of the brain vascular system [1]. In numerous studies in the literature, alterations of the retinal vessels have been associated with diseases like diabetic retinopathy(DR) [2], hypertension [3] and glaucoma [4]. In diabetes and DR especially, changes have been identified both in the blood flow and the vessel wall structure, leading to geometric alterations, which can be measured in fundus images [5–8]. According to the World Health Organisation, the global prevalence of diabetes is estimated to be 9% among adults aged 18+ years. DR, during the advanced stages, has already caused serious damages and can lead to blindness. Early detection of these alterations, before the onset of DR, could possibly assist the clinicians in deciding a better series of treatment interventions.

DR occurs when hyperglycaemia-induced (elevated blood sugar levels) oxidative stress begins to damage the cells at the back of the eye [9]. DR may progress through four stages [10,11]:
                           
                              1.
                              
                                 Background retinopathy, where small balloon-like swellings appear in the retina׳s blood vessels called microaneurysms.


                                 Moderate non-proliferative retinopathy, where swelling and distortion of the vessels might occur, as well as possibly losing their ability to transport blood.


                                 Severe non-proliferative retinopathy, where even more blood vessels get blocked, depriving the blood supply to various areas of the retina. These areas can stimulate the production of growth factors that signal the retina to start growing new blood vessels.


                                 Proliferative retinopathy: At this stage, the proliferation of new blood vessels occurs, which grow along the inner surface of the retina and the vitreous gel. These vessels are fragile, which makes them more likely to leak and start bleeding. It is also possible that the scar tissue will contract and cause the retina to be detached from the underlying tissue.

The retinal vascular geometry offers a unique opportunity to study a number of different diseases. However, to do so, reliable and robust methods are needed in order to extract all of the relevant information for running the statistical analysis. Measuring accurately and summarising the vessel trunks in the most efficient way, even though the improvement might be subtle, can contribute towards defining the biomarkers of the progression for a disease. Additionally, taking into account that during the proliferation of retinal diseases, as defined by the anatomical structure of the retinal vessels, any alteration is very fine, and any possible improvement, no matter how negligible it might be, is undoubtedly important.

The main purpose of this study is to provide an alternative method of quantifying the retinal vessel calibres. Even the slightest improvement of this quantification can have a direct effect on studies of retinal pathologies, especially if we take into account that in different diseases, like diabetes and DR, the vascular changes are quite subtle (even less than 5%), especially during the consecutive years of the disease׳s progression [2]. In addition, these changes are difficult to quantify in digitised images, which thus may warrant and justify the innovation of methods to quantify those small changes in vessel calibers. The proposed method aims to improve and generalise the quantification for healthy, diabetic and DR eyes.

@&#RELATED WORK@&#

The central retinal artery (CRA) and vein (CRV) are the two main vessels of the retina. The CRV leaves the optic nerve head, draining the blood from the capillaries directly into either the superior ophthalmic vein or the cavernous sinus. Meanwhile, the CRA branches off the ophthalmic artery, passing under the optic nerve head within its dural sheath to the eyeball [15]. Initially Parr et al. [16,17] and then Hubbard et al. [18] completed some important work in the quantification of the retinal vessel calibres, which was then extended and improved by Knudtson et al. [19]. In their methods, the central retinal vein and artery equivalents (CRVE and CRAE) were proposed. In both cases, the calibre measurements around the optic nerve head were combined into one index, giving us the CRVE and CRAE. All of the measurements are collected around the optic nerve head, in an area of interest that lies within 0.5–1.0 optic disc diameters from the optic disc margin. To improve the estimation, Knudtson et al. revised the formulas used in the previous studies, in order to be independent of the units of measurement (e.g. pixels or microns) and without constant terms. The derived formulas for arteries and veins can be seen in Eqs. (1) and (2) respectively, which are based on branching coefficient values of 1.28 for arteries and 1.11 for veins. The ratio between the CRAE and CRVE is known as arteriovenous ratio (AVR).
                           
                              (1)
                              
                                 Arterioles
                                 :
                                 
                                 
                                    
                                       W
                                    
                                    
                                       ^
                                    
                                 
                                 =
                                 0.88
                                 ⁎
                                 
                                    
                                       (
                                       
                                          
                                             W
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             W
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 Veins
                                 :
                                 
                                 
                                    
                                       W
                                    
                                    
                                       ^
                                    
                                 
                                 =
                                 0.95
                                 ⁎
                                 
                                    
                                       (
                                       
                                          
                                             W
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             W
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        where 
                           
                              
                                 w
                              
                              
                                 ^
                              
                           
                         is the estimate of the parent trunk arteriole or venule and w
                        1, w
                        2 are the two branches (children).

It is worth mentioning that the data used to derive these formulas included only normotensive subjects. However, as has been shown in previous studies [2,20], applying these formulas to diabetic and DR subjects give us different estimates of the BC. This could lead to errors in measurements, in the event that they were about to be used in summarising the vessel calibres in diabetic and/or DR patients.

Following a similar logic, Patton et al. attempted to improve the above formulas for calculating the BC, recruiting healthy subjects to measure the retinal vessels calibres [21]. Following that, they tested the performance on a different group of people that they also recruited. Their main method included the design of a least-squares linear regression model for the arteries only, since the main independent variable, the asymmetry index, was found to only be related to the arteries and not the veins. Their developed model can be seen in Eq. (3).
                           
                              (3)
                              
                                 BC
                                 _
                                 arteries
                                 _
                                 model
                                 =
                                 0.78
                                 +
                                 0.63
                                 ⁎
                                 Asymmetry
                                 
                                 index
                              
                           
                        
                     

@&#PROPOSED METHOD@&#

The relationship between parent and daughter vessels at vascular junctions has been expressed by using the junction exponent(x) [22]. It has been shown that deviations from the optimal value, as predicted by Murray׳s cubic law (x=3), can be an indication of a vascular disease. Witt et al. [23] proposed an alternative parameter, which they called the optimality ratio, that is simpler to calculate and more robust in the presence of noise than Murray׳s junction exponent [22].

In addition, in another study [24], they assessed the arteriovenous distribution of haemodynamic parameters throughout a microvascular network inside the human retina. They suggested an alternative value for the exponent, based on the fractal dimension and a branch exponent, with the latter derived from data on cerebral vessels, mainly because they share similar structural and functional characteristics as the retina [25]. The reasoning behind this is that Murray׳s theoretical value of 3, actually ranges between 2.7 and 3.0 in various vascular beds [26,27]. Fractal dimension has been vastly studied in the literature and is primarily used to quantify complex vascular networks like the retina [28]. The branch exponent, which is also consistent with a fractal recursive rule, can also define the relation between the length and radius of a branch segment as 
                           L
                           (
                           r
                           )
                           =
                           β
                           
                              
                                 r
                              
                              
                                 a
                              
                           
                        . In the study of Takahashi et al. they used a value of 1.7 for fractal dimension and 1.15 for the branch exponent [24].

In our proposed method, we combine the mean diameter ratio with a revised exponent, which has been derived from data of healthy, diabetic and DR subjects. Therefore, the final exponent, although it uses the standard branch exponent of 1.15, as suggested in [24], is combined with the fractal dimension, as we calculated for these three groups. The newly derived formulas were compared against the BC of Knudtson et al. and the linear regression model of Patton et al. for all the above cases, using the mean absolute percentage error (MAPE).

The following study is organised into four main sections. In Section 1, a thorough description of the methods and techniques is given, alongside the tools and the data that were used. In Section 2, more details will be given for the study of the evaluation of the AVR and the arteries and veins individually, as biomarkers of progression to DR. Section 3 will be devoted to presenting the results in two parts. The first part will present the comparisons between the three techniques for summarising the retinal vessel calibres. The second part will present the results and the statistical analysis for the study of progression to DR, in the four different groups, using a repeated measures nested design. In the last section, the implications and importance of this study will be addressed, followed by the conclusion.

All of the studies were performed according to the tenets of the Declaration of Helsinki. As mentioned previously, numerous studies have shown that the retinal vasculature changes during the progression of diabetes and DR [8,29–32]. Therefore, in order to improve the accuracy of the estimation of the trunk for both arteries and veins, different data for healthy, diabetics with no-DR and DR subjects were used. All of the individuals in the diabetic and DR groups had no history of hypertension or any other cardiovascular disease. Twenty five images (each of 3888× 2592pixels) were chosen from image database of healthy group in a previous, unpublished study, conducted at the School of Computer Science at the University of Lincoln, UK.The diabetic group included data from twenty five diabetic subjects taken annually, over a three-year period, before the onset of DR (3years pre-DR, 2years pre-DR and 1year pre-DR). The same exact junctions were used in all three cases, which were then averaged and used to derive the formulas, constituting one group (age range 35–60years, mean 
                           47.5
                           (
                           ±
                           7.48
                           )
                        ). The rationale behind this is that in order for the formulas to be useful in estimating the trunk in diabetic subjects, which can be at different stages of diabetes, more than one year is needed to have a more accurate representation of the junctions. Regarding the DR group, twenty five DR patients in the early stages of DR were included (first and/or second year that the first lesions appeared). The data of both these groups comes from a diabetic/DR screening database in the UK (each of 3216×2316 pixels) (age range 37–70, mean 
                           53.2
                           (
                           ±
                           9.63
                           )
                        ). The image resolution in the above groups does not affect the implementation of the method since it is resolution-invariant. Moreover, in all of the above cases, either the left or the right eye was used, chosen at random before the beginning of the study.

The junctions were labelled and measured using a semi-automated tool described in [33]. Using this tool, each junction is firstly labelled manually as being a vein or an artery and then in a second stage the calibre is determined by fitting a rectangle between the wall edges of each vessel. The entire process is conducted in a semi-automated manner, going through each junction. The rectangle is adjusted by the user until he is confident that the measurement is correct. In that way, if a junction cannot be accurately measured, then the user can discard and select another one, making sure that the included measurements are accurate. The process was repeated twice for every junction, taking the average of the two measurements, after calculating the intrarater reliability (95.6% (95% CI=94.3, 96.8) of agreement). The performance of the expert user of the tool has been validated against a fully automated tool as proposed in [34], with the average agreement being 96.1% (95% CI=95.1, 97.9).

The fractal dimension estimation was calculated using the well-established box-counting algorithm, based on Eq. (4) 
                        [35]. The estimation starts with an evenly spaced grid, followed by counting how many boxes are required to cover the set. The final dimension is calculated by observing how this number changes as the grid becomes finer, by applying the box-counting algorithm. Initially, the fundus images are segmented using a tram-line algorithm as proposed in [36] (Fig. 2
                        ). In the second stage, the box-counting method is applied in the binary segmented trees, getting the fractal dimension in [36]. All of the analyses and algorithms were implemented using Matworks Matlab 2015b software and the open source Rstudio [37].
                           
                              (4)
                              
                                 FD
                                 =
                                 
                                    
                                       
                                          lim
                                       
                                       
                                          r
                                          →
                                          0
                                       
                                    
                                 
                                 
                                    
                                       Log
                                       
                                       N
                                       (
                                       r
                                       )
                                    
                                    
                                       Log
                                       (
                                       1
                                       /
                                       r
                                       )
                                    
                                 
                                 ,
                              
                           
                        where 
                           N
                           (
                           r
                           )
                         is the number of boxes of side length r that have to be used to cover a given area in the Euclidean n-space, by using a sequential number of descending size boxes. This occurs in multiple orientations. The final dimension in the 2D space is between 1 and 2.

It is well known that the relationship between the parent and daughter vessels׳ diameters at a branch is described by the junction exponent(x) defined by Eq. (5).
                           
                              (5)
                              
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                    
                                       x
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                    
                                       x
                                    
                                 
                                 ,
                              
                           
                        where d
                        0 is the diameter of the parent vessel and d
                        1, d
                        2 are the daughter vessels’ diameters [22]. Murray׳s law predicts that this exponent is equal to 3 under conditions of optimum power loss in the bifurcation. A few studies have shown that healthy veins and arteries follow Murray׳s law with the exception of very large vessels [26,38].

Witt et al. suggested an alternative parameter to characterise the optimality of the relationship between the vessels׳ diameter at a bifurcation, which they called the optimality ratio, aiming to reduce the bias and variability in the presence of noise in the measurements of individual vascular diameters, from which the junction exponent calculation suffers. This optimality ratio is based on the non-dimensional variants ζ
                        1, ζ
                        2 of the daughter diameters at bifurcation (Eq. (6)).
                           
                              (6)
                              
                                 
                                    
                                       ζ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       ζ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        After a few transformations, the mean diameter ratio Γ is calculated by Eq. (7).
                           
                              (7)
                              
                                 Γ
                                 =
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ζ
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             ζ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        Finally, after some algebraic manipulations of the mean diameter ratio and the asymmetry factor, they define the optimality ratio for a bifurcation obeying Murray׳s cubic law as
                           
                              (8)
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       ratio
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      3
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             
                                                2
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                              
                           
                        More information for the above derivation of the formula is given in [23].

As mentioned previously, Murray׳s cubic law of x=3 has actually been found to range between 2.7 and 3.0 for various vessels. Following the mathematical proofs of Takahashi et al. [24], showing that this exponent can be approximated more accurately by combining the fractal dimension and a branch exponent, this was derived experimentally from patients’ data for healthy, diabetic and DR eyes.

All of the 125 images (25 for healthy, 75 for diabetic and 25 for DR eyes) were segmented and the binary trees were used to calculate the fractal dimension (Fig. 2). In the diabetic group, the fractal dimensions of the same retinas were averaged over the three year period, in order to get a more accurate representation of the multiple and versatile changes that occur during the progression of diabetes. The final 25 measurements for each of the three groups (healthy, diabetic and DR) were summarised using both the mean and median values. Therefore, all of the experiments were run using both the mean and median fractal dimension to derive the exponent.

The general form of the adjusted Γ ratio, using the experimentally measured fractal dimension, combined with the branch exponent of 1.15 is summarised in Eq. (9), 
                           
                              (9)
                              
                                 Adj
                                 .
                                 
                                    
                                       Γ
                                    
                                    
                                       ratio
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      m
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                2
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             1
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where m is taking 6 different values, for the three groups and for the mean and median fractal dimensions. By solving Eq. (9) with respect to the parent vessel d
                        0, we get the generalised Eq. (10), which, after adjusting for the different exponents, will be used in all of the following experiments and will be compared against the other two methods in the literature [19,21].
                           
                              (10)
                              
                                 trunkvessel
                                 _
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                                
                                                   m
                                                
                                             
                                             +
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                                
                                                   m
                                                
                                             
                                          
                                          
                                             2
                                             ⁎
                                             
                                                
                                                   adj
                                                   
                                                      
                                                         Γ
                                                      
                                                      
                                                         ratio
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                                
                                                   m
                                                
                                             
                                             +
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                                
                                                   m
                                                
                                             
                                          
                                          
                                             2
                                             ⁎
                                             
                                                
                                                   (
                                                   adj
                                                   
                                                      
                                                         Γ
                                                      
                                                      
                                                         ratio
                                                      
                                                   
                                                   )
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                              
                           
                        
                     

In Table 1
                           , the experimental results of the three groups can be found. Depending on the value of the exponent, the adjusted 
                              
                                 
                                    Γ
                                 
                                 
                                    ratio
                                 
                              
                            has been calculated based on Eq. (9). For each exponent, we derived the corresponding equation, in order to calculate the performance within the different groups, for both veins and arteries, using the mean and median FD. In total, we obtained 12 equations to be used and compared against the other two methods.
                              
                                 (11)
                                 
                                    Vein
                                    :
                                    Healthy
                                    _
                                    
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                    _
                                    mean
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2.8
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2.8
                                                   
                                                
                                             
                                             
                                                0.8894
                                             
                                          
                                       
                                       
                                          2.8
                                       
                                    
                                 
                              
                           
                           
                              
                                 (12)
                                 
                                    Vein
                                    :
                                    Healthy
                                    _
                                    
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                    _
                                    median
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2.78
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2.78
                                                   
                                                
                                             
                                             
                                                0.8936
                                             
                                          
                                       
                                       
                                          2.78
                                       
                                    
                                 
                              
                           
                           
                              
                                 (13)
                                 
                                    Vein
                                    :
                                    Diabetic
                                    _
                                    
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                    _
                                    mean
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2.76
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2.76
                                                   
                                                
                                             
                                             
                                                0.9377
                                             
                                          
                                       
                                       
                                          2.76
                                       
                                    
                                 
                              
                           
                           
                              
                                 (14)
                                 
                                    Vein
                                    :
                                    Diabetic
                                    _
                                    
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                    _
                                    median
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2.79
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2.79
                                                   
                                                
                                             
                                             
                                                0.9317
                                             
                                          
                                       
                                       
                                          2.79
                                       
                                    
                                 
                              
                           
                           
                              
                                 (15)
                                 
                                    Vein
                                    :
                                    DR
                                    _
                                    
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                    _
                                    mean
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2.74
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2.74
                                                   
                                                
                                             
                                             
                                                0.9314
                                             
                                          
                                       
                                       
                                          2.74
                                       
                                    
                                 
                              
                           
                           
                              
                                 (16)
                                 
                                    Vein
                                    :
                                    DR
                                    _
                                    
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                    _
                                    median
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2.77
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2.77
                                                   
                                                
                                             
                                             
                                                0.9253
                                             
                                          
                                       
                                       
                                          2.77
                                       
                                    
                                 
                              
                           
                           
                              
                                 (17)
                                 
                                    Arteries
                                    :
                                    Healthy
                                    _
                                    
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                    _
                                    mean
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2.8
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2.8
                                                   
                                                
                                             
                                             
                                                1.079
                                             
                                          
                                       
                                       
                                          2.8
                                       
                                    
                                 
                              
                           
                           
                              
                                 (18)
                                 
                                    Arteries
                                    :
                                    Healthy
                                    _
                                    
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                    _
                                    median
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2.78
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2.78
                                                   
                                                
                                             
                                             
                                                1.0826
                                             
                                          
                                       
                                       
                                          2.78
                                       
                                    
                                 
                              
                           
                           
                              
                                 (19)
                                 
                                    Arteries
                                    :
                                    Diabetic
                                    _
                                    
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                    _
                                    mean
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2.76
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2.76
                                                   
                                                
                                             
                                             
                                                1.118
                                             
                                          
                                       
                                       
                                          2.76
                                       
                                    
                                 
                              
                           
                           
                              
                                 (20)
                                 
                                    Arteries
                                    :
                                    Diabetic
                                    _
                                    
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                    _
                                    median
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2.79
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2.79
                                                   
                                                
                                             
                                             
                                                1.1129
                                             
                                          
                                       
                                       
                                          2.79
                                       
                                    
                                 
                              
                           
                           
                              
                                 (21)
                                 
                                    Arteries
                                    :
                                    DR
                                    _
                                    
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                    _
                                    mean
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2.74
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2.74
                                                   
                                                
                                             
                                             
                                                1.152
                                             
                                          
                                       
                                       
                                          2.74
                                       
                                    
                                 
                              
                           
                           
                              
                                 (22)
                                 
                                    Arteries
                                    :
                                    DR
                                    _
                                    
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                    _
                                    median
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2.77
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2.77
                                                   
                                                
                                             
                                             
                                                1.1465
                                             
                                          
                                       
                                       
                                          2.77
                                       
                                    
                                 
                              
                           
                        

Knudtson et al. suggested using a region around the optic nerve head in order to estimate the CRVE and CRAE and also calculate their quotient, the arteriovenous ratio (AVR). They also observed that the number of vessels used does not affect the final estimation. We adopted this methodology here to make the AVR estimation. Therefore the area used can be seen in Fig. 3
                        .

However, although the number of vessels might not significantly affect the final estimation, the branching order plays an important role. In an example that will be presented later on, the final estimation is affected when vessels of different branching order are combined. Nevertheless, just looking at the fundus images, someone cannot be certain about the branching order of the vessel that is measuring, since the vessels might have branched before they exit the bright optic nerve head area. Having said this, in many retinas, the excluded area, which is 0.0–0.5 optic disc diameters from the optic nerve head margin, hides the branching of some segments. Therefore zone B (Fig. 3) might include vessels of different branching order. The same problem however exists to the area inside the optic nerve head, where the branchings cannot be identified as well.

Taking into consideration the reasons above and despite the drawbacks of this methodology, and also since the branching order cannot be accurately defined, we have adopted the established zone B, where the vessels are larger and more accurately measured and their status is already attained.

Another issue is that in [19], the six vessels are summarised using an iterative process, where the largest vessel is paired with the smallest one and then the second largest with the second smallest and so on. However, experimentally testing that by summarising four different trunk vessels using six subsequent vessels (daughters) of the same tree showed that both this method and simply taking the vessels in an ascending order lead to mixed results (two versus two), when compared against the actual measured trunks (Table 3). Therefore, according to these four trunks estimations, there is no evidence that one method is consistently more accurate than the other.

In contrast to the method in [19], the method in [21] includes only the arteries, hence the comparison with this one will only be limited to the arteries. For the other method a full comparison will be made. In addition, despite the fact that in previous studies [2,20], updated branching coefficients for both diabetic and DR groups have been reported, the purpose of this study is not to revise the established methods rather to propose a new one. Therefore these methods are utilised exactly as they have been described in the literature and used by other researchers.

In order to compare the performance and accuracy of the estimations of the proposed method against the other two, we use the mean absolute percentage error (MAPE), which is defined as:
                              
                                 (23)
                                 
                                    MAPE
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    |
                                    ⁎
                                    100
                                    %
                                    ,
                                 
                              
                           where A
                           
                              i
                            is the actual measurement and P
                           
                              i
                            is the predicted one. The whole sample of junctions is initially partitioned in 10 equal parts, in order to run a 10-fold cross-validation. For instance, for the healthy group, each time the formulas are derived using 135 junctions and tested with the other 15; this process is repeated for all the combinations. This means that all of the above equations, as well as the reported errors, are the overall average of the iterations. In the above way we avoid the bias that arises from using the same data for training and test purposes.

In addition, in order to justify taking multiple junction measurements from the same image, we compared the within each image variation with the between images variation, using the intraclass correlation coefficient (ICC).

Finally, for the progression study, using the individually measured vessels, a mixed model design was used, analysed by a repeated measures analysis of variance (ANOVA), as described in [2], which accounts for the multiple measurements taken within the same fundus images. For the AVR, a simple repeated measures ANOVA was used. Normality, using the Shapiro–Wilk test, and sphericity, using the Mauchlys test, were run prior to the analysis, to make sure that the data can be analysed using this type of test. Effect sizes according to the partial η
                           2 were also reported for the CRVE, CRAE and AVR. Post-hoc comparisons, adjusted according to the Bonferroni correction, were also made for the significant results (CRVE, CRAE and AVR), in order to specify which group means actually differ. All of the analyses were fulfilled using a balanced design.

In Fig. 4
                            we can see two example images out of the four that were used, to estimate the trunk veins. In each of these cases, the trunk vein is estimated from the subsequent daughter veins of different orders. The number 1 is the trunk vein, and 2, 3, 4, 5, 6, 7 are the six veins that are used to estimate the trunk. The same four images were used to compare the ascending order iteration and the largest–smallest.

To study the progression from diabetes to DR, many different biomarkers have been evaluated in the literature, including widths, tortuosity, fractal dimension, and branching angles. However the purpose of this study is primarily to assess the proposed method of quantifying the vessel calibers and subsequently apply them in a diabetic/DR progression study, in order to figure out whether the results of the analysis change according to the utilised method. Supplementary to this, since the six veins and six arteries are measured to estimate the CRVE/CRAE and their quotient, the same ones are used for comparison over the four consecutive years of progression (last three years of diabetic eye and the first year of DR). A schematic representation of this can be seen in Fig. 5
                        . In both these studies, 200 fundus images from 50 diabetic patients who progressed to DR were used, extracting and measuring 2400 vessels in total (1200 veins and 1200 arteries).

@&#RESULTS@&#

Firstly, the intraclass correlation coefficient was 0.12 (95% CI=0.11–0.15) for the arteries and 0.14 for the veins (95% CI=0.12–0.17). In this way, we are confident that each fundus image has no more variation than the variation that we have between the images. Additionally, each method is correlated with the other, with the correlation coefficients ranging from 0.975 to 0.989.

@&#PROPOSED METHOD@&#

In Table 2
                         we can see the estimate errors for all the methods. The proposed method marginally improves the quantification of the vessel calibres for every group under consideration. In addition, in Table 3
                         we can see the results of the quantification of four different vein trunks from four different retinal eyes. In the absence of data of the actual measurements of the central retinal arteries and veins, this is the closest alternative to simulating a real case scenario and presenting the performance of the methods as well.

The first two cases refer to the trunk veins of two healthy eyes, whereas the third and fourth refer to the trunk veins of two diabetic eyes. The results of the estimation of the trunk veins for these cases can be seen in Table 3.
                           
                              1.
                              10.30, 6.7, 5.9, 7.9, 9.4, 8.9.

10.60, 6.9, 6.4, 7.6, 8.9, 8.2.

13.1, 9.1, 8.5, 10.2, 9.7, 5.8.

6.3, 10.8, 10.7, 13.1, 9, 5.

In order to illustrate the proposed improvement in an additional manner, we utilised a logistic regression classifier. The purpose of this work is not to build a classification system, rather to show an example of how this method of quantifying the retinal vessels could improve the performance of a system in conjunction with other features. To do so, we trained an elastic-net regularised logistic regression classifier in Rstudio, using the package glmnet, according to the method proposed in [39]. This algorithm linearly combines the L1 (least absolute shrinkage and selection operator) and L2 (ridge regression) penalties, using a cyclical coordinate descent, computed along a regularisation path, in order to improve prediction accuracy. The difference with the ordinary logistic regression has to do with the penalty parameter, which is applied to the coefficients. In LASSO [40], the penalty corresponds to a Laplace prior, which expects some coefficients to be zero or close to zero, in addition to a subset of non-zero coefficients. In the case of ridge regression [41], the coefficients of correlated parameters are shrunk towards each other, reducing the variance of the estimates. More information of the elastic-net can be found in the extensive work of Friedman et al. [39].

AVR, CRVE and CRAE were the three features used inside the binary classification system. Given the limited amount of data and the use of only three features, this system was trained and applied between two groups: the diabetic and the DR group. The Receiving Operating Characteristic (ROC) curve of the two methods under comparison, the proposed and the Knudtson et al. method, can be seen in Fig. 6
                        , which was produced after running a 10-fold cross validation process. After evaluating them inside the elastic-net logistic regression, all three features were found to contribute to the performance of the classifier.

The average Area under the ROC curve was 0.594 for the proposed method and 0.581 for the method of Knudtson et al. As initially indicated by the decrease of the MAPE of the proposed method, the above classification also indicates that getting more accurate quantification can in turn lead to a better performance of a multi-feature classification system.

Firstly, no violation of normality and sphericity was observed in either of the investigated cases (p-values ranging from 0.27 to 0.46 and from 0.18 to 0.26 respectively). In Table 4
                         we can see the results of the analysis for the AVR data, as well as for the CRVE and CRAE separately, using both the proposed method and the method in [19], since the method in [21] refers only to the arteries.

In this experiment, the semi-automated tool described in [33] was used to manually label the arteries and veins. The methodology of Knudtson et al. was followed, using the six largest veins and six largest arteries to estimate the CRVE and CRAE.

In Fig. 7
                         we can see the within subjects confidence intervals for both methods. Adjusting the p-values according to the Bonferroni correction, pairwise comparisons using the method in [19] gave significant results for both the CRVE and CRAE for the groups 3ypreDR/DR, 2ypreDR/DR and 1ypreDR/DR, but not for any other combination (p-values ranged from 0.0001 to 0.007 for CRVE and 0.0006 to 0.008 for CRAE). No significant result was observed for the AVR whatsoever. Similarly, using the proposed method, significant results were found from the same combinations as above, apart from the group 2ypreDR/DR of the CRAE (p-values ranged from 0.0009 to 0.005 and 0.003 to 0.008 for CRVE and CRAE respectively). Likewise, no significant results were observed for any combination of the AVR.

Similarly, no violation of either normality or sphericity was observed for the individual abalysis of vessels׳ calibers (p-values=0.28 and 0.35 for veins and arteries for normality, respectively and p-values=0.32 and 0.37 for veins and arteries for sphericity, respectively). Table 4 presents the analysis of the progression study in detail. As we can see, the differences are significant for both veins and arteries, which is in agreement with studies in the literature that investigated the vessel calibres in the whole retina. It is worth pointing out that due to the diverse nature and uniqueness of each person׳s retina, studying the progression in a repeated measures way, at the exact same segments over a period of a few years, yields more accurate results, increasing the power of the study at the same time [42].

Finally, significant results were also observed for all of the combinations of artery and vein calibres, apart from the group 3ypreDR/2ypreDR, when analysed in a two-group design (p-values ranged from 0.0003 to 0.002 and 0.0009 to 0.006 for veins and arteries accordingly).

@&#DISCUSSION@&#

As has been shown in previous studies [43,44,2], both geometric and haemodynamic features can be studied for different diseases inside the human retina. However, due to factors such as the different modalities used, the low image quality of real-world data and the difficulty of implementing tools that will account for all these properties consistently and accurately, the study of diseases is a difficult process, leading to ambiguous and contradicting results. Therefore, our present study focused on trying to bridge this gap and introduce some new and more general formulas for the vessel quantification for healthy, diabetic and DR subjects.

A crucial point when calculating the CRVE and CRAE around the optic nerve head is that the exact branching order remains uncertain, and it is also unclear whether the vessels have branched before they come out of the optic nerve head or not. As we showed in Fig. 4, we simulated this scenario by quantifying the vessel trunk in uneven branching order daughter vessels. Even in this case, the quantification proved to be more accurate (case 3 in Table 3), which covers this important possible situation. The more accurate the quantification is, the more robust and meaningful the statistical inferences will be as well. In this work, we offered an alternative-a more generalised and improved method for quantifying the retinal vessel calibres, adding up to the previous works found in [17–19,21]. As a logical future step, we will investigate further scenarios and include an even larger sample, in order to possibly identify other areas that could be improved as well.

@&#CONCLUSION@&#

A new approach for summarising the retinal vessel trunk has been proposed. The improvement in terms of the mean absolute percentage error, ranged from 0.24% to 0.49%, whereas the improvement in the classification capability of the proposed method against the Knudtson et al. between the diabetic and the DR group was 0.013 of the AUC. Using the new derived formulas one can estimate and summarise more accurately the retinal vessel trunks and use them in studies of retinal diseases. In addition, if we take into account that during the iteration process, six vessel calibres are summarised before the final vessel trunk value is estimated, then the actual improvement is more extensive than what the mean absolute percentage error suggests, since the errors are accumulated during the process (Table 3).

The progression study that was also presented shows a difference between the methods, both in the results of the estimation of the CRVE,CRAE and AVR and in the statistical analyses. Therefore it is apparent that the improved estimations lead to even more accurate analysis of the data.

None declared.

@&#ACKNOWLEDGEMENTS@&#

This research study was supported by a Marie Sklodowska-Curie grant from the European Commission in the framework of the REVAMMAD ITN (Initial Training Research network), Project number 316990.

@&#REFERENCES@&#

