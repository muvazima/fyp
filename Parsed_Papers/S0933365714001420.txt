@&#MAIN-TITLE@&#A short-term operating room surgery scheduling problem integrating multiple nurses roster constraints

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We focus on short-term surgery scheduling problem considering complete surgery flow and the multiple resources involved.


                        
                        
                           
                           We integrate the surgery scheduling problem with four real-life nurse roster constraints.


                        
                        
                           
                           We propose a modified ACO algorithm with a two-level ant graph model and specific ACO mechanism.


                        
                        
                           
                           Our ACO is compared with test cases from both literature and real hospital.


                        
                        
                           
                           The proposed ACO outperforms in end time, operating rooms’ and nurses’ cost-related time, and balanced resource utilization.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Ant colony optimization

Operating room management

Surgery scheduling

Nurse roster

@&#ABSTRACT@&#


               
               
                  Objectives
                  Operating room (OR) surgery scheduling determines the individual surgery's operation start time and assigns the required resources to each surgery over a schedule period, considering several constraints related to a complete surgery flow and the multiple resources involved. This task plays a decisive role in providing timely treatments for the patients while balancing hospital resource utilization. The originality of the present study is to integrate the surgery scheduling problem with real-life nurse roster constraints such as their role, specialty, qualification and availability. This article proposes a mathematical model and an ant colony optimization (ACO) approach to efficiently solve such surgery scheduling problems.
               
               
                  Method
                  A modified ACO algorithm with a two-level ant graph model is developed to solve such combinatorial optimization problems because of its computational complexity. The outer ant graph represents surgeries, while the inner graph is a dynamic resource graph. Three types of pheromones, i.e. sequence-related, surgery-related, and resource-related pheromone, fitting for a two-level model are defined. The iteration-best and feasible update strategy and local pheromone update rules are adopted to emphasize the information related to the good solution in makespan, and the balanced utilization of resources as well. The performance of the proposed ACO algorithm is then evaluated using the test cases from (1) the published literature data with complete nurse roster constraints, and 2) the real data collected from a hospital in China.
               
               
                  Results
                  The scheduling results using the proposed ACO approach are compared with the test case from both the literature and the real life hospital scheduling. Comparison results with the literature shows that the proposed ACO approach has (1) an 1.5-h reduction in end time; (2) a reduction in variation of resources’ working time, i.e. 25% for ORs, 50% for nurses in shift 1 and 86% for nurses in shift 2; (3) an 0.25h reduction in individual maximum overtime (OT); and (4) an 42% reduction in the total OT of nurses. Comparison results with the real 10-workday hospital scheduling further show the advantage of the ACO in several measurements. Instead of assigning all surgeries by a surgeon to only one OR and the same nurses by traditional manual approach in hospital, ACO realizes a more balanced surgery arrangement by assigning the surgeries to different ORs and nurses. It eventually leads to shortening the end time within the confidential interval of [7.4%, 24.6%] with 95% confidence level.
               
               
                  Conclusion
                  The ACO approach proposed in this paper efficiently solves the surgery scheduling problem with daily nurse roster while providing a shortened end time and relatively balanced resource allocations. It also supports the advantage of integrating the surgery scheduling with the nurse scheduling and the efficiency of systematic optimization considering a complete three-stage surgery flow and resources involved.
               
            

@&#INTRODUCTION@&#

Surgeries are critical processes in hospital operation, not only because of their direct impact on patients’ health but also because of their high relevance to a hospital's total revenues and expenses. At the moment, hospitals around the world are facing a trend of increasing demand for surgeries due to the aging population [1], and the prevailing nurse shortage problem [2]. Hence, it has been a challenge for operating room (OR) management to deliver timely and high quality surgery services to patients with limited resources in recent years. In this context, it is essential to provide an efficient decision making strategy for OR management.

Much OR management focuses on the surgery scheduling and resource management. Surgery scheduling (also called OR scheduling) determines the time sequencing of an individual surgery in different surgical specialties and the resources assigned to it over a scheduling period. It is used to satisfy the patient's demand for timely treatments and to maximize the OR's resource utilization. On the other hand, resource management in OR needs to focus on the nurse roster as nursing services play an important role in hospital's operating budget [3,4]. For medical and operation research literature, both the surgery and nurse scheduling problems have been studied independently and are solved separately. There usually exists a sequence in OR decisions, i.e. firstly surgery sequencing decision and then nurse scheduling decision. We are thinking of why surgery scheduling and nurse scheduling have to be separately done. Why not try to integrate these two decisions together in short term OR management?

Current literature on a daily or weekly surgery scheduling problem can be classified into two categories. The first category can be called “surgery-based OR scheduling” in which a schedule is provided to assign resources for the intra-operative activities only (OR and surgeon scheduling) while ignoring all other resources. The second category can be called “comprehensive OR scheduling” where a schedule is designed considering all resources for all three stages, i.e. the pre-operative stage, the intra-operative stage and the post-operative stage. Most of the currently available comprehensive OR scheduling research, especially operations research type of articles, usually treats the resources as homogenous entities for simplification. However, in an actual OR management, there exists vast differences in individual nurse attributes such as skill set, qualification, shift preferences, contractual agreements, to name a few. Furthermore, surgeries also have constraints on the qualification and skills of nurses. Oversimplifying nurses by considering them as homogeneous entities may result in a surgery schedule that may not even be feasible in practice. Scheduling a surgery without considering the nurse roster constraints on that day may lead to an inability of securing qualified nurses to support pre-scheduled surgery cases. OR management then has to either arrange OT hours for the qualified nurses on-duty or call for part-time qualified nurses as temporary replacement, which will increase the OR operation cost and will create an inefficient management of operating rooms. Recently, OR management has been coping with a growing problem in the shortage of registered OR nurses, which continues to hamper the effective delivery of the scheduled surgery service. Hence, it is of vital importance that surgery scheduling should be carefully optimized by integrating both surgery scheduling and daily nurse roster constraints.

The research presented in this paper aims to solve a surgery scheduling problem for an operating suite with multiple operating rooms, taking into account of the real life nurse roster constraints such as skill/specialty, job qualification, level, shift, and contractual agreements. A mathematical model is proposed to describe such a complicated surgery scheduling problem, and an ACO approach is developed to solve it. As to our knowledge, there has been little, if any, research on the surgery scheduling problem that integrates real life nurse roster constraints.

The rest of the paper is organized as follows. In Section 2, a summary of the literature review on recent surgery scheduling problem is presented. In Section 3, the integrated scheduling problem is outlined and a formal problem statement is given. In Section 4, we introduce an ACO algorithm to solve the integrating surgery scheduling problem and present the detailed mechanisms. In Section 5, the proposed ACO approach is evaluated with the test cases using the literature data and the real-life hospital scheduling data. Section 6 summarizes the current study work and suggestions for future research.

@&#LITERATURE REVIEW@&#

Given the ever increasing demand in the healthcare industry, a great deal of efforts has been invested in improving OR management. This section reviews the state of art surgery scheduling (or OR scheduling) and nurse scheduling (or nurse rostering).

The surgery scheduling problem has been a widely studied topic and there exists a vast amount of literature in the medical and operation research communities. Reviews about OR planning and scheduling have been reported by several researchers recent years [5–8]. They provide detailed classifications of papers based on the types of problems, operations research methodology, and decision levels. We limit our literature review specifically on the short-term surgery scheduling problem (daily or weekly) as it is directly related to the scope of this paper.

According to the literature, earlier work on the surgery scheduling research was mostly concentrated on the activities and resources associated with the intra-operative stage only in the operating room [9–11]. The developed models are often applicable to small size problems with a limited number of constraints including surgery demand and OR capacity.

Surgery scheduling problems are then further extended to take into account multiple resources that are involved during the entire process of surgery flow: before, during, and after surgery. More realistic constraints on surgery flow and multiple resources were added to the models. Some researchers have treated the surgery scheduling problem as a “two-stage no wait hybrid flow-shop” problem with the operating rooms as the first stage and the recovery room as the second stage [12,13]. However, human resources, except surgeons, are always considered available in their works. Fei et al. [14] further improved the hybrid flow-shop model by taking into account the availability of recovery beds, and proposed a hybrid genetic algorithm (HGA) to solve such daily surgery scheduling problems. Augusto et al. [15] modeled surgery scheduling under the open scheduling strategy as a four-stage flow-shop scheduling problem, further involving the preoperative stage and the transporting stage, comparing it to the previous two-stage flow-shop model. However, all of the above research ignored the qualifications and skills of human resources. Pham and Klinkert [16] proposed a job-shop scheduling model and emphasized the resources (such as transporters, ORs and recovery beds) needed in the three stages (i.e. pre-operative, intra-operative and post-operative stage) in the operation process. The medical staff constraint in their model is described as resource modes, in which each mode consists of a surgical team with surgeon(s) and nurses. An individual surgery has its own required mode to make the solution closer to the actual surgical procedure. Our pilot research [17,18] represented the surgery scheduling problem as an extended multi-resource constrained flexible job-shop scheduling problem and proposed a modified ant colony algorithm to solve it. The multiple resources covered include all major resources involved in a complete surgery stages. However, the resources like ORs, nurses, anesthetists, and beds in different surgery stages are all considered as homogeneous. As it has been surfaced by reviewing these papers, the short-term surgery scheduling problem, in most research, has simplified the resources (especially workforce resources) required in surgery as homogeneous. Few surgery scheduling research takes into account the constraints on the nurse roster, such as specialty, skill level, qualification and shift, which are very common in actual OR management in the hospitals.

Given the ever increasing labor costs and the fact that the nursing staff accounts for a substantial portion of an OR's budget [19], another scheduling problem, called nurse scheduling (or nurse rostering), has especially been proposed for resource management in OR, mainly dealing with the nurse related constraints. The surgery demand (a set of resources for a surgery to be performed) information is estimated as an input to the nurse rostering problem. Excellent surveys on nurse rostering problems can be found in [20,21]. Most of the research is focused on finding the efficient mid-term staff schedules (i.e. nurses are assigned to shifts within a cycle or a week/month) with the objective of either minimizing the cost or maximizing the nurse preferences. Due to many uncertainties in the scheduling problem, some papers considered the staffing problem as a newsvendor problem [22–24]. He et al. [24] indicated that if staffing decision can be deferred until information on all schedule cases becomes available, then uncertainty is purely due to variability in case duration and add-on cases, and the optimal staffing cost will be expected to be lower. This is an interesting point for the significance of the decision timing for staffing arrangement. There has been a limited amount of research on the daily nurse re-scheduling problem which makes daily adjustments to account for changes in demand, absenteeism, and skill mismatches [25]. The primary goal is to improve nurse utilization and job satisfaction, which ignores the surgery planning and scheduling. The resulting nurse schedule only assigns the nurses to shifts, not to ORs or surgeries. Mobasher et al. proposed a multi-objective integer programming model for the daily scheduling of nurses in operating suites [26]. The goals are to minimize overtime and idle time, delays due to staff shortages, and assignment changes during the day, as well as to maximize the case demand satisfaction. The work focuses on scheduling the nursing staff by assuming that the daily surgery schedule is given as the input.

Because OR management consists of both surgery scheduling and resource allocation, these two components have mutual impacts on each other. Separately optimizing the individual component may not yield an optimal solution for OR management. As pointed out by Litvak and Long [27], one common problem at OR management is the extreme variation in daily workload which makes staffing the ORs difficult at best. This typically occurs in ORs in which there is a combination of excess capacity and adopting a block scheduling system whereby most surgeons or surgical specialties are given a reserved block of time. Surgeons are allowed to set their schedules without being responsible for smoothly or consistently using their operating times. In this situation, the priority of efficient use of the operating rooms becomes secondary to other demands on the surgeons’ time. Large gaps in the operating room schedule and overruns at the end of the day are common. And they also indicated that an important amount of the variability can electively be managed and reduced by appropriate decision taking. As demonstrated by He et al. [24], incorporating information on the exact number and type of cases for each specialty into staff scheduling can reduce total staffing costs by an average of 49% relative to those without using the case information. Dexter et al. [28] further applied descriptive analytics to show that such information are not available until at least 2 workdays before the day of surgery, and likely not until the evening ahead. It strongly suggests that staff decision making should be engaged in during the last few workdays. Therefore, it is valuable to model the short-term surgery scheduling with the short-term nurse rostering constraints as an integral part. This will help generate an efficient surgery schedule that can be delivered in practice with a minimum staffing cost. It is noticed that the research articles on the surgery scheduling problem considering nurses roster constraints are very scarce. Beliën and Demeulemeester [29] is the first and perhaps the only paper which developed an integrated nurse and surgery scheduling system for a weekly planning problem. Two scheduling problems were solved alternatively. The surgery scheduling uses integer programming to develop a master surgery schedule with the objective of meeting nurse preferences, while assuring that the demand requirements were satisfied in general, but not necessarily with respect to skill types. It was assumed that the adequate resources were available to cover all demands. The basic model was extended by enumerating all the possible ways of assigning operating blocks to the different surgeons subject to the surgery demand and the capacity restrictions. A branch-and-price algorithm was proposed to find the solutions. Most recently, Meskens et al. proposed the constraint programming paradigm to solve a complicated scheduling problem considering perhaps the most complete multiple resource constraints including ORs, surgeons, nurses, anesthetists, material, pre-operative holding units (PHU) and the post anesthesia care unit (PACU) beds. Multiple real-life resource constraints cover availability, staff preferences, and affinities among staff members [30]. Their work also indicates the importance and the efficiency of short-term surgery scheduling which integrates real-life resource constraints. However, as mentioned in their paper, a nurse's experience (i.e. skill or qualification) is the missing constraint in their model. The nurses are considered as the homogenous, same as the PHU or PACU beds. In fact, the nurse experience, skill level, qualification and role constraints are commonly arise in a real-life nurse roster. In order to better address the real life applications, we develop a mathematical model that integrates the surgery scheduling processes with respect to the involved resources. In particular, our model considers the real-life nurse roster constraints into the surgery scheduling.

The research aims to the management of an operating suite composed of a fixed number of multifunctional operating rooms to perform the surgeries over a limited time horizon. Surgery in a hospital can be classified as elective or emergent. This study only focuses on the elective. For most hospitals, the elective surgeries are usually known at least one or two days in advance. Therefore, we focus on short-term (mostly daily) surgery scheduling in this paper. In such deterministic context, the purpose is to schedule the different elective surgeries by determining their starting time and assigning them the available qualified resources while satisfying timely treatment requirement of patients. The surgery flow, resources involved, multiple nurse roster constraints and mathematical model will be introduced in this section.

A surgery case is defined as a series of operations performed by a medical team on a single patient, in a single OR, over the course of a day. Patients in hospitals are classified as inpatients or outpatients. Typically, outpatient cases are shorter and less complex than inpatient cases, while inpatient cases are longer and require more resources. The complete surgery procedure usually has three stages: the pre-operative stage, intra-operative stage and post-operative stage.
                           
                              1.
                              Pre-operative (setup) stage

The resources required in this stage include PHUs, and a nurse (usually remains in PHU for whole day in most hospitals) to do tasks related to preparing for the surgery cases including registration and document checking.

Intra-operative (surgery) stage

The resources required to perform a surgery include the personnel (surgeons, anesthetists, nurses, etc.) as well as the facilities (multiple ORs). The personnel required in this stage are case-dependent and usually are determined according to the specific surgery type. Legally, a surgical operation requires the presence of at least one surgeon, one anesthetist, and two nurses (one circulator and one scrub). For some complex surgical cases, two surgeons from different surgical specialties, two anesthetists, and three nurses may be needed.

Post-operative (recovery) stage

After surgery, most patients are then transferred to the PACU for recovery. Some patients may bypass PACU. For example, critical patients may require additional treatments in ICU, while some outpatients/inpatients have minor local anesthesia may be discharged/moved directly to the ward. Since the duration of a patient's staying in ICU is really hard to determine, we did not consider ICU in post-operative stage in this paper. The resources required in PACU include PACU beds and an anesthetist nurse (also fixed in PACU for whole day in most hospitals).


                        Fig. 1
                         illustrates these three stages as well as the required resources. The resources involved in the OR flow have the characteristics of simultaneity and diversity restriction. If any resource in this three-stage surgery flow is not available on time, the surgery process has to be postponed, and the efficiency of the OR will be affected. In general, most facility resources are multi-functional and can accommodate different types of cases. However, the personnel resources are always non-homogeneous with respect to their surgery specialty, skill set, experience, and general availability. In this paper, only surgeons and nurses including circulation nurses and scrub nurses are considered as the non-homogeneous resources, others are all considered as multi-functional and the homogeneous, i.e. all PHU/PACU beds, ORs, and anesthetists can deals with any kinds of patients.

To make the scheduling more practical in OR management, several constraints on human resources commonly found in the real life situation should be considered, especially on the nurses roster. In this paper, four types of nurse constraints are introduced as follows:
                           
                              1.
                              Role constraint

In a surgery case, nurses work as either a circulator or a scrub. Each surgery needs at least one circulator and one scrub nurse—both being essential. The circulator role must be served by a registered nurse because it requires coordinating all the needs of the surgical team for a surgery case. The scrub usually prepares and passes supplies and instruments to the surgeon during the surgery.

Specialty constraint

Surgeries involving different surgery specialties may have great differences in the actual surgery procedure, which requires nurses with proper specialties. Therefore, nurses are categorized by specialty (e.g. Head and Neck, OPTH, ORTHO, Plastic, Surgical Oncology, etc.).

Qualification constraint

Not all nurses are qualified for all surgical procedures, although they may be adequately trained in the specialty. Given the complexity of a surgery, assignments are made according to the skill level and work experience. In general, nurses with higher skill levels and experience can also work on the cases with less complex ones.

Availability constraint

Nurses usually work by shifts, which governs the available time frame of an individual nurse. Nurses can only work during their normal working hours. If no more qualified nurses within a specific shift are available for a scheduled surgery case, a qualified nurse on-duty may be asked to work OT. Furthermore, OT should not violate the shift restrictions and regulatory and union requirements.

Our modeling approach rests on a very widespread model in the shop scheduling problem, Job-shop Scheduling Problem (JSP) [31]. Similar to JSP, surgeries and facilities can be, respectively, regarded as work pieces and machines in JSP. Moreover, the facilities considered in the three stage surgery flow in this paper can be viewed as multifunctional. Hence, the surgical scheduling problem can be modeled as a flexible multiprocessor JSP [32]. However, the specific requirements in the healthcare setting contribute to the main differences between the two problems. Each surgery has its case information and resource demand. The case information specifies that a surgery can only be performed by a team of specialized personnel, and the surgery duration varies by the individual surgeon, even for the same type of surgery specialty. The resource demand specifies all resources required for the complete stages of a surgery. Whether a stage can start successfully depends not only on the variety of required resources, but also by the performance of the previous stage(s). Hence, the scheduling goal is to determine the optimal operating sequences of various surgeries by assigning appropriate resources to the different stages of each surgery case while obtaining the shortest makespan. The scheduling should take various types and amounts of available resources into account.

Several assumptions are made as follows:
                           
                              1.
                              No uncertainties are considered in both surgeries and nurses information, i.e. only elective surgeries with all information known in advanced are considered and there is no emergent surgery. No surgery cancel and no resources absence.

Open scheduling strategy [7] is adopted, i.e. surgical cases are assigned to an available OR, at the convenience of surgeons and ORs are not blocked to specialties.

The case information of a specific surgery type, such as specialty, complexity, required resources, etc., is given prior to the scheduling.

The operating time of a surgery performed by a specific surgeon is determined prior to the scheduling using the mean value of the historical surgery duration of the same surgery type by the surgeon.

The transfer time between two stages in the same surgery can be neglected, i.e. the start time of next surgery stage is exactly the end time of the predecessor surgery stage.

The nurse roster information, such as the nurse's skill set, qualification, specialty, and shifts, is provided prior to the scheduling.

In this research, it is assumed that there is a set of surgeries, represented as I, to be performed in an operating suite with parallel multi-functional operating rooms and other types of resources (including both personnel and facilities associated with surgery groups). The notations used for our model are listed in Table 1
                        .

We now describe the mathematical model. The objective function is to minimize the time required to complete all surgeries, also called makespan.
                           
                              (1)
                              
                                 
                                    F
                                    =
                                    min
                                    
                                       
                                          max
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                    E
                                    
                                       T
                                       
                                          i
                                          3
                                       
                                    
                                 
                              
                           
                        
                     

The following constraints are included in the model:
                           
                              (1)
                              The end time of stage j of surgery i is determined by the start time and the maximum duration of all assigned resources.
                                    
                                       (2)
                                       
                                          
                                             E
                                             
                                                T
                                                
                                                   i
                                                   j
                                                
                                             
                                             =
                                             S
                                             
                                                T
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                
                                                   max
                                                
                                                
                                                   c
                                                   ∈
                                                   
                                                      C
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   ,
                                                   m
                                                   ∈
                                                   
                                                      M
                                                      c
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      T
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         c
                                                         m
                                                      
                                                   
                                                   ×
                                                   
                                                      x
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         c
                                                         m
                                                      
                                                   
                                                
                                             
                                             ,
                                              
                                             i
                                             ∈
                                             I
                                             ,
                                              
                                             j
                                             =
                                             1,2,3
                                          
                                       
                                    
                                 
                              

For any two consecutive stages j and j
                                 +1 of a surgery i, j
                                 +1 starts immediately after stage j is completed.
                                    
                                       (3)
                                       
                                          
                                             E
                                             
                                                T
                                                
                                                   i
                                                   j
                                                
                                             
                                             =
                                             S
                                             
                                                T
                                                
                                                   i
                                                   (
                                                   j
                                                   +
                                                   1
                                                   )
                                                
                                             
                                             ,
                                              
                                             i
                                             ∈
                                             I
                                             ,
                                              
                                             j
                                             =
                                             1,2
                                          
                                       
                                    
                                 
                              

Any two stages of a surgery cannot be performed at the same time.
                                    
                                       (4)
                                       
                                          
                                             E
                                             
                                                T
                                                
                                                   i
                                                   
                                                      j
                                                      ′
                                                   
                                                
                                             
                                             −
                                             E
                                             
                                                T
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≥
                                             
                                                T
                                                
                                                   i
                                                   
                                                      j
                                                      ′
                                                   
                                                
                                                
                                                   c
                                                   m
                                                
                                             
                                             ,
                                              
                                             j
                                             ,
                                             
                                                j
                                                ′
                                             
                                             ∈
                                             
                                                J
                                                i
                                             
                                             ,
                                              
                                             j
                                             <
                                             
                                                j
                                                ′
                                             
                                             ,
                                              
                                             i
                                             ∈
                                             I
                                             ,
                                              
                                             c
                                             ∈
                                             C
                                             ,
                                              
                                             m
                                             ∈
                                             
                                                M
                                                c
                                             
                                          
                                       
                                    
                                 
                              

A resource can only be assigned to one surgery stage at a time.
                                    
                                       (5)
                                       
                                          
                                             E
                                             
                                                T
                                                
                                                   
                                                      i
                                                      ′
                                                   
                                                   
                                                      j
                                                      ′
                                                   
                                                
                                             
                                             −
                                             E
                                             
                                                T
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             H
                                             
                                                
                                                   1
                                                   −
                                                   
                                                      Z
                                                      
                                                         i
                                                         j
                                                         ,
                                                         
                                                            i
                                                            ′
                                                         
                                                         
                                                            j
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                             ≥
                                             
                                                T
                                                
                                                   
                                                      i
                                                      ′
                                                   
                                                   
                                                      j
                                                      ′
                                                   
                                                
                                                
                                                   c
                                                   m
                                                
                                             
                                             ,
                                              
                                             i
                                             j
                                             ,
                                             
                                                i
                                                ′
                                             
                                             
                                                j
                                                ′
                                             
                                             ∈
                                             
                                                J
                                                
                                                   c
                                                   m
                                                
                                             
                                             ,
                                              
                                             i
                                             ,
                                             
                                                i
                                                ′
                                             
                                             ∈
                                             I
                                             ,
                                              
                                             i
                                             ≠
                                             
                                                i
                                                ′
                                             
                                             ,
                                          
                                       
                                    
                                 
                                 
                                    
                                       (6)
                                       
                                          
                                             E
                                             
                                                T
                                                
                                                   i
                                                   j
                                                
                                             
                                             −
                                             E
                                             
                                                T
                                                
                                                   
                                                      i
                                                      ′
                                                   
                                                   
                                                      j
                                                      ′
                                                   
                                                
                                             
                                             +
                                             H
                                             
                                                Z
                                                
                                                   i
                                                   j
                                                   ,
                                                   
                                                      i
                                                      ′
                                                   
                                                   
                                                      j
                                                      ′
                                                   
                                                
                                             
                                             ≥
                                             
                                                T
                                                
                                                   i
                                                   j
                                                
                                                
                                                   c
                                                   m
                                                
                                             
                                             ,
                                              
                                             i
                                             j
                                             ,
                                             
                                                i
                                                ′
                                             
                                             
                                                j
                                                ′
                                             
                                             ∈
                                             
                                                J
                                                
                                                   c
                                                   m
                                                
                                             
                                             ,
                                              
                                             i
                                             ,
                                             
                                                i
                                                ′
                                             
                                             ∈
                                             I
                                             ,
                                              
                                             i
                                             ≠
                                             
                                                i
                                                ′
                                             
                                             ,
                                          
                                       
                                    
                                 
                              

The surgery must be performed within the same working day. i.e. 
                                    
                                       S
                                       
                                          T
                                          
                                             i
                                             1
                                          
                                       
                                       ,
                                       E
                                       
                                          T
                                          
                                             i
                                             3
                                          
                                       
                                       ∈
                                       
                                          C
                                          w
                                       
                                    
                                 
                                 
                                    
                                       (7)
                                       
                                          
                                             
                                                T
                                                
                                                   S
                                                   w
                                                
                                             
                                             ≤
                                             S
                                             
                                                T
                                                
                                                   i
                                                   1
                                                
                                             
                                             ≤
                                             
                                                T
                                                
                                                   E
                                                   w
                                                
                                             
                                             −
                                             
                                                T
                                                
                                                   i
                                                   1
                                                
                                             
                                             −
                                             
                                                T
                                                
                                                   i
                                                   3
                                                
                                             
                                             −
                                             max
                                             
                                                
                                                   
                                                      T
                                                      
                                                         i
                                                         2
                                                      
                                                      
                                                         c
                                                         m
                                                      
                                                   
                                                   ×
                                                   
                                                      x
                                                      
                                                         i
                                                         2
                                                      
                                                      
                                                         c
                                                         m
                                                      
                                                   
                                                
                                             
                                             ,
                                              
                                             c
                                             ∈
                                             
                                                C
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                              
                                             m
                                             ∈
                                             
                                                M
                                                c
                                             
                                             ,
                                              
                                             i
                                             =
                                             1,2
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                              
                                             w
                                             ∈
                                             
                                                N
                                                +
                                             
                                          
                                       
                                    
                                 
                              

The exact number of required resources in resource type c is assigned to perform stage j of surgery i.

(8)
                                    
                                       
                                          ∑
                                          
                                             m
                                             ∈
                                             
                                                M
                                                c
                                             
                                          
                                       
                                       
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                             
                                                c
                                                m
                                             
                                          
                                          =
                                          
                                             n
                                             
                                                i
                                                j
                                             
                                             c
                                          
                                       
                                       ,
                                        
                                       c
                                       ∈
                                       
                                          C
                                          
                                             i
                                             j
                                          
                                       
                                    
                                 
                              

The surgery must start and finish within the time window in which the assigned resources are available.
                                    
                                       (9)
                                       
                                          
                                             S
                                             
                                                T
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≥
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                                
                                                   c
                                                   m
                                                
                                             
                                             ×
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         T
                                                         
                                                            W
                                                            
                                                               c
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         w
                                                         
                                                            i
                                                            j
                                                         
                                                         
                                                            c
                                                            m
                                                            t
                                                         
                                                      
                                                      ×
                                                      S
                                                      T
                                                      
                                                         W
                                                         
                                                            c
                                                            m
                                                         
                                                         t
                                                      
                                                   
                                                
                                             
                                             ,
                                              
                                             i
                                             ∈
                                             I
                                             ,
                                              
                                             j
                                             =
                                             1,2,3
                                             ,
                                              
                                             c
                                             ∈
                                             
                                                C
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                              
                                             m
                                             ∈
                                             
                                                M
                                                c
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (10)
                                       
                                          
                                             E
                                             
                                                T
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≤
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                                
                                                   c
                                                   m
                                                
                                             
                                             ×
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         T
                                                         
                                                            W
                                                            
                                                               c
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         w
                                                         
                                                            i
                                                            j
                                                         
                                                         
                                                            c
                                                            m
                                                            t
                                                         
                                                      
                                                      ×
                                                      E
                                                      T
                                                      
                                                         W
                                                         
                                                            c
                                                            m
                                                         
                                                         t
                                                      
                                                   
                                                
                                             
                                             ,
                                              
                                             i
                                             ∈
                                             I
                                             ,
                                              
                                             j
                                             =
                                             1,2,3
                                             ,
                                              
                                             c
                                             ∈
                                             
                                                C
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                              
                                             m
                                             ∈
                                             
                                                M
                                                c
                                             
                                          
                                       
                                    
                                 
                              

The resource (here mainly referring to a surgeon, circulator(s) and scrub(s)) assigned to a surgery must meet the qualifications required by the surgery specialty and the surgery complexity.
                                    
                                       (11)
                                       
                                          
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                                
                                                   c
                                                   m
                                                
                                             
                                             ≤
                                             
                                                ∑
                                                
                                                   d
                                                   ∈
                                                   D
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      s
                                                      ∈
                                                      S
                                                   
                                                
                                                
                                                   
                                                      P
                                                      
                                                         s
                                                         d
                                                      
                                                      i
                                                   
                                                   ×
                                                   
                                                      Q
                                                      
                                                         s
                                                         d
                                                      
                                                      
                                                         c
                                                         m
                                                      
                                                   
                                                
                                                ,
                                                 
                                                i
                                                ∈
                                                I
                                                ,
                                                 
                                                j
                                                =
                                                1,2,3
                                                ,
                                                 
                                                c
                                                ∈
                                                
                                                   C
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                ∩
                                                
                                                   
                                                      S
                                                      G
                                                      ,
                                                      N
                                                      C
                                                      ,
                                                      N
                                                      S
                                                   
                                                
                                                ,
                                                 
                                                m
                                                ∈
                                                
                                                   M
                                                   c
                                                
                                             
                                          
                                       
                                    
                                 
                              

The following are binary variables:
                                    
                                       (12)
                                       
                                          
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                                
                                                   c
                                                   m
                                                
                                             
                                             ∈
                                             
                                                
                                                   0,1
                                                
                                             
                                             ,
                                              
                                             i
                                             ∈
                                             I
                                             ,
                                              
                                             j
                                             =
                                             1,2,3
                                             ,
                                              
                                             c
                                             ∈
                                             
                                                C
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                              
                                             m
                                             ∈
                                             
                                                M
                                                c
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (13)
                                       
                                          
                                             
                                                Z
                                                
                                                   i
                                                   j
                                                   ,
                                                   
                                                      i
                                                      ′
                                                   
                                                   
                                                      j
                                                      ′
                                                   
                                                
                                             
                                             ∈
                                             
                                                
                                                   0
                                                   ,
                                                    
                                                   1
                                                
                                             
                                             ,
                                              
                                             i
                                             j
                                             ,
                                             
                                                i
                                                ′
                                             
                                             
                                                j
                                                ′
                                             
                                             ∈
                                             
                                                J
                                                
                                                   c
                                                   m
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (14)
                                       
                                          
                                             
                                                w
                                                
                                                   i
                                                   j
                                                
                                                
                                                   c
                                                   m
                                                   t
                                                
                                             
                                             ∈
                                             
                                                
                                                   0
                                                   ,
                                                    
                                                   1
                                                
                                             
                                             ,
                                              
                                             i
                                             ∈
                                             I
                                             ,
                                              
                                             j
                                             =
                                             1,2,3
                                             ,
                                              
                                             c
                                             ∈
                                             
                                                C
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                              
                                             m
                                             ∈
                                             
                                                M
                                                c
                                             
                                             ,
                                              
                                             t
                                             ∈
                                             
                                                N
                                                +
                                             
                                             ,
                                              
                                             t
                                             ≤
                                             
                                                
                                                   T
                                                   
                                                      W
                                                      
                                                         c
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

The surgery scheduling problem is formulated in Eqs. (1)–(14) as a mixed integer non-linear programming optimization problem. We claim that the surgery scheduling problem in this paper is computationally hard because (1) the optimization model is similar to a JSP, which is proven to be NP-hard [31,33] and (2). In literature, several paper proved or mentioned daily surgery scheduling problem is NP-hard [14,34]. For an illustration, consider a hospital with 6 ORs, 3 PHU beds, and 3 PACU beds that utilizes 10 circulation nurses, 10 scrub nurses, and 10 anesthetists each day. Suppose that the hospital typically deals with 20 surgery cases per day. Then the optimization model will have 15,140 discrete variables and over 30,000 constraints, which takes a significant computational effort to solve for daily scheduling problem. In general, the combinatorial nature of the surgery scheduling problem becomes extremely complex to solve for actual scheduling problems in the hospital. Furthermore, the nonlinearity in constraints (i.e. Eqs. (9) and (10)) make the problem even more difficult to optimize. Therefore, we propose a meta-heuristic approach to find a sub-optimal good-quality solution in a fast manner.

The ant colony optimization (ACO) algorithm is a fast suboptimal meta-heuristic inspired by ants foraging behavior and works for the discrete optimization problem. It is adopted to solve surgery scheduling problem in this research. The distributed and adaptive characteristic of ACO is suited for the dynamic scheduling problem as well, which makes the proposed ACO approach having much more potential to open for future scheduling research. A modified ACO algorithm is presented in this section to solve such a complex combinatorial optimization problem.

The concepts and underlying fundamentals of the ACO are introduced by Dorigo et al. [35]. The ACO algorithm is based on the idea of ants depositing pheromone on edges of a node-edge graph, such that edges involved in the shortest tour receive greater pheromone, resulting in more ants choosing those arcs in subsequent iterations. An ACO algorithm alternates two basic procedures: (1) a parallel solution construction/modification procedure in which a set of m ants builds/modifies in parallel m solutions to the considered problem, and (2) a pheromone updating procedure by which the amount of pheromone trail on the problem graph edges is changed. The solution construction/modification is done probabilistically. The probability with which ants choose nodes to visit concerns the amount of pheromone trail τ deposited by previous ants and the heuristic visibility η (e.g. length of the edge). Pheromone updating is the function of both the evaporation rate ρ and the quality of the solutions produced. To apply ACO to the surgery scheduling problem, the following structure should be defined: (1) an appropriate ant graph representation, (2) the pheromone definition and update strategy, (3) the ant solution construction, and (4) an algorithm description.

A two-level ant graph (see Fig. 2
                        ) is designed to provide the complete surgery schedule that includes both the surgery sequence and the resource allocation for every surgery stages. The outer level graph (Fig. 2a) is defined as a surgery graph. The nodes on the surgery graph represent the surgeries, and the directional arcs, indicating the precedence sequence, are used to link two nodes. Therefore, the ant foraging path is the scheduling sequence of the surgeries [17,18]. The inner level graph (Fig. 2b) is defined as a resource graph. The inner-graph nodes represent the total qualified resources of the OR management system along the three-stage surgery procedure. The nodes are grouped into several layers from left to right according to the number of demanding resource types. The first node in the left is a dummy node as a starting point. Individual layers represent the required resource types in the surgery stages. The nodes in same layer are all qualified or immediate available resources of a specific resource type. The ant foraging path in the inner level graph determines the resources selected for each specific stage during a surgery. For example, in Fig. 2a, the inner resources of surgery #6 are classified into three stages (named as sub-graph 61, 62 and 63). In Fig. 2b, the available resources in each stage further form an ant graph, the nodes linked by solid arrow line are selected as the resources allocated to the specific surgery, e.g. PHU bed #2 and nurse #3 are selected in the pre-operative stage in sub-graph 61.

The inner ant graph is a dynamic graph which indicates all available required resources in a surgery taking into account all resource constraints. The inner graph structure should be constructed whenever an ant enters into an individual surgery's resource graph. The individual surgery has its own resource demand, which specifies the types of resources to be included in the constraints such as specific specialty, qualification, job title and other attributes. Those constraints are mainly imposed on surgeons and nurses because they are regarded as non-homogenous during an intra-operative stage. The practical constraints considered for nurses can be found in Section 3.2. In addition to the types of resources, the time availability of the resources also determines the individual surgery's inner ant graph structure.

Assume that an ant is entering into a surgery i's inner resource graph with surgery specialty s
                        
                           i
                        
                        ∈
                        S and complexity d
                        
                           i
                        
                        ∈
                        D. Let d
                        
                           cm
                         represent the qualification of resource m, of resource type c, and s
                        
                           cm
                         is the surgery specialty with resource m, of resource type c. A set of qualified resources in a resource type c, for stage j, of surgery i, is identified in Eq. (15), which indicates that only immediately available resources, whose earliest start time (
                           
                              E
                              
                                 S
                                 
                                    i
                                    j
                                 
                                 
                                    c
                                    m
                                 
                              
                           
                        ) is less than the end time of the immediate predecessor (ET
                        
                           i(j−1)), can be a member of the immediately available resource set 
                           
                              
                                 
                                    G
                                    ′
                                 
                                 c
                                 
                                    i
                                    j
                                 
                              
                           
                        . For non-homogenous resources such as surgeons and nurses working in an intra-opertive stage, it is necessary that 
                           
                              
                                 
                                    G
                                    ′
                                 
                                 c
                                 
                                    i
                                    j
                                 
                              
                           
                         takes into account the specialty and complexity constraints. If there is no resource immediately available, then all qualified resources can be considered as the available resource set 
                           
                              
                                 G
                                 c
                                 
                                    i
                                    j
                                 
                              
                           
                         as shown in Eq. (16). The total qualified resources for surgery i is the union of the sets of all required resource types during the three surgery stages as shown in Eq. (17), which forms the nodes of the inner resource ant graph of surgery i. Also we provide the possibility to fix the surgeon to a surgery by setting 
                           
                              
                                 G
                                 c
                                 
                                    i
                                    j
                                 
                              
                           
                         to a specific surgeon as required.
                           
                              (15)
                              
                                 
                                    
                                       
                                          G
                                          ′
                                       
                                       c
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   M
                                                   c
                                                
                                                |
                                                
                                                   s
                                                   
                                                      c
                                                      m
                                                   
                                                
                                                =
                                                
                                                   s
                                                   i
                                                
                                                ,
                                                
                                                   d
                                                   
                                                      c
                                                      m
                                                   
                                                
                                                ≥
                                                
                                                   d
                                                   i
                                                
                                                ,
                                                E
                                                
                                                   S
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      c
                                                      m
                                                   
                                                
                                                ≤
                                                E
                                                
                                                   T
                                                   
                                                      i
                                                      (
                                                      j
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                                 
                                                if
                                                 
                                                c
                                                ∈
                                                
                                                   
                                                      S
                                                      G
                                                      ,
                                                      N
                                                      C
                                                      ,
                                                      N
                                                      S
                                                   
                                                
                                                &
                                                j
                                                =
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   M
                                                   c
                                                
                                                |
                                                E
                                                
                                                   S
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      c
                                                      m
                                                   
                                                
                                                ≤
                                                E
                                                
                                                   T
                                                   
                                                      i
                                                      (
                                                      j
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                                 
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       G
                                       c
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      G
                                                      ′
                                                   
                                                   c
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                 
                                                if
                                                 
                                                
                                                   
                                                      G
                                                      ′
                                                   
                                                   c
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                ≠
                                                ϕ
                                             
                                          
                                          
                                             
                                                
                                                   M
                                                   c
                                                
                                                |
                                                
                                                   s
                                                   
                                                      c
                                                      m
                                                   
                                                
                                                =
                                                
                                                   s
                                                   i
                                                
                                                ,
                                                
                                                   d
                                                   
                                                      c
                                                      m
                                                   
                                                
                                                ≥
                                                
                                                   d
                                                   i
                                                
                                                 
                                                if
                                                 
                                                (
                                                
                                                   
                                                      G
                                                      ′
                                                   
                                                   c
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                =
                                                ϕ
                                                )
                                                &
                                                c
                                                ∈
                                                
                                                   
                                                      S
                                                      G
                                                      ,
                                                      N
                                                      C
                                                      ,
                                                      N
                                                      S
                                                   
                                                
                                                &
                                                
                                                   
                                                      j
                                                      =
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   M
                                                   c
                                                
                                                 
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       G
                                       i
                                    
                                    =
                                    
                                       ∪
                                       
                                          j
                                          =
                                          1,2,3
                                       
                                    
                                    
                                       ∪
                                       
                                          c
                                          ∈
                                          
                                             C
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                    
                                       G
                                       c
                                       
                                          i
                                          j
                                       
                                    
                                 
                              
                           
                        
                     

For the two-level ant graph, an appropriate pheromone structure and its update strategy need to be designed to efficiently record and enhance the optimal solution during the ant's solution construction. Three types of pheromone, i.e. sequence-related pheromone, surgery-related pheromone and resource-related pheromone, and the corresponding pheromone update strategies are designed.

The sequence-related pheromone (
                           
                              
                                 τ
                                 
                                    i
                                    
                                       i
                                       ′
                                    
                                 
                              
                           
                        ) is defined to indicate the strength of the sequence from node i to node i′ in the outer ant graph. As the ant traverses the nodes in the outer ant graph, it returns with a sequence of nodes visited, which indicates sequence of surgeries in the schedule. When considering multiple nurse roster constraints in surgery scheduling, the traversing solutions are prone to be infeasible. The detail evaluation of the feasibility of a solution is described in Section 4.5. Since there is a limited amount of ants can build feasible solutions in a generation, it is essential to reinforce the pheromone of not only the iteration-best solution (i.e. the sequence of surgeries with the shortest makespan), but also all feasible solutions in order to ensure that the follow-up ants avoid an invalid path. All of the ants’ feasible solutions in a generation are grouped into a set defined as FS. The pheromone on the paths in FS should be reinforced by a constant pheromone increment. Moreover, the iteration-best solution should be further reinforced with a higher pheromone value. Hence, an iteration-best and the feasible update strategy is adopted as shown in Eq. (18) for the sequence-related pheromone update.
                           
                              (18)
                              
                                 
                                    
                                       τ
                                       
                                          i
                                          
                                             i
                                             ′
                                          
                                       
                                    
                                    =
                                    
                                       
                                          1
                                          −
                                          ρ
                                       
                                    
                                    ×
                                    
                                       τ
                                       
                                          i
                                          
                                             i
                                             ′
                                          
                                       
                                    
                                    +
                                    
                                       Δ
                                    
                                    
                                       τ
                                       
                                          i
                                          
                                             i
                                             ′
                                          
                                       
                                    
                                    +
                                    
                                       ∑
                                       
                                          f
                                          ∈
                                          F
                                          S
                                       
                                    
                                    
                                       
                                          
                                             Δ
                                          
                                          *
                                       
                                       
                                          τ
                                          
                                             i
                                             
                                                i
                                                ′
                                             
                                          
                                          f
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       τ
                                       
                                          i
                                          
                                             i
                                             ′
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   Q
                                                   
                                                      
                                                         L
                                                         k
                                                      
                                                   
                                                
                                                ,
                                                 
                                                if
                                                 
                                                ant
                                                 
                                                k
                                                 
                                                goes
                                                 
                                                through
                                                 
                                                (
                                                i
                                                ,
                                                
                                                   i
                                                   ′
                                                
                                                )
                                                 
                                                in
                                                 
                                                this
                                                 
                                                iteration
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                                 
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       
                                          Δ
                                       
                                       *
                                    
                                    
                                       τ
                                       
                                          i
                                          
                                             i
                                             ′
                                          
                                       
                                       f
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   τ
                                                   0
                                                
                                                ,
                                                 
                                                if
                                                 
                                                a
                                                 
                                                feasible
                                                 
                                                solution
                                                 
                                                f
                                                 
                                                bypass
                                                 
                                                (
                                                i
                                                ,
                                                
                                                   i
                                                   ′
                                                
                                                )
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                                 
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Eq. (18) indicates that the pheromone update involves three parts. The first part 
                           
                              (
                              1
                              −
                              ρ
                              )
                              ×
                              
                                 τ
                                 
                                    i
                                    
                                       i
                                       ′
                                    
                                 
                              
                           
                         denotes the pheromone value after evaporation, where ρ denotes the pheromone evaporation rate. The second part, 
                           
                              
                                 Δ
                              
                              
                                 τ
                                 
                                    i
                                    
                                       i
                                       ′
                                    
                                 
                              
                           
                        , is the incremental pheromone on the edge (i,i′) and is based on the iteration-best solution as shown in Eq. (19), where Q is an adjustable parameter and L
                        
                           k
                         is the makespan of a solution. The final part is the sum of the incremental pheromone on the edge (i,i′) (
                           
                              
                                 
                                    Δ
                                 
                                 *
                              
                              
                                 τ
                                 
                                    i
                                    
                                       i
                                       ′
                                    
                                 
                                 f
                              
                           
                        ) as long as the edge (i,i′) is in a feasible solution f among set FS, where τ
                        0 is a constant incremental value.

The surgery-related pheromone and the resource-related pheromone belong to the inner ant graph. The inner surgery-related pheromone (
                           
                              
                                 τ
                                 
                                    c
                                    m
                                 
                                 i
                                 
                                 
                                 
                                    I
                                    n
                                 
                              
                           
                        ) is defined to associate surgery i with resource m of resource type c. It is also updated based on the iteration-best and the feasible update strategy to enhance the resource allocation solution both in feasibility and in best makespan as shown in Eq. (21). The variable 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    I
                                    n
                                 
                              
                              
                                 τ
                                 
                                    c
                                    m
                                 
                                 i
                              
                           
                         is the incremental pheromone associated with the iteration best solution as shown in Eq. (22), and 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    I
                                    n
                                    *
                                 
                              
                              
                                 τ
                                 
                                    c
                                    m
                                 
                                 
                                    i
                                    f
                                 
                              
                           
                         denotes the incremental pheromone associated with the feasible solution as shown in Eq. (23).
                           
                              (21)
                              
                                 
                                    
                                       τ
                                       
                                          c
                                          m
                                       
                                       i
                                       
                                       
                                       
                                          I
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          1
                                          −
                                          ρ
                                       
                                    
                                    ×
                                    
                                       τ
                                       
                                          c
                                          m
                                       
                                       i
                                       
                                       
                                       
                                          I
                                          n
                                       
                                    
                                    +
                                    
                                       Δ
                                    
                                    
                                       τ
                                       
                                          c
                                          m
                                       
                                       i
                                       
                                       
                                       
                                          I
                                          n
                                       
                                    
                                    +
                                    
                                       ∑
                                       
                                          f
                                          ∈
                                          F
                                          S
                                       
                                    
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             I
                                             n
                                             *
                                          
                                       
                                       
                                          τ
                                          
                                             c
                                             m
                                          
                                          
                                             i
                                             f
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       τ
                                       
                                          c
                                          m
                                       
                                       i
                                       
                                       
                                       
                                          I
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   Q
                                                   
                                                      
                                                         L
                                                         k
                                                      
                                                   
                                                
                                                ,
                                                 
                                                if
                                                 
                                                ant
                                                 
                                                k
                                                 
                                                goes
                                                 
                                                through
                                                 
                                                the
                                                 
                                                surgery
                                                 
                                                i
                                                '
                                                s
                                                 
                                                resource
                                                 
                                                graph
                                                 
                                                (
                                                c
                                                ,
                                                m
                                                )
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                                 
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       τ
                                       
                                          c
                                          m
                                       
                                       
                                          i
                                          f
                                       
                                       
                                       
                                       
                                          I
                                          n
                                          *
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   τ
                                                   0
                                                
                                                ,
                                                 
                                                if
                                                 
                                                a
                                                 
                                                feasible
                                                 
                                                solution
                                                 
                                                f
                                                 
                                                bypass
                                                 
                                                the
                                                 
                                                surgery
                                                 
                                                i
                                                '
                                                s
                                                 
                                                resource
                                                 
                                                graph
                                                 
                                                (
                                                c
                                                ,
                                                m
                                                )
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                                 
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The inner resource-related pheromone 
                           
                              
                                 λ
                                 m
                                 k
                                 
                                 
                                 
                                    I
                                    n
                                 
                              
                           
                         is defined to record the information related to the resource utilization during the period of an ant constructing solution. This pheromone is effective as long as an ant enters the inner resource graph, and it becomes void when the ant leaves the inner graph and backs to the outer surgery graph. In any surgery stage, once a resource is selected, its opportunity to be selected by another surgery should be reduced in order to balance the resource utilization. Therefore, it is updated locally after visiting each node (i.e. on an arc-step completion) as shown in Eq. (24), where q
                        0 is the decremented pheromone value. By local pheromone updating, the possibility of ants traveling through the same path decreases, thus it can effectively avoid the uneven utilization of resources. This pheromone has the initial value of 1 and value is not allowed to be negative.
                           
                              (24)
                              
                                 
                                    
                                       λ
                                       m
                                       k
                                       
                                       
                                       
                                          I
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                   m
                                                   k
                                                   
                                                   
                                                   
                                                      I
                                                      n
                                                   
                                                
                                                −
                                                
                                                   q
                                                   0
                                                
                                                ,
                                                 
                                                if
                                                 
                                                
                                                   λ
                                                   m
                                                   k
                                                   
                                                   
                                                   
                                                      I
                                                      n
                                                   
                                                
                                                >
                                                
                                                   q
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                                 
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Ants build solutions using a probabilistic transition rule in the ACO algorithm. The probability that an ant chooses the next visiting node is determined by the amount of pheromone and heuristic desirability. The next node to be chosen is based on the probability where a roulette wheel mechanism is used to make the selection.

Eq. (25) gives the probability (P
                        
                           ii′) that the ant will choose node i′ immediately after node i in the outer surgery graph, where I
                        
                           0
                         is the feasible node set including nodes to be scheduled and α and β are two parameters which determine the impact of the pheromone trail and the heuristic information. The variable 
                           
                              
                                 τ
                                 
                                    i
                                    
                                       i
                                       ′
                                    
                                 
                              
                           
                         is the outer sequence-related pheromone intensity between node i and i′ and 
                           
                              
                                 η
                                 
                                    i
                                    
                                       i
                                       ′
                                    
                                 
                              
                           
                         represents the heuristic visibility from node i to node i′ and is determined by Eq. (26).
                           
                              (25)
                              
                                 
                                    
                                       p
                                       
                                          i
                                          
                                             i
                                             ′
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         τ
                                                         
                                                            i
                                                            
                                                               i
                                                               ′
                                                            
                                                         
                                                         α
                                                      
                                                      ×
                                                      
                                                         η
                                                         
                                                            i
                                                            
                                                               i
                                                               ′
                                                            
                                                         
                                                         β
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            
                                                               i
                                                               ′
                                                            
                                                            ⊂
                                                            
                                                               I
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            τ
                                                            
                                                               i
                                                               
                                                                  i
                                                                  ′
                                                               
                                                            
                                                            α
                                                         
                                                         ×
                                                         
                                                            η
                                                            
                                                               i
                                                               
                                                                  i
                                                                  ′
                                                               
                                                            
                                                            β
                                                         
                                                      
                                                   
                                                
                                                ,
                                                 
                                                i
                                                f
                                                 
                                                
                                                   i
                                                   ′
                                                
                                                ∈
                                                
                                                   I
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                                 
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (26)
                              
                                 
                                    
                                       η
                                       
                                          i
                                          
                                             i
                                             ′
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               T
                                                               
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                                  1
                                                               
                                                            
                                                            +
                                                            
                                                               T
                                                               
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                                  3
                                                               
                                                            
                                                            +
                                                            max
                                                            
                                                               
                                                                  
                                                                     T
                                                                     
                                                                        
                                                                           i
                                                                           ′
                                                                        
                                                                        2
                                                                     
                                                                     
                                                                        S
                                                                        G
                                                                        m
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               T
                                                               
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                                  1
                                                               
                                                            
                                                            +
                                                            
                                                               T
                                                               
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                                  3
                                                               
                                                            
                                                            +
                                                            max
                                                            
                                                               
                                                                  
                                                                     T
                                                                     
                                                                        
                                                                           i
                                                                           ′
                                                                        
                                                                        2
                                                                     
                                                                     
                                                                        S
                                                                        G
                                                                        m
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            A
                                                         
                                                      
                                                   
                                                
                                                ,
                                                 
                                                m
                                                ∈
                                                
                                                   M
                                                   
                                                      S
                                                      G
                                                   
                                                
                                                ,
                                                 
                                                
                                                   i
                                                   ′
                                                
                                                ∈
                                                
                                                   I
                                                   0
                                                
                                                ,
                                                 
                                                
                                                   ε
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                          
                                             
                                                H
                                                 
                                                if
                                                 
                                                
                                                   ε
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                =
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The heuristic visibility is defined to integrate the priority preference in surgery scheduling. The constant A, usually associated with the surgery duration, is used to ensure that the visibility value is at the same level as the pheromone value. Two kinds of priorities are considered here in managing ORs. The first priority is urgency priority, i.e. the elective patients who need urgent care (e.g. kids and seniors) take a higher priority over other patients. When a surgery is known to be urgent, the heuristic visibility will be set as a very big positive value H, which will finally lead to a higher probability in P
                        
                           ii′. The second priority is duration-based priority, i.e. the surgeries with longer surgery durations have priority over those with shorter durations because the shorter surgeries are easier to fit into empty time slots before the end of the working day. For normal surgeries without urgency priority, the heuristic visibility depends on the duration.

In the inner resource graph, the probability that ant k will choose resource m of type c for surgery i is denoted as 
                           
                              
                                 P
                                 
                                    c
                                    m
                                 
                                 
                                    k
                                    i
                                 
                              
                           
                         in Eq. (27), where G
                        
                           c
                         is the available set of resources for the next resource node stage selection as shown in Eq. (18).
                           
                              (27)
                              
                                 
                                    
                                       P
                                       
                                          c
                                          m
                                       
                                       
                                          k
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     τ
                                                                     
                                                                        c
                                                                        m
                                                                     
                                                                     i
                                                                     
                                                                     
                                                                     
                                                                        I
                                                                        n
                                                                     
                                                                  
                                                                  ×
                                                                  
                                                                     λ
                                                                     m
                                                                     k
                                                                     
                                                                     
                                                                     
                                                                        I
                                                                        n
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         α
                                                      
                                                      ×
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     η
                                                                     
                                                                        c
                                                                        m
                                                                     
                                                                     
                                                                     
                                                                     
                                                                     
                                                                        I
                                                                        n
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         β
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            g
                                                            ⊂
                                                            
                                                               G
                                                               c
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        τ
                                                                        
                                                                           c
                                                                           g
                                                                        
                                                                        i
                                                                        
                                                                        
                                                                        
                                                                           I
                                                                           n
                                                                        
                                                                     
                                                                     ×
                                                                     
                                                                        λ
                                                                        g
                                                                        k
                                                                        
                                                                        
                                                                        
                                                                           I
                                                                           n
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            α
                                                         
                                                         ×
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        η
                                                                        
                                                                           c
                                                                           g
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                           I
                                                                           n
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            β
                                                         
                                                      
                                                   
                                                
                                                ,
                                                 
                                                if
                                                 
                                                g
                                                ∈
                                                
                                                   G
                                                   c
                                                
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                                 
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Because the pheromone in the inner resource graph consists of the surgery-related pheromone (
                           
                              
                                 τ
                                 
                                    c
                                    m
                                 
                                 i
                                 
                                 
                                 
                                    I
                                    n
                                 
                              
                           
                        ) and the resource-related pheromone (
                           
                              
                                 λ
                                 m
                                 k
                                 
                                 
                                 
                                    I
                                    n
                                 
                              
                           
                        ), it is represented as the product of these two pheromone values. The heuristic visibility 
                           
                              
                                 η
                                 
                                    c
                                    m
                                 
                                 
                                 
                                 
                                 
                                    I
                                    n
                                 
                              
                           
                         is defined in Eq. (28) to indicate the priority of the earlier available resources in the resource selection. The variable 
                           
                              E
                              
                                 S
                                 
                                    i
                                    j
                                 
                                 
                                    c
                                    m
                                 
                              
                           
                         is the earliest starting time of surgery stage j of surgery i under resource m of resource type c. Eq. (28) ensures a larger value in heuristic visibility for the resource with earliest finishing time. The numerator is chosen to ensure that the heuristic value is in the same order of magnitude as the pheromone. It will help to ensure both pheromone and heuristic have the effective influence on the probability in Eq. (27).
                           
                              (28)
                              
                                 
                                    
                                       η
                                       
                                          c
                                          m
                                       
                                       
                                       
                                       
                                       
                                          I
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          10
                                       
                                       
                                          
                                             
                                                E
                                                
                                                   S
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      c
                                                      m
                                                   
                                                
                                                +
                                                
                                                   T
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      c
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Every time an ant finishes an inner resource graph path, it receives a resource assignment. A decoding procedure is then required to obtain the detailed time windows of the assigned resources. An individual resource has its own available time window. The possible period assigned to a specific surgery stage is the intersection set of all the required resources’ available time windows. Because the stage of surgery requires multiple resources to work together, the time window allocated to its required resources must be exactly the same, i.e. each required resource is occupied by the same period and is released at the same time. In addition, the non-preemptive factor needs to be considered to ensure the consecutive time windows of the three-stage surgery and of the relative required resources. The evaluation of the feasibility of a solution follows the same procedure: (1) The solution is infeasible as long as there is no intersection set among all required resources’ available time windows, i.e. 
                           
                              T
                              W
                              
                                 j
                              
                              =
                              T
                              
                                 W
                                 
                                    
                                       c
                                       1
                                    
                                    
                                       m
                                       1
                                    
                                 
                              
                              ∩
                              T
                              
                                 W
                                 
                                    
                                       c
                                       2
                                    
                                    
                                       m
                                       2
                                    
                                 
                              
                              ∩
                              ⋯
                              ∩
                              T
                              
                                 W
                                 
                                    
                                       c
                                       k
                                    
                                    
                                       m
                                       k
                                    
                                 
                              
                              =
                              ϕ
                           
                         (2) The solution is infeasible if the available time window is not longer than the duration of the surgery stage, i.e. 
                           
                              
                                 
                                    T
                                    W
                                    
                                       j
                                    
                                    
                                       
                                          E
                                          T
                                          
                                             W
                                             
                                                j
                                                k
                                             
                                          
                                          −
                                          S
                                          T
                                          
                                             W
                                             
                                                j
                                                k
                                             
                                          
                                          >
                                          
                                             T
                                             
                                                i
                                                j
                                             
                                          
                                          ,
                                           
                                          k
                                          ∈
                                          
                                             
                                                1
                                                ,
                                                z
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              ϕ
                           
                         (3) The solution is infeasible if three stages of a surgery are not consecutive. Whenever an ant solution is decoded, the resources selected for performing the surgery need to be updated with their latest available time window immediately.


                        Fig. 3
                         shows an example of the inner resource assignment result and its decoded time window. The series of letter and number in the upper part of figure gives the resource assignment of a solution, e.g. P-1 means PHU bed is #1. Therefore, this example tells us that a surgery is done by nurse (#6) in PHU bed (#1), by surgeon (#12), nurse (#5), anesthesia (#25) in OR (#17), by nurse (#10) in PACU bed (#21). The individuals’ old occupied time windows before a schedule are given in the Gant Chart in lower part of Fig. 3. After decoding, the time windows of a solution are generated and should be updated to individual resources. If the feasible time windows can not be found, it will be regarded as an infeasible solution.


                        Fig. 4
                         briefly shows the proposed ACO algorithm for solving the surgery scheduling problem. The detailed procedure is explained as follows:

Step1: Initialize the ACO parameters and assign m ants to arbitrary nodes in the outer graph.

Step2: Ants travel to a node in the outer graph.

In this step, each ant constructs an ant solution by visiting a node in the outer graph based on the state transition rule as shown in Eq. (25). Whenever a new surgery node is visited, it is added to the tabu list and deleted from the I
                        0.

Step3: The ant travels into the inner resource graph.

As long as an ant travels to a surgery node, it immediately enters into this surgery's inner resource graph. In this step, three activities are performed by each ant: (1) construct the required resources set G based on Eq. (15), (2) construct an ant solution by visiting a node in the inner graph based on the state transition rule as shown in Eq. (27), and (3) update the resource-related pheromone as shown in Eq. (24).

Step4: Evaluate the feasibility of an ant's resource solution.

If a solution is feasible, it is then decoded to a real surgery scheduler with the start time and end time of each surgery stage and the resources occupied. After the decoding, the occupied resources’ availability will be updated in real time. If an ant's inner solution is infeasible, its current ant travel is then terminated.

Repeat Step 2 to Step 4 until an ant k finishes travel in the outer graph, which means an ant k traverses all surgeries and obtains a scheduler.

Repeat Step 2 to Step 5 until all m ants in a cycle finish traveling and obtain m scheduling results.

Step5: Find best solution and update the pheromone in the inner and outer ant graph.

After all m ants return with their scheduling results, the iteration best ant solution is determined according to the 1st objective function, the makespan. Then the pheromone in both the inner and outer ant graph is updated based on Eqs. (18) and (21).

Repeat Step 2 to Step 6 until the maximum number of iterations NC
                        
                           max
                        , is reached.

Step6: The final step is to find the global best ant solution.

Because of the two-level ant graph model, it is possible for several ant solutions to have the same makespan with different allocation of resources. Among these solutions, we can further find the one with the minimum total OT and set it as the global solution.

Two decision strategies were compared through case study in this section. One is the independent decision strategy in OR management, the other is the integrating decision strategy. The former one separately deals with surgery sequencing and nurse scheduling problem. Such independent decision strategy can be commonly found in hospitals and in most literature researches. Our work focused on the latter one which tries to integrate the surgery scheduling with the nurse roster constraints. In this section, test cases from both literature and real-life hospital scheduling data with different levels of constraints were used to evaluate these two strategies.

In the test case #1, we use the same data set reported in Mobasher et al.’s work [26]. The data was collected from an actual schedule designed by the nurse scheduler at the University of Texas MD Anderson Cancer Center, Houston, TX. In their work, the sequence and OR assignments of the surgery cases for the next day are pre-determined, and nurses are assigned to different surgery cases subjected to various constraints. Nurse roster information (such as nurse specialties, competency levels, shifts, and job titles) and surgery case information (including case specialties, procedural complexities, and demand per case) are all given as the input information to their daily nurse scheduling model. The basic data set was built around 28 cases in 17 ORs to be staffed by 23 RNs and 14 scrubs, each working one of the five shifts starting at 6:30 AM and ending at 11:30 PM. The minimum nurse demand for each case is one circulator and one scrub tech. The daily nurse schedule (DNS) result obtained by the goal programming presented in Mobasher et al. is shown in Fig. 5
                           , and is noted as Mobasher et al.’s DNS in the paper. Since their work was designed to optimize the perioperative nurse schedule only, some additional data for resources (excluded nurses) and surgery data related to the pre-operative and post-operative stages are listed in Table 2
                           . We set those numbers to be large enough so that they will not be the bottleneck of the surgery flow, which will ensure the perioperative stage to be the core of the scheduling. If those numbers are set to be of small value, it will lead to the situation that the schedule is mainly constrained by the shortage of the resources in the pre-operative and post-operative stage. This is important to ensure that our model extends to the Mobasher et al.’s DNS so that a reasonable performance comparison can be made between the two approaches.

In comparing these two approaches, our ACO model can be regarded as a systematical and global optimization, while Mobasher et al.’s DNS can be considered as local optimization on daily nurse scheduling.

This test dataset is from the real life hospital scheduling data of a typical medium scale hospital in China. They may have limited nurse constraints but it is the common phenomenal and the real case occurring in the medium scale hospital.

The test case involves 10 ORs, 6 PHU beds, 10 PACU beds, and staffed with totally 30 nurses and 27 ANs. All ORs are open during the day shift period (starting from 7:30 AM to 4:30 PM) of week day (Monday to Friday). Only one OR with two nurses and ANs is open for emergency during night shift and weekend. Therefore, most nurses and ANs are working on day shift and there is no specialty constraints in OR nurses and ANs. Generally the surgery demand is around 40 to 50 surgeries per day from totally 19 specialties. The empirical schedule of surgeries and staff in OR as well as the detailed surgeries information is collected from Oct, 22, 2013 to Nov, 04, 2013. Those data sets are used to build the 10 day cases of one day planning horizon. The detailed one day case information is listed in Appendix A.

Several parameters in the ACO have an impact on the ant exploration and the ant behavior of following known pheromone, which makes a difference in the algorithm's convergence and solution quality. The ACO algorithm in this paper refers to the basic implementation of the ACO, also called the Ant-Cycle [34]. The basic ACO parameters include the number of ants (m), the pheromone factor (α), the heuristic factor (β), the evaporate rate (ρ), and the pheromone intensity (Q). Moreover, an additional decremented pheromone value (q
                        0) is added. All parameters of the test cases are experimented with different adjustments within the suggested range by the Ant-Cycle and the final parameters are used in our ACO which are displayed in Table 3
                        . The number of iteration is set to 150. This value is tested to be enough for the algorithm to be converged.

The proposed ACO algorithm was implemented with Matlab and run on a PC running Windows XP with Intel Core5 @2.79GHz and 3GB of memory.

The computational time for running this test case #1 took about 43min to produce solutions. It is the mean CPU time of 10 independent runs with 1min standard deviation (STD). The computational time ranges from seconds to hours depending on the numbers of surgical cases and resources available, the complexity of nurse constraints, and the number of ants used in ACO as well. For a smaller scale problem instance with 10 surgeries/4 ORs/8 nurses/2 PHUs/4 PACUs/6 ANs/6 surgeons and no nurse qualification constraints, it only took 132s when ant number is set to 50. However, it took 2h for around 2-day scheduling problem under the same problem configuration. The nurse assignment results by our ACO on test case #1 in Section 5.1 are shown in Fig. 6
                           . The comparison between DNS and the ACO in several measurements are shown in Table 4
                           .

Four performance measurements are used in this comparison: the end time, the coefficient of variation of resources working time, the maximum overtime of nurses, and the total overtime of nurses. End time (i.e. the finishing time of all 28 surgeries) is used to measure the efficiency of the scheduling approaches. The coefficient of variation of working times (CVWT) is defined as the ratio of the standard deviation to the mean and it is used to evaluate the balance of the resource utilization. A lower CVWT value corresponds to a better utilization among resources; a zero value means a fully balanced assignment in resources utilization. Nurses are further divided into groups according to the shifts when calculating the CVWT of nurses because they are assigned to work different shifts in real-life OR. Overtime records the total additional time required to finish all surgeries assigned to a resource in addition to its regular working hours and directly effects the cost of OR management. OT measurement is further evaluated by both the maximum OT and the total OT among nurses. An authorized overtime is additional time that nurses can be assigned if a surgery is not completed by the end of the regular shift.

Although we further extended the duration of intra-operative stage by nearly half an hour with a pre-operative and a post-operative stage in the our ACO approach, Table 4 still shows that the end time can be improved to 6:30PM when ACO is used as compared to 8:00PM by DNS. Furthermore, taking into account the complete three stages in surgery flow makes the ACO model more realistic to the actual OR management. In DNS, the surgery cases have pre-determined time slots and the model optimized the nurse assignment accordingly, while in the ACO, all surgeries are to be scheduled with the objective of minimizing makespan. The one and a half hour reduction in end time can be significant in surgery scheduling. It shows that ACO is efficient in OR scheduling by systematically integrating surgery scheduling and nurse scheduling into one scheduling problem.

With regard to the resource utilization, the nurse CVWT value in the third shift is 0 because only one nurse is on duty. The CVWT of other resources, including ORs and nurses in shift 1 and shift 2, shows varying improvements. The CVWT of ORs in our ACO is 0.21, which has a 25% reduction when compared to DNS. Nurse management is a vital part of OR management. Among other issues in nurse management, a balanced utilization among resources is very important. From Table 5
                           , we can see that both CVWT values of nurses in shift 1 and shift 2 have much better values of 0.18 and 0.05 when compared to those in DNS with 0.35 and 0.37, respectively. They are improved by 50% for shift 1 and 86% for shift 2.

Overtime increases operational costs, which is not desired in OR management. The third observation from the results is the improvement of overtime measurements in both the maximum overtime of individual nurse and the total overtime of all nurses. The individual nurse's maximum OT is reduced from 3h in DNS to 2.75h in ACO. The total OT of nurses is reduced by about 42% (i.e. the reduction of 11h from 19h).

Overall, the comparison results show the superior performance of the ACO in shortening total time and balancing resource allocation for surgery scheduling. It further proves the advantages of integrating the surgery scheduling problem with daily nurse scheduling and taking a complete three-stage surgery flow and multiple resources into consideration.

10 cases of one day planning horizon from the empirical data of a medium scale hospital are used as the test case#2. The comparisons of these 10 test cases in several measurements are shown in Table 5. The performance measurements are classified into four types, i.e. the ORs’ cost-related times, the coefficient of variation of resources working time (CVWT), the surgeries end time, and the nurses’ cost-related times. The latter three types are the same as the performance measurements in test case #1. Since most of the nurses are working on day shift, so only nurses on day shift are analyzed for CVWT to evaluate the balanced utilization of nurses. The ORs’ cost-related times further include the total idle time, total overtime, maximum idle time and maximum overtime. Both idle time and overtime of ORs are not expected in OR management, for it will lead to the under utilization and over utilization of ORs.


                           Table 5 listed all performance measurements of scheduling result both from the real data and from optimization obtained by ACO. Table 6
                            gives further analysis and statistics (in percentage) of our ACO on each measurement.


                           Table 6 gives the sample mean 
                              
                                 μ
                                 ⌢
                              
                            and the sample standard deviation s for each measurement, and the 95% confidence interval for the mean improvement μ can be constructed by 
                              
                                 μ
                                 ∈
                                 
                                    
                                       
                                          μ
                                          ⌢
                                       
                                       −
                                       
                                          t
                                          
                                             n
                                             −
                                             1
                                             ,
                                             
                                                α
                                                /
                                                2
                                             
                                          
                                       
                                       
                                          1
                                          /
                                          
                                             
                                                n
                                             
                                          
                                       
                                       s
                                       ,
                                        
                                       
                                          μ
                                          ⌢
                                       
                                       +
                                       
                                          t
                                          
                                             n
                                             −
                                             1
                                             ,
                                             
                                                α
                                                /
                                                2
                                             
                                          
                                       
                                       
                                          1
                                          /
                                          
                                             
                                                n
                                             
                                          
                                       
                                       s
                                    
                                 
                              
                           . The comparison results show that the end time of all ten days can be improved more or less. Since the daily surgery demand is quite different in these ten days, the improvement varies from 2% to 38%. The mean of the improvement in percentage is estimated within confidential interval of [7.4, 24.6] with 95% confidence level, i.e. ACO approach can shorten the end time around 7.4% to 24.6% with 95% confidence level. The CVWT of the resources shows varying improvements (e.g. 21% to 57% for ORs’ CVWT and 26–46% for nurses’ CVWT) as well for all ten test cases. For example, in Oct, 22, the CVWT of ORs and nurses in our ACO is 0.18 and 0.31, which has a reduction of 39% and 19%, respectively, when compared to those real data. Such reduction means a more balanced utilization among resources in OR management suggested by ACO. For the measurement of ORs’ cost-related times, except Oct, 28 and Oct, 30 record the worse performance in ORs’ total OT and nurses’ total OT, all other measurements have improvement more or less. The common thing in surgery demand of these two dates is that only one surgeon is assigned to all surgeries in one specialty. Therefore, in actual scheduling, surgeries under a surgeon are allocated to the same OR and the same nurses. However, in ACO scheduling, different ORs and nurses are assigned. Although such scheduling causes the extension in total OT of nurses and ORs, it has advantages in reducing the end time and balancing the utilization of resources. The total nurses’ OT shows the similar result as the total ORs’ OT for the ten cases.

In this paper, we aim to solve the surgery scheduling problem that arises in operating suites in the hospital. The problem is complicated by the need to integrate the surgery scheduling problem with nurse scheduling while taking into account real life constraints, especially nurse roster constraints. The nurse roster constraints considered in our work include role, specialty, qualification, and availability constraints that most commonly exist in reality. A mathematical model of the surgery scheduling problem under nurse roster constraints was proposed. Due to the computational complexity of solving such combinatorial optimization problems, we developed an ACO algorithm with the objective of minimizing the makespan of all surgeries.

A two-level ant graph model containing both an outer surgery graph and multiple inner resource graphs is proposed. The inner resource graph is dynamic due to the consideration of practical resource constraints. The algorithm and the relative mechanisms (i.e. the pheromone definition, pheromone updating rule and the ant construct solution, etc.) that fit for such a modified two-level ant graph model are also presented. In the pheromone representation, three types of pheromones, i.e. sequence-related, surgery-related, and resource-related pheromone, are defined to emphasize both the information related to the good solution in makespan and the balanced utilization of resources. The iteration-best and feasible update strategy and local (on arc-step completion) pheromone update rules are adopted. The ants build a path in the inner and outer level ant graph considering the priority of either the earliest start time of resources or the longest processing duration of the surgeries. The ants finally construct a scheduler solution taking into account several factors such as the synchronous consideration, non-preemptive consideration, and individual time window.

Two sets of test cases, one from literature and the other from a medium scale hospital in China were used to validate our method. The case from literature involves a total of 28 surgery cases to be assigned to 17 ORs and 37 nurses. The nurses in this test case have complete nurse roster constraints i.e. specialty, role, qualification and availability constraints. The test cases from real hospital are built by collecting 10 work days’ surgery schedule data from the real life hospital data. The surgery demand is around 40–50 surgeries per day and resources include ORs, PACU beds, PHU beds, surgeons, anesthetists, and nurses with specialty and qualification constraints. The scheduling results of the proposed ACO algorithm were compared with the scheduling results from literature and real life hospital data. Several measurements, the end time, individual nurse's maximum overtime, total overtime of nurses (i.e. nurses’ cost-related time) and the coefficient of variation of working time of resource, and ORs cost-related time (idle time and overtime) were evaluated. In general, the comparison results demonstrates the superior performance of the proposed ACO, which indicates that the algorithm can solve the surgery scheduling problem effectively within a reasonable computation time, while providing a shortened end time and relatively balanced resource allocations. It also supports the advantage of integrating surgery scheduling with nurse scheduling and the efficiency of systematic optimization considering a complete three stage surgery flow and resources involved.

Besides the four type of nurse roster constraints mentioned in this work, there are still some other constraints like contractual, medical team preference constraints etc. To further involve those constraints during surgery scheduling decision calls for more measurements. Several new objectives should also be introduced to the surgery scheduling model. The main objective of this paper was to minimize the makespan of total surgeries. Makespan was mainly used to satisfy the efficiency of the ORs when dealing with more surgeries in a shorter time. A shorter makespan improves patient satisfaction because it can arrange timely treatments for patients. However, in reality, surgery scheduling should also improve OR management in several ways such as reducing cost, increasing resources’ utilization, and increasing the medical staffs’ satisfaction. Therefore, a surgery scheduling problem should be modeled as a multiple objective optimization problem instead of a single objective on makespan. Furthermore, the objectives such as increasing patients’ satisfaction and reducing cost are usually conflicting goals. For example, reducing patient's wait time can be achieved by hiring more staff or allowing more overtime to nurses, which in turn can build up pressure and stress on the nurses. Finding a compromise among these measurements in a surgery scheduling problem is a challenge. Future research will be in the direction of extending our ACO algorithm to solve such multi-objectives surgery scheduling problems. Another important issue in healthcare is uncertainty. It will lead to the unfeasibility of the optimized schedule in practice. In this research, no uncertainties are considered. Future research on extending the integrating scheduling problem under the uncertainties environment is on-going.

@&#ACKNOWLEDGMENTS@&#

The Project is supported by Zhejiang Provincial Natural Science Foundation of China (LY12G01007), Ningbo Natural Science Foundation (2013A610109) and K.C. Wong Magna Fund in Ningbo University. Special thanks are given to the operating theatre of the Affiliated Hospital of School of Medicine of Ningbo University for sharing the OR schedule and resource information.

The daily surgery schedule information and the information of OR resources are collected from the operating theatre of the Affiliated Hospital of School of Medicine of Ningbo University (AHSMNU). Here in this appendix, the detail information on Oct, 22, 2013 is listed in Tables A1–A3
                     
                     
                     . On that date, there are 44 surgeries from 11 specialties need to be finished.

@&#REFERENCES@&#

