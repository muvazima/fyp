@&#MAIN-TITLE@&#Visual object tracking using spatial Context Information and Global tracking skills

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           This paper proposes a novel color cue called CIG.


                        
                        
                           
                           CIG computes weights based on spatial Context Information and Global tracking skills.


                        
                        
                           
                           CIG is effective and can be computed pixel by pixel efficiently.


                        
                        
                           
                           Weights by CIG have high stability and precision under low-contrast scenes with complex motions.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Object tracking

Mean shift

Weight image

Spatial context model

CIG

@&#ABSTRACT@&#


               
               
                  Tracking objects in videos by the mean shift algorithm with color weighted histograms has received much attention in recent years. However, the stability of weights in mean shift still needs to be improved especially under low-contrast scenes with complex motions. This paper presents a new type of color cue, which produces stable weights for mean shift tracking and can be computed pixel by pixel efficiently. The proposed color cue employs global tracking techniques to overcome the illustrated drawbacks of the mean shift algorithm. It represents a target candidate with a larger scale than that of the target model so that the model is much more precise than the candidate. We illustrate that the weights by this way are more reliable under various scenes. To further suppress surrounding clutters, we establish a new spatial context model so that the optimization results are a set of weights which can be computed pixel by pixel. The proposed color cue is called CIG since it computes the weights based on spatial Context Information and Global tracking skills. Experimental results on various tracking videos show that weight images by CIG have higher stability and precision than those of current methods especially under low-contrast scenes with complex motions.
               
            

@&#INTRODUCTION@&#

Real-time visual tracking is a critical task in many computer vision applications such as driver assistance [1,2], aerial surveillance and exploitation [3,4], etc. The major challenges to be addressed in these circumstances include illumination changes, occlusions, scale variations, presence of clutters, and camera vibrations. Much efforts have been put into the research on object tracking, and some algorithms are proposed including the unscented Kalman filter [5,6], particle filter [7–9], and mean shift [10]. Among the above methods, mean shift has received much attention due to its low computational complexity. However, mean shift may fail for cameras carried by a high-speed moving platform with vibrations. In this case, motion blur is serious and images of objects have large transition regions. Some transition colors may be similar to those of background, and the contrast between object and background is low. Thus, mean shift may drift when some transition colors of objects are similar to those of background. In addition, mean shift would fail when images of objects between adjacent frames have few overlaps or no overlap due to platform vibrations. We refer the above cases as “low-contrast scenes with complex motions” for short. In these cases, mean shift still needs to be improved.

In the mean shift tracking algorithm, a weight image is generated by comparisons between color histograms such that pixels on the foreground blob have high weights, whereas pixels in backgrounds have low weights [11]. Then, mean shift provides a way to combine the color weights and a set of kernel weights within the object bandwidth to produce an offset for the centroid of the blob. Thus, a main factor to determine the effectiveness of mean shift tracking algorithms is the quality of the weight image.

Popular weight image generation methods by the color cue include color weighted histogram (CWH) and foreground background ratio (FBR). To enhance the discriminant of CWH, Zhao and Tao presented a special form of color correlogram to obtain a richer representation for object tracking [12]. A simplified color correlogram representation encoded the spatial information explicitly and enabled an estimation algorithm to recover the object orientation. In [13,14], ellipse orientation and affine kernel fitting were incorporated into the color histogram to get the object orientation. Leichter et al. enhanced the mean shift tracker to cope with appearance changes by using multiple reference histograms obtained from different target views when they are available prior to the tracking [15]. They used the convex hull of these histograms to represent the model. The main problem was that their method required multiple reference views of the interest target before tracking, which placed an obstacle in many applications. Wang et al. presented a foreground-target histogram approximation method to effectively reduce disturbances from background [39]. The approximating involved brute force searching, thus the computation cost was relatively high. Caulfield [42] fused multiple-part models and background exclusion into a single mean-shift-based tracker. The author showed that the reliability for mean-shift-based trackers was increased considerably by exploiting background models of the scene. However, Caulfield employed background modeling method for surveillance domain under static cameras to get background models of the scene, whereas our interest is in the domain of cameras carried by a high-speed moving platform with vibrations.

Current researches by FBR mainly focus on online color feature selection. Collins et al. proposed a method which selected discriminative tracking features online from linear combinations of RGB space based on variance ratio [16]. Babu et al. used color features to develop a target model based on fast learning radial basis function networks [17]. Xu et al. employed subclass discriminant analysis to find a color subspace that best discriminated foreground and background pixels [18]. In [19], the authors calculated color histograms in RGB, HSV, and normalized rg color spaces, separately. They pointed out that two features were appropriate in most cases and developed an evaluation method to adaptively update the color features during tracking. Recently, Wang et al. combined methods of CWH and FBR to get a fused weight image [40]. They showed that the fused weights were more reliable than those by single term. Other features, such as edge density or histograms [20–23], scale invariant feature transform (SIFT) [24,25], or combinations of them [24–26] have also been developed to improve the effectiveness of tracking algorithms.

Compared with methods by CWH which can encode long-time information, algorithms by FBR that only use current pixels have gained better performances as shown in [16,18]. In addition, the results by FBR can be further improved by establishing long-time foreground and background models. The comparison results violate with our intuition. In fact, tracking is the detection of specified target in memory, not the one that is only different from backgrounds. Therefore, there may be inherent drawbacks for current methods by CWH. In our earlier work [27], a background weighted histogram (BWH) was selected for the target model whereas a CWH was employed for the target candidate. We found that tracking performances were improved by setting the model and the candidate with different precisions. The same strategy was recently employed and verified from a different viewpoint in [41], and they termed the method as CBWH (corrected background weighted histogram). To address problems when there were no overlaps between consecutive frames, global tracking strategies such as annealed mean shift [28,29] or pyramid mean shift [27] were proposed. These skills gradually smoothed the surface of cost function at different scales, and gently reached the global peak. The results were greatly improved for scenes with both large and small values of motion displacements, which indicated that a global search and comparison method could improve the quality of the weights.

In this paper, the inherent drawbacks of the color cue in mean shift are analyzed. We show that a color cue is more reliable under the condition “precise model+less precise candidate enclosing the object”. This is reasonable because mean shift employs color histogram comparisons to get the weight image. A less precise candidate makes the denominator of object colors smaller, thus the comparisons larger. On the other hand, the candidate should enclosing the object to make the denominator larger than 0, otherwise the weight would be 0. These requirements can be met by enlarging the candidate scales. The benefits lie in twofold. One is that more background pixels can be enclosed into the candidate, making the model relatively more “precise”; and the other is that the candidate with a large scale has foreground pixels even when motion displacements between consecutive frames are large. Thus, the quality of the acquired color weight images by the above way will be greatly improved. This idea coincides with the mechanism of human vision. For object model, we only intend to reserve target characteristics since backgrounds are usually unstable for a long time. As for the candidate, a large scale is used to include the whole object into the ROI and to make the object and its surroundings visibly discriminable [30]. This property is termed as global tracking skills. Though simple, it differs from current methods to our knowledge. The proposed method uses a relatively large scale (usually 3 or 4) to calculate the candidate and only needs one large scale, whereas: (1) variable bandwidth selection [10] or scale-space method [11] got similarities under different scales (usually between 0.5 and 2.0) to determine the current object scale; (2) global mode seeking methods [27–29] used different scales (for example: 4, 3, 2, 1) to find the global mode and worked in a coarse-to-fine manner. To further improve the quality of the color weight image, we extend the mean shift algorithm by exploiting background models of the scene. For moving platforms where the background is not available, we employ spatial context information to model the scene. According to human vision, the tracked object should be similar to the model meanwhile its surroundings should be different from the model [30]. We establish a new spatial context model to implement this visual mechanism so that the optimization results are a set of weights which can be computed pixel by pixel. Combined with the above extension, a novel method called CIG is proposed since it computes the color weight image employing spatial Context Information and Global tracking skills. We show that weight images obtained by CIG have higher stability and precision than those of current methods especially for low-contrast scenes with complex motions. Our main contributions include:
                        
                           •
                           We reveal that color cue is more reliable under the condition “precise model+less precise candidate enclosing the object”. We implement this idea by simply enlarging the candidate scales borrowing from global tracking techniques to meet the condition. This method differs from current ones to our knowledge.

A new spatial context model is proposed to exploit background models of the scene for moving platforms. The proposed spatial context model can be fused into a single mean-shift-based tracker, thus the optimization results are a set of weights which can be computed pixel by pixel.

This paper is outlined as follows. The profiles of the tracking algorithm are reviewed in Section 2. In Section 3, the inherent drawbacks of the classical mean shift are analyzed. Global tracking skills and spatial context information are then explored to improve the quality of weights in Sections 4 and 5, respectively. Section 6 presents experimental results on various videos. Finally, the conclusion of the paper is stated in Section 7 with a discussion of some significant issues.

Mean shift algorithms [10] usually use comparisons between color histograms to obtain the weight image. Then, mean shift procedure and scale update methods are employed to get the target position and scale, respectively. Finally, target models are updated using tracking results to cope with viewpoint and illumination changes.

Let x
                        0 be the initial object position, q
                        ={q
                        
                           u
                        ∣u
                        =1,2,…,
                        m} and p(x
                        0
                        +Δx)={p
                        
                           u
                        (x
                        0
                        +Δx)∣u
                        =1,2,…,
                        m} be CWH that represent the target model and target candidate, respectively. CWH is calculated in RGB space with 16×16×16 bins, so m equals to 4096. With these definitions, the tracking algorithm can be represented as finding the best displacement Δx
                        ∗ that maximizes the similarity between q and p(x
                        0
                        +Δx):
                           
                              (1)
                              
                                 Δ
                                 
                                    
                                       x
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 arg
                                 
                                    
                                       
                                          max
                                       
                                       
                                          Δ
                                          x
                                       
                                    
                                 
                                 {
                                 ρ
                                 [
                                 q
                                 ,
                                 p
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 Δ
                                 x
                                 )
                                 ]
                                 }
                              
                           
                        
                     

In the classical mean shift algorithm [10], the Bhattacharyya coefficient is used to obtain a distance metric:
                           
                              (2)
                              
                                 ρ
                                 [
                                 q
                                 ,
                                 p
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 Δ
                                 x
                                 )
                                 ]
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          u
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       Δ
                                       x
                                       )
                                       
                                          
                                             q
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Using Taylor expansion approximations and gradient descent method, the above tracking problem can be transformed into a mean shift procedure on a weight image. The weight for a given color index u can be computed by [10]:
                           
                              (3)
                              
                                 
                                    
                                       w
                                    
                                    
                                       u
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   u
                                                
                                             
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   u
                                                
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Thus, the weight for each pixel in ROI (The ROI used in this paper is 4×4 times of the object scale at the previous frame) can be computed by finding its color index u and using distribution comparison of color index u according to Eq. (3).

Once the weight image is available, mean shift procedure can be employed to get the local mode. Several improvements to get the global maximum have been proposed, such as combined with SSD tracker [31] and particle filter [32], or employ global tracking skills such as annealed mean shift [28] and Adaptive Pyramid Mean Shift (APMS) [27]. We use APMS to estimate the target position since it can cope with camera vibrations and large object motions. In addition, APMS can decide the pyramid level adaptively, which can save lots of computational resources since motions or vibrations between adjacent frames are small for most instances.

Scale selection is difficult for algorithms like mean shift, which use a global color model of the target. A traditional way adapts window size by a fixed percentage and evaluates it using Bhattacharyya coefficient [10]. Although this does stop the window from growing too big, it is insufficient to keep the window from shrinking too much. Collins [11] proposes a method to generate a combined model which captures features at different scales. Then, mean shift is applied in the spatial and scale dimensions to the weight image, hence tracking blobs through scale space. Jiang et al. [33] prove that the kernel bandwidth can be determined by maximizing the lower bound of log-likelihood function of Bhattacharyya coefficient, and the adaptive bandwidth is finally calculated by weighted standard deviation along the X- and Y-directions, respectively. We utilize the method of Jiang et al. [33] to update the target scale due to its simplicity and efficiency.

The target model should be updated as the object may undergo changes in scale, shape and illumination during the tracking process. The similarity measure between the model and the candidate at the current location is often used to update the model [23,31]. Another strategy is to use Kalman filters to filter object kernel histogram so as to obtain an optimal estimation of the model [34,35]. These methods make trade-off between adaptation to rapid changes and robustness to changes due to occlusion. In this paper, we adopt the similarity measure to update the target model.

Let q
                        
                           t−1 be the color model at the previous frame, p
                        
                           obj
                         be CWH within the acquired object region at the current frame. Then, the color model q
                        
                           t
                         at current frame can be updated by:
                           
                              (4)
                              
                                 
                                    
                                       q
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       q
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       γ
                                       [
                                       1
                                       -
                                       ρ
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             obj
                                          
                                       
                                       )
                                       ]
                                    
                                 
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       obj
                                    
                                 
                                 -
                                 
                                    
                                       q
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 )
                              
                           
                        where γ is a parameter that controls the model update rate with a default value of 15 in this paper, and ρ(q,
                        p) is the similarity function between q and p using the Bhattacharyya coefficient.

The color weight image of mean shift algorithm in Eq. (3) has been widely used in many applications. However, it cannot cope with low-contrast scenes involving complex motions such as VIVID sequences [36]. This indicates that there may be some inherent drawbacks in the weight image generation process. This section demonstrates and analyzes the underlining reasons for the failure and points out possible directions to improve performances.

Suppose the foreground and background distributions are represented by color histograms H
                        
                           f
                        (u) and H
                        
                           b
                        (u){u
                        =1,2,…,
                        m}, respectively. Color histogram is employed because of its high flexibility in representing probability distributions. In tracking applications, the target model q(u) and the target candidate p(u) in Eq. (3) can be approximately seen as combinations of H
                        
                           f
                        (u) and H
                        
                           b
                        (u):
                           
                              (5)
                              
                                 q
                                 (
                                 u
                                 )
                                 =
                                 α
                                 
                                    
                                       H
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 u
                                 )
                                 +
                                 (
                                 1
                                 -
                                 α
                                 )
                                 
                                    
                                       H
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 u
                                 )
                              
                           
                        
                        
                           
                              (6)
                              
                                 p
                                 (
                                 u
                                 )
                                 =
                                 β
                                 
                                    
                                       H
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 u
                                 )
                                 +
                                 (
                                 1
                                 -
                                 β
                                 )
                                 
                                    
                                       H
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 u
                                 )
                              
                           
                        
                     

In practice, we are only interested in relatively strong colors. That is too say, a color belongs to object if the occurring frequency in object is higher than that in background. For objects which have some parts similar to background, these colors give no contribution for tracking, thus can be categorized as background pixels. Though losing some generality, tracking by only using relatively strong object colors works well for most applications. Let u
                        
                           f
                         and u
                        
                           b
                         be the relatively strong color elements from foreground and background, respectively. The following relationship holds: H
                        
                           f
                        (u
                        
                           f
                        )>
                        H
                        
                           b
                        (u
                        
                           f
                        )⩾0, H
                        
                           b
                        (u
                        
                           b
                        )>
                        H
                        
                           f
                        (u
                        
                           b
                        )⩾0. Thus:
                           
                              (7)
                              
                                 
                                    
                                       H
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       f
                                    
                                 
                                 )
                                 
                                    
                                       H
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       b
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       H
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       b
                                    
                                 
                                 )
                                 
                                    
                                       H
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       f
                                    
                                 
                                 )
                                 >
                                 0
                              
                           
                        
                     

In most applications, the target model usually includes a few background pixels (α
                        >0) because the target may be oblique, not rectangular, or with imperfect initializations. From the above assumptions, we can draw several interesting yet surprising conclusions:
                           
                              •
                              For nearly zero motion displacements, target model and target candidate may have similar precision (α
                                 ≈
                                 β). As a result, all color elements have similar weights approximated to 1, and weights for color elements with a low probability may be unstable. Thus, the tracker may drift under clutter scenes.

For too large motion displacements, target candidate may contain no or loss parts of object colors. In this case, the weights for lost color elements will be 0 and the tracker fails.

For in-between motion displacements, target candidate contains more background pixels than target model, thus is less precise (0<
                                 α
                                 <
                                 β). According to Eqs. (5)–(7), we can get the following relationship after simple manipulations: q(u
                                 
                                    f
                                 )p(u
                                 
                                    b
                                 )>
                                 q(u
                                 
                                    b
                                 )p(u
                                 
                                    f
                                 ). Thus,
                                    
                                       (8)
                                       
                                          w
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                f
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                
                                                   
                                                      q
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            f
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      p
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            f
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          >
                                          w
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                b
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                
                                                   
                                                      q
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            b
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      p
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            b
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

It can be seen from (8) that the weight of u
                                 
                                    f
                                  is higher than that of u
                                 
                                    b
                                  for in-between motions. Therefore, reliable tracking results can be acquired in this case.

From the previous subsection, we can conclude that the weight of u
                        
                           f
                         is higher than that of u
                        
                           b
                         when target model is more precise than target candidate. In a similar way, we can testify that target model should be more precise than target candidate to ensure that the weight of u
                        
                           f
                         is higher than that of u
                        
                           b
                        . Thus, the relative precision between target model and target candidate is the main decision factor for the quality of the weight image.

We now investigate the effects with different target candidate precision, since target candidate may change abruptly due to camera vibrations and illumination changes, whereas target model is usually updated smoothly. The foreground weight strength relative to the background one can be represented as:
                           
                              
                                 
                                    
                                       w
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             f
                                          
                                       
                                       )
                                    
                                    
                                       w
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             b
                                          
                                       
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             [
                                             α
                                             
                                                
                                                   H
                                                
                                                
                                                   b
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   f
                                                
                                             
                                             )
                                             +
                                             (
                                             1
                                             -
                                             α
                                             )
                                             
                                                
                                                   H
                                                
                                                
                                                   f
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   f
                                                
                                             
                                             )
                                             ]
                                             [
                                             β
                                             
                                                
                                                   H
                                                
                                                
                                                   b
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   b
                                                
                                             
                                             )
                                             +
                                             (
                                             1
                                             -
                                             β
                                             )
                                             
                                                
                                                   H
                                                
                                                
                                                   f
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   b
                                                
                                             
                                             )
                                             ]
                                          
                                          
                                             [
                                             β
                                             
                                                
                                                   H
                                                
                                                
                                                   b
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   f
                                                
                                             
                                             )
                                             +
                                             (
                                             1
                                             -
                                             β
                                             )
                                             
                                                
                                                   H
                                                
                                                
                                                   f
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   f
                                                
                                             
                                             )
                                             ]
                                             [
                                             α
                                             
                                                
                                                   H
                                                
                                                
                                                   b
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   b
                                                
                                             
                                             )
                                             +
                                             (
                                             1
                                             -
                                             α
                                             )
                                             
                                                
                                                   H
                                                
                                                
                                                   f
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   b
                                                
                                             
                                             )
                                             ]
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   f
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   f
                                                
                                             
                                             )
                                             
                                                
                                                   H
                                                
                                                
                                                   b
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   b
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   H
                                                
                                                
                                                   b
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   f
                                                
                                             
                                             )
                                             
                                                
                                                   H
                                                
                                                
                                                   f
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   b
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   f
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   f
                                                
                                             
                                             )
                                             -
                                             β
                                             [
                                             
                                                
                                                   H
                                                
                                                
                                                   f
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   f
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   H
                                                
                                                
                                                   b
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   f
                                                
                                             
                                             )
                                             ]
                                          
                                       
                                       -
                                       [
                                       
                                          
                                             H
                                          
                                          
                                             b
                                          
                                       
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             b
                                          
                                       
                                       )
                                       -
                                       
                                          
                                             H
                                          
                                          
                                             f
                                          
                                       
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             b
                                          
                                       
                                       )
                                       ]
                                    
                                 
                                 .
                              
                           
                        
                     

Here, C
                        
                           α
                         is a factor which is independent on β. It can be seen that a larger value of β results in a better foreground weight strength. This means that target candidate with a low precision is suitable for reliable object tracking. For real scenes, though color histogram can represent arbitrary probability distributions, spatial layout of color elements can influence the accuracies of assumptions (5) and (6). Nevertheless, the above analysis just intends to explore the basic rules for possible directions to improve the performance of mean shift. Experimental results on various real videos in Section 6 validate the reasonability of the rules.

Based on the above analysis, the representations of target model and target candidate should obey the following rules:
                           
                              •
                              
                                 Target model should be as precise as possible. In [27,41], BWH is selected for target model whereas CWH is employed for target candidate. Since BWH suppresses surrounding background colors from the model, target model in these methods is more precise than target candidate, thus the tracker is more reliable.


                                 Target candidate with lower precision and enclosing the object at the same time is preferred.Global tracking skills such as annealed mean shift [28,29] or pyramid mean shift [27] are implemented in a coarse-to-fine manner. A large scale for target candidate is used at the coarse level, including foreground pixels into target candidate and making target candidate less precision, thus results are improved.

The above two rules are called “precise model+less precise candidate enclosing the object” for short in this paper.

The classical mean shift tracking algorithm intends to estimate an optimal displacement Δx
                        ∗, so that the target candidate p(x
                        0
                        +Δx
                        ∗) at the new location best matches the target model q. The tracking is regarded as a block-comparison problem, which somewhat violates the mechanism of human vision [30]. Instead, humans usually lock an object first by focus, and then by comparison. A large scale is used to place the whole object into the ROI and to make the object and its surroundings visibly discriminable. Focuses are given to regions which are more similar to object model than to the environments. As for target tracking applications, a large scale can be used to estimate target candidate representing the characteristics of visibly discriminable object and its surroundings. High weights will be given to colors which have higher probability to occur in target model than in target candidate. This property is termed as global tracking skills. The weights using this skill can be calculated by simply enlarging the target candidate scales:
                           
                              (9)
                              
                                 
                                    
                                       w
                                    
                                    
                                       g
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          u
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   u
                                                
                                             
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   u
                                                
                                                
                                                   s
                                                
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 δ
                                 [
                                 b
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 -
                                 u
                                 ]
                                 ,
                                 
                                 s
                                 >
                                 1
                              
                           
                        where s is a scale factor, δ is the Kronecher delta function, b(x
                        
                           i
                        ) is the serial number of histogram bin for x
                        
                           i
                        , and p
                        
                           s
                        (x) is the CWH within bandwidth sh:
                           
                              (10)
                              
                                 
                                    
                                       p
                                    
                                    
                                       u
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                sh
                                             
                                          
                                       
                                    
                                 
                                 k
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                x
                                                -
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                sh
                                             
                                          
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 δ
                                 [
                                 b
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 -
                                 u
                                 ]
                              
                           
                        
                     

Here, C
                        
                           s
                         is a normalization constant to make the probabilities sum to 1, n
                        
                           sh
                         is the number of pixels within bandwidth sh, and k(x) is a profile function. When s equals to 1, Eq. (10) is the classical mean shift color cue and we denote the expression in this case as p(x).

This extension has two desirable properties. Firstly, for large motion displacements, there exists a proper s so that the whole object regions are within bandwidth sh. In this case, there are object pixels in both p
                        
                           s
                         and q, and that q is more precise than p
                        
                           s
                        , thus the weight is reliable. Secondly, for near-zero motion displacements, a value of s larger than 1 can make p
                        
                           s
                         less precise. Thus, q is more precise than p
                        
                           s
                        , and the tracker will be stable.

@&#DISCUSSIONS@&#


                        Comparison to classical mean shift and FBR 
                        [10,16]. Fig. 1
                         shows the main differences between classical mean shift, FBR, and the proposed global mean shift. FBR uses regions surrounding the predicted object to estimate background distribution b(u), and the weight can be represented as:


                        
                           
                              
                                 
                                    w
                                 
                                 
                                    fbr
                                 
                              
                              (
                              u
                              )
                              =
                              log
                              
                                 
                                    q
                                    (
                                    u
                                    )
                                 
                                 
                                    b
                                    (
                                    u
                                    )
                                 
                              
                           
                        
                     

Since q(u) and b(u) cannot be estimated accurately for large motions, the weights may be affected in this case. In addition, noisy colors can make the ratio unstable. On the contrary, our method can be approximately represented as:
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       g
                                    
                                 
                                 (
                                 u
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             q
                                             (
                                             u
                                             )
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             q
                                             (
                                             u
                                             )
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   -
                                                   1
                                                   )
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             b
                                             (
                                             u
                                             )
                                          
                                       
                                    
                                 
                                 =
                                 s
                                 
                                    
                                       1
                                       -
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             1
                                          
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             1
                                             +
                                             q
                                             (
                                             u
                                             )
                                             /
                                             b
                                             (
                                             u
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     

It can be seen that w
                        
                           fbr
                        (u) and w
                        
                           g
                        (u) have the same trends. The main differences are: (1) distributions of 
                           
                              
                                 
                                    q
                                    (
                                    u
                                    )
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    1
                                    )
                                    b
                                    (
                                    u
                                    )
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                         can be approximated more reliably than those of b(u); (2) for arbitrary colors including noisy colors, the weights are bounded by [0,
                        s]. Thus, weight images by global mean shift are more reliable than those by FBR.


                        Comparison to CBWH 
                        [41]. CBWH employs BWH and CWH for target model and target candidate, respectively. By using BWH, a more precise target model can be acquired. However, CBWH may fail when the displacement is large since there may be no object pixels in the candidate. Thus, CBWH is only stable when the displacement is small. Instead, our method is competent for both large and small displacements. According to the rules in Section 3, a combination of CBWH and the proposed global mean shift may further improve the performance.


                        Comparison to FUSION method 
                        [40]. Recently, Wang et al. combine methods of CWH and FBR to get the fused weight image (called FUSION method), given by:
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       fusion
                                    
                                 
                                 (
                                 u
                                 )
                                 =
                                 
                                    
                                       q
                                       (
                                       u
                                       )
                                    
                                    
                                       b
                                       (
                                       u
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             q
                                             (
                                             u
                                             )
                                          
                                          
                                             p
                                             (
                                             u
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Since there may be no object pixels in the candidate when the displacement is large, FUSION method may fail in this case. In addition, the use of 
                           
                              
                                 
                                    q
                                    (
                                    u
                                    )
                                 
                                 
                                    b
                                    (
                                    u
                                    )
                                 
                              
                           
                         instead of 
                           
                              log
                              
                                 
                                    q
                                    (
                                    u
                                    )
                                 
                                 
                                    b
                                    (
                                    u
                                    )
                                 
                              
                           
                         magnifies noisy colors which can make the ratio unstable. Thus, weight image by FUSION method may have a few extremely large values which would attract the mean shift process to such undesired values. Instead, the proposed method can overcome these drawbacks.

Caulfield [42] showed that the reliability for mean-shift-based trackers was increased considerably by exploiting background models of the scene. He employed background modeling method for surveillance domain under static cameras to get background models of the scene. For moving platforms, we propose here to use spatial context information to model the scene. A tracker could be more discriminative when q and p(x) have a good match while the match between q and its surrounding regions is poor. Given an initial point x
                     0, the problem of object tracking with spatial context information can be expressed as:
                        
                           (11)
                           
                              Δ
                              
                                 
                                    x
                                 
                                 
                                    ∗
                                 
                              
                              =
                              arg
                              
                                 
                                    
                                       max
                                    
                                    
                                       Δ
                                       x
                                    
                                 
                              
                              
                                 
                                    
                                       ρ
                                       [
                                       q
                                       ,
                                       p
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       Δ
                                       x
                                       )
                                       ]
                                       -
                                       ρ
                                       
                                          
                                             
                                                q
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      c
                                                   
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      0
                                                   
                                                
                                                +
                                                Δ
                                                x
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Here, p
                     
                        c
                     (x) is the color cue of spatial context information at position x:
                        
                           (12)
                           
                              
                                 
                                    p
                                 
                                 
                                    c
                                 
                              
                              (
                              x
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                              
                              p
                              (
                              x
                              +
                              
                                 
                                    d
                                 
                                 
                                    p
                                 
                              
                              )
                           
                        
                     where d
                     
                        p
                     {p
                     =1,…,
                     N
                     
                        p
                     } are the vectors that are equally spaced on the ellipse with bandwidth 2h as shown in Fig. 2
                     . N
                     
                        p
                      is the number of sampling regions and is set as 4 in all experiments.

Traditional methods usually use a background region simply surrounding the target region sharing the common center with the target as shown in Fig. 1(b) [16,23,37]. The regions in Fig. 2 are employed due to the following reasons:
                        
                           •
                           The mean shift tracking algorithm is based on kernel density estimation, whereas the ring shapes of traditional methods make them difficult to apply a kernel.

Since weights near the kernel boundary are low in the proposed model, fewer object pixels will be included to p
                              
                                 c
                              (x) when the prediction is not precise.

Using this model, the optimization problem (11) results in a novel color weight image, which can be computed efficiently pixel by pixel. The sticking point is that using linear combinations of background blocks (with the same dimensions as those of target object) allows the optimization problem reduced to a kernel density estimation problem as is shown below.

Using Bhattacharyya coefficient in Eq. (2) as the similarity measure and employing Taylor expansions around the values p(x
                     0) and p
                     
                        c
                     (x
                     0) similar to the classical mean shift tracking algorithm, the maximization problem in (11) can be expressed as:
                        
                           
                              
                                 
                                    x
                                 
                                 
                                    ∗
                                 
                              
                              =
                              arg
                              
                                 
                                    
                                       max
                                    
                                    
                                       x
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                u
                                                =
                                                1
                                             
                                             
                                                m
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      u
                                                   
                                                
                                                (
                                                x
                                                )
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  q
                                                               
                                                               
                                                                  u
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  u
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                -
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  q
                                                               
                                                               
                                                                  u
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  u
                                                               
                                                               
                                                                  c
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         p
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      u
                                                   
                                                
                                                (
                                                x
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Let k(x) be a profile function. A piece-wise profile called Epanechnikov profile [38] is adopted in this paper due to its low computational complexity and fast convergence rates. According to [10], CWH can be expressed as:
                        
                           
                              
                                 
                                    p
                                 
                                 
                                    u
                                 
                              
                              (
                              x
                              )
                              =
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                              
                              k
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         -
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              δ
                              [
                              b
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              -
                              u
                              ]
                           
                        
                     
                     
                        
                           
                              
                                 
                                    p
                                 
                                 
                                    u
                                 
                              
                              (
                              x
                              +
                              
                                 
                                    d
                                 
                                 
                                    p
                                 
                              
                              )
                              =
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                              
                              k
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         x
                                                         +
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                         )
                                                         -
                                                         (
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              δ
                              [
                              b
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    d
                                 
                                 
                                    p
                                 
                              
                              )
                              -
                              u
                              ]
                              =
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                              
                              k
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         -
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              δ
                              [
                              b
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    d
                                 
                                 
                                    p
                                 
                              
                              )
                              -
                              u
                              ]
                           
                        
                     
                  

Here, C
                     1 is a normalization constant to make the probabilities sum to 1. Thus, the right-hand side of the optimization problem can be expressed as:
                        
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       u
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       x
                                       )
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       -
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         u
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                p
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       x
                                       +
                                       
                                          
                                             d
                                          
                                          
                                             p
                                          
                                       
                                       )
                                    
                                 
                              
                              =
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                u
                                                =
                                                1
                                             
                                             
                                                m
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  q
                                                               
                                                               
                                                                  u
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  u
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                δ
                                                
                                                   
                                                      
                                                         b
                                                         (
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                         -
                                                         u
                                                      
                                                   
                                                
                                                -
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  q
                                                               
                                                               
                                                                  u
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  u
                                                               
                                                               
                                                                  c
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         p
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                   
                                                
                                                δ
                                                [
                                                b
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                                -
                                                u
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                              k
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         -
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Thus, the optimization problem (11) is a density estimation problem, and the local mode can be found through mean shift procedure. This results in a novel color weight image expressed as:
                        
                           (13)
                           
                              
                                 
                                    w
                                 
                                 
                                    ci
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       u
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       δ
                                       [
                                       b
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       -
                                       u
                                       ]
                                       -
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         u
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                p
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                       δ
                                       [
                                       b
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             d
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       -
                                       u
                                       ]
                                    
                                 
                              
                           
                        
                     
                  

The conditions p
                     
                        u
                     (x
                     0)>0 and 
                        
                           
                              
                                 p
                              
                              
                                 u
                              
                              
                                 c
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           )
                           >
                           0
                        
                      for all u
                     =1,…,
                     m can always be enforced by not using the feature values in violation. According to Eq. (13), the weight at a pixel is the difference between basic mean shift feature and the similarity to its neighbors equally spaced on the ellipse with bandwidth 2h as shown in Fig. 3
                     . Thus, the weight can be computed pixel by pixel with a small number of neighboring operations.

To accelerate the tracking algorithm, only positive weights are considered. Thus, if the mean shift feature at a point is equal to 0, the second term in Eq. (13) does not need to be computed. As a result, only a portion of the ROI computes both terms.

Combining the above two extensions, the color weight image used in this paper, which employs spatial Context Information and Global tracking skills (CIG), can be expressed as:
                        
                           (14)
                           
                              
                                 
                                    w
                                 
                                 
                                    CIG
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       u
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         u
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       δ
                                       [
                                       b
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       -
                                       u
                                       ]
                                       -
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         u
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                p
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                       δ
                                       [
                                       b
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             d
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       -
                                       u
                                       ]
                                    
                                 
                              
                           
                        
                     The main steps to calculate the color weight image with CIG are given in Fig. 4
                     .


                     Fig. 5
                      shows typical weight images in ROI based on classical color cue, color cue with global tracking skills and color cue by CIG, respectively. It can be observed that foreground weight strengths are improved by leveraging global tracking skills. The background clutters are further suppressed by utilizing spatial context information.

@&#EXPERIMENTAL RESULTS@&#

In Section 3, we show that classical mean shift may be unstable when motion displacements are too small or too large. Here, real tracking videos are used to verify the exploitation and discuss the effects of different scale parameter values for CIG. In order to simulate different motions, we sample the sequences by factors of 1, 4, 8, 12, 16, and 20, respectively. Using these factors, the model is initialized at frame 0, and the candidate is acquired within the rectangle of frame 0 at frames 1, 4, 8, 12, 16, and 20, respectively. In this way, typical weight images under different motions and scale parameters (1.0, 2.0, 3.0, 4.0) can be obtained. These motions usually change from small to large and the weight images can reflect the capability of the tracker to cope with complex motions.


                        Fig. 6
                         shows typical ROI images and weight images by CIG using the specified different scale parameters and sample intervals for “egtest02” sequence. It can be observed that: (1) For classical mean shift (s
                        =1.0), the quality of weight images get better for sample intervals smaller than 8 and change worse for sample intervals larger than 12. The results show that classical mean shift is only stable for in-between motions. (2) The visual quality of weight images for CIG is greatly improved by increasing the scale parameter s. For a larger value of s, object evidences in weight images are obviously enhanced. This illustrates that target candidate with a larger scale makes the model relatively more precise, thus weights for object pixels have high values.

We now analyze why weights on the object region are small for “egtest02” sequence at frame 1 by the classical mean shift method. As shown in Fig. 7
                        , the target model contains car pixels as well as road and shadow pixels. In addition, road edge clutters have similar brightness values to parts of car transition pixels. When the motion displacement is small, target model and target candidate have similar precisions. As a result, the weight for bins with a low probability may be unstable as shown in Fig. 7(c). The maximum weight occurs when both values of target model and target candidate are small, and coincidentally the road edge clutters have the same brightness values. In addition, the weights of road pixels are comparable to those of car pixels. Thus, the weight image is unreliable in this case. On the contrary, the weights are very small for road pixels and are relatively stable for non-road pixels when s
                        =4 as shown in Fig. 7(e). This demonstrates that the reliability of weight image can be improved by using a large scale for target candidate.


                        Figs. 8 and 9
                        
                         show several typical ROI images and color weight images by CIG using different scale parameters and different sample intervals for “egtest03” and “egtest04” sequences, respectively. It can be seen that the visual quality of weight images in these low-contrast scenes is greatly improved for CIG by increasing the scale parameter s. The results further validate the drawbacks of classical mean shift and the effectiveness of CIG. In addition, CIG can cope with different motion displacements well, thus can be used in applications such as UAV surveillance where the camera may vibrate frequently.


                        Fig. 10
                         shows the tracked percentages of datasets with color cue by CIG using different scale parameters. The tracked percentage is defined as the ratio of tracked frames before first failure to total frames. It can be seen that the tracked percentages are greatly improved for most sequences by increasing the scale parameter s. By calculating the target candidate with a large scale, the target model is more precise than target candidate, thus improving the foreground weight strength of the color weight image. However, a large s increases the computational complexity. A tradeoff should be made and a value of 4 for s is suitable for tracking applications.

In this subsection, weight images generated by CIG are compared to those of classical mean shift [10]], FBR [16], and CBWH [41] using real videos. To make the comparisons comparable, target model is calculated using image data within ground-truth rectangle at the previous frame. 
                        Fig. 11
                         shows typical ROI images and corresponding color weight images by these methods at frames 1301, 601, and 901 for “egtest01” sequence. It can be seen that: (1) Weight images by FBR, CBWH and CIG are better than that of classical mean shift. This explains why most current methods get weight image by FBR. (2) Weight images by CIG and CBWH have less noise than that of FBR. (3) The object evidence of weight image by CIG is stronger than that of CBWH. Overall, weight images by CIG are the best among these methods.

We now investigate the performances of these methods under different motions. Again, the sampling strategy is employed to simulate various motion displacements. Fig. 12
                         shows typical ROI images and color weight images by different weight generation methods and different sample intervals for “egtest05” sequence. We can see that weight images by FBR get worse as the sample interval increases. The reason is that foreground estimations are inaccurate when large motions occur. We believe that establishing long-time models of foreground and background can improve the performances for FBR under large motions. Another interesting discovery is that methods of classical mean shift and FBR are reciprocal when the motion displacement is not too large, and thus fusing these two results would benefit the tracking results. On the contrary, weight images by CIG are very stable for various motion displacements, thus are conformable for tracking objects under complex motions or camera vibrations.


                        Fig. 13
                         shows typical ROI images and the corresponding color weight images by these methods at frames 1, 91, and 121 for “person” sequence. It can be seen that weight images by CIG are the best among these methods. This indicates that weight images by CIG are superior to those by other methods for both rigid and non-rigid objects.

In this subsection, we compare the tracking results by CIG to those of MS (classical mean shift) [10], FBR [16], CBWH [41] and FUSION [40]. For MS, we do not update the target scale, since scale update is not stable for it. For FBR, we implement FBR by keeping track of the appearance of the foreground and background. Thus, foreground and background distributions by FBR in this comparative study are more reliable than those in [16], making the comparisons more convincing. For CBWH and FUSION, the methods in the reference papers are implemented with an additional scale update process as shown in Section 2.3.

Two test sequences are selected to evaluate our method under clutter scenes by comparing it with MS, FBR, CBWH and FUSION. The video sequences are captured by humans from a training plane flying on Nanchang, China. In the first sequence, the contrast between the target and background is very low, whereas in the second one, there is another object with similar colors to the tracked one. Fig. 14
                            shows typical tracking results for these methods. As shown in this figure, CIG, FBR and FUSION track targets successfully, whereas MS and CBWH fail at last. In addition, the tracking accuracy of CIG and FBR is higher than that of FUSION.

Another two test sequences are selected to evaluate our method under scale and appearance changes by comparing it with MS, FBR, CBWH and FUSION. The fist video sequence is captured by humans from a training plane flying on Nanchang, China, whereas the second one is captured by a hand-held Sony EVI-D70P camera with image card MV-U2000 on the top of a 13th building, Beijing, China. In these sequences, the targets undergo scale and appearance changes. Fig. 15
                            shows typical tracking results for these methods. As shown in this figure, CIG and FBR track targets successfully, whereas MS, CBWH and FUSION may fail at last.

We now use different target initialization sizes to evaluate our method under initialization errors by comparing it with MS, FBR, CBWH and FUSION. The sequence is downloaded from the web-site: http://procerusuav.com/gallery.php/. In this sequence, relatively precise, large and small target initialization sizes are applied. Fig. 16
                            shows typical tracking results under each case for these methods. As shown in this figure, CIG, CBWH and FBR track targets successfully, whereas MS and FUSION may fail at last.

Next, we evaluate our method under large motions by comparing it with MS, FBR, CBWH and FUSION. In this case, we leverage the mean shift process in Section 2.2 for all methods. The original sequence is downloaded from the web-site: http://procerusuav.com/gallery.php/. To simulate large motions, we sample the sequence with intervals of 5 and 10 frames and run the tracking algorithms on the sampled sequences, respectively. Fig. 17
                            shows typical tracking results on the sampled sequences for these methods. As shown in this figure, only CIG track targets successfully, whereas MS, CBWH, FBR and FUSION may fail at last.

Finally, we test CIG against MS, FBR, CBWH and FUSION for tracking non-rigid objects. Fig. 18
                            shows typical tracking results on the CAVIAR datasets. As shown in this figure, all methods can track successfully for the “EnterExitCrossingPaths1cor” sequence. For the sequence “Split”, CIG can track the target before frame 330, whereas MS, CBWH, FBR and FUSION fail after frame 60.


                           Table 1
                            summarizes the above results for MS, FBR, CBWH, FUSION and CIG. It can be seen that: (1) CIG and FBR are better than MS, CBWH and FUSION; (2) CIG has better or similar performances compared to FBR under clutter scenes, scale and appearance changes, and initialization errors; (3) CIG has best performance under large motions. Thus, weight images by CIG have higher stability than current methods especially under low-contrast scenes with complex motions.

Some tracking failures of the proposed method are shown in Fig. 19
                           . In these cases, the object is occluded for a long time or there is a similar object in color nearby. Our current method cannot solve these problems since CIG only focuses on the weight image generation stage.

The tracking results by CIG are compared with MS, FBR, CBWH and FUSION on VIVID sequences using the measure of tracked percentages. The comparison results are shown in Fig. 20
                           . The proposed tracker gets great performance improvements over others for “egtest02”. It gives similar results to CBWH for all the other sequences. CIG gets worse results for “egtest05” and better results for “egtest02” and “egtest04” compared to the FUSION tracker. Overall speaking, the tracking results by CIG are better than those of MS, FBR, CBWH and FUSION.

As for the efficiency, we test the computation time of the tracking algorithm on a 2.4GHz Duo processor with 2.0GB memory. The average costs for sequence “egtest02” by CIG-based tracker are 2.9ms (the image size is 640 by 480, and the target size is about 30 by 30). For objects with a large scale, users can employ down sampling method before tracking. In this way, the proposed method is efficient enough to apply to on-board environments.

@&#CONCLUSIONS@&#

The inherent drawbacks of the color cue in mean shift are analyzed. We show that target model should be far more precise than target candidate to achieve reliable tracking results. Based on this idea, a novel color cue for computing color weight image is proposed by employing spatial Context Information and Global tracking skills (CIG). Experimental results on various sequences show that the proposed method is effective under clutter scenes with complex motions for both rigid and non-rigid objects.

To further improve the performance, we will investigate on how to adjust the value of the scale of the kernel to optimize performance according to conditions and the motion of the target object. In addition, shadow removal methods will be investigated in future works to decrease the influence of shadows. Efforts will also be given on occlusion detection and localizing the object when it reappears after long time occlusions.

@&#ACKNOWLEDGMENTS@&#

This work is supported by National Natural Science Foundation of China (Nos. 61005028 and 61175032). We thank the anonymous reviewers for their insightful comments to improve the quality of the paper.

@&#REFERENCES@&#

