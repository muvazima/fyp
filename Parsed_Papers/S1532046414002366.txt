@&#MAIN-TITLE@&#Towards probabilistic decision support in public health practice: Predicting recent transmission of tuberculosis from patient attributes

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a probabilistic decision support algorithm for tuberculosis control.


                        
                        
                           
                           A logistic regression model was used to estimate the probability of transmission.


                        
                        
                           
                           Multiple imputation was used to estimate missing values of predictive features.


                        
                        
                           
                           Bayesian model averaging was performed to identify an accurate classification model.


                        
                        
                           
                           The performance of the model suggests that field application may be appropriate.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Decision support model

Statistical prediction

Public health

Tuberculosis

Transmission

@&#ABSTRACT@&#


               
               
                  Objective
                  Investigating the contacts of a newly diagnosed tuberculosis (TB) case to prevent TB transmission is a core public health activity. In the context of limited resources, it is often necessary to prioritize investigation when multiple cases are reported. Public health personnel currently prioritize contact investigation intuitively based on past experience. Decision-support software using patient attributes to predict the probability of a TB case being involved in recent transmission could aid in this prioritization, but a prediction model is needed to drive such software.
               
               
                  Methods
                  We developed a logistic regression model using the clinical and demographic information of TB cases reported to Montreal Public Health between 1997 and 2007. The reference standard for transmission was DNA fingerprint analysis. We measured the predictive performance, in terms of sensitivity, specificity, negative predictive value, positive predictive value, the Receiver Operating Characteristic (ROC) curve and the Area Under the ROC (AUC).
               
               
                  Results
                  Among 1552 TB cases enrolled in the study, 314 (20.2%) were involved in recent transmission. The AUC of the model was 0.65 (95% confidence interval: 0.61–0.68), which is significantly better than random prediction. The maximized values of sensitivity and specificity on the ROC were 0.53 and 0.67, respectively.
               
               
                  Conclusions
                  The characteristics of a TB patient reported to public health can be used to predict whether the newly diagnosed case is associated with recent transmission as opposed to reactivation of latent infection.
               
            

Tuberculosis (TB) is a communicable disease caused by Mycobacterium tuberculosis (MTB). Despite organized control efforts, TB continues to occur in developed countries. In Canada, TB is concentrated in immigrants from high TB incidence countries, inner-city residents, and Aboriginal persons [1]. Upon infection, approximately 90% of individuals remain asymptomatic and non-infectious with latent tuberculosis infection (LTBI). After months or years of latency, approximately 5–10% of persons with LTBI develop active TB disease due to a complex array of biological, genetic and environmental factors [2]. Individuals with reactivated TB can transmit infection to others in the absence of timely detection and intervention.

Contact investigation is a core public health strategy to prevent and control TB. It involves identification, medical evaluation, and treatment of individuals who have had contact with a newly diagnosed case, often called an index case. Evidence of recent infection or active TB disease among contacts suggests ongoing transmission, and treatment is provided to infected individuals to prevent subsequent active TB, thereby interrupting transmission.

A more recent approach to identifying TB transmission is DNA fingerprint analysis. With this approach, DNA is isolated from the MTB organisms cultured from patient samples. Mycobacterial DNA is then characterized with respect to the presence and number of target sequences; transmission is assumed to have occurred between cases with matching “fingerprints”. Although this method is capable of identifying transmission involving persons with limited contact, results can take weeks [3], and the method can be applied only to persons with active disease from whom it is possible to obtain a positive MTB culture. In particular, DNA fingerprinting is not able to establish transmission to individuals with LTBI, or to those with culture-negative active TB (a frequent manifestation in children, for example). For these reasons, contact investigation remains critical to the rapid assessment and interruption of transmission.

Ideally, contact investigation should be conducted for all infectious cases immediately upon diagnosis. In practice, however, limited resources in public health may necessitate prioritization of contact tracing among multiple infectious individuals. In general, patient features related to infectiousness, such as pulmonary and laryngeal disease, cavitary lesions on chest radiography, positive sputum acid fast smears, and younger age are considered when assessing the urgency of investigation [4].

Previous molecular epidemiological investigations of TB transmission have identified additional clinical and demographic predictors associated with involvement in transmission chains. These features include HIV infection, drug-resistant TB, homelessness, and intravenous (IV)-drug use [5]. The degree to which these features are used to prioritize contact tracing depends on the intuition and experience of public health officials, and the potential use of these patient features to predict the probability that a case is involved in recent transmission has not been explored.

Statistical and machine learning algorithms, which estimate the probability of an event as a function of input variables, can analyze many patient variables to assist medical decision making. Such prediction models can inform decisions about diagnosis and therapy when applied to patient data contained in electronic health records (EHR) [6]. Although the models are most frequently used for clinical decision support, their application in public health is rare. In TB control, using known risk factors for transmission associated with a newly diagnosed active TB case to predict recent transmission appears feasible and should aid timely and evidence-based decision making in prioritization of contact investigation.

The rapid identification of community transmission allows timely intervention. Although it is often considered the gold-standard for detection of transmission, the impact of DNA fingerprinting is hampered by its slow turnaround time. A decision-support tool that uses readily available clinical and demographic features of an active TB case would permit more rapid, evidence-based decision making in prioritizing contact investigation. As an initial step towards creating such a decision-support tool, we developed and evaluated a statistical learning model to estimate the probability of a given case of active TB being involved in recent transmission.

The data used to develop and evaluate the model were obtained from 1844 active TB cases reported to the public health department between January 1, 1996 and December 31, 2007 in Montreal, Quebec, Canada. In Quebec, as in all provinces in Canada and states in USA, every diagnosis of active TB must be reported by name to the local public health department along with standardized demographic, clinical, and microbiologic information. Hence, as part of routine public health practice, clinical and epidemiological data were collected by public health nurses from patients and treating clinicians and were stored in a database. We extracted these data in non-nominal form for our study, which was approved by the McGill Faculty of Medicine Institutional Review Board.

We used DNA fingerprinting based on the IS6110 target sequence, by restriction-fragment length polymorphism (RFLP) analysis, to assess the involvement of each case in recent transmission. IS6110 is a repetitive DNA sequence in the MTB genome, and its frequency and insertion location vary from one MTB strain to another. This sequence is highly preserved, however, as the bacteria propagate from one host to another, thus making it possible to identify the same MTB strain in cases belonging to a chain of transmission [7]. Based on standardized IS6110 – RFLP methodology [8], cases with MTB isolates that shared identical numbers and insertion locations of the IS6110 sequence were deemed members of the same TB “cluster.” Cases with unique IS6110 patterns were deemed unique. As the discriminative ability of the RFLP method is compromised for MTB strains with few copies of the IS6110 element [9], we used the results of a secondary genotyping method, spoligotyping, for strains that contain less than six IS6110 elements.


                        Table 1
                         lists the independent variables initially included in the prediction model, which were selected by review of previous epidemiological studies exploring transmission of TB. For the countries of origin variable, we created three categories: Canadian born, Haitian born, and born in other countries. In previous work, Haitian birth was identified as a risk factor for transmission in Montreal [10], hence we used a distinct category for these individuals. For the Area of residence variable, we used health administrative areas on the island of Montreal (Centres de santé et de services sociaux – CSSS) as a unit of the analysis. There are 10 CSSS areas in Montreal, and areas with a similar frequency of genotype-defined clustering were merged to create four areas of residence. Multi-drug resistant TB (MDR-TB) disease, which is resistant to at least two of the main anti-TB drugs, Isoniazid (INH) and rifampicin, has been most strongly associated with recent transmission [11–13]. However, MDR-TB disease rarely occurs in Canada [14], so we considered for inclusion in our model the more frequently observed INH resistance. The Previous diagnosis of TB variable included previous diagnosis of active disease and LTBI.

Because excluding the cases with missing data would reduce the size of the dataset and possibly introduce bias [15], we filled in the missing values using multiple imputation, which replaces missing information with plausible values drawn from a conditional distribution formed by the observed covariates [16]. We used fully conditional specification approach [17], where multivariable imputation model is specified for each incomplete variables. As an example, a linear regression model was fit to the observed data in order to predict the missing values of the continuous age variable. Similarly, logistic regression and multinomial regression models were specified to predict the missing values of binary and categorical variables. We used all the variables in our dataset shown in Table 1 as the predictor variables for the imputations models.

Imputation was repeated multiple times to generate m different complete datasets, each of which was used to train and test the model [16]. The resulting m measured performances of prediction and their corresponding variances were pooled into a single final estimate using Rubin’s rule [16]. In this study, 15 imputed datasets were created, which should be sufficient given the proportion of missingness [16]. We used the MICE (Multivariate Imputation by Chained Equation) package [18] in the R programming environment [19] to generate imputed datasets. Homelessness and Aboriginal status were not useful predictors and were not explored further, since both variables had a very large proportion of missing values. Missing values in all other predictors, including HIV infection, were imputed.

A logistic regression model was used to predict whether a given case was involved in recent transmission or was reactivation of LTBI. We selected logistic regression due to its wide recognition in the medical community [20], and its comparable classification performance to other methods such as artificial neural networks and support vector machines [21–24]. In addition, it provides a straightforward interpretation of the predictive power of independent variables in the form of an odds ratio [23].

Interaction of predictor variables may occur, so the plausibility of adding interaction terms was assessed by the following selection approach; the Bayesian Information Criterion (BIC) of a model containing all the predictors (i.e. main model) was compared to the BIC derived from the same model plus the interaction term. Lower BIC indicates better model fit, and BIC tends to penalize the larger model (i.e. the model with additional parameter) [25]. Therefore, the interaction term was considered a strong predictor if the model containing the term showed a lower BIC than the main model. Because BIC-based model selection is substantially more conservative than other statistical criteria such as Akaike’s Information Criterion and the likelihood ratio test due to its stronger penalization mechanism, we were less likely to select interaction terms resulting from noise of the development data. All possible combinations of two variables were tested in this fashion. We performed the screening of interaction terms before the model selection process described below, since testing all possible combinations of interaction terms by the model selection method (Bayesian Model Averaging) can result in a very large model space. As well, we assessed the linearity of the continuous age variable in relation to the logit of the dependent variable. To do this analysis, we used a fractional polynomial, which tests the feasibility of linear and various non-linear functions of continuous variables [26].

We identified the optimal model using Bayesian Model Averaging (BMA). BMA estimates the posterior probabilities of all possible models given the training data, chooses a set of candidate models according to their posterior probability distributions, and averages the coefficients of the selected models using the posterior probabilities as weights [27]. Posterior model probability for each of candidate models can be analytically approximated by BIC, as described by Hoeting et al. [27]
                        .
                     

BMA assumes that no single model will correctly explain the observed data and creates a synthetic model as an approximation to a true unobserved model. Unlike conventional model selection approach for generalized linear model, such as stepwise selection which bases inference and prediction on a single best model, BMA offers a solution to account for model uncertainly by averaging the coefficient of multiple models [27]. Compared to stepwise model selection, BMA was shown to perform superior in selecting collect model [28] and often estimate smaller standard deviations for the parameters of interest [29].

Instead of determining the effect of a predictor by its p-value from statistical significant test, BMA reports the posterior probability of each predictor. This value is simply the sum of the posterior probabilities of the models that contain a given variable, and represents the normalized probability of a coefficient having a non-zero value given the training data, P(β
                        ≠0|D). A posterior effect probability of more than 0.5 indicates evidence for the effect of a variable. For prediction, we included in the final model variables whose posterior effect probability were not zero. We implemented our model in the R programming environment using the BMA package [30].

The discriminative performance of the model was assessed by plotting the Receiver Operating Characteristic (ROC) curve and calculating the Area Under the ROC Curve (AUC). In addition, we calculated negative predictive value (NPV) and positive predictive value (PPV) of the model over a range of classification thresholds. All estimates were obtained through 10 repeats of 10-fold cross-validation. Since we generated 15 imputed datasets, we applied the ten repeats of 10-fold cross-validation to each of these imputed data sets, producing 15 sets of estimates (i.e. AUC, ROC, PPV, NPV, sensitivity, and specificity), which we pooled using Rubin’s rule [16].

@&#RESULTS@&#

Of the 1829 active TB cases reported to the public health department during the study period, we excluded cases with negative or missing culture results (199 cases, 10.9%), and culture positive cases with missing DNA fingerprinting results (78 cases, 4.3%), leaving 1552 cases (84.9%) to train and test the model. Of these 1552 cases, 314 (20.2% of the enrolled cases) were clustered according to IS6110 RFLP and spoligotyping. 107 distinct matching patterns were observed, representing 107 TB clusters. The vast majority of TB clusters (67%, or 72 clusters) consisted of 2 cases; in other words, most clusters contained only one putative secondary case. The small proportion of clustered cases suggests a low level of ongoing transmission in Montreal.


                     Table 2
                      shows the distributions of potential predictors among clustered and unique cases. An interaction term for Living in apartment and Cavitary lesion on chest X-ray was included in the prediction model, since the model containing the product of the two variables had a lower BIC than the model without it. No transformation of the continuous variable (Age) was needed, as the analysis of its functional relationship with the logit of the dependent variable by fractional polynomial suggested a linear relationship (data not shown).


                     Table 3
                      shows the regression coefficients and posterior effect probabilities of the predictors estimated by BMA. In general, most variables that we considered had strong evidence against their effects, as represented by the small values of their posterior effect probabilities. Age of the patients and residential location on the island of Montreal appeared to have modest positive evidence for an effect. Being Canadian or Haitian born appeared to be the strongest predictors of involvement in recent transmission. In addition, HIV infection and the interaction of living in an apartment and having cavitary TB disease showed strong positive evidence.


                     Fig. 1
                      presents the classification performance of the model as summarized by the ROC curve. The AUC of 0.65 (95% CI: 0.61–0.68) indicates that the performance is significantly superior to random prediction. The maximized accuracy of the model (the point of the curve closest to the top-left corner of the graph) is at a sensitivity of 0.53 and a specificity of 0.67.

As seen in Table 4
                     , the values of NPV remained substantially higher than the prevalence of unique cases in the original dataset throughout the range of the sensitivity (i.e. 0.8). On the other hand, PPV was lower than the prior probability of clustering (i.e. 0.2) except at very low sensitivity.

@&#DISCUSSION@&#

We assessed the feasibility of predicting whether a newly diagnosed TB case reported to the public health department was involved in a chain of recent transmission. The discriminative performance of the model we developed was superior to random prediction, suggesting that the model has some potential to aid decision-support in a public health practice setting. The probabilistic interpretation of the AUC of our model in the context of TB control is as follows: given two reported TB cases to public health authority, one being involved in recent transmission and the other being an isolated case, there is a 0.65 probability that the model will suggest the prioritization of the case involved in recent transmission. Even though an AUC of 0.65 may represent only a modest improvement over chance discrimination, the classification accuracy of our model is likely to be optimal for the available set of predictor variables at the time of diagnosis. Such a model has the potential to promote accurate and reproducible decision-making in situations where public health practitioners may have not received adequate training and may be forced to prioritize investigation of TB cases due to resource constraint in local health authorities. The strongest predictor of recent transmission is the interaction of cavitary lesion and living in apartment, followed by HIV infection. Age and the area of residence are found to have modestly predictive powers.

Across the range of the classification thresholds considered, the NPV was high, while the PPV was low. A decision-support algorithm based on this model is therefore likely to be most useful in identifying unique cases or excluding recent transmission. The low PPV may be due to a small number of strong predictors, which occur with a low frequency among cases involved in recent transmission.

A challenge associated with predicting recent TB transmission is the influence of many clinical and non-clinical variables on the process of transmission. Prediction of individual clinical outcomes usually considers individual characteristics, such as demographic variables, medical history, clinical observations, and laboratory data. Predicting disease transmission, however, is likely to be improved by the addition of features, such as susceptibility of contacts, dwelling characteristics that facilitate transmission, and the nature of interactions between a person with TB disease and his/her contacts. Although these data would likely improve transmission in our model, they are not captured routinely. Our research focused on attributes of cases that are readily available at the time the case is reported to public health authorities, thus allowing timely decision-making.

Utilization of prediction models to aid public health intervention is uncommon, and its application is largely limited to selective screening of case-finding activities for sexually transmitted infections [31]. A simple analogue of a decision support algorithm for the prioritization of contact investigation is the Syphilis Reactor Grid, a table algorithm to rank the investigation based on the age, sex, and laboratory result of a notified case [32]. Although simple to use, the amount of information incorporated into the decision algorithm is limited. In part, the difficulty of implementing prediction algorithm in daily public health practice is due to the unavailability of relevant patient attributes to public health department at the time of diagnosis. Increasing adoption of EHRs and the progress of health information exchange is opening new opportunities for local health departments to utilize the data in clinical information systems, from automated notification of reportable diseases and syndromic surveillance to beyond [33]. The interoperability between clinical and public health information systems would enable querying relevant clinical and demographic characteristics of reported case of notifiable disease for investigational purposes upon notification of reportable disease to local health department [34]. Such data can be immediately synthesized to generate the probability of recent transmission within the information system in local health departments, thereby promoting timely resource allocation for response, particularly in resource-limited settings.

Strengths of this study include the use of multiple imputation to simulate missing values. Without this method, we would have discarded more than 50% of observations due to the high proportion of missing status for HIV infection, leading to decreased precision and a potentially biased estimate of prediction if the distribution of input and dependent variables are associated with the missingness of the HIV status. In addition, recent transmission in our reference data was objectively determined by DNA fingerprint analysis.

Although specific in identifying clusters, DNA fingerprint-based investigation has its own limitations. Because the method is applicable only to culture-positive active TB cases, individuals who contracted latent infection only, and culture negative cases could not be included. For example, children are less likely to develop culture positive disease, and persons with LTBI who are uninfected by HIV are much less likely to develop active disease than those who are HIV-coinfected. Even though the proportion of active TB cases with missing or negative culture results was relatively small, we did not have systematic data on LTBI in contacts, so we could not use this as a complementary index of transmission for purposes of the present analysis.

Similarly, clusters defined by DNA fingerprinting do not necessarily capture transmission events that are already appropriately managed by successful identification, evaluation and treatment of latently infected contacts, since such contacts do not develop active disease. Therefore, in a setting where contact investigation is generally successful, as in Montréal, transmission events identified by genotyping tend to involve casual contacts, where links to a given index case may not be captured by interview, no matter how thorough. In addition, because active TB cases with well-known risk factors of transmission receive intense intervention (including treatment of infected contacts), further transmission and development of active disease among contacts are more likely to be prevented. Thus, the relationship of the risk factors and transmission is obscured in the presence of active intervention in the training data. Despite the little predictive power of clustering observed in our model, however, positive sputum smear plays a primary role in assessing the urgency of contact investigation in current public health practice [4]. In practice, the prioritization of investigation should be initially determined based on the established factors of infectiousness, and the probabilistic assessment of transmission by the model will subsequently aid ranking investigation based on other attributes, thus combining existing knowledge and predictive analysis.

Further research is required to measure the added value of the predictive model to a TB control program. The classification performance of the model was better than random prediction, but its performance relative to current practice (i.e. judgment as to the likelihood of transmission by public health practitioners) should be ascertained, preferably in prospective evaluation. How to translate the probabilistic output to the decision making in public health setting would depend on the balance of available public health resource, incidence of active tuberculosis and recent transmission, and the goal of local TB control program.

@&#CONCLUSIONS@&#

We have demonstrated that patient attributes available at the time of disease reporting can be used to predict whether a TB case reported to public health is involved in recent transmission. Models such as the one we developed have the potential to be embedded in a decision support tool and guide evidence-based public health practice. The use of such models and decision-support tools are likely to become increasingly feasible in the future as clinical and demographic data become rapidly available in an electronic format to public health authorities.

@&#ACKNOWLEDGMENTS@&#

The authors thank Ms. Fiona Macintosh and Mr. Carmine Rossi for providing the results of DNA fingerprint analysis and Ms. Kimberly Kotar for maintaining the tuberculosis database. The research in this paper was supported by the Canadian Institute of Health Research (MOP-93587 and MOP-84493).

@&#REFERENCES@&#

