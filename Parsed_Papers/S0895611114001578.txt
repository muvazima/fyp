@&#MAIN-TITLE@&#A robust and fast approach to simulating the behavior of guidewire in vascular interventional radiology

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           An approach to simulating the behavior of guidewire in vascular interventional radiology is proposed.


                        
                        
                           
                           Our approach works robustly and realistically under different vascular circumstances.


                        
                        
                           
                           Our approach is faster by proposing a force correction strategy which avoids endlessly repetitive collision detections.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Interventional radiology

Surgical simulation and training

Guidewire model

Vasculature

@&#ABSTRACT@&#


               
               
                  Interventional radiology (IR) is widely used in the treatment of cardiovascular disease. The manipulation of the guidewire and catheter is an essential skill in IR procedure. Computer-based training simulators can provide solutions to overcome many drawbacks of the traditional apprenticeship training during the procedure. In this paper, a physically-based approach to simulating the behavior of the guidewire is presented. Our approach models the guidewire as thin flexible elastic rods with different resolutions which are dynamically adaptive to the curvature of the vessel. More material characteristics of this deformable material are integrated into our discrete model to realistically simulate the behavior of the wire. A force correction strategy is proposed to adjust the elastic force to avoid endless collision detections. Several experimental tests on our simulator are given to demonstrate the effectiveness of our approach.
               
            

@&#INTRODUCTION@&#

It is well known that cardiovascular disease is the leading cause of deaths worldwide. Interventional radiology (IR) is widely used in the treatment of most cardiovascular disease. With fluoroscopic guidance, physicians can percutaneously insert flexible instruments (such as guidewire, stent, or catheter) into the patient's blood vessel and, from outside the body, manipulate these instruments through the vascular network until reaching the diseased position. Due to the complexity of the vascular network and the counter-intuitive movement of the instruments, performing an IR procedure is difficult, manipulating instruments in a 3D field while viewing them in a 2D screen, and thus requires a high degree of expertise to avoid causing serious injury to the patients.

As a result, physicians require a lot of training to acquire necessary skills such as hand-eye coordination of IR to ensure healthy outcomes. This medical training is traditionally obtained on live patients under the guidance of skilled physicians. However, the apprenticeship training is an expensive, unstructured, time-consuming and resource-intensive process lacking objective feedback [1,2]. Most importantly, learning the skill using real patients is risky and potentially fatal and a breach of ethnics.

Interactive virtual reality based simulators provide promising solutions to overcome many drawbacks of the apprenticeship training. With virtual simulators, trainees can practice the required skills anytime and anywhere without putting patients at risk and exposing themselves to an invasive environment. Moreover, the simulators are reusable. Unlike in vivo experimental training, it can assess the trainees’ performance objectively. However, developing a high-fidelity and real-time immersive virtual environment is a challenging task. Several companies or research groups devoted many efforts to virtual vascular IR simulators over the past years [3–6].

The simulation of guidewire and catheter is a crucial component in a vascular IR simulator. In a real vascular IR procedure, physicians manipulate the guidewire to the targeted position by pulling, pushing and rotating the proximal end of the guidewire. The marching direction of the guidewire is determined by the deformation of the guidewire's tip. However, the shape of the guidewire changes all the time as the guidewire is advanced through the vasculature due to its high flexibility. As a consequence, the direction is not easy to control. On the other hand, in different vascular circumstances (e.g. at vessel branches), the physician's manipulation technique is different. Therefore, to provide a meaningful training environment for intervention, it is important to simulate the surgical instruments’ behavior with high fidelity in a complex vascular system. Furthermore, the visual feedback of the simulator should be achieved in real time or within an acceptable limit for the trainees to perform subsequent operations. To address these challenging problems, we present a robust approach to modeling guidewire. Our approach realistically and efficiently simulates the behavior of the guidewire in a wide variety of vasculatures.

Several methods have been presented to simulate the interactive behavior of a guidewire and catheter in a vascular IR procedure. Nowinski and Chui [6] defined the catheter as a series of curved arc segments joined smoothly one after another. This method merges, splits, removes and inserts element curves using the Finite Element Model (FEM)-based representation. However, it is unable to simulate large geometric non-linearity of deformation. Aiming at solving this problem and achieving a more realistic simulation, Cotin et al. [7] employed a set of linked deformable beams with non-holonomic constraints to model the guidewire or catheter dependent on an incremental FEM method. Unfortunately, the simulation accuracy of this method is low due to the accumulating errors generated in each incremental step. Based on this work, Lenoir et al. [8] developed a composite model to simulate the interactive motion of guidewire and catheter by dynamically changing their material properties. Alderliesten et al. [9,10] modeled the guidewire as a set of linked rigid rods with more complex bending energies. Such model can achieve highly accurate simulation, but need to iteratively compute the minimum of the global energy. As a result, this model has a low efficiency and is not suitable for real time simulation. Luboz et al. [11] modeled the guidewire as a hybrid mass–spring particle system and introduced extra bending forces in order to constrain the guidewire to remain within the vasculature. Bergou et al. [12] presented a geometric model of thin flexible rods with arbitrary cross section and non-deformed configuration which can relatively accurately simulate the bend and twist deformations. More recently, Tang et al. [13,14] applied this model to the simulation of guidewire and catheter. However, the simulation accuracy of this method is not high and needs to be improved by invoking additional optimization techniques.

In this paper, an approach to simulating the guidewire's behaviors in vascular structures is presented. Though our approach aims at guidewire modeling, it can be applied to catheter modeling, as the catheter is a wire-like deformable object. Compared with the previous methods, our approach has the following advantages:

Our approach is more robust. The human vascular system is very complex; the inner diameter and curvature of the vessel vary significantly. Most previous methods [9,15,11] simply model the guidewire as rigid rods with invariant length in simulation. It is simple but fails to work in vessels with high curvature and small diameter. In our approach, the guidewire is modeled as rods with different resolutions which are dynamically adaptive to the diameter and curvature of the vessel. Additionally, more material characteristics are integrated into our model based on real guidewires’ material property to increase the realism of simulation. This model and the dynamically adaptive discretization strategy make our approach work very well and realistically under different vascular circumstances.

Our approach is faster. In previous methods [10,11], to calculate the elastic force generated by the guidewire colliding with the vessel wall, collision detection needs to be performed frequently. In this paper, we propose a force correction strategy to dynamically adjust the elastic force, leading to reducing the heavy computational burden and saving a great amount of time. In this way, the collision detection is executed only once at each simulation step. Thus, when compared with previous methods, our collision response is more efficient without endlessly repetitive collision detections.

@&#METHODOLOGY@&#

Our approach is based on quasi-static mechanics in order to ensure a realistic modeling of guidewire propagation. When updating positions of the guidewire, a dynamically adaptive strategy for the discretization of the guidewire is proposed to handle vasculatures with high curvature and small diameter. An efficient and memory-optimized collision detection is performed to deal with the collision between the guidewire and the highly detailed vascular model, which is composed of thousands of triangles. In the collision response, a dynamic force correction strategy is proposed to adjust the external force induced by local displacement of the guidewire.

During the simulation, a local coordinate is attached to every rod of the guidewire to compute local displacements. Main steps of one simulation loop in our approach are summarized in Algorithm 1.
                        
                           
                              
                              
                                 
                                    Algorithm 1: Guidewire simulation
                                 
                                 
                                    Import vascular model
                                 
                                 
                                    Initialize guidewire (Section 2.1)
                                 
                                 
                                    Preprocess
                                 
                                 
                                    While simulating do
                                 
                                 
                                    Step 1: Wait for control signal
                                 
                                 
                                    Step 2: Update positions (Section 2.1)
                                 
                                 
                                    Step 3: Update local coordinates (Section 2.1)
                                 
                                 
                                    Step 4: Collision detection (Section 2.2)
                                 
                                 
                                    Step 5: Collision response (i.e., minimizing the total potential energy) (Section 2.3)
                                 
                                 
                                    Step 6: Update positions (Section 2.1)
                                 
                                 
                                    End while
                                 
                              
                           
                        
                     
                  

The real guidewire is a flexible, long, thin object. The longest guidewire in IR procedures is 260cm. In this work, the guidewire is considered as an elastic rod model and is represented as a chain of rigid rods that tend to bend or twist rather than stretch. They are linked by the joint points that form the fixed centerline of the wire. The collision detection and force propagation are based on these joint points.

As shown in Fig. 1
                        , the point 
                           x
                        
                        
                           i
                         represents the joint point that links two rods. The subscript index of points increases from the tip part to the proximal end of the guidewire. A rod is represented by a vector 
                           t
                        
                        
                           i
                         which is defined as follows:
                           
                              (1)
                              
                                 
                                    
                                       
                                          t
                                       
                                       i
                                    
                                    =
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       i
                                    
                                    ,
                                     
                                    i
                                    ≥
                                    1
                                 
                              
                           
                        The angle between two adjacent rods 
                           t
                        
                        
                           i
                         and 
                           t
                        
                        
                           i−1 is used as a measure of bending energy. To simulate intrinsically curved tips with different curvatures, bias angles 
                           
                              (
                              e
                              .
                              g.
                                 
                              
                                 φ
                                 1
                              
                              ,
                                 
                              
                                 φ
                                 2
                              
                              ,
                                 
                              
                                 φ
                                 3
                              
                              ,
                              …
                              ,
                              )
                           
                         as shown in Fig. 1 between the tip rods are defined. And a maximum bias angle 
                           
                              
                                 φ
                                 m
                              
                           
                         is also predefined for every joint point in order to make the guidewire bend gradually but not abruptly.

In our approach, the lengths of rod do not remain constant during the simulation. The lengths are dynamically adaptive to the curvature and inner diameter of the vasculature. In the simulation, when the guidewire reaches a vessel region whose curvature is higher than a given curvature threshold, the rods of the guidewire split into smaller pieces. The degree of split is closely related to the diameter of the corresponding vessel region. Let 
                           
                              
                                 n
                                 d
                              
                           
                         denote the times of split, and it is calculated as follows:
                           
                              (2)
                              
                                 
                                    
                                       n
                                       d
                                    
                                    =
                                    
                                       
                                          log
                                          
                                             
                                                
                                                   
                                                      
                                                         l
                                                         t
                                                      
                                                   
                                                   ¯
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         r
                                                         c
                                                      
                                                      +
                                                      0.5
                                                      ×
                                                      
                                                         d
                                                         v
                                                      
                                                   
                                                
                                                
                                                   
                                                      2
                                                      ×
                                                      
                                                         
                                                            1
                                                            −
                                                            cos
                                                             
                                                            
                                                               φ
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 d
                                 v
                              
                           
                         denotes the diameter of vessel and 
                           
                              
                                 
                                    
                                       l
                                       t
                                    
                                 
                                 ¯
                              
                           
                         is the average length of the rods. 
                           
                              
                                 r
                                 c
                              
                           
                         is the radius of curvature.

After the dynamic discretization, a rod is split into two segments and the number of the joint points increases accordingly. With smaller rods representing the guidewire, the highly curved vessel could be passed through smoothly without perforation, as shown in Fig. 2
                        . To avoid extra computation, 
                           
                              
                                 n
                                 d
                              
                           
                         is not calculated when the guidewire is marching inside the vasculature in real time. Instead, the vascular model is preprocessed before the simulation starts (as described in Algorithm 1) and a trigger point for split is planted in certain positions. However, the burden of computation increases as the rods split. To maintain real-time simulation speed, in Section 2.3, we propose an optimized collision response scheme to handle the variation of computational cost caused by the adaptive discrete setting of the guidewire.

In contrast, when the guidewire is advanced through a low-curvature or a large-diameter region, 
                           
                              
                                 n
                                 d
                              
                           
                         may be negative and 
                           
                              1
                              /
                              
                                 2
                                 
                                    
                                       n
                                       d
                                    
                                 
                              
                           
                         rods are merged as one rod correspondingly. In this way, the total number of joint points decreases, which means a relief of the computational burden. And the guidewire is still able to pass through this particular region comfortably.

The dynamic discretization strategy of ours is significantly different from [13]. First, instead of splitting the rods after the collision response to make the guidewire look smoother, the discretization in our work is done before the collision response. And the position of every single joint point at the end of each simulation loop is calculated based on a minimal energy principle which leads to a higher accuracy. Second, the inner diameter of the vasculature is involved in our method as a key parameter to calculate the times of split. In this way, more complex vascular circumstances are covered and our approach becomes more robust.

As explained previously, penetration problems induced by geometrical modeling could be well solved by employing the preceding discretization strategy. However, certain kinds of penetration scenarios resulting from inappropriate operation in real interventional procedures should be saved and well simulated instead of being eradicated. Unlike the modeling-caused penetration, a different method is presented in Section 2.3 to deal with such incidents.

Based on Schröder's study [16,17] on the property of the guide wire, the tip part is always less stiff than the body part, and the transition between these two parts is mostly abrupt rather than gradual. To realistically simulate the material properties of the guidewire, we define a function of angular spring constant corresponding to the index of the joint point to approximately represent the variation trend of the stiffness from the tip to the body. The function is defined as follows:
                           
                              (3)
                              
                                 
                                    
                                       C
                                       i
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         C
                                                         
                                                            min
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      0
                                                      ≤
                                                      i
                                                      <
                                                      
                                                         T
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         C
                                                         
                                                            min
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            i
                                                            −
                                                            
                                                               T
                                                               1
                                                            
                                                         
                                                      
                                                      ×
                                                      K
                                                   
                                                
                                                
                                                   
                                                      
                                                         T
                                                         1
                                                      
                                                      ≤
                                                      i
                                                      <
                                                      
                                                         T
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         C
                                                         
                                                            max
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         T
                                                         2
                                                      
                                                      ≤
                                                      i
                                                      <
                                                      N
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 C
                                 i
                              
                           
                         denotes the angular spring constant of point 
                           x
                        
                        
                           i
                        . N is the total number of the joint points and i is the index. 
                           
                              
                                 C
                                 
                                    min
                                 
                              
                           
                         and 
                           
                              
                                 C
                                 
                                    max
                                 
                              
                           
                         are the minimum and maximum of the angular spring constant, respectively. 
                           
                              
                                 T
                                 1
                              
                           
                         and 
                           
                              
                                 T
                                 2
                              
                           
                         are the inflection points for the transition trend. 
                           K
                         is the gradient of the angular spring constant between 
                           
                              
                                 T
                                 1
                              
                           
                         and 
                           
                              
                                 T
                                 2
                              
                           
                        .

During the simulation, a local displacement vector is introduced to denote the variation of the position for each joint point. To explicitly express such a displacement vector, a local coordinate is attached to every rod, as demonstrated in Fig. 3
                        . Let 
                           
                              
                                 
                                    e
                                 
                                 i
                                 
                                    (
                                    m
                                    )
                                 
                              
                              
                                 ,
                              
                                 
                              
                                 
                                    e
                                 
                                 i
                                 
                                    (
                                    n
                                    )
                                 
                              
                              
                                 ,
                              
                                 
                              
                                 
                                    e
                                 
                                 i
                                 
                                    (
                                    t
                                    )
                                 
                              
                              ∈
                              
                                 R
                                 3
                              
                           
                         denote the axes of the local coordinate on rod 
                           
                              
                                 t
                                 i
                              
                           
                        . 
                           
                              
                                 
                                    e
                                 
                                 i
                                 
                                    (
                                    t
                                    )
                                 
                              
                           
                         is defined as 
                           
                              
                                 
                                    e
                                 
                                 i
                                 
                                    (
                                    t
                                    )
                                 
                              
                              =
                              
                                 
                                    t
                                 
                                 i
                              
                              /
                              
                                 
                                    
                                       
                                          t
                                       
                                       i
                                    
                                 
                              
                           
                        . 
                           
                              
                                 
                                    e
                                 
                                 i
                                 
                                    (
                                    m
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 
                                    e
                                 
                                 i
                                 
                                    (
                                    n
                                    )
                                 
                              
                           
                         are unit vectors chosen arbitrarily, as long as 
                           
                              
                                 
                                    e
                                 
                                 i
                                 
                                    (
                                    t
                                    )
                                 
                              
                              ⊥
                              
                                 
                                    e
                                 
                                 i
                                 
                                    (
                                    n
                                    )
                                 
                              
                           
                        , 
                           
                              
                                 
                                    e
                                 
                                 i
                                 
                                    (
                                    t
                                    )
                                 
                              
                              ⊥
                              
                                 
                                    e
                                 
                                 i
                                 
                                    (
                                    m
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 
                                    e
                                 
                                 i
                                 
                                    (
                                    m
                                    )
                                 
                              
                              ⊥
                              
                                 
                                    e
                                 
                                 i
                                 
                                    (
                                    n
                                    )
                                 
                              
                           
                        . Once the position of the guidewire changes at each simulation step, the local coordinates need to be updated immediately.

The modeling of guidewire's propagation is based on quasi-static mechanics. At the first step of each simulation loop, trainees steer the guidewire by pulling, pushing or rotating the proximal end of the guidewire. In our approach, translation (i.e., pulling and pushing) and rotation are treated separately.

During the whole simulation, the guidewire is constantly colliding with the vessel wall. Note that the guidewire and the vascular structures are considered as a small physical system in which these two parts interact with each other. At the end of the last simulation loop, this system is in an equilibrium state where its potential energy reaches minimum. Once the guidewire is pushed or pulled, all positions of the points in the guidewire are updated, resulting in disturbing the equilibrium. Nevertheless, points of the body part tend to shift their positions to maintain the shape of guidewire and the collision state with the vessel wall in order to minimize the damage to the last equilibrium state. However, the points of the tip part are treated in another way. Unlike the proximal end with a fixed insert point and angle, the tip is more active and usually works as a pathfinder for the guidewire. Taking the pushing translation as an example, after a translation, for the body part (
                              x
                           
                           
                              b
                           , …,
                              x
                           
                           
                              n
                           ), the point 
                              x
                           
                           
                              i
                            will move to 
                              x
                           
                           
                              i−1 and its present position will be occupied by 
                              x
                           
                           
                              i+1. As for the tip part (x
                           0, …, 
                              x
                           
                           
                              b−1), a uniform vector 
                              t
                           
                           
                              b
                            that denotes the first rod of the body part is added to all points of the tip part. The pulling translation works similarly but in the opposite direction.

The rotation performed on the guidewire corresponds to applying torsion to its proximal end. The stiffness and the torsion strength of a guidewire are proportional to the elasticity modulus and the fourth power of the core diameter [16,17]. It is usually assumed that the torsion constant of the guidewire approaches infinity. In this work, it is suggested that the guidewire has excellent torque control except for the tip part. Let 
                              x
                           
                           
                              c
                            denote the first body point which collides with the vessel wall after the last simulation loop. The rod vectors connected by it are 
                              t
                           
                           
                              c
                            and 
                              t
                           
                           
                              c+1. When a rotation is performed (e.g. the rotational angle is α), only the part (
                              x
                           
                           0, …, 
                              x
                           
                           
                              c
                           ) is rotated along the axis 
                              t
                           
                           
                              c
                            by an angle α.

At each step of the simulation, when the guidewire is exerted by an action of translation or rotation, a step of collision detection should be performed to update the relative position between the guidewire and vessel wall. Since the detection is conducted very often, an effective and efficient collision detection computation must be achieved to guarantee the real time simulation speed. In this work, an open source collision detection library called OPCODE [18] is introduced to our simulation system. The library uses memory-optimized bounding volume hierarchies to minimize memory occupation without sacrificing efficiency.

After updating the local coordinates, a bounding sphere is assigned to every joint point of the guidewire to initialize detection. The radius of the bounding sphere is half of the distance between two adjacent joint points to ensure that the whole guidewire is inside the bounding volume. In this way, the inter-penetration between the vessel wall and rods of the guidewire can be avoided.

Once a collision is detected, the vessel wall deforms because of the pushing of the bounding sphere. According to Hooke's law, the elastic force generated by the deformed vessel wall can be expressed as follows:
                           
                              (4)
                              
                                 
                                    
                                       F
                                       
                                          vessel
                                       
                                    
                                    =
                                    k
                                    d
                                 
                              
                           
                        where k is the modulus of elasticity and d is the depth of the overlap. The direction of the force is perpendicular to the contact triangle facet pointing at the interior of the vessel. If the collision involves more than one triangle, the resultant force equals the sum of all component forces.

There are two cases of collisions in the detection: the joint point is outside or inside the vessel. For the former case, most part of the bounding sphere is outside the vessel wall including the joint point. The depth of overlap d is calculated as:
                           
                              (5)
                              
                                 
                                    d
                                    =
                                    r
                                    +
                                    s
                                 
                              
                           
                        where r is the radius of the bounding sphere while s is the minimum distance from the joint point to the colliding triangle facet. With regard to the latter case, the joint point is inside the vessel and d is calculated as:
                           
                              (6)
                              
                                 
                                    d
                                    =
                                    r
                                    −
                                    s
                                 
                              
                           
                        
                     

As mentioned in Section 2.1, the guidewire and the vasculature are considered as a minor physical system in our work. Once a collision is detected, the guidewire must react to the elastic force generated by the deformation of the vessel wall. And the reaction means continual variation of position for both the guidewire and vessel wall. From the perspective of energy, the collision response is a process of energy exchanges inside this system till equilibrium is achieved. At each step of simulation, the system tends to be in a state whose total potential energy is the minimum. This system's total energy 
                           
                              
                                 E
                                 
                                    total
                                 
                              
                           
                         is defined as follows:
                           
                              (7)
                              
                                 
                                    
                                       E
                                       
                                          total
                                       
                                    
                                    =
                                    
                                       E
                                       g
                                    
                                    +
                                    
                                       E
                                       v
                                    
                                 
                              
                           
                        where 
                           
                              
                                 E
                                 
                                    total
                                 
                              
                           
                         is the sum of two components: the bending energy of the guidewire 
                           
                              
                                 E
                                 g
                              
                           
                         and the elastic energy of the vessel wall 
                           
                              
                                 E
                                 v
                              
                           
                         which are both generated by the deformation. In this work, we define the bending energy 
                           
                              
                                 E
                                 g
                              
                           
                         as follows:
                           
                              (8)
                              
                                 
                                    
                                       E
                                       g
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       1
                                       2
                                    
                                    
                                       C
                                       i
                                    
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                   i
                                                
                                                −
                                                
                                                   φ
                                                   i
                                                
                                             
                                          
                                       
                                       2
                                    
                                 
                              
                           
                        where 
                           
                              
                                 θ
                                 i
                              
                           
                         denotes the angle between two adjacent rods of point 
                           x
                        
                        
                           i
                        , while 
                           
                              
                                 φ
                                 i
                              
                           
                         denotes the intrinsic bias angle of 
                           x
                        
                        
                           i
                        , as indicated in Fig. 1. The scalar 
                           
                              
                                 θ
                                 i
                              
                           
                         and 
                           
                              
                                 φ
                                 i
                              
                           
                         cannot represent the bending direction of the tip in 3D space. Thus, a pair of deflection vectors is introduced to approximate them, which is defined as follows:
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            γ
                                                         
                                                         i
                                                      
                                                      =
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                     i
                                                                  
                                                                  −
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        i
                                                                        +
                                                                        1
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            l
                                                            ¯
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               γ
                                                            
                                                            ′
                                                         
                                                         i
                                                      
                                                      =
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           t
                                                                        
                                                                        ′
                                                                     
                                                                     i
                                                                  
                                                                  −
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        i
                                                                        +
                                                                        1
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            l
                                                            ¯
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              l
                              ¯
                           
                         is the average length of two adjacent rods, namely, 
                           
                              
                                 l
                                 ¯
                              
                              =
                              (
                              
                                 
                                    
                                       
                                          t
                                       
                                       i
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                 
                              
                              )
                              /
                              2
                           
                        . 
                           
                              
                                 
                                    
                                       t
                                    
                                    ′
                                 
                                 i
                              
                              =
                              
                                 
                                    
                                       x
                                    
                                    ′
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              −
                              
                                 
                                    x
                                 
                                 i
                              
                           
                        , 
                           
                              
                                 
                                    
                                       x
                                    
                                    ′
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                           
                         is the new position of 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                           
                         after the movement induced by external force. As shown in Fig. 4
                        , the displacement of 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                           
                         is indicated as 
                           
                              
                                 
                                    α
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                           
                        . 
                           
                              
                                 
                                    γ
                                 
                                 i
                              
                           
                         denotes the intrinsic deflection vector of 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          γ
                                       
                                       i
                                    
                                 
                              
                           
                         can be conceived as 
                           
                              
                                 φ
                                 i
                              
                           
                        . Similarly, 
                           
                              
                                 
                                    
                                       γ
                                    
                                    ′
                                 
                                 ι
                              
                           
                         denotes the final deflection vector and 
                           
                              
                                 
                                    
                                       
                                          
                                             γ
                                          
                                          ′
                                       
                                       ι
                                    
                                 
                              
                           
                         can be conceived as 
                           
                              
                                 θ
                                 i
                              
                           
                        .

The energy of the vessel wall 
                           
                              
                                 E
                                 v
                              
                           
                         is defined as:
                           
                              (10)
                              
                                 
                                    
                                       E
                                       v
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       1
                                       2
                                    
                                    
                                       k
                                       v
                                    
                                    
                                       d
                                       i
                                       2
                                    
                                 
                              
                           
                        where 
                           
                              
                                 k
                                 v
                              
                           
                         denotes the elastic coefficient of the vessel wall, and 
                           
                              
                                 d
                                 i
                              
                           
                         is the depth of the vessel wall's deformation caused by collision.

To obtain the displacement 
                           
                              
                                 
                                    α
                                 
                                 i
                              
                           
                         for joint point 
                           x
                        
                        
                           i
                        , the extremes that make the total energy minimum have to be calculated. Generally, 
                           α
                        
                        
                           i
                         is a vector in 3D space. But in our case, the aforementioned adaptive discretization takes place only between simulation loops which means that the lengths of rods remain constant when calculating the displacements for the guidewire in every single simulation loop. Thus, 
                           α
                        
                        
                           i
                         can be restricted to a 2D surface in 3D space. As mentioned in Section 2.1, 
                           α
                        
                        
                           i
                         is expressed in local coordinate of 
                           t
                        
                        
                           i
                        . Inspired by [19], we define scalar 
                           
                              
                                 a
                                 i
                              
                           
                         as the magnitude of 
                           α
                        
                        
                           i
                         and scalar 
                           
                              
                                 ψ
                                 i
                              
                           
                         as the angle of revolution around 
                           
                              
                                 
                                    e
                                 
                                 i
                                 
                                    (
                                    t
                                    )
                                 
                              
                           
                        . To find 
                           
                              
                                 a
                                 i
                              
                           
                         and 
                           
                              
                                 ψ
                                 i
                              
                           
                         that minimize the total energy, two fundamental equations are defined as follows:
                           
                              (11)
                              
                                 
                                    
                                       
                                          ∂
                                          
                                             E
                                             
                                                total
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             a
                                             i
                                          
                                       
                                    
                                    =
                                    0
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       
                                          ∂
                                          
                                             E
                                             
                                                total
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             ψ
                                             i
                                          
                                       
                                    
                                    =
                                    0
                                 
                              
                           
                        
                     

After solving the above equations in every iteration, the obtained displacement 
                           α
                        
                        
                           i
                         is added to the corresponding points to push them closer to their equilibrium position resulting the change in 
                           
                              
                                 d
                                 i
                              
                           
                        . Unfortunately, such change makes the result of last collision detection invalid and the external force 
                           F
                        
                        
                           i
                         (in this case, 
                           
                              
                                 
                                    F
                                 
                                 
                                    vessel
                                 
                              
                           
                        ) defined in Eq. (4) incorrect. Therefore, the external force has to be updated immediately to work as the input for the next iteration computation. In previous methods, collision detection is computed every iteration to update the force. Obviously, it is not only high computational cost but also quite time-consuming for an iterative algorithm. To avoid this problem, we propose a force correction strategy.

According to Newton's Second Law, the joint points move in the direction of the external force. Consequently, the depth of overlap 
                           
                              
                                 d
                                 i
                              
                           
                         between the bounding sphere and the colliding triangle facet decreases. As implied in Eq. (4), the magnitude of external force 
                           F
                        
                        
                           i
                         will decrease after the movement. The updated external force 
                           
                              
                                 
                                    F
                                    ′
                                 
                                 i
                              
                           
                         is calculated as follows:
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             F
                                          
                                          ′
                                       
                                       i
                                    
                                    =
                                    
                                       
                                          F
                                       
                                       i
                                    
                                    
                                       
                                          1
                                          −
                                          η
                                          
                                             
                                                α
                                             
                                             i
                                          
                                          ×
                                          
                                             
                                                
                                                   F
                                                   i
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               F
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           η
                         is a feedback coefficient, representing the scale of the force's reduction induced by the displacement. Note that it must be set properly to avoid over or lack of correction. In our experience, the 
                           η
                         is set to 10 times of the elastic modulus k of the vessel wall.

As described in Algorithm 2, at the end of collision detection stage of every simulation loop, the elastic force 
                           
                              
                                 
                                    F
                                 
                                 i
                              
                           
                         is applied to the joint point 
                           x
                        
                        
                           i
                         which collides with the vessel wall and works as the initial force input for the following iterations. After the displacement 
                           
                              
                                 
                                    α
                                 
                                 i
                              
                           
                         is calculated, it is applied to all the points from 
                           x
                        
                        
                           i
                         to 
                           x
                        
                        0. If the magnitude of 
                           
                              
                                 
                                    α
                                 
                                 i
                              
                           
                         is less than a user-defined threshold, the subsequent iterations for 
                           
                              
                                 
                                    x
                                 
                                 i
                              
                           
                         would be skipped because the displacement is so small that it could be neglected. In our experience, the threshold is usually chosen as five percent of the length of the rod. Additionally, 
                           
                              
                                 
                                    α
                                 
                                 i
                              
                           
                         is used as a key feedback parameter to correct the force 
                           
                              
                                 
                                    F
                                 
                                 i
                              
                           
                         in return. With this strategy, the collision detection can only be executed once in each simulation loop, with the force still being corrected efficiently, and the joint points can approach their equilibrium positions in fewer iterations.
                           
                              
                                 
                                 
                                    
                                       Algorithm 2: Pseudo-code for force correction strategy
                                    
                                    
                                       for every simulation loop
                                    
                                    
                                       
                                          Collision detection (set external forces 
                                             
                                                
                                                   
                                                      F
                                                   
                                                   i
                                                
                                             
                                           on joint points)
                                    
                                    
                                       
                                          for joint point 
                                             
                                                
                                                   
                                                      x
                                                   
                                                   i
                                                
                                             
                                           from 
                                             
                                                
                                                   
                                                      x
                                                   
                                                   n
                                                
                                             
                                           to 
                                             
                                                
                                                   
                                                      x
                                                   
                                                   0
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          Calculate the displacement 
                                             
                                                
                                                   
                                                      α
                                                   
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          If 
                                             
                                                
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         i
                                                      
                                                   
                                                
                                                <
                                                threshold
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          
                                          Continue
                                    
                                    
                                       
                                          
                                          Apply the 
                                             
                                                
                                                   
                                                      α
                                                   
                                                   i
                                                
                                             
                                           to points from 
                                             
                                                
                                                   
                                                      x
                                                   
                                                   i
                                                
                                             
                                           to 
                                             
                                                
                                                   
                                                      x
                                                   
                                                   0
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          Correct the external forces for points from 
                                             
                                                
                                                   
                                                      x
                                                   
                                                   i
                                                
                                             
                                           to 
                                             
                                                
                                                   
                                                      x
                                                   
                                                   0
                                                
                                             
                                           based on 
                                             
                                                
                                                   
                                                      α
                                                   
                                                   i
                                                
                                             
                                          , as Eq. (13) indicates
                                    
                                    
                                       
                                          
                                          Update local reference coordinates
                                    
                                 
                              
                           
                        
                     

In real interventional procedures, operational errors (e.g. using excessive force and selecting wrong type of guidewire) may lead to a penetration between the tip of guidewire and the vessel wall. The fundamental cause of such penetration is that the stress of the vessel wall exceeds its rupture strength limit above which the vasculature will be pierced. A user-defined boundary force 
                              
                                 
                                    F
                                    r
                                 
                              
                            is employed in our method to approximate the rupture strength of the vascular model. When the equilibrium of the guidewire is achieved at the end of every simulation loop, the elastic force applied on the tip of the guidewire by the vessel wall is calculated and compared with 
                              
                                 
                                    F
                                    r
                                 
                              
                           . If the force is greater than 
                              
                                 
                                    F
                                    r
                                 
                              
                           , the vessel is pierced and an operational accident happens.

@&#RESULTS AND DISCUSSION@&#

To evaluate the performance of the proposed approach for guidewire modeling, we developed a vascular intervention simulator, equipped with AMD AthlonTM II X2 processor at 3.00GHz with a 4GB memory, and carried out experiments on the simulator, as shown in Fig. 5
                      (detailed design of the hardware system will be presented in another paper). By manipulating the real guidewire and catheter, one could realistically simulate the procedure of the radiological intervention. With the simulator, we tested our approach on a wide variety of vascular structures with varying degrees of complexity, such as coronary artery, cerebral artery, and abdominal aorta (Fig. 6
                     ). Our approach can robustly and efficiently translate, rotate and interact with the vascular network as interventional radiologists expect and realistically give them visual feedback of the guidewire's behavior. As demonstrated in Fig. 6, from an inserted point, the guidewire can be effectively advanced to the desired point located at different branches with varying curvatures and diameters by the interventional radiologists. Moreover, the guidewire bends naturally and reaches the target location through the vascular network without piercing the vessel wall in any of three complex vascular models.

In the following sections, we evaluated our approach in terms of bifurcation performance, discretization comparison, simulation accuracy, time performance, validation of force correction strategy, parameter choosing, and user evaluation.


                        Fig. 7
                         illustrates the simulation of the guidewire's behaviors at vascular bifurcations. As mentioned in Section 2.1, the material characteristic of the tip part is set differently to the body part, which is closer to a real guidewire. Therefore, the mechanical properties of the flexible tips are realistically simulated in our approach. Most existing methods [10,14] simply apply similar material properties to the entire device, resulting in that the guidewire bends less than it should, or bends more than it should if much force is exerted. As a consequence, during the interaction with vascular bifurcations it is difficult to choose the desired vessel branch to go into. With our method, the guidewire can be easily steered to bend to the desired side of the bifurcation by proper rotation during advancement to the bifurcation, as illustrated in Fig. 7c and e.


                        Fig. 8
                         shows the comparison of constant discrete setting with dynamically adaptive discrete setting. In previous methods [10,11], the guidewire is modeled as a series of rods with equal length and the length remains invariant in the simulation. Unfortunately, when the guidewire is advanced to a vessel area with high curvature or with small diameter, the vessel wall might be perforated by the collision with the sharp tip part at a vertical impact angle or a high velocity, as illustrated in Fig. 8b and d. In comparison, our approach models the guidewire with a dynamic adaptive discrete setting. As the discrete setting is dynamically modified to adapt to situations where the vessel has large local curvatures, the tip part bends well and the perforation does not occur in our approach, as demonstrated in Fig. 8a and c.

In order to evaluate the accuracy and the simulation of the proposed approach in different circumstances, validation experiments are conducted on two vascular phantoms (Fig. 9
                        ) which are made of transparent silicon tubing. Therefore, the real guidewire and catheter can be operated on them. The phantoms are derived from real human anatomy and thus provide a realistic environment for the evaluation of our simulation of endovascular procedures. In our experiments, the phantoms were first scanned by computed tomography (CT) with a spatial resolution of 0.75mm and then a semi-automatic segmentation was applied on the 2D scanned images, followed by manual correction and refinement by an experienced radiologist. Finally, to reconstruct the 3D vascular surface geometry with high accuracy, a scale-adaptive vascular modeling method [20] was performed. To verify the behavior of the guidewire in phantoms and reconstructed models, identical operations of manipulating the guidewire to the same target position are carried out under similar circumstances. The same operations are conducted multiple times to guarantee that the guidewire configuration can be reproduced in the physical experimental setup. Meanwhile, corresponding pictures on different stages are taken to make a comparison. Fig. 10
                         shows the comparisons of the behavior of the guidewire in the real phantoms and the corresponding virtual models. Due to the refraction of the transparent silicon material, it is impossible to measure the actual distances of the guidewire between the vessel walls. However, the relative distance, the shape of the guidewire and the main collision points in each pair of pictures all indicate that the behavior of the virtual instruments in virtual models and the behavior of the real ones in the real vascular phantoms are well matched.


                        Table 1
                         reports the timing performance in a collision response. Compared to previous methods [10,11], our approach can save a considerable amount of time in the collision response by using the dynamic force correction strategy. The reason lies in the fact that with our strategy, collision detection executed in every iteration is now only performed once at the beginning of every simulation loop. It is also a tremendous relief of computational burden, as the collision detection is frequently conducted in one iteration loop of an iterative procedure. For a vascular model with more than 12,000 triangles and a guidewire with 300 joint points, previous methods need 519ms to complete the calculation of a collision response. This time efficiency is unacceptable for an interactive real time simulation. In contrast, our approach needs only 27.3ms, 19 times faster than the previous methods, and there is no latency for our interaction. It is an obvious advantage for our force correction strategy with an increased number of joint points and triangles.

The variation of elastic force is recorded during the iterative calculation of the equilibrium position. On most occasions, the tip collides with the vessel wall first and the force applied on this part varies most greatly in each simulation loop. As such, we chose one of the tip joint points to record its force change in three different simulation loops, as shown in Fig. 11
                        . The initial input elastic force applied on the joint point at the stage of collision detection is always higher than that which keeps the guidewire stable. The force decreases rapidly as the collision response starts and reaches equilibrium in around 200 iterations which indicates that our force correction strategy helps achieve the equilibrium of the guidewire quickly.

To find a proper feedback coefficient, we record the variation of the elastic force with different settings of 
                           η
                         ranging from 2 to 15 times of the value of modulus of elasticity. As illustrated in Fig. 12
                        , it takes more than 400 iterations to achieve the equilibrium with the setting of 2 and 5 times. The force converges to the equilibrium very slowly and we call it lack-correction. When the setting grows to 15 times, the external force decreases quickly and reaches the lowest value which is lower than the equilibrium within 200 iterations. As the iteration goes on, the force goes back to equilibrium level eventually. In this case, the high feedback coefficient makes the force converge to the equilibrium so quickly that an oscillation around the equilibrium happens and we call it over-correction. By contrast, with the setting of 10 times, the force converges fast and almost no over-correction happens. It is a trade-off between convergence rate and stability. Bearing in mind the goal of achieving the best result, we have carried out extensive experiments on the setting of 
                           η
                         and obtained similar results.

The evaluation of our simulator was double-blinded tested by 27 experienced third-party interventional radiologists who were not involved in the design of our experiment. A questionnaire was designed to collect the feedback of the user's experiences. The questionnaire has several evaluation criteria about the practical performance of the methods presented in this paper. The results (as shown in Table 2
                        ) indicate that the efficiency of our simulation can exactly meet the requirements of the physicians and our simulator can provide a realistic environment for core skills training in vascular interventional radiology. Our study also demonstrated that naive interventional radiologists could accelerate their acquirement of core skills by training with our simulator. However, evaluation of the haptic experience of manipulation is not very satisfying. It is mainly because the haptic feedback is provided by a very tricky hardware system which needs more experiments to balance the feedback force induced by the translation and rotation operations. Additionally, the haptic experience is subjective and varies with each individual. It remains to be one of our future works to make the haptic experience better, but not a focus of this paper.

For the current implementation of our simulator, when manipulating the guidewire through the vascular network, large steps in translation and rapid maneuver should be avoided. Fortunately, it is not a problem in the virtual simulation of guidewire behaviors. Actually, in real vascular IR procedures, the physician manipulates the guidewire slowly and very carefully, just as our simulation could do, to avoid injury to the patient. Additionally, there is a considerable variety of guidewires in IR and the guidewire tip configuration is diverse. Currently, our approach only takes into account the most frequently used type of tip configuration. Therefore, the trainee has limited option to use a guidewire with a different flexibility. However, our approach can easily be extended to model the remaining types of tip configurations, as the configurations are mainly different from curved angle, length, diameter, material, and stiffness.

@&#CONCLUSION@&#

In this paper, a robust and fast approach to simulating the behaviors of the guidewire in vascular interventional radiology is presented. By modeling the guidewire with a dynamically adaptive discrete setting, our approach performs well under various vascular circumstances, especially in vessel area with high curvature. Aiming at simulating the behavior of the guidewire as realistically as possible, more material characteristics of the guidewire are integrated into the discrete model by defining a material function. In the collision response, we propose a force correction strategy to dynamically handle the variation of the force induced by movement of the guidewire instead of performing collision detection frequently. Experimental results and validations on phantoms demonstrate that our approach can efficiently and realistically simulate the behavior of the guidewire under complex vasculatures with arbitrary topology and the guidewire can be navigated to a desired location through the vascular network without perforation by proper manipulation. In clinical practice, the behavior of the guidewire in IR is affected by flow of the blood and the periodic impulse of the vessel. Thus, simulating the behaviors of the surgical instruments in a dynamic environment can be one challenge in future works.

We confirm that all authors of this manuscript have no conflicts of interest to declare.

@&#ACKNOWLEDGEMENTS@&#

This work was supported by National Natural Science Foundation of China (no. 61272328) and Shenzhen Science and Technology Program (no. JCYJ20130402151227178).

@&#REFERENCES@&#

