@&#MAIN-TITLE@&#Multi-way PLS regression: Monotony convergence of tri-linear PLS2 and optimality of parameters

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           It is shown that the tri-linear PLS2 procedure is convergent.


                        
                        
                           
                           The sequences generated by the tri-linear PLS2 can be described as increasing or decreasing two specific criteria.


                        
                        
                           
                           A hidden tensor is described allowing tri-linear PLS2 to search its best rank one approximation.


                        
                        
                           
                           A link between multi-way PLS regression and the well-known PARAFAC model is highlighted.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Multi-way data

Tensors

Multi-way PLS regression

Best rank-one approximation

Monotony sequences

@&#ABSTRACT@&#


               
               
                  The tri-linear PLS2 iterative procedure, an algorithm pertaining to the NIPALS framework, is considered. It was previously proposed as a first stage to estimate parameters of the multi-way PLS regression method. It is shown that the tri-linear PLS2 procedure is convergent. The procedure generates a sequence of parameters (scores and loadings), which can be described as increasing or decreasing two specific criteria. Furthermore, a hidden tensor is described allowing tri-linear PLS2 to search its best rank-one approximation. This tensor highlights the link between multi-way PLS regression and the well-known PARAFAC model. The parameters of the multi-way PLS regression method can be computed using three alternative procedures.
               
            

@&#INTRODUCTION@&#

Regression methods constitute widely used tools in chemometrics. Usually, the data set to be analyzed is composed of two matrices, 
                        
                           X
                        
                      and 
                        
                           Y
                        
                     . The rows of 
                        
                           Y
                        
                      correspond to the responses, which have to be predicted according to the values contained in 
                        
                           X
                        
                     . A very popular method to implement this prediction is the Partial Least Squares method (PLS), and numerous papers have previously discussed this method from a geometrical, mathematical and statistical point of view (Bhupimder and McGregor, 1997; Helland, 1988; Martens and Naes, 1989; Phatak and de Jong, 1997). Several reviews illustrating the interest in PLS regression for various applications are also available (Clayton et al., 2006; Martin et al., 2008).

The amount of data currently generated by modern instrumentation is very large, and collecting data has become easier due to more efficient computers, technological advances in data storage, and automatic instrumentation. In many situations, the data contained in 
                        
                           X
                        
                      have three modes and can be meaningfully arranged in a three-way table (see Fig. 1
                     ). For example, if a batch process is running, measurements of the process variables are made at regular time intervals. For each batch, the resulting data matrix has a size equal to the number of process variables 
                        ∗
                      the number of time points. When several batches are simultaneously considered, the data set becomes dimensioned as third-order data (number of batches 
                        ∗
                      number of process variables 
                        ∗
                      number of points), which are also called third-order tensors.

The purpose of multi-way regression is to build a model between a high-order array 
                        
                           X
                        
                      of independent variables and a response array 
                        
                           Y
                        
                     . Similar to PLS, such a model might be useful for predicting future 
                        
                           Y
                        
                      values from future 
                        
                           X
                        
                      values or for studying the relation between 
                        
                           X
                        
                      and 
                        
                           Y
                        
                     . A well-known method for addressing the multi-way regression problem is multi-way PLS (NPLS), a modeling strategy introduced by Bro (1996) and further studied by Smilde (1997). NPLS can be seen as an extension of the ordinary PLS regression model to the case where the 
                        
                           X
                        
                      data consists of a multi-way array. It has been used in different situations, including multivariate time-series analysis, e.g., metabolomics longitudinal data. For instance, NPLS was proposed for the quantification of lipoprotein fractions obtained by 2D diffusion-edited NMR spectra (Dyrby et al., 2005) to model longitudinal microbial metabolic data (Rubingh et al., 2009) and to analyze LC-MS time-series data (Boccard et al., 2010, 2011).

As in PLS regression, NPLS can be described as essentially consisting of two stages. In the first stage, the components (
                        
                           X
                        
                      scores and 
                        
                           Y
                        
                      scores) and the vector of weights (
                        
                           X
                        
                      loadings and 
                        
                           Y
                        
                      loadings) are computed according to an iterative procedure, which pertains to the NIPALS framework. This procedure allows one to compute the scores and loadings related to the 
                        
                           X
                        
                      and 
                        
                           Y
                        
                      data.

The second stage in NPLS aims at computing subsequent components (scores and loadings of order higher than 1). This is achieved by deflating the 
                        
                           X
                        
                      and 
                        
                           Y
                        
                      data with respect to the previously computed parameters (
                        
                           X
                        
                      scores and 
                        
                           X
                        
                      loadings).

The case where the response data 
                        
                           Y
                        
                      is a vector or a matrix is considered. The independent data 
                        
                           X
                        
                      is a three-way array (third-order tensor). When 
                        
                           Y
                        
                      is a vector (single variable 
                        
                           y
                        
                     ), the NPLS follows the so-called tri-linear PLS1 procedure (see below). When 
                        
                           Y
                        
                      is a matrix, the NPLS regression follows the tri-linear PLS2 procedure. The main difference between tri-linear PLS1 and tri-linear PLS2 resides in the fact that the latter is iterative.

The computation of scores and loadings by the tri-linear PLS2 procedure is considered. Because tri-linear PLS1 is not an iterative procedure, it does not exhibit any computational difficulty. The proof of convergence of the Tri-linear PLS2 procedure has not been provided and a criterion optimized by scores and loadings of the NPLS regression has not been established. Indeed, no apparent optimization properties have been proposed to characterize the parameters (scores and loadings) of the multi-way PLS regression method. This remains problematic because the solution is not guaranteed to be optimal and, therefore, the output interpretation can be erroneous.

The contributions of the present paper can be summarized using the following three results: 
                        
                           (i)
                           Iteratively, the tri-linear PLS2 procedure generates sequences of scores and loadings vectors for which two criteria have been found to be monotone. As a consequence, the monotony convergence of tri-linear PLS2 is guaranteed.

A hidden tensor allowing tri-linear PLS2 to be considered as searching its best rank-one approximation is described. This tensor highlights the link between multi-way PLS regression and the well-known PARAFAC model.

As an alternative to the tri-linear PLS2 procedure, scores and loadings can be computed using three other procedures, which are available in the literature.

The organization is as follows. Section  2, summarizes the notations and basic definitions from tensor algebra. Section  3 gives a brief presentation of the multi-way PLS regression model and details the stage of the computation of scores and loadings by providing a complete description of the tri-linear PLS1 and tri-linear PLS2 procedures. Section  4 focuses on the results and their proofs, and contribution (i) mentioned above is presented. Contributions (ii) and (iii) are presented in Section  5, where three alternatives procedures to tri-linear PLS2 are briefly discussed.

Various notations have been used to describe the multi-way PLS regression method. Bro’s presentation (Bro, 1996) is based on matrix notation, whereas (Smilde, 1997) uses Kronecker product notation (Van Loan, 2000). This paper follows a description of the multi-way PLS regression method based on 
                        n
                     -mode product notation (De Lathauwer et al., 2000; Kolda, 2006). This choice appears to be more rigorous and uses fewer indexes.

This section summarizes the basic definitions and notations required in subsequent developments. Matrices and third-order tensors are in uppercase bold, and vectors are in lowercase bold.


                        
                           
                              •
                              Let 
                                    
                                       a
                                    
                                    ,
                                    
                                       b
                                    
                                    ,
                                    
                                       c
                                    
                                  be three real vectors of size 
                                    
                                       (
                                       I
                                       ×
                                       1
                                       )
                                    
                                    ,
                                    
                                       (
                                       J
                                       ×
                                       1
                                       )
                                    
                                  and 
                                    
                                       (
                                       K
                                       ×
                                       1
                                       )
                                    
                                 , respectively, and a third-order tensor 
                                    
                                       X
                                    
                                  is rank one if it can be written as the outer product of three vectors, i.e., 
                                    
                                       X
                                    
                                    =
                                    
                                       a
                                    
                                    ∘
                                    
                                       b
                                    
                                    ∘
                                    
                                       c
                                    
                                 . The symbol “
                                    ∘
                                 ” represents the vector outer product. This means that each element of the tensor is the product of the corresponding vector elements: 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          k
                                       
                                    
                                 .

Let 
                                    
                                       X
                                    
                                  and 
                                    
                                       
                                          
                                             X
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                  be two tensors of size 
                                    
                                       (
                                       I
                                       ,
                                       J
                                       ,
                                       K
                                       )
                                    
                                 . The scalar product of two third-order tensors is denoted by 
                                    
                                       〈
                                       
                                          X
                                       
                                       ,
                                       
                                          
                                             
                                                X
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                       〉
                                    
                                  and is computed as a sum of element-wise products over all indices, that is, 
                                    
                                       〈
                                       
                                          X
                                       
                                       ,
                                       
                                          
                                             
                                                X
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                       〉
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          I
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          J
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 . The scalar product allows the norm of a third-order tensor 
                                    
                                       X
                                    
                                  to be defined as 
                                    
                                       
                                          
                                             ‖
                                             
                                                X
                                             
                                             ‖
                                          
                                          =
                                          
                                             
                                                
                                                   〈
                                                   
                                                      X
                                                   
                                                   ,
                                                   
                                                      X
                                                   
                                                   〉
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      I
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      J
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      K
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              

To multiply a third-order tensor by a vector or a matrix, it is necessary to specify the corresponding tensor mode (or way).


                        1—The 1-mode product 
                           
                              X
                           
                           
                              
                                 
                                    
                                       ×
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 1
                              
                           
                           
                              u
                           
                         of a third-order tensor 
                           
                              X
                           
                         of size 
                           
                              (
                              I
                              ,
                              J
                              ,
                              K
                              )
                           
                         and an 
                           I
                        -vector 
                           
                              u
                           
                         is a matrix 
                           
                              M
                           
                         of size 
                           
                              (
                              J
                              ,
                              K
                              )
                           
                         with elements 
                           
                              
                                 
                                    
                                       m
                                    
                                    
                                       j
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       I
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    (
                                    1
                                    ≤
                                    j
                                    ≤
                                    J
                                    )
                                 
                                 
                                 and
                                 
                                 
                                    (
                                    1
                                    ≤
                                    k
                                    ≤
                                    K
                                    )
                                 
                                 .
                              
                           
                        
                     

In the same manner, the 2-mode product 
                           
                              X
                           
                           
                              
                                 
                                    
                                       ×
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 2
                              
                           
                           
                              u
                           
                         of a third-order tensor 
                           
                              X
                           
                         of size 
                           
                              (
                              I
                              ,
                              J
                              ,
                              K
                              )
                           
                         and a 
                           J
                        -vector 
                           
                              u
                           
                         is a matrix 
                           
                              M
                           
                         of size 
                           
                              (
                              I
                              ,
                              K
                              )
                           
                         with elements 
                           
                              
                                 m
                              
                              
                                 i
                                 k
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 J
                              
                           
                           
                              
                                 x
                              
                              
                                 i
                                 j
                                 k
                              
                           
                           
                              
                                 u
                              
                              
                                 j
                              
                           
                        . Similarly, the 3-mode product 
                           
                              X
                           
                           
                              
                                 
                                    
                                       ×
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 3
                              
                           
                           
                              u
                           
                         of a third-order tensor 
                           
                              X
                           
                         of size 
                           
                              (
                              I
                              ,
                              J
                              ,
                              K
                              )
                           
                         and a 
                           K
                        -vector 
                           
                              u
                           
                         is a matrix 
                           
                              M
                           
                         of size 
                           
                              (
                              I
                              ,
                              J
                              )
                           
                         with elements 
                           
                              
                                 m
                              
                              
                                 i
                                 j
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 k
                                 =
                                 1
                              
                              
                                 K
                              
                           
                           
                              
                                 x
                              
                              
                                 i
                                 j
                                 k
                              
                           
                           
                              
                                 u
                              
                              
                                 k
                              
                           
                         (see Fig. 2
                         for a graphical representation of the 
                           n
                        -mode product).


                        2—The 1-mode product 
                           
                              X
                           
                           
                              
                                 ×
                              
                              
                                 1
                              
                           
                           
                              U
                           
                         of a third-order tensor 
                           
                              X
                           
                         of size 
                           
                              (
                              I
                              ,
                              J
                              ,
                              K
                              )
                           
                         with a matrix 
                           
                              U
                           
                         of size 
                           
                              (
                              L
                              ,
                              I
                              )
                           
                         is a third-order tensor 
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 1
                              
                           
                         of size 
                           
                              (
                              L
                              ,
                              J
                              ,
                              K
                              )
                           
                         with elements 
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       l
                                       j
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       I
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       l
                                       i
                                    
                                 
                                 
                                 with  
                                 
                                    (
                                    1
                                    ≤
                                    l
                                    ≤
                                    L
                                    )
                                 
                                 ,
                                 
                                 
                                    (
                                    1
                                    ≤
                                    j
                                    ≤
                                    J
                                    )
                                 
                                   and  
                                 
                                    (
                                    1
                                    ≤
                                    k
                                    ≤
                                    K
                                    )
                                 
                                 .
                              
                           
                        
                     

In the same manner, the 2-mode product 
                           
                              X
                           
                           
                              
                                 ×
                              
                              
                                 2
                              
                           
                           
                              U
                           
                         of a third-order tensor 
                           
                              X
                           
                         of size 
                           
                              (
                              I
                              ,
                              J
                              ,
                              K
                              )
                           
                         and a matrix 
                           
                              U
                           
                         of size 
                           
                              (
                              L
                              ,
                              J
                              )
                           
                         is a third-order tensor 
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 2
                              
                           
                         of size 
                           
                              (
                              I
                              ,
                              L
                              ,
                              K
                              )
                           
                         with elements 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                                 l
                                 k
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 J
                              
                           
                           
                              
                                 x
                              
                              
                                 i
                                 j
                                 k
                              
                           
                           
                              
                                 u
                              
                              
                                 l
                                 j
                              
                           
                        . Similarly, the 3-mode product 
                           
                              X
                           
                           
                              
                                 ×
                              
                              
                                 3
                              
                           
                           
                              U
                           
                         of a third-order tensor 
                           
                              X
                           
                         of size 
                           
                              (
                              I
                              ,
                              J
                              ,
                              K
                              )
                           
                         and a matrix 
                           
                              U
                           
                         of size 
                           
                              (
                              L
                              ,
                              K
                              )
                           
                         is a third-order tensor 
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 3
                              
                           
                         of size 
                           
                              (
                              I
                              ,
                              J
                              ,
                              L
                              )
                           
                         with elements 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                                 j
                                 l
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 k
                                 =
                                 1
                              
                              
                                 K
                              
                           
                           
                              
                                 x
                              
                              
                                 i
                                 j
                                 k
                              
                           
                           
                              
                                 u
                              
                              
                                 l
                                 k
                              
                           
                         (see Fig. 3
                         for a graphical representation of the 
                           n
                        -mode product).

Matricization (also known as unfolding or flattening) attempts to reorganize the elements of a third-order tensor into a matrix.
                           
                              (a)
                              The mode-1 matricization of a third-order tensor 
                                    
                                       X
                                    
                                  is denoted 
                                    
                                       
                                          X
                                       
                                       
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                    
                                  and is obtained as follows: the element 
                                    
                                       
                                          m
                                       
                                       
                                          i
                                          l
                                       
                                    
                                  of a matrix 
                                    
                                       
                                          X
                                       
                                       
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                    
                                  of size 
                                    
                                       (
                                       I
                                       ,
                                       K
                                       ×
                                       J
                                       )
                                    
                                  with 
                                    l
                                    =
                                    1
                                    +
                                    
                                       (
                                       j
                                       −
                                       1
                                       )
                                    
                                    J
                                    +
                                    
                                       (
                                       k
                                       −
                                       1
                                       )
                                    
                                    J
                                    K
                                  corresponds to the elements 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                  of the third-order tensor 
                                    
                                       X
                                    
                                  of size 
                                    
                                       (
                                       I
                                       ,
                                       J
                                       ,
                                       K
                                       )
                                    
                                  (Fig. 4
                                 (a)).

The mode-2 matricization of a third-order tensor 
                                    
                                       X
                                    
                                  is denoted as 
                                    
                                       
                                          X
                                       
                                       
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                    
                                  and is obtained as follows: the element 
                                    
                                       
                                          m
                                       
                                       
                                          j
                                          l
                                       
                                    
                                  of a matrix 
                                    
                                       
                                          X
                                       
                                       
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                    
                                  of size 
                                    
                                       (
                                       J
                                       ,
                                       I
                                       ×
                                       K
                                       )
                                    
                                  with 
                                    l
                                    =
                                    1
                                    +
                                    
                                       (
                                       i
                                       −
                                       1
                                       )
                                    
                                    I
                                    +
                                    
                                       (
                                       j
                                       −
                                       1
                                       )
                                    
                                    I
                                    +
                                    
                                       (
                                       k
                                       −
                                       1
                                       )
                                    
                                    I
                                    K
                                  corresponds to the elements 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                  of the third-order tensor 
                                    
                                       X
                                    
                                  of size 
                                    
                                       (
                                       I
                                       ,
                                       J
                                       ,
                                       K
                                       )
                                    
                                  (Fig. 4(b)).

The mode-3 matricization of a third-order tensor 
                                    
                                       X
                                    
                                  is denoted as 
                                    
                                       
                                          X
                                       
                                       
                                          
                                             (
                                             3
                                             )
                                          
                                       
                                    
                                  and is obtained as follows: the element 
                                    
                                       
                                          m
                                       
                                       
                                          k
                                          l
                                       
                                    
                                  of a matrix 
                                    
                                       
                                          X
                                       
                                       
                                          
                                             (
                                             3
                                             )
                                          
                                       
                                    
                                  of size 
                                    
                                       (
                                       K
                                       ,
                                       J
                                       ×
                                       I
                                       )
                                    
                                  with 
                                    l
                                    =
                                    1
                                    +
                                    
                                       (
                                       i
                                       −
                                       1
                                       )
                                    
                                    I
                                    +
                                    
                                       (
                                       j
                                       −
                                       1
                                       )
                                    
                                    I
                                    J
                                    +
                                    
                                       (
                                       k
                                       −
                                       1
                                       )
                                    
                                    I
                                    J
                                  correspond to the elements 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                  of the third-order tensor 
                                    
                                       X
                                    
                                  of size 
                                    
                                       (
                                       I
                                       ,
                                       J
                                       ,
                                       K
                                       )
                                    
                                  (Fig. 4(c)).

The following definition is necessary to explore the systematic variation patterns in a three-way data set 
                        
                           X
                        
                      of size 
                        
                           (
                           I
                           ,
                           J
                           ,
                           K
                           )
                        
                     , which are likely to predict the systematic variation patterns in the response data matrix 
                        
                           Y
                        
                      of size 
                        
                           (
                           I
                           ,
                           Q
                           )
                        
                     . The multi-way PLS regression model for the mean-centered data 
                        
                           X
                        
                      and 
                        
                           Y
                        
                      is defined as 
                        
                           
                              (1)
                              
                                 
                                    X
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       H
                                    
                                 
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       
                                          X
                                       
                                       ,
                                       h
                                    
                                 
                                 ∘
                                 
                                    
                                       
                                          a
                                       
                                    
                                    
                                       
                                          X
                                       
                                       ,
                                       h
                                    
                                 
                                 ∘
                                 
                                    
                                       
                                          b
                                       
                                    
                                    
                                       
                                          X
                                       
                                       ,
                                       h
                                    
                                 
                                 +
                                 
                                    
                                       
                                          R
                                       
                                    
                                    
                                       
                                          X
                                       
                                    
                                    
                                       
                                          (
                                          H
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                           
                              (2)
                              
                                 
                                    Y
                                 
                                 =
                                 
                                    
                                       
                                          T
                                       
                                    
                                    
                                       
                                          X
                                       
                                    
                                    
                                       
                                          (
                                          H
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          B
                                       
                                    
                                    
                                       
                                          (
                                          H
                                          )
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          R
                                       
                                    
                                    
                                       
                                          Y
                                       
                                    
                                    
                                       
                                          (
                                          H
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        
                     
                  

In Eq. (1), 
                        
                           
                              
                                 t
                              
                           
                           
                              
                                 X
                              
                              ,
                              h
                           
                        
                      denotes the so-called 
                        
                           X
                        
                      scores, 
                        
                           
                              
                                 a
                              
                           
                           
                              
                                 X
                              
                              ,
                              h
                           
                        
                      and 
                        
                           
                              
                                 b
                              
                           
                           
                              
                                 X
                              
                              ,
                              h
                           
                        
                      indicates the 
                        
                           X
                        
                      loadings associated with the second and third mode, and 
                        
                           
                              
                                 R
                              
                           
                           
                              
                                 X
                              
                           
                           
                              
                                 (
                                 H
                                 )
                              
                           
                        
                      denotes the residual part.

In Eq. (2), 
                        
                           
                              
                                 T
                              
                           
                           
                              
                                 X
                              
                           
                           
                              
                                 (
                                 H
                                 )
                              
                           
                        
                        =
                        
                           [
                           
                              
                                 
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                          ,
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                          ,
                                          2
                                       
                                    
                                 
                                 
                                    ⋯
                                 
                                 
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                          ,
                                          H
                                       
                                    
                                 
                              
                           
                           ]
                        
                      is an 
                        I
                        ×
                        H
                      matrix obtained by combining all the 
                        
                           X
                        
                      score vectors 
                        
                           
                              
                                 t
                              
                           
                           
                              
                                 X
                              
                              ,
                              h
                           
                        
                        
                        
                           (
                           h
                           =
                           1
                           ,
                           2
                           …
                           H
                           )
                        
                     .

To estimate model (1), the parameters of the 
                        
                           X
                        
                      scores 
                        
                           
                              
                                 t
                              
                           
                           
                              
                                 X
                              
                              ,
                              h
                           
                        
                      and the 
                        
                           X
                        
                      loadings 
                        
                           (
                           
                              
                                 
                                    a
                                 
                              
                              
                                 
                                    X
                                 
                                 ,
                                 h
                              
                           
                           ,
                           
                              
                                 
                                    b
                                 
                              
                              
                                 
                                    X
                                 
                                 ,
                                 h
                              
                           
                           )
                        
                        
                        
                           (
                           h
                           =
                           1
                           ,
                           2
                           …
                           H
                           )
                        
                      are computed according to the iterative procedure detailed in 3.1.

The matrix 
                        
                           
                              
                                 B
                              
                           
                           
                              
                                 (
                                 H
                                 )
                              
                           
                        
                      in model (2) is estimated as 
                        
                           
                              
                                 B
                              
                           
                           
                              
                                 (
                                 H
                                 )
                              
                           
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       
                                          T
                                       
                                    
                                    
                                       
                                          X
                                       
                                    
                                    
                                       
                                          
                                             
                                                (
                                                H
                                                )
                                             
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          T
                                       
                                    
                                    
                                       
                                          X
                                       
                                    
                                    
                                       
                                          (
                                          H
                                          )
                                       
                                    
                                 
                                 )
                              
                           
                           
                              −
                              1
                           
                        
                        
                           
                              
                                 T
                              
                           
                           
                              
                                 X
                              
                           
                           
                              
                                 (
                                 H
                                 )
                              
                           
                        
                        
                           Y
                        
                     . The columns of 
                        
                           
                              
                                 B
                              
                           
                           
                              
                                 (
                                 H
                                 )
                              
                           
                        
                      are obtained from multiple regressions of each column of 
                        
                           Y
                        
                      on 
                        
                           
                              
                                 T
                              
                           
                           
                              
                                 X
                              
                           
                           
                              
                                 (
                                 H
                                 )
                              
                           
                        
                     . 
                        
                           
                              
                                 R
                              
                           
                           
                              
                                 Y
                              
                           
                           
                              
                                 (
                                 H
                                 )
                              
                           
                        
                      denotes the residual part.

The parameter (
                        H
                     ), i.e., the rank of the tensor 
                        
                           
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              
                                 (
                                 H
                                 )
                              
                           
                        
                        =
                        
                           
                              ∑
                           
                           
                              h
                              =
                              1
                           
                           
                              H
                           
                        
                        
                           
                              
                                 t
                              
                           
                           
                              
                                 X
                              
                              ,
                              h
                           
                        
                        ∘
                        
                           
                              
                                 a
                              
                           
                           
                              
                                 X
                              
                              ,
                              h
                           
                        
                        ∘
                        
                           
                              
                                 b
                              
                           
                           
                              
                                 X
                              
                              ,
                              h
                           
                        
                      to be retained in Eqs. (1) and (2), is usually evaluated using cross-validation (CV) techniques (Kemsley, 1996; Kiers, 2000).

Given a fixed 
                        H
                     , N-PLS proceeds in two stages to compute the 
                        
                           X
                        
                      scores and 
                        
                           X
                        
                      loadings. In the first stage, the parameters (
                        
                           X
                        
                      scores and 
                        
                           X
                        
                      loadings) are computed according to the tri-linear procedure detailed in 3.1. The second stage in N-PLS aims at computing subsequent components (scores and loadings of order higher than 1). This is performed by deflating with respect to the parameters previously computed, as will be detailed in 3.2.

When the 
                              
                                 Y
                              
                            response is an 
                              I
                           -vector, the multi-way PLS regression follows the tri-linear PLS1 procedure to compute the scores and loadings. This procedure is described in Table 1
                           .

As can be observed in Table 1, the procedure starts with the computation of a matrix 
                              
                                 Z
                              
                           . Thereafter, Singular Value Decomposition (SVD) is performed on 
                              
                                 Z
                              
                           . The dominant left and right singular vectors (associated with the largest singular value) are extracted. Then, the 
                              
                                 X
                              
                            score is directly computed.

The elements of the matrix 
                              
                                 Z
                              
                            have a simple interpretation in terms of covariance between a third-order tensor 
                              
                                 X
                              
                            and the single variable 
                              
                                 y
                              
                           . This matrix can be written in 
                              n
                           -mode product notation as 
                              
                                 Z
                              
                              =
                              
                                 X
                              
                              
                                 
                                    
                                       
                                          ×
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    T
                                 
                              
                           . First, the third-order tensor 
                              
                                 X
                              
                            is considered as a collection of 
                              
                                 (
                                 J
                                 ,
                                 K
                                 )
                              
                            centered columns denoted 
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    j
                                    k
                                 
                              
                           . Second the covariance of each 
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    j
                                    k
                                 
                              
                            and that of 
                              
                                 y
                              
                            are computed, leading to the following 
                              
                                 (
                                 J
                                 ,
                                 K
                                 )
                              
                            matrix: 
                              
                                 (3)
                                 
                                    
                                       
                                          z
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          I
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    =
                                    
                                       (
                                       I
                                       −
                                       1
                                       )
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          I
                                       
                                    
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                       
                                       
                                          
                                             (
                                             I
                                             −
                                             1
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       (
                                       I
                                       −
                                       1
                                       )
                                    
                                    
                                       cov
                                    
                                    
                                       (
                                       
                                          y
                                       
                                       ,
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             
                                                X
                                             
                                          
                                          
                                             j
                                             k
                                          
                                       
                                       )
                                    
                                 
                              
                            where 
                              
                                 cov
                              
                              
                                 (
                                 
                                    y
                                 
                                 ,
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       
                                          X
                                       
                                    
                                    
                                       j
                                       k
                                    
                                 
                                 )
                              
                            denotes the covariance between 
                              
                                 y
                              
                            and 
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    j
                                    k
                                 
                              
                           . The equality (3) holds because 
                              
                                 X
                              
                            and 
                              
                                 y
                              
                            are centered. The matrix 
                              
                                 Z
                              
                            contains the covariance between 
                              
                                 X
                              
                            and 
                              
                                 y
                              
                           . Fig. 5
                            presents how the matrix 
                              
                                 Z
                              
                            is calculated.

On other hand, the 
                              
                                 X
                              
                            score 
                              
                                 
                                    t
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    J
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    K
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    k
                                 
                              
                              ;
                              
                                 (
                                 1
                                 ≤
                                 i
                                 ≤
                                 I
                                 )
                              
                           , which can be equivalently written as 
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                              
                              =
                              
                                 X
                              
                              
                                 
                                    
                                       
                                          ×
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       a
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          ×
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    
                                       b
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                              
                           , can also be seen as a component or latent variable or projection to the latent structure, which is built using a linear combination from the third-order tensor 
                              
                                 X
                              
                           . The 
                              
                                 X
                              
                            score 
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                              
                            has the same meaning as scores in the case of ordinary PLS Regression.

When the 
                              
                                 Y
                              
                            response is a matrix, N-PLS follows the tri-linear PLS2 procedure. The parameters (
                              
                                 X
                              
                            scores, 
                              
                                 X
                              
                            loadings, 
                              
                                 Y
                              
                            scores and 
                              
                                 Y
                              
                            loadings) are computed according to an iterative procedure as follows:

In Table 2
                           , 
                              s
                            denotes the current iteration. Steps 2–4 can be viewed as a tri-linear PLS1 procedure (Table 1) applied to 
                              
                                 X
                              
                            and 
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       Y
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                           .

The tri-linear PLS2 procedure iterates in the following way: The procedure starts with a normalized vector 
                              
                                 
                                    
                                       a
                                    
                                 
                                 
                                    
                                       Y
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                           ; then, the 
                              
                                 Y
                              
                            score 
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       Y
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       Y a
                                    
                                 
                                 
                                    
                                       Y
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                            is computed. Thereafter, the matrix 
                              
                                 
                                    
                                       Z
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              =
                              
                                 [
                                 
                                    
                                       z
                                    
                                    
                                       j
                                       k
                                    
                                    
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                 
                                 ]
                              
                              
                              
                                 
                                    z
                                 
                                 
                                    j
                                    k
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    I
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    
                                       Y
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                    i
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                            and the pair 
                              
                                 (
                                 
                                    
                                       
                                          a
                                       
                                    
                                    
                                       
                                          X
                                       
                                    
                                    
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          b
                                       
                                    
                                    
                                       
                                          X
                                       
                                    
                                    
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                 
                                 )
                              
                            corresponding to the singular vectors associated with the largest singular value of 
                              
                                 
                                    
                                       Z
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                            are extracted. Therefore, the 
                              
                                 X
                              
                            score 
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                            is computed. Finally, the 
                              
                                 Y
                              
                            loading vector is updated using 
                              
                                 
                                    
                                       a
                                    
                                 
                                 
                                    
                                       Y
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       +
                                       1
                                       )
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       Y
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              /
                              
                                 
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   s
                                                   )
                                                
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             Y Y
                                          
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                 
                              
                           .

One can observe that steps 2 and 4 of the tri-linear PLS2 procedure can be written in the 
                              n
                           -mode product notations, considering that 
                              
                                 
                                    
                                       Z
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              =
                              
                                 X
                              
                              
                                 
                                    
                                       
                                          ×
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       Y
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                            and that 
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              =
                              
                                 X
                              
                              
                                 
                                    
                                       
                                          ×
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       a
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          ×
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    
                                       b
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                           .

The steps described in Table 2 are iterated over 
                              s
                            until convergence is achieved. After convergence, 
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                    ,
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       a
                                    
                                 
                                 
                                    
                                       X
                                    
                                    ,
                                    1
                                 
                              
                            and 
                              
                                 
                                    
                                       b
                                    
                                 
                                 
                                    
                                       X
                                    
                                    ,
                                    1
                                 
                              
                            are obtained, and Eqs. (1) and (2) can be evaluated. It should be noted that the convergence of the tri-linear PLS2 procedure is often observed in practice, but to our knowledge, no formal mathematical proof is available.

The second stage in NPLS regression attempts to compute subsequent components (scores and loadings of order higher than 1). This is performed on the residual part with respect to the 
                           
                              X
                           
                         scores and 
                           
                              X
                           
                         loadings previously computed.

Assume that at the current level 
                           
                              
                                 H
                              
                              
                                 0
                              
                           
                        , 
                           
                              X
                           
                         scores 
                           
                              
                                 
                                    t
                                 
                              
                              
                                 
                                    X
                                 
                                 ,
                                 h
                              
                           
                         and 
                           
                              X
                           
                         loadings 
                           
                              
                                 
                                    a
                                 
                              
                              
                                 
                                    X
                                 
                                 ,
                                 h
                              
                           
                           ,
                           
                              
                                 
                                    b
                                 
                              
                              
                                 
                                    X
                                 
                                 ,
                                 h
                              
                           
                           
                           
                              (
                              h
                              =
                              1
                              ,
                              2
                              …
                              
                                 
                                    H
                                 
                                 
                                    0
                                 
                              
                              )
                           
                         have already been computed. Then, in the next level, the tri-linear PLS2 procedure is repeated by replacing the current data 
                           
                              (
                              
                                 X
                              
                              ,
                              
                                 Y
                              
                              )
                           
                         with 
                           
                              (
                              
                                 
                                    
                                       R
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             H
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       R
                                    
                                 
                                 
                                    
                                       Y
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             H
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                              
                              )
                           
                        , which is defined as 
                           
                              
                                 (4)
                                 
                                    
                                       
                                          
                                             R
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   H
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       X
                                    
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   H
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                              
                                 (5)
                                 
                                    
                                       
                                          
                                             R
                                          
                                       
                                       
                                          
                                             Y
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   H
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       Y
                                    
                                    −
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   H
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             B
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   H
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 h
                                 =
                                 1
                              
                              
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           
                              
                                 
                                    t
                                 
                              
                              
                                 
                                    X
                                 
                                 ,
                                 h
                              
                           
                           ∘
                           
                              
                                 
                                    a
                                 
                              
                              
                                 
                                    X
                                 
                                 ,
                                 h
                              
                           
                           ∘
                           
                              
                                 
                                    b
                                 
                              
                              
                                 
                                    X
                                 
                                 ,
                                 h
                              
                           
                         in (3); the columns of 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                              
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   H
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    )
                                 
                              
                              
                                 −
                                 1
                              
                           
                           
                              
                                 
                                    T
                                 
                              
                              
                                 
                                    X
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                              
                           
                           
                              Y
                           
                         in (4), which is obtained from multiple regression on each column of 
                           
                              Y
                           
                         on 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 
                                    X
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                              
                           
                           =
                           
                              [
                              
                                 
                                    
                                       
                                          
                                             
                                                t
                                             
                                          
                                          
                                             
                                                X
                                             
                                             ,
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                t
                                             
                                          
                                          
                                             
                                                X
                                             
                                             ,
                                             2
                                          
                                       
                                    
                                    
                                       ⋯
                                    
                                    
                                       
                                          
                                             
                                                t
                                             
                                          
                                          
                                             
                                                X
                                             
                                             ,
                                             
                                                
                                                   H
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ]
                           
                        ; and 
                           
                              
                                 
                                    t
                                 
                              
                              
                                 
                                    X
                                 
                                 ,
                                 h
                              
                           
                           
                           
                              (
                              1
                              ≤
                              h
                              ≤
                              
                                 
                                    H
                                 
                                 
                                    0
                                 
                              
                              )
                           
                         are the 
                           
                              X
                           
                         scores.

From the computational point of view, it is clear that, whereas the first stage (i.e., the computation of scores and loadings by the iterative Tri-linear PLS2) needs further investigation, the second stage of the multi-way PLS regression method (i.e., the deflation stage) does not present any computational issues (while 
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   H
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    )
                                 
                              
                              
                                 −
                                 1
                              
                           
                         exists, or, equivalently, 
                           
                              
                                 H
                              
                              
                                 0
                              
                           
                           ≤
                           
                              rank
                           
                           
                              (
                              
                                 
                                    
                                       T
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                              
                              )
                           
                        ).

Relevant algorithmic properties related to the convergence of the solution and the optimality of parameters (scores and loadings can be considered as solutions to the optimization problem) are reported in Table 3
                        .

When 
                           
                              Y
                           
                         is a single variable, multi-way PLS regression does not pose any computational problems because the tri-linear PLS1 procedure is not iterative. Thus, as clearly presented by Bro (1996), 
                           
                              X
                           
                         scores can be characterized as optimal because they are solutions of the following optimization problem: 
                           
                              
                                 
                                    
                                       Maximize cov
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                    
                                    ,
                                    
                                       y
                                    
                                    )
                                 
                                 
                                 under the constraint  
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       
                                          X
                                       
                                    
                                 
                                 =
                                 
                                    X
                                 
                                 
                                    
                                       
                                          
                                             ×
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          a
                                       
                                    
                                    
                                       
                                          X
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ×
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       
                                          b
                                       
                                    
                                    
                                       
                                          X
                                       
                                    
                                 
                                   and  
                                 
                                    ‖
                                    
                                       
                                          
                                             a
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                    
                                    ‖
                                 
                                 =
                                 
                                    ‖
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                    
                                    ‖
                                 
                                 =
                                 1
                                 .
                              
                           
                        
                     

When 
                           
                              Y
                           
                         is a matrix, proof of convergence of the tri-linear PLS2 procedure is not available. In contrast, no apparent optimization is provided to characterize the parameters (scores and loadings) of the method. Therefore, multi-way PLS regression needs further investigation, which is presented in the following section.

Iteratively, the tri-linear PLS2 procedure, as described in Section  3.2, generates five sequences denoted as follows: 
                        
                           (i)
                           
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                             
                                             
                                                
                                                   (
                                                   s
                                                   )
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       s
                                       ≥
                                       0
                                    
                                 
                               is the sequence of 
                                 
                                    X
                                 
                               scores.


                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                             
                                             
                                                
                                                   (
                                                   s
                                                   )
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       s
                                       ≥
                                       0
                                    
                                 
                               is the sequence of 
                                 
                                    Y
                                 
                               scores.


                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   a
                                                
                                             
                                             
                                                
                                                   X
                                                
                                             
                                             
                                                
                                                   (
                                                   s
                                                   )
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       s
                                       ≥
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   b
                                                
                                             
                                             
                                                
                                                   X
                                                
                                             
                                             
                                                
                                                   (
                                                   s
                                                   )
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       s
                                       ≥
                                       0
                                    
                                 
                               are the two sequences of 
                                 
                                    X
                                 
                               loadings.


                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   a
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                             
                                             
                                                
                                                   (
                                                   s
                                                   )
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       s
                                       ≥
                                       0
                                    
                                 
                               is the sequence of 
                                 
                                    Y
                                 
                               loadings.

The following section is dedicated to the analysis of these sequences. Two monotony properties for the sequences (i)–(iv) generated by the tri-linear PLS2 procedure will be established. As a consequence, the monotony convergence of this procedure is proven.

In this section, two additional sequences are introduced, in order to better discuss the monotony convergence of tri-linear PLS2 as well as the optimality properties of scores and loadings of multi-way PLS. These two real sequences are defined as 
                        
                           
                              (6)
                              
                                 
                                    
                                       α
                                    
                                    
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          cov
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             Y
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    )
                                 
                              
                           
                           
                              (7)
                              
                                 
                                    
                                       β
                                    
                                    
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ‖
                                          
                                             Z
                                          
                                          −
                                          
                                             
                                                λ
                                             
                                             
                                                
                                                   (
                                                   s
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   a
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                             
                                             
                                                
                                                   (
                                                   s
                                                   )
                                                
                                             
                                          
                                          ∘
                                          
                                             
                                                
                                                   a
                                                
                                             
                                             
                                                
                                                   X
                                                
                                             
                                             
                                                
                                                   (
                                                   s
                                                   )
                                                
                                             
                                          
                                          ∘
                                          
                                             
                                                
                                                   b
                                                
                                             
                                             
                                                
                                                   X
                                                
                                             
                                             
                                                
                                                   (
                                                   s
                                                   )
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                      where in (7), 
                        
                           
                              λ
                           
                           
                              
                                 (
                                 s
                                 )
                              
                           
                        
                        =
                        
                           cov
                        
                        
                           (
                           
                              
                                 
                                    t
                                 
                              
                              
                                 
                                    X
                                 
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                           ,
                           
                              
                                 
                                    t
                                 
                              
                              
                                 
                                    Y
                                 
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                           )
                        
                     , and the third-order tensor 
                        
                           Z
                        
                      is defined as 
                        
                           Z
                        
                        =
                        
                           X
                        
                        
                           
                              ×
                           
                           
                              1
                           
                        
                        
                           
                              
                                 Y
                              
                           
                           
                              T
                           
                        
                     . Here, the tensor 
                        
                           Z
                        
                      is called the covariance tensor between 
                        
                           X
                        
                      and 
                        
                           Y
                        
                      (Fig. 6
                     ).

The following property relates the two sequences 
                        
                           
                              α
                           
                           
                              
                                 (
                                 s
                                 )
                              
                           
                        
                      and 
                        
                           
                              β
                           
                           
                              
                                 (
                                 s
                                 )
                              
                           
                        
                      as always summing to a constant. 
                        Property 1
                        
                           At each iteration 
                           
                              s
                           
                           , the following equality holds:
                           
                              
                                 (8)
                                 
                                    
                                       
                                          β
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    +
                                    
                                       
                                          α
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ‖
                                             
                                                Z
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        


                           The proof can be found in   
                              Appendix  A.1
                           .
                        


                        
                           Property 2
                           
                              At each iteration 
                              
                                 s
                              
                              , the following inequality holds:
                              
                                 
                                    (9)
                                    
                                       
                                          
                                             α
                                          
                                          
                                             
                                                (
                                                s
                                                )
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                cov
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                             
                                             
                                                
                                                   (
                                                   s
                                                   )
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                             
                                             
                                                
                                                   (
                                                   s
                                                   )
                                                
                                             
                                          
                                          )
                                       
                                       ≤
                                       
                                          
                                             
                                                cov
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                             
                                             
                                                
                                                   (
                                                   s
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                             
                                             
                                                
                                                   (
                                                   s
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             α
                                          
                                          
                                             
                                                (
                                                s
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                              The proof of   
                                 Property  2   can be found in   
                                 Appendix  A.2
                              .
                           


                        Property 2 is the core of the monotony results presented in this section. For a better understanding of its meaning, it is illustrated with simulated data. Five couples of centered data (one couple = one third-order tensor set 
                           
                              X
                           
                         and one matrix  
                           
                              Y
                           
                        ) were randomly generated and a tri-linear PLS2 procedure performed to compute scores from each of them. For each iteration 
                           s
                        , 
                           
                              
                                 α
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                           =
                           
                              
                                 
                                    cov
                                 
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       Y
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              )
                           
                         (the square of the covariance between scores) is computed. The evolution of 
                           
                              
                                 α
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                         is shown in Fig. 7
                        .

When 
                           s
                         increases, it can be observed that the sequence 
                           
                              
                                 α
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                           =
                           
                              
                                 
                                    cov
                                 
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       Y
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              )
                           
                         regularly increases until reaching a maximum value. This rise is found for every initial value of the covariance defined by the initialization step of the procedure.


                        Property 2 helps one understand how the 
                           
                              X
                           
                         scores and 
                           
                              Y
                           
                         scores are related when the tri-linear PLS2 is iterated. The interpretation is straightforward because tri-linear PLS2 entails finding an 
                           
                              X
                           
                         score and a 
                           
                              Y
                           
                         score recovering as much covariance (relation) as possible between 
                           
                              X
                           
                         and 
                           
                              Y
                           
                        .


                        Property 2 focused only on the monotony of the sequences of scores generated by the tri-linear PLS2 procedure through the sequence 
                           
                              
                                 α
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                           =
                           
                              
                                 
                                    cov
                                 
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       Y
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              )
                           
                        . The interest now is to analyze the three sequences of loadings. This analysis requires the covariance tensor 
                           
                              Z
                           
                         between 
                           
                              X
                           
                         and 
                           
                              Y
                           
                        . This tensor 
                           
                              Z
                           
                         and the sequence 
                           
                              
                                 β
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                         provide an interesting description of the sequences of loadings generated by tri-linear PLS2, as summarized in the following monotony property. 
                           Property 3
                           
                              At each iteration 
                              
                                 s
                              
                              , the following inequality holds:
                              
                                 
                                    (10)
                                    
                                       
                                          
                                             β
                                          
                                          
                                             
                                                (
                                                s
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ‖
                                                
                                                   Z
                                                
                                                −
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      
                                                         (
                                                         s
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                   
                                                   
                                                      
                                                         Y
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         s
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                
                                                ∘
                                                
                                                   
                                                      
                                                         a
                                                      
                                                   
                                                   
                                                      
                                                         X
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         s
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                
                                                ∘
                                                
                                                   
                                                      
                                                         b
                                                      
                                                   
                                                   
                                                      
                                                         X
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         s
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ≤
                                       
                                          
                                             
                                                ‖
                                                
                                                   Z
                                                
                                                −
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      
                                                         (
                                                         s
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                   
                                                   
                                                      
                                                         Y
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         s
                                                         )
                                                      
                                                   
                                                
                                                ∘
                                                
                                                   
                                                      
                                                         a
                                                      
                                                   
                                                   
                                                      
                                                         X
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         s
                                                         )
                                                      
                                                   
                                                
                                                ∘
                                                
                                                   
                                                      
                                                         b
                                                      
                                                   
                                                   
                                                      
                                                         X
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         s
                                                         )
                                                      
                                                   
                                                
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             β
                                          
                                          
                                             
                                                (
                                                s
                                                )
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                              
                                 Property  3   directly results from the combination of   
                                 Properties  1 and 2
                              . Substituting 
                              
                                 
                                    
                                       β
                                    
                                    
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ‖
                                          
                                             Z
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       α
                                    
                                    
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                 
                                 (
                              
                                 Property  1
                              ) in 
                              
                                 
                                    
                                       α
                                    
                                    
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                 
                                 ≤
                                 
                                    
                                       α
                                    
                                    
                                       
                                          (
                                          s
                                          +
                                          1
                                          )
                                       
                                    
                                 
                                 (
                              
                                 Property  2
                              ) leads to
                              (10)
                              .
                           

At iteration 
                           s
                        , 
                           
                              
                                 β
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                         can be interpreted as the quadratic error approximation of 
                           
                              Z
                           
                         by the rank-one tensor 
                           
                              
                                 λ
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                           
                              
                                 
                                    a
                                 
                              
                              
                                 
                                    Y
                                 
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                           ∘
                           
                              
                                 
                                    a
                                 
                              
                              
                                 
                                    X
                                 
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                           ∘
                           
                              
                                 
                                    b
                                 
                              
                              
                                 
                                    X
                                 
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                        . By stating Property 3, it is shown that the tri-linear PLS2 procedure attempts to extract the best rank-one approximation of the covariance tensor 
                           
                              Z
                           
                        . This property is also interpreted in a manner whereby the tri-linear PLS2 iterative procedure tries to estimate the so-called PARAFAC model, as applied to the covariance tensor 
                           
                              Z
                           
                        . This is an important bridge, enabling the connection between these two models.


                        
                           Property 4
                           
                              The two sequences 
                              
                                 
                                    
                                       α
                                    
                                    
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       β
                                    
                                    
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                 
                               
                              are convergent.
                           


                              This property is a direct consequence of   
                                 Properties  2 and 3
                              . The convergence of the sequence 
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                
                                                   (
                                                   s
                                                   )
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       s
                                       ≥
                                       1
                                    
                                 
                               
                              comes from a well-known theorem in real analysis, which states that each monotonic and bounded real sequence is convergent (
                              Sudhir and Balmohan, 2010
                              ).
                           

The sequence 
                           
                              
                                 α
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                           =
                           
                              
                                 
                                    cov
                                 
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       Y
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              )
                           
                         (with 
                           
                              
                                 β
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                           =
                           
                              
                                 
                                    ‖
                                    
                                       Z
                                    
                                    −
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             a
                                          
                                       
                                       
                                          
                                             Y
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    ∘
                                    
                                       
                                          
                                             a
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    ∘
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    ‖
                                 
                              
                              
                                 2
                              
                           
                        ) is monotonously increasing (Property 2) (respectively monotonously decreasing (Property 3)). Property 1 shows that both sequences 
                           
                              
                                 α
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 β
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                         are bounded. Therefore, the sequences 
                           
                              
                                 α
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 β
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                         converge. It follows that a stopping rule in the Tri-linear PLS2 procedure can be stated by checking that the sequence 
                           
                              
                                 α
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                         ceases to increase (respectively 
                           
                              
                                 β
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                         ceases to decrease) by more than a pre-specified (small) threshold.

Using Property 3, it is shown that Tri-linear PLS2 entails finding a best rank-one approximation of the covariance tensor 
                        
                           Z
                        
                     . Three procedures can be found in the literature for computing the best rank-one approximation of a tensor. Therefore, these methods can be seen as alternatives to computing loadings for multi-way PLS regression. In the present section, the three procedures are briefly presented.

The first alternative to tri-linear PLS2, Alternative Least-squares (ALS) was reported by Kolda and Bader (2009). ALS has been proposed in the general case to compute the best rank-
                        R
                        
                        
                           (
                           R
                           ≥
                           1
                           )
                        
                      approximation of a tensor. This procedure was applied here to the tensor 
                        
                           Z
                        
                      in the particular case 
                        R
                        =
                        1
                     . As a consequence, some simplifications of the original ALS procedure are possible, leading to a simple form, as described in Table 4
                     .

The two other alternative procedures, the Update Higher-order Power Method (UPM) and the Joint Update Higher-order Power Method (JUPM), were proposed by De Lathauwer et al. (2000). These procedures have been proposed for tensors of order possibly greater than 3. Here, these two methods were applied to the tensor 
                        
                           Z
                        
                     , as described in Table 4.

First, the covariance tensor 
                        
                           Z
                        
                      is computed, and subsequently, each procedure is initialized and iterated until convergence is obtained leading to 
                        
                           X
                        
                      loadings and 
                        
                           Y
                        
                      loadings. Thereafter, the scores are computed as 
                        
                           
                              
                                 t
                              
                           
                           
                              
                                 X
                              
                           
                        
                        =
                        
                           X
                        
                        
                           
                              
                                 
                                    ×
                                 
                                 
                                    ̄
                                 
                              
                           
                           
                              2
                           
                        
                        
                           
                              
                                 a
                              
                           
                           
                              X
                           
                        
                        
                           
                              
                                 
                                    ×
                                 
                                 
                                    ̄
                                 
                              
                           
                           
                              3
                           
                        
                        
                           
                              
                                 b
                              
                           
                           
                              X
                           
                        
                     .

To visualize the behavior of the four procedures, a simulation was performed. The aim of this simulation was to highlight that the sequences generated by the four procedures are different, showing that the four procedures can lead to different results. Two data sets 
                        
                           X
                        
                      and 
                        
                           Y
                        
                      (
                        
                           X
                        
                      being a third-order data set, and 
                        
                           Y
                        
                      being a matrix having the same number of rows as the first mode of 
                        
                           X
                        
                     ) were randomly generated. The procedures were initialized with the same vectors at the first iteration (
                        s
                        =
                        0
                     ). Next, each procedure was iterated five times, and the least-squares criteria 
                        
                           (
                           
                              
                                 β
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                           )
                        
                      was evaluated at each iteration. The results obtained are shown in Fig. 8
                     , each curve representing one procedure, as variations in 
                        
                           
                              β
                           
                           
                              
                                 (
                                 s
                                 )
                              
                           
                        
                      over the five iterations.

It can be observed in Fig. 8, that the four procedures (Tri-linear PLS2, ALS1, UPM and JUPM) are quite different because they generate different sequences of loadings; even if the four curves have the same starting point (i.e., identical initialization values), differences in the solutions are visible starting from the second iteration. Therefore, these four procedures cannot be regarded as equivalent from a computational point of view.

Because the algorithms behave differently between iterations (they generate different sequences), they should not necessarily converge to the same end points. It may seem surprising that algorithms proposed to solve the same problem produce different results, but this phenomenon is a result of each algorithm depending on randomly chosen starting vectors. Two simulations based on different initialization conditions can therefore produce slightly different solutions. In this respect, these algorithms can only guarantee a local solution, and they cannot guarantee a globally optimal solution. Moreover, the trilinear PLS2, as with the other algorithms, does not minimize the least-squares criterion 
                        β
                     , but it does monotonically decrease 
                        β
                     , until convergence. Similarly, the ALS procedure does not minimize 
                        β
                     ; therefore, it cannot always provide the lowest function value, as shown in Fig. 8. As a consequence, the ALS procedure is not guaranteed to find the best solution.

@&#CONCLUSION@&#

The present paper has provided a clarification on computational mechanisms in multi-way PLS. The properties of monotony highlighted the convergence of the procedure and allowed a better understanding of the goal of the method, i.e., maximizing the square covariance between scores or minimizing the quadratic error between the covariance tensor and a tensor of rank 1 formed from the loadings.

In practical terms, these results offer a guarantee of the proper operation of tri-linear PLS2 and create the possibility of using alternative procedures when requested. These methods not necessarily lead to the same end points and a closer comparison of their computational aspects would be of great interest. This topic is however beyond the scope of the present article and will be the subject of future work.

The results of this study also helped to highlight the important role of the covariance tensor in the multi-way PLS regression method. This tensor highlights, at least computationally, the link between multi-way PLS regression and the well-known PARAFAC model. These two methods remain, however, very different from a data analysis perspective because they serve different purposes, i.e., describing the variability of a tensor in PARAFAC and explaining a response matrix of several variables from a data tensor in multi-way PLS.

The proof of Property 1 results from developing 
                           β
                           
                              (
                              s
                              )
                           
                         as follows (recall that 
                           
                              
                                 λ
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                           =
                           
                              cov
                           
                           
                              (
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       Y
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              )
                           
                        ): 
                           
                              (11)
                              
                                 
                                    
                                       β
                                    
                                    
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ‖
                                          
                                             Z
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          cov
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             Y
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 −
                                 2
                                 
                                    
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    〈
                                    
                                       Z
                                    
                                    ,
                                    
                                       
                                          
                                             a
                                          
                                       
                                       
                                          
                                             Y
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    ∘
                                    
                                       
                                          
                                             a
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    ∘
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    〉
                                 
                                 .
                              
                           
                        
                     

By remarking that 
                           
                              〈
                              
                                 Z
                              
                              ,
                              
                                 
                                    
                                       a
                                    
                                 
                                 
                                    
                                       Y
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              ∘
                              
                                 
                                    
                                       a
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              ∘
                              
                                 
                                    
                                       b
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              〉
                           
                           =
                           
                              cov
                           
                           
                              (
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    
                                       Y
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              )
                           
                        , we have 
                           
                              (12)
                              
                                 
                                    
                                       β
                                    
                                    
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ‖
                                          
                                             Z
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       
                                          cov
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             Y
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          ‖
                                          
                                             Z
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       α
                                    
                                    
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        
                     


                        Property 2 states that the sequence of score vectors 
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    )
                                 
                              
                              
                                 s
                                 ≥
                                 0
                              
                           
                           ,
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             Y
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    )
                                 
                              
                              
                                 s
                                 ≥
                                 0
                              
                           
                         generated iteratively by the Tri-linear PLS2 procedure verifies the following property: 
                           
                              (13)
                              
                                 
                                    
                                       
                                          cov
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             Y
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 ≤
                                 
                                    
                                       
                                          cov
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             Y
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 ;
                                 
                                 s
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 .
                              
                           
                        
                     

First, consider the following maximization problem: 
                           
                              (14)
                              
                                 
                                    
                                       Maximize cov
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             Y a
                                          
                                       
                                       
                                          
                                             Y
                                          
                                       
                                    
                                    )
                                 
                                   under the constraint  
                                 
                                    ‖
                                    
                                       
                                          
                                             a
                                          
                                       
                                       
                                          
                                             Y
                                          
                                       
                                    
                                    ‖
                                 
                                 =
                                 1
                                 .
                              
                           
                        
                     

The following solution can be easily found: 
                           
                              
                                 
                                    a
                                 
                              
                              
                                 
                                    Y
                                 
                              
                              
                                 
                                    (
                                    s
                                    +
                                    1
                                    )
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          Y
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       
                                          X
                                       
                                    
                                    
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                 
                              
                              
                                 
                                    ‖
                                    
                                       
                                          
                                             Y
                                          
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    ‖
                                 
                              
                           
                        . Because 
                           
                              
                                 
                                    a
                                 
                              
                              
                                 
                                    Y
                                 
                              
                              
                                 
                                    (
                                    s
                                    +
                                    1
                                    )
                                 
                              
                           
                         is a solution of (14), it follows that 
                           
                              (15)
                              
                                 
                                    
                                       
                                          cov
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             Y a
                                          
                                       
                                       
                                          
                                             Y
                                          
                                       
                                    
                                    )
                                 
                                 ≤
                                 
                                    
                                       
                                          cov
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             Y
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 
                                 for every  
                                 
                                    
                                       
                                          a
                                       
                                    
                                    
                                       
                                          Y
                                       
                                    
                                 
                                   with  
                                 
                                    ‖
                                    
                                       
                                          
                                             a
                                          
                                       
                                       
                                          
                                             Y
                                          
                                       
                                    
                                    ‖
                                 
                                 =
                                 1
                                 .
                              
                           
                        
                     

Inequality (15) is valid in particular for 
                           
                              
                                 
                                    a
                                 
                              
                              
                                 
                                    Y
                                 
                              
                              
                                 
                                    (
                                    s
                                    )
                                 
                              
                           
                        , which verifies that 
                           
                              ‖
                              
                                 
                                    
                                       a
                                    
                                 
                                 
                                    
                                       Y
                                    
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                              ‖
                           
                           =
                           1
                        , and it follows that 
                           
                              (16)
                              
                                 
                                    
                                       
                                          cov
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             Y a
                                          
                                       
                                       
                                          
                                             Y
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 ≤
                                 
                                    
                                       
                                          cov
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             Y
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

Second, consider the following maximization problem: 
                           
                              (17)
                              
                                 
                                    
                                       Maximize cov
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             Y
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    )
                                 
                                   under the constraint  
                                 
                                    ‖
                                    
                                       
                                          
                                             a
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                    
                                    ‖
                                 
                                 =
                                 
                                    ‖
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                    
                                    ‖
                                 
                                 =
                                 1
                                 .
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       
                                          X
                                       
                                    
                                 
                                 =
                                 
                                    X
                                 
                                 
                                    
                                       
                                          
                                             ×
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          a
                                       
                                    
                                    
                                       X
                                    
                                 
                                 
                                    
                                       
                                          
                                             ×
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       
                                          b
                                       
                                    
                                    
                                       X
                                    
                                 
                                 .
                              
                           
                        
                     

The solution of problem (16) is the 
                           
                              X
                           
                         score and 
                           
                              X
                           
                         loadings associated with the tri-linear PLS1 of 
                           
                              
                                 
                                    t
                                 
                              
                              
                                 
                                    Y
                                 
                              
                              
                                 
                                    (
                                    s
                                    +
                                    1
                                    )
                                 
                              
                           
                         on 
                           
                              X
                           
                        . It follows that: 
                           
                              (18)
                              
                                 
                                    
                                       
                                          cov
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             Y
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 ≤
                                 
                                    
                                       
                                          cov
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             Y
                                          
                                       
                                       
                                          
                                             (
                                             s
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

Combining (15) and (18) leads to (9).

@&#REFERENCES@&#

