@&#MAIN-TITLE@&#Soft-constrained inference for Named Entity Recognition

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Named Entity Recognition is addressed by constraining inference in CRF.


                        
                        
                           
                           An two phases integer linear programming approach is proposed.


                        
                        
                           
                           Complex relationships among labels are automatically extracted from data.


                        
                        
                           
                           Extracted relationships are introduced as soft constraints in the ILP formulation.


                        
                        
                           
                           The proposed method significantly outperforms the state of the art approach.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Conditional Random Fields

Named Entity Recognition

Rule extraction

Integer linear programming

@&#ABSTRACT@&#


               
               
                  Much of the valuable information in supporting decision making processes originates in text-based documents. Although these documents can be effectively searched and ranked by modern search engines, actionable knowledge need to be extracted and transformed in a structured form before being used in a decision process. In this paper we describe how the discovery of semantic information embedded in natural language documents can be viewed as an optimization problem aimed at assigning a sequence of labels (hidden states) to a set of interdependent variables (textual tokens). Dependencies among variables are efficiently modeled through Conditional Random Fields, an indirected graphical model able to represent the distribution of labels given a set of observations. The Markov property of these models prevent them to take into account long-range dependencies among variables, which are indeed relevant in Natural Language Processing. In order to overcome this limitation we propose an inference method based on Integer Programming formulation of the problem, where long distance dependencies are included through non-deterministic soft constraints.
               
            

@&#INTRODUCTION@&#

The data used by Decision Support Systems are assumed to be structured and quantifiable. However, thanks to the growing of the web and the spread of Document Management Systems, most of the valuable information are embedded in textual documents that need to be processed to extract relevant information in a machine readable form to become actionable. In most of the cases this activity involves the analysis of human language texts by means of Natural Language Processing (NLP) techniques. Named Entity Recognition (NER) is the task aimed at identifying and associating atomic elements in a given text to a set of predefined categories such as names of persons, organizations, locations, dates, and quantities.

Early NER systems have been defined as rule-based approaches with a set of fixed and manually coded rules provided by domain experts (Rau, 1991; Lehnert et al., 1993; Riloff, 1993; Appelt, Hobbs, Bear, Israel, & Tyson, 1993). Considering the costs, in terms of human effort, to reveal and formulate hand-crafted rules, several research communities ranging from Statistical Analysis to Natural Language Processing and Machine Learning have provided valuable contributions for automatically derive models able to detect and categorize pre-defined entities. The first tentatives, aimed at deriving these rules under the form of boolean conditions, are based on inductive learner where rules can be learnt automatically from labeled examples. The inductive rule learning approach has been instantiated according to different learning paradigm: bottom-up (Califf & Mooney, 2003; Califf & Mooney, 1999; Ciravegna, 2001), top-down (Soderland, 1999; Quinlan, 1990; Landwehr, Kersting, & Raedt, 2007; Ho & Nguyen, 2003) and interactive rule learning (Khaitan, Ramakrishnan, Joshi, & Chalamalla, 2008; Bohannon et al., 2009; Beckerle, Martucci, & Ries, 2010).

An alternative approach to inductive rule learners is represented by statistical methods, where the NER task is viewed as a decision making process aimed at assigning a sequence of labels to a set of either joint or interdependent variables, where also complex relationships may hold among them. This decision making paradigm can be addressed in two different ways: (1) at segment-level (Sarawagi & Cohen, 2004; Daumé & Marcu, 2005; Galen, 2006), where the NER task is managed as a segmentation problem in which each segment corresponds to an entity label and (2) at token level (Takeuchi & Collier, 2002; Seymore, McCallum, & Rosenfeld, 1999; Ratnaparkhi, 1999; Richardson & Domingos, 2006; Lafferty, McCallum, & Pereira, 2001), where an entity label is assigned to each token of the sentence. In the first case the output of the decision process is a sequence of segments. More formally, a segmentation s of an input sentence 
                        
                           x
                           =
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 N
                              
                           
                        
                      is a sequence of segments 
                        
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           …
                           
                              
                                 s
                              
                              
                                 p
                              
                           
                        
                      with 
                        
                           p
                           ⩽
                           N
                        
                     . Each segment 
                        
                           
                              
                                 s
                              
                              
                                 j
                              
                           
                        
                      consists of a start position 
                        
                           
                              
                                 l
                              
                              
                                 j
                              
                           
                        
                     , an end position 
                        
                           
                              
                                 u
                              
                              
                                 j
                              
                           
                        
                     , and a label y belonging to a set of entity labels 
                        
                           Y
                        
                     . The second decision making paradigm is represented by token-level models, where the unstructured text is tackled as a sequence of tokens and the output of the decision process is a sequence of labels 
                        
                           y
                           =
                           
                              
                                 y
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 y
                              
                              
                                 N
                              
                           
                        
                     .

Nowadays, the state of the art to model a NER problem is represented by Linear Chain Conditional Random Fields (Lafferty et al., 2001). This model, thanks to its advantages over generative approaches, has been extensively investigated to extract named entities from different unstructured sources such as judicial transcriptions (Fersini, Messina, Archetti, & Cislaghi, 2013; Fersini & Messina, 2013), medical reports (Cvejic, Zhang, Marx, & Tjoe, 2012; Deléger et al., 2013), and user generated contents (Qi & Chen, 2010; Shariaty & Moghaddam, 2011). The efficiency of Linear Chain Conditional Random Fields (CRF) is strictly related to the underlying Markov assumption: given the observation of a token, the corresponding hidden state (label) depends only on the labels of its adjacent tokens. In order to efficiently enhance the description power of CRF, during the last ten years several approaches have been proposed to enlarge the information set exploited during training and inference. In particular, two main research directions have been investigated: (1) relaxing the Markov assumption (Sarawagi & Cohen, 2004; Galen, 2006) to model long distance relationships and (2) introducing additional domain knowledge in terms of logical constraints during the inference phase (Kristjansson, Culotta, Viola, & McCallum, 2004; Roth & Yih, 2005; Chang, Ratinov, & Roth, 2007; Chang, Ratinov, & Roth, 2008). Considering that the relaxation of the Markov assumption implies an increasing computational complexity related to the training and inference phase, in this paper we focused our attention on an integer linear programming (ILP) formulation of the inference problem by including soft constraints obtained by learning declarative rules from data.

The introduction of constraints allows us to improve the global label assignment by correcting mistakes of local predictions. The label assignment problem is therefore solved through a constrained optimization problem where the extra-knowledge related to complex relationships among variables is represented through a set of logical rules easily introduced as linear inequalities. This approach, as shown by the experimental results, makes it possible to significantly improve the performances of CRF in NER tasks.

The outline of the paper is the following. In Section 2 a brief review of CRF is presented along with a background overview of the training phase, together with the most relevant inference approaches able to include domain constraints. In Section 3 the proposed soft-constrained inference approach is detailed by focusing on learning constraints from data and by presenting its mathematical programming formulation. In Section 4 the experimental investigation on both benchmark and datasets is described, while in Section 5 conclusions and ongoing research are summarized.

A Conditional Random Field is an indirected graphical model that defines the joint distribution 
                        
                           P
                           (
                           y
                           |
                           x
                           )
                        
                      of the predicted labels (hidden states) 
                        
                           y
                           =
                           
                              
                                 y
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 y
                              
                              
                                 N
                              
                           
                        
                      given the corresponding tokens (observations) 
                        
                           x
                           =
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 N
                              
                           
                        
                     . Now, consider X as the random variable over data sequences (natural language sentences) to be labeled, and Y is the random variable over corresponding label sequences over a finite label alphabet 
                        
                           Y
                        
                     . The joint distribution 
                        
                           P
                           (
                           X
                           ,
                           Y
                           )
                        
                      is represented by a conditional model 
                        
                           P
                           (
                           Y
                           |
                           X
                           )
                        
                      from paired observation and label sequences, and the marginal probability 
                        
                           p
                           (
                           X
                           )
                        
                      is not explicitly model. The formal definition of CRF (Lafferty et al., 2001) is given below:
                        Definition 1
                        Conditional Random Fields


                        Let 
                              
                                 G
                                 =
                                 (
                                 V
                                 ,
                                 E
                                 )
                              
                            be a graph such that 
                              
                                 Y
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             Y
                                          
                                          
                                             v
                                          
                                       
                                       )
                                    
                                    
                                       v
                                       ∈
                                       V
                                    
                                 
                              
                           , so that Y is indexed by the vertices of G. Then 
                              
                                 (
                                 X
                                 ,
                                 Y
                                 )
                              
                            is a Conditional Random Field, when conditioned on X, the random variables 
                              
                                 
                                    
                                       Y
                                    
                                    
                                       v
                                    
                                 
                              
                            obey the Markov property with respect to the graph: 
                              
                                 p
                                 (
                                 
                                    
                                       Y
                                    
                                    
                                       v
                                    
                                 
                                 |
                                 X
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       w
                                    
                                 
                                 ,
                                 w
                                 
                                 ≠
                                 
                                 v
                                 )
                                 =
                                 p
                                 (
                                 
                                    
                                       Y
                                    
                                    
                                       v
                                    
                                 
                                 |
                                 X
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       w
                                    
                                 
                                 ,
                                 w
                                 ∼
                                 v
                                 )
                              
                           , where 
                              
                                 w
                                 ∼
                                 v
                              
                            means that w and v are neighbors in G.

Thus, a CRF is a random field globally conditioned on the observation X. Throughout the paper we tacitly assume that the graph G is fixed. A Linear-Chain Conditional Random Field is a Conditional Random Field in which the output nodes are linked by edges in a linear chain. The graphical representation of a general CRF and a Linear-Chain CRF is reported in Fig. 1
                     . In the following, Linear-Chain CRF are assumed.

According to the Hammersley–Clifford theorem (Hammersley & Clifford, 1971; Clifford, 1990), given 
                        
                           C
                        
                      as the set of all cliques in G, the conditional probability distribution of a sequence of labels y given a sentence x can be written as:
                        
                           (1)
                           
                              p
                              (
                              y
                              |
                              x
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    Z
                                    (
                                    x
                                    )
                                 
                              
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       C
                                       ∈
                                       C
                                    
                                 
                              
                              
                                 
                                    Φ
                                 
                                 
                                    C
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    C
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    C
                                 
                              
                              )
                           
                        
                     where 
                        
                           
                              
                                 Φ
                              
                              
                                 C
                              
                           
                        
                      represents the set of maximal cliques 
                        
                           C
                           ∈
                           C
                        
                     , the vertices 
                        
                           
                              
                                 x
                              
                              
                                 C
                              
                           
                        
                      and 
                        
                           
                              
                                 y
                              
                              
                                 C
                              
                           
                        
                      of the clique C correspond to hidden states y and observations x, and 
                        
                           Z
                           (
                           x
                           )
                           ∈
                           [
                           0
                           ,
                           1
                           ]
                        
                      is the partition function for global normalization. Formally 
                        
                           Z
                           (
                           x
                           )
                        
                      is defined as:
                        
                           (2)
                           
                              Z
                              (
                              x
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       y
                                    
                                    
                                       |
                                       Y
                                       |
                                    
                                 
                              
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       C
                                       ∈
                                       C
                                    
                                 
                              
                              
                                 
                                    Φ
                                 
                                 
                                    C
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    C
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    C
                                 
                              
                              )
                           
                        
                     
                  

In order to compute the joint probability distribution (Eq. (1)), a set of potential functions must be defined over configurations of the maximal cliques in the underlying graph. The potential functions, which state the prior probability that elements of the clique C have certain values, can be conveniently simplified as inner products between a parameter vector 
                        
                           ω
                        
                      and a set of feature function f. Considering that each clique 
                        
                           
                              
                                 Φ
                              
                              
                                 C
                              
                           
                           (
                           ·
                           )
                           ∈
                           C
                        
                      can encode one or more potential functions (in this case we consider the log-linear ones), the probability of a sequence of label y given the sequence of observations x can be rewritten as:
                        
                           (3)
                           
                              p
                              (
                              y
                              |
                              x
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    Z
                                    (
                                    x
                                    )
                                 
                              
                              exp
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                t
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                K
                                             
                                          
                                       
                                       
                                          
                                             ω
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                       x
                                       ,
                                       t
                                       )
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 f
                              
                              
                                 k
                              
                           
                           (
                           
                              
                                 y
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 t
                                 -
                                 1
                              
                           
                           x
                           ,
                           t
                           )
                        
                      is an arbitrary feature function over its arguments and 
                        
                           
                              
                                 ω
                              
                              
                                 k
                              
                           
                        
                      is a feature weight that is a free parameter in the model. Feature functions are fixed in advance and are used to verify some properties of the input text, while the weights 
                        
                           
                              
                                 ω
                              
                              
                                 k
                              
                           
                        
                      have to be learned from data and are used to tune the discriminative power of each feature function. In particular when for a token 
                        
                           
                              
                                 x
                              
                              
                                 t
                              
                           
                        
                      a given feature function 
                        
                           
                              
                                 f
                              
                              
                                 k
                              
                           
                        
                      is active, i.e. a given property is verified, the corresponding weight 
                        
                           
                              
                                 ω
                              
                              
                                 k
                              
                           
                        
                      indicates how to take into account 
                        
                           
                              
                                 f
                              
                              
                                 k
                              
                           
                        
                     : (1) if 
                        
                           
                              
                                 ω
                              
                              
                                 k
                              
                           
                           >
                           0
                        
                      it increases the probability of the tag sequence y and (2) if 
                        
                           
                              
                                 ω
                              
                              
                                 k
                              
                           
                           <
                           0
                        
                      it decreases the probability of the tag sequence y; (3) if 
                        
                           
                              
                                 ω
                              
                              
                                 k
                              
                           
                           =
                           0
                        
                      has no effect whatsoever.

The partition function 
                        
                           Z
                           (
                           x
                           )
                        
                      assumes the form:
                        
                           (4)
                           
                              Z
                              (
                              x
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       y
                                    
                                    
                                       |
                                       Y
                                       |
                                    
                                 
                              
                              
                                 
                                    
                                       exp
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                K
                                             
                                          
                                       
                                       
                                          
                                             ω
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                       ,
                                       x
                                       ,
                                       t
                                       )
                                    
                                 
                              
                           
                        
                     
                  

The conditional probability distribution of Linear-Chain CRF can be estimated by exploiting two different kinds of feature functions such that 
                        
                           p
                           (
                           y
                           |
                           x
                           )
                        
                      can be rewritten as follows:
                        
                           (5)
                           
                              p
                              (
                              y
                              |
                              x
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    Z
                                    (
                                    x
                                    )
                                 
                              
                              exp
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                t
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                |
                                                I
                                                |
                                             
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       x
                                       ,
                                       t
                                       )
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                |
                                                J
                                                |
                                             
                                          
                                       
                                       
                                          
                                             μ
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             j
                                          
                                       
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       x
                                       ,
                                       t
                                       )
                                    
                                 
                              
                           
                        
                     where I and J represent the given and fixed set of state feature function 
                     
                        
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                           (
                           
                              
                                 y
                              
                              
                                 t
                              
                           
                           ,
                           x
                           ,
                           t
                           )
                        
                      and transition feature function 
                     
                        
                           
                              
                                 t
                              
                              
                                 j
                              
                           
                           (
                           
                              
                                 y
                              
                              
                                 t
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 t
                              
                           
                           ,
                           x
                           ,
                           t
                           )
                        
                     , while 
                        
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                        
                      and 
                        
                           
                              
                                 μ
                              
                              
                                 j
                              
                           
                        
                      are the corresponding weights to be estimated from training data. State feature function and transition feature function model respectively the sequence of observations x with respect to the current state 
                        
                           
                              
                                 y
                              
                              
                                 t
                              
                           
                        
                      and the transition from the previous state 
                        
                           
                              
                                 y
                              
                              
                                 t
                                 -
                                 1
                              
                           
                        
                      to the current state 
                        
                           
                              
                                 y
                              
                              
                                 t
                              
                           
                        
                     . The parameters 
                        
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                        
                      and 
                        
                           
                              
                                 μ
                              
                              
                                 j
                              
                           
                        
                      are used to weight the corresponding state and transition feature function.

The choice of the feature functions strongly depends from the application context. For instance, an example of state feature function is
                        
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                              
                              ,
                              x
                              ,
                              t
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      t
                                                   
                                                
                                                =
                                                PERSON
                                                
                                                and
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      t
                                                   
                                                
                                                =
                                                John
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     while a transition feature function could be
                        
                           
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                              
                              ,
                              x
                              ,
                              t
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      t
                                                      -
                                                      1
                                                   
                                                
                                                =
                                                PERSON
                                                
                                                and
                                                
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      t
                                                   
                                                
                                                =
                                                DATE
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     In our case, where the CRF are assumed in a linear form, transition feature functions are assumed to verify dependencies between a label y at time t and its previous y values, while state feature functions evaluate Word Features to check whether a given token is present in the dictionary in a particular state, Start Features and End Features to check if a given label is a start and/or an end label.

The learning problem in CRF relates to the identification of the best feature functions 
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                              
                              ,
                              x
                              ,
                              t
                              )
                           
                         and 
                           
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                              
                              ,
                              x
                              ,
                              t
                              )
                           
                         by unrevealing the corresponding weights 
                           
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    μ
                                 
                                 
                                    j
                                 
                              
                           
                        . These parameters can be quantified either by exploiting some background domain knowledge or by learning from training data. When no background knowledge is available, several learning approaches can be adopted for estimating 
                           
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    μ
                                 
                                 
                                    j
                                 
                              
                           
                        . Among them a widely used approach consists of maximizing the conditional log-likelihood of the training data. Given a training set 
                           
                              T
                           
                         composed of training samples 
                           
                              (
                              x
                              ,
                              y
                              )
                           
                        , with y ranging in the set 
                           
                              Y
                           
                         of entity labels, the conditional (penalized) log-likelihood is defined as follows:
                           
                              (6)
                              
                                 L
                                 (
                                 T
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          ∈
                                          T
                                       
                                    
                                 
                                 log
                                 p
                                 (
                                 y
                                 |
                                 x
                                 ,
                                 λ
                                 ,
                                 μ
                                 )
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          |
                                          I
                                          |
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          |
                                          J
                                          |
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             j
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             μ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          ∈
                                          T
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          |
                                          I
                                          |
                                       
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 x
                                 ,
                                 t
                                 )
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          |
                                          J
                                          |
                                       
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 x
                                 ,
                                 t
                                 )
                                 -
                                 log
                                 Z
                                 (
                                 x
                                 )
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          |
                                          I
                                          |
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          |
                                          J
                                          |
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             j
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             μ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        where the terms 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    |
                                    I
                                    |
                                 
                              
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    2
                                    
                                       
                                          σ
                                       
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    |
                                    J
                                    |
                                 
                              
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          j
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    2
                                    
                                       
                                          σ
                                       
                                       
                                          μ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                         map a Gaussian prior on 
                           
                              λ
                           
                         and 
                           
                              μ
                           
                         used for avoiding over-fitting.

The objective function 
                           
                              L
                              (
                              T
                              )
                           
                         is concave, and therefore both parameters 
                           
                              λ
                           
                         and 
                           
                              μ
                           
                         have a unique set of global optimal values. A standard approach to parameter learning computes the gradient of the objective function to be used in an optimization algorithm (Lafferty et al., 2001; Sutton, 2008; Nocedal & Wright, 2000; Malouf, 2002). Among them we choose the quasi-Newton approach known as Limited-memory Broyden–Fletcher–Goldfarb–Shanno (L-BFGS) (Malouf, 2002) due the main advantage of providing a dramatic speedups in case of huge number of feature functions.

The inference problem in CRF corresponds to find the most likely sequence of hidden state 
                           
                              
                                 
                                    y
                                 
                                 
                                    ∗
                                 
                              
                           
                        , given the set of observation 
                           
                              x
                              =
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    N
                                 
                              
                           
                        . This problem can be solved approximately or exactly by determining 
                           
                              
                                 
                                    y
                                 
                                 
                                    ∗
                                 
                              
                           
                         such that:
                           
                              (7)
                              
                                 
                                    
                                       y
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 arg
                                 
                                    
                                       
                                          max
                                       
                                       
                                          y
                                       
                                    
                                 
                                 
                                 p
                                 (
                                 y
                                 |
                                 x
                                 )
                              
                           
                        
                     

The most common approach to tackle the inference problem is represented by the Viterbi algorithm (Baum & Petrie, 1966). Now, consider 
                           
                              
                                 
                                    δ
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                              
                              =
                              y
                              |
                              x
                              )
                           
                         as the probability of the most likely path of generating the sequence 
                           
                              
                                 
                                    y
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                              
                           
                        . This path can be derived by one of the most probable paths that could have generated the subsequence 
                           
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    y
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                           
                        . Formally, given 
                           
                              
                                 
                                    δ
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                              
                              =
                              y
                              |
                              x
                              )
                           
                         as:
                           
                              (8)
                              
                                 
                                    
                                       δ
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 y
                                 |
                                 x
                                 )
                                 =
                                 
                                    
                                       
                                          max
                                       
                                       
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 p
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 x
                                 )
                              
                           
                        we can derive the induction step as:
                           
                              (9)
                              
                                 
                                    
                                       δ
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       ′
                                    
                                 
                                 |
                                 x
                                 )
                                 =
                                 
                                    
                                       
                                          max
                                       
                                       
                                          y
                                          ∈
                                          Y
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          y
                                          |
                                          x
                                          )
                                          
                                             
                                                Φ
                                             
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          max
                                       
                                       
                                          y
                                          ∈
                                          Y
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          y
                                          |
                                          x
                                          )
                                          exp
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            k
                                                            =
                                                            1
                                                         
                                                         
                                                            K
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   y
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ,
                                                   x
                                                   ,
                                                   t
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The recursion terminates in 
                           
                              
                                 
                                    y
                                 
                                 
                                    ∗
                                 
                              
                              =
                              arg
                              
                                 
                                    max
                                 
                                 
                                    y
                                 
                              
                              [
                              
                                 
                                    δ
                                 
                                 
                                    T
                                 
                              
                              (
                              y
                              )
                              ]
                           
                        , allowing the backtrack to recover 
                           
                              
                                 
                                    y
                                 
                                 
                                    ∗
                                 
                              
                           
                        .

CRF, in their native form, are able to capture some local properties through the definition of transition and state feature functions. However, some more complex relationships among output variables (labels to be predicted) could exist when addressing NER problems. For instance, when annotating scientific citations the label Author should appear anywhere before the label Title.

Two different strategies are suitable to include relationships in the probabilistic model: the feature way and the constraint way. The first one is concerned with the training phase by the definition of feature functions able to capture different kinds of relationships (Sarawagi & Cohen, 2004). The second one relates to the introduction of constraints during the inference phase for preserving the necessary relationships over the output prediction (Kristjansson et al., 2004; Roth & Yih, 2005; Chang et al., 2007; Chang, Ratinov, & Roth, 2012). While the first strategy might lead to intractable training and inference due to the necessity of learning additional parameters or defining higher order models, the second paradigm allows us to keep the model simple by enclosing expressive constraints directly during the inference phase. In this context we can distinguish between constraining the Viterbi algorithm (Kristjansson et al., 2004; Culotta, Kristjansson, McCallum, & Viola, 2006) and formulating the inference process as a constrained optimization problem.

The main idea underlying the Constrained Viterbi algorithm is concerned with the clamping of some hidden variables to particular values. The resulting algorithm alters the induction step outlined in Eq. (9) such that 
                        
                           
                              
                                 y
                              
                              
                                 ∗
                              
                           
                        
                      is constrained to pass through a given sub-path C. The related constraint 
                        
                           
                              
                                 C
                              
                              
                                 ^
                              
                           
                        
                      can be encoded in the induction step as follows:
                        
                           (10)
                           
                              
                                 
                                    δ
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                              |
                              x
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         max
                                                      
                                                      
                                                         y
                                                         ∈
                                                         Y
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         (
                                                         y
                                                         )
                                                         exp
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           ∑
                                                                        
                                                                        
                                                                           k
                                                                           =
                                                                           1
                                                                        
                                                                        
                                                                           K
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        ω
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        f
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                                  (
                                                                  
                                                                     
                                                                        y
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        y
                                                                     
                                                                     
                                                                        t
                                                                        +
                                                                        1
                                                                     
                                                                  
                                                                  ,
                                                                  x
                                                                  ,
                                                                  t
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      ^
                                                   
                                                
                                                
                                                is
                                                
                                                satisfied
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     For time steps not involved in C Eq. (8) is used instead, restricting the algorithm to only consider paths that respect the defined constraint.

Although the Constrained Viterbi algorithm is suitable to deal with short distance relationships in an efficient way, the introduction of non-local and non-sequential constraints makes this solution no longer applicable. In order to deal with more complex relationships, the inference process can be formulated as a constrained optimization problem and in particular as a shortest path problem. A simple representation of a labeling shortest path problem is given in Fig. 2
                     .

Given n tokens and m labels that each token can take, we can define a graph 
                        
                           Ω
                           =
                           (
                           Φ
                           ,
                           Ψ
                           )
                        
                      as composed of 
                        
                           nm
                           +
                           2
                        
                      nodes and 
                        
                           (
                           n
                           -
                           1
                           )
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           +
                           2
                           m
                        
                      edges.
                        1
                        Two special nodes denoting the start and end positions of the path are additionally introduced.
                     
                     
                        1
                      The label of each token is represented by a node 
                        
                           
                              
                                 ϕ
                              
                              
                                 ty
                              
                           
                        
                     , where 
                        
                           0
                           ⩽
                           t
                           ⩽
                           n
                           -
                           1
                        
                      and 
                        
                           0
                           ⩽
                           y
                           ⩽
                           m
                           -
                           1
                        
                     , while the arc connecting two adjacent nodes 
                        
                           
                              
                                 ϕ
                              
                              
                                 (
                                 t
                                 -
                                 1
                                 )
                                 y
                              
                           
                        
                      and 
                        
                           
                              
                                 ϕ
                              
                              
                                 
                                    
                                       ty
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      is denoted by a directed edge 
                        
                           
                              
                                 ψ
                              
                              
                                 t
                                 ,
                                 
                                    
                                       yy
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      with the associated cost 
                        
                           
                              
                                 c
                              
                              
                                 
                                    
                                       yy
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 t
                              
                           
                           =
                           -
                           log
                           (
                           
                              
                                 M
                              
                              
                                 t
                              
                           
                           (
                           
                              
                                 yy
                              
                              
                                 ′
                              
                           
                           |
                           x
                           )
                           )
                        
                     .
                        2
                        The weight of each edge corresponds to the exponential in Eq. (5).
                     
                     
                        2
                      The problem consists in minimizing the cost of visiting the nodes 
                        
                           
                              
                                 ϕ
                              
                              
                                 
                                    
                                       ty
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      along the entire path:
                        
                           (11)
                           
                              arg
                              
                                 
                                    
                                       min
                                    
                                    
                                       y
                                    
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       0
                                    
                                    
                                       n
                                       -
                                       1
                                    
                                 
                              
                              log
                              (
                              
                                 
                                    M
                                 
                                 
                                    t
                                 
                              
                              (
                              y
                              ,
                              
                                 
                                    y
                                 
                                 
                                    ′
                                 
                              
                              )
                              |
                              x
                              )
                              =
                              arg
                              
                                 
                                    
                                       max
                                    
                                    
                                       y
                                    
                                 
                              
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       t
                                       =
                                       0
                                    
                                    
                                       n
                                       -
                                       1
                                    
                                 
                              
                              log
                              (
                              
                                 
                                    M
                                 
                                 
                                    t
                                 
                              
                              (
                              y
                              ,
                              
                                 
                                    y
                                 
                                 
                                    ′
                                 
                              
                              )
                              |
                              x
                              )
                           
                        
                     The goal defined in Eq. (11), which corresponds to find the shortest path along the graph 
                        
                           Ω
                        
                     , can be formulated as an integer linear programming problem that allow us to introduce additional background knowledge in terms of constraints. Let 
                        
                           
                              
                                 e
                              
                              
                                 t
                                 ,
                                 
                                    
                                       yy
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      denote a decision variable restricted to be 1 if the edge 
                        
                           
                              
                                 ψ
                              
                              
                                 t
                                 ,
                                 
                                    
                                       yy
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      is in the shortest path and 0 otherwise. The ILP formulation for the shortest path problem
                        3
                        The shortest path problem solution corresponds to the output of the Viterbi algorithm.
                     
                     
                        3
                      can be formalized as follows:
                        
                           (12)
                           
                              
                                 max
                              
                              
                              Z
                              (
                              e
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             
                                                0
                                                ⩽
                                                t
                                                ⩽
                                                n
                                                -
                                                1
                                             
                                             
                                                0
                                                ⩽
                                                y
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ⩽
                                                m
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              
                              log
                              
                                 
                                    M
                                 
                                 
                                    t
                                 
                              
                              (
                              y
                              ,
                              
                                 
                                    y
                                 
                                 
                                    ′
                                 
                              
                              )
                              ·
                              
                                 
                                    e
                                 
                                 
                                    t
                                    ,
                                    
                                       
                                          yy
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (13)
                           
                              s
                              .
                              t
                              .
                              :
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       0
                                       ⩽
                                       
                                          
                                             y
                                          
                                          
                                             1
                                          
                                       
                                       ⩽
                                       m
                                       -
                                       1
                                    
                                 
                              
                              
                              
                                 
                                    e
                                 
                                 
                                    t
                                    -
                                    1
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          1
                                       
                                    
                                    y
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       0
                                       ⩽
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       ⩽
                                       m
                                       -
                                       1
                                    
                                 
                              
                              
                              
                                 
                                    e
                                 
                                 
                                    t
                                    ,
                                    
                                       
                                          yy
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              =
                              0
                           
                        
                     
                     
                        
                           (14)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       0
                                       ⩽
                                       y
                                       ⩽
                                       m
                                       -
                                       1
                                    
                                 
                              
                              
                              
                                 
                                    e
                                 
                                 
                                    start
                                    ,
                                    0
                                    y
                                 
                              
                              =
                              1
                              
                              and
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       0
                                       ⩽
                                       y
                                       ⩽
                                       m
                                       -
                                       1
                                    
                                 
                              
                              
                              
                                 
                                    e
                                 
                                 
                                    end
                                    ,
                                    y
                                    0
                                 
                              
                              =
                              1
                           
                        
                     
                     
                        
                           (15)
                           
                              
                                 
                                    e
                                 
                                 
                                    start
                                    ,
                                    0
                                    y
                                 
                              
                              ,
                              
                              
                                 
                                    e
                                 
                                 
                                    t
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          1
                                       
                                    
                                    y
                                 
                              
                              ,
                              
                              
                                 
                                    e
                                 
                                 
                                    end
                                    ,
                                    y
                                    0
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                           
                        
                     
                     
                        
                           (16)
                           
                              ∀
                              t
                              ,
                              
                              y
                              
                              s
                              .
                              t
                              .
                              
                              0
                              ⩽
                              i
                              ⩽
                              n
                              -
                              1
                              ,
                              
                              0
                              ⩽
                              y
                              ,
                              
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              ⩽
                              m
                              -
                              1
                           
                        
                     Any relationships that should be preserved over the output prediction could be smoothly represented as Boolean function and therefore introduced as linear inequalities constraints (Zuev, 1985). Nevertheless, this approach is based on two main assumptions: (1) constraints must be manually defined by a domain expert and (2) constraints must be satisfied, i.e. they are hard constraints. The implications arisen are concerned with the time consuming activity on defining boolean functions and the satisfiability of constraints with respect to training and testing data (otherwise possible infeasible solutions could be obtained). In order to overcome the mentioned weak points, a combination of learning constraints from data and a two-stages ILP approach is proposed.

In this section we outline in detail the approach proposed in this paper. First we describe a general approach to extract from the available data additional knowledge in the form of logic rules. Then we describe how such knowledge can be embedded in a mathematical model as soft constraints, by relaxing the inference procedure and using a set of additional constraints whose violation is minimized in the objective function.

In order to provide a completely automated Named Entity extraction process, with no need of human effort to define and include domain specific complex relationships, we defined a procedure for learning constraints from data. In a sequential labeling issue, the problem of finding out valuable knowledge can be viewed as a discovery process aimed at revealing common patterns within training data and a subsequent extraction of logical relationships from the identified patterns. The identification of some common patterns and their extraction from data in the form of logic rules is formulated, as originally proposed in Felici and Truemper (2002, 2005), as a sequence of minimum cost satisfiability problems. These problems are solved efficiently with an ad hoc algorithm based on the decomposition strategies presented in Truemper (2004). The method adopts a standard learning paradigm where the different tag labels are the classes and the logic rules that are found are able to separate the samples of one class from the samples of the other classes optimizing the information used to define the logic rules with the aim of controlling the performances of the system in a desired direction. The formulas so obtained are in disjunctive normal form (DNF), i.e. they are composed by the disjunction of one or more conjunctive clauses. A specific characteristic of this method is that these clauses have decreasing discrimination power and thus they can be pruned according to their power and to the importance that is given to the rules that explain the outliers that may be present in the training data. Moreover, each conjunctive clause can be easily associated with an integer linear constraints with standard techniques.

Interesting logic relationship that are extracted from data may fall into one of the following categories:
                              
                                 •
                                 
                                    Adjacency: if label A is associated to token 
                                       
                                          
                                             
                                                x
                                             
                                             
                                                t
                                             
                                          
                                       
                                    , then label B must be associated to token 
                                       
                                          
                                             
                                                x
                                             
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          (17)
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      0
                                                      ⩽
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ⩽
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   A
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      0
                                                      ⩽
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ⩽
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   t
                                                   ,
                                                   
                                                      
                                                         By
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             ⩽
                                             0
                                          
                                       
                                    
                                 


                                    Precedence: if label A is associated to token 
                                       
                                          
                                             
                                                x
                                             
                                             
                                                t
                                             
                                          
                                       
                                    , then label B should be associated to token 
                                       
                                          
                                             
                                                x
                                             
                                             
                                                t
                                                +
                                                z
                                             
                                          
                                       
                                    
                                    
                                       
                                          (18)
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      0
                                                      ⩽
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ⩽
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   A
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               0
                                                               ⩽
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               ⩽
                                                               m
                                                               -
                                                               1
                                                            
                                                            
                                                               0
                                                               ⩽
                                                               z
                                                               ⩽
                                                               n
                                                               -
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   t
                                                   +
                                                   z
                                                   ,
                                                   
                                                      
                                                         By
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             ⩽
                                             0
                                          
                                       
                                    
                                 


                                    State Change: if 
                                       
                                          
                                             
                                                x
                                             
                                             
                                                t
                                             
                                          
                                       
                                     is a given delimiter punctuation mark (d), then label A and label B should be associated to token 
                                       
                                          
                                             
                                                x
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                x
                                             
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                       
                                     respectively
                                       
                                          (19)
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      0
                                                      ⩽
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ⩽
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                             2
                                             (
                                             
                                                
                                                   e
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   d
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      0
                                                      ⩽
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ⩽
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   t
                                                   -
                                                   2
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   A
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      0
                                                      ⩽
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      ⩽
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   t
                                                   ,
                                                   
                                                      
                                                         By
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             ⩽
                                             0
                                          
                                       
                                    
                                 


                                    Begin-End: if label A is associated to token 
                                       
                                          
                                             
                                                x
                                             
                                             
                                                0
                                             
                                          
                                       
                                    , then label B should be associated to token 
                                       
                                          
                                             
                                                x
                                             
                                             
                                                n
                                                -
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          (20)
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      0
                                                      ⩽
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ⩽
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   1
                                                   ,
                                                   
                                                      
                                                         Ay
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      0
                                                      ⩽
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ⩽
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   n
                                                   -
                                                   1
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   B
                                                
                                             
                                             ⩽
                                             0
                                          
                                       
                                    
                                 


                                    Presence and Precedence: if label A appears, then label B cannot appear before label A
                                    
                                       
                                          (21)
                                          
                                             m
                                             (
                                             t
                                             -
                                             2
                                             )
                                             
                                                
                                                   e
                                                
                                                
                                                   t
                                                   ,
                                                   
                                                      
                                                         Ay
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                               ⩽
                                                               z
                                                               ⩽
                                                               t
                                                               -
                                                               2
                                                            
                                                            
                                                               0
                                                               ⩽
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               ⩽
                                                               m
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             (
                                             1
                                             -
                                             
                                                
                                                   e
                                                
                                                
                                                   z
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   B
                                                
                                             
                                             )
                                             ⩽
                                             0
                                             
                                             with
                                             
                                             2
                                             ⩽
                                             t
                                             ⩽
                                             n
                                             
                                             and
                                             
                                             0
                                             ⩽
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             ⩽
                                             m
                                             -
                                             1
                                          
                                       
                                    
                                 

These rules are not necessarily satisfied by all training sentences and a fortiori by data during the inference phase. Therefore introducing these constraints could easily lead to feasibility problems. For this reason we enclosed in each linear equality constraint h a variable 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       h
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                              
                           , which will indicate when a given logical relationships could not be preserved over the output prediction. The constraints associated with the rules can thus be represented in a compact way with the notation:
                              
                                 
                                    L
                                    ·
                                    e
                                    -
                                    σ
                                    ⩽
                                    0
                                 
                              
                           where L is a matrix composed of H rows containing the coefficients of the components of vector e for each of the H constraints, and 
                              
                                 σ
                              
                            is the binary vector of size H representing the violation of the constraints.

In order to introduce the automatically learned logical rules for constraining the inference phase without occurring in feasibility problems, a twofold approach is proposed. The first step is aimed at determining the optimal solution of the shortest path by solving the problem formulation presented in Eqs. (12)–(14), i.e. to determine the optimal solution 
                              
                                 
                                    
                                       e
                                    
                                    
                                       t
                                       ,
                                       
                                          
                                             yy
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                              
                            equivalent to the one solved by Viterbi algorithm. Concerning the second step, we introduce a set of constraints in order to identify a labeling solution consistent with the logical rules previously extracted, while ensuring a good approximation first step Viterbi solution. In order to ensure feasibility we allow for a violation of this constraints, which however must be penalized. The second step, is therefore targeted at minimizing the cost of violating these of constraints, and is formulated as follows:
                              
                                 (22)
                                 
                                    
                                       min
                                    
                                    
                                    Z
                                    (
                                    σ
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             h
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          h
                                       
                                    
                                 
                              
                           
                           
                              
                                 (23)
                                 
                                    s
                                    .
                                    t
                                    .
                                    :
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   
                                                      0
                                                      ⩽
                                                      i
                                                      ⩽
                                                      n
                                                      -
                                                      1
                                                   
                                                   
                                                      0
                                                      ⩽
                                                      y
                                                      ,
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ⩽
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    log
                                    
                                       
                                          M
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    y
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          ′
                                       
                                    
                                    |
                                    x
                                    )
                                    ·
                                    
                                       
                                          e
                                       
                                       
                                          t
                                          ,
                                          
                                             
                                                yy
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    ⩾
                                    τ
                                    Z
                                    
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   t
                                                   ,
                                                   
                                                      
                                                         yy
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   ∗
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (24)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             0
                                             ⩽
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             ⩽
                                             m
                                             -
                                             1
                                          
                                       
                                    
                                    
                                    
                                       
                                          e
                                       
                                       
                                          t
                                          -
                                          1
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          y
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             0
                                             ⩽
                                             
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                             ⩽
                                             m
                                             -
                                             1
                                          
                                       
                                    
                                    
                                    
                                       
                                          e
                                       
                                       
                                          t
                                          ,
                                          
                                             
                                                yy
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    0
                                 
                              
                           
                           
                              
                                 (25)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             0
                                             ⩽
                                             y
                                             ⩽
                                             m
                                             -
                                             1
                                          
                                       
                                    
                                    
                                    
                                       
                                          e
                                       
                                       
                                          -
                                          1
                                          ,
                                          0
                                          y
                                       
                                    
                                    =
                                    1
                                    
                                    and
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             0
                                             ⩽
                                             y
                                             ⩽
                                             m
                                             -
                                             1
                                          
                                       
                                    
                                    
                                    
                                       
                                          e
                                       
                                       
                                          n
                                          ,
                                          y
                                          0
                                       
                                    
                                    =
                                    1
                                 
                              
                           
                           
                              
                                 (26)
                                 
                                    L
                                    ·
                                    e
                                    -
                                    σ
                                    ⩽
                                    0
                                 
                              
                           
                           
                              
                                 (27)
                                 
                                    
                                       
                                          e
                                       
                                       
                                          -
                                          1
                                          ,
                                          0
                                          y
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          e
                                       
                                       
                                          t
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          y
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          e
                                       
                                       
                                          n
                                          ,
                                          y
                                          0
                                       
                                    
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                              
                           
                           
                              
                                 (28)
                                 
                                    ∀
                                    t
                                    ,
                                    y
                                    
                                    s
                                    .
                                    t
                                    .
                                    
                                    0
                                    ⩽
                                    t
                                    ⩽
                                    n
                                    -
                                    1
                                    ,
                                    0
                                    ⩽
                                    y
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    ⩽
                                    m
                                    -
                                    1
                                 
                              
                           
                           
                              
                                 (29)
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          h
                                       
                                    
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    }
                                    ,
                                    
                                    h
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    H
                                 
                              
                           The objective function (22) is penalized whenever a logical relationship is violated, i.e. when 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       h
                                    
                                 
                                 =
                                 1
                              
                           . Constraints (24)–(29) play the same role as in the shortest path problem, while constraint (23) states that the variables 
                              
                                 
                                    
                                       e
                                    
                                    
                                       
                                          
                                             tyy
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                            should assume values to guarantee a solution close to the shortest path one. This lower bound ensures the current solution of 
                              
                                 Z
                                 (
                                 σ
                                 )
                              
                           , which originates a novel configuration of 
                              
                                 
                                    
                                       e
                                    
                                    
                                       t
                                       ,
                                       
                                          
                                             yy
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           , to be coherent to the solution determined at the first step according to the threshold 
                              
                                 0
                                 ⩽
                                 τ
                                 ⩽
                                 1
                              
                            . The parameter vector c represents the cost of violating a given constraint. In particular, the element 
                              
                                 
                                    
                                       c
                                    
                                    
                                       h
                                    
                                 
                              
                            is proportional to the occurrence of a clause in the training data and represents the (log) probability that the corresponding constraint h is violated. Given a clause l representing the logical relationship among labels (for instance label A should appear before label B), the cost of violating all the constraints related to l is computed as follows:
                              
                                 (30)
                                 
                                    
                                       
                                          c
                                       
                                       
                                          l
                                       
                                    
                                    =
                                    log
                                    P
                                    
                                       
                                          
                                             
                                                
                                                   |
                                                   D
                                                   (
                                                   l
                                                   )
                                                   |
                                                
                                                
                                                   |
                                                   D
                                                   (
                                                   l
                                                   )
                                                   |
                                                   +
                                                   
                                                      
                                                         |
                                                         D
                                                         (
                                                         l
                                                         )
                                                         |
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 D
                                 (
                                 l
                                 )
                              
                            denotes the set of true clauses and 
                              
                                 
                                    
                                       D
                                       (
                                       l
                                       )
                                    
                                    
                                       ‾
                                    
                                 
                              
                            represents the set of clauses that are not satisfied in training data.

@&#EXPERIMENTAL RESULTS@&#

The proposed method has been tested with success on different datasets and benchmark models. In order to provide a complete understanding of the experimental campaign, we firstly introduce the performance criteria used to evaluate quality of the generated solutions, the datasets exploited for training and testing, the settings of the models considered for the comparative analysis and finally the computational results.

The performance in terms of effectiveness has been measured by using four well known evaluation metrics, i.e. F-Measure, Precision, Recall and Accuracy. The F-Measure metric represents a combination of Precision and Recall typical of Information Retrieval. Given a set of labels 
                           
                              Y
                           
                         we compute the Precision and Recall for each label 
                           
                              y
                              ∈
                              Y
                           
                         as:
                           
                              (31)
                              
                                 Precision
                                 (
                                 y
                                 )
                                 =
                                 
                                    
                                       #
                                       
                                       of
                                       
                                       tokens
                                       
                                       successfully
                                       
                                       predicted
                                       
                                       as
                                       
                                       y
                                    
                                    
                                       #
                                       
                                       of
                                       
                                       tokens
                                       
                                       predicted
                                       
                                       as
                                       
                                       y
                                    
                                 
                              
                           
                        
                        
                           
                              (32)
                              
                                 Recall
                                 (
                                 y
                                 )
                                 =
                                 
                                    
                                       #
                                       
                                       of
                                       
                                       tokens
                                       
                                       successfully
                                       
                                       predicted
                                       
                                       as
                                       
                                       y
                                    
                                    
                                       #
                                       
                                       of
                                       
                                       tokens
                                       
                                       effectively
                                       
                                       labeled
                                       
                                       as
                                       
                                       y
                                    
                                 
                              
                           
                        
                     

The F-Measure for each class 
                           
                              y
                              ∈
                              Y
                           
                         is computed as the harmonic mean of Precision and Recall:
                           
                              (33)
                              
                                 F
                                 (
                                 y
                                 )
                                 =
                                 
                                    
                                       2
                                       ·
                                       Recall
                                       (
                                       y
                                       )
                                       ·
                                       Precision
                                       (
                                       y
                                       )
                                    
                                    
                                       Recall
                                       (
                                       y
                                       )
                                       +
                                       Precision
                                       (
                                       y
                                       )
                                    
                                 
                              
                           
                        
                     

The Accuracy measure can be summarized as follows:
                           
                              (34)
                              
                                 Accuracy
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          y
                                       
                                       
                                          |
                                          Y
                                          |
                                       
                                    
                                 
                                 
                                    
                                       #
                                       
                                       of
                                       
                                       tokens
                                       
                                       correctly
                                       
                                       labeled
                                       
                                       as
                                       
                                       y
                                    
                                    
                                       total
                                       
                                       number
                                       
                                       of
                                       
                                       tokens
                                    
                                 
                              
                           
                        Considering that the datasets used in this experimental evaluation are composed of unbalanced samples, i.e. the class distribution of each label is not uniform, both micro and macroaverage have been computed for Precision, Recall and F-Measure. Micro and macromeasures differs in the computation of global performance: macro-averaging gives equal weight to each label category (independently from the category size), while micro-averaging considers the contribution of each label class according to its dimension.

In order to compare the proposed inference method against the traditional ones, we performed experiments on four datasets: US50, CoNLL-2003, Cora and Advertisements. The first dataset, named US50, represents a set of US Postal Addresses. It contains 740 instances, where 50 are used as training and 690 as testing. Each postal address has been manually annotated according the following labels: Street, City, Civic Number, State and Zip Code.

A further benchmark concerns with the CoNLL-2003 corpus (Tjong Kim Sang & Meulder, 2003), which consists of Reuters news stories annotated with four entity types: Person, Location, Organization and Miscellaneous. It is composed of 945 instances used as training and 246 as testing.

The Cora citation benchmark (McCallum, Freitag, & Pereira, 2000) is composed of 500 citations of research papers annotated with 13 different labels: Title, Author, Book Title, Date, Journal, Volume, Tech, Institution, Pages, Editor, Location, Notes. The benchmark has been split for training and testing the models: 300 instances have been used as training set, while the remaining 200 instances as testing.

The last benchmark concerns with the Advertisements corpus (Grenager, Klein, & Manning, 2005), which comprises announcement for apartment rentals in the San Francisco Bay Area. This dataset includes the following tags to be detected: Features, Size, Neighborhood, Photos, Address, Available, Contacts, Rent, Restrictions, Utilities, Roomates and Other. Its composed of 100 instances used as training and 100 as testing. The distribution of the considered datasets are reported in Tables 1–4
                        
                        
                        
                        .

In order to evaluate the contribution of the proposed inference method, we considered two main approaches for a comparative analysis. The experimental evaluation includes: Viterbi algorithm on a traditional CRF model (CRF-Viterbi), Nested Viterbi algorithm on the SemiCRF segment-based model (SemiCRF-Viterbi), and Soft-constrained inference on traditional CRF model (CRF-Soft). This allows us to compare the proposed inference method with the main state of the art solutions: CRF-Viterbi as baseline token-based approach, and SemiCRF-Viterbi as reference of segment-based approaches able to consider long range dependencies. Concerning the model settings, the following features have been included during the training phase of traditional CRF models:
                           
                              •
                              
                                 EdgeFeatures: denote transition feature functions that solely dependent upon the current label and the previous one.


                                 StartFeatures: evaluate whether the current label in consideration is a start state.


                                 EndFeatures: evaluate whether the current label in consideration is an end state.


                                 WordFeatures: check if the current token belongs to the dictionary created on-the-fly from the training set, and provide a counts of the number of times the token occurs in a state (label).


                                 UnknownFeatures: check if the current token is not observed at the time of training.


                                 ConcatRegexFeatures: match the token with the character patterns. Character patterns are regular expressions for checking whether the token is capitalized word, a number, small case word, whether the token contains any special characters and like.

Concerning SemiCRF, we used the same set of word-level features, as well their logical extensions to segments. In particular, we exploited indicators for the sentence inside a segment and the capitalization pattern inside a phrase, as well as indicators for words and capitalization patterns in 3-word windows before and after the segment. We also used indicators for each segment length and combined all word-level features with indicators for the beginning and end of a segment.

@&#RESULTS@&#

The proposed inference relaxation has been compared with two state-of-the-art approaches, i.e Viterbi algorithm on CRF (CRF-Viterbi) and SemiCRF (SemiCRF-Viterbi). Tables 5–8
                        
                        
                        
                         report the performance of Precision (P), Recall (R), F-Measure (F) and Accuracy (A) on the considered datasets both in terms of macro and microaverage. The performance are detailed by showing at first the results of CRF-Viterbi and SemiCRF-Viterbi, and then illustrating the contribution of the considered soft constraints on the relaxed ILP formulation.

Concerning the US50 dataset, the results reported in Table 5 show that the proposed inference approach allows to improve the prediction accuracy with respect to the traditional approaches both by including constraint separately and by considering all the constraints together. The constraints that provide the most relevant improvement in terms of accuracy are State Change and Begin–End: while some punctuation marks as “comma” clearly denote a State Change between adjacent labels, a Begin–End constraint helps to capture recurrent patterns in US address specifications.

If we focus on results in Table 6 about the CoNLL-2003 dataset, we can easily deduce that a free natural language text is more complex to be modeled than structured or semi-structured instances of US50. Although the overall results obtained by the proposed approach is slightly better than others (the CRF-Soft with all constraints achieves 73.49% of accuracy against 71.77% of traditional CRF and 65.30 of Semi-CRF), we can point out that some constraints do not provide any gain in terms of performance. In particular, Begin–End and Presence and Precedence constraints are redundant in respect of the generated solutions, leading to a labeling output that correspond to the one generated by the traditional Viterbi algorithm. On the contrarty, interesting constraints relate to State Change, where some punctuation mark are relevant, i.e. the cost of violating the corresponding constraint is high, for conditioning the solution. Among them we can for instance find out a constraint stating that given an Organization name, its Location is usually specified subsequently among brackets, e.g. Organization
                        =‘Dynamo Batumi’ (Location
                        =‘Georgia’).

Concerning the Cora benchmark, the computational results in Table 7 confirm once more that the learned constraints allows the relaxed inference to achieve good performance of the assessed criteria, by ensuring significant improvements with respect to state of the art solutions. When introducing all the modeled constraints in the soft ILP formulation, the proposed approach achieves the highest results. The only exception being the macro-average precision, which is biased by classes of small size as Publisher, Tech and Note. If we analyze the performance more deeply, we can notice that the labels that benefit most from the learned constraints and therefore from the relaxed ILP problem formulation are Author, Title and Booktitle. In particular, for these labels the proposed approach is able to ensure a value of F-Measure about 95.19%, 95.31% and 92.61% against the 92.22%, 90.19% and 90.20% of traditional Viterbi.The results about macro and micro-average F-Measure on this named entities are affected by the dimension of training and testing sets: sizable training entities allow a robust constraint learning and subsequently an effective inference phase on testing instances.

Regarding the Advertisements dataset, the results are reported in Table 8. This benchmark is characterized not only by a free natural language text as the ConLL-2003 dataset, but also by an informal expressive form. Although a high variability of natural language, the proposed approach is able to capture some global relationships as constraints to be included in the inference phase. For instance, the constraint State Change is able to capture relationship Size.Feature (e.g. Size
                        =‘1350 square feet’. Feature
                        =‘new carpet and more’), while the Begin–End constraint is able to constraining the labeling solution to end with the entity Contact.

As general conclusion, it’s interesting to highlight that the gains of the relaxed ILP formulation are larger when the dataset shows complex structural relationships among token labels. In this case the Viterbi algorithm could be “biased” by transition feature function encoded in 
                           
                              log
                              
                                 
                                    M
                                 
                                 
                                    t
                                 
                              
                              (
                              y
                              ,
                              
                                 
                                    y
                                 
                                 
                                    ′
                                 
                              
                              |
                              x
                              )
                           
                        , which captures only local relationships, while the proposed approach is able to find a more appropriate labeling solution thanks to the global relationships encoded as constraints.

At the end of the computational comparison across several dataset, we would like to stress once more that the proposed approach consists in adding information (constraints) during the inference phase, without modifying the learning step. On the contrary, most of the works proposed in the literature are instead based on adding knowledge during the learning procedures. The advantage of constraining (and relaxing) the inference phase, instead of forcing the training, is twofold: (1) lower computational complexity and (2) adaptability to changes in the domain setting (the probabilistic model generated during the learning phase can be maintained while inference can be adapted to a modified context). To the best of our knowledge, the most recent work on constrained inference in discriminative probabilistic model is Learning Plus Inference (L
                        +
                        I) presented in Chang et al. (2012), where the two dataset Advertisements and Cora have been exploited for validation purposes. If we compare the performance achieved by the proposed inference approach with the ones obtained by L
                        +
                        I, we can easily note that our relaxed ILP formulation is able to achieve higher performance: our approach is able to ensure an accuracy of 93.99% against 89.72% on the Cora dataset and 78.50% against 75.28% on the Advertisements dataset. This highlights that the proposed approach is able to directly derive constraints from data and include them in the relaxed ILP formulation making the inference with a more expressive model.

In this paper we have presented an ILP approach for relaxing inference for Information Extraction problems by using Conditional Random Fields. The proposed approach is based on the automatic extraction of background knowledge from training data and in the incorporation of such knowledge in the inference problem. The proposed ILP formulation is aimed at incorporating the additional knowledge hidden in long distance dependencies through nondeterministic soft constraints. The adoption of a relaxation of the inference problem and the use of properly weighted violation variables for the additional constraints is designed to preserve these complex relationships during the output prediction. Experimental results show that our method significantly outperforms the current state of the art approaches, obtaining remarkable performance gains across several domains and types of data (benchmark and real datasets).

Concerning ongoing research, an interesting direction relates to how effectively label any named entity with hundreds of labels. As outlined in Cohn, Smith, and Osborne (2005) and Lee et al. (2006), the probabilistic model defined by a CRF in its native form is not appropriate for dealing with Named Entity Recognition tasks in large-scale domains. This is mainly due to the computational limitation of the learning algorithms. Traditional approaches to train CRF are based on gradient-based methods and, although these approaches are relatively efficient, the learning phase results to be impracticable due to the amount of data to be considered. Traditional training algorithms are usually able to work on relatively small-scale domains, with reduced number of training examples and small label sets. For much larger tasks, with hundreds of labels and millions of examples, the current training methods prove intractable. In order to perform a large scale Named Entity Recognition with a number of labels and examples, a possible solution could be to perform a heuristic search (Tkachenko & Simanovsky, 2012) to find the optimal feature subset that could be used for training.

@&#ACKNOWLEDGEMENT@&#

Dan Roth is partly support by DARPA under agreement number FA8750-13-2-0008 and by ARL under agreement W911NF-09-2-0053. Any opinions, findings, conclusions or recommendations are those of the authors and do not necessarily reflect the view of the ARL, DARPA or the U.S. Government. Elisabetta Fersini and Enza Messina are partially supported by the eJRM project (ref. PON01_01286).

@&#REFERENCES@&#

