@&#MAIN-TITLE@&#Non-myopic information theoretic sensor management of a single pan–tilt–zoom camera for multiple object detection and tracking

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Detailed derivation of an information theoretic framework for real PTZ management.


                        
                        
                           
                           Introduction and implementation of a non-myopic strategy.


                        
                        
                           
                           Large experimental validation, with synthetic and realistic datasets.


                        
                        
                           
                           Working demonstration of myopic strategy on an off-the-shelf PTZ camera.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Pan–tilt–zoom camera

Multiple object tracking

Sensor management

Markov decision process

@&#ABSTRACT@&#


               
               
                  Automatic multiple object tracking with a single pan–tilt–zoom (PTZ) cameras is a hard task, with few approaches in the literature, most of them proposing simplistic scenarios. In this paper, we present a novel PTZ camera management framework in which at each time step, the next camera pose (pan, tilt, focal length) is chosen to support multiple object tracking. The policy can be myopic or non-myopic, where the former analyzes exclusively the current frame for deciding the next camera pose, while the latter takes into account plausible future target displacements and camera poses, through a multiple look-ahead optimization. In both cases, occlusions, a variable number of subjects and genuine pedestrian detectors are taken into account, for the first time in the literature. Convincing comparative results on synthetic data, realistic simulations and real trials validate our proposal, showing that non-myopic strategies are particularly suited for a PTZ camera management.
               
            

@&#INTRODUCTION@&#

Visual tracking of multiple objects in realistic outdoor scenarios is often performed in wide areas. In these viewing conditions a stationary fixed focal length camera has typically too limited field of view and image resolution with respect to the scene extent. Therefore, a network of cameras is used to sufficiently cover the area at the required resolution [1–5]. However, this may be unfeasible for the cost associated to the setup and maintenance of the camera network, as well as for the practical impossibility to provide all the necessary resolutions for target biometric recognition at a distance. Similarly, in the case of a vehicle mounted camera [6–9] it would be difficult to cover a wide area at adequate resolution due to the limited acceleration at which the camera may be moved. Active vision [10] and specifically active pan tilt zoom (PTZ) cameras, have promised to solve these limitations, permitting at least in principle the monitoring of a large space at variable image resolutions [11,4]. However, letting a large number of stationary or PTZ cameras operate in a cooperative way is still an expensive and complex solution [12,13]; for this reason, exploiting a single zooming sensor could be a more reasonable and worthy goal. According to this, in this paper, we propose and show the benefits of an active sensing approach to multiple object detection and tracking using a single pan tilt zoom camera.

Despite the high exploitable potential, when applied for the task of multiple object tracking in world coordinates, a single PTZ camera induces a number of complex problems that must be solved to obtain effective results [14,15]. Specifically, camera calibration solutions adopting natural landmarks [16,17] should be preferred with respect to others adopting domain specific scene landmark geometry as in [11,15,18]. Since the PTZ camera must also undergo rapid and unpredictable motions to rapidly gaze at any part of the field of view, real time tracking of camera motion should not be based on recursive filtering, but on keyframe based methods [16,19]. At the same time, the scene background appearance must be continuously updated [16,20,21]. Moreover, due to the fact that monitoring is performed in a large area, accurate objects localization in a common 3D world reference frame is needed to track targets at a distance. This requires some form of online camera calibration since the camera parameters change dynamically. The framework we developed in [22] is conceived to support all these requirements and is therefore suitable to be used in task-driven active surveillance of scenes with multiple moving objects.

Starting from this framework [22], we propose a solution for sensor management (i.e. determine the best way to control the visual sensor) in order to enhance multiple target detection and tracking in a wide area. Here the focus is on non-myopic sensor management where the long-term ramifications of taking a particular sensing action are accounted for decision making. A sensing action may consist of choosing a particular image processing modality (e.g. pedestrian detection or motion detection), a particular camera pose and focal length, or a combination of the two. Information gain [23] is chosen as performance indicator of decision making, since it has the desirable property that different inhomogeneous sensing actions can be simultaneously optimized in a single metric. This requires to maintain the probability density which capture uncertainty in the current state estimate. In our setting there are multiple actions that can be tasked by evaluating a single global metric, some of which contribute better than others to tracking. The PTZ camera sensor is used to gain information about the kinematic state (e.g. position and velocity) and objects detectability.
                        1
                        Image object measurements are obtained according to a detector that have a time-varying object response characteristics. For example in the case of pedestrian detection as processing modality, the response characteristic varies depending on the imaged size of the object and on how much the object is occluded.
                     
                     
                        1
                      There are many objectives that the sensor manager may be tuned to meet, e.g. minimization of track loss, probability of target detection, minimization of track error/covariance, and identification accuracy. Each of these different objectives taken alone may lead to a different sensor allocation strategy. As detailed in Section 4, we jointly optimize over all these objectives by maximizing the expected amount of information extracted from the scene, namely the expected information gain between the current objects state estimate and the state estimate after a measurement has been made. Since the best sensing action must be selected before actually executing it, what is practically maximized is the expected reduction in entropy (i.e. the expected information gain) that a sensing action will produce. Fig. 1
                      shows the three main components of the complete multi target tracking system for a single PTZ camera.

The sensor management problem can be approached in a principled way with the Markovian Decision Process (MDP) formalism [24]. However, the long-term (non-myopic) planning solution suffers from combinatorial explosion and may be defined, as in our case, in a continuous state space. Approximate solutions are therefore required and will be discussed in the next section. This work extends the preliminary results we obtained in [25] where we have analyzed the myopic (i.e. greedy) aspects of sensor management. Experimental results show that the non-myopic strategy provides a substantial performance improvement by better capturing the complex space–time trade-off between objects and camera motion. Two motivating examples for which the non-myopic will outperform the myopic strategy are: (1) the case in which an object is repeatedly measured before it gets occluded so as to sharpen its uncertainty when it reappears and (2) the case in which objects are measured exploiting the calibrated zoom
                        2
                        Calibrated zoom allows increasing measurement accuracy in world plane coordinate object localization. In Appendix A a formal proof of this result is presented.
                     
                     
                        2
                      so as to sharpen their uncertainties. The underlying assumption is that if the operative scenario evolves with reasonable temporal coherence, it is possible to predict the ability of gathering information of a future action.

Synthetic and real experiments are shown confirming the suitability of our approach for realistic scenarios. Fig. 2
                      shows few frames from the three sets of experiments.

The rest of the paper is organized as follows. We give and overview of related work in Section 2 while we summarize our contributions in Section 3. The information theoretic formulation based on MDP for the myopic version is presented in Section 4, and the modeling of the real world challenges such as missed detections and occlusions is presented in Section 5. The non-myopic version is described in Section 6. In Section 7 we give a detailed discussion about how the proposed solution can be extended to a network of multiple cameras. Some implementation and evaluation details are given in Section 8. Experiments for the myopic framework are reported in Section 9 while experiments for the non-myopic version are reported in Section 10. Finally the conclusions are drawn in Section 11.

@&#RELATED WORK@&#

Automatic multiple object tracking with a single pan–tilt–zoom camera is a hard task with few approaches present in the literature, most of which propose simplified scenarios. One of the most challenging part is that the evaluation with real data require the development of a real time system since it is not possible to work offline with pre-recorded
                        3
                        If the video is recorded at high resolution it is possible to crop and downsample the image to get the desired field of view. However the level of detail and the quality of the image that can be captured with optical zoom is still orders of magnitude larger than the one achievable with the digital zoom.
                     
                     
                        3
                      videos. To deal with this issue, in [26] a completely simulated environment is created through computer graphics and different strategies for camera to target assignments are proposed and compared. In [27] the authors propose a system for cooperative tracking between multiple Active Vision Agents (AVA). In this solution each AVA agent manages visual perception, camera action and network communication to perform cooperative tracking. Different scheduling policies for a network of PTZ cameras in a master–slave configuration were tested in [28,29]. However, the strategies described above [26–29] are mainly hand-crafted, and require precise information on the targets’ position from other sensors. An overview of recent methods for managing PTZ camera networks can be found in [30,31].

Principled information theoretic frameworks exploiting the concept of information gain for single object tracking are introduced in [32–34]. In [32] optimal selection of the focal lengths of two cameras during active 3D object tracking is proposed. This is the first work on active focal length selection for improving accuracy in 3D object tracking. Despite the promising results observed in a controlled laboratory test, the system is not yet mature to work in unconstrained video sequences. In [33], the authors propose a non-myopic solution for optimal focal length selection based on the minimization of the expected entropy of a tracked object. Tracking is performed in 2D, only on simulated data, using an extended Kalman filter. In [34] the authors suggests a method to control the zoom in order to obtain maximum resolution by placing a limit in the innovation of a constant velocity Kalman filter. In particular, the zoom is used to modify the measurement process. Other works that control the focal length to keep the imaged size of a single object constant were proposed in [35–37], but no 3D localization uncertainty is taken into account and the extension to multiple objects is not trivial.

Sensor management for the task of multiple object tracking is addressed in [38]. Here tracking is performed in the image plane and therefore focal length selection cannot be used to improve the accuracy in 3D object localization. Multiple zooming cameras which give a 3D representation of target positions are considered in [39] for the multi-target scenario. In both [38,39] the evaluation is carried out with ground truth data (i.e. sources of error from the detection, tracking and data association stage are ignored). All the works described above optimize over a single step look-ahead (i.e. myopic) except for the method in [33] which optimize over multiple step ahead for the task of tracking a single moving object. However testing is conducted with single object in a constrained simulated environment and only the zoom is managed.

Recently novel sensor management approaches with real-time implementations has been reported in [12,13] with convincing results. The network camera system described in [12] comprises a total of eight cameras, four fixed and four PTZ. The fixed cameras are processed at a resolution of 
                        
                           320
                           ×
                           240
                        
                      while no image processing is performed on the PTZ views. The sensor network in [13] includes nine PTZ network IP cameras with a resolution of 
                        
                           320
                           ×
                           240
                        
                      pixels and 
                        
                           12
                           ×
                        
                      optical zoom. In this system the control of the PTZ parameters is modeled as a multiplayer game where the cameras gain by reducing the error covariance of the tracked targets or through higher resolution feature acquisition, which, however, comes at the risk of losing the target. The work in [40] proposes a distributed approach to optimize various scene analysis performance criteria through distributed control of a dynamic camera network including the uncertainty of the targets. All these works adopt a large number of stationary or PTZ cameras operating in a coordinated way (typically in master–slave configuration [41,42]). Although these approaches could be in principle applied to the case of a single camera we are not aware of any work investigating in this regard.

In Table 1
                      we give an overview of the main characteristics for some of the methods described above and our solution. In particular, we highlight the main differences in terms of: necessity of synchronization between the sensors involved in the network, calibration of each sensor, number of cameras, number of tracked targets, occlusions management and the cost to be optimized. In particular, the cost to be optimized can be: the accuracy in tracking the targets (tracking accuracy), the necessity to maintain constant the size at which the object is observed (constant object imaged size) or the necessity to obtain the highest resolution for the object of interest (highest target resolution).


                     Computational model. The sensor management problem is generally approached as planning under uncertainty according to Markov Decision Processes (MDPs) [24]. Such framework explicitly models the temporal state evolution and designs a policy for selecting the action based on a reward function. However, optimal long-term solutions suffer from combinatorial explosion, for this reason suboptimal approximate methods must be applied.

The non-myopic strategy can be optimized with a Monte Carlo rollout strategy as described in [43,44]. These approaches address the solution for large MDPs while small problems can be directly solved with Dynamic Programming [45]. There are two basic variants for estimating (online) an approximate strategy of a MDP and both these variants can be classified based on the length of the planning horizon, namely: Monte Carlo Tree Search methods (MCTS) [46] and Reinforcement Learning (RL) based methods [47]. The former guide the search using results from rollouts in the decision tree of the actions and are appropriate for the finite horizon case. The latter are most indicated for finding approximate solutions in the infinity horizon case. The method that we investigate here is focused on finite horizon and includes sparse sampling techniques for direct approximation of the Bellman equation, as described in [48]. A relevant application of this technique has been recently presented in [49] for the task of tracking vehicles from radar imagery. The rollout approach driven by information metric is exploited to capture the long-term reward due to expected visibility and occlusion of objects.

Another application of MDP, hidden MDP (hMDP), is proposed in [50], where a target moving in the scene is modeled as an agent for which the state is the position on the plane and the action is its future direction. In this work the goal is to estimate the policy it is following in order to forecast its future behavior.

Our contributions with respect to the related work are:
                        
                           •
                           A well-founded theoretical solution for the information theoretic management of an active camera, which keeps into account all the typical sources of error of a tracking system: detector performance, limited field of view, occlusions among targets, variable number of targets. The solution has been divided in two techniques: one myopic, introduced in [25] and here fully detailed in all the mathematical derivations; the other technique is a non-myopic minimization strategy that can more effectively deal with a high number of targets, occlusions among them and the mechanical constraints of the camera.

We adopt the sampling method in [48] to handle large Partially Observable MDP (POMDP) and modify it to further limit the computational cost.

We improve the evaluation of the whole method with respect to previous works [38,39] in which ground truth data are used as objects measurements, and use standard metrics for multi-target tracking evaluation.

We firstly show how to task a single PTZ camera according to a sophisticated sensor management strategy to support multiple object tracking in a 3D world coordinate frame [22], and demonstrate it working online in a real scenario.

Similarly to [22,38], our baseline multi object tracking uses extended Kalman filter (EKF) for each initialized target. Pedestrian detection [51] is used to extract object observations, and the Hungarian algorithm [52] is applied to associate each observation to the corresponding EKF-filter and to initialize a new filter in the case of unassociated observations.

At time t, the real object state, 
                           
                              
                                 
                                    s
                                 
                                 
                                    t
                                 
                              
                           
                        , and its estimation, 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                           
                        , include its location in world coordinates and its speed: 
                           
                              
                                 
                                    s
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    [
                                    
                                       
                                          x
                                       
                                       
                                          s
                                          ,
                                          t
                                       
                                       
                                          w
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          s
                                          ,
                                          t
                                       
                                       
                                          w
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          s
                                          ,
                                          t
                                       
                                       
                                          w
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          s
                                          ,
                                          t
                                       
                                       
                                          w
                                       
                                    
                                    ]
                                 
                                 
                                    ⊤
                                 
                              
                              ,
                              
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    [
                                    
                                       
                                          x
                                       
                                       
                                          t
                                       
                                       
                                          w
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          t
                                       
                                       
                                          w
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          t
                                       
                                       
                                          w
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          t
                                       
                                       
                                          w
                                       
                                    
                                    ]
                                 
                                 
                                    ⊤
                                 
                              
                           
                        . The observation 
                           
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    [
                                    
                                       
                                          u
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          t
                                       
                                    
                                    ]
                                 
                                 
                                    ⊤
                                 
                              
                           
                        , i.e., the target location on the image plane, only depends on the current state and on the action 
                           
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                           
                        , that is selected from the finite set 
                           
                              A
                           
                         which comprises L different possible actions each of which corresponds to a particular PTZ camera pose 
                           
                              a
                              =
                              (
                              ϕ
                              ,
                              θ
                              ,
                              f
                              )
                              ∈
                              A
                           
                         (the pan 
                           
                              ϕ
                           
                        , tilt 
                           
                              θ
                           
                         and focal length 
                           
                              f
                           
                         respectively). Formally, we have:
                           
                              (1)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             f
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   m
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   m
                                                
                                                
                                                   t
                                                
                                             
                                             ∼
                                             N
                                             (
                                             0
                                             ,
                                             U
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   o
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             g
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   a
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   n
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   n
                                                
                                                
                                                   t
                                                
                                             
                                             ∼
                                             N
                                             (
                                             0
                                             ,
                                             V
                                             )
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              f
                              (
                              ·
                              )
                           
                         and 
                           
                              g
                              (
                              ·
                              )
                           
                         are the motion model and the observation model, respectively, 
                           
                              
                                 
                                    m
                                 
                                 
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 
                                    n
                                 
                                 
                                    t
                                 
                              
                           
                         are the process and the measurement noise with 
                           
                              U
                           
                         and 
                           
                              V
                           
                         their respective covariance matrices. In particular, the function 
                           
                              g
                              (
                              ·
                              )
                           
                         represents the homography from the world plane to the image plane parameterized by the actions defined in the set 
                           
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                           
                        .

Let 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                           
                         be the predicted state estimate at time t, i.e. before having made the observation at t, while 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    +
                                 
                              
                           
                         incorporates the observation. The final estimate for the state at time 
                           
                              t
                              ,
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                           
                        , is either 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    +
                                 
                              
                           
                         or 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                           
                        , depending whether the target is observed or not (e.g., when the camera is not pointing at it, or the detector misses it). 
                           
                              
                                 
                                    P
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    t
                                 
                                 
                                    +
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    t
                                 
                              
                           
                         are the covariance matrices for 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    +
                                 
                              
                           
                         and 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                           
                        , respectively. If the target is not observed, only 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                           
                         are considered. The EKF equations are then:
                           
                              (2)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                
                                                
                                                   -
                                                
                                             
                                             =
                                             
                                                
                                                   Fx
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   t
                                                
                                                
                                                   -
                                                
                                             
                                             =
                                             
                                                
                                                   F
                                                
                                                
                                                   ⊤
                                                
                                             
                                             
                                                
                                                   P
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                             
                                             F
                                             +
                                             U
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             
                                                
                                                   P
                                                
                                                
                                                   t
                                                
                                                
                                                   -
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   x
                                                
                                             
                                             (
                                             
                                                
                                                   a
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             
                                                
                                                   (
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                   +
                                                   V
                                                   )
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                
                                                
                                                   +
                                                
                                             
                                             =
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                
                                                
                                                   -
                                                
                                             
                                             +
                                             
                                                
                                                   K
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             
                                                
                                                   o
                                                
                                                
                                                   t
                                                
                                             
                                             -
                                             g
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                
                                                
                                                   -
                                                
                                             
                                             ,
                                             
                                                
                                                   a
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   t
                                                
                                                
                                                   +
                                                
                                             
                                             =
                                             (
                                             I
                                             -
                                             
                                                
                                                   K
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   x
                                                
                                                
                                                   ⊤
                                                
                                             
                                             (
                                             
                                                
                                                   a
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             )
                                             
                                                
                                                   P
                                                
                                                
                                                   t
                                                
                                                
                                                   -
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    C
                                 
                                 
                                    x
                                 
                              
                              (
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                              =
                              
                                 
                                    ∇
                                 
                                 
                                    x
                                 
                              
                              g
                              (
                              x
                              ,
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                              
                                 
                                    |
                                 
                                 
                                    x
                                    =
                                    
                                       
                                          x
                                       
                                       
                                          t
                                       
                                       
                                          -
                                       
                                    
                                 
                              
                           
                         is the linearized homography g evaluated in 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                           
                         and 
                           
                              F
                           
                         is the 
                           
                              4
                              ×
                              4
                           
                         matrix that models the system dynamics. Importantly, 
                           
                              
                                 
                                    C
                                 
                                 
                                    x
                                 
                              
                              (
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         depends on the action, so that diverse camera poses lead to different observation matrices, and different estimations for 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    +
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    t
                                 
                                 
                                    +
                                 
                              
                           
                        . It is worth to highlight that also the zoom modifies the linearized projection matrix 
                           
                              
                                 
                                    C
                                 
                                 
                                    x
                                 
                              
                              (
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                        ; in fact observing a target with an higher magnification will produce a smaller covariance 
                           
                              
                                 
                                    P
                                 
                                 
                                    t
                                 
                                 
                                    +
                                 
                              
                           
                         
                        [32].

Eq. (2) can be seen as modeling the transition probabilities in the MDP (see Fig. 3
                        ). To complete the MDP model, we need the reward function 
                           
                              R
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                        , which tells how informative is a given action 
                           
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                           
                         performed in the state 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                           
                        . Notably, the reward must depend on 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                           
                         (not on 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    +
                                 
                              
                           
                        ), since we want to select the action before performing the observation. Given the reward function, at each time step we can evaluate its value for all the possible actions 
                           
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              ∈
                              A
                           
                        , choosing the one which gives the maximal reward.

In designing the reward function 
                           
                              R
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         we directly relate it to the expected information gain 
                           
                              I
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              ;
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         between the state 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                           
                         and the observation 
                           
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                           
                        , for a given action. In practice, it expresses the amount of information shared between state and observation. Adopting the same formulation of [53], we can write:
                           
                              (3)
                              
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                    
                                       ★
                                    
                                 
                                 =
                                 arg
                                 
                                    
                                       
                                          max
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                 R
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 ;
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 arg
                                 
                                    
                                       
                                          max
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                 I
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 ;
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 arg
                                 
                                    
                                       
                                          max
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 )
                                 -
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 arg
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 ,
                              
                           
                        where 
                           
                              H
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         is the conditional entropy.
                           4
                           The conditional entropy for two random variables x and y is defined as 
                                 
                                    H
                                    (
                                    x
                                    |
                                    y
                                    )
                                    =
                                    -
                                    ∬
                                    p
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    log
                                    p
                                    (
                                    x
                                    |
                                    y
                                    )
                                    dxdy
                                 
                              .
                        
                        
                           4
                         Thus, we want to minimize:
                           
                              (4)
                              
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 -
                                 ∫
                                 p
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 ∫
                                 p
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 log
                                 
                                    
                                       
                                          p
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                t
                                             
                                          
                                          |
                                          
                                             
                                                o
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                a
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 )
                                 d
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 d
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 p
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 d
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 +
                                 
                                    ∫
                                    
                                       ¬
                                       
                                          
                                             Ω
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 p
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 d
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 +
                                 (
                                 1
                                 -
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 )
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 )
                                 ,
                              
                           
                        where we split the domain of integration for 
                           
                              p
                              (
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                        . 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    t
                                 
                              
                           
                         is the set of points in which the target is visible, 
                           
                              ¬
                              
                                 
                                    Ω
                                 
                                 
                                    t
                                 
                              
                           
                         is the set where it is not visible, i.e., it is out of the camera field of view (FoV), is occluded, or is too small to be detected. Assuming the distribution for 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                           
                         as Gaussian and being the system in Eq. (2) linear, we can derive the entropy 
                           
                              H
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    +
                                 
                              
                              )
                           
                         directly from the EKF equations. In fact, the entropy of a Gaussian distribution only depends on its covariance
                           5
                           The entropy of a Gaussian distributed random vector 
                                 
                                    x
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          n
                                       
                                    
                                 
                               with 
                                 
                                    x
                                    ∼
                                    N
                                    (
                                    μ
                                    ,
                                    Σ
                                    )
                                 
                               is: 
                                 
                                    H
                                    (
                                    x
                                    )
                                    =
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    log
                                    (
                                    
                                       
                                          (
                                          2
                                          π
                                          )
                                       
                                       
                                          n
                                       
                                    
                                    ‖
                                    Σ
                                    ‖
                                    )
                                 
                              .
                        
                        
                           5
                         and Eq. (2) provide 
                           
                              
                                 
                                    P
                                 
                                 
                                    t
                                 
                                 
                                    +
                                 
                              
                           
                         if 
                           
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                           
                         allows to get the observation for the target, and 
                           
                              
                                 
                                    P
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                           
                         otherwise. For more details, see [53].

In other words, to ensure maximal expected information gain 
                           
                              I
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              ;
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         we need only to consider how the term 
                           
                              α
                              (
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         varies for different actions 
                           
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                           
                        . Intuitively, such term estimates the probability that at the next step a target will be observed by the camera, as a function of the pose of the camera itself. Extending to K independent targets correspond to sum up the information gains 
                           
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                           
                         for each target k.

As analyzed in the previous section, the formulation of 
                        
                           α
                           (
                           
                              
                                 a
                              
                              
                                 t
                              
                           
                           )
                        
                      in [53] is limited, since it neglects aspects of real world scenarios. We model (a) the visibility constraint, accounting for the physical dimension of the target in the current field of view; (b) a realistic person detector whose performance varies according to the occlusion ratio and the imaged object size; (c) the occlusions between the targets that considers the relative positions between the imaged objects (evaluated through sampling); and (d) the mechanical speed limits of camera motion. The variability of the number of targets is managed through the patrolling term as in [38].

Introducing the visibility constraint requires to define properly the set 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    t
                                 
                              
                           
                         in Eq. (4), while introducing the estimation of the detector performance implies to modify 
                           
                              p
                              (
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                        . Let 
                           
                              
                                 
                                    d
                                 
                                 
                                    t
                                 
                              
                           
                         be a binary variable which is 1 if the target is found by the detector and 0 otherwise. In practice, 
                           
                              
                                 
                                    d
                                 
                                 
                                    t
                                 
                              
                           
                         tells us whether the Kalman filter will be updated with a new observation or only the information from the previous prediction will be considered. Hence, Eq. (4) can be modified by considering this new variable:
                           
                              (5)
                              
                                 
                                    
                                       
                                       
                                          
                                             H
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                
                                             
                                             |
                                             
                                                
                                                   o
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   d
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   a
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             =
                                             -
                                             ∬
                                             p
                                             (
                                             
                                                
                                                   o
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   d
                                                
                                                
                                                   t
                                                
                                             
                                             |
                                             
                                                
                                                   a
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             ∫
                                             p
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                
                                             
                                             |
                                             
                                                
                                                   o
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   d
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   a
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             log
                                             
                                                
                                                   
                                                      p
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            o
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                             d
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                
                                             
                                             d
                                             
                                                
                                                   o
                                                
                                                
                                                   t
                                                
                                             
                                             d
                                             
                                                
                                                   d
                                                
                                                
                                                   t
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Let us start by analyzing 
                           
                              p
                              (
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         and introducing some assumptions. First, 
                           
                              p
                              (
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                              =
                              p
                              (
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                              |
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         (where 
                           
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                              =
                              g
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                        ) since the actual observation 
                           
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                           
                         is yet not available when selecting the actual action 
                           
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                           
                        .
                           6
                           In the remaining, for the sake of clarity, we omit the apex 
                                 
                                    
                                       
                                       
                                          -
                                       
                                    
                                 
                               from 
                                 
                                    
                                       
                                          o
                                       
                                       
                                          t
                                       
                                       
                                          -
                                       
                                    
                                 
                              , if not otherwise specified.
                        
                        
                           6
                         In this way, we assume that the expected positions of the targets on the image plane only depend on the prediction of the state and the action. Second, we assume that the visibility of a target only depends on its position on the image plane, being unaware of obstacles or other occluders in the scene. Therefore, the term 
                           
                              p
                              (
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         in Eq. (5) factorizes as:
                           
                              (6)
                              
                                 p
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 p
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 p
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 .
                              
                           
                        Being 
                           
                              
                                 
                                    d
                                 
                                 
                                    t
                                 
                              
                           
                         binary, Eq. (5) may be rearranged as:
                           
                              (7)
                              
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 
                                    ∫
                                    
                                       ¬
                                       
                                          
                                             Ω
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 p
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 d
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 )
                                 +
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 p
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 p
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 0
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 d
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 )
                                 +
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 p
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 p
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 1
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 d
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 =
                                 (
                                 1
                                 -
                                 α
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 )
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 )
                                 +
                                 α
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 ,
                              
                           
                        where we also suppose that a detection is possible only if the observation is visible in the image. In conclusion, we just need to compute for any possible action 
                           
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                           
                         the weight 
                           
                              α
                              (
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                        :
                           
                              (8)
                              
                                 α
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 p
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 p
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 1
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 d
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 .
                              
                           
                        Now, to preserve the Gaussian distribution and therefore the efficient integration for the weight 
                           
                              α
                              (
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                        , the two pdfs in Eq. (8) and the integration domain 
                           
                              Ω
                           
                         are defined as follows.


                        Observation distribution. 
                           
                              p
                              (
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         is the predicted distribution of the observation. Based on the prediction of the state from Eq. (2), we have 
                           
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                              ∼
                              N
                              (
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                              ,
                              
                                 
                                    Σ
                                 
                                 
                                    
                                       
                                          o
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              )
                           
                        , where:
                           
                              (9)
                              
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       Σ
                                    
                                    
                                       
                                          
                                             o
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 
                                    
                                       P
                                    
                                    
                                       -
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       x
                                    
                                    
                                       ⊤
                                    
                                 
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 +
                                 V
                                 .
                              
                           
                        
                     


                        Visibility probability. 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    t
                                 
                              
                           
                         is the set of possible observations 
                           
                              {
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                              }
                           
                         for which the target is fully visible in the camera field of view, considering the limited size of the image plane 
                           
                              S
                              ⊂
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                        . In defining such set, we originally extend the work in [39], and consider the spatial dimension of the targets, assuming that objects are almost vertical on the ground plane and that their projected height is known for at least one target. Since we know the extrinsic calibration parameter for the camera, we can estimate the head position 
                           
                              
                                 
                                    e
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         on the image plane for a target whose feet are in 
                           
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                           
                        , through the homology 
                           
                              
                                 
                                    W
                                 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                           
                        , as in [54]. The set 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    t
                                 
                              
                           
                         is then defined as:
                           
                              (10)
                              
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 ∈
                                 
                                    
                                       Ω
                                    
                                    
                                       t
                                    
                                 
                                 
                                 ⇔
                                 
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 ∈
                                 S
                                 ∧
                                 
                                    
                                       e
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 ∈
                                 S
                                 .
                              
                           
                        To integrate 
                           
                              p
                              (
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         on the set of points defined above we linearize the homology through the Jacobian 
                           
                              J
                              
                                 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    ∇
                                 
                                 
                                    
                                       
                                          o
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              W
                              
                                 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    
                                       
                                          o
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          o
                                       
                                       
                                          t
                                       
                                       
                                          -
                                       
                                    
                                 
                              
                           
                         of 
                           
                              W
                              
                                 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                           
                         around 
                           
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                           
                        . Therefore:
                           
                              (11)
                              
                                 
                                    
                                       e
                                    
                                    
                                       t
                                    
                                 
                                 ≈
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 J
                                 
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 )
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       W
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 )
                                 .
                              
                           
                        Assuming that people are vertical in the scene, and that the image plane y-axis is vertical, we can discard the horizontal component getting:
                           
                              (12)
                              
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       
                                          
                                             e
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                                 +
                                 J
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             2
                                             ,
                                             2
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       o
                                    
                                 
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       
                                          
                                             o
                                          
                                          
                                             -
                                          
                                       
                                    
                                 
                                 )
                                 ,
                                 
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       o
                                    
                                 
                                 .
                              
                           
                        In conclusion, the y coordinate for the head 
                           
                              
                                 
                                    e
                                 
                                 
                                    t
                                 
                              
                           
                         is linearly obtained from the y coordinate of 
                           
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                           
                        , thus the integration on the image plane is still equivalent to integrating over a rectangle whose sides are parallel to the x–y axis.


                        Detection probability. 
                           
                              p
                              (
                              
                                 
                                    d
                                 
                                 
                                    t
                                 
                              
                              =
                              1
                              |
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         is the probability that a target will actually be detected given its position in the image plane. In practice, we consider that the performance of any pedestrian detectors depends on the height 
                           
                              
                                 
                                    r
                                 
                                 
                                    t
                                 
                              
                           
                         of the target on the image plane (in pixels). We estimate such a relation with the function 
                           
                              p
                              (
                              
                                 
                                    d
                                 
                                 
                                    t
                                 
                              
                              =
                              1
                              )
                              =
                              1
                              -
                              
                                 
                                    e
                                 
                                 
                                    -
                                    
                                       
                                          K
                                       
                                       
                                          d
                                       
                                    
                                    (
                                    r
                                    -
                                    
                                       
                                          r
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                              
                              1
                              (
                              r
                              -
                              
                                 
                                    r
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        . The two parameters 
                           
                              
                                 
                                    K
                                 
                                 
                                    d
                                 
                              
                              =
                              0.0098
                           
                         and 
                           
                              
                                 
                                    r
                                 
                                 
                                    0
                                 
                              
                              =
                              21.29
                           
                         are extrapolated from the performance of HOG pedestrian detector on the Caltech Pedestrian Dataset, reported in [55].
                           7
                           Since in our implementations we use the HOG pedestrian detector, we estimate the parameters 
                                 
                                    
                                       
                                          K
                                       
                                       
                                          d
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          0
                                       
                                    
                                 
                               for the performance of that detector. The same procedure can be applied to any other detector for which the miss-rate as a function of the target size is given.
                        
                        
                           7
                         More details are given in Table 2
                         where we report the miss rate values as a function of target size for the HOG pedestrian detector and compare them with the parametric estimation used. Fig. 4
                         (left) shows the miss rate values for all the other methods reported in [55].

The target height 
                           
                              
                                 
                                    r
                                 
                                 
                                    t
                                 
                              
                              =
                              |
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                                 
                                    e
                                 
                              
                              -
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                                 
                                    o
                                 
                              
                              |
                              =
                              (
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                                 
                                    o
                                 
                              
                              -
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                                 
                                    e
                                 
                              
                              )
                           
                         can be computed as a function of the observation 
                           
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                                 
                                    o
                                 
                              
                           
                         and the camera position 
                           
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                           
                        , exploiting the homology:
                           
                              (13)
                              
                                 
                                    
                                       r
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         o
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                I
                                             
                                             
                                                2
                                                ×
                                                2
                                             
                                          
                                          -
                                          J
                                          
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                          )
                                          
                                             
                                                o
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          W
                                          
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                o
                                             
                                             
                                                t
                                             
                                             
                                                -
                                             
                                          
                                          )
                                          -
                                          J
                                          
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                                o
                                             
                                             
                                                t
                                             
                                             
                                                -
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          T
                                          
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                o
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          -
                                          W
                                          
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                o
                                             
                                             
                                                t
                                             
                                             
                                                -
                                             
                                          
                                          )
                                          -
                                          J
                                          
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                                o
                                             
                                             
                                                t
                                             
                                             
                                                -
                                             
                                          
                                       
                                    
                                 
                                 =
                                 T
                                 
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       t
                                    
                                    
                                       t
                                    
                                 
                                 .
                              
                           
                        Linearizing the homology around the expected observation 
                           
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                           
                         give us the exponential function:
                           
                              (14)
                              
                                 p
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 1
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 1
                                 -
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       
                                          
                                             K
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             o
                                          
                                          
                                             t
                                          
                                       
                                       +
                                       
                                          
                                             t
                                          
                                          
                                             t
                                          
                                       
                                       -
                                       
                                          
                                             r
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                                 ,
                              
                           
                        where the matrix 
                           
                              T
                              
                                 
                                 
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 
                                    t
                                 
                                 
                                    t
                                 
                              
                           
                         are constants depending on the linearized homology, see Eq. (12). The product of the Gaussian distribution 
                           
                              p
                              (
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                        , Eq. (9), and the exponential function in 
                           
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                           
                        , Eq. (14), gives another Gaussian distribution:
                           
                              (15)
                              
                                 p
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 p
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 1
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                       π
                                       |
                                       Σ
                                       
                                          
                                             |
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          1
                                          -
                                          exp
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                          exp
                                          
                                             
                                                
                                                   -
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   T
                                                   
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      
                                                         o
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          -
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      o
                                                   
                                                   
                                                      t
                                                   
                                                
                                                -
                                                μ
                                                )
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                Σ
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                o
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          μ
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                       π
                                       |
                                       Σ
                                       
                                          
                                             |
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          exp
                                          -
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      o
                                                   
                                                   
                                                      t
                                                   
                                                
                                                -
                                                μ
                                                )
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                Σ
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                o
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          μ
                                          )
                                       
                                    
                                 
                                 +
                                 -
                                 
                                    
                                       
                                          exp
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                          exp
                                          -
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                o
                                             
                                             
                                                t
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                Σ
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          Σ
                                          T
                                          
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                K
                                             
                                             
                                                d
                                             
                                          
                                          +
                                          T
                                          
                                             
                                             
                                                t
                                             
                                             
                                                ⊤
                                             
                                          
                                          Σ
                                          
                                             
                                                Σ
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                o
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                K
                                             
                                             
                                                d
                                             
                                          
                                          +
                                          
                                             
                                                (
                                                
                                                   
                                                      o
                                                   
                                                   
                                                      t
                                                   
                                                
                                                -
                                                μ
                                                )
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                Σ
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                o
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          μ
                                          )
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                       π
                                       |
                                       Σ
                                       
                                          
                                             |
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          -
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      o
                                                   
                                                   
                                                      t
                                                   
                                                
                                                -
                                                μ
                                                )
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                Σ
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                o
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          μ
                                          )
                                       
                                    
                                 
                                 +
                                 -
                                 
                                    
                                       1
                                    
                                    
                                       2
                                       π
                                       |
                                       Σ
                                       
                                          
                                             |
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          
                                             
                                                r
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          T
                                          
                                             
                                             
                                                t
                                             
                                             
                                                ⊤
                                             
                                          
                                          Σ
                                          T
                                          
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          -
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      o
                                                   
                                                   
                                                      t
                                                   
                                                
                                                -
                                                (
                                                μ
                                                -
                                                Σ
                                                T
                                                
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      d
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                Σ
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                o
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          (
                                          μ
                                          -
                                          Σ
                                          T
                                          
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                K
                                             
                                             
                                                d
                                             
                                          
                                          )
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        Thus the weight 
                           
                              α
                              (
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         in Eq. (8) can be numerically computed as bounded integration of a Gaussian distribution, and the boundary are modified to require that the minimum target height is 
                           
                              
                                 
                                    r
                                 
                                 
                                    0
                                 
                              
                           
                        .

At this point we have introduced two factors that increase the realism and completeness of the proposed model, while maintaining a low computational cost for the reward function. In the next sections the management of occlusions among targets will be introduced to further reduce the difference between the expected information gain and the real information gain obtained from the camera.

Occlusions represent a serious problem for the selection of the action due to a wrong estimation of the information gain for a target. In fact, being occlusions not modeled in the above formulation, even an occluded target would bring a contribution to the expected information gain, which will not correspond to real information gain obtained after the action is performed. As analyzed in [55] the larger the occluded area for a target the more probable that the detection algorithm will fail. Without any information on possible occluding obstacles in the field of view, we can only keep into account inter-occlusions among targets. To this aim, we introduce a term that estimates the ratio of area of a person occluded in the frame, resembling the depth-sorting method of [56]. In practice, we build a binary occlusion mask which indicates the occluded pixels for each target. From now on we slightly modify the notation, introducing an index for each target 
                           
                              k
                              ∈
                              K
                           
                         (with 
                           
                              |
                              K
                              |
                              =
                              K
                           
                        ), since we will have to consider also the dependencies among two or more targets.

Formally, let 
                           
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              ∈
                              [
                              0
                              ,
                              1
                              ]
                           
                         be the ratio of the bounding box of the target which is visible at time t, we can estimate the relation between the probability of detecting the target and its associated 
                           
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                              
                           
                         by injecting this variable in Eq. (5):
                           
                              (16)
                              
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 
                                    ∫
                                    
                                       ¬
                                       
                                          
                                             Ω
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 p
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 d
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       -
                                       ,
                                       k
                                    
                                 
                                 )
                                 +
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 p
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 ∫
                                 p
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 0
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 p
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 d
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 d
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 )
                                 +
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 p
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 ∫
                                 p
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 1
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 p
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 d
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 d
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 =
                                 (
                                 1
                                 -
                                 α
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 )
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       -
                                       ,
                                       k
                                    
                                 
                                 )
                                 +
                                 α
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       +
                                       ,
                                       k
                                    
                                 
                                 )
                                 .
                              
                           
                        As for the previous case, we just need to compute for any possible action 
                           
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                           
                         a modified version of the weight 
                           
                              α
                              (
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                        :
                           
                              (17)
                              
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 p
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 ∫
                                 p
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 1
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 p
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 d
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 d
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                        which requires to define 
                           
                              p
                              (
                              
                                 
                                    d
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              =
                              1
                              |
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         and 
                           
                              p
                              (
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                        .


                        Detection probability with occlusion term. We assume that the effect of the occlusion ratio and the target size on the detection performance are independent. This leads to the following factorization: 
                           
                              p
                              (
                              
                                 
                                    d
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                              =
                              p
                              (
                              
                                 
                                    d
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                              p
                              (
                              
                                 
                                    d
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              )
                           
                        , where the first factor has been computed in Section 5.1. To estimate 
                           
                              p
                              (
                              
                                 
                                    d
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              )
                           
                        , i.e., the effect of the occlusion on the detection performance, we use again the Caltech Pedestrian Dataset [55], obtaining the plots shown in Fig. 4(right). We choose to approximate this relation as linear: 
                           
                              p
                              (
                              
                                 
                                    d
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              =
                              1
                              |
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              )
                              =
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                           
                        .


                        Computing occlusion ratio for each target. 
                           
                              p
                              (
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         estimates the distribution of the occlusion ratio, given the observation for the target k and the camera position. This term also depends on the position of the other targets in the scene (collectively indexed by 
                           
                              
                                 
                                 
                                    ¬
                                    k
                                 
                              
                           
                        ), so we need to expand it as:
                           
                              (18)
                              
                                 p
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 ∫
                                 p
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       K
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 p
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       K
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 d
                                 
                                    
                                       o
                                    
                                    
                                       ¬
                                       k
                                    
                                 
                                 .
                              
                           
                        The term 
                           
                              p
                              (
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    o
                                 
                                 
                                    K
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         expresses the visibility probability given by the ratio of visible versus occluded pixels:
                           
                              (19)
                              
                                 p
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       o
                                    
                                    
                                       K
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 δ
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                       δ
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             
                                                <
                                             
                                             
                                                u
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                          
                                             ¬
                                             k
                                          
                                       
                                       |
                                       
                                          
                                             a
                                          
                                          
                                             t
                                          
                                       
                                       )
                                       du
                                    
                                    
                                       ∫
                                       δ
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       |
                                       
                                          
                                             a
                                          
                                          
                                             t
                                          
                                       
                                       )
                                       du
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              δ
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    <
                                 
                                 
                                    u
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    ¬
                                    k
                                 
                              
                              |
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         is a binary mask that takes value 1 if at pixel u a part of target k is observed, and 0 otherwise. The other term 
                           
                              ∫
                              δ
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         measures the whole target area.

The main limitation of this formulation is that it is not possible anymore to compute the information gain for each target independently, since the relative position among targets is considered when estimating occlusion, and it is also not possible to compute the 
                           
                              p
                              (
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         in closed form.

Therefore, at each possible camera pose we apply a Monte Carlo approach sampling from 
                           
                              p
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    -
                                    ,
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    -
                                    ,
                                    k
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    -
                                    ,
                                    K
                                 
                              
                              )
                              =
                              
                                 
                                    ∏
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    K
                                 
                              
                              p
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    -
                                    ,
                                    k
                                 
                              
                              )
                           
                        , M sets of positions 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                t
                                                ,
                                                j
                                             
                                             
                                                -
                                                ,
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                t
                                                ,
                                                j
                                             
                                             
                                                -
                                                ,
                                                k
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                t
                                                ,
                                                j
                                             
                                             
                                                -
                                                ,
                                                K
                                             
                                          
                                       
                                    
                                 
                                 
                                    j
                                    =
                                    1
                                    …
                                    M
                                 
                              
                           
                         for all the targets. Then, for a candidate action 
                           
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                           
                        , the corresponding weight 
                           
                              
                                 
                                    α
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         is estimated from the related sets of observation predictions, 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      o
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                t
                                                ,
                                                j
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      o
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                t
                                                ,
                                                j
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      o
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                t
                                                ,
                                                j
                                             
                                             
                                                K
                                             
                                          
                                       
                                    
                                 
                                 
                                    j
                                    =
                                    1
                                    …
                                    M
                                 
                              
                           
                        , computed according to the model of Eq. (2). Each of this set j is used to evaluate the inner integral in Eq. (17):
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       t
                                       ,
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 ∫
                                 p
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 1
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             o
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       t
                                       ,
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 p
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             o
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       t
                                       ,
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 d
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                        providing the detection probability of the target k in the sample j. The final 
                           
                              
                                 
                                    α
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         for the target k is therefore computed replacing the integral in Eq. (17) with a summation over the samples:
                           
                              (21)
                              
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       t
                                       ,
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 .
                              
                           
                        The conditional entropy for that target is then computed according to Eq. (7). The sum of the contribution of each target provides the information gain for all the targets. In Sections 5.1 and 5.2, we gradually refined the reward function making the expected entropy to match the realized entropy, thus helping in choosing a better action. Fig. 5
                         shows such effect on some synthetic data.

We want to model the mechanical constraints that define the set of positions reachable from the current pose, in a given time interval, of a real PTZ camera. Given the set of all the possible camera actions 
                           
                              A
                           
                         and the previous action 
                           
                              
                                 
                                    a
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              =
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              )
                           
                        , an action 
                           
                              (
                              ϕ
                              ,
                              θ
                              ,
                              f
                              )
                              ∈
                              A
                           
                         also belongs to the set of actions 
                           
                              
                                 
                                    A
                                 
                                 
                                    t
                                 
                              
                           
                        , reachable at the next time t, if:
                           
                              (22)
                              
                                 |
                                 ϕ
                                 -
                                 
                                    
                                       ϕ
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 |
                                 ⩽
                                 Δ
                                 ϕ
                                 ∧
                                 |
                                 θ
                                 -
                                 
                                    
                                       θ
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 |
                                 ⩽
                                 Δ
                                 θ
                                 ∧
                                 |
                                 f
                                 -
                                 
                                    
                                       f
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 |
                                 ⩽
                                 Δ
                                 f
                                 ,
                              
                           
                        where 
                           
                              Δ
                              ϕ
                           
                         and 
                           
                              Δ
                              θ
                           
                         are the maximum displacement allowed in the unit of time for the pan and tilt angles and 
                           
                              Δ
                              f
                           
                         is the maximum variation in the zoom, that can be easily obtained by combining the expected system frame rate and the camera specifications.

To take into account for new targets occurring in the scene, the PTZ has to randomly patrol, looking for new evidence. To model this factor we get inspiration from [38], where an additional term 
                           
                              
                                 
                                    I
                                 
                                 
                                    p
                                 
                              
                              (
                              
                                 
                                    b
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         related to the patrolling around the scene is defined. Such factor estimates the information gain that could be obtained performing an action 
                           
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                           
                         due to the detection of a new target 
                           
                              
                                 
                                    b
                                 
                                 
                                    t
                                 
                              
                           
                        .

When combining the information gain on target position uncertainty with the patrolling term we obtain:
                           
                              (23)
                              
                                 
                                    
                                       I
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                       
                                       
                                          N
                                       
                                    
                                 
                                 I
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ;
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 +
                                 β
                                 
                                    
                                       I
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 ,
                              
                           
                        where 
                           
                              β
                           
                         is the weight that mixes the two quantities.

With this last element we complete the definition of the MDP process formed by the EKF equations plus the reward function. In particular, Eqs. (8) and (17) characterize the two proposed versions, the first more efficient and the second one more complex, which also takes into account the occlusions. Algorithm 1 shows the pseudo-code for the version with the occlusions handling.
                           Algorithm 1
                           Algorithm for the myopic approach
                                 
                                    
                                 
                              
                           

The solution proposed so far is myopic, i.e. the action to be performed at the next step is selected only considering the current system state and the prediction for the next time step, as shown in Fig. 6
                     . Better results could be achieved if we design a non-myopic approach, where the reward function to be maximized considers more than one step in the future. A non-myopic approach would outperform the myopic one when there are terms which are time-variant: a visibility map on the scene (trees, houses or other occlusion that could prevent the tracker from working properly), occlusions between targets that move close to each others, a target that is leaving the field of view or a target that is going far away from the camera where it will be no longer visible. Indeed, these are all examples of a realistic scenario, that we want to take into account. On the other hand, reasoning on a longer temporal horizon requires a precise modeling of the target future behavior in order to produce a reliable prediction of the targets trajectories.

To solve the non-myopic approach we use a sampling strategy inspired by [48], that allows approximate computation on a MDP with very large or infinite dimensionality of the state space.
                           Algorithm 2
                           Algorithm for the non-myopic approach
                                 
                                    
                                 
                              
                           

The main idea is to estimate the future dynamic of the model by sampling the future observations 
                           
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                           
                         from the 
                           
                              p
                              (
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                              ,
                              a
                              )
                           
                        . The sampled observation 
                           
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                           
                         are used to update the state 
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                           
                         according to the 
                           
                              p
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    o
                                 
                                 
                                    t
                                 
                              
                              )
                           
                        . The prediction and sampling iteration are repeated iteratively in future steps and at each step the information gain is computed. The global information gain is computed as a discounted sum of the current and future steps.

Let L be the maximum number of possible actions that are reachable from any action 
                           
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                           
                         and M the number of observations to sample at each time for each action. Exploiting the notation of [48], we define the selection of the best action at time t over the finite horizon 
                           
                              ℏ
                           
                         as:
                           
                              (24)
                              
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                    
                                       ★
                                    
                                 
                                 =
                                 arg
                                 
                                    
                                       
                                          max
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                 Q
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 ℏ
                                 )
                                 ,
                              
                           
                        with:
                           
                              (25)
                              
                                 
                                    
                                       
                                       
                                          
                                             Q
                                             (
                                             
                                                
                                                   a
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                             
                                             ,
                                             ℏ
                                             )
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                             (
                                             I
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                
                                             
                                             ;
                                             
                                                
                                                   z
                                                
                                                
                                                   t
                                                
                                             
                                             |
                                             
                                                
                                                   a
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             +
                                             γ
                                             V
                                             (
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             ℏ
                                             -
                                             1
                                             )
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             V
                                             (
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             ℏ
                                             )
                                             =
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                             Q
                                             (
                                             
                                                
                                                   a
                                                
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             ℏ
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             Q
                                             (
                                             
                                                
                                                   a
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                             
                                             ,
                                             1
                                             )
                                             =
                                             I
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                
                                             
                                             ;
                                             
                                                
                                                   o
                                                
                                                
                                                   t
                                                
                                             
                                             |
                                             a
                                             )
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              γ
                           
                         is the discount factor parameter. Such parameter balances the contribution of the information gain expected at the next step and the information gain expected on later steps. A complete recursive description of the algorithm is given in Algorithm 2 while Fig. 7
                         gives a graphical representation of the procedure. At the final step, in the leaves of the tree we can either compute the information gain considering also the occlusion through the sampling procedure or compute the closed form reward, that discards the occlusion effects.

We add the pruning parameter 
                           
                              
                                 
                                    r
                                 
                                 
                                    p
                                 
                              
                           
                         that allows to reduce the size of the tree to be explored, discarding the least promising actions at the current step. The computational cost is 
                           
                              O
                              (
                              L
                              ·
                              K
                              )
                           
                         for the myopic case and 
                           
                              O
                              (
                              
                                 
                                    (
                                    K
                                    ·
                                    L
                                    )
                                 
                                 
                                    ℏ
                                 
                              
                              ·
                              
                                 
                                    (
                                    M
                                    ·
                                    
                                       
                                          r
                                       
                                       
                                          p
                                       
                                    
                                    )
                                 
                                 
                                    ℏ
                                    -
                                    1
                                 
                              
                              )
                           
                         for the non-myopic. The pruning factor 
                           
                              
                                 
                                    r
                                 
                                 
                                    p
                                 
                              
                           
                         is essential when considering a system with many possible actions, we set it to 
                           
                              
                                 
                                    r
                                 
                                 
                                    p
                                 
                              
                              =
                              0.1
                           
                         in our experiments.

The non-myopic approach should be extremely effective in case of occlusions that are considered in the look-ahead procedure via sampling. The number of samples that can be used in our approach is really limited due to exponential growth of the tree in the number of samples. In fact, each new sampled observation generates a state for the tracking algorithm that must be propagated in the future. On the other hand, a small number of samples gives a very rough idea on the expected state of the targets, in particular whether it would be visible or not.

We would like to better predict the expected information gain, keeping a reduced size of the tree, i.e. keeping the same computational complexity as if 
                           
                              M
                              =
                              1
                           
                        . To achieve this we first sample M observations for each action and compute the expected information gain, but then these data are merged, resulting in a single updated value for the filter state. This state 
                           
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    M
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    M
                                 
                              
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    j
                                 
                              
                           
                         is the average of the states corresponding to each observation. In this way, we do not have to generate a subtree for each of the M sample, but a single subtree for each action, as shown in Fig. 7. Its variance 
                           
                              
                                 
                                    P
                                 
                                 
                                    ‾
                                 
                              
                           
                         is computed as the weighted geometrical mean between matrix to preserve the same information gain, [58]:
                           
                              (26)
                              
                                 
                                    
                                       P
                                    
                                    
                                       ‾
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             -
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                   )
                                                
                                                
                                                   -
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   P
                                                
                                                
                                                   +
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                   )
                                                
                                                
                                                   -
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             -
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        such definition ensures that if 
                           
                              
                                 
                                    P
                                 
                                 
                                    +
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    -
                                 
                              
                           
                         are symmetric and definite positive, also 
                           
                              
                                 
                                    P
                                 
                                 
                                    ‾
                                 
                              
                           
                         is. Moreover, the entropy 
                           
                              
                                 
                                    H
                                 
                                 
                                    ‾
                                 
                              
                           
                         associated to a Gaussian distribution with variance 
                           
                              
                                 
                                    P
                                 
                                 
                                    ‾
                                 
                              
                           
                         is exactly the weighted arithmetic mean of the entropy associated to 
                           
                              
                                 
                                    P
                                 
                                 
                                    +
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    -
                                 
                              
                           
                        , with weight 
                           
                              α
                           
                        . This property guarantees that the entropy obtained averaging over the samples is the same as the entropy associated to this new state 
                           
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                           
                        :
                           
                              (27)
                              
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 H
                                 (
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 H
                                 (
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       j
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 H
                                 (
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       j
                                    
                                    
                                       -
                                    
                                 
                                 )
                                 =
                                 α
                                 H
                                 (
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 +
                                 (
                                 1
                                 -
                                 α
                                 )
                                 H
                                 (
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       -
                                    
                                 
                                 )
                                 ,
                              
                           
                        where 
                           
                              α
                              =
                              
                                 
                                    1
                                 
                                 
                                    M
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    M
                                 
                              
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    j
                                 
                              
                           
                        . By applying this procedure we propagate only one subtree common to all the M observations, thus the computational complexity reduces to 
                           
                              O
                              (
                              
                                 
                                    (
                                    K
                                    ·
                                    L
                                    )
                                 
                                 
                                    ℏ
                                 
                              
                              ·
                              
                                 
                                    r
                                 
                                 
                                    p
                                 
                                 
                                    ℏ
                                    -
                                    1
                                 
                              
                              ·
                              M
                              )
                           
                        , which is linear in the number of samples instead of exponential. The summarization causes the loss of the multiple modes, represented by the samples, which are not propagated to future steps.

The method presented in the previous sections describes an algorithm for efficiently and automatically managing a single PTZ camera in a standard multi-target tracking scenario. The extension to a network of multiple PTZ cameras may be obtained in several ways. For example [39] proposes a sequential Kalman filter to combine, in the update stage, the observations of the same target as seen from different cameras. This approach can be applied also to the information gain formulation we proposed. Consider a set 
                        
                           C
                        
                      of 
                        
                           
                              
                                 N
                              
                              
                                 c
                              
                           
                        
                      cameras which successfully observe a target 
                        
                           
                              
                                 x
                              
                              
                                 t
                              
                           
                        
                      at time t, the covariance resulting from the successive observation according the sequential Kalman filter is the product:
                        
                           (28)
                           
                              
                                 
                                    P
                                 
                                 
                                    t
                                 
                                 
                                    +
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                ∏
                                             
                                             
                                                c
                                                ∈
                                                C
                                             
                                          
                                       
                                       
                                          
                                             
                                                I
                                                -
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      c
                                                   
                                                
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      c
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                              .
                           
                        
                     As observed in [39] this equation depends on the order in which each camera is considered, mainly because it does not take into account the fact that a camera could miss a target, i.e. 
                        
                           α
                           (
                           
                              
                                 a
                              
                              
                                 t
                              
                              
                                 c
                              
                           
                           )
                           <
                           1
                        
                      in Eq. (4.) All the possible combinations are exponential in the number of cameras and therefore not suitable for an online application. Hence, we approximate the updated covariance for a single camera with 
                        
                           α
                           (
                           
                              
                                 a
                              
                              
                                 t
                              
                              
                                 c
                              
                           
                           )
                        
                     , from the weighted average of Eq. (26):
                        
                           (29)
                           
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    c
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          c
                                          ,
                                          -
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      c
                                                      ,
                                                      -
                                                   
                                                
                                                )
                                             
                                             
                                                -
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   I
                                                   -
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                P
                                             
                                             
                                                t
                                             
                                             
                                                c
                                                ,
                                                -
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      c
                                                      ,
                                                      -
                                                   
                                                
                                                )
                                             
                                             
                                                -
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    α
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          t
                                       
                                       
                                          c
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          c
                                          ,
                                          -
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              .
                           
                        
                     Then, the information gain for a single target across multiple cameras is obtained by successively iterating such computation for each camera, substituting 
                        
                           
                              
                                 P
                              
                              
                                 t
                              
                              
                                 c
                                 ,
                                 -
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             t
                                          
                                       
                                    
                                    
                                       ‾
                                    
                                 
                              
                              
                                 c
                                 -
                                 1
                              
                           
                        
                     .

The formulation is similar to the one proposed in [39] except for the fact that Eq. (29) replaces the weighted sum. As introduced in Section 6, Eq. (29) guarantees that the entropy related to a gaussian distribution with covariance 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             t
                                          
                                       
                                    
                                    
                                       ‾
                                    
                                 
                              
                              
                                 c
                              
                           
                        
                      is the weighted sum of the entropy due to covariances 
                        
                           
                              
                                 P
                              
                              
                                 t
                              
                              
                                 c
                                 ,
                                 -
                              
                           
                        
                      and 
                        
                           
                              
                                 P
                              
                              
                                 t
                              
                              
                                 c
                                 ,
                                 +
                              
                           
                        
                     . This modification does not affect the computational cost, compared to [39]. Indeed, it is exponential in the number of cameras, 
                        
                           O
                           (
                           
                              
                                 (
                                 
                                    
                                       (
                                       K
                                       ·
                                       L
                                       )
                                    
                                    
                                       ℏ
                                    
                                 
                                 ·
                                 
                                    
                                       r
                                    
                                    
                                       p
                                    
                                    
                                       ℏ
                                       -
                                       1
                                    
                                 
                                 ·
                                 M
                                 )
                              
                              
                                 
                                    
                                       N
                                    
                                    
                                       c
                                    
                                 
                              
                           
                           )
                        
                     , since all different combinations of actions for the different cameras need to be evaluated.

Experimenting PTZ tracking solutions is a classic problem in computer vision [59]. The current protocols span between being quantitative and perfectly repeatable with a low realism [26,39], and considering real scenarios, where each test is qualitative and cannot be repeated [13,60]. Here, we consider both the cases, providing a synthetic and a realistic experimental benchmark, which are quantitative and repeatable, concluding with a real experiment where our approach has been implemented in a real-time surveillance platform.

A direct comparison with the methods similar to ours [12,13,40], described in Section 2, is not possible without changing their own network architecture (number of cameras and the way they communicate), or the experimental protocol (data and ground truth information used by previous works). One of the main features of our system is that it integrates both the multi-target tracking module and the camera management on a single PTZ device, differently from [12] which requires a set of fixed cameras to track the targets and then drive the PTZ cameras towards the target of interest. Both [13,40] perform live experiments on their own video-surveillance network, hence it is not possible to perform new tests on the same sequences.

We tried to compare our method with the solution proposed in [38], which is the only one focusing on information theoretic management for a single PTZ camera. In particular, this is obtained by simplifying our method (without the detector performance, the occlusion management and the look-ahead optimization) in order to obtain an implementation as close as possible to their method, apart for the fact that we are tracking the targets in the ground plane, instead of the image plane as they do. Results in Sections 9 and 10 demonstrates that the contributions proposed in this paper allow to outperform [38].

We have performed two kind of experiments, synthetic and realistic, for both myopic and non-myopic strategies in order to quantitatively and qualitatively asses the performance of our approach. For the myopic method we have also performed a real experiment with an off-the shelf IP PTZ camera (Sony SNC-RZ30P).

The synthetic scenario consists in a 
                           
                              15
                              ×
                              15
                           
                        
                        m area, with 7 targets following random trajectories mimicking human motion, Fig. 2 (a). The targets are always in the scene, thus the exploration term 
                           
                              
                                 
                                    I
                                 
                                 
                                    p
                                 
                              
                           
                         in Eq. (23) is not considered. We run 12 different sequences, each 50 frames long, with diverse target trajectories, and compute the final scores averaging the per sequence results. In each sequence, we manage 350 target instances, which have to be detected and associated to tracks. The action set has 4 steps for the zoom, 7 for pan angle and 10 for tilt angle (i.e., L
                        =280 different actions). To model the mechanical constraints the camera can move by a maximum displacement of 2 steps for the angles and 1 for the zoom.

For the realistic experiments, as compromise between repeatability and realism, we consider here the PETS 2009 (S2-L1-View1) benchmark, Fig. 2b, where intrinsic calibration matrix 
                           
                              K
                              
                                 
                                 
                                    c
                                 
                              
                           
                         and the extrinsic calibration information are provided. For reproducing the PTZ zoom 1, we reduce the 576×768 resolution to 120×160. The homography 
                           
                              G
                              
                                 
                                 
                                    ptz
                                 
                              
                           
                         for this virtual camera to the 3D plane is 
                           
                              G
                              
                                 
                                 
                                    ptz
                                 
                              
                              =
                              K
                              
                                 
                                 
                                    c
                                 
                              
                              R
                              
                                 
                                 
                                    ptz
                                 
                              
                              K
                              
                                 
                                 
                                    ptz
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                        , where 
                           
                              K
                              
                                 
                                 
                                    ptz
                                 
                              
                           
                         and 
                           
                              R
                              
                                 
                                 
                                    ptz
                                 
                              
                           
                         are the intrinsic and the rotation PTZ matrices (defined empirically). The original extrinsic calibration data allow to map the ground plane to the original sequence image plane and then, through the 
                           
                              H
                              
                                 
                                 
                                    ptz
                                 
                              
                           
                        , to the virtual PTZ image plane. The action set is made of 140 different actions, 7 for pan angle, 5 for tilt angle and 4 steps for the zoom. The mechanical constraints of the camera are implemented as in the previous case. The sequence is 795 frames longa and we sub-sample it every 2 frames. Globally, there are 19 different targets, for a total of 2322 true detections.

The whole framework has been implemented in MATLAB and it works at 10fps for the Gaussian integral solution of Eq. (8) and 
                           
                              0.3
                           
                        
                        fps for the sampling strategy of Eq. (21). However, it is easily parallelizable both in the sampling stage and in evaluating Eq. (5) for the various actions. Indeed, the evaluation of the expected information gain for each action can be done independently. With 
                           
                              Δ
                              ϕ
                              =
                              2
                              ,
                              Δ
                              θ
                              =
                              2
                           
                         and 
                           
                              Δ
                              f
                              =
                              1
                           
                         the number of reachable actions varies between 18 (at the corners of the grid) and 75. If enough parallel threads are available this can lead to a speedup from 18× to 75× when computing the information gain for each action.

To ease future comparisons, we adopt standard multi-target tracking metrics: the Multiple Object Tracking Accuracy (MOTA, the higher the better) which tells how reliable the tracks are and the Multiple Object Tracking Precision (MOTP, the lower the better) [61], which measures the error in localizing the tracked targets on the ground plane. In addition, we calculate the average height of targets as detected in the image, analogously to [38]: the bigger a target appears on the screen, the more information could be extracted for higher level tasks (recognition, re-identification, etc.). Other important parameters for appreciating the performance from different strategies are the number of detections on the whole sequence and the average zoom value for the camera.

We use three comparative control strategies: ‘fix’, keeping the camera fixed at the lowest zoom (1x), ‘patrol’, scanning the field of regard according to a preset sequence, ‘random’, performing actions randomly chosen from the set 
                           
                              A
                           
                        .

We exploit the occlusion term of Eq. (17), comparing the Gaussian integral solution of Eq. (8), namely ‘intg’ (that represent our implementation of [38]), with the sampling strategy of Eq. (21), namely ‘smpl’.

Two different experimental sessions are performed on the synthetic scenario, comparing the formulations proposed above for two different types of pedestrian detectors.

A first session considers a perfect detector, whose performance does not decay for smaller targets, but still worsens when the target gets occluded; results are in Table 3
                        . The following observations can be made: (1) both the ‘intg’ and ‘smpl’ approaches outperform the competing PTZ strategies ‘patrol’ and ‘rnd’, both in terms of MOTA and MOTP; (2) the ‘fix’ policy is the best among the competitors: actually, it detects a large number of targets (see # Dets), even when they are small, due to the perfect detector; (3) the improvements of our approaches are mainly due to the zooming on the targets (see Zoom [x]), which both creates more reliable tracks (higher MOTA) and better localization (lower MOTP); (4) the sampling approach, that prevents the camera from observing targets which may be occluded, outperforms the ‘intg’ approach.

Note that when using the ideal detector and the ‘intg’ version, which discards the occlusions, our method slightly differs from the approach in [38]. In fact, in this case our approach only considers the mechanical constraints of the camera and the physical extension of the targets as additional elements. Hence, results also show a clear improvement with respect to [38].

In the second session, we consider Eq. (14), substituting the ideal detector with a realistic one, which simulates the HOG performance (i.e. it works worse at small resolutions). Results are in Table 4
                        , leading to considerations similar to the previous test. The presence of a realistic detector brings in general to worse MOTA and MOTP scores. In addition, the #Dets in the ‘fix’ case decreases dramatically (it cannot zoom to increment the number of detections), and, in general, both the proposed approaches are better in this case. In fact, our strategies know that they need to zoom more (see the Zoom values) to possibly get a detection. Again, the advantage of keeping into account the occlusion term is evident.

A different experimental setup uses a publicly available dataset (PETS2009) and its ground truth for quantitative evaluation. Fig. 8
                         shows how a PTZ camera is simulated from the original frame, and used to track targets on the ground plane, exploiting the calibration data.

In a first test, whose results are in Table 5
                        , we employ the ideal detector, extracting the bounding box from the ground-truth and removing the occluded ones. Since in this sequence people are entering and leaving the scene, we include the exploration term (Eq. (23)), testing two different values for 
                           
                              β
                           
                        . Considerations: (1) the sampling strategy gives better results for both values of 
                           
                              β
                           
                        , in terms of MOTA, MOTP, and Height; (2) since we have all the detections, MOTA is high also for the fixed strategy. MOTP is higher with our policies, due to the possibility of zooming. (3) reducing 
                           
                              β
                           
                         encourages to focus on the tracked targets (i.e., lower MOTP) instead of capturing new items. The best value for 
                           
                              β
                           
                         should be a compromise between tracking accuracy and the capability of capturing novel targets.

In the second test, we introduce a real implementation of the HOG detector, enriching the realism of the simulation, and therefore introduce in the implementation the term in Eq. (14). Results are in Table 6
                         and in general are dramatically lower than those in Table 5 because of the many false positives and missed detections from the HOG detector. The improvement of the ‘smpl’ method with respect to the competitor strategies is evident considering MOTA, this is due to term in Eq. (14) that pushes the camera to increase the zoom with respect to the previous case of the ideal detector. The MOTP is slightly better for the ‘fix’ strategy, but this is due to the fact that it is computed only for the targets correctly tracked, that are less than for the ‘smpl’ case.

We also tested our system with a real-time off-the shelf IP PTZ camera, Sony SNC-RZ30P. In order to estimate the calibration parameters of the PTZ camera while moving we use a method similar to [62]. The action set 
                           
                              A
                           
                         is made of 462 actions corresponding to the following grid: 14 values for pan×11 tilt×3 zoom. The step between two pan angles is 10.4°, for the tilt is 4.3°, and the zoom values are 1×, 6× and 9×. We set 
                           
                              β
                              =
                              0.667
                           
                         and used the ‘intg’ approach, due to the real-time constraints. The whole system works online at about 15fps for the tracker and 3fps for the action selection. Some frames (videos are in supplementary material) are shown in Fig. 9
                         with a detailed description. The method produces a camera which is able to fully autonomous move in the scene, according to the utility cost, and resulting in a “reasonable” behavior without any supervision from a human operator or other sensors. Effective implementations of computer vision algorithm on PTZ camera are really few, and as far as we know it is the first time a sophisticated algorithm is successfully applied to a stand alone PTZ camera.

A first session considers a perfect detector, whose performance does not decay for smaller targets, but still worsens as the target gets occluded. Results are in Table 7
                        ; 
                           
                              ℏ
                              =
                              1
                           
                         indicates the myopic approach, 
                           
                              ℏ
                              =
                              2
                              ,
                              3
                           
                         address the non-myopic strategy, with horizon 2 and 3, respectively.

Many observations can be made: (1) for all the three values of 
                           
                              ℏ
                           
                         and in terms of MOTA and MOTP our approach outperforms the other competitors. (2) The ‘fix’ strategy is the best among the competitors: actually, it detects a large number of targets (see #Dets), even when they are small, due to the perfect detector. The improvement of the myopic approach (
                           
                              ℏ
                              =
                              1
                           
                        ) is mainly due to the zooming on the targets (see Zoom [x]), which both creates more reliable tracks (higher MOTA) and better localization (lower MOTP). In this scenario the non-myopic approach 
                           
                              ℏ
                              =
                              2
                              ,
                              3
                           
                         does not improve the MOTA metric but provides higher resolution images for the targets. This happens because typically the set of tracked targets is divided on the future steps, hence the camera precisely focuses on few targets at each time. Anyway being the detector ideal, the targets are detected even when they are small in the image, for this reason the MOTA is at is maximum value for 
                           
                              ℏ
                              =
                              1
                           
                        . For a deeper understanding of the non-myopic approach, Fig. 10
                         visualizes the action selection process: the information gain for all the reachable actions is evaluated considering the contribution of each target at each horizon.

In the second session we substitute through Eq. (14) the ideal detector with another one, which simulates the HOG performance. Results are in Table 8
                        , leading to considerations similar to the previous test. In addition, the presence of a realistic detector brings in general to lower MOTA and MOTP scores. The #Dets in the ‘fix’ case decreases dramatically (it cannot zoom for taking care of the detector) and in general all the comparative approaches are better in this respect In fact, our strategies know that they need to zoom more (see the Zoom values) to possibly get a detection. From these simulations, it seems that the best horizon is (
                           
                              ℏ
                              =
                              2
                           
                        ). This indicates a natural limit of the system in going too far in the future, and this is reasonable. If the target abruptly changes directions, when close to the boundaries of the limited area, the EKF engine is not able to predict far in future the probability density for the target’s position. Thus, an action selected relying on such prediction could not be the best.

In Table 9
                         we report the results on the PETS sequence using the ground truth as detector. As it can be seen the non-myopic approach obtain slightly better performance than the myopic version in terms of accuracy (MOTA). The best horizon is 
                           
                              ℏ
                              =
                              2
                           
                         since we obtain the highest MOTA value and an high accuracy in the localization. In this first setting the detector is not affected by the target size: all the non occluded targets, even at very low resolution (less than 20 pixels) are correctly detected. For this reason the ‘fix’ strategy has the second best MOTA. Anyway, the zooming capability of the camera helps in the localization. In fact, the MOTP is lower for 
                           
                              ℏ
                              =
                              1
                              ,
                              2
                              ,
                              3
                           
                         and results in a higher average size of targets on the image plane 
                           
                              36.1
                           
                         pixels for 
                           
                              ℏ
                              =
                              3
                           
                         while the ‘fix’ strategy obtain 
                           
                              19.9
                           
                         pixels.

In the second test, we introduce a real implementation of the HOG detector, enriching the realism of the simulation. Since we noticed that the HOG detector was performing quite well on this dataset, better than the expected performance (Fig. 4), we did not put the detection term in the estimation (
                           
                              
                                 
                                    K
                                 
                                 
                                    d
                                 
                              
                              =
                              +
                              ∞
                              ,
                              
                                 
                                    r
                                 
                                 
                                    0
                                 
                              
                              =
                              +
                              ∞
                           
                        ). The results are in Table 10
                        . Even in this case, the non-myopic approach does considerable better than the myopic version, as witnessed by the MOTA score. In this case, the best horizon is 
                           
                              ℏ
                              =
                              3
                           
                         since the dynamics of the targets is simpler, with less changes in directions. Therefore, our model (and the EKF dynamics) can predict the future target trajectories with more reliability.

@&#CONCLUSIONS@&#

In this paper, we propose a novel solution to perform sensor management of a single PTZ camera for multiple target tracking. Such solution considers the detector performance at different image resolutions and occlusion ratios. Moreover, it considers the effects of a different camera pose to targets localization. To further improve the tracking performance we apply a non-myopic approach which considers future occlusions among targets in selecting the next actions. We analyze the characteristics and demonstrate the effectiveness of our approach through, synthetic experiments, realistic simulations and effective real-time trials on a real PTZ camera.

Assuming a constant image measurement error and perfect calibration, world coordinate localization is much more accurate if the backprojection is performed using zoomed views (i.e. long focal length).

We derive analytically the expression that allows to appreciate how zoom affects the measurement equation in the recursive filtering formulation. Measurement uncertainty is mainly oriented along the direction of instantaneous depth because of the panning camera capability. According to this, uncertainty can be quantified assuming a 1D projective camera parametrized by the tilt angle 
                        
                           θ
                        
                      in the instantaneous plane rotating around the vertical camera axis and focal length f.

Without loss of generality let’s consider that the principal point lies at the image center:
                        
                           (A.1)
                           
                              K
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     We further have:
                        
                           (A.2)
                           
                              R
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                cos
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                
                                             
                                             
                                                -
                                                sin
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                sin
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                
                                             
                                             
                                                cos
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     The 1-D camera projection matrix 
                        
                           P
                           =
                           K
                           [
                           R
                           |
                           t
                           ]
                        
                      results in:
                        
                           (A.3)
                           
                              P
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                                cos
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                
                                             
                                             
                                                -
                                                f
                                                sin
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                sin
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                
                                             
                                             
                                                cos
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                
                                             
                                             
                                                -
                                                d
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           t
                           =
                           
                              
                                 [
                                 0
                                 -
                                 d
                                 ]
                              
                              
                                 ⊤
                              
                           
                        
                      and d is the camera distance with respect to the scene plane. Being the scene plane 
                        
                           Z
                           =
                           0
                        
                     , the 1D homography from world to image can be computed from Eq. (A.3):
                        
                           (A.4)
                           
                              H
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                                cos
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                sin
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                
                                             
                                             
                                                -
                                                d
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     The inverse:
                        
                           (A.5)
                           
                              H
                              
                                 
                                 
                                    -
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      f
                                                      cos
                                                      
                                                         
                                                            
                                                               θ
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      sin
                                                      
                                                         
                                                            
                                                               θ
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      f
                                                      cos
                                                      
                                                         
                                                            
                                                               θ
                                                            
                                                         
                                                      
                                                      d
                                                   
                                                
                                             
                                             
                                                -
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     can be used to compute the back-projected uncertainty of a given noise uncertainty 
                        
                           ∊
                        
                      assumed in the camera image sensor and compute its backprojection 
                        
                           δ
                        
                     . Without loss of generality and for the sake of simplicity, let’s define:
                        
                           (A.6)
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                ∊
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     their corresponding backprojected points:
                        
                           (A.7)
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              =
                              H
                              
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                             
                                          
                                          
                                             
                                                -
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (A.8)
                           
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                              =
                              H
                              
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∊
                                                   
                                                   
                                                      f
                                                      cos
                                                      
                                                         
                                                            
                                                               θ
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      sin
                                                      
                                                         
                                                            
                                                               θ
                                                            
                                                         
                                                      
                                                      ∊
                                                   
                                                   
                                                      f
                                                      cos
                                                      
                                                         
                                                            
                                                               θ
                                                            
                                                         
                                                      
                                                      d
                                                   
                                                
                                                -
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     are used to compute:
                        
                           (A.9)
                           
                              δ
                              =
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    ∊
                                    
                                    d
                                 
                                 
                                    sin
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                    ∊
                                    -
                                    f
                                    cos
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     Given 
                        
                           ∊
                           ,
                           θ
                        
                      and d, the value of 
                        
                           δ
                        
                      can be increased by increasing the focal length (i.e. performing zoom-in).

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.cviu.2014.12.001.


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

