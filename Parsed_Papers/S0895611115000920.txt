@&#MAIN-TITLE@&#Landmark constrained registration of high-genus surfaces applied to vestibular system morphometry

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Landmark constrained diffeomorphic registration of high-genus surfaces is proposed.


                        
                        
                           
                           Registration algorithm is based on quasi-conformal theories.


                        
                        
                           
                           Shape analysis models are proposed using the registration.


                        
                        
                           
                           Proposed models are tested on 27 vestibular system (VS) surfaces.


                        
                        
                           
                           Shape differences in the posterior canal between normal and AIS group are found.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Surface registration

Landmark

High-genus surface

Vestibular system

Universal covering space

Beltrami coefficients

Homotopic loops

Minimal surfaces

@&#ABSTRACT@&#


               
               
                  The analysis of the vestibular system (VS) is an important research topic in medical image analysis. VS is a sensory structure in the inner ear for the perception of spatial orientation. It is believed several diseases, such as the Adolescent Idiopathic Scoliosis (AIS), are due to the impairment of the VS function. The morphology of the VS is thus of great research significance. A major challenge is that the VS is a genus-3 surface. The high-genus topology of the VS poses great challenges to find accurate pointwise correspondences between the surfaces and whereby perform accurate shape analysis. In this paper, we present a method to obtain the landmark constrained diffeomorphic registration between the VS surfaces based on the quasi-conformal theory. Given a set of corresponding landmarks on the VS surfaces, a diffeomorphism between the VS surfaces that matches the features consistently can be obtained. The basic idea is to iteratively search for an admissible Beltrami coefficient, which is associated to our desired landmark matching registration. With the obtained surface registrations, vertex-wise morphometric analysis can be carried out. Two types of geometric features are used for shape comparison. One is the collection of homotopic loops on each canals of the VS, which can be used to measure the local thickness of the canals. From the homotopic loops, centerlines can be extracted. By examining the deviations of the centerlines from the best fit planes, bendings of the canals can be detected. The second geometric feature is the minimal surface enclosed by the homotopic loop. From the minimal surfaces of each homotopic loops, cross-sectional area of the canals can be evaluated. To study the local shape difference more comprehensively, a complete shape index, which is defined using the Beltrami coefficients and surface curvatures, is used. We test proposed registration method on 15 VS of normal control subjects and 12 VS of patients suffering from AIS. Experimental results show the efficacy and accuracy of the proposed algorithm to compute the VS surface registration. Shape analysis has also been carried out using the proposed geometric features and shape index, which reveals shape differences in the posterior canal between normal and diseased AIS groups.
               
            

@&#INTRODUCTION@&#

Surface-based morphometry has become one of the most ubiquitous shape analysis techniques in medical image analysis. For example, in human brain mapping, the morphometry of brain cortical surfaces has been extensively studied to detect shape changes during disease progression or healthy aging. The hippocampal surface morphometry has also been an active research field to study the Alzheimer's disease.

In order to compare two anatomical surfaces, finding accurate point-wise correspondences between them is of utmost importance. Such a process is called surface registration. Surface registrations between simply-connected open or closed surfaces have been extensively studied and various algorithms have been developed. However, registration between high-genus surfaces is comparatively less studied. The high-genus topology of the surfaces makes the registration procedure much more challenging. One typical example of high-genus anatomical structures is called the vestibular system (VS) (see Fig. 1
                     ). The VS is a genus-3 structure situated in the inner ear, which is a sensory structure responsible for detecting head movements and sending postural signals to the brain. The morphometry of VS plays an important role in the analysis of various diseases such as the Adolescent Idiopathic Scoliosis (AIS) disease. The AIS is a 3D spinal deformity which affects about 4% schoolchildren worldwide. The etiology of AIS is still unclear but believed to be a multi-factorial disease. One popular hypothesis was suggested to be the structural changes in the VS that induce the disturbed balance perception, and further cause the spinal deformity. The morphometry of the VS becomes important to understand the disease.

Our goal in this paper is develop an effective algorithm to obtain accurate registrations between VS surfaces so that systematic shape analysis can be performed. In medical imaging, landmark-based surface registration may sometimes be advantageous, since expert knowledge of feature correspondences can be incorporated into the registration model. Although various landmark-based registration models have been recently proposed, most of them focus on computing landmark matching registrations for simply-connected surfaces. For higher genus surfaces, they are often cut into several simply-connected patches. Landmark-based registration is then obtained by registering every corresponding simply-connected patches. The drawback is that consistent boundary cuts must be accurately delineated, which is usually difficult. In this work, we propose an effective algorithm to obtain the landmark constrained diffeomorphic (1-1 and onto) registration between the VS surfaces, which is independent of the boundary cuts. Given a set of corresponding landmarks on the VS surfaces, a diffeomorphism between the VS surfaces that matches features consistently can be obtained.

To simplify the registration problem, the VS surfaces are firstly parameterized conformally into the hyperbolic disk 
                        
                           ℍ
                        
                      in 
                        
                           
                              
                                 ℝ
                              
                           
                           2
                        
                     , which is endowed with the hyperbolic metric. An iterative scheme is then used to search for a landmark-matching diffeomorphism. It is done by iteratively search for an admissible Beltrami coefficient, which is associated to our desired landmark-aligned diffeomorphism. Using the proposed method, accurate point-wise correspondences between the VS surfaces that match corresponding features can be efficiently obtained within 30s.

Once the surfaces have been registered, vertex-wise morphometric analysis can be carried out. Various corresponding geometric features can also be extracted on the VS, which can be used for the shape comparison. In this paper, we extract two kinds of geometric features on the VS surfaces. One is the homotopic loops on each canals of the VS. A set of geodesic homotopic loops is firstly extracted on the mean VS surface. With the registration, corresponding homotopic loops on every VS surfaces can be extracted. These homotopic loops can be used to study the local geometry and thickness at each position of the VS surface. From the homotopic loops, the centerlines can be extracted, which are curves passing through the centroids of homotopic loops. By examining the deviations of the centerlines from the best fit plane, bendings of the canals can be detected. The second geometric feature is the minimal surfaces enclosed by the homotopic loops. With these minimal surfaces, cross-sectional area at each position of the canals can be evaluated. To study the local geometric difference in details, a complete shape energy, which is defined using the Beltrami coefficients and surface curvatures, is also applied.

We have evaluated the proposed registration algorithm on 15 VS of normal control subjects and 12 VS of AIS patients. Results demonstrate the efficiency and accuracy of the proposed method to compute the VS surface registration. Shape analysis has also been carried out using the proposed shape features and shape energy, which reveals shape differences in the posterior semi-circular canal between the normal control and diseased subjects.

In short, the contributions of this work are two-folded. Firstly, we propose a method to compute the landmark constrained diffeomorphic registration between the high-genus surfaces, which is independent of the boundary cuts. Given any two corresponding sets of landmarks, we can obtain a smooth and bijective map between the high-genus surfaces aligning the landmarks consistently. Secondly, we propose several shape analysis models to study the geometric differences between corresponding VS surfaces.

@&#RELATED WORKS@&#

About 4% of teenagers suffered from Adolescent Idiopathic Scoliosis (AIS). Developed AIS leads to physical pains and lower the pulmonary function. Vital capacity of the lung could be reduced due to deficit respiratory muscle strength under abnormal bone and muscle structure [1]. AIS also affects the living quality of the patients, disability on work hours and activity level. Perception of limitation due to the disease might increase the chance for depression [2]. Recent researches suggest that AIS may be a cause of other mental illnesses such as eating disorders [3].

The etiopathology of AIS is still unknown and there are clinical and scientific studies to investigate the cause from different aspects. Poor postural balance is one of the earliest characteristics recognized and being studied in patients with AIS [3–5]. Experiments demonstrated that the development of AIS is related to the impaired vestibular system [6,7]. Lambert et al. [8] demonstrated a possible relationship between the vestibular system and scoliosis in frog models by removing the labyrinthine end organs at their larval stages. Characteristics similar to scoliosis such as spinal deformation appeared after their metamorphosis. Therefore, the morphometric analysis of the VS is of utmost importance to understand AIS.

There has been a lot of work on shape analysis for anatomical surfaces. In order to perform shape analysis effectively, surface registration is necessary. Surface registration has been extensively studied. For genus 0 closed surface registration, conformal surface registration, which minimizes angular distortion and preserves the local geometry well, has been widely used [9–13]. Hurdal and Stephenson [12] proposed to compute the conformal parameterizations using circle packing and applied it to registration of human brains. Gu et al. [10] and Wang et al. [13] proposed to compute the conformal parameterizations of human brain surfaces for registration using harmonic energy minimization and holomorphic 1-forms. Quasi-conformal mapping, as a generalization of conformal map, has been applied to obtain surface registration [14–16]. For example, Lui et al. [15] proposed to compute quasi-conformal registrations between hippocampal surfaces based on the holomorphic Beltrami flow method, which matches geometric quantities (such as curvatures) and minimizes the conformality distortion [14].

In many situations, shape information such as curvature or intensity are important. Several registration algorithms have been proposed to incorporate these information into the registration models. Lyttelton et al. [17] computed surface registrations with surface curvature matching. Fischl et al. [9] proposed an algorithm for brain registration that better aligns cortical folding patterns, by minimizing the mean squared difference between the convexity of the surface and the average convexity across a set of subjects. Lord et al. [18] proposed to match surfaces by minimizing the deviation of the registration from isometry. Yeo et al. [19] proposed the spherical demons method, which adopted the diffeomorphic demons algorithm [20], to drive surfaces into correspondence based on the mean curvature and average convexity.

Feature landmarks, such as sulcal landmarks on the human brains, provide important human knowledge. Landmark-matching registration algorithms are proposed to take these informations into account. Bookstein [21] proposed to obtain a landmark-matching registration using a thin-plate spline regularization (or biharmonic regularization). Tosun et al. [22] proposed to combine iterative closest point registration, parametric relaxation and inverse stereographic projection to align cortical sulci across brain surfaces. These diffeomorphisms obtained can better match landmark features, although not perfectly. Wang et al. [23] and Lui et al. [24] proposed to compute the optimized conformal parameterizations of brain surfaces by minimizing a compounded energy. Lui et al. [25] proposed the use of vector fields to represent surface maps and reconstruct them through integral flow equations. Additionally, time dependent vector fields can be used to represent the set of all surface maps. Joshi and Miller [26] proposed the generation of large deformation diffeomorphisms for landmark matching, where the registrations are generated as solutions to the transport equation of time dependent vector fields.

Most of the existing algorithms for surface registration and shape analysis can only deal with simply-connected open or closed surfaces. Analyzing high-genus surfaces is generally challenging because of their complicated topologies. Recently, some works have been carried out to register and analyze high-genus surfaces. Zeng et al. [27] proposed to measure the geodesic spectra on VS surfaces using the Ricci flow. Length and thickness of each canal were measured and the difference between two groups of subjects was shown statistically significant. Partition approaches have also been proposed to analyze and register VS surfaces by partitioning them into simple open surface patches [28]. However, partition approaches greatly rely on the consistency of surface cuts, which are usually difficult to obtain. Geometric registration of high-genus surfaces that matches the surface curvatures has been proposed in [29]. Surface registration is obtained by minimizing the curvature mismatching energy, Since the energy is non-convex, the obtained registration can possibly be the local minimizer. Thus, this algorithm can give good registration results only if two surfaces have similar curvature distributions.

@&#BACKGROUND@&#

In this section, we describe some basic mathematical theories closely related to our work.

Every Riemann surface of genus g
                        >1 is conformally equivalent to a Riemannian metric, called the uniformization metric or the hyperbolic metric, whose induced Gaussian curvature is equal to −1.

The high-genus surface S can be conformally embedded into the Poincaré disk 
                           
                              
                                 ℍ
                              
                           
                           ⊂
                           
                              
                                 
                                    ℝ
                                 
                              
                              2
                           
                        . The Poincaré disk is a unit disk equipped with the hyperbolic metric:
                           
                              (1)
                              
                                 
                                    ds
                                    2
                                 
                                 =
                                 
                                    
                                       
                                          dx
                                          2
                                       
                                       +
                                       
                                          dy
                                          2
                                       
                                    
                                    
                                       
                                          
                                             (
                                             1
                                             −
                                             
                                                x
                                                2
                                             
                                             −
                                             
                                                y
                                                2
                                             
                                             )
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        
                     

In fact, S can be sliced open along the canonical homotopic basis {a
                        1, b
                        1,…, a
                        
                           g
                        , b
                        
                           g
                        } of the fundamental domain π(S, p) at a point p
                        ∈
                        S, for which any two loops of the basis intersect only at p (see Fig. 2
                        (A)). Slicing along the basis, we get a simply-connected open surface S
                        
                           cut
                        . The boundary of S
                        
                           cut
                         is given by 
                           
                              a
                              1
                           
                           
                              b
                              1
                           
                           
                              a
                              1
                              
                                 −
                                 1
                              
                           
                           
                              b
                              1
                              
                                 −
                                 1
                              
                           
                           ⋯
                           
                              a
                              g
                           
                           
                              b
                              g
                           
                           
                              a
                              g
                              
                                 −
                                 1
                              
                           
                           
                              b
                              g
                              
                                 −
                                 1
                              
                           
                        . S
                        
                           cut
                         can then be conformally parameterized 1-1 and onto a domain 
                           
                              
                                 D
                                 ˜
                              
                              i
                           
                           ⊂
                           
                              
                                 ℍ
                              
                           
                        , which is called a fundamental polygon (see Fig. 2(B)). Denote the parameterization by 
                           
                              π
                              ˜
                           
                           :
                           
                              S
                              cut
                           
                           →
                           
                              
                                 D
                                 ˜
                              
                              i
                           
                        . The edges of 
                           
                              
                                 D
                                 ˜
                              
                              i
                           
                         satisfy the periodic boundary conditions. More specifically, there exist Möbius transformations {φ
                        1, ϕ
                        1, ⋯, φ
                        
                           g
                        , ϕ
                        
                           g
                        } (called the Fuchsian group generators) such that:


                        
                           
                              (2)
                              
                                 
                                    φ
                                    i
                                 
                                 (
                                 
                                    π
                                    ˜
                                 
                                 (
                                 
                                    a
                                    i
                                 
                                 )
                                 )
                                 =
                                 
                                    π
                                    ˜
                                 
                                 (
                                 
                                    a
                                    i
                                    
                                       −
                                       1
                                    
                                 
                                 )
                                 ;
                                 
                                 
                                    ϕ
                                    i
                                 
                                 (
                                 
                                    π
                                    ˜
                                 
                                 (
                                 
                                    b
                                    i
                                 
                                 )
                                 )
                                 =
                                 
                                    π
                                    ˜
                                 
                                 (
                                 
                                    b
                                    i
                                    
                                       −
                                       1
                                    
                                 
                                 )
                              
                           
                        
                     

By gluing infinitely many copies of 
                           
                              
                                 D
                                 ˜
                              
                              i
                           
                         together along its boundaries, we get the Poincaré disk 
                           
                              ℍ
                           
                        . 
                           
                              π
                              ˜
                           
                         is extended to a surjective map 
                           
                              π
                              ˜
                           
                           :
                           
                              
                                 ℍ
                              
                           
                           →
                           S
                        , which is called the covering map, satisfying


                        
                           
                              (3)
                              
                                 
                                    
                                       π
                                       ˜
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 S
                                 )
                                 =
                                 
                                    ⋃
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                    
                                       D
                                       ˜
                                    
                                    i
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 D
                                 ˜
                              
                              i
                           
                         and 
                           
                              
                                 D
                                 ˜
                              
                              j
                           
                         intersects only at the edges of the fundamental polygon (see Fig. 2(C)).

Let Ω1 and Ω2 be 2D domains. Every diffeomorphism f
                        :Ω1
                        →Ω2 is associated to a unique Beltrami coefficient (BC), which measures the conformality distortion of the f
                        :=
                        u
                        +
                        iv. Here, we consider f as a complex-valued function on Ω1. The BC, 
                           μ
                           :
                           
                              Ω
                              1
                           
                           →
                           
                              
                                 ℂ
                              
                           
                         can be computed by the following equation:


                        
                           
                              (4)
                              
                                 μ
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                f
                                             
                                             
                                                ∂
                                                x
                                             
                                          
                                          +
                                          i
                                          
                                             
                                                ∂
                                                f
                                             
                                             
                                                ∂
                                                y
                                             
                                          
                                       
                                    
                                 
                                 /
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                f
                                             
                                             
                                                ∂
                                                x
                                             
                                          
                                          −
                                          i
                                          
                                             
                                                ∂
                                                f
                                             
                                             
                                                ∂
                                                y
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Given a smooth BC 
                           μ
                           :
                           
                              
                                 ℂ
                              
                           
                           →
                           
                              
                                 ℂ
                              
                           
                         with ∥μ
                        ∥
                        ∞
                        <1. There is always a diffeomorphism of 
                           
                              ℂ
                           
                         that satisfies the Eq. (4) 
                        [30]. However, suppose Ω1 and Ω2 are arbitrary domains and extra constraints (such as landmark constraints) are enforced. Then, an arbitrary BC 
                           μ
                           :
                           
                              Ω
                              1
                           
                           →
                           
                              
                                 ℂ
                              
                           
                         may not be associated to a diffeomorphism f
                        :Ω1
                        →Ω2 subject to the extra constraints. In this case, a BC is called admissible if it is associated to a quasi-conformal map subject to the given constraints.

In this work, we use BCs to control the bijectivity of the mappings [31].

In this section, we describe the proposed landmark constrained surface registration algorithm for high-genus surfaces in details.

@&#MOTIVATION@&#

Suppose S
                        1 and S
                        2 are two genus-3 VS surfaces. Let 
                           
                              
                                 {
                                 
                                    p
                                    i
                                 
                                 ∈
                                 
                                    S
                                    1
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              n
                           
                         and 
                           
                              
                                 {
                                 
                                    q
                                    i
                                 
                                 ∈
                                 
                                    S
                                    2
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              n
                           
                         be the corresponding feature landmarks on S
                        1 and S
                        2 respectively. Note that the feature landmarks can either be landmark points or curves. Our objective is to look for a smooth diffeomorphism f
                        :
                        S
                        1
                        →
                        S
                        2 that matches the corresponding feature landmarks consistently. That is, f(p
                        
                           i
                        )=
                        q
                        
                           i
                         for i
                        =1, 2, …, n. Although various surface registration algorithms have been recently proposed, the topology of the high-genus surfaces poses a great challenge toward this goal.

In [29], a variational model has been proposed to obtain geometric registration between high-genus surfaces that matches surface curvatures. The basic idea is to conformally embed each high-genus surface into the Poincaré disk 
                           
                              ℍ
                           
                         in the 2D plane using the Ricci flow method. Registration is then carried out on 
                           
                              ℍ
                           
                         through minimizing an energy functional involving a curvature mismatching term. This algorithm gives good surface registration results if the two surfaces are geometrically similar. The registration result may be inaccurate if the two surfaces have very different curvature distributions. For example, the VS surfaces of a normal subject and a diseased patient have quite different surface curvatures. Curvature may not be a valid information to guide the surface matching. Applying the algorithm in [29] on these surfaces may be susceptible to mis-registration. In this situation, landmark-based registration may be more advantageous, since expert knowledge of feature correspondences can be incorporated into the model. Various landmark-based surface registrations have been recently proposed. However, most of them focus on computing landmark constrained registrations for simply-connected surfaces. This motivates us to look for an effective algorithm to obtain a diffeomorphism between high-genus surfaces that aligns features consistently.

Similar to [29], we first simplify the registration problem by conformally embedding S
                        1 and S
                        2 into 
                           
                              ℍ
                           
                         in 
                           
                              
                                 
                                    ℝ
                                 
                              
                              2
                           
                        . An iterative scheme is then used to look for a landmark-matching diffeomorphism between the conformal parameter domains. The strategy is to iteratively search for an admissible Beltrami coefficient associated to our desired landmark-aligned diffeomorphism. Here, a BC is called admissible if it is associated to a bijective quasi-conformal map subject to the landmark constraints. In [32], the surface Teichüller map (T-Map) was computed through adjusting BCs. The BC is normalized in each iteration to an adjusted BC with a constant norm. However, this algorithm does not suit our purpose for two reasons. Firstly, it works only on simply-connected open or closed surfaces. In our case, genus-3 VS surfaces are considered. Secondly, the algorithm computes surface T-Map, whose conformality distortions are uniform and spread over the whole surface. It is unnatural in medical applications.

Motivated by the above observations, we propose a landmark constrained registration algorithm for high-genus surfaces with a smooth and natural distribution of conformality distortions. The proposed algorithm can compute a diffeomorphism between two high-genus surfaces that matches prescribed corresponding landmarks consistently. The contributions are two-folded:
                           
                              1.
                              First, we propose a landmark-constrained registration algorithm for general high-genus surfaces. This is a novel extension of the curvature-matching registration algorithm proposed in [29]. We stress that VS surfaces of different subjects have quite different curvature distributions, curvature-matching registration may be susceptible to mis-registration. Therefore, a landmark-based registration for high-genus surfaces is necessary.

Second, we propose a modified iterative scheme, which extends the scheme in [32], to search for an admissible BC under landmark constraints with a natural distribution for general high-genus surfaces. The key idea is to find an admissible BC under landmark constraints between the Poincaré disks. This admissible BC gives rise to a bijective and landmark-matching registration between the Poincaré disks. The desired constrained registration between the high-genus surfaces S
                                 1 and S
                                 2 can then be obtained by the composition map with their conformal parameterizations. The resultant registration has a smooth and natural distribution of conformality distortions.

Suppose 
                           
                              S
                              1
                              cut
                           
                         and 
                           
                              S
                              2
                              cut
                           
                         are the fundamental domains, obtained by slicing along the homotopic bases {a
                        1, b
                        1, a
                        2, b
                        2, a
                        3, b
                        3} and {c
                        1, d
                        1, c
                        2, d
                        2, c
                        3, d
                        3} of S
                        1 and S
                        2 respectively. Let 
                           
                              Φ
                              1
                           
                           :
                           
                              S
                              1
                              cut
                           
                           →
                           
                              
                                 D
                                 ˜
                              
                              1
                           
                           ⊂
                           
                              
                                 ℍ
                              
                           
                         and 
                           
                              Φ
                              2
                           
                           :
                           
                              S
                              2
                              cut
                           
                           →
                           
                              
                                 D
                                 ˜
                              
                              2
                           
                           ⊂
                           
                              
                                 ℍ
                              
                           
                         be the conformal parameterization of 
                           
                              S
                              1
                              cut
                           
                         and 
                           
                              S
                              2
                              cut
                           
                         respectively. We apply the Ricci flow method [33] to obtain Φ1 and Φ2 in this work. The idea of Ricci flow is to conformally deform the surface metric g
                        =(g
                        
                           ij
                        (t)) according to its induced Gaussian curvature K(t) to its uniformization metric through the heat flow equation on the metric: 
                           
                              
                                 
                                    dg
                                    ij
                                 
                                 (
                                 t
                                 )
                              
                              dt
                           
                           =
                           −
                           2
                           (
                           K
                           (
                           t
                           )
                           +
                           1
                           )
                           
                              g
                              ij
                           
                           (
                           t
                           )
                        . g(∞) is the desired uniformization metric. From the uniformization metric, the surface can be conformally embedded onto a fundamental polygon in 
                           
                              ℍ
                           
                        .

With the conformal parameterization of S
                        1 and S
                        2, the registration process can be carried out on 
                           
                              ℍ
                           
                        . Our goal is to look for a diffeomorphism 
                           g
                           :
                           
                              
                                 ℍ
                              
                           
                           →
                           
                              
                                 ℍ
                              
                           
                         such that:
                           
                              (1)
                              
                                 Landmark constraints: g(ϕ
                                 1(p
                                 
                                    i
                                 ))=
                                 ϕ
                                 2(q
                                 
                                    i
                                 ) for i
                                 =1, 2, …, n.


                                 Periodic conditions on boundary cuts: 
                                 
                                    
                                       φ
                                       i
                                    
                                    (
                                    g
                                    (
                                    a
                                    
                                       ′
                                       i
                                    
                                    )
                                    )
                                    =
                                    g
                                    (
                                    a
                                    
                                       ′
                                       i
                                       
                                          −
                                          1
                                       
                                    
                                    )
                                    and
                                    
                                       ϕ
                                       i
                                    
                                    (
                                    g
                                    (
                                    b
                                    
                                       ′
                                       i
                                    
                                    )
                                    )
                                    =
                                    g
                                    (
                                    b
                                    
                                       ′
                                       i
                                       
                                          −
                                          1
                                       
                                    
                                    )
                                 ,

where: {a′1, b′1, a′2, b′2, a′3, b′3} are images of the homotopic basis on S
                                 1 in 
                                    
                                       ℍ
                                    
                                 . {φ
                                 1, ϕ
                                 1, φ
                                 2, ϕ
                                 2, φ
                                 3, ϕ
                                 3} are the Fuchsian group generators.

(1) is the landmark constraints which require corresponding feature landmarks to be aligned consistently. For (2), note that our proposed registration process is carried on 
                           
                              ℍ
                           
                        , but not on the fundamental polygons 
                           
                              
                                 D
                                 ˜
                              
                              1
                           
                         and 
                           
                              
                                 D
                                 ˜
                              
                              1
                           
                        , without enforcing the correspondences of the homotopic basis of 
                           
                              S
                              1
                              cut
                           
                         and 
                           
                              S
                              2
                              cut
                           
                        . In other words, a
                        
                           i
                         may not correspond to c
                        
                           i
                         and b
                        
                           i
                         may not correspond to d
                        
                           i
                         for 1≤
                        i
                        ≤3. Therefore, some periodic conditions must be satisfied on 
                           
                              ℍ
                           
                        . More specifically, suppose 
                           
                              Φ
                              1
                              
                                 −
                                 1
                              
                           
                           (
                           
                              S
                              1
                           
                           )
                           =
                           
                              ⋃
                              
                                 i
                                 ∈
                                 I
                              
                           
                           
                              
                                 D
                                 ˜
                              
                              i
                              1
                           
                         and 
                           
                              Φ
                              1
                              
                                 −
                                 1
                              
                           
                           (
                           
                              S
                              2
                           
                           )
                           =
                           
                              ⋃
                              
                                 i
                                 ∈
                                 I
                              
                           
                           
                              
                                 D
                                 ˜
                              
                              i
                              2
                           
                        , we require that g is associated to a mapping f
                        :
                        S
                        1
                        →
                        S
                        2 such that 
                           f
                           =
                           
                              Φ
                              2
                           
                           ∘
                           g
                           ∘
                           
                              Φ
                              1
                           
                           
                              |
                              
                                 
                                    
                                       D
                                       ˜
                                    
                                    i
                                    1
                                 
                              
                              
                                 −
                                 1
                              
                           
                         for any i
                        ∈
                        I. In other words, we require that g can be lifted to a surface map f
                        :
                        S
                        1
                        →
                        S
                        2. (2) ensures the above condition to be satisfied.

We proceed to solve the above constrained problem with an iterative scheme, using the quasi-conformal theory. Since g is a diffeomorphism, its associated BC 
                           
                              μ
                              g
                           
                           :
                           
                              
                                 
                                    ℍ
                                 
                              
                              1
                           
                           →
                           
                              
                                 ℂ
                              
                           
                         must have supreme norm strictly less than 1 (
                           
                              
                                 |
                                 |
                                 
                                    μ
                                    g
                                 
                                 |
                                 |
                              
                              ∞
                           
                           <
                           1
                        ). In fact, the Jacobian J
                        
                           g
                         is closely related to μ
                        
                           g
                        :


                        
                           
                              (5)
                              
                                 
                                    J
                                    g
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   g
                                                
                                                
                                                   ∂
                                                   z
                                                
                                             
                                          
                                       
                                    
                                    2
                                 
                                 (
                                 1
                                 −
                                 
                                    
                                       |
                                       
                                          μ
                                          g
                                       
                                       |
                                    
                                    2
                                 
                                 )
                              
                           
                        
                     

Hence, J
                        
                           g
                        
                        >0 if and only if 
                           
                              
                                 |
                                 |
                                 
                                    μ
                                    g
                                 
                                 |
                                 |
                              
                              ∞
                           
                           <
                           1
                        . By inverse function theorem, g is a diffeomorphism if and only if 
                           
                              
                                 |
                                 |
                                 
                                    μ
                                    g
                                 
                                 |
                                 |
                              
                              ∞
                           
                           <
                           1
                        .

Therefore, to obtain g, our strategy is to iteratively search for a sequence of BCs 
                           
                              
                                 {
                                 
                                    μ
                                    j
                                 
                                 }
                              
                              
                                 j
                                 =
                                 1
                              
                              ∞
                           
                         associated with a sequence of mappings 
                           
                              
                                 {
                                 
                                    g
                                    j
                                 
                                 }
                              
                              
                                 j
                                 =
                                 1
                              
                              ∞
                           
                         such that: μ
                        
                           j
                        
                        →
                        μ
                        
                           g
                         with 
                           
                              
                                 |
                                 |
                                 
                                    μ
                                    g
                                 
                                 |
                                 |
                              
                              ∞
                           
                           <
                           1
                         and g
                        
                           j
                        
                        →
                        g as j→∞. More precisely, iterative scheme can be explained geometrically as follows.


                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             μ
                                             0
                                          
                                       
                                       
                                          ⟶
                                       
                                       
                                          …
                                       
                                       
                                          ⟶
                                       
                                       
                                          
                                             μ
                                             j
                                          
                                       
                                       
                                          ⟶
                                       
                                       
                                          …
                                       
                                       
                                          ⟶
                                       
                                       
                                          
                                             μ
                                             ∞
                                          
                                          =
                                          
                                             μ
                                             g
                                          
                                       
                                    
                                    
                                       
                                          ↕
                                       
                                       
                                       
                                          ↕
                                       
                                       
                                       
                                          ↕
                                       
                                       
                                       
                                          ↕
                                       
                                       
                                       
                                          ↕
                                       
                                    
                                    
                                       
                                          
                                             g
                                             0
                                          
                                       
                                       
                                          ⟶
                                       
                                       
                                          …
                                       
                                       
                                          ⟶
                                       
                                       
                                          
                                             g
                                             j
                                          
                                       
                                       
                                          ⟶
                                       
                                       
                                          …
                                       
                                       
                                          ⟶
                                       
                                       
                                          
                                             g
                                             ∞
                                          
                                          =
                                          g
                                       
                                    
                                    
                                       
                                       
                                       
                                       
                                       
                                       
                                       
                                       
                                       
                                    
                                 
                              
                           
                        
                     

For the initial map 
                           
                              g
                              0
                           
                           :
                           
                              
                                 ℍ
                              
                           
                           →
                           
                              
                                 ℍ
                              
                           
                        , we choose the harmonic map satisfying the landmark constraints and the correspondences of the boundary cuts given by the arc-length parameterization. Note that with the landmark constraints, g
                        0 is unlikely bijective. According to the quasi-conformal theory, a non-bijective g
                        0 is associated with a BC μ
                        0 with supreme norm greater than 1. Our goal is to look for an admissible BC, μ, with ||μ||∞
                        <1, which is associated to a quasi-conformal map between 
                           
                              
                                 
                                    ℍ
                                 
                              
                              1
                           
                         and 
                           
                              
                                 
                                    ℍ
                                 
                              
                              2
                           
                         satisfying the constraints (1) and (2). We proceed to adjust μ
                        0 iteratively to obtain our desired optimal BC. More generally, suppose g
                        
                           n
                         is obtained at the nth iteration, whose BC is given by μ
                        
                           n
                        . Our proposed algorithm can be described as a chop-smooth-reconstruct iterative procedure. We now describe each step in details.

Suppose g
                           
                              n
                            is non-bijective. Then, ||μ
                           
                              n
                           ||>1. We proceed to project μ
                           
                              n
                            to a BC with supreme norm strictly less than 1. This can be done by chopping down the norm of μ
                           
                              n
                           . The chopping is to eliminate the overlaps of g
                           
                              n
                           , since |μ
                           
                              n
                           |>1 indicates the occurrence of flips. More specifically, the chopping operation is defined as follows:


                           
                              
                                 (7)
                                 
                                    
                                       
                                          μ
                                          ˜
                                       
                                       n
                                    
                                    =
                                    
                                       
                                          
                                             
                                                (
                                                1
                                                −
                                                ϵ
                                                )
                                                
                                                   
                                                      
                                                         μ
                                                         n
                                                      
                                                   
                                                   
                                                      |
                                                      
                                                         μ
                                                         n
                                                      
                                                      |
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                |
                                                
                                                   μ
                                                   n
                                                
                                                |
                                                ≥
                                                1
                                                −
                                                ϵ
                                             
                                          
                                          
                                             
                                                
                                                   μ
                                                   n
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                |
                                                
                                                   μ
                                                   n
                                                
                                                |
                                                <
                                                1
                                                −
                                                ϵ
                                             
                                          
                                       
                                    
                                 
                              
                           where ϵ
                           >0 is small.

Here, we remark that the chopping of BC was also applied in [29] to control the bijectivity of the mapping. However, note that there is no landmark constraint enforced in [29]. Hence, an admissible BC associated to a bijective map can be easily obtained by solving the Beltrami equation. In our case, landmark constraints are enforced and the challenge is to search for an admissible BC associated to a bijective map satisfying the landmark constraints consistently. Hence, in this work, we need to iteratively search for an admissible BC associated to a landmark-matching diffeomorphism.

A smooth mapping is associated with a smooth BC. In order to obtain a smooth registration, we proceed to smooth out 
                              
                                 
                                    μ
                                    ˜
                                 
                                 n
                              
                           . This can be done by a Laplace smoothing on 
                              
                                 
                                    μ
                                    ˜
                                 
                                 n
                              
                           :
                              
                                 (8)
                                 
                                    μ
                                    
                                       ′
                                       n
                                    
                                    (
                                    
                                       v
                                       i
                                    
                                    )
                                    =
                                    
                                       1
                                       
                                          
                                             N
                                             i
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          
                                             v
                                             j
                                          
                                          ∈
                                          
                                             N
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             μ
                                             ˜
                                          
                                          n
                                       
                                       (
                                       
                                          v
                                          j
                                       
                                       )
                                    
                                 
                              
                           where N
                           
                              i
                            is the one-ring neighborhood of vertex 
                              
                                 v
                                 i
                              
                           . This simple smoothing operation allows us to further reduce the norm of BC (and thus reduce the conformality distortions). It also helps to obtain a smooth and naturally distributed BC, and hence the resultant registration has a smooth and natural distribution of conformality distortions.

After the adjusted BC μ′
                              n
                            is obtained, we need to find an associated map 
                              
                                 g
                                 
                                    n
                                    +
                                    1
                                 
                              
                              :
                              
                                 
                                    ℍ
                                 
                              
                              →
                              
                                 
                                    ℍ
                                 
                              
                            satisfying the landmark constraints (1) and periodic conditions (2) on the boundary cuts. Note that μ′
                              n
                            may not be admissible. In other words, subject to the landmark constraints, there may not exist a quasi-conformal map whose BC is exactly equal to μ′
                              n
                           . We proceed to look for a map g
                           
                              n+1 whose BC is as close to μ′
                              n
                            as possible.

As in [31], the reconstruction of the quasi-conformal map from an admissible BC (without landmark constraints) can be reduced to solving an elliptic PDE. Also, in our case, the reconstructed map g
                           
                              n+1 from 
                              
                                 ℍ
                              
                            to itself can be lifted to a surface map f
                           
                              n+1
                           :
                           S
                           1
                           →
                           S
                           2. Hence, the periodic condition (2) on the boundary cuts of the fundamental polygon must be satisfied. Following [29], the elliptic PDE subject to the periodic condition (2) can be reduced to the following non-linear equation in the discrete case:


                           
                              
                                 (9)
                                 
                                    A
                                    
                                       
                                          z
                                          ˜
                                       
                                    
                                    +
                                    Q
                                    (
                                    
                                       
                                          z
                                          ˜
                                       
                                    
                                    )
                                    =
                                    b
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       z
                                       ˜
                                    
                                 
                                 i
                              
                              =
                              
                                 g
                                 
                                    n
                                    +
                                    1
                                 
                              
                              (
                              
                                 v
                                 i
                              
                              )
                            (
                              
                                 v
                                 i
                              
                              ∈
                              
                                 
                                    ℍ
                                 
                              
                           ), 
                              A
                              =
                              (
                              
                                 w
                                 ij
                              
                              )
                            is the matrix representation discretizing the differential operator ∇·(D ∇), and Q(i, j) is the Mobiüs transformation that transforms outside vertex 
                              
                                 
                                    v
                                    ˜
                                 
                                 j
                              
                            of fundamental polygon to its inside copy 
                              
                                 v
                                 j
                              
                            in the fundamental polygon, and is zero elsewhere, multiplied by 
                              
                                 w
                                 ij
                              
                           .

In our work, landmark constraints (1) are also enforced. In other words, the following constraints should be added to the nonlinear Eq. (9):


                           
                              
                                 (10)
                                 
                                    
                                       
                                          
                                             z
                                             ˜
                                          
                                       
                                       j
                                    
                                    :
                                    =
                                    
                                       g
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    (
                                    
                                       p
                                       j
                                    
                                    )
                                    =
                                    
                                       q
                                       j
                                    
                                 
                              
                           for 1≤
                           j
                           ≤
                           n, where 
                              
                                 
                                    {
                                    
                                       p
                                       j
                                    
                                    }
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 n
                              
                            and 
                              
                                 
                                    {
                                    
                                       q
                                       j
                                    
                                    }
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 n
                              
                            are the corresponding landmark constraints.

We apply the Newton's method to solve the simultaneous Eqs. (9) and (10). We call such process the landmark constrained hyperbolic Beltrami solver, and denote it by HBS
                           
                              LM
                           .

The reconstruction of map using HBS
                           
                              LM
                            ensures the constraints (1) and (2) are both satisfied in each iteration. The BC is iteratively chopped down to an optimal BC with supreme norm strictly less than 1, which is associated to a bijective and landmark-matching quasi-conformal map.

In short, motivated by [29], we develop an efficient algorithm to compute constrained diffeomorphic registration for high-genus surfaces with a smooth and natural distribution of conformality distortion. This proposed iterative algorithm is a gradient descent based algorithm. It essentially minimizes the harmonic energy of the Beltrami coefficient iteratively over the space of admissible Beltrami coefficient. The algorithm stops when the change of Beltrami coefficients are small enough, which converges to an optimal solution.

The algorithm can be summarized as follows.


                           Algorithm 1:
                        


                           Input: 
                           universal covering space U
                           1 
                           and U
                           2
                           , landmark constraints 
                           
                              
                                 
                                    {
                                    
                                       p
                                       i
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 n
                              
                              ↔
                              
                                 
                                    {
                                    
                                       q
                                       i
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 n
                              
                           
                        


                           Output: 
                           hyperbolic quasi-conformal map f
                           :
                           U
                           1
                           →
                           U
                           2
                           , s.t. f(p
                           
                              i
                           )=
                           q
                           
                              i
                           
                           , i
                           =1, .., n
                           
                              
                                 1.
                                 
                                    Compute initial map f
                                    0 
                                    and Beltrami coefficients μ
                                    0
                                    =
                                    μ(f
                                    0), n
                                    =0;
                                 


                                    Chop and smooth μ
                                    
                                       n
                                     
                                    by Eqs. 
                                    
                                       (7) and (8)
                                     
                                    to obtain 
                                    
                                       
                                          
                                             μ
                                             ˜
                                          
                                          n
                                       
                                    
                                    ;
                                 


                                    Reconstruct f
                                    
                                       n+1 
                                    from 
                                    
                                       
                                          
                                             μ
                                             ˜
                                          
                                          n
                                       
                                     
                                    via HBS: 
                                    
                                       
                                          f
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                       =
                                       
                                          HBS
                                          LM
                                       
                                       (
                                       
                                          
                                             μ
                                             ˜
                                          
                                          n
                                       
                                       )
                                    
                                    ;
                                 


                                    Compute Beltrami coefficients μ
                                    
                                       n+1
                                    =
                                    μ(f
                                    
                                       n+1);
                                 


                                    If 
                                    
                                       
                                          
                                             ∥
                                             
                                                μ
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                             −
                                             
                                                μ
                                                n
                                             
                                             ∥
                                          
                                          ∞
                                       
                                       <
                                       ϵ
                                    
                                    , stop the process, obtain the map f
                                    =
                                    f
                                    
                                       n+1
                                    . Otherwise n
                                    =
                                    n
                                    +1, go to step 2;
                                 

With the registrations of the VS surfaces, corresponding geometric features can be extracted to analyze the shape differences. A complete shape index can also be defined, which can be used to perform the local shape analysis of the VS surfaces. In this section, we will describe our proposed shape analysis models in details.

In this work, we propose to extract two geometric features for shape analysis. They are: (1) homotopic loops [34] and (2) minimal surfaces. These features can be used to understand the geometric patterns of the VS surfaces.

With the registration, we can compute the mean shape of the VS surfaces. Denote the genus-3 VS mean surface by S
                        
                           mean
                        . A homotopic basis based at a point p on the surface can be extracted. By cutting along the homotopic basis, S
                        
                           mean
                         becomes a simply-connected open surface. S
                        
                           mean
                         can be embedded into its universal covering using Ricci flow. On the universal covering space, we can easily find a canonical homotopic basis {a
                        1, b
                        1, a
                        2, b
                        2, a
                        3, b
                        3}, which intersects only at the base point p and are all hyperbolic geodesic. For each point q on the curve a
                        
                           i
                         (i
                        =1, 2 or 3), we can find a geodesic closed loop c
                        
                           q
                        
                        :[0, 1]→
                        S
                        1 such that c
                        
                           q
                        (0)=
                        c
                        
                           q
                        (1)=
                        q. The geodesic loop c
                        
                           q
                        (t) solves the following minimization problem:


                        
                           
                              (11)
                              
                                 
                                    c
                                    1
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       
                                          argmin
                                       
                                    
                                    
                                       γ
                                       (
                                       t
                                       )
                                    
                                 
                                 
                                    ∫
                                    0
                                    1
                                 
                                 
                                    
                                       
                                          g
                                          
                                             γ
                                             (
                                             t
                                             )
                                          
                                       
                                       (
                                       γ
                                       ′
                                       (
                                       t
                                       )
                                       ,
                                       γ
                                       ′
                                       (
                                       t
                                       )
                                       )
                                    
                                 
                                 dt
                              
                           
                        all closed loop γ(t) satisfying γ(0)=
                        γ(1)=
                        q. The collection of all loops c
                        
                           q
                        (t) situated at q on a
                        
                           i
                         (i
                        =1, 2 or 3) are called the homotopic loops. These homotopic loops belongs to the equivalence class [a
                        
                           i
                        ] of the homotopic group.

Using the obtained registration between the mean surface and any VS surface, corresponding homotopic loops can be delineated on each VS surface. Let S be any VS surface. Suppose f
                        :
                        S
                        
                           mean
                        
                        →
                        S is the registration between S
                        
                           mean
                         and S. The corresponding homotopic loops on S can be easily obtained by 
                           
                              c
                              q
                              S
                           
                           :
                           =
                           f
                           ∘
                           
                              c
                              q
                           
                           :
                           [
                           0
                           ,
                           1
                           ]
                           →
                           S
                        . These homotopic loops can be used to study the local geometry and thickness at each positions of the VS surface.

From the homotopic loops, the centerlines can be extracted. Let 
                           
                              
                                 {
                                 
                                    c
                                    q
                                    S
                                 
                                 }
                              
                              
                                 q
                                 ∈
                                 
                                    a
                                    i
                                 
                              
                           
                         be the collection of all homotopic loops on one canal of the VS surface S. For each homotopic loop, we can compute its centroid. By joining all the centroids, we can obtain a curve lying in the interior of one canal of S. This curve is called the centerline. Using the centerline, bendings of the canals can be examined. Each canals of the VS surface can roughly be fitted to a plane. And the three planes are roughly orthogonal to each others. To study AIS, it is commonly of interest to examine how each canals are deviated from a plane. Let 
                           
                              
                                 c
                                 →
                              
                           
                           =
                           
                              
                                 c
                                 →
                              
                           
                           (
                           t
                           )
                         be parametric equation of the centerline. We can find a best fit plane 
                           P
                           :
                           
                              
                                 
                                    
                                       n
                                    
                                 
                                 →
                              
                           
                           ·
                           (
                           x
                           ,
                           y
                           ,
                           z
                           )
                           =
                           λ
                         to the centerline by minimizing:


                        
                           
                              (12)
                              
                                 E
                                 (
                                 
                                    
                                       
                                          
                                             n
                                          
                                       
                                       →
                                    
                                 
                                 ,
                                 λ
                                 ,
                                 
                                    
                                       c
                                       →
                                    
                                 
                                 )
                                 =
                                 
                                    ∫
                                    0
                                    1
                                 
                                 D
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   n
                                                
                                             
                                             →
                                          
                                       
                                       ,
                                       λ
                                       ,
                                       
                                          
                                             c
                                             →
                                          
                                       
                                       (
                                       t
                                       )
                                       )
                                    
                                    2
                                 
                                 dt
                                 ,
                              
                           
                        where 
                           D
                           (
                           
                              
                                 
                                    
                                       n
                                    
                                 
                                 →
                              
                           
                           ,
                           λ
                           ,
                           
                              
                                 c
                                 →
                              
                           
                           (
                           t
                           )
                           )
                         is the distance of the point 
                           
                              
                                 c
                                 →
                              
                           
                           (
                           t
                           )
                         from the plane 
                           P
                           :
                           
                              
                                 
                                    
                                       n
                                    
                                 
                                 →
                              
                           
                           ·
                           (
                           x
                           ,
                           y
                           ,
                           z
                           )
                           =
                           λ
                        . The distance 
                           D
                           (
                           
                              
                                 
                                    
                                       
                                          n
                                       
                                    
                                    →
                                 
                              
                              *
                           
                           ,
                           
                              λ
                              *
                           
                           ,
                           
                              
                                 c
                                 →
                              
                           
                           (
                           t
                           )
                           )
                         of the point 
                           
                              
                                 c
                                 →
                              
                           
                           (
                           t
                           )
                         from the best fit plane can be used to measure the deviation of the canal from a plane at each point of the centerline.

Once the homotopic loops on each canals of the VS is extracted, we can compute the minimal surfaces enclosed by each homotopic loops. With the minimal surfaces, cross-sectional area at each position of the canals can be evaluated. Minimal surfaces are defined as surfaces which are critical points for the area functional. Suppose the homotopic loop l is projected orthogonally to a convex curve enclosing a domain D in a plane. The minimal surface is a graph of a function: z
                        =
                        u(x, y), where x and y are the coordinates on the plane (see Fig. 3
                        (A)). Suppose the homotopic loop is given by l
                        =
                        l(x, y) for (x, y)∈∂D. The function u(x, y) of the minimal surface satisfies the following Euler–Lagrange equation:


                        
                           
                              (13)
                              
                                 ∇
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                ∇
                                                u
                                             
                                             
                                                
                                                   
                                                      1
                                                      +
                                                      
                                                         
                                                            |
                                                            ∇
                                                            u
                                                            |
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                        subject to the constraint that: u|∂D
                        (x, y)=
                        l(x, y). In this work, the minimal surface is computed by solving Eq. (13) using the finite element method. Fig. 3(B) shows the minimal surfaces enclosed by the homotopic loops of a standard 3-torus.

It is often necessary to study the local shape differences between VS surfaces. For this purpose, a shape index defined on each vertex of the surface mesh, which quantifies the local shape difference at each position of the surface, is needed. In this work, we use a complete shape index based on the Beltrami coefficients and the surface curvatures. Given two VS surfaces S
                        1 and S
                        2. Suppose f
                        :
                        S
                        1
                        →
                        S
                        2 be the registration between S
                        1 and S
                        2, as obtained in the last section. The complete shape index is defined as follows.


                        
                           
                              (14)
                              
                                 
                                    E
                                    shape
                                 
                                 (
                                 f
                                 )
                                 =
                                 α
                                 
                                    
                                       |
                                       μ
                                       |
                                    
                                    2
                                 
                                 +
                                 β
                                 
                                    
                                       (
                                       
                                          H
                                          1
                                       
                                       −
                                       
                                          H
                                          2
                                       
                                       (
                                       f
                                       )
                                       )
                                    
                                    2
                                 
                                 +
                                 γ
                                 
                                    
                                       (
                                       
                                          K
                                          1
                                       
                                       −
                                       
                                          K
                                          2
                                       
                                       (
                                       f
                                       )
                                       )
                                    
                                    2
                                 
                              
                           
                        where μ is the Beltrami coefficients of f; H
                        1, H
                        2 are the mean curvatures on S
                        1 and S
                        2 respectively; and K
                        1, K
                        2 are the Gaussian curvatures on S
                        1 and S
                        2 respectively. Thus, 
                           
                              E
                              shape
                           
                           :
                           
                              S
                              1
                           
                           →
                           
                              
                                 ℝ
                              
                           
                         is a non-negative real-valued function defined on S
                        1.

The first term measures the conformality distortion of the surface registration. The second and third terms measure the curvature differences. It turns out E
                        
                           shape
                         is a complete shape index measuring subtle shape differences between two VS surfaces. More precisely, E
                        
                           shape
                        (f)=0 if and only if two shapes are identical up to a rigid motion. By adjusting the parameters (i.e., α, β and γ), E
                        
                           shape
                         can be made equivalent to other existing shape indices. For example, when β
                        =0, E
                        
                           shape
                         is equivalent to the isometric shape index; when α
                        =0, E
                        
                           shape
                         is equivalent to the curvature index; when β
                        =
                        γ
                        =0, E
                        
                           shape
                         measures the conformality distortion. In our work, we set α, β and γ to be nonzero to measure complete shape changes.

After the registration is obtained, a vertex-wise statistical morphometric analysis can be carried out. The vertex-wise morphometric deviation can be investigated using a two-sample Hotelling's T-squared test. Before the analysis, the registered surfaces are rigidly aligned using the iterative closest point algorithm. The test then measures the position (coordinates) difference of two corresponding points of the VS surfaces of the AIS group and the normal control (NC) group. A significant level of 0.001 will be used in this work.

@&#EXPERIMENTAL RESULTS@&#

To test the efficacy of the proposed algorithms, experiments have been carried out on 27 VS surfaces from the normal and AIS groups.


                     Subject and Imaging Protocol:
                  

In this research, 27 left-side vestibular system samples were studied. The samples were from two groups of volunteers, the AIS group and the NC group. The AIS group consists of 12 girls suffering from right-thoracic AIS while there are 15 age-matched healthy girls in the NC group. MRI scanning is performed for obtaining T2 weighted images of the inner ears of the volunteers using a 1.5T MR Scanner (Sonata, Siemens, Erlangen, Germany) with a quadrature head coil. The imaging protocol is a 3D constructive interference steady state (CISS) sequence and with parameters including, TR = 11.94ms, TE = 5.97ms, flip angle = 70°, FOV = 130mm, slice thickness s= 1mm, no gap, matrix = 320×288 and number of excitation = 1. High quality images are obtained with the voxel size of 0.5×0.4×1.0mm3. The resultant voxel size is adjusted to 0.2×0.2×1.0mm3 after an on-site image interpolation.

On each VS surfaces, 8 feature landmarks are located. The landmarks are selected as follows: (i) 4 landmarks are chosen to be the saddle points located at the intersections of the three canals; (ii) 3 points on each canals which are geodesic mid-points of the landmarks in (i); and (iii) 1 landmark is selected to be center near the utricle. These 8 landmarks are consistent amongst different subjects. Fig. 4
                         shows the eight feature landmarks on one VS surface visualized at two different angles.


                        Fig. 5
                        (A) and (B) shows the canonical fundamental polygons of two VS surfaces of a normal and AIS subjects respectively. The canonical cuts are shown on each surfaces. By slicing along the cuts, we can embed the surface onto a fundamental polygon. The fundamental polygons of different periods can be glued together to form the universal covering space. Note that the canonical cuts are introduced to obtain the conformal embedding of the surface into its universal covering space only. During the registration process, the canonical cuts on the source surface are allowed to move freely on the target surface, since the whole process is carried out on the universal covering spaces. In other words, the correspondences between canonical cuts are not required.


                        Fig. 6
                         shows the universal covering spaces of two VS surfaces of a normal (left) and an AIS subject (middle). The positions of the corresponding landmarks on the parameter domains are shown. Using the proposed registration algorithm, we compute the constrained diffeomorphism between the parameter domains that matches corresponding landmarks. In Fig. 6, the right shows the registration result, which matches the landmarks consistently. Note that the boundary cuts on the source parameter domain are allowed to move freely on the target parameter domain, while satisfying the periodic conditions.

Through the composition map of the diffeomorphism with the conformal parameterizations, the registration between the VS surfaces can be obtained. Fig. 7
                         shows the surface registration result of the first pair of VS surfaces (corresponding to Fig. 6) visualized by the colormap. The colormap on the left (normal) VS surface is mapped to the right (AIS) surfaces using the obtained registration. Note that corresponding regions of the two surfaces are consistently matched. To better visualize the accuracy of the registration, feature loops are plotted on the source surface and are mapped to the target surfaces using the registration. Note that the feature loops are matched to corresponding locations on the target surfaces.


                        Fig. 8
                         shows a pair of VS surfaces of normal subjects. The surface registration results are shown. Again, the registration is visualized using the colormap. The colormap on the source surfaces are mapped to the target surfaces. The feature loops on the source surfaces are also mapped to the target surfaces. From the correspondences of the colormap and feature loops, we observe that corresponding regions of the VS surfaces are consistently matched. It again demonstrates the accuracy of our registration results.

Using the proposed registration algorithm, we compute the surface registrations between all pairs of VS surfaces. With the computed registrations, we compute the mean surface of all VS surfaces of the normal group. The mean surface is computed by taking the mean of their corresponding coordinates. The mean surface is shown in Fig. 9
                        (A). Similarly, we compute the mean surface of all VS surfaces of the AIS group, which is shown in Fig. 9(B). Note that the mean surfaces preserve the structures of the VS surface well. It means that our obtained registrations are accurate. The registration between the two mean surfaces is visualized by colormap. The colormap on the mean VS surface of the normal subjects is mapped to the VS mean surface of the AIS subject. Note that the corresponding regions are matched consistently. This demonstrates our proposed algorithm is able to obtain surface registration between the VS surfaces with accurate one-to-one point-wise correspondences.

The computational details for the surface registration between some pairs of the VS surfaces are recorded in Table 1
                        . We compute the surface registrations between a source surface (VS surface of the normal subject N01) to different target VS surfaces. The computational times are shown in the second column, which are all less than 30s. It illustrates that our proposed algorithm is quite efficient. The second column shows the number of overlapping faces of the obtained registrations. Note that the number of overlapping faces are 0 in all cases. It demonstrates our obtained surface registrations are all bijective. The third and forth column show the number of vertices for each target VS surfaces and the iterations needed for the registration process. Depending on the geometry of the surfaces, our algorithm generally converges in about 50 iterations on average.

Our registration algorithm is a gradient descent based algorithm. Algorithm stops when the change of Beltrami coefficients are small enough. In all our cases, it always converges, an optimal solution of the local minimizer of the energy obtained.

With the obtained registration, various geometric features can be extracted on VS surfaces. These geometric features can be used for the shape analysis and shape comparison of the VS surfaces.

We first compute the homotopic loops of the normal mean VS surface, which are shown in Fig. 10
                        (A). From the surface registration, we can map the homotopic loops to the corresponding locations on other VS surfaces. Corresponding homotopic loops on every VS surfaces can then be obtained. Fig. 10(B) shows the corresponding homotopic loops on the AIS mean VS surface. By joining the centroids of the homotopic loops, the three centerlines of the AIS mean VS surface can be extracted.

From the homotopic loops, minimal surfaces can be extracted. Fig. 11
                        (A) shows the minimal surfaces of the normal mean VS surface. Fig. 11(B) shows the minimal surfaces of the AIS mean surface.

From the geometric features, shape analysis of the VS surfaces can be carried out for the purpose of disease analysis. In this work, we compare the shape difference between the VS surfaces of the normal and AIS groups.

We test the idea to compare the mean surfaces of the normal VS and the AIS VS. Fig. 12
                        (A) shows the perimeters of each homotopic loops of the normal mean VS and the AIS mean VS. Loops 1–25 are the homotopic loops on the anterior semi-circular canal (SSC). Loops 26–43 are the homotopic loops on the horizontal semi-circular canal (LSC). Loops 44–74 are the homotopic loops on the posterior semi-circular canal (PSC). The blue curve shows the perimeters of the homotopic loops of the normal mean VS. The red curve shows the perimeters of the homotopic loops of the AIS mean VS. Note that the differences in perimeter between the normal mean VS and the AIS mean VS at the SSC and LSC are insignificant. However, the difference in perimeter between the normal mean VS and the AIS mean VS is quite obvious at the PSC.

We have also computed the surface area of each minimal surfaces. Fig. 12(B) shows the area of each minimal surfaces enclosed by the homotopic loops of the normal mean VS and the AIS mean VS. Again, the blue curve shows the area of the minimal surfaces of the normal mean VS. The red curve shows the area of the minimal surfaces of the AIS mean VS. Notice that the difference in area between the normal mean VS and the AIS mean VS is quite obvious at the PSC. It again demonstrate the shape difference between the normal and AIS VS surfaces at the PSC.

Using the centerlines, we can also measure the deviation of each canals of the VS from the best fit plane. Fig. 13
                         shows the distances of each points on the centerlines from the best fit planes of the normal mean VS surface (left) and AIS mean VS surface (right). The distances are visualized by the colormaps. Red color indicates a large deviation from the best fit plane. As shown in the figure, it was found that the PSC of AIS mean VS surface is more distorted and deviated from the best fit plane.

For a more comprehensive local shape analysis, we use a complete shape index based on the Beltrami coefficients and curvatures to capture the local geometric difference between the VS surfaces. After the surface registration between two VS surfaces is obtained, the complete shape index that gives a value for each vertex can be computed. The value measures the degree of geometric difference. Fig. 14
                         shows the VS surfaces of two normal subjects. The shape index is shown as colormap, plotted on each VS surfaces. The blue color means the geometric difference is small. The red regions are those with higher degree of geometric difference. Fig. 15
                         shows the shape index of another pair of VS surfaces of two normal subjects. Fig. 16
                         shows the shape index of a pair of VS of the normal and AIS subjects. Note that the geometric difference between the two surfaces are more obvious than the geometric difference between the VS of two normal subjects. Fig. 17
                         shows the shape index of another pair of VS of the normal and AIS subjects. Again, the geometric difference between the two surfaces are more obvious than the geometric difference between the VS of two normal subjects. These results demonstrate that the complete shape index is an effective measure to detect local surface geometric differences.

We also compute the complete shape index to detect the geometric difference between the normal mean VS and the AIS mean VS. The shape index is shown in Fig. 18
                        . Note that the local geometric difference is more obvious in the PSC. This again suggests that the shape difference at the PSC between the normal and AIS VS is more significant.

With the obtained surface registration, statistical morphometric analysis based on the coordinates’ deviation can be performed. Using the two-sample Hotelling's T-squared test, the p-value at each vertex on the surface is found. It indicates the probability of the existence of structural differences between the VS of the AIS group and the NC group. If the p-value is less than our predefined significant level of 0.001, a potential morphometric variation can be concluded at that vertex. Our results shown in Fig. 19
                         illustrates the location of possible morphometric deviations. It can be observed that the significant regions lie mainly at the PSC.

@&#DISCUSSION@&#

VS is a key organ for maintaining postural balance in humans and poor postural balance is a recognized characteristic in AIS patients [35,36]. The shape of the VS is confirmed being related to the growth of vertebrates. Lambert et al. [8] made use of frog models for experiment to conclude that asymmetric vestibular inputs could lead to imbalanced growth of the spine. Thus, the studies on the relationship between AIS and VS abnormality become important to the etiopathology of the disease. Our proposed methods focus on the accurate registration and the quantitative shape analysis of the canals in the VS between the AIS group and the normal control group. The goal of this study is to provide an objective assessment of the VS abnormality in AIS patients.

Handling the VS surfaces is challenging because of their complex topology. Our proposed landmark-based registration method effectively obtains accurate point-wise correspondences between the VS surfaces. Experimental results show that the computed registration matches corresponding regions of the VS surfaces consistently. Landmark-based registration is shown to be effective for matching VS surfaces, and it is beneficial since expert knowledge of feature correspondences can be incorporated into the model. The obtained registrations are also folding-free. In addition, the registration process can be done efficiently.

With the registration, information about the correspondences between VS surfaces of the normal and AIS groups vertex-wisely can be obtained. It can be used to perform comprehensive shape analysis on the whole VS surfaces. Preliminary testing on 27 VS surfaces reveals that there are geometric differences along the length of the posterior canal in the left-side VS of the AIS patients. It could contribute to the uneven vestibular signals to the patients and thus their vertebral growths. Furthermore, it is also observed that there are distortions of the plane of PSC in the AIS patients. Such planar defection was found affecting the locomotion in primates by [37].

The proposed surface registration method is shown to be helpful in the shape analysis of the complex geometry of VS. It is hoped that a standardized assessment could set out for clinical diagnosis. To examine the accuracy and stability of the measurement, a larger sample size would be included in the continuation of this study. Moreover, our registration method could be extended for the analysis of other organs, such as spinal cord and pelvis.

@&#CONCLUSION@&#

This paper proposes an effective method to obtain landmark constrained surface registration between high-genus surfaces (genus g
                     >1). The algorithm can be applied to register VS surfaces, which are of genus-3. Given a set of corresponding landmarks on the VS surfaces, a diffeomorphism between the VS surfaces that matches the features consistently can be obtained. The basic idea is to iteratively search for admissible Beltrami coefficients, which is associated to our desired landmark matching registration. With the surface registrations, two geometric features, homotopic loops and minimal surfaces, can be obtained. These geometric features can be used for the shape analysis of the VS surfaces. To perform a more comprehensive local shape analysis, a complete shape index defined by the Beltrami coefficients and curvatures can be used. The shape index effectively measures the geometric difference between two VS surfaces at each vertex of surfaces. To test our proposed algorithms, experiments have been carried out to register VS surfaces of 15 normal control subjects and 12 AIS subjects. Results show that our method can effectively and accurately compute the surface registrations between the VS surfaces. Shape analysis has also been carried out using the proposed shape features and shape energy, which reveals shape differences in the posterior canal between normal and diseased AIS groups.

@&#ACKNOWLEDGMENTS@&#

This research is supported by HKRGC GRF (CUHK Project ID: 401811, 411910, 475711, 462611, 411811). Defeng Wang is also supported by a grant from the National Natural Science Foundation of China (Project No. 81101111), and a grant from The Science, Technology and Innovation Commission of Shenzhen Municipality (Program Code: CXZZ20140606164105361).

@&#REFERENCES@&#

