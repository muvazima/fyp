@&#MAIN-TITLE@&#FRR: Fair remote retrieval of outsourced private medical records in electronic health networks

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose the fair remote retrieval (FRR) model.


                        
                        
                           
                           We motivate FRR to fairly retrieve encrypted medical records from the cloud.


                        
                        
                           
                           We construct the first FRR scheme.


                        
                        
                           
                           We prove the security of our scheme in the random oracle model.


                        
                        
                           
                           We give a detailed performance analysis and experimental results.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Cloud computing

Medical records

Fair remote data retrieval

@&#ABSTRACT@&#


               
               
                  Cloud computing is emerging as the next-generation IT architecture. However, cloud computing also raises security and privacy concerns since the users have no physical control over the outsourced data. This paper focuses on fairly retrieving encrypted private medical records outsourced to remote untrusted cloud servers in the case of medical accidents and disputes. Our goal is to enable an independent committee to fairly recover the original private medical records so that medical investigation can be carried out in a convincing way. We achieve this goal with a fair remote retrieval (FRR) model in which either t investigation committee members cooperatively retrieve the original medical data or none of them can get any information on the medical records. We realize the first FRR scheme by exploiting fair multi-member key exchange and homomorphic privately verifiable tags. Based on the standard computational Diffie–Hellman (CDH) assumption, our scheme is provably secure in the random oracle model (ROM). A detailed performance analysis and experimental results show that our scheme is efficient in terms of communication and computation.
               
            

@&#INTRODUCTION@&#

Cloud servers (CS) can provide shared resources, software and information to remote clients over a network such as Internet. The clients can access the CS through a web browser or a smartphone application, while the business software and data are stored on the CS at a remote location. An important application of cloud computing is to store medical documents from electronic health networks (EHNs) in order to facilitate the exchange of health information between healthcare organizations, clinical research organizations, healthcare payers and public health agencies. Each day, an EHN generates and records numerous medical documents, including medical images, medical check reports, clinical reports, medical prescriptions, patient monitoring reports, and so on [1,2]. These documents are sensitive and need to be protected, so that only authorized parties can access them. It is preferable to employ cloud servers to store and maintain such a large number of medical documents, because the cloud reduces cost and offers universal accessibility.

Cloud computing poses some security problems: remote data integrity checking, remote data retrieval and data privacy. For example, CS may neglect keeping or may deliberately delete rarely accessed data of some clients. Thus, it is important to enable the client to easily check the integrity of the outsourced data without downloading the entire database. Furthermore, the remotely stored data may need to be used in the future; therefore, the client must have the ability to retrieve his/her data anywhere anytime. To achieve data privacy, a general approach is to let the clients encrypt their data before uploading them to CS. The encryption can be elegantly designed to allow searching encrypted data or retrieving data with specific content. To improve the robustness of data retrieval, error-correcting codes can be used before the data are stored at the CS.

@&#RELATED WORK@&#

The provable data possession (PDP) model, introduced by Ateniese et al. [3], performs a probabilistic check and is designed to catch a misbehaving CS deleting or altering a file outsourced by a client. In [3] Ateniese et al. also instantiated two non-dynamic PDP schemes that are provably secure in the random oracle model. Subsequently, they proposed a dynamic PDP security model and realized a concrete PDP scheme [4] supporting data updates except the insert operation. Fully dynamic PDP was realized by Erway et al. based on an authenticated flip table [5]. Independently, Sebé et al. designed an efficient PDP scheme by using the problem of factoring large integers [6]. Since then, several variants of the original PDP models and new instantiations have been proposed. Wang et al. studied proxy PDP [7], cooperative PDP [8] and identity-based PDP [9,10]. Zhu et al. proposed the concept of cooperative PDP for hybrid clouds [11,12]. Curtmola et al. proposed the multiple-replica PDP [13]. Yu et al. studied the security and privacy-preserving problems in remote data integrity checking [14,15].

Proofs of Retrievability (PoRs) is an enhanced model to guarantee that the clients can retrieve their remotely stored data. The above PDP model ensures that the clients will catch with high probability a misbehaving CS who modified the clients’ files. However, secure remote data storage is only part of the client’s requirements. The clients must be able to retrieve the remote data no matter whether the misbehaving CS was caught or not. This gap is filled by the PoRs model [16,17] that ensures that the clients can definitely retrieve their data. In the PoRs model, CS proves to a client that it is actually storing the entire data of the client and the client can retrieve the data anytime anywhere. In a multi-client setting, Zheng et al. more recently proposed a fair and dynamic PoRs model and a corresponding scheme [18]. Since then, several variants of the original PoRs models and new instantiations have been proposed. Bower et al. concluded the theory and implementation of PoRs [19]. Dodis et al. proposed novel PoRs via hardness amplification [20]. Zhu et al. proposed the zero-knowledge proofs of retrievability [21].

Efforts have been also devoted to privacy and management of outsourced data. Wan et al. proposed hierarchical attribute-set-based encryption by extending ciphertext-policy attribute-set-based encryption with a hierarchical structure of users [22]. The encryption approach can be added to PoRs to simultaneously achieve data privacy and retrievability [23].

In this paper, we study the security and privacy concerns in medical investigation in EHNs. In such a scenario, numerous medical records are encrypted and stored in a CS. Unlike in other cloud storage applications, here the CS, the hospital and the patients may be interested in dishonestly modifying the outsourced medical data. Hence, an independent third party is employed to guarantee the integrity and the retrievability of the outsourced data. Further, when medical investigation is performed in the case of medical accidents, the third party should be able to recover the original medical records in a fair way. We argue that an independent third party is necessary since both the hospital and the patients might tamper with the original medical records or refuse to decrypt the encrypted records if the original records could be used as arguments against them in a dispute.

Motivated by the above application, we present a fair remote retrieval (FRR) model in EHNs. We capture the data privacy, retrievability and fairness requirements in such applications. To achieve data privacy, private medical records need to be encrypted before they are outsourced to cloud servers so that curious CS cannot understand the content of the stored data. In FRR, t of n cooperating medical committee members should be able to check whether the data are kept intact or not. Further, the t cooperating members should be also able to recover the original data if necessary; however, if less than t members collude, they must not be able to obtain any information about the outsourced data, which guarantees fairness in medical investigation in the case of medical accidents or disputes.

The rest of the paper is organized as follows. Section 2 states the problem to be investigated and defines the system model. Section 3 describes our FRR scheme and proves its security. Section 4 evaluates our scheme in terms of computation and communication cost. Section 5 concludes the paper.

In this section, we present a functional FRR model in EHNs (Section 2.1) and then formally define its security requirements (Section 2.2). Our FRR system considers the following scenario: a hospital uploads the patients’ private medical records to a CS maintained by a cloud service provider; the provider is not assumed to be trustable; specifically, the provider may be curious and occasionally misbehave, e.g., by deleting or modifying some parts of the medical records; a medical committee of n members is employed to validate whether the records have been kept intact; the committee can also recover the records if required.

An FRR system, as shown in Fig. 1
                        , comprises five types of participants: Patient, Hospital, CS, Committee and Semi-Trusted Neutral Party (STNP). They are described as follows.
                           
                              1.
                              Patient: When a patient goes to the hospital for health treatment, private medical records are generated and encrypted by the patient.

Hospital: The hospital helps the patient to create some private medical records. After receiving the patient’s encrypted medical records, the hospital uploads them to the CS.

CS: CS has significant storage space and computational resources to maintain the data from the hospitals. However, CS may also occasionally misbehave and modify some parts of the stored data.

Committee: This is the third party trusted by the patient and the hospital to solve a medical tangle; this is a situation in which the patients (or their family members) query the hospital’s course of treatment and are not satisfied with the hospital’s reply. In such a situation, the patient and the hospital may appeal to the committee of medical tangle, which consists of n independent members who do not necessarily trust each other. At least t members must cooperate in a fair exchange in order to recover the original patient data.

STNP: The Semi-Trusted Neutral Party (STNP) is selected on a case-by-case basis and asked to aid in the execution of a fair multi-member exchange among the independent committee members. STNP is trusted to ensure the fairness of the multi-member exchange, that is, all members trust it to honestly process the received messages and respond to the corresponding members. However, it is not assumed to be fully trusted by the members. In particular, STNP is not allowed to see the final exchanged secret shares of the members; hence, a malicious STNP cannot get the private medical records as long as the number of dishonest members is less than 
                                    
                                       t
                                       -
                                       1
                                    
                                 . The members can request STNP’s intervention in case of dispute. If there is no dispute, STNP stays offline. If there exists a dispute, STNP stays online.

An FRR scheme among untrusted members, CS, hospital and patient, and utilizing STNP, is a collection of eight probabilistic polynomial-time algorithms (KeyGen, TagGen, CheckTag, GroupBarter, GenProof, GenRetrieval, Verify, Extract) such that:
                                 
                                    1.
                                    
                                       KeyGen
                                       
                                          
                                             (
                                             
                                                
                                                   1
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             →
                                             (
                                             pk
                                             ,
                                             sk
                                             )
                                          
                                        is a probabilistic polynomial-time key generation algorithm, where k is the security parameter. CS runs the algorithm KeyGen to obtain its own pair 
                                          
                                             (
                                             y
                                             ,
                                             Y
                                             )
                                          
                                        of private/public keys. The hospital runs the algorithm KeyGen to obtain its own pair 
                                          
                                             (
                                             z
                                             ,
                                             Z
                                             )
                                          
                                        of private/public keys. On the other hand, the patient runs the algorithm KeyGen to get a pair 
                                          
                                             (
                                             s
                                             ,
                                             v
                                             )
                                          
                                        of matching private/public keys. Then the patient distributes the shares 
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   n
                                                
                                             
                                          
                                        of the private key s to the corresponding committee members. This phase produces the system parameters which are denoted by param.


                                       TagGen
                                       
                                          
                                             (
                                             s
                                             ,
                                             m
                                             )
                                             →
                                             
                                                
                                                   T
                                                
                                                
                                                   m
                                                
                                             
                                          
                                        is a polynomial-time algorithm run by the patient to generate the verification metadata. On input the private key s and a file block m, it returns the verification tag 
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       . Then, with the help of the hospital, the patient uploads the block-tag pairs 
                                          
                                             (
                                             m
                                             ,
                                             
                                                
                                                   T
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                          
                                        to CS. Some corresponding metadata will be kept by the patient and the hospital.


                                       CheckTag
                                       
                                          
                                             (
                                             
                                                
                                                   m
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   T
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             param
                                             ,
                                             Y
                                             ,
                                             Z
                                             ,
                                             v
                                             )
                                             →
                                             {
                                          
                                       “success”, “failure”
                                          
                                             }
                                          
                                        is a polynomial-time algorithm run by CS to check whether a block-tag pair is valid. It takes as input a block-tag pair 
                                          
                                             (
                                             
                                                
                                                   m
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   T
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                        and the public keys of CS, the hospital and the patient; it returns “success” or “failure”. “Success” denotes that the pair is valid and “failure” denotes that it is invalid.


                                       GroupBarter
                                       
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             )
                                             →
                                             s
                                          
                                        is a polynomial-time algorithm fairly run by t committee members with the help of STNP. It takes as input t secret shares 
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                        which are distributed in the phase KeyGen, and returns the final private key s. Fair running ensures that either the t participating members obtain the private key s or no member obtains it. s can be used to decrypt the patient’s private records.


                                       GenProof
                                       
                                          
                                             (
                                             F
                                             ,
                                             chal
                                             ,
                                             Σ
                                             )
                                             →
                                             V
                                          
                                        is run by CS in order to realize the remote data integrity checking and the retrieval protocol. It takes as inputs an ordered collection F of blocks, a challenge chal and an ordered collection 
                                          
                                             Σ
                                          
                                        of verification metadata which corresponds to the blocks in F. It returns V for the blocks in F that are determined by the challenge chal.


                                       GenRetrieval
                                       
                                          
                                             (
                                             F
                                             ,
                                             Rchal
                                             ,
                                             Σ
                                             )
                                             →
                                             V
                                          
                                        is run by CS. It takes as inputs an ordered collection F of blocks, a challenge Rchal and an ordered collection 
                                          
                                             Σ
                                          
                                        of verification metadata which corresponds to the blocks in F. It returns V that corresponds to the challenge Rchal.


                                       Verify
                                       
                                          
                                             (
                                             (
                                             z
                                             ,
                                             Z
                                             )
                                             ,
                                             chal
                                             ,
                                             V
                                             )
                                             →
                                             b
                                             ∈
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                        is run by the hospital to check whether the response V is valid. “1” denotes valid; “0” denotes invalid.


                                       Verify-Retrieve
                                       
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   
                                                      
                                                         2
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             ,
                                             Rchal
                                             ,
                                             V
                                             )
                                             →
                                             M
                                          
                                        is run by the members of the medical tangle expert committee to retrieve the remote private medical records M. It takes as inputs the challenge Rchal, the shares 
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   
                                                      
                                                         2
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                        of the patient’s private key s, and the corresponding response V. The members verify the response V and get the remote private medical records M if successful.

Note. The step Verify-Retrieve can also be performed by the patient since it owns the private key s.

An FRR scheme should be correct. Correctness requires that, for the keypairs 
                           
                              (
                              y
                              ,
                              Y
                              )
                              ,
                              (
                              z
                              ,
                              Z
                              )
                           
                         and 
                           
                              (
                              s
                              ,
                              v
                              )
                           
                         output by KeyGen, for all file block-tag pairs 
                           
                              (
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         output by TagGen, the verification algorithm accepts the response V when interacting with the honest CS.

We now formally define the security properties: unforgeability against untrusted CS, retrievability, and threshold fairness among the untrusted clients.
                           Definition 2
                           Unforgeability against untrusted CS


                           An FRR scheme is unforgeable against any probabilistic polynomial-time untrusted CS if the probability that any such CS wins the FRR game below is negligible. We denominate the untrusted CS as the adversary 
                                 
                                    A
                                 
                              . The FRR game is described below:
                                 
                                    1.
                                    Setup: The challenger is denoted by 
                                          
                                             C
                                          
                                       . 
                                          
                                             C
                                          
                                        obtains CS’s public–private key pair 
                                          
                                             (
                                             
                                                
                                                   pk
                                                
                                                
                                                   s
                                                
                                             
                                             ,
                                             
                                                
                                                   sk
                                                
                                                
                                                   s
                                                
                                             
                                             )
                                             ←
                                             KeyGen
                                             (
                                             
                                                
                                                   1
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       . It obtains the Client’s public–private key pair (
                                          
                                             
                                                
                                                   pk
                                                
                                                
                                                   c
                                                
                                             
                                             ,
                                             
                                                
                                                   sk
                                                
                                                
                                                   c
                                                
                                             
                                          
                                       ) 
                                          
                                             ←
                                          
                                        KeyGen (1k). Then, 
                                          
                                             C
                                          
                                        sends 
                                          
                                             (
                                             params
                                             ,
                                             
                                                
                                                   pk
                                                
                                                
                                                   s
                                                
                                             
                                             ,
                                             
                                                
                                                   sk
                                                
                                                
                                                   s
                                                
                                             
                                             ,
                                             
                                                
                                                   pk
                                                
                                                
                                                   c
                                                
                                             
                                             )
                                          
                                        to 
                                          
                                             A
                                          
                                        (i.e., untrusted CS) and keeps the private key 
                                          
                                             
                                                
                                                   sk
                                                
                                                
                                                   c
                                                
                                             
                                          
                                        confidential.

First-Phase Queries: 
                                          
                                             A
                                          
                                        adaptively makes different queries to 
                                          
                                             C
                                          
                                        as listed below:
                                          
                                             •
                                             
                                                Hash queries. 
                                                   
                                                      A
                                                   
                                                 makes hash queries adaptively and 
                                                   
                                                      C
                                                   
                                                 responds to them.


                                                Tag queries. 
                                                   
                                                      A
                                                   
                                                 makes block-tag pair queries adaptively. For a query 
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                 issued by 
                                                   
                                                      A
                                                      ,
                                                      
                                                      C
                                                   
                                                 computes the tag 
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ←
                                                      TagGen
                                                      (
                                                      
                                                         
                                                            sk
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                 and sends it back to 
                                                   
                                                      A
                                                   
                                                . Without loss of generality, let 
                                                   
                                                      (
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                 be the queried block-tag pairs for index 
                                                   
                                                      i
                                                      ∈
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                .

Challenge: 
                                          
                                             C
                                          
                                        generates a challenge chal which defines an ordered queried index collection 
                                          
                                             {
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   c
                                                
                                             
                                             }
                                          
                                       , where 
                                          
                                             {
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   c
                                                
                                             
                                             }
                                             
                                             ⊈
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   1
                                                
                                             
                                          
                                        and c is a positive integer. In the index set 
                                          
                                             {
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   c
                                                
                                             
                                             }
                                          
                                       , at least there exists one corresponding 
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                             (
                                             1
                                             ⩽
                                             j
                                             ⩽
                                             c
                                             )
                                          
                                        that has never been queried by 
                                          
                                             A
                                          
                                       .

Second-Phase Queries: Similar to the First-Phase Queries. Suppose that 
                                          
                                             (
                                             
                                                
                                                   m
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   T
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                        is the queried and answered block-tag pair for index 
                                          
                                             i
                                             ∈
                                             
                                                
                                                   I
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       , where 
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   2
                                                
                                             
                                          
                                        is the queried and answered block-tag pair index set. The restriction is that 
                                          
                                             {
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   c
                                                
                                             
                                             }
                                             
                                             ⊈
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   1
                                                
                                             
                                             ∪
                                             
                                                
                                                   I
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       .

Forge: 
                                          
                                             A
                                          
                                        computes an integrity proof V for the blocks indicated by chal and returns V to 
                                          
                                             C
                                          
                                       .

We say that FRR satisfies unforgeability against the untrusted CS if the adversary 
                                 
                                    A
                                 
                               wins the FRR game with negligible probability.

Now, we define the property of retrievability where the adversary 
                           
                              A
                           
                         is still an untrusted CS. For 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    A
                                 
                              
                              ⩽
                              ∊
                           
                        , an 
                           
                              ∊
                           
                        -adversary 
                           
                              A
                           
                         replies correctly to a fraction of at least 
                           
                              1
                              -
                              
                                 
                                    ∊
                                 
                                 
                                    A
                                 
                              
                           
                         challenges over the lifetime of the file.
                           Definition 3
                           
                              
                                 
                                    (
                                    ∊
                                    ,
                                    γ
                                    )
                                 
                              -Retrievability


                           An FRR scheme against the untrusted cloud is an 
                                 
                                    (
                                    ∊
                                    ,
                                    γ
                                    )
                                 
                              -valid proof of retrievability if for every polynomial-time 
                                 
                                    ∊
                                 
                              -adversary 
                                 
                                    A
                                 
                               (i.e., untrusted cloud), the probability that Verify-Retrieve outputs the correct stored file M is 
                                 
                                    γ
                                 
                              .

Suppose the set of committee members is S and the number of members is 
                                 
                                    |
                                    S
                                    |
                                    =
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . The threshold value is t. The FRR scheme with STNP against untrusted members satisfies the property of 
                                 
                                    (
                                    t
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                              -threshold fairness if it satisfies the following conditions.
                                 
                                    1.
                                    Any t or more honest members can cooperate to check and retrieve the remote data. If there exist dishonest members among the t members, the t members cannot check or retrieve the remote data.

Any 
                                          
                                             t
                                             -
                                             1
                                          
                                        or less members cannot check or retrieve the remote data.

In this section, we recall some mathematical background (Section 3.1) and then we present our pairing-based FRR scheme to fairly protect the hospital and the patients in the case of medical accident investigation (Section 3.2). Then, in Section 3.3, we analyze the correctness and security of our scheme, which is shown to satisfy provable security in the ROM.

Let 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                           
                         be two cyclic multiplicative groups with the same prime order q, i.e., 
                           
                              |
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              |
                              =
                              |
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              |
                              =
                              q
                           
                        . Let 
                           
                              e
                              :
                              
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ×
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              →
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                           
                         be a bilinear map which satisfies the following properties: (1) Bilinearity: 
                           
                              ∀
                              Q
                              ,
                              R
                              ,
                              S
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              a
                              ,
                              b
                              ∈
                              
                                 
                                    Z
                                 
                                 
                                    q
                                 
                              
                              ,
                              
                              e
                              (
                              
                                 
                                    R
                                 
                                 
                                    a
                                 
                              
                              ,
                              
                                 
                                    Q
                                 
                                 
                                    b
                                 
                              
                              )
                              =
                              e
                              
                                 
                                    (
                                    R
                                    ,
                                    Q
                                    )
                                 
                                 
                                    ab
                                 
                              
                           
                        . (2) Non-degeneracy: 
                           
                              ∃
                              Q
                              ,
                              R
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           
                         such that 
                           
                              e
                              (
                              Q
                              ,
                              R
                              )
                              
                              ≠
                              
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        . (3) Computability: 
                           
                              ∀
                              Q
                              ,
                              R
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           
                        , there is an efficient algorithm to calculate 
                           
                              e
                              (
                              Q
                              ,
                              R
                              )
                           
                        .

We can construct such a bilinear map e based on the modified Weil pairings [24] or Tate pairings [25] on elliptic curves over finite fields. A group with such a map e is called a bilinear group. Our scheme is proven to be secure under some well-understood computational difficulty assumptions in the random oracle model.

Let P be the generator of 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           
                        . Now, given unknown 
                           
                              a
                              ,
                              b
                              ,
                              c
                              ∈
                              
                                 
                                    Z
                                 
                                 
                                    q
                                 
                              
                           
                         and 
                           
                              P
                              ,
                              
                                 
                                    P
                                 
                                 
                                    a
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    b
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    c
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           
                        , it holds that there exists an efficient algorithm to determine whether 
                           
                              ab
                              =
                              c
                              
                              mod
                              
                              q
                           
                         by verifying 
                           
                              e
                              (
                              
                                 
                                    P
                                 
                                 
                                    a
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    b
                                 
                              
                              )
                              =
                              e
                              
                                 
                                    (
                                    P
                                    ,
                                    P
                                    )
                                 
                                 
                                    c
                                 
                              
                           
                         in polynomial time (Decisional Diffie-Hellman or DDH problem), while there exists no efficient algorithm to compute 
                           
                              
                                 
                                    P
                                 
                                 
                                    ab
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           
                         with non-negligible probability within polynomial time (Computational Diffie–Hellman or CDH problem); see [26] for details. A group where DDH is easy and CDH is hard is called a co-GDH group; hence, 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           
                         is a co-GDH group.

In order to give the intuition of our FRR scheme construction, its architecture is given in Fig. 2
                        . There are five entities: patient, hospital, cloud server, committee and STNP. Parameters t and 
                           
                              
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                           
                         are determined by the patient, the committee and STNP. STNP is used for the multi-member fair exchange. The architecture can be outlined as follows:
                           
                              ① The patient goes to the hospital for health treatment. With the help of the hospital, he gets his own private medical records. The patient encrypts these medical records.

② The hospital uploads these encrypted private medical records to the cloud server.

③ A medical tangle happens between the patient and the hospital. The patient and the hospital appeal to the committee.

④ The patient distributes the secret shares 
                                    
                                       {
                                       
                                          
                                             s
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       }
                                    
                                  to all committee members 
                                    
                                       {
                                       
                                          
                                             M
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       }
                                    
                                 .

⑤ Without loss of generality, we let the threshold be t and the active member subset be 
                                    
                                       {
                                       
                                          
                                             M
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             t
                                          
                                       
                                       }
                                    
                                 . The entities 
                                    
                                       {
                                       STNP
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             t
                                          
                                       
                                       }
                                    
                                  perform the threshold fair multi-member key exchange.

⑥ The members 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             t
                                          
                                       
                                    
                                  interact with the cloud server and retrieve the remote medical records.

We next describe our scheme in detail and start by introducing some additional notation used in the construction. Suppose the maximum number of block-tag pairs is n. Let f and w be two pseudo-random functions. Let 
                           
                              H
                              ,
                              
                              h
                              ,
                              
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    h
                                 
                                 
                                    1
                                 
                              
                           
                         be cryptographic hash functions. The functions mentioned in this paragraph can be defined as follows:
                           
                              
                                 f
                                 :
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       q
                                    
                                    
                                       ∗
                                    
                                 
                                 ×
                                 {
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 }
                                 →
                                 
                                    
                                       Z
                                    
                                    
                                       q
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                 ω
                                 :
                                 
                                 {
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 }
                                 →
                                 
                                    
                                       Z
                                    
                                    
                                       q
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                 H
                                 :
                                 
                                 
                                    
                                       G
                                    
                                    
                                       2
                                    
                                 
                                 →
                                 
                                    
                                       Z
                                    
                                    
                                       q
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 :
                                 
                                 
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                       ∗
                                    
                                 
                                 →
                                 
                                    
                                       Z
                                    
                                    
                                       q
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                 h
                                 :
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       q
                                    
                                    
                                       ∗
                                    
                                 
                                 →
                                 
                                    
                                       G
                                    
                                    
                                       1
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       h
                                    
                                    
                                       1
                                    
                                 
                                 :
                                 
                                 
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                       ∗
                                    
                                 
                                 →
                                 
                                    
                                       Z
                                    
                                    
                                       q
                                    
                                    
                                       ∗
                                    
                                 
                                 .
                              
                           
                        
                     

Let 
                           
                              
                                 
                                    f
                                 
                                 
                                    z
                                 
                              
                              (
                              i
                              )
                           
                         denote the function f with input i and trapdoor z. Let g be a generator of 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    g
                                 
                                 
                                    ¯
                                 
                              
                           
                         be a generator of 
                           
                              
                                 
                                    Z
                                 
                                 
                                    q
                                 
                                 
                                    ∗
                                 
                              
                           
                        , where q is the order of 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                           
                        . The phases of our FRR scheme are described below.


                        KeyGen: CS picks a random number 
                           
                              y
                              ∈
                              
                                 
                                    Z
                                 
                                 
                                    q
                                 
                                 
                                    ∗
                                 
                              
                           
                         as its private key and computes 
                           
                              Y
                              =
                              
                                 
                                    g
                                 
                                 
                                    y
                                 
                              
                           
                         as its public key. The hospital picks a random number 
                           
                              z
                              ∈
                              
                                 
                                    Z
                                 
                                 
                                    q
                                 
                                 
                                    ∗
                                 
                              
                           
                         as its private key and computes 
                           
                              Z
                              =
                              
                                 
                                    g
                                 
                                 
                                    z
                                 
                              
                           
                         as its public key. The patient picks a random number 
                           
                              s
                              ∈
                              
                                 
                                    Z
                                 
                                 
                                    q
                                 
                                 
                                    ∗
                                 
                              
                           
                         and computes 
                           
                              v
                              =
                              
                                 
                                    g
                                 
                                 
                                    s
                                 
                              
                           
                        . Then, it picks a random polynomial 
                           
                              
                                 
                                    f
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              x
                              )
                           
                         of degree 
                           
                              t
                              -
                              1
                              :
                              
                                 
                                    f
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              x
                              )
                              =
                              s
                              +
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              x
                              +
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              +
                              ⋯
                              +
                              
                                 
                                    a
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    Z
                                 
                                 
                                    q
                                 
                                 
                                    ∗
                                 
                              
                           
                         and 
                           
                              1
                              ⩽
                              i
                              ⩽
                              t
                              -
                              1
                           
                        . For 
                           
                              
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                           
                         different members 
                           
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    M
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    M
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                        , the patient performs the following steps:
                           
                              1.
                              For 
                                    
                                       1
                                       ⩽
                                       i
                                       ⩽
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 , compute 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             H
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                  and 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 . Then, send 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                    
                                  to the member 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                    
                                  via a secure channel.

For 
                                    
                                       1
                                       ⩽
                                       i
                                       ⩽
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 , compute 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             g
                                          
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                  and make them public.

Then, the patient picks a random element 
                           
                              u
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                                 
                                    ∗
                                 
                              
                           
                         and its public key is 
                           
                              {
                              u
                              ,
                              v
                              }
                           
                        . The patient’s private key is s and the private key shares are 
                           
                              {
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              ,
                              1
                              ⩽
                              i
                              ⩽
                              
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              }
                           
                        .


                        TagGen (s, F, i). Given the file F, the patient encrypts F by using a symmetric encryption algorithm E and the private key s of the patient. Suppose the ciphertext is 
                           
                              
                                 
                                    F
                                 
                                 
                                    ^
                                 
                              
                              =
                              
                                 
                                    E
                                 
                                 
                                    s
                                 
                              
                              (
                              F
                              )
                           
                        . Then, the patient applies an erasure code on 
                           
                              
                                 
                                    F
                                 
                                 
                                    ^
                                 
                              
                           
                         to obtain 
                           
                              
                                 
                                    F
                                 
                                 
                                    ′
                                 
                              
                           
                        . Then, the patient splits 
                           
                              
                                 
                                    F
                                 
                                 
                                    ′
                                 
                              
                           
                         into l blocks 
                           
                              
                                 
                                    F
                                 
                                 
                                    ′
                                 
                              
                              =
                              (
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    l
                                 
                              
                              )
                           
                         for some positive integer l. To generate the tag 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                         that corresponds to the block 
                           
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                        , the patient performs the following procedures:
                           
                              1.
                              Compute 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             h
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ,
                                       
                                       δ
                                       =
                                       H
                                       (
                                       e
                                       
                                          
                                             (
                                             Y
                                             ,
                                             Z
                                             )
                                          
                                          
                                             s
                                          
                                       
                                       )
                                    
                                  and generate 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             ω
                                          
                                          
                                             δ
                                          
                                       
                                       (
                                       i
                                       )
                                    
                                 .

Compute 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             h
                                             (
                                             
                                                
                                                   W
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             s
                                          
                                       
                                    
                                  and output 
                                    
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 .

As soon as the patient generates the l block tags, the hospital uploads all the block-tag pairs 
                           
                              {
                              (
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                              1
                              ⩽
                              i
                              ⩽
                              l
                              }
                           
                         to CS.


                        CheckTag(
                           
                              {
                              (
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                              1
                              ⩽
                              i
                              ⩽
                              l
                              }
                           
                        ). Given 
                           
                              {
                              (
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                              1
                              ⩽
                              i
                              ⩽
                              l
                              }
                           
                        , CS performs the following procedures for every 
                           
                              i
                              ,
                              1
                              ⩽
                              i
                              ⩽
                              l
                           
                        :
                           
                              1.
                              Compute 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             h
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ,
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             ˆ
                                          
                                       
                                       =
                                       H
                                       (
                                       e
                                       
                                          
                                             (
                                             v
                                             ,
                                             Z
                                             )
                                          
                                          
                                             y
                                          
                                       
                                       )
                                    
                                  and 
                                    
                                       
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             ω
                                          
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                       
                                       (
                                       i
                                       )
                                    
                                 .

Verify whether 
                                    
                                       e
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       g
                                       )
                                       
                                          
                                             =
                                          
                                          
                                             ?
                                          
                                       
                                       e
                                       (
                                       h
                                       (
                                       
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       ,
                                       v
                                       )
                                    
                                  holds.

If it holds, it is valid and it is stored in CS. Otherwise, it is rejected.


                        Notes: In CheckTag, CS can perform the batch checking as follows. After receiving the l block-tag pairs 
                           
                              {
                              (
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                              
                              1
                              ⩽
                              i
                              ⩽
                              l
                              }
                           
                        , CS picks l random 
                           
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    Z
                                 
                                 
                                    q
                                 
                                 
                                    ∗
                                 
                              
                           
                         and computes 
                           
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    h
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                              
                              T
                              =
                              
                                 
                                    ∏
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    l
                                 
                              
                              
                                 
                                    T
                                 
                                 
                                    j
                                 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    m
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    l
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    m
                                 
                                 
                                    j
                                 
                              
                           
                        . If 
                           
                              e
                              (
                              T
                              ,
                              g
                              )
                              
                                 
                                    =
                                 
                                 
                                    ?
                                 
                              
                              e
                              
                                 
                                    
                                       
                                          
                                             ∏
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             l
                                          
                                       
                                       h
                                       
                                          
                                             (
                                             
                                                
                                                   ω
                                                
                                                
                                                   δ
                                                
                                             
                                             (
                                             j
                                             )
                                             )
                                          
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       ,
                                       v
                                    
                                 
                              
                           
                         holds, these l block-tag pairs are accepted; otherwise, CS can get the invalid block-tag pairs by dichotomizing the search and then reject them.


                        GroupBarter. t members cooperate to perform fair exchange in order to check and retrieve remote private medical records. Let the t members’ identity set be 
                           
                              {
                              
                                 
                                    M
                                 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    M
                                 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    M
                                 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              }
                           
                        . They do as follows:
                           
                              1.
                              For 
                                    
                                       i
                                       ∈
                                       {
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             t
                                          
                                       
                                       }
                                       ,
                                       
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                    
                                  picks a random 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                       ∈
                                       
                                          
                                             Z
                                          
                                          
                                             q
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 , computes 
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                       
                                       mod
                                       
                                       (
                                       q
                                       -
                                       1
                                       )
                                    
                                  and 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                       mod
                                       
                                       q
                                    
                                 , and makes 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                    
                                  public.

For 
                                    
                                       i
                                       ∈
                                       {
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             t
                                          
                                       
                                       }
                                       ,
                                       
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                    
                                  sends 
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                    
                                  to STNP through a secure channel.

For 
                                    
                                       i
                                       ∈
                                       {
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             t
                                          
                                       
                                       }
                                       ,
                                       
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                    
                                  sends 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                    
                                  to 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                       j
                                       
                                       ≠
                                       
                                       i
                                    
                                  and 
                                    
                                       j
                                       ∈
                                       {
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             t
                                          
                                       
                                       }
                                    
                                 .

For 
                                    
                                       j
                                       ∈
                                       {
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             t
                                          
                                       
                                       }
                                    
                                 , when 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             j
                                          
                                       
                                    
                                  receives 
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             M
                                          
                                          
                                             j
                                          
                                       
                                    
                                  checks whether 
                                    
                                       
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             =
                                          
                                          
                                             ?
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                       
                                       mod
                                       
                                       q
                                    
                                  holds. If it holds, 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             j
                                          
                                       
                                    
                                  accepts 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                    
                                  and sends a sign 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             ji
                                          
                                       
                                       =
                                       1
                                    
                                  to STNP through a secure channel; otherwise, 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             j
                                          
                                       
                                    
                                  rejects 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                    
                                 .

For 
                                    
                                       i
                                       ∈
                                       {
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             t
                                          
                                       
                                       }
                                    
                                 , STNP checks: 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             =
                                          
                                          
                                             ?
                                          
                                       
                                       
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                       
                                       mod
                                       
                                       q
                                    
                                 . If it holds, STNP accepts 
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                    
                                 ; otherwise, STNP rejects it.

When STNP receives the t responses 
                                    
                                       {
                                       (
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             R
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       )
                                       ,
                                       (
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             R
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                       ,
                                       …
                                       ,
                                       (
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             R
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       )
                                       }
                                    
                                  and 
                                    
                                       t
                                       (
                                       t
                                       -
                                       1
                                       )
                                    
                                  signs 
                                    
                                       {
                                       
                                          
                                             y
                                          
                                          
                                             ji
                                          
                                       
                                       ,
                                       i
                                       ,
                                       j
                                       ∈
                                       {
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             t
                                          
                                       
                                       }
                                       ,
                                       i
                                       
                                       ≠
                                       
                                       j
                                       }
                                    
                                 , it broadcasts 
                                    
                                       S
                                       =
                                       {
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       }
                                    
                                  to all the clients 
                                    
                                       {
                                       
                                          
                                             M
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       }
                                    
                                 .

For 
                                    
                                       i
                                       ∈
                                       {
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             t
                                          
                                       
                                       }
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                    
                                  computes 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             r
                                          
                                          
                                             j
                                          
                                       
                                       
                                       mod
                                       
                                       (
                                       q
                                       -
                                       1
                                       )
                                    
                                 , where 
                                    
                                       j
                                       
                                       ≠
                                       
                                       i
                                    
                                 . Then, by using the Lagrange interpolation method, 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                    
                                  obtains
                                    
                                       
                                          s
                                          =
                                          
                                             
                                                f
                                             
                                             
                                                ˆ
                                             
                                          
                                          (
                                          0
                                          )
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                s
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∏
                                                         
                                                         
                                                            r
                                                            =
                                                            1
                                                            ,
                                                            r
                                                            ≠
                                                            j
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         -
                                                         
                                                            
                                                               H
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  
                                                                     r
                                                                  
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               H
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                         )
                                                         -
                                                         
                                                            
                                                               H
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  
                                                                     r
                                                                  
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          mod
                                          
                                          q
                                       
                                    
                                 
                              

Thus, after GroupBarter, every member can get the private key s.


                        GenProof(
                           
                              pk
                              ,
                              M
                              =
                              (
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    l
                                 
                              
                              )
                              ,
                              chal
                              ,
                              Σ
                              =
                              (
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    T
                                 
                                 
                                    l
                                 
                              
                              )
                           
                        ). Let the hospital’s integrity challenge be 
                           
                              chal
                              =
                              
                                 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       k
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        . After receiving the challenge chal, CS performs the following steps:
                           
                              1.
                              For 
                                    
                                       1
                                       ⩽
                                       j
                                       ⩽
                                       
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 , compute 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       j
                                       )
                                    
                                 , and 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             h
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       )
                                    
                                 . Then, compute 
                                    
                                       T
                                       =
                                       
                                          
                                             ∏
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       
                                          
                                             T
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             m
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 .

Output 
                                    
                                       V
                                       =
                                       (
                                       T
                                       ,
                                       
                                          
                                             m
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                  to the hospital as the response to chal.


                        GenRetrieval(
                           
                              pk
                              ,
                              M
                              =
                              (
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    l
                                 
                              
                              )
                              ,
                              Rchal
                              ,
                              Σ
                              =
                              (
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    T
                                 
                                 
                                    l
                                 
                              
                              )
                           
                        ). Let the committee members’ Verify-Retrieve challenge be 
                           
                              Rchal
                              =
                              {
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    i
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              }
                           
                        . Then, CS sends 
                           
                              
                                 
                                    V
                                 
                                 
                                    ′
                                 
                              
                              =
                              {
                              (
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    T
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              )
                              ,
                              1
                              ⩽
                              j
                              ⩽
                              
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              }
                           
                         to the members.


                        Verify
                        
                           
                              (
                              (
                              pk
                              ,
                              sk
                              )
                              ,
                              chal
                              ,
                              V
                              )
                           
                        . For the hospital’s challenge-response pair 
                           
                              (
                              chal
                              ,
                              V
                              )
                           
                        , the hospital verifies the response V as follows:
                           
                              1.
                              Compute 
                                    
                                       δ
                                       =
                                       H
                                       (
                                       e
                                       
                                          
                                             (
                                             v
                                             ,
                                             Y
                                             )
                                          
                                          
                                             z
                                          
                                       
                                       )
                                    
                                  and check: 
                                    
                                       e
                                       (
                                       T
                                       ,
                                       g
                                       )
                                       
                                          
                                             =
                                          
                                          
                                             ?
                                          
                                       
                                       e
                                       
                                          
                                             
                                                
                                                   
                                                      ∏
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                h
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            ω
                                                         
                                                         
                                                            δ
                                                         
                                                      
                                                      (
                                                      j
                                                      )
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ,
                                                v
                                             
                                          
                                       
                                    
                                 .

If it holds, accept this response. Otherwise, reject it.


                        Verify-Retrieve
                        
                           
                              (
                              pk
                              ,
                              sk
                              ,
                              Rchal
                              ,
                              
                                 
                                    V
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                        . After receiving the medical tangle, the members of the committee query the medical records 
                           
                              Rchal
                              =
                              {
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              l
                              }
                           
                        . Every member 
                           
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              ,
                              i
                              ∈
                              {
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                              
                              }
                           
                         performs the following steps:
                           
                              1.
                              For 
                                    
                                       1
                                       ⩽
                                       j
                                       ⩽
                                       l
                                    
                                 , pick the random coefficients of the blocks 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             Z
                                          
                                          
                                             q
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  and compute 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             h
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       ,
                                       
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             ∏
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             l
                                          
                                       
                                       
                                          
                                             T
                                          
                                          
                                             j
                                          
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             m
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             l
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       
                                          
                                             m
                                          
                                          
                                             j
                                          
                                       
                                    
                                 .

Compute 
                                    
                                       δ
                                       =
                                       H
                                       (
                                       e
                                       
                                          
                                             (
                                             Y
                                             ,
                                             Z
                                             )
                                          
                                          
                                             s
                                          
                                       
                                       )
                                    
                                  and check: 
                                    
                                       e
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       g
                                       )
                                       
                                          
                                             =
                                          
                                          
                                             ?
                                          
                                       
                                       e
                                       
                                          
                                             
                                                
                                                   
                                                      ∏
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      l
                                                   
                                                
                                                h
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            ω
                                                         
                                                         
                                                            δ
                                                         
                                                      
                                                      (
                                                      j
                                                      )
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            i
                                                            ,
                                                            j
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ,
                                                v
                                             
                                          
                                       
                                    
                                 . If it holds, accept the records. Otherwise, reject them and exit the protocol.

Obtain 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       (
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                       
                                       )
                                    
                                 . Then, get 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ^
                                          
                                       
                                    
                                  by eraser decoding on 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 . After that, retrieve 
                                    
                                       F
                                       =
                                       
                                          
                                             D
                                          
                                          
                                             s
                                          
                                       
                                       (
                                       
                                          
                                             F
                                          
                                          
                                             ^
                                          
                                       
                                       )
                                    
                                  by using s to decrypt 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ^
                                          
                                       
                                    
                                 , where D is the symmetric decryption algorithm that corresponds to E.

In this way, all the 
                           
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              i
                              ∈
                              {
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                              
                              }
                           
                         can fairly check and retrieve the remote private medical records M.


                        Notes: Since s is also known to the patient, the patient can also verify and retrieve his own remote medical records. On the other hand, s is unknown to the hospital, so the hospital cannot retrieve the patient’s remote medical records although it can verify their integrity.

The security analysis of our FRR scheme is given by the following lemmas and theorems. Due to the page limits, the detailed process can be seen in the Appendix. Theorem 1 shows that our protocol can ensure the property of threshold fairness.
                           Theorem 1
                           
                              In the GroupBarter phase, our FRR scheme realizes multi-member threshold fair key exchange with STNP. The advantage of an adversary 
                              
                                 
                                    A
                                 
                               
                              (i.e., a dishonest member), is 
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          q
                                       
                                    
                                 
                               
                              where q is the order of the field 
                              
                                 
                                    
                                       
                                          Z
                                       
                                       
                                          q
                                       
                                    
                                 
                              
                              , which is negligible.
                           

Given in Appendix 1.□


                              If the patient and CS are honest, i.e., they follow the proposed phases, then any block-tag pair can pass CS’s tag checking, i.e., the CheckTag phase satisfies correctness.
                           

Given in Appendix 2.□


                              If the hospital and CS are honest, i.e., they follow the proposed phases, response V can pass the hospital’s integrity checking, i.e., the Verify phase satisfies correctness.
                           

Given in Appendix 3.□


                              If the members and CS are honest, i.e., they follow the proposed phases, all members can retrieve the remote medical records, i.e., the Verify-Retrieve phase satisfies correctness.
                           

Given in Appendix 4.□


                        Lemmas 1–3 have shown the correctness results. We now turn to security results. Lemma 4 shows that a single Tag is existentially unforgeable.
                           Lemma 4
                           
                              Let (
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ) be a (
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          ∊
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              )-co-GDH group pair of order q. Then the tag generation scheme on 
                              
                                 
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                               
                              is 
                              
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          q
                                       
                                       
                                          S
                                       
                                    
                                    ,
                                    
                                       
                                          q
                                       
                                       
                                          h
                                       
                                    
                                    ,
                                    ∊
                                    )
                                 
                              
                              -secure against existential forgery under an adaptive chosen-message attack for all t and 
                              
                                 
                                    ∊
                                 
                               
                              satisfying 
                              
                                 
                                    
                                       
                                          ∊
                                       
                                       
                                          ′
                                       
                                    
                                    ⩾
                                    
                                       
                                          ∊
                                       
                                       
                                          
                                             
                                                e
                                             
                                             
                                                ˆ
                                             
                                          
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                S
                                             
                                          
                                          +
                                          1
                                          )
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    ⩽
                                    
                                       
                                          t
                                       
                                       
                                          ˆ
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          
                                             
                                                G
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          h
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          q
                                       
                                       
                                          S
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          e
                                       
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          H
                                       
                                    
                                    -
                                    1
                                    )
                                 
                              
                              , where 
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          
                                             
                                                G
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                               
                              is a constant that depends on 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          e
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                               
                              is the base of the natural logarithm, and 
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          S
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          q
                                       
                                       
                                          h
                                       
                                    
                                 
                               
                              are the number of Tag queries and h-queries, respectively; 
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          
                                             
                                                G
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                               
                              denotes the time cost of exponentiation on 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ;
                                    
                                    
                                       
                                          c
                                       
                                       
                                          e
                                       
                                    
                                 
                               
                              denotes the time cost of bilinear pairings.
                           

Given in Appendix 5.□


                              Given that a single tag is existentially unforgeable (proven in 
                              
                                 Lemma 4
                              ), a forged grouped tag-block pair 
                              
                                 
                                    (
                                    T
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                 
                               
                              can pass the verification with probability less than 
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          q
                                       
                                    
                                 
                              
                              , which is negligible.
                           

Given in Appendix 6.□


                              If some block-tag pairs 
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          l
                                       
                                    
                                    ,
                                    
                                       
                                          T
                                       
                                       
                                          l
                                       
                                    
                                    )
                                    ,
                                    
                                    l
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          1
                                       
                                    
                                    ⊆
                                    {
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          i
                                       
                                       
                                          c
                                       
                                    
                                    }
                                 
                               
                              are modified, CS can substitute the other valid block-tag pairs 
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          T
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          l
                                       
                                       
                                          ˆ
                                       
                                    
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          2
                                       
                                    
                                 
                               
                              for 
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          l
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          T
                                       
                                       
                                          l
                                       
                                    
                                    )
                                    ,
                                    l
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          1
                                       
                                    
                                 
                               
                              only with negligible probability.
                           

Given in Appendix 7.□


                              Let 
                              
                                 
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                               
                              be a 
                              
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          ∊
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                              
                              -co-GDH group pair of order q. Then a grouped message-tag is 
                              
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          q
                                       
                                       
                                          S
                                       
                                    
                                    ,
                                    
                                       
                                          q
                                       
                                       
                                          h
                                       
                                    
                                    ,
                                    ∊
                                    )
                                 
                              
                              -secure against existential forgery under an adaptive chosen-message attack (in the ROM) for all 
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    ∊
                                 
                               
                              satisfying 
                              
                                 
                                    min
                                    
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   ˆ
                                                
                                             
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   S
                                                
                                             
                                             +
                                             1
                                             )
                                             
                                                
                                                   ∊
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   1
                                                
                                                
                                                   q
                                                
                                             
                                          
                                       
                                    
                                    ⩾
                                    ∊
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    ⩽
                                    
                                       
                                          t
                                       
                                       
                                          ˆ
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          
                                             
                                                G
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          h
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          q
                                       
                                       
                                          S
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          e
                                       
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          H
                                       
                                    
                                    -
                                    1
                                    )
                                 
                              
                              , where 
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          
                                             
                                                G
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                               
                              is a constant that depends on 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          e
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                               
                              is the base of the natural logarithm, and 
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          S
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          q
                                       
                                       
                                          h
                                       
                                    
                                 
                               
                              are the number of Tag queries and h-queries, respectively; 
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          
                                             
                                                G
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                               
                              denotes the time cost of exponentiation on 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ;
                                    
                                    
                                       
                                          c
                                       
                                       
                                          e
                                       
                                    
                                 
                               
                              denotes the time cost of bilinear pairings.
                           

Given in Appendix 8.□

According to Lemmas 1–3, our FRR scheme satisfies the property of correctness. Putting these lemmas together with Theorems 1 and 2, we can assert that our FRR scheme is provably secure in the ROM.

In this section, we first analyze the performance of our proposed FRR protocol in terms of computation and communication costs (Section 4.1). Then, in Section 4.2, we report on empirical figures obtained from an implementation of the solution.


                        Computation. Suppose there exist l message blocks. In the TagGen phase, the patient needs 1 pairing, 
                           
                              2
                              l
                           
                         exponentiations and l multiplications over 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           
                        . In the CheckTag phase, CS needs 1 pairing, 
                           
                              2
                              l
                           
                         exponentiations and l multiplications. In the GroupBarter phase, every member needs 
                           
                              2
                              (
                              t
                              -
                              1
                              )
                           
                         exponentiations and STNP needs t multiplications. In the GenProof phase, CS needs l exponentiations and 
                           
                              l
                              -
                              1
                           
                         multiplications. In the Verify phase, the hospital needs 3 pairings, 
                           
                              l
                              +
                              1
                           
                         exponentiations and l multiplications. In the Verify-Retrieve phase, the members need 3 pairings, 
                           
                              2
                              l
                              +
                              1
                           
                         exponentiations and 
                           
                              2
                              l
                              -
                              1
                           
                         multiplications. Other operations, such as hashing, exponentiation, and multiplication in the group 
                           
                              
                                 
                                    Z
                                 
                                 
                                    q
                                 
                                 
                                    ∗
                                 
                              
                           
                        , are omitted since they just contribute a negligible computation cost compared with the cost of the multiplication and exponentiation operations in 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           
                        . This previously listed computational costs are totally tolerable with current computing devices.


                        Communication. The communication overhead mostly comes from the queries and responses. In the hospital query phase, if the number of queried blocks is 
                           
                              
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                           
                        , the hospital needs to send 
                           
                              
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              +
                              2
                           
                         elements in 
                           
                              
                                 
                                    Z
                                 
                                 
                                    q
                                 
                                 
                                    ∗
                                 
                              
                           
                         to CS. In the response, CS needs to send 1 element in 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           
                         and 1 element in 
                           
                              
                                 
                                    Z
                                 
                                 
                                    q
                                 
                                 
                                    ∗
                                 
                              
                           
                         to the hospital. In the member query phase, if the number of queried blocks is l, every member needs to send l elements in 
                           
                              
                                 
                                    Z
                                 
                                 
                                    q
                                 
                                 
                                    ∗
                                 
                              
                           
                         to CS. In the response, CS needs to send l elements in 
                           
                              
                                 
                                    Z
                                 
                                 
                                    q
                                 
                                 
                                    ∗
                                 
                              
                           
                         to the members. This communication overhead is totally tolerable with current communication technology.

In order to study the performance of our scheme, we have implemented a prototype. The tests were run on an ASUS S56C Laptop with the following settings:
                           
                              •
                              CPU: Intel Core i7-3517U @ 1.90GHz.

Physical Memory: 4GB DDR3 1600MHz.

OS: Ubuntu 13.04 Linux 3.8.0-19-generic SMP i686.

Our code was written in Java7, using the java-7-openjdk-i386 environment. Java is slower than, for example, C when it comes to high-demand computations, but, considering that parts of this protocol might be run in mobile devices and that some of the most important cloud service providers run their systems in Java, the choice of this environment is reasonable.

We used the Java Pairing Based Cryptography Library (jPBC, [27]), which is a port of the PBC library [28]. Our choice of elliptic curve was Type A (see Chapter 8 of [29]), with 
                           
                              |
                              r
                              |
                              =
                              160
                           
                         bits and 
                           
                              |
                              q
                              |
                              =
                              512
                           
                         bits, making elements in 
                           
                              
                                 
                                    Z
                                 
                                 
                                    q
                                 
                                 
                                    ☆
                                 
                              
                           
                         160bits long and elements in 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           
                         1024bits long. Considering a scenario with l message blocks and t members in the committee, we present the performance results for each of the actors of the protocol, namely the patients, the CS, the hospital and the STNP, for different values of l and t. Note that the jPBC library allows precomputation of operations, thereby trading storage capacity for speed in the computations. Based on two cases, with or without precomputation, Fig. 3
                         depicts the computation time for the patient and Fig. 4
                         depicts the computation time for the hospital. X-label denotes the file block number and Y-label denotes the computation time (ms) for the patient and the hospital. The computation times for the members with and without precomputation are depicted in Figs. 5 and 6
                        
                        , respectively. X-label denotes the file block number and Y-label denotes the computation time (ms) for committee members. After that, the computation times for the STNP and for the cloud service are depicted in Figs. 7 and 8
                        
                        , respectively. In Fig. 7, X-label denotes the number of committee members and Y-label denotes the computation time (ms) for STNP. In Fig. 8, X-label denotes the file block number and Y-label denotes the computation time (ms) for CS.

In order to show the feasibility of our proposed scheme in concrete terms, we consider a more realistic case for a hospital. We assume the one-day transactions of a hospital take 1GB. These data will be stored in CS. Let the hash function 
                           
                              
                                 
                                    h
                                 
                                 
                                    1
                                 
                              
                           
                         be SHA-1, which maps 1MB to 160bits. Thus, the 1GB data can be split into 1024 blocks of 1MB each. According to the implementation, for 1024 blocks, every entity’s time cost is given below: (1) The patient’s time cost is 5025ms=5.025s with precomputation and 34,163ms=34.163s without precomputation. (2) The hospital’s time cost is 2565ms=2.565s with precomputation and 17034ms=17.034s without precomputation. (3) When there are 8 members, every member’s time cost is 5106ms=5.106s with precomputation and 34176ms=34.176s without precomputation. (4) CS’s time cost is 7265ms=7.265s with precomputation and 51,159ms=51.159s without precomputation. The implementation results show that our proposed protocol is practical. Compared to the other remote data integrity checking schemes [30,31], our scheme has better efficiency. When the data are 1GB, they are split into 1024 blocks in our scheme while they will be split into 
                           
                              8
                              ×
                              1024
                              ×
                              1024
                              ×
                              1024
                              /
                              160
                              =
                              
                                 
                                    51.2
                                 
                                 
                                    2
                                 
                              
                           
                         blocks in Refs. [30,31]. A larger block number results in lower efficiency. On the other hand, besides remote data integrity checking, our scheme has also another important security property, fair remote remote data retrieval, not offered by [30,31].

@&#CONCLUSION@&#

In this paper, we have proposed an efficient pairing-based FRR scheme which can check and retrieve remote data between untrusted members. We formally proved that the scheme is secure under the standard CDH assumption. Our performance analysis and implementation show that our scheme is efficient.

Thanks go to Alberto Blanco for his help with the simulations. This work was partly supported by the NSF of China through Projects (Nos. 61272522, 61173154, 61370190, 61003214), the Open Project of Shanghai Key Laboratory of Trustworthy Computing (No. 07dz22304201306), and by the Spanish Government through projects TIN2011-27076-C03-01 “CO-PRIVACY” and CONSOLIDER INGENIO 2010 CSD2007-00004 “ARES”, by the Government of Catalonia under Grant 2009 SGR 1135, by the European Commission under FP7 projects “DwB” and “Inter-Trust”. The last author is partially supported as an ICREA-Acadèmia researcher by the Catalan Government; he leads the UNESCO Chair in Data Privacy, but this paper does not necessarily reflect the position of UNESCO nor does it commit that organization.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.jbi.2014.02.008.


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

