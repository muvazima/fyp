@&#MAIN-TITLE@&#Mathematical model in left ventricle segmentation

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           A parametric model of the left ventricle is presented.


                        
                        
                           
                           Bézier curves are used to model the left ventricle shape.


                        
                        
                           
                           The model improves the results obtained by other segmentation algorithms.


                        
                        
                           
                           The presented algorithm is fully automatic.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Cardiac MRI

Left ventricle

Automatic segmentation

Parametric model

Model-based segmentation

@&#ABSTRACT@&#


               
               
                  In this paper a parametric model of the left ventricle is presented. Its task is to estimate the myocardium shape on those slices, on which the segmentation algorithm has outlined the structure incorrectly. The aim of using the model on improperly segmented slices is to improve the accuracy of computing cardiac hemodynamic parameters and the heart mass. The proposed model works with any segmentation algorithm. The usefulness of the model is the largest while determining the myocardium at end-systole and calculating the heart mass. In case of the segmentation algorithm applied in this study, the error decreased from clinically unacceptable to acceptable after using the presented model.
               
            

@&#INTRODUCTION@&#

Due to the large share of heart diseases in mortality statistics the importance of cardiac condition diagnostic has increased significantly. It is usually assessed on the basis of the values of hemodynamic parameters. The most commonly performed cardiac test is MRI, which is a non-invasive, yet accurate technique [1,2].

Currently, it is a common practice to outline the contour of the left ventricle at each slice. An expert usually needs about one and a half to two hours to manually delineate 10–14 slices with a resolution of 256×256 for each phase of the cardiac cycle, which are usually recorded in the number of 16–24 [3]. Automated assessment of the heart condition would shorten the specialist׳s work time and therefore accelerate the diagnostic process. The beneficients of such solution are both doctors and patients and, in the long term, also institutions financing the examinations. However, fully automatic segmentation methods are often a source of errors – there occur areas that are undersegmented or incorrectly included in the wanted structure.

An important and difficult step of image diagnostics is the segmentation of anatomical structures and lesions. The segmentation quality is the most important factor determining the accuracy of the parametric description of the examined organ. A common problem in dynamic studies is blurred outlines of the structures. This phenomenon is observed inter alia in cardiac diagnostics.

Most of the currently developed cardiac MRI segmentation methods, that have practical applications, are semi-automatic methods. Intelligent scissors may serve as an example of an approach that permits a starting point to be marked by a user [4,5].

A fully automated approach implies the need of developing a methodology for determining initial conditions. However, not involving qualified specialists results in limited functionality or accuracy.

Techniques often applied in cardiac segmentation are regions of interest growing and mathematical morphology operations [6–9]. Algorithms presented in [10,11] use contours propagation. The segmentation of the left ventricle can also be based on active contours [12–14]. In [15,16] Graph Searching has been used. Examples of using Graph Cuts for segmentation can be found in [17–19]. Attempts have been also made to apply artificial neural networks for left ventricle segmentation purposes [20,21].

Popular segmentation algorithms tend to oversegment on cardiac magnetic resonance images and attempt to avoid this problem result in undersegmented areas. Methods suitable for particular data type often do not give good results in case of changing any imaging parameter. Furthermore, methods completely devoid of medical intervention (better from the user׳s point of view) usually segment the desired structures with less accuracy than methods initialized or even fully supervised by a specialist.

Another common approach, presented inter alia in [22–26], proposes the use of deformable models of the left ventricle. Paper [27] introduces a deformable “balloon” model. Active appearance models, which have been used in [28,29], can be found in the literature as well. An active shape model of the left ventricle has been presented in [30]. The authors of [31] have proposed the Deformable Elastic Template (DET), whereas in [32] the Optimized Nonrigid Temporal Model has been introduced. The paper [33] is an example of a combination of two processes: a global preliminary estimation of the location of the left ventricle and a local deformation of the shape.

However, it should be noticed that most of the methods that use a priori models of the organ work on the basis of iterative-evolutionary algorithms. Their disadvantage is that calculations may stop at a local minimum, not achieving the global extreme. Myocardial segmentation results are therefore often burdened with significant errors [21,34], important from the diagnostic point of view [35,36].

The solution to this problem is the presented model of the left ventricle. It includes both the endocardium and the epicardium. Its task is to replace slices incorrectly segmented by an image processing algorithm, which can be arbitrarily chosen and implemented by the user. The model supports the segmentation, but does not replace it. The efficiency of the segmentation of each slice is verified using the proposed segmentation correctness coefficients. This approach combines the advantages of image processing techniques with basic knowledge about the organ shape. The presented model works with any segmentation algorithm. A flowchart of the presented framework is shown in Fig. 1
                     .

To assess the suitability of the model, a left ventricle segmentation algorithm had to be chosen. The proposed model has been used with segmentation results obtained with the method described in Section 2.3 
                     [37].

This paper is an extension of [38], where the model has been introduced. Here, an algorithm of fitting the model to available data is proposed. Segmentation correctness coefficients have been developed and improved by introducing three more coefficients (one additional for the analysis of the endocardium and two others for the epicardium). The building and the parameters of the model are presented.

The paper is organized as follows. In Section 2 the methodology has been described. In Section 3 the results has been presented and Section 4 includes conclusion.

@&#METHODS@&#

Automated left ventricle segmentation is frequently burdened with errors — usually undersegmented or oversegmented parts occur. The proposed segmentation correctness coefficients allow us to find (without user intervention) slices segmented incorrectly by any image processing algorithm. They divide all slices with respect to the correctness of the performed segmentation.

For each slice a segmentation correctness coefficient is calculated and its value determines whether the given slice was properly or improperly segmented (Fig. 2
                        ). Incorrect segmentations are replaced with ellipses obtained using the model (Fig. 3
                        ).

The analysis of common left ventricle segmentation errors leads to defining various SCCs for endocardium and epicardium with different threshold values for end-diastole and end-systole.

The segmentation correctness coefficient for endocardium (SCC
                              n
                           ) is a pair of numbers λ
                           1 and λ
                           2:
                              
                                 (1)
                                 
                                    
                                       
                                          SCC
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    i
                                    )
                                    =
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    i
                                    )
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    i
                                    )
                                    )
                                    ,
                                 
                              
                           where i is the slice number.

The endocardium is considered as incorrectly segmented on the i-th slice when both 
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              (
                              i
                              )
                            and 
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              (
                              i
                              )
                            exceed their threshold (values presented in Section 3).

For the first slice 
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              (
                              1
                              )
                              =
                              0
                           . For subsequent slices 
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              (
                              i
                              )
                            is equal to the area of the part of the segmented structure on the i-th slice, that did not belong to the endocardium on the last properly segmented contour (red area in Fig. 4
                           ), divided by the total area of the structure on the i-th slice (blue area in Fig. 4).

The value of 
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              (
                              i
                              )
                              =
                              
                                 
                                    h
                                 
                                 
                                    e
                                 
                              
                              (
                              i
                              )
                              /
                              
                                 
                                    r
                                 
                                 
                                    e
                                 
                              
                              (
                              i
                              )
                            is the maximum of the distance h
                           
                              e
                            between the segmented contour on the i-th slice and the circumscribed ellipse, divided by the radius of the ellipse r
                           
                              e
                           , measured at the point belonging to the straight line crossing the center of the ellipse and the given contour point (Fig. 5
                           ).

The coefficient that helps to assess the correctness of the epicardium segmentation (
                              
                                 
                                    SCC
                                 
                                 
                                    p
                                 
                              
                           ) is, likewise the opposite myocardium wall, a pair of numbers (λ
                           3 and λ
                           4):
                              
                                 (2)
                                 
                                    
                                       
                                          SCC
                                       
                                       
                                          p
                                       
                                    
                                    (
                                    i
                                    )
                                    =
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    i
                                    )
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          4
                                       
                                    
                                    (
                                    i
                                    )
                                    )
                                    ,
                                 
                              
                           where i is the slice number.

The epicardium is considered as incorrectly segmented on the i-th slice if 
                              
                                 
                                    λ
                                 
                                 
                                    3
                                 
                              
                              (
                              i
                              )
                            or 
                              
                                 
                                    λ
                                 
                                 
                                    4
                                 
                              
                              (
                              i
                              )
                            exceeds its threshold (values presented in Section 3).


                           
                              
                                 
                                    λ
                                 
                                 
                                    3
                                 
                              
                              (
                              i
                              )
                            is the ratio of the epicardium area on the i-th slice calculated before applying the convex hull [39] (orange area in Fig. 6
                           ) and the area of the structure with the convex hull (blue area in Fig. 6).

The value of 
                              
                                 
                                    λ
                                 
                                 
                                    4
                                 
                              
                              (
                              i
                              )
                            is the ratio of the semi-major axis and the semi-minor axis of the ellipse, inscribed in the segmented epicardium on the i-th slice (Fig. 7
                           ).

The model has been developed on the basis of MR cardiac images. In each contour outlined by an expert (Fig. 8
                        a) an ellipse has been inscribed (Fig. 8b). Then the variability of the parameters of those figures has been studied (Fig. 9
                        ). Finding the most repetitive dependencies has made it possible to estimate the parameters of the ellipses, that should replace the myocardium contour on those slices, on which the segmentation correctness coefficients values indicate such necessity.

The two key parameters of an ellipse are the lengths of the semi-axes. They impact the ellipse area and consequently the values of the parameters describing the condition of the heart muscle as well. Calculating the center of the ellipse and its rotation angle is important mostly for visualization purposes.

In order to determine the dependencies between the ellipses parameters, a number of analyses have been performed. Variability has been studied in subsequent slices of the cardiac cycle for a fixed myocardium wall as well as in subsequent slices of the epicardium and endocardium for a fixed phase of the cardiac cycle. The mutual relations between those parameters at end-diastole and end-systole have also been examined with respect to the slice number.

In the following part of the paper the semi-major axes are denoted with the symbol a and the semi-minor axes with symbol b. Subscripts of the variables occurring in following equations refer to n the endocardium, p the epicardium, d the end-diastole, and s the end-systole.

Analysis of the parameters graphs (Figs. 10 and 11
                        
                        ) has led to the conclusion that both the semi-major axes course and the 
                           
                              
                                 b
                              
                              
                                 n
                                 ,
                                 d
                              
                           
                         parameter course should be in all cases approximated with a parametric curve L(t), in particular with the Beziér curve of degree 2:
                           
                              (3)
                              
                                 L
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       0
                                    
                                 
                                 ⁎
                                 
                                    
                                       (
                                       1
                                       −
                                       t
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 2
                                 ⁎
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 ⁎
                                 t
                                 ⁎
                                 (
                                 1
                                 −
                                 t
                                 )
                                 +
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 ⁎
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 t
                                 ∈
                                 [
                                 0
                                 ;
                                 1
                                 ]
                              
                           
                        where P
                        
                           i
                         is the i-th control point.

Curve L(t) can be also considered as a fusion of two coordinates, which results in the following formula:
                           
                              (4)
                              
                                 L
                                 (
                                 t
                                 )
                                 =
                                 [
                                 p
                                 (
                                 t
                                 )
                                 ,
                                 q
                                 (
                                 t
                                 )
                                 ]
                                 .
                              
                           
                        
                     

The first and the third control point are the first and the last point of the graph, respectively, numbered according to the slice number:
                           
                              (5)
                              
                                 
                                    
                                       P
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 sma
                                 (
                                 1
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 sma
                                 (
                                 l
                                 )
                                 ,
                              
                           
                        where sma is any semi-major axis or semi-minor axis for endocardium at end-systole and l is the number of slices registered for the given patient.

The position of the middle control point P
                        1 determines the shape of the curve. Its exact coordinates are a function of the number of arguments 
                           (
                           l
                           )
                         and the range of data values:
                           
                              (7)
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 (
                                 
                                    i
                                    ·
                                    l
                                    ,
                                    
                                       
                                          min
                                       
                                       
                                          1
                                          ≤
                                          k
                                          ≤
                                          l
                                       
                                    
                                    (
                                    sma
                                    (
                                    k
                                    )
                                    )
                                    +
                                    j
                                    ·
                                    (
                                    
                                       
                                          
                                             max
                                          
                                          
                                             1
                                             ≤
                                             k
                                             ≤
                                             l
                                          
                                       
                                       (
                                       sma
                                       (
                                       k
                                       )
                                       )
                                       −
                                       
                                          
                                             min
                                          
                                          
                                             1
                                             ≤
                                             k
                                             ≤
                                             l
                                          
                                       
                                       (
                                       sma
                                       (
                                       k
                                       )
                                       )
                                    
                                    )
                                 
                                 )
                                 ,
                              
                           
                        where 
                           i
                           ,
                           j
                         are the coefficients for which the curve matches best the real data used to build the model.

The process of determining values of the coefficients 
                           i
                           ,
                           j
                         was the same for each parameter in which course has been approximated with the curve L(t). The best set consists of values, that minimize the sum of distances between consecutive values of the appropriate semi-axis and the curve (Fig. 12
                        ) using the Hooke–Jeeves optimization method [40].

The course of 
                           
                              
                                 b
                              
                              
                                 n
                                 ,
                                 s
                              
                           
                         exhibited a linear character (Fig. 13
                        ). Due to this fact, a straight line should be used for approximation. Average approximation error has not exceeded 2 pixels. Attempts to model the course with a Beziér curve of degree 2 have been a source of larger mean square errors than the proposed solution.

In case of the epicardium, a dependency between the respective lengths of the semi-major 
                           
                              
                                 a
                              
                              
                                 p
                                 ,
                                 d
                              
                           
                        , 
                           
                              
                                 a
                              
                              
                                 p
                                 ,
                                 s
                              
                           
                         and semi-minor axes 
                           
                              
                                 b
                              
                              
                                 p
                                 ,
                                 d
                              
                           
                        , 
                           
                              
                                 b
                              
                              
                                 p
                                 ,
                                 s
                              
                           
                         has been noticed. This dependency can be modeled with a constant (Fig. 14
                        ). When developing the model, first curve-fitting has been performed in all cases, however, it turned out that the use of the ratio implies better results than using a curve. The proposed solution minimizes fitting errors, which has been confirmed by experiment results. In addition, the computational cost is lower.

The center of the ellipse and its rotation angle are calculated using the regression line, thus they are approximated with a polynomial of the first degree. These lines are adjusted to appropriate centers׳ coordinates and rotation angles of ellipses inscribed in properly segmented slices. Approximation is used due to the fact that the ellipses centers inscribed in expert outlines have changed for both coordinates by no more than 2 pixels.

The model has to be rescaled to fit the properly segmented slices best (Fig. 15
                           ). Both semi-axes are considered independently and the parametric curves that build the model can be stretched out or compressed.

First, an auxiliary reference Beziér curve of degree 2 R(t) with the following control points is constructed:
                              
                                 (8)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    (
                                    1
                                    ,
                                    1
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (9)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    (
                                    i
                                    ·
                                    l
                                    ,
                                    j
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (10)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    (
                                    l
                                    ,
                                    0
                                    )
                                    .
                                 
                              
                           
                        

Therefore
                              
                                 (11)
                                 
                                    R
                                    (
                                    t
                                    )
                                    =
                                    (
                                    1
                                    ,
                                    1
                                    )
                                    ·
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    2
                                    ·
                                    (
                                    i
                                    ·
                                    l
                                    ,
                                    j
                                    )
                                    ·
                                    t
                                    ·
                                    (
                                    1
                                    −
                                    t
                                    )
                                    +
                                    (
                                    l
                                    ,
                                    0
                                    )
                                    ·
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    (
                                    
                                       1
                                       −
                                       2
                                       t
                                       +
                                       2
                                       ilt
                                       +
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             lt
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       2
                                       
                                          
                                             ilt
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       1
                                       −
                                       2
                                       t
                                       +
                                       2
                                       jt
                                       +
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       2
                                       
                                          
                                             jt
                                          
                                          
                                             2
                                          
                                       
                                    
                                    )
                                    =
                                    (
                                    
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       t
                                       )
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                    )
                                    .
                                 
                              
                           
                        

Let 
                              
                                 
                                    C
                                 
                                 
                                    q
                                    ,
                                    u
                                 
                              
                            denote an increasingly ordered set of layers numbers on which the segmentation of the fixed myocardium wall q at moment u has been performed properly, whereas 
                              
                                 
                                    D
                                 
                                 
                                    q
                                    ,
                                    u
                                 
                              
                            includes those slices numbers on which the SCC has not exceeded the threshold value thresh: 
                              
                                 
                                    ∀
                                    q
                                    ∈
                                    {
                                    n
                                    ,
                                    p
                                    }
                                    ,
                                    
                                    ∀
                                    u
                                    ∈
                                    {
                                    d
                                    ,
                                    s
                                    }
                                 
                              
                           
                           
                              
                                 (12)
                                 
                                    
                                       
                                          C
                                       
                                       
                                          q
                                          ,
                                          u
                                       
                                    
                                    =
                                    {
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    :
                                    1
                                    ≤
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    ≤
                                    l
                                    ∧
                                    [
                                    
                                       (
                                       j
                                       <
                                       k
                                       )
                                       ⇒
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             j
                                          
                                       
                                       <
                                       
                                          
                                             c
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    ]
                                    ∧
                                    
                                       
                                          SCC
                                       
                                       
                                          q
                                          ,
                                          u
                                       
                                    
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ≥
                                    thresh
                                    (
                                    q
                                    ,
                                    u
                                    )
                                    }
                                    ,
                                 
                              
                           
                           
                              
                                 (13)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          q
                                          ,
                                          u
                                       
                                    
                                    =
                                    {
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    :
                                    1
                                    ≤
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    ≤
                                    l
                                    ∧
                                    
                                       
                                          SCC
                                       
                                       
                                          q
                                          ,
                                          u
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    <
                                    thresh
                                    (
                                    q
                                    ,
                                    u
                                    )
                                    }
                                    .
                                 
                              
                           
                        

Let qu denote the cardinality of the set 
                              
                                 
                                    C
                                 
                                 
                                    q
                                    ,
                                    u
                                 
                              
                           :
                              
                                 (14)
                                 
                                    qu
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      q
                                                      ,
                                                      u
                                                   
                                                
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          ¯
                                       
                                    
                                    ,
                                 
                              
                           
                        

It is assumed that in each case at least 4 proper contours are given (
                              n
                              ≥
                              4
                           ). If the number of correctly segmented slices would be less than or equal to 3, an expert should outline the myocardium manually in order to fulfill that condition. To determine the stretch of the curve L(t) along the ordinate axis, the following coefficients have to be calculated:
                              
                                 (15)
                                 
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    sma
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    −
                                    sma
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          qu
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (16)
                                 
                                    
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    sma
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    −
                                    sma
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          qu
                                          −
                                          1
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (17)
                                 
                                    
                                       
                                          g
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    sma
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    −
                                    sma
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          qu
                                          −
                                          2
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (18)
                                 
                                    
                                       
                                          g
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    sma
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    −
                                    sma
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          qu
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (19)
                                 
                                    
                                       
                                          g
                                       
                                       
                                          5
                                       
                                    
                                    =
                                    sma
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    −
                                    sma
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          qu
                                          −
                                          1
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (20)
                                 
                                    
                                       
                                          g
                                       
                                       
                                          6
                                       
                                    
                                    =
                                    sma
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          3
                                       
                                    
                                    )
                                    −
                                    sma
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          qu
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (21)
                                 
                                    
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          r
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          r
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    
                                       
                                          
                                             c
                                          
                                          
                                             qu
                                          
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (22)
                                 
                                    
                                       
                                          h
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          r
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          r
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    
                                       
                                          
                                             c
                                          
                                          
                                             qu
                                             −
                                             1
                                          
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (23)
                                 
                                    
                                       
                                          h
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    
                                       
                                          r
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          r
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    
                                       
                                          
                                             c
                                          
                                          
                                             qu
                                             −
                                             2
                                          
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (24)
                                 
                                    
                                       
                                          h
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    
                                       
                                          r
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          r
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    
                                       
                                          
                                             c
                                          
                                          
                                             qu
                                          
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (25)
                                 
                                    
                                       
                                          h
                                       
                                       
                                          5
                                       
                                    
                                    =
                                    
                                       
                                          r
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          r
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    
                                       
                                          
                                             c
                                          
                                          
                                             qu
                                             −
                                             1
                                          
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (26)
                                 
                                    
                                       
                                          h
                                       
                                       
                                          6
                                       
                                    
                                    =
                                    
                                       
                                          r
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    
                                       
                                          
                                             c
                                          
                                          
                                             3
                                          
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          r
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    
                                       
                                          
                                             c
                                          
                                          
                                             qu
                                          
                                       
                                    
                                    )
                                 
                              
                           where
                              
                                 (27)
                                 
                                    
                                       
                                          r
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    c
                                    )
                                    =
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          
                                             c
                                             −
                                             1
                                          
                                          
                                             l
                                             −
                                             1
                                          
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        

The next step is to determine the average quotient of coefficients g
                           
                              i
                            and h
                           
                              i
                           :
                              
                                 (28)
                                 
                                    λ
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          6
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          6
                                       
                                    
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

The new curve 
                              
                                 
                                    L
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                            is scaled according to the values of the reference curve and the coefficient d, introduced to compensate too small size of ellipses, resulting from inscribing them into contours with rough edges:
                              
                                 (29)
                                 
                                    
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                    =
                                    (
                                    
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       t
                                       )
                                       ,
                                       d
                                       ·
                                       λ
                                       ·
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                    )
                                    ,
                                    
                                    t
                                    ∈
                                    [
                                    0
                                    ;
                                    1
                                    ]
                                    .
                                 
                              
                           
                        

In order to calculate the scaling coefficient d, an expert has drawn an ellipse, which, in their opinion, replicated the wanted shape best on each properly segmented slice from the learning set. Each expert׳s outline has been compared with an appropriate ellipse inscribed into the correctly segmented contour. Coefficient d has been calculated as the mean of the respective semi-axes.

According to the above formula ordinates of 
                              
                                 
                                    L
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                            are within 
                              [
                              0
                              ,
                              1
                              ]
                           . In the result the process of curve fitting to the data also requires the translation of the resulting functions by vector 
                              [
                              0
                              ,
                              δ
                              ]
                           . For this purpose, the average distance between all points obtained through the properly segmented contours processing and the corresponding points of curve 
                              
                                 
                                    L
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                            is calculated:
                              
                                 (30)
                                 
                                    δ
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    |
                                    sma
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    λ
                                    ·
                                    
                                       
                                          r
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                    
                                    )
                                    |
                                    ,
                                 
                              
                           thus the new, fitted curve 
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              (
                              t
                              )
                            should be computed by the formula:
                              
                                 (31)
                                 
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    t
                                    )
                                    =
                                    (
                                    
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       t
                                       )
                                       ,
                                       d
                                       ·
                                       λ
                                       ·
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       t
                                       )
                                       +
                                       δ
                                    
                                    )
                                    =
                                    (
                                    
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       t
                                       )
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                    )
                                    ,
                                    
                                    t
                                    ∈
                                    [
                                    0
                                    ;
                                    1
                                    ]
                                    .
                                 
                              
                           
                        

Values obtained with the model are denoted using a “hat”, (i.e. 
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          p
                                          ,
                                          r
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           ), whereas other variables refer to the values of the parameters of ellipses inscribed in the properly segmented slices.

Assuming that the curves 
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              (
                              t
                              )
                            obtained for the semi-axes for a fixed cardiac cycle phase and a fixed myocardium wall are denoted: 
                              
                                 
                                    L
                                 
                                 
                                    2
                                    ,
                                    a
                                    ,
                                    p
                                    ,
                                    d
                                 
                              
                              (
                              t
                              )
                           , 
                              
                                 
                                    L
                                 
                                 
                                    2
                                    ,
                                    a
                                    ,
                                    p
                                    ,
                                    s
                                 
                              
                              (
                              t
                              )
                           , 
                              
                                 
                                    L
                                 
                                 
                                    2
                                    ,
                                    a
                                    ,
                                    n
                                    ,
                                    d
                                 
                              
                              (
                              t
                              )
                           , 
                              
                                 
                                    L
                                 
                                 
                                    2
                                    ,
                                    a
                                    ,
                                    n
                                    ,
                                    s
                                 
                              
                              (
                              t
                              )
                           , 
                              
                                 
                                    L
                                 
                                 
                                    2
                                    ,
                                    b
                                    ,
                                    n
                                    ,
                                    d
                                 
                              
                              (
                              t
                              )
                           , an algorithm of computing the parameters of the necessary ellipses is proposed:
                              
                                 (32)
                                 
                                    ∀
                                    q
                                    ∈
                                    {
                                    n
                                    ,
                                    p
                                    }
                                    ,
                                    
                                    ∀
                                    u
                                    ∈
                                    {
                                    d
                                    ,
                                    s
                                    }
                                    ,
                                    
                                    ∀
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    
                                       
                                          D
                                       
                                       
                                          q
                                          ,
                                          u
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                q
                                                ,
                                                u
                                             
                                          
                                       
                                       
                                          ^
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          L
                                       
                                       
                                          2
                                          ,
                                          a
                                          ,
                                          q
                                          ,
                                          u
                                       
                                    
                                    ○
                                    
                                       
                                          r
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (33)
                                 
                                    ∀
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    
                                       
                                          D
                                       
                                       
                                          n
                                          ,
                                          d
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                n
                                                ,
                                                d
                                             
                                          
                                       
                                       
                                          ^
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          L
                                       
                                       
                                          2
                                          ,
                                          b
                                          ,
                                          n
                                          ,
                                          d
                                       
                                    
                                    ○
                                    
                                       
                                          r
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        

The length of the semi-minor axis in case of estimating the epicardium shape is approximated on the basis of the quotient a/b for consecutive slices:
                              
                                 (34)
                                 
                                    ∀
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    
                                       
                                          D
                                       
                                       
                                          p
                                          ,
                                          r
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                p
                                                ,
                                                r
                                             
                                          
                                       
                                       
                                          ^
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      p
                                                      ,
                                                      r
                                                   
                                                
                                             
                                             
                                                ^
                                             
                                          
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ab
                                                ,
                                                p
                                                ,
                                                r
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (35)
                                 
                                    ∀
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    
                                       
                                          D
                                       
                                       
                                          p
                                          ,
                                          s
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                p
                                                ,
                                                s
                                             
                                          
                                       
                                       
                                          ^
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      p
                                                      ,
                                                      s
                                                   
                                                
                                             
                                             
                                                ^
                                             
                                          
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ab
                                                ,
                                                p
                                                ,
                                                s
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

The length of the semi-minor axes of the ellipses for the endocardium at end-systole is calculated as follows: 
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    ≠
                                    1
                                    ⇒
                                    ∀
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    
                                       
                                          D
                                       
                                       
                                          n
                                          ,
                                          s
                                       
                                    
                                    :
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    <
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           
                           
                              
                                 (36)
                                 
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                n
                                                ,
                                                s
                                             
                                          
                                       
                                       
                                          ^
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          n
                                          ,
                                          s
                                       
                                    
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                n
                                                ,
                                                s
                                             
                                          
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          −
                                          
                                             
                                                b
                                             
                                             
                                                n
                                                ,
                                                s
                                             
                                          
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ·
                                    (
                                    
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             d
                                          
                                          
                                             i
                                          
                                       
                                    
                                    )
                                    ,
                                    ∀
                                    i
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    (
                                    ns
                                    −
                                    1
                                    )
                                    }
                                 
                              
                           
                           
                              
                                 (37)
                                 
                                    [
                                    
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       >
                                       1
                                       )
                                       ⇒
                                       ∀
                                       
                                          
                                             d
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             D
                                          
                                          
                                             n
                                             ,
                                             s
                                          
                                       
                                       :
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       <
                                       
                                          
                                             d
                                          
                                          
                                             j
                                          
                                       
                                       <
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   n
                                                   ,
                                                   s
                                                
                                             
                                          
                                          
                                             ^
                                          
                                       
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             b
                                          
                                          
                                             n
                                             ,
                                             s
                                          
                                       
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   n
                                                   ,
                                                   s
                                                
                                             
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             )
                                             −
                                             
                                                
                                                   b
                                                
                                                
                                                   n
                                                   ,
                                                   s
                                                
                                             
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       ·
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    ]
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ns
                                       
                                    
                                    ≠
                                    l
                                    ⇒
                                    ∀
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    
                                       
                                          D
                                       
                                       
                                          n
                                          ,
                                          s
                                       
                                    
                                    :
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    >
                                    
                                       
                                          c
                                       
                                       
                                          ns
                                       
                                    
                                 
                              
                           
                           
                              
                                 (38)
                                 
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                n
                                                ,
                                                s
                                             
                                          
                                       
                                       
                                          ^
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          n
                                          ,
                                          s
                                       
                                    
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          ns
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                n
                                                ,
                                                s
                                             
                                          
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                ns
                                             
                                          
                                          )
                                          −
                                          
                                             
                                                b
                                             
                                             
                                                n
                                                ,
                                                s
                                             
                                          
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                ns
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ns
                                             
                                          
                                          −
                                          
                                             
                                                c
                                             
                                             
                                                ns
                                                −
                                                1
                                             
                                          
                                       
                                    
                                    ·
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          c
                                       
                                       
                                          ns
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        

The selected segmentation algorithm is based on Kernelized Fuzzy C-Means method [41] and has been modified in order to compute the best possible endocardium and epicardium outlines on MR images. 
                           Algorithm 1
                           KWCM-based segmentation algorithm. 
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                                Input: Cardiac MRI images at end-diastole and end-systole
                                          
                                          
                                             
                                             
                                                Output: Segmented contours of the myocardium
                                          
                                          
                                             
                                                1
                                             
                                             Divide 3D cardiac image at end-diastole using KWCM into 4 groups
                                          
                                          
                                             
                                                2
                                             
                                             Create a mask of the elements belonging to the 1st or 2nd group
                                          
                                          
                                             
                                                3
                                             
                                             Find 2 largest 6-coherent objects: N
                                                1 and N
                                                2
                                             
                                          
                                          
                                             
                                                4
                                             
                                             
                                                while 
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   >
                                                   10
                                                   %
                                                 
                                                of the image and 
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   >
                                                   25
                                                   %
                                                 
                                                of the image 
                                                do
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            5
                                                         
                                                      
                                                      
                                                         
                                                            6
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⌊
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               Perform
                                                               
                                                               erosion
                                                               
                                                               by
                                                               
                                                               a
                                                               
                                                               spherical
                                                               
                                                               structuring
                                                               
                                                               element
                                                               
                                                               of
                                                               
                                                               r
                                                               =
                                                               3
                                                            
                                                         
                                                         
                                                            
                                                               Find
                                                               
                                                               2
                                                               
                                                               largest
                                                               
                                                               6-coherent
                                                               
                                                               objects
                                                               :
                                                               
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               
                                                               and
                                                               
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                7
                                             
                                             
                                                foreach 
                                                object 
                                                do
                                             
                                          
                                          
                                             
                                                8
                                             
                                             
                                                
                                                   ⌊
                                                   
                                                      
                                                      Check
                                                      
                                                      the
                                                      
                                                      distance
                                                      
                                                      between
                                                      
                                                      the
                                                      
                                                      center
                                                      
                                                      of
                                                      
                                                      the
                                                      
                                                      mass
                                                      
                                                      and
                                                      
                                                      the
                                                      
                                                      center
                                                      
                                                      of
                                                      
                                                      the
                                                      
                                                      image
                                                   
                                                
                                             
                                          
                                          
                                             
                                                9
                                             
                                             Find the object closest to the center of image M
                                             
                                          
                                          
                                             
                                                10
                                             
                                             Lead two perpendicular lines, parallel to the image edges (l
                                                1 and l
                                                2) through the centroid of the cross section of object M on the first slice
                                          
                                          
                                             
                                                11
                                             
                                             Calculate the distances dist1 and dist2 between the object M and the closest object in the directions specified by l
                                                1 and l
                                                2
                                             
                                          
                                          
                                             
                                                12
                                             
                                             The thickness of the myocardium g
                                                
                                                   m
                                                 is 
                                                   min
                                                   (
                                                   
                                                      
                                                         dist
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         dist
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                13
                                             
                                             Delete all objects except M
                                             
                                          
                                          
                                             
                                                14
                                             
                                             
                                                
                                                   
                                                      
                                                         ROI
                                                      
                                                      
                                                         n
                                                         ,
                                                         r
                                                      
                                                   
                                                 is the object M dilated by a spherical structuring element of 
                                                   r
                                                   =
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                15
                                             
                                             Divide 3D cardiac image at end-diastole limited to 
                                                   
                                                      
                                                         ROI
                                                      
                                                      
                                                         n
                                                         ,
                                                         r
                                                      
                                                   
                                                 into 5 groups using KWCM
                                          
                                          
                                             
                                                16
                                             
                                             Create a mask of the elements belonging to the 1st or 2nd group
                                          
                                          
                                             
                                                17
                                             
                                             Find the largest coherent object and dilate it by a spherical structuring element of 
                                                   r
                                                   =
                                                   3
                                                 
                                                
                                                   (
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         n
                                                         ,
                                                         r
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                18
                                             
                                             
                                                foreach
                                                slice 
                                                do
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            19
                                                         
                                                      
                                                      
                                                         
                                                            20
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⌊
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               if
                                                               
                                                               Endocardium
                                                               
                                                               at
                                                               
                                                               end
                                                               -
                                                               diastole
                                                               
                                                               segmented
                                                               
                                                               incorrectly
                                                               
                                                               then
                                                            
                                                         
                                                         
                                                            
                                                               ⌊
                                                               
                                                                  
                                                                  Replace
                                                                  
                                                                  the
                                                                  
                                                                  slice
                                                                  
                                                                  with
                                                                  
                                                                  the
                                                                  
                                                                  model
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                21
                                             
                                             
                                                
                                                   
                                                      
                                                         ROI
                                                      
                                                      
                                                         n
                                                         ,
                                                         s
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         n
                                                         ,
                                                         r
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                22
                                             
                                             Divide 3D cardiac image at end-systole limited to 
                                                   
                                                      
                                                         ROI
                                                      
                                                      
                                                         n
                                                         ,
                                                         s
                                                      
                                                   
                                                 into 4 groups using KWCM
                                          
                                          
                                             
                                                23
                                             
                                             Create a mask of the elements belonging to the 1st or 2nd group
                                          
                                          
                                             
                                                24
                                             
                                             Find the largest coherent object and dilate it by a spherical structuring element of 
                                                   r
                                                   =
                                                   3
                                                 
                                                
                                                   (
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         n
                                                         ,
                                                         s
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                25
                                             
                                             
                                                foreach 
                                                slice 
                                                do
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            26
                                                         
                                                      
                                                      
                                                         
                                                            27
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⌊
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               if
                                                               
                                                               Endocardium
                                                               
                                                               at
                                                               
                                                               end
                                                               -
                                                               systole
                                                               
                                                               segmented
                                                               
                                                               incorrectly
                                                               
                                                               then
                                                            
                                                         
                                                         
                                                            
                                                               ⌊
                                                               
                                                                  
                                                                  Replace
                                                                  
                                                                  the
                                                                  
                                                                  slice
                                                                  
                                                                  with
                                                                  
                                                                  the
                                                                  
                                                                  model
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                28
                                             
                                             Divide 3D cardiac image at end-diastole into 4 groups using KWCM
                                          
                                          
                                             
                                                29
                                             
                                             Create a mask M
                                                1 of the elements belonging to the 3rd group
                                          
                                          
                                             
                                                30
                                             
                                             Limit mask M
                                                1 to the middle part of the left ventricle
                                          
                                          
                                             
                                                31
                                             
                                             
                                                
                                                   
                                                      
                                                         ROI
                                                      
                                                      
                                                         p
                                                         ,
                                                         r
                                                      
                                                   
                                                 is the object 
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         n
                                                         ,
                                                         r
                                                      
                                                   
                                                 dilated by a spherical structuring element of r=g
                                                
                                                   m
                                                , limited to the side part of the left ventricle
                                          
                                          
                                             
                                                32
                                             
                                             Divide 3D cardiac image at end-systole limited to 
                                                   
                                                      
                                                         ROI
                                                      
                                                      
                                                         p
                                                         ,
                                                         r
                                                      
                                                   
                                                 using KWCM into 5 groups
                                          
                                          
                                             
                                                33
                                             
                                             Create a mask M
                                                2 of the elements belonging to the 4th group
                                          
                                          
                                             
                                                34
                                             
                                             Create a mask M
                                                3 of the elements belonging to the endocardium at end-diastole or to mask M
                                                1 or to mask M
                                                2
                                             
                                          
                                          
                                             
                                                35
                                             
                                             Perform erosion by a spherical structuring element of 
                                                   r
                                                   =
                                                   3
                                                 on mask M
                                                3
                                             
                                          
                                          
                                             
                                                36
                                             
                                             Find the largest coherent object 
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         p
                                                         ,
                                                         r
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                37
                                             
                                             Delete other objects
                                          
                                          
                                             
                                                38
                                             
                                             Perform erosion by a spherical structuring element of 
                                                   r
                                                   =
                                                   3
                                                 on mask 
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         p
                                                         ,
                                                         r
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                39
                                             
                                             
                                                foreach 
                                                slice 
                                                do
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            40
                                                         
                                                      
                                                      
                                                         
                                                            41
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⌊
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               if
                                                               
                                                               Epicardium
                                                               
                                                               at
                                                               
                                                               end
                                                               -
                                                               diastole
                                                               
                                                               segmented
                                                               
                                                               incorrectly
                                                               
                                                               then
                                                            
                                                         
                                                         
                                                            
                                                               ⌊
                                                               
                                                                  
                                                                  Replace
                                                                  
                                                                  the
                                                                  
                                                                  slice
                                                                  
                                                                  with
                                                                  
                                                                  the
                                                                  
                                                                  model
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                42
                                             
                                             
                                                
                                                   
                                                      
                                                         ROI
                                                      
                                                      
                                                         p
                                                         ,
                                                         s
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         p
                                                         ,
                                                         r
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                43
                                             
                                             Divide 3D cardiac image at end-systole limited to ROI 
                                                   
                                                      
                                                      
                                                         p
                                                         ,
                                                         s
                                                      
                                                   
                                                 into 5 groups using KWCM
                                          
                                          
                                             
                                                44
                                             
                                             Create a mask M
                                                4 of the elements belonging to the 3rd or 4th group or to the endocardium at end-systole
                                          
                                          
                                             
                                                45
                                             
                                             Perform erosion by a spherical structuring element of 
                                                   r
                                                   =
                                                   2
                                                 on mask M
                                                4
                                             
                                          
                                          
                                             
                                                46
                                             
                                             Find the largest coherent object 
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         p
                                                         ,
                                                         s
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                47
                                             
                                             Delete other objects
                                          
                                          
                                             
                                                48
                                             
                                             Perform erosion by a spherical structuring element of 
                                                   r
                                                   =
                                                   2
                                                 on mask 
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         p
                                                         ,
                                                         s
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                49
                                             
                                             New 
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         p
                                                         ,
                                                         s
                                                      
                                                   
                                                 is the convex hull of 
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         p
                                                         ,
                                                         s
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                50
                                             
                                             
                                                foreach 
                                                slice 
                                                do
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            51
                                                         
                                                      
                                                      
                                                         
                                                            52
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⌊
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               if
                                                               
                                                               Epicardium
                                                               
                                                               at
                                                               
                                                               end
                                                               -
                                                               systole
                                                               
                                                               segmented
                                                               
                                                               incorrectly
                                                               
                                                               then
                                                            
                                                         
                                                         
                                                            
                                                               ⌊
                                                               
                                                                  
                                                                  Replace
                                                                  
                                                                  the
                                                                  
                                                                  slice
                                                                  
                                                                  with
                                                                  
                                                                  the
                                                                  
                                                                  model
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

@&#RESULTS@&#

The model has been developed on the basis of MR cardiac images, received from Cedars-Sinai Medical Center (CSMC) in Los Angeles, containing 2 series with expert outlines and from a database, available on the Internet, provided by the authors of [42], which contains series from 18 patients. In this database the contours of the left ventricle have been outlined by two independent experts.

10 studies (2 from CSMC and 8 from the Internet [42]) have created the learning base, which has been used to estimate the values of the modelparameters. The remaining 10 studies have served as the test base. Each series belonging to the test set consists of 22 or 25 3D images on which at least one full cardiac cycle has been recorded. The number of slices ranges from 24 to 44 in each series, which gives a total of 312 sections.

The selection of threshold values for the correctness coefficients SCC has been performed on the basis of a comparison of the obtained segmentation results [37] and the experts׳ outlines. For slices indicated by a user as improperly segmented, the SCCs have been calculated. Due to a large discrepancy between λ
                     1 values in the upper and the lower part of the ventricle, the SCC analysis of both regions has employed various threshold values. For λ
                     3 the minimum of the obtained values has been established as the threshold. In case of λ
                     1, λ
                     2 and λ
                     4 it has been the maximum.

The endocardium at end-diastole is considered to be properly segmented on the i-th slice, when the condition
                        
                           (39)
                           
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              <
                              0.04
                              ∨
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              <
                              0.35
                           
                        
                     is fulfilled.

In case of the endocardium at end-systole, for both λ coefficients there are two threshold values, depending on which half (upper or lower) of the heart is analyzed.

The endocardium at end-systole is correctly segmented if
                        
                           (40)
                           
                              {
                              
                                 
                                    
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                          <
                                          0.4
                                          ∨
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                          
                                          <
                                          0.2
                                       
                                       
                                          if
                                          
                                          i
                                          ≤
                                          l
                                          /
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                          <
                                          0.08
                                          ∨
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                          
                                          <
                                          0.5
                                       
                                       
                                          if
                                          
                                          i
                                          >
                                          l
                                          /
                                          2
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  

Properly segmented epicardium at end-diastole on the i-th slice is a contour, meeting the condition
                        
                           (41)
                           
                              
                                 
                                    λ
                                 
                                 
                                    3
                                 
                              
                              >
                              0.95
                              ∧
                              
                                 
                                    λ
                                 
                                 
                                    4
                                 
                              
                              <
                              1.3
                              ,
                           
                        
                     whereas in case of end-systole the condition is
                        
                           (42)
                           
                              
                                 
                                    λ
                                 
                                 
                                    3
                                 
                              
                              >
                              0.95
                              ∧
                              
                                 
                                    λ
                                 
                                 
                                    4
                                 
                              
                              <
                              1.2
                              .
                           
                        
                     
                  

Values of the coefficients i and j (used to build Beziér curves) obtained for each combination “myocardium wall — cardiac cycle phase” are presented in Table 1
                     .

Coefficient d has been computed as described in Section 2.2.1:
                        
                           (43)
                           
                              d
                              =
                              1
                              ,
                              1
                              .
                           
                        
                     
                  

Quotients 
                        
                           
                              a
                           
                           
                              p
                              ,
                              r
                           
                        
                      by 
                        
                           
                              b
                           
                           
                              p
                              ,
                              r
                           
                        
                      and 
                        
                           
                              a
                           
                           
                              p
                              ,
                              s
                           
                        
                      by 
                        
                           
                              b
                           
                           
                              p
                              ,
                              s
                           
                        
                      are almost constant (standard deviation did not exceed 0.05) and in both cases they oscillate around similar values:
                        
                           (44)
                           
                              
                                 
                                    b
                                 
                                 
                                    p
                                    ,
                                    r
                                 
                              
                              (
                              w
                              )
                              =
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          p
                                          ,
                                          r
                                       
                                    
                                    (
                                    w
                                    )
                                 
                                 
                                    1.1392
                                 
                              
                              
                              ,
                           
                        
                     
                     
                        
                           (45)
                           
                              
                                 
                                    b
                                 
                                 
                                    p
                                    ,
                                    s
                                 
                              
                              (
                              w
                              )
                              =
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          p
                                          ,
                                          s
                                       
                                    
                                    (
                                    w
                                    )
                                 
                                 
                                    1.1367
                                 
                              
                              
                              ,
                           
                        
                     where w is the slice number, l is the number of slices registered for the given patient.

While testing the model, the areas of endocardium and epicardium at end-diastole and end-systole obtained only by the segmentation algorithm and model-improved segmentation have been compared with the experts׳ outlines. The interobserver variability has been calculated as well. Tables 2–5
                     
                     
                     
                      present the results of those comparisons. In most cases using the model increased the similarity between the outcome and the expert׳s outline. It should be emphasized that in those cases, where the application of the model have not given any improvement, the differences have been very small. The examined values are the linear correlation coefficient between the results obtained with different methods (first expert, second expert, segmentation, model-improved segmentation) and the relative error for both experts (in percent). The correlation coefficient has been calculated as
                        
                           (46)
                           
                              
                                 
                                    r
                                 
                                 
                                    xy
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          l
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                l
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                −
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                l
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                                −
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     In case of the endocardium or epicardium error analysis, x
                     
                        i
                      and y
                     
                        i
                      are the values of the areas marked as the sought structure on the i-th slice; 
                        
                           
                              x
                           
                           
                              ¯
                           
                        
                      and 
                        
                           
                              y
                           
                           
                              ¯
                           
                        
                      are the mean of x
                     
                        i
                      and y
                     
                        i
                     , respectively, for the given patient.

The final correlation coefficient is the mean of correlation coefficients for all patients. If the analyzed parameters are ejection fraction, stroke volume or the heart mass, then x
                     
                        i
                      and y
                     
                        i
                      are the values of the analyzed parameters for the i-th patient, 
                        
                           
                              x
                           
                           
                              ¯
                           
                        
                      and 
                        
                           
                              y
                           
                           
                              ¯
                           
                        
                      are the averages of the analyzed parameters for all patients.

The relative error for the epicardium and endocardium has been computed as
                        
                           (47)
                           
                              RE
                              =
                              
                                 
                                    1
                                 
                                 
                                    l
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    l
                                 
                              
                              
                                 
                                    OCA
                                    (
                                    i
                                    )
                                    +
                                    OEA
                                    (
                                    i
                                    )
                                 
                                 
                                    EA
                                    (
                                    i
                                    )
                                 
                              
                           
                        
                     where EA(i) is the area marked by one expert on the i-th slice, OCA(i) is the area not marked by the first expert and marked by the compared method or second expert on the i-th slice, OEA(i) is the area marked by the first expert and not marked by the compared method or second expert on the i-th slice, l is the number of slices registered for a given patient, whereas the relative error for the ejection fraction, stroke volume and heart mass is the mean relative error for all analyzed patients, which has been calculated by the formula
                        
                           (48)
                           
                              RE
                              =
                              
                                 
                                    |
                                    PE
                                    −
                                    PC
                                    |
                                 
                                 
                                    PE
                                 
                              
                           
                        
                     where PE is the analyzed parameter value for the first expert, PC is the analyzed parameter value for the compared method or second expert. Figs. 16–19
                     
                     
                     
                      show examples of finding incorrectly segmented sections and replacing them with the model.

The model improved the results of myocardium at end-systole contours determination to a large extent, whereas at end-diastole the differences resulting from using it have not been so significant. In all cases, the relative error has varied from about 5% to 10%. For myocardium at end-systole, stroke volume and ejection fraction, the obtained relative errors are comparable with the interobserver variability.


                     Fig. 20
                      presents the number of slices replaced with the model with respect to the number of correctly segmented left ventricular contours. In case of the endocardium, only a few contours have been corrected, which is below 2% and 4% of all slices at end-diastole and end-systole, respectively. For the epicardium these values are 28.2% at end-diastole and 38.5% at end-systole.

The values of cardiac hemodynamic parameters and the heart mass have been compared in Tables 6–8
                     
                     
                     .

It can be noticed that the mass estimation has significantly improved thanks to the application of the model, while the ejection fraction and stroke volume have not been corrected on a comparatively high level. The reason for this is a good segmentation of the endocardium while the epicardium segmentation has required some correction. The mentioned hemodynamic parameters are calculated only on the basis of the inner walls of the heart muscle while the heart mass estimation requires also the knowledge of the epicardium. Regardless of the myocardium wall, results obtained with the segmentation algorithm supplemented with the proposed model have not differed significantly from the experts׳ outlines.

The correlation coefficient between the incorrectly segmented slices percentage and the relative error for ejection fraction, stroke volume and heart mass has been calculated. No statistically significant correlation has been noted while testing the null hypothesis (
                        |
                        r
                        |
                        <
                        0
                        ,
                        4
                        ,
                        
                        p
                        >
                        0
                        ,
                        1
                      in all cases). Therefore, the relative error does not increase linearly with the number of slices replaced with the model.

@&#CONCLUSIONS@&#

The model parameters have been determined on the basis of the learning set. Using the endocardium and epicardium outlines, performed by two independent experts, the segmentation results and cardiac hemodynamic parameters obtained with the segmentation algorithm with and without the model have been compared.

Replacing the improperly determined shapes with ellipses, from which parameters and position are calculated on the basis of the model, results in the improvement of the accuracy of heart condition assessment. Ellipses’ main task is to prevent leaks, which are often an issue when image analysis based on pixels gray-scale is performed.

The usefulness of the model is the greatest while calculating the endocardium and epicardium at end-systole and the heart mass. The estimation error of cardiac parameters calculated for the segmentation improved with the model is clinically acceptable, whereas without the model the error for the epicardium at end-systole and for the heart mass exceeds the permissible norm. A small absolute error in the area of the apex of the heart becomes a very large relative error. As a result the mean value of the relative error rises significantly.

The presented method is fully automatic and has been developed to improve automatic segmentation, yet it can be used with any segmentation algorithm.

@&#SUMMARY@&#

In this paper a parametric model of the left ventricle is proposed, which includes endocardium and epicardium at end-diastole and end-systole. The building algorithm and the parameters of the model are presented. An algorithm of fitting the model to available data is proposed.

The task of the model is to estimate the myocardium shape on those slices on which the segmentation algorithm has outlined the structure incorrectly. The property of the segmentation of each slice is verified using the proposed segmentation correctness coefficients, which are defined differently for the two myocardium walls.

This approach combines the advantages of image processing techniques with basic knowledge about the organ shape.

The presented method is fully automatic and has been developed to improve automatic segmentation, yet it can be used with any segmentation algorithm.

For the purposes of this study, the proposed model has been used with segmentation results obtained with an algorithm based on Kernelized Fuzzy C-Means method, which has been modified in order to compute the best possible endocardium and epicardium outlines on MR images.

The usefulness of the model is the largest while determining the epicardium and calculating the heart mass. In case of the applied segmentation algorithm, the error has decreased from clinically unacceptable to acceptable after using the presented model. For myocardium at end-systole, stroke volume and ejection fraction the obtained relative errors are comparable with the interobserver variability.

None declared.

Supplementary data associated with this paper can be found in the online version at doi:10.1016/j.compbiomed.2014.12.009.


                     
                        
                           Application 1
                           
                        
                     
                  

@&#REFERENCES@&#

