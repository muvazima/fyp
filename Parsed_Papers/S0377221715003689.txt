@&#MAIN-TITLE@&#A multi-step rolled forward chance-constrained model and a proactive dynamic approach for the wheat crop quality control problem

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           This study is referring to the multi-period wheat quality control problem.


                        
                        
                           
                           A rolling multi-step joint chance-constrained model is proposed.


                        
                        
                           
                           A proactive dynamic framework is conceived.


                        
                        
                           
                           Obtained results exhibit proactive and accurate harvest scheduling solutions.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in agriculture

Multi-step joint chance constrained programming

Proactive dynamic approach

Exogenous Markov decision process

Wheat crop quality control

@&#ABSTRACT@&#


               
               
                  Handling weather uncertainty during the harvest season is an indispensable aspect of seed gathering activities. More precisely, the focus of this study refers to the multi-period wheat quality control problem during the crop harvest season under meteorological uncertainty. In order to alleviate the problem curse of dimensionality and to reflect faithfully exogenous uncertainties revealed progressively over time, we propose a multi-step joint chance-constrained model rolled forward step-by-step. This model is subsequently solved by a proactive dynamic approach, specially conceived for this purpose. Based on real-world derived instances, the obtained computational results exhibit proactive and accurate harvest scheduling solutions for the wheat crop quality control problem.
               
            

@&#INTRODUCTION@&#

Both individual farmers and agricultural cooperatives aim to meet uncertainty within sight of the economic consequences on crop production management. The outcome of factors such as climate conditions, yield and agronomic responses to various farming practices has a straightforward incidence on the qualitative and quantitative returns achieved.

So far, since agricultural processes and activities are quite intricate and manifold, many research efforts have been devoted to supporting managerial decision-making. In general, optimization models in most agricultural and crop production applications deal preponderantly with deterministic input data (Gigler, Hendrix, Heesen, van den Hazelkamp, & Meerdink, 2002; Santos, Costa, Arenales, & Santos, 2010; Wang, Li, & O’Brien, 2009, etc.). Nevertheless, several studies have been dedicated to addressing miscellaneous types of uncertainties affecting agri-supply chains. More specifically, various agricultural scheduling and planning problems tackled under uncertainty have been discussed by Borodin, Bourtembourg, Hnaien, and Labadie (2014b), Bohle, Maturana, and Vera (2010), Tan and Cömden (2012), Moghaddam and DePuy (2011), etc. For more details on this topic, one can refer to the survey realized by Ahumada and Villalobos (2009), which reviewed recent studies on the subject and outlined the main contributions related to production and distribution planning models for different commodities of agricultural supply chains.

To the best of our knowledge, there is a lack of flexible and uncertain proactive and/or reactive crop production operational planning tools. By the same token, traditional methods dedicated to solving deterministic optimization are not always suitable to capture the truly dynamic nature of most real-life applications. In order to overcome some of above delineated shortcomings, the seed quality control problem during the harvest season is addressed minutely in this paper.

Two powerful and competing frameworks are well-known for dealing with uncertain and dynamic decision processes: multi-stage and dynamic stochastic programmings. Even if the use of these two paradigms is showing increasing interest, there are still very few real-world implementations. In this article, arising from the background characteristics of a particular problem, we are interested in using some of fundamental concepts of both multi-stage and dynamic stochastic programming approaches and respectively, adapting them in order to better respond to crop quality requirements during the harvest season. Particularly, we make use of the chance-constrained programming approach (Charnes & Cooper, 1959; Dentcheva, Prékopa, & Ruszczynski, 1998, etc.), that allows us to tackle appropriately stochastic optimization problems for which solutions are given jointly with a requested high reliability (confidence) level.

It is worth mentioning our previous work (Borodin et al., 2014b) which only addressed the generic static version of the seed quality control problem during the harvest season via a joint chance-constrained program. This static version presents a twofold drawback: firstly, the model is intractable for a real-life harvest horizon length (one month and a half, or even more) due to the problem curse of dimensionality, and secondly, no forecasting meteorological data are available for the entire harvest season with a satisfactory accuracy level. On the other hand, looking to treat a real-life case study problem encountered in a typical French agricultural cooperative, the present work proposes a new multi-step joint chance-constrained model rolled forward jointly with a proactive dynamic framework able to: (i) propose proactive solutions during the whole harvest season; (ii) absorb and reflect the harvest process dynamics; (iii) take into account weather and agronomic data updates. In responding to the needs of the case study cooperative, this paper focuses on wheat crop quality degradation, which can be faithfully expressed via the Hagberg falling number.

The content of this paper is structured as follows. The next section summarizes the state-of-the-art related to both dynamic and multi-stage stochastic programming paradigms. Section 3 details the problem statement and refers both to its static and rolling forward multi-step models. In Section 4, a proactive dynamic approach is developed. After that, in Section 5, several computational results are reported and discussed. Finally, this paper ends with some concluding remarks including an outline of topics for future research.

Stochastic programming is becoming an increasingly popular tool for modeling decisions under uncertainty. In particular, multi-stage and dynamic programmings have been evolved for solving sequential stochastic optimization problems. Following an independent development, they were initiated approximately in the same period (1955–1965).

Although multi-stage and dynamic stochastic programming paradigms have several similarities, note that in this paper they are distinguished. This is not always the case in the literature. Since stages are just points in time, systems inspected at a finite number of stages are often considered as dynamic (Birge, 1985; Kall & Wallace, 1994; Zhang, Küçükyavuz, & Goel, 2014).

As claimed by Dupačová and Sladký (2002), stochastic dynamic and multi-stage stochastic programming problems with discrete time parameter cope essentially with the same types of problems, i.e. with the dynamic and stochastic decision processes. The main distinction resides in the decision concept, in the different structures used in their formulation and subsequently in different solution procedures:

                        
                           •
                           for dynamic programming, the definition of state is primordial: the structure of the problem is tied to the solution method (the backward/forward recursion is connected with the principle of optimality);

multi-stage stochastic programs do not use the notion of state and their formulation is not connected with any prescribed solution technique. Hence, a variety of stochastic programs exists along with various solution methods.

The classical technique to handle a multi-stage stochastic programming problem is premised on scenario tree construction that branches at each stage. Even with a small number of outcomes per stage, the scenario tree size grows exponentially with the number of stages. As a response to the curse of dimensionality, stochastic dual dynamic programming has been proposed. Decomposition is another well-known solution approach for optimization problems based on the idea of partition, originating with the technical report of Birge (1985). The most common form of decomposition approaches is the L-shaped method drawn-on Benders decomposition or its improvement (Van Slyke & Wets, 1969) and Lagrangian relaxation (Takriti & Birge, 2000). Moreover, Cristobal, Escudero, and Monge (2009) introduced a decomposition methodology, based on a mathematical programming framework, in order to compute the equilibrium path in dynamic stochastic model by decomposing the problem into a set of smaller independent sub-problems.

As regards stochastic dynamic programming, this aims at solving stochastic optimization problems following Markov decision processes, which are the appropriate models for purely endogenous problems (Powell, 2007; Puterman, 1994). An illustrative and eloquent example has been presented by Lin, Chen, and Chu (2014), which focuses on the dynamic multi-site capacity planning problem encountered in the thin film transistor liquid crystal display industry under stochastic demand.

From a practical standpoint, multi-stage and dynamic stochastic programs have applications in many areas. One field in which multi-stage stochastic linear programming is extensively applied, is the long-term scheduling of water resources. More precisely, in order to address the future electricity demand at the lowest expected fuel cost, the problem consists of: (i) establishing a policy of releasing water from reservoirs for hydro-electricity generation, and (ii) determining planning at thermal plant level over a horizon of months or years (Philpott & de Matos, 2012). Among the closest recent studies, the work of Cervellera, Chen, and Wen (2006) can be mentioned, that presented a computational tractable stochastic dynamic programming method for the optimal management of large scale water reservoir networks. Edwards, Ross, Mares, Ellison, and Tomlinson (1989) incorporated time-consistent coherent risk measure into a multi-stage programming model for an application of hydro-thermal scheduling in the New Zealand electricity system.

The increasing complexities of inherent uncertainties in financial markets have led to the need for stochastic mathematical programs to support decision making processes. In this spirit, the portfolio selection problem has received broad interest (Matmoura & Penev, 2013; Topaloglou, Vladimirou, & Zenios, 2008, etc.).

Another field which has received significant attention, concerns vehicle routing problems, as witnessed by the survey of Pillac, Gendreau, Guéret, and Medaglia (2013). On this topic, Powell and Topaloglu (2003) explored the use of concepts from stochastic programming in the context of resource allocation problems arising in transportation and logistics applications. Since transportation problems are often quite large, the research efforts described in Powell and Topaloglu (2003) have been particularly focused on the degree to which some techniques exploit the intrinsic structure of these problems.

Consider an agricultural cooperative specializing in cereal production and commercialization, which integrates a union of several hundred farmers, for whom it offers storage, transportation and other customer services. Cereal harvesting represents the pivotal stage for both the agricultural cooperative and growers, on the grounds of its high cost and vulnerability to weather conjuncture. This is particularly notable in the case of wheat gathering, which presupposes substantial crop quality losses in case of any exposure of wheat crops to rainfall after their physiological maturity. Rainfall during the harvest period can lead to sprouting of wheat kernels, which causes alpha-amylase activity. Alpha-amylase is a protein enzyme that decomposes starch and its activity is responsible for the breakdown of starch to a mixture of glucose and maltose, resulting in a reduction of viscosity estimated by the Hagberg falling number (Edwards et al., 1989). Seed sprouting during wet harvest conditions leads to high levels of alpha-amylase, which manifest detrimental effects on the end-use quality and subsequently, the crop’s economic returns (Eeden & Labuschagne, 2012).

The Hagberg falling number χ is an internationally standardized and recognized quality metric, which allows the indirect determination of alpha-amylase activity. Low values for χ mean excessive levels of alpha-amylase causing loaves to be discolored, sticky, with poor resilience and texture (Hagberg, 1960; Perten, 1964). Thus, wheat grains whose alpha-amylase activity is too high, do not suit the baking industry and rather should be used for animal feeding. The curvilinear relationship between the Hagberg falling number χ and the alpha-amylase activity may be expressed as a straight-line function by converting the falling number χ into a liquefaction number η as given by the empirical formula below (Perten, 1964):

                        
                           (1)
                           
                              
                                 η
                                 =
                                 
                                    6000
                                    
                                       χ
                                       −
                                       50
                                    
                                 
                              
                           
                        
                     
                  

In order to calculate the liquefaction number 
                        
                           η
                           
                              
                                 l
                                 1
                              
                              +
                              
                                 l
                                 2
                              
                           
                        
                      of the mixture of two wheat samples with sizes l
                     1 and l
                     2, having the falling numbers 
                        
                           η
                           
                              l
                              1
                           
                        
                      and 
                        
                           
                              η
                              
                                 l
                                 2
                              
                           
                           ,
                        
                      
                     ITCF (2001) give the formula:

                        
                           (2)
                           
                              
                                 
                                    η
                                    
                                       
                                          l
                                          1
                                       
                                       +
                                       
                                          l
                                          2
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          l
                                          1
                                       
                                       ·
                                       
                                          η
                                          
                                             l
                                             1
                                          
                                       
                                       +
                                       
                                          l
                                          2
                                       
                                       ·
                                       
                                          η
                                          
                                             l
                                             2
                                          
                                       
                                    
                                    
                                       
                                          l
                                          1
                                       
                                       +
                                       
                                          l
                                          2
                                       
                                    
                                 
                              
                           
                        
                     
                  

Now, let us generalize the formula (2) for a mixture composed of L different wheat lots ln
                     , having the associated Hagberg falling numbers 
                        
                           η
                           
                              l
                              n
                           
                        
                      (
                        
                           n
                           =
                           
                              
                                 1
                                 ,
                                 L
                              
                              ¯
                           
                        
                     ):

                        
                           (3)
                           
                              
                                 
                                    η
                                    
                                       
                                          ∑
                                          
                                             n
                                             =
                                             1
                                          
                                          L
                                       
                                       
                                          l
                                          n
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                          
                                             n
                                             =
                                             1
                                          
                                          L
                                       
                                       
                                          l
                                          n
                                       
                                       ·
                                       
                                          η
                                          
                                             l
                                             n
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             n
                                             =
                                             1
                                          
                                          L
                                       
                                       
                                          l
                                          n
                                       
                                    
                                 
                              
                           
                        
                     
                  

In the following, let us consider wheat crop harvesting carried out by I different agricultural holdings. Each holding i represents the consolidation of a group of growers, Pi
                      parcels and agricultural equipment involving a harvest rate of ci
                      (tonnes per day). The quantity to be harvested qip
                      (tonnes) on parcel p of holding i can be determined beforehand according to the planted acreage and estimated crop yield.

Let the harvest season be constituted of J days. Wheat crop harvesting on parcel p of holding i is forbidden before its ripeness day dip
                     . Denote by ηipj
                      the estimated liquefaction number corresponding to the wheat harvested the jth day from parcel p belonging to holding i.

No harvest is possible on rainy days. Based on the weather station data related to the volume of rainfalls during the harvest season, it is possible to have information about daily harvest availability. Thus, the daily harvest availability is expressed by ξj
                      (
                        
                           ∀
                           j
                           =
                           
                              
                                 1
                                 ,
                                 J
                              
                              ¯
                           
                        
                     ), an independent J-dimensional random binary-valued variable, which takes the value 1 if it is possible to harvest on jth day, and 0 otherwise. These variables are described by their discrete distributions, as follows: 
                        
                           
                              D
                              j
                           
                           =
                           
                              {
                              
                                 (
                                 
                                    ξ
                                    j
                                 
                                 =
                                 k
                                 ,
                                 P
                                 
                                    (
                                    
                                       ξ
                                       j
                                    
                                    =
                                    k
                                    )
                                 
                                 )
                              
                              ,
                              k
                              =
                              
                                 {
                                 0
                                 ,
                                 1
                                 }
                              
                              }
                           
                           ,
                           ∀
                           j
                           =
                           
                              
                                 1
                                 ,
                                 J
                              
                              ¯
                           
                           ,
                        
                      where 
                        P
                      denotes probability.

In the sequel, let xipj
                      (0 ≤ xipj
                      ≤ 1) be the real decision variables that represent the portion of parcel p of holding i gathered on jth day. Moreover, let yip
                      be the real variables that estimate the liquefaction number of harvested mixture originated from parcel p of holding i. The binary variables gipj
                      are defined to take the value 1, if the parcel p of holding i is gathered on jth day, and the value 0 otherwise. Variables rj
                      are used to express if on jth day no parcel is gathered by taking the value 0, and the value 1, otherwise. Table 1
                      summarizes the problem statement notations used in this paper, other local notations will be explained later in the text.

Although the present paper focuses on multi-step (dynamic in time) decisions rolled forward step-by-step, let us first present the static model of the wheat crop quality control during the whole harvest season (i.e. ranging from 1 to J periods of time), under climate uncertainty. On this topic, Borodin et al. (2014b) have already addressed the static generic version of the crop quality risk management problem under weather uncertainty, while allowing both premature and delayed harvests. Based on above defined decision variables and data parameters (see Table 1), a static (single-stage) joint chance constrained model 
                           
                              P
                              static
                           
                         is formulated as follows:

                           
                              (4)
                              
                                 
                                    min
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       I
                                    
                                    
                                       ∑
                                       
                                          p
                                          =
                                          1
                                       
                                       
                                          P
                                          i
                                       
                                    
                                    
                                       y
                                       
                                          i
                                          p
                                       
                                    
                                    ·
                                    
                                       
                                          q
                                          
                                             i
                                             p
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             I
                                          
                                          
                                             ∑
                                             
                                                p
                                                =
                                                1
                                             
                                             
                                                P
                                                i
                                             
                                          
                                          
                                             q
                                             
                                                i
                                                p
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                J
                                             
                                             
                                                x
                                                
                                                   i
                                                   p
                                                   j
                                                
                                             
                                             =
                                             1
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   p
                                                   =
                                                   1
                                                
                                                
                                                   P
                                                   i
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   p
                                                   j
                                                
                                             
                                             ·
                                             
                                                q
                                                
                                                   i
                                                   p
                                                
                                             
                                             ≤
                                             
                                                c
                                                i
                                             
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             P
                                             
                                                (
                                                
                                                   x
                                                   
                                                      i
                                                      p
                                                      j
                                                   
                                                
                                                ≤
                                                
                                                   ξ
                                                   j
                                                
                                                ,
                                                ∀
                                                i
                                                ,
                                                ∀
                                                p
                                                ,
                                                ∀
                                                j
                                                )
                                             
                                             ≥
                                             1
                                             −
                                             α
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                
                                                   i
                                                   p
                                                   j
                                                
                                             
                                             ≤
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   j
                                                
                                             
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                             ,
                                             ∀
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             N
                                             ·
                                             
                                                x
                                                
                                                   i
                                                   p
                                                   j
                                                
                                             
                                             ≥
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   j
                                                
                                             
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                             ,
                                             ∀
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                r
                                                j
                                             
                                             ≤
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                I
                                             
                                             
                                                ∑
                                                
                                                   p
                                                   =
                                                   1
                                                
                                                
                                                   P
                                                   i
                                                
                                             
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   j
                                                
                                             
                                             ,
                                             
                                             ∀
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             N
                                             ·
                                             
                                                r
                                                j
                                             
                                             ≥
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                I
                                             
                                             
                                                ∑
                                                
                                                   p
                                                   =
                                                   1
                                                
                                                
                                                   P
                                                   i
                                                
                                             
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   j
                                                
                                             
                                             ,
                                             
                                             ∀
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   j
                                                
                                             
                                             ·
                                             
                                                (
                                                j
                                                −
                                                
                                                   d
                                                   
                                                      i
                                                      p
                                                   
                                                
                                                )
                                             
                                             ≥
                                             0
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                             ,
                                             ∀
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   j
                                                
                                             
                                             ≥
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   (
                                                   j
                                                   −
                                                   1
                                                   )
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   
                                                      j
                                                      ′
                                                   
                                                   =
                                                   1
                                                
                                                
                                                   j
                                                   −
                                                   1
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   p
                                                   
                                                      j
                                                      ′
                                                   
                                                
                                             
                                             +
                                             
                                                r
                                                j
                                             
                                             −
                                             1
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                             ,
                                             ∀
                                             j
                                             >
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                J
                                             
                                             
                                                x
                                                
                                                   i
                                                   p
                                                   j
                                                
                                             
                                             ·
                                             
                                                η
                                                
                                                   i
                                                   p
                                                   j
                                                
                                             
                                             =
                                             
                                                y
                                                
                                                   i
                                                   p
                                                
                                             
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             0
                                             ≤
                                             
                                                x
                                                
                                                   i
                                                   p
                                                   j
                                                
                                             
                                             ≤
                                             1
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                             ,
                                             ∀
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             
                                                y
                                                
                                                   i
                                                   p
                                                
                                             
                                             ∈
                                             R
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             
                                                r
                                                j
                                             
                                             ,
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   j
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                             ,
                                             ∀
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Constraints (5) are required, as each parcel must be completely gathered. Since all quantities harvested on parcels belonging to agricultural holding i must not exceed its daily capacity ci
                        , constraints (6) are imposed. Non-linear constraint (7), which can be violated at least α times, ensures that no harvest is made on rainy days. Constraints (8) and (9) force the binary variables gipj
                         to
 take the value 1, if the parcel p of holding i is gathered on jth day, and the value 0 otherwise. Similarly, constraints (10) and (11) impose the binary variable rj
                         to take the value 1 if at least one parcel is gathered on jth day and 0, otherwise. Since no wheat harvesting is authorized before the wheat ripeness date dip
                        , constraints (12) are prescribed. Constraints (14) calculate the liquefaction number of a post-harvested mixture originating from parcel p of holding i.

For economic reasons (stopping a combine-harvester is very onerous expenditure), constraints (13) force the continuation of the harvest process on parcel p of holding i once it is started. However, the parcel can be changed after rain, because in this last case, stopping the combine-harvester is anyway unavoidable.

The objective function (4) aims to minimize the liquefaction number of the wheat mixture composed of harvested crops arising from all concerned parcels. To determine the associated Hagberg falling number, it is sufficient to apply the formula (1).

Needless to say, there is no explicit or quantifiable recourse to consider. Although the non-linear constraint (7) is affected by uncertainty only on the right-hand side, this does not make the problem easier.

It is worth pointing out that the drawback of the static version of the treated real-life application is twofold: firstly, the model is intractable even for a monthly harvest time horizon due to the problem curse of dimensionality (Borodin et al., 2014b), and secondly, no forecasting meteorological data are available for one month ahead with a satisfactory accuracy level.

To the best of our knowledge, and as mentioned by Zhang et al. (2014), most problems in the literature, modeled by using the chance-constrained programming, are considered static by nature, i.e. the decisions are taken here-and-now and do not change once uncertainties are revealed over time. Quite often, more flexible and efficient decision-making models are requested in order better to address problems affected by uncertainty, as emphasized in the previous subsection.

In the light of the above remarks, let us define a multi-step approach rolled forward step-by-step, under joint chance-constraints (7), in which the scheduling decisions are adjustable to the realization of the weather (stochastic) data at every non-overlapping step s (
                           
                              s
                              =
                              
                                 
                                    1
                                    ,
                                    S
                                 
                                 ¯
                              
                           
                        ), while taking into account the future weather forecasting and the agronomic data updating. For the sake of clarity, note that the notion of step (stage) does not necessarily correspond to an elementary period of time. Thus, let each step s be constituted of Ts
                         periods of time, considered lengthened equivalent in the sequel without loss of generality (T = T
                        1 = T
                        2⋅⋅⋅ = TS
                        ). In fact, the set S of steps s represents a partition of the harvest time horizon J, i.e. J = T · |S|.

In our multi-step setting, the exogenous uncertain data (i.e. which is uncontrollable and do not depend on the decision variables) 
                           
                              
                                 ξ
                                 1
                                 1
                              
                              ,
                              …
                              ,
                              
                                 ξ
                                 T
                                 1
                              
                              ,
                              
                                 ξ
                                 1
                                 2
                              
                              ,
                              …
                              ,
                              
                                 ξ
                                 T
                                 2
                              
                              ,
                              …
                              ,
                              
                                 ξ
                                 1
                                 S
                              
                              ,
                              …
                              ,
                              
                                 ξ
                                 T
                                 S
                              
                           
                         are revealed over time in S time steps and decisions should be adapted to this process. Each sequence of step s, 
                           
                              
                                 ξ
                                 t
                                 s
                              
                              ∈
                              
                                 {
                                 0
                                 ,
                                 1
                                 }
                              
                              ,
                           
                        
                        
                           
                              t
                              =
                              
                                 
                                    1
                                    ,
                                    T
                                 
                                 ¯
                              
                           
                         is interpreted as a stochastic process, i.e. as a sequence of random variables which follows a specified probability distribution.

Let us use the notations ξ
                        [s] = (ξ
                        1, …, ξs
                        ) to design the history of the stochastic process up to step s, where 
                           
                              
                                 ξ
                                 s
                              
                              =
                              
                                 (
                                 
                                    ξ
                                    1
                                    s
                                 
                                 ,
                                 …
                                 ,
                                 
                                    ξ
                                    T
                                    s
                                 
                                 )
                              
                           
                        . The values of the decision variables chosen for stage s may depend on the known information data ξ
                        [s − 1] and also on the results of future observation ξs
                        .

In the same manner, replace the index j by both the step index s and the period of time t in all of the static problem parameters and variables introduced in the previous subsection, as follows: 
                           
                              
                                 x
                                 
                                    i
                                    p
                                    t
                                 
                                 s
                              
                              ,
                           
                        
                        
                           
                              
                                 g
                                 
                                    i
                                    p
                                    t
                                 
                                 s
                              
                              ,
                           
                        
                        
                           
                              r
                              
                                 t
                              
                              s
                           
                         and 
                           
                              η
                              
                                 i
                                 p
                                 t
                              
                              s
                           
                        . Moreover, let us denote by 
                           
                              
                                 x
                                 
                                    i
                                    p
                                    t
                                 
                                 
                                    [
                                    s
                                    ]
                                 
                              
                              ,
                           
                        
                        
                           
                              
                                 g
                                 
                                    i
                                    p
                                    t
                                 
                                 
                                    [
                                    s
                                    ]
                                 
                              
                              ,
                           
                        
                        
                           
                              
                                 r
                                 
                                    t
                                 
                                 
                                    [
                                    s
                                    ]
                                 
                              
                              ,
                           
                         
                        de facto solution implementations taken at the step s. Note that the parameters and variables definition is kept the same in the sequel.

Therefore, let us establish the order of events within the rolling forward multi-step approach in the following way: at the beginning of the first stage, decisions are made under ξ
                        1 (weather uncertainty not yet revealed) and given by the 
                           
                              
                                 x
                                 
                                    i
                                    p
                                 
                                 1
                              
                              =
                              
                                 (
                                 
                                    x
                                    
                                       i
                                       p
                                       1
                                    
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    x
                                    
                                       i
                                       p
                                       T
                                    
                                    1
                                 
                                 )
                              
                           
                        ; next, the weather events occurring are observed in the ξ
                        1, as well as the de facto implementation of the decision vector 
                           
                              x
                              
                                 i
                                 p
                              
                              1
                           
                         is carried out and designed by 
                           
                              x
                              
                                 i
                                 p
                              
                              
                                 [
                                 1
                                 ]
                              
                           
                        . Based on the revealed outcomes, the decision at the second stage 
                           
                              
                                 x
                                 
                                    i
                                    p
                                 
                                 2
                              
                              
                                 (
                                 
                                    x
                                    
                                       i
                                       p
                                    
                                    
                                       [
                                       1
                                       ]
                                    
                                 
                                 ,
                                 
                                    ξ
                                    2
                                 
                                 )
                              
                           
                         is made considering past climate observations ξ
                        [1], previous decisions realization 
                           
                              x
                              
                                 i
                                 p
                              
                              
                                 [
                                 1
                                 ]
                              
                           
                         and future climate forecast ξ
                        2, etc. Thus, let us formalize the decision process as following the trajectory (18).

Since other problem decision variables such as 
                           
                              g
                              
                                 i
                                 p
                                 t
                              
                              s
                           
                         do not depend explicitly on meteorological uncertainties, they are adjusted only according to their realizations made at the previous time step: 
                           
                              
                                 g
                                 
                                    i
                                    p
                                    t
                                 
                                 s
                              
                              =
                              
                                 g
                                 
                                    i
                                    p
                                    t
                                 
                                 s
                              
                              
                                 (
                                 
                                    g
                                    
                                       i
                                       p
                                       t
                                    
                                    
                                       [
                                       s
                                       −
                                       1
                                       ]
                                    
                                 
                                 )
                              
                           
                        . As far as 
                           
                              r
                              
                                 t
                              
                              s
                           
                         are concerned, they do not depend either on past solution realizations or on weather uncertainties. An overview of the problem decision process is illustrated in Fig. 1
                        .

                           
                              (18)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             decision
                                             
                                                (
                                                
                                                   x
                                                   1
                                                
                                                ,
                                                
                                                   ξ
                                                   1
                                                
                                                )
                                             
                                             ⇝
                                             
                                             realization
                                             
                                                (
                                                
                                                   x
                                                   
                                                      [
                                                      1
                                                      ]
                                                   
                                                
                                                ,
                                                
                                                   ξ
                                                   
                                                      [
                                                      1
                                                      ]
                                                   
                                                
                                                )
                                             
                                             ⇝
                                             decision
                                             
                                                (
                                                
                                                   x
                                                   2
                                                
                                                ,
                                                
                                                   ξ
                                                   2
                                                
                                                )
                                             
                                             ⇝
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             ⋯
                                             ⇝
                                             
                                             realization
                                             
                                                (
                                                
                                                   x
                                                   
                                                      [
                                                      S
                                                      −
                                                      1
                                                      ]
                                                   
                                                
                                                ,
                                                
                                                   ξ
                                                   
                                                      [
                                                      S
                                                      −
                                                      1
                                                      ]
                                                   
                                                
                                                )
                                             
                                             ⇝
                                             decision
                                             
                                                (
                                                
                                                   x
                                                   S
                                                
                                                ,
                                                
                                                   ξ
                                                   S
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

For the sake of terminology convenience and in order to avoid any confusion with classical multi-stage programming problems, henceforth let us call the program which respects the above introduced decision process (see Fig. 1) a multi-step program rolled forward step-by-step, since: as time progresses and new meteorological and agronomic information becomes available, new updated data are considered, and so a new problem is formulated and solved. Thus, a counterpart rolling forward multi-step chance constrained reformulation called 
                           
                              
                                 P
                                 S
                              
                              −
                              
                                 steps
                                 I
                              
                           
                         can be formalized as follows:

                           
                              (4)
                              
                                 
                                    m
                                    i
                                    n
                                    f
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       I
                                    
                                    
                                       ∑
                                       
                                          p
                                          =
                                          1
                                       
                                       
                                          P
                                          i
                                       
                                    
                                    
                                       y
                                       
                                          i
                                          p
                                       
                                    
                                    ·
                                    
                                       
                                          q
                                          
                                             i
                                             p
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             I
                                          
                                          
                                             ∑
                                             
                                                p
                                                =
                                                1
                                             
                                             
                                                P
                                                i
                                             
                                          
                                          
                                             q
                                             
                                                i
                                                p
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   s
                                                   =
                                                   1
                                                
                                                S
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                T
                                             
                                             
                                                x
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                s
                                             
                                             =
                                             1
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   p
                                                   =
                                                   1
                                                
                                                
                                                   P
                                                   i
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                s
                                             
                                             ·
                                             
                                                q
                                                
                                                   i
                                                   p
                                                
                                             
                                             ≤
                                             
                                                c
                                                i
                                             
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             s
                                             ,
                                             ∀
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             P
                                             
                                                (
                                                
                                                   x
                                                   
                                                      i
                                                      p
                                                      t
                                                   
                                                   s
                                                
                                                ≤
                                                
                                                   ξ
                                                   t
                                                   s
                                                
                                                ,
                                                ∀
                                                i
                                                ,
                                                ∀
                                                p
                                                ,
                                                ∀
                                                t
                                                ,
                                                ∀
                                                s
                                                )
                                             
                                             ≥
                                             1
                                             −
                                             α
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                s
                                             
                                             ≤
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                s
                                             
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                             ,
                                             ∀
                                             s
                                             ,
                                             ∀
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             N
                                             ·
                                             
                                                x
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                s
                                             
                                             ≥
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                s
                                             
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                             ,
                                             ∀
                                             s
                                             ,
                                             ∀
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             
                                                r
                                                
                                                   t
                                                
                                                s
                                             
                                             ≤
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                I
                                             
                                             
                                                ∑
                                                
                                                   p
                                                   =
                                                   1
                                                
                                                
                                                   P
                                                   i
                                                
                                             
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                s
                                             
                                             ,
                                             
                                             ∀
                                             s
                                             ,
                                             ∀
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                    
                                       
                                          
                                             N
                                             ·
                                             
                                                r
                                                
                                                   t
                                                
                                                s
                                             
                                             ≥
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                I
                                             
                                             
                                                ∑
                                                
                                                   p
                                                   =
                                                   1
                                                
                                                
                                                   P
                                                   i
                                                
                                             
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   t
                                                
                                             
                                             ,
                                             
                                             ∀
                                             s
                                             ,
                                             ∀
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (26)
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                s
                                             
                                             ·
                                             
                                                (
                                                
                                                   (
                                                   s
                                                   −
                                                   1
                                                   )
                                                
                                                ·
                                                T
                                                +
                                                t
                                                −
                                                
                                                   d
                                                   
                                                      i
                                                      p
                                                   
                                                
                                                )
                                             
                                             ≥
                                             0
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                             ,
                                             ∀
                                             s
                                             ,
                                             ∀
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                1
                                             
                                             ≥
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   (
                                                   t
                                                   −
                                                   1
                                                   )
                                                
                                                1
                                             
                                             −
                                             
                                                ∑
                                                
                                                   
                                                      t
                                                      ′
                                                   
                                                   =
                                                   1
                                                
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   p
                                                   
                                                      t
                                                      ′
                                                   
                                                
                                                1
                                             
                                             +
                                             
                                                r
                                                t
                                                1
                                             
                                             −
                                             1
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                             ,
                                             ∀
                                             t
                                             >
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (28)
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                s
                                             
                                             ≥
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   (
                                                   t
                                                   −
                                                   1
                                                   )
                                                
                                                s
                                             
                                             −
                                             
                                                ∑
                                                
                                                   
                                                      s
                                                      ′
                                                   
                                                   =
                                                   1
                                                
                                                
                                                   s
                                                   −
                                                   1
                                                
                                             
                                             
                                                ∑
                                                
                                                   
                                                      t
                                                      ′
                                                   
                                                   =
                                                   1
                                                
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   p
                                                   
                                                      t
                                                      ′
                                                   
                                                
                                                s
                                             
                                             +
                                             
                                                r
                                                t
                                                s
                                             
                                             −
                                             1
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             s
                                             >
                                             1
                                             ,
                                             ∀
                                             p
                                             ,
                                             ∀
                                             t
                                             >
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (29)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   s
                                                   =
                                                   1
                                                
                                                S
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                T
                                             
                                             
                                                x
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                s
                                             
                                             ·
                                             
                                                η
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                s
                                             
                                             =
                                             
                                                y
                                                
                                                   i
                                                   p
                                                
                                             
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (30)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                s
                                             
                                             =
                                             
                                                x
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                s
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      i
                                                      p
                                                      t
                                                   
                                                   
                                                      [
                                                      s
                                                      −
                                                      1
                                                      ]
                                                   
                                                
                                                )
                                             
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                             ,
                                             ∀
                                             s
                                             >
                                             1
                                             ,
                                             ∀
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (31)
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                s
                                             
                                             =
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                s
                                             
                                             
                                                (
                                                
                                                   g
                                                   
                                                      i
                                                      p
                                                      t
                                                   
                                                   
                                                      [
                                                      s
                                                      −
                                                      1
                                                      ]
                                                   
                                                
                                                )
                                             
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                             ,
                                             ∀
                                             s
                                             >
                                             1
                                             ,
                                             ∀
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (32)
                              
                                 
                                    
                                       
                                          
                                             0
                                             ≤
                                             
                                                x
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                s
                                             
                                             ≤
                                             1
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                             ,
                                             ∀
                                             s
                                             ,
                                             ∀
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (33)
                              
                                 
                                    
                                       
                                          
                                             
                                                y
                                                
                                                   i
                                                   p
                                                
                                             
                                             ∈
                                             R
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (34)
                              
                                 
                                    
                                       
                                          
                                             
                                                r
                                                
                                                   t
                                                
                                                s
                                             
                                             ,
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                s
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             ∀
                                             p
                                             ,
                                             ∀
                                             s
                                             ,
                                             ∀
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Let us deduce some properties of the reformulation 
                           
                              
                                 P
                                 S
                              
                              −
                              
                                 steps
                                 I
                              
                           
                        :

                           
                              (A)
                              the harvest availability stochastic data ξ
                                 1, ξ
                                 2,…,ξs
                                 ,…, (∀s) are mutually independent. In the framework of multi-stage stochastic programming, this property is called the interstage independence assumption (Dupačová & Sladký, 2002).

the objective function (4) is separable with respect to the step index s. In particular, it is additive according to (36).


                                 sub-optimality: the following problem properties can be noticed: (i) the wheat degradation process is irreversible and triggered by rainfall, i.e.:

                                    
                                       (35)
                                       
                                          
                                             
                                                η
                                                
                                                   i
                                                   p
                                                   1
                                                
                                                1
                                             
                                             ≤
                                             ⋯
                                             ≤
                                             
                                                η
                                                
                                                   i
                                                   p
                                                   T
                                                
                                                1
                                             
                                             ≤
                                             
                                                η
                                                
                                                   i
                                                   p
                                                   1
                                                
                                                2
                                             
                                             ≤
                                             ⋯
                                             ≤
                                             
                                                η
                                                
                                                   i
                                                   p
                                                   T
                                                
                                                2
                                             
                                             ≤
                                             ⋯
                                          
                                       
                                    
                                 (ii) since the harvest must be achieved as soon as possible for the sake of preserving wheat quality and no harvest is possible before the seed ripeness dates (26), harvesting decisions taken at any stage s of the harvest process do not depend on future realizations of the climate uncertainty. Hence, pursuant to (i), (ii) and (36), it is easy to discern the sub-optimal structure of the 
                                    
                                       
                                          P
                                          S
                                       
                                       −
                                       
                                          steps
                                          I
                                       
                                    
                                 .

the joint constraints (29) can be inserted directly into the objective function by replacing 
                                    
                                       
                                          y
                                          
                                             i
                                             p
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             s
                                             =
                                             1
                                          
                                          S
                                       
                                       
                                          ∑
                                          
                                             t
                                             =
                                             1
                                          
                                          T
                                       
                                       
                                          x
                                          
                                             i
                                             p
                                             t
                                          
                                          s
                                       
                                       ·
                                       
                                          η
                                          
                                             i
                                             p
                                             t
                                          
                                          s
                                       
                                       ,
                                    
                                  as shown in (36).

                                    
                                       (36)
                                       
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         I
                                                      
                                                      
                                                         ∑
                                                         
                                                            p
                                                            =
                                                            1
                                                         
                                                         
                                                            P
                                                            i
                                                         
                                                      
                                                      
                                                         y
                                                         
                                                            i
                                                            p
                                                         
                                                      
                                                      ·
                                                      
                                                         
                                                            q
                                                            
                                                               i
                                                               p
                                                            
                                                         
                                                         
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  1
                                                               
                                                               I
                                                            
                                                            
                                                               ∑
                                                               
                                                                  p
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  P
                                                                  i
                                                               
                                                            
                                                            
                                                               q
                                                               
                                                                  i
                                                                  p
                                                               
                                                            
                                                         
                                                      
                                                      =
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         I
                                                      
                                                      
                                                         ∑
                                                         
                                                            p
                                                            =
                                                            1
                                                         
                                                         
                                                            P
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                
                                                
                                                   
                                                      ×
                                                      
                                                         (
                                                         
                                                            ∑
                                                            
                                                               s
                                                               =
                                                               1
                                                            
                                                            S
                                                         
                                                         
                                                            ∑
                                                            
                                                               t
                                                               =
                                                               1
                                                            
                                                            T
                                                         
                                                         
                                                            x
                                                            
                                                               i
                                                               p
                                                               t
                                                            
                                                            s
                                                         
                                                         ·
                                                         
                                                            η
                                                            
                                                               i
                                                               p
                                                               t
                                                            
                                                            s
                                                         
                                                         ·
                                                         
                                                            
                                                               q
                                                               
                                                                  i
                                                                  p
                                                               
                                                            
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     i
                                                                     =
                                                                     1
                                                                  
                                                                  I
                                                               
                                                               
                                                                  ∑
                                                                  
                                                                     p
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     P
                                                                     i
                                                                  
                                                               
                                                               
                                                                  q
                                                                  
                                                                     i
                                                                     p
                                                                  
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                
                                                
                                                   
                                                      =
                                                      
                                                         ∑
                                                         
                                                            s
                                                            =
                                                            1
                                                         
                                                         S
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         I
                                                      
                                                      
                                                         ∑
                                                         
                                                            p
                                                            =
                                                            1
                                                         
                                                         
                                                            P
                                                            i
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            t
                                                            =
                                                            1
                                                         
                                                         T
                                                      
                                                      
                                                         x
                                                         
                                                            i
                                                            p
                                                            t
                                                         
                                                         s
                                                      
                                                      ·
                                                      
                                                         η
                                                         
                                                            i
                                                            p
                                                            t
                                                         
                                                         s
                                                      
                                                      ·
                                                      
                                                         
                                                            q
                                                            
                                                               i
                                                               p
                                                            
                                                         
                                                         
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  1
                                                               
                                                               I
                                                            
                                                            
                                                               ∑
                                                               
                                                                  p
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  P
                                                                  i
                                                               
                                                            
                                                            
                                                               q
                                                               
                                                                  i
                                                                  p
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (37)
                                       
                                          
                                             f
                                             =
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         I
                                                      
                                                      
                                                         ∑
                                                         
                                                            p
                                                            =
                                                            1
                                                         
                                                         
                                                            P
                                                            i
                                                         
                                                      
                                                      
                                                         y
                                                         
                                                            i
                                                            p
                                                         
                                                      
                                                      ·
                                                      
                                                         
                                                            q
                                                            
                                                               i
                                                               p
                                                            
                                                         
                                                         
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  1
                                                               
                                                               I
                                                            
                                                            
                                                               ∑
                                                               
                                                                  p
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  P
                                                                  i
                                                               
                                                            
                                                            
                                                               q
                                                               
                                                                  i
                                                                  p
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ︸
                                                
                                                
                                                   (
                                                   37
                                                   )
                                                   a
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      M
                                                      ·
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         I
                                                      
                                                      
                                                         ∑
                                                         
                                                            p
                                                            =
                                                            1
                                                         
                                                         
                                                            P
                                                            i
                                                         
                                                      
                                                      
                                                         (
                                                         1
                                                         −
                                                         
                                                            ∑
                                                            
                                                               s
                                                               =
                                                               1
                                                            
                                                            S
                                                         
                                                         
                                                            ∑
                                                            
                                                               t
                                                               =
                                                               1
                                                            
                                                            T
                                                         
                                                         
                                                            x
                                                            
                                                               i
                                                               p
                                                               t
                                                            
                                                            s
                                                         
                                                         )
                                                      
                                                   
                                                   ︸
                                                
                                                
                                                   (
                                                   37
                                                   )
                                                   b
                                                
                                             
                                          
                                       
                                    
                                 
                              

Now, let us define the stochastic reformulation 
                           
                              
                                 P
                                 S
                              
                              −
                              
                                 steps
                                 II
                              
                           
                         of the problem 
                           
                              
                                 P
                                 S
                              
                              −
                              
                                 steps
                                 I
                              
                           
                         by making the following modifications: minimize the objective function (37); eliminate constraints (29) and insert them directly into the objective function as shown in (36); relax joint constraints (19) (i.e. substitute the equal sign (=) by the smaller or equal (≤ )); and, add them into the objective function as expressed in (37)
                        b, while keeping the other constraints (20)–(34) the same.

                           Proposition 1
                           
                              Let < x
                              *, y
                              *, r
                              *, g
                              * > be an optimal solution of
                              
                                 
                                    
                                       P
                                       S
                                    
                                    −
                                    
                                       steps
                                       I
                                    
                                    ,
                                 
                               
                              then < x
                              *, y
                              *, r
                              *, g
                              * > is also optimal for
                              
                                 
                                    
                                       P
                                       S
                                    
                                    −
                                    
                                       steps
                                       II
                                    
                                 
                              
                              .
                           

Firstly, by taking into account (35), let us remark that for a large constant value of M (e.g. 
                                 
                                    M
                                    ≥
                                    max
                                    {
                                    
                                       η
                                       
                                          i
                                          p
                                          t
                                       
                                       s
                                    
                                    :
                                    ∀
                                    i
                                    ,
                                    ∀
                                    p
                                    ,
                                    ∀
                                    t
                                    ,
                                    ∀
                                    s
                                    }
                                 
                              ), a small value of (37)
                              b is associated with also a small value of (37)
                              a, and vice-versa. In fact, by minimizing (37)
                              b, we minimize (37)
                              a. Moreover, in the case when (37)
                              b attains zero value, 
                                 
                                    
                                       P
                                       S
                                    
                                    −
                                    
                                       steps
                                       I
                                    
                                 
                               and 
                                 
                                    
                                       P
                                       S
                                    
                                    −
                                    
                                       steps
                                       II
                                    
                                 
                               become equivalent.

If < x
                              *, y
                              *, r
                              *, g
                              * > is an optimal solution for 
                                 
                                    
                                       P
                                       S
                                    
                                    −
                                    
                                       steps
                                       I
                                    
                                    ,
                                 
                               thus constraints (19) are verified and subsequently, (37)
                              b is null. Hence, < x
                              *, y
                              *, r
                              *, g
                              * > is also optimal for 
                                 
                                    
                                       P
                                       S
                                    
                                    −
                                    
                                       steps
                                       II
                                    
                                 
                              .□

Obviously, any feasible problem 
                           
                              
                                 P
                                 S
                              
                              −
                              
                                 steps
                                 I
                              
                           
                         is equivalent to 
                           
                              
                                 P
                                 S
                              
                              −
                              
                                 steps
                                 II
                              
                           
                        . Since the interest of this study was elicited by a real-world application where the harvest must be accomplished, we have considered a sufficiently large number of steps S to make problem 
                           
                              
                                 P
                                 S
                              
                              −
                              
                                 steps
                                 I
                              
                           
                         feasible. Hence, in the following, let us address the 
                           
                              
                                 P
                                 S
                              
                              −
                              
                                 steps
                                 II
                              
                           
                         reformulation.

By virtue of proposition 1, properties (A)–(C) under a decision process following the trajectory (18), the considered multi-step stochastic problem can be represented in the form known as a classical discrete time Markov decision process (or discrete time stochastic dynamic program) (Dupačová, 2002). Drawing on the exogenous nature of uncertain weather parameters, the sub-optimality problem feature and by introducing the notion of harvest system state, we propose a proactive dynamic approach in the next section, which turns out to be suitable for capturing the specificities of the studied harvest scheduling problem, as well as for solving the multi-step stochastic reformulation 
                           
                              
                                 P
                                 S
                              
                              −
                              
                                 steps
                                 II
                              
                           
                        .

Traditionally, stochastic optimization problems are cataloged into two classes according to the nature of their uncertainty: exogenous and endogenous ones. Mercier and Van Hentenryck (2008) have refined this classification into purely exogenous, purely endogenous and Stoxuno (stochastic optimization with exogenous uncertainty and endogenous observations) problems.

From this point of view, the quality control problem is a purely exogenous problem, where all uncertainties are contained in the distribution of the random variables, which are independent of the decision taken during a step. Such a decision process is called an exogenous Markov decision process (Mercier & Van Hentenryck, 2008).

In order to address the harvest scheduling problem suitably, let us characterize the dynamics of the harvest system as an exogenous Markov decision process, which consists of:

                        
                           •
                           
                              Steps (stages): The harvest horizon is rolled forward in time and is constituted of an unfixed number of steps s (s = 1, 2,…).


                              Harvest system state: Instead of fixing the harvest horizon to J periods of time (or the number of steps to S), define the notion of harvest system state at step s by Δs
                              , which represents the total residual quantities 
                                 
                                    q
                                    
                                       i
                                       p
                                    
                                    s
                                 
                               to be gathered from all parcels Pi
                               (
                                 
                                    i
                                    =
                                    
                                       
                                          1
                                          ,
                                          I
                                       
                                       ¯
                                    
                                 
                              ) , where:

                                 
                                    (38)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                      
                                                         i
                                                         p
                                                      
                                                      1
                                                   
                                                   =
                                                   
                                                      q
                                                      
                                                         i
                                                         p
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   i
                                                   ,
                                                   ∀
                                                   p
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (39)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Δ
                                                      1
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      I
                                                   
                                                   
                                                      ∑
                                                      
                                                         p
                                                         =
                                                         1
                                                      
                                                      
                                                         P
                                                         i
                                                      
                                                   
                                                   
                                                      q
                                                      
                                                         i
                                                         p
                                                      
                                                      1
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (40)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Δ
                                                      s
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      I
                                                   
                                                   
                                                      ∑
                                                      
                                                         p
                                                         =
                                                         1
                                                      
                                                      
                                                         P
                                                         i
                                                      
                                                   
                                                   
                                                      q
                                                      
                                                         i
                                                         p
                                                      
                                                      s
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   s
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              Reward function at step s: Denote by f s
                               the objective function corresponding to the step s. Owing to the expression (36) and considering the objective function as used for 
                                 
                                    
                                       P
                                       S
                                    
                                    −
                                    
                                       steps
                                       II
                                    
                                    ,
                                 
                               the recurrent relations (41) and (42) are obtained. Hence, the one-period reward function (immediate return) Rs
                               is deducted, as shown in the expression (42), if at step s the system is in the state Δs
                               and the three-dimensional decision < x, r, g > is taken.

                                 
                                    (41)
                                    
                                       
                                          
                                             f
                                             1
                                          
                                          =
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             I
                                          
                                          
                                             ∑
                                             
                                                p
                                                =
                                                1
                                             
                                             
                                                P
                                                i
                                             
                                          
                                          
                                             ∑
                                             
                                                t
                                                =
                                                1
                                             
                                             T
                                          
                                          
                                             x
                                             
                                                i
                                                p
                                                t
                                             
                                             1
                                          
                                          ·
                                          
                                             η
                                             
                                                i
                                                p
                                                t
                                             
                                             1
                                          
                                          ·
                                          
                                             
                                                q
                                                
                                                   i
                                                   p
                                                
                                                1
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   I
                                                
                                                
                                                   ∑
                                                   
                                                      p
                                                      =
                                                      1
                                                   
                                                   
                                                      P
                                                      i
                                                   
                                                
                                                
                                                   q
                                                   
                                                      i
                                                      p
                                                   
                                                   1
                                                
                                             
                                          
                                          −
                                          M
                                          ·
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             I
                                          
                                          
                                             ∑
                                             
                                                p
                                                =
                                                1
                                             
                                             
                                                P
                                                i
                                             
                                          
                                          
                                             ∑
                                             
                                                t
                                                =
                                                1
                                             
                                             T
                                          
                                          
                                             x
                                             
                                                i
                                                p
                                                t
                                             
                                             1
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (42)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                      s
                                                   
                                                   =
                                                   
                                                      f
                                                      
                                                         s
                                                         −
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      I
                                                   
                                                   
                                                      ∑
                                                      
                                                         p
                                                         =
                                                         1
                                                      
                                                      
                                                         P
                                                         i
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      T
                                                   
                                                   
                                                      x
                                                      
                                                         i
                                                         p
                                                         t
                                                      
                                                      s
                                                   
                                                   ·
                                                   
                                                      η
                                                      
                                                         i
                                                         p
                                                         t
                                                      
                                                      s
                                                   
                                                   ·
                                                   
                                                      
                                                         q
                                                         
                                                            i
                                                            p
                                                         
                                                         s
                                                      
                                                      
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            I
                                                         
                                                         
                                                            ∑
                                                            
                                                               p
                                                               =
                                                               1
                                                            
                                                            
                                                               P
                                                               i
                                                            
                                                         
                                                         
                                                            q
                                                            
                                                               i
                                                               p
                                                            
                                                            s
                                                         
                                                      
                                                   
                                                   −
                                                
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   M
                                                   ·
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      I
                                                   
                                                   
                                                      ∑
                                                      
                                                         p
                                                         =
                                                         1
                                                      
                                                      
                                                         P
                                                         i
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      T
                                                   
                                                   
                                                      x
                                                      
                                                         i
                                                         p
                                                         t
                                                      
                                                      s
                                                   
                                                   ,
                                                   ∀
                                                   s
                                                   >
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              (Deterministic) Transition functions: The transformation (or transition) of the harvest system from the state Δ
                              
                                 s − 1 and the decision taken at step (s − 1) into the state Δs
                               at the next stage are expressed by the following formulae, for each ∀i, ∀p, ∀t, ∀s > 1:

                                 
                                    (43)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      
                                                         i
                                                         p
                                                         t
                                                      
                                                      s
                                                   
                                                   =
                                                   
                                                      x
                                                      
                                                         i
                                                         p
                                                         t
                                                      
                                                      s
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         
                                                            i
                                                            p
                                                            t
                                                         
                                                         
                                                            [
                                                            s
                                                            −
                                                            1
                                                            ]
                                                         
                                                      
                                                      )
                                                   
                                                   :
                                                   
                                                      q
                                                      
                                                         i
                                                         p
                                                      
                                                      s
                                                   
                                                   =
                                                   
                                                      q
                                                      
                                                         i
                                                         p
                                                      
                                                      
                                                         s
                                                         −
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         p
                                                         =
                                                         1
                                                      
                                                      
                                                         P
                                                         i
                                                      
                                                   
                                                   
                                                      x
                                                      
                                                         i
                                                         p
                                                         t
                                                      
                                                      
                                                         [
                                                         s
                                                         −
                                                         1
                                                         ]
                                                      
                                                   
                                                   ·
                                                   
                                                      q
                                                      
                                                         i
                                                         p
                                                      
                                                      
                                                         s
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (44)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                      
                                                         i
                                                         p
                                                         t
                                                      
                                                      s
                                                   
                                                   =
                                                   
                                                      g
                                                      
                                                         i
                                                         p
                                                         t
                                                      
                                                      s
                                                   
                                                   
                                                      (
                                                      
                                                         g
                                                         
                                                            i
                                                            p
                                                            t
                                                         
                                                         
                                                            [
                                                            s
                                                            −
                                                            1
                                                            ]
                                                         
                                                      
                                                      )
                                                   
                                                   :
                                                   
                                                      g
                                                      
                                                         i
                                                         p
                                                         1
                                                      
                                                      s
                                                   
                                                   ≥
                                                   
                                                      g
                                                      
                                                         i
                                                         p
                                                         T
                                                      
                                                      
                                                         s
                                                         −
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         =
                                                         1
                                                      
                                                      
                                                         s
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         
                                                            t
                                                            ′
                                                         
                                                         =
                                                         1
                                                      
                                                      T
                                                   
                                                   
                                                      x
                                                      
                                                         i
                                                         p
                                                         
                                                            t
                                                            ′
                                                         
                                                      
                                                      
                                                         s
                                                         ′
                                                      
                                                   
                                                   +
                                                   
                                                      r
                                                      t
                                                      s
                                                   
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              Decision (action) taken at step 
                              
                                 s
                              
                              : Let Ωs
                               be the problem weather availability scenarios set corresponding to each step s, where 
                                 
                                    
                                       ω
                                       s
                                    
                                    =
                                    
                                       (
                                       
                                          ξ
                                          1
                                          
                                             ω
                                             s
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          ξ
                                          T
                                          
                                             ω
                                             s
                                          
                                       
                                       )
                                    
                                 
                               and their associated joint discrete probability: 
                                 
                                    P
                                    
                                       (
                                       
                                          ω
                                          s
                                       
                                       )
                                    
                                    =
                                    
                                       ∏
                                       
                                          t
                                          =
                                          1
                                       
                                       T
                                    
                                    P
                                    
                                       (
                                       
                                          ξ
                                          t
                                          
                                             ω
                                             s
                                          
                                       
                                       )
                                    
                                    ,
                                 
                               ∀ωs
                               ∈ Ωs
                               at step s. Furthermore, let 
                                 
                                    
                                       Ω
                                       ˜
                                    
                                    s
                                 
                               be the set of (1 − α)-pertinent incomparable scenarios. For the sake of clarity, let us recapitulate some related definitions:

Let 
                              P
                            be a discrete probability distribution having a finite support Ω. Let 
                              
                                 
                                    ω
                                    s
                                 
                                 =
                                 
                                    (
                                    
                                       ξ
                                       1
                                       s
                                    
                                    ,
                                    
                                       ξ
                                       2
                                       s
                                    
                                    ,
                                    …
                                    
                                       ξ
                                       J
                                       s
                                    
                                    )
                                 
                              
                            and 
                              
                                 
                                    ω
                                    t
                                 
                                 =
                                 
                                    (
                                    
                                       ξ
                                       1
                                       t
                                    
                                    ,
                                    
                                       ξ
                                       2
                                       t
                                    
                                    ,
                                    …
                                    
                                       ξ
                                       J
                                       t
                                    
                                    )
                                 
                              
                            be two J-dimensional scenario realizations, ∀ωs, ωt
                            ∈ Ω. The scenario ωs
                            is greater or equal to ωt, ωs
                            ≥ ωt
                            if 
                              
                                 
                                    ξ
                                    j
                                    s
                                 
                                 ≥
                                 
                                    ξ
                                    j
                                    t
                                 
                                 ,
                                 ∀
                                 j
                                 =
                                 
                                    
                                       1
                                       ,
                                       J
                                    
                                    ¯
                                 
                              
                           . And, respectively, ωt
                            is smaller or equal to ωs, ωt
                            ≤ ωs
                           . Moreover, if ωs
                            is neither greater nor smaller to ωt
                           , the scenario ωs
                            is considered incomparable with ωt
                           .

Let 
                              P
                            be a discrete probability distribution having a finite support Ω, i.e. a finitely many scenarios ω = (ξ
                           1, ξ
                           2, …ξJ
                           ) with associated probabilities pω
                           . The scenario ω is named (1 − α)-pertinent if 
                              
                                 
                                    ∑
                                    
                                       
                                          
                                             
                                                
                                                   ω
                                                   ′
                                                
                                                ≥
                                                ω
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ω
                                                   ′
                                                
                                                ∈
                                                Ω
                                             
                                          
                                       
                                    
                                 
                                 
                                    p
                                    
                                       ω
                                       ′
                                    
                                 
                                 ≥
                                 1
                                 −
                                 α
                              
                           .

Let 
                        
                           
                              Ω
                              ˜
                           
                           s
                        
                      be the subset of (1 − α)-pertinent scenarios and incomparable between them (
                        
                           
                              
                                 Ω
                                 ˜
                              
                              s
                           
                           ⊂
                           
                              Ω
                              s
                           
                        
                     ). In order to tackle the non-linear probabilistically joint constraint (21) and pursuing the chance-constrained programming research efforts (Borodin et al., 2014b; Shapiro, Dentcheva, & A., 2009), let us introduce the binary variables 
                        
                           
                              λ
                              
                                 
                                    ω
                                    ˜
                                 
                              
                              s
                           
                           ,
                        
                      associated to each (1 − α)-pertinent incomparable scenarios 
                        
                           
                              ω
                              s
                           
                           ˜
                        
                      at step s (
                        
                           
                              
                                 ω
                                 s
                              
                              ˜
                           
                           ∈
                           
                              
                                 Ω
                                 ˜
                              
                              s
                           
                        
                     ). These variables 
                        
                           λ
                           
                              
                                 ω
                                 ˜
                              
                           
                           s
                        
                      are defined to take the value 1 if the probabilistic constraints (21) are satisfied for the (1 − α)-pertinent scenario ωs
                     , and 0 otherwise. In this manner, (21) can be rewritten using deterministic constraints (21a) and (21b):

                        
                           (21a)
                           
                              
                                 
                                    
                                       
                                          
                                             r
                                             t
                                             s
                                          
                                          −
                                          
                                             (
                                             
                                                ξ
                                                t
                                                
                                                   
                                                      ω
                                                      s
                                                   
                                                   ˜
                                                
                                             
                                             −
                                             
                                                λ
                                                
                                                   
                                                      
                                                         ω
                                                         s
                                                      
                                                      ˜
                                                   
                                                
                                                s
                                             
                                             )
                                          
                                          ≤
                                          1
                                          ,
                                          
                                          ∀
                                          t
                                          ,
                                          ∀
                                          
                                             
                                                ω
                                                s
                                             
                                             ˜
                                          
                                          ,
                                          ∀
                                          s
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (21b)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      ω
                                                      s
                                                   
                                                   ˜
                                                
                                                =
                                                1
                                             
                                             
                                                
                                                   |
                                                
                                                
                                                   
                                                      Ω
                                                      ˜
                                                   
                                                   s
                                                
                                                
                                                   |
                                                
                                             
                                          
                                          
                                             λ
                                             
                                                
                                                   
                                                      ω
                                                      s
                                                   
                                                   ˜
                                                
                                             
                                             s
                                          
                                          ≥
                                          1
                                          ,
                                          
                                          ∀
                                          s
                                       
                                    
                                 
                              
                           
                        
                     
                  

The correctness of this kind of transformation and the equivalence between constraints (21) and (21a)--(21b) are proved in Borodin et al. (2014b).

Hence, by summarizing the aforementioned remarks and results, an equivalent deterministic mixed integer reformulation 
                        
                           
                              P
                              s
                           
                           −
                           
                              step
                              MIP
                           
                        
                      for one-step wheat quality control problem can be modeled by the objective function (42) subject to (21a), (21b) and (45)–(56).

                        
                           (42)
                           
                              
                                 min
                                 
                                 
                                    R
                                    s
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             I
                                          
                                          
                                             ∑
                                             
                                                p
                                                =
                                                1
                                             
                                             
                                                P
                                                i
                                             
                                          
                                          
                                             ∑
                                             
                                                t
                                                =
                                                1
                                             
                                             T
                                          
                                          
                                             x
                                             
                                                i
                                                p
                                                t
                                             
                                             s
                                          
                                          ·
                                          
                                             η
                                             
                                                i
                                                p
                                                t
                                             
                                             s
                                          
                                          ·
                                          
                                             
                                                q
                                                
                                                   i
                                                   p
                                                
                                                s
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   I
                                                
                                                
                                                   ∑
                                                   
                                                      p
                                                      =
                                                      1
                                                   
                                                   
                                                      P
                                                      i
                                                   
                                                
                                                
                                                   q
                                                   
                                                      i
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                       ︸
                                    
                                    
                                       (
                                       42
                                       )
                                       a
                                    
                                 
                                 −
                                 M
                                 ·
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    I
                                 
                                 
                                    ∑
                                    
                                       p
                                       =
                                       1
                                    
                                    
                                       P
                                       i
                                    
                                 
                                 
                                    ∑
                                    
                                       t
                                       =
                                       1
                                    
                                    T
                                 
                                 
                                    x
                                    
                                       i
                                       p
                                       t
                                    
                                    s
                                 
                              
                           
                        
                     
                     
                        
                           (45)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                t
                                                =
                                                1
                                             
                                             T
                                          
                                          
                                             x
                                             
                                                i
                                                p
                                                t
                                             
                                             s
                                          
                                          ≤
                                          1
                                          ,
                                          
                                          ∀
                                          i
                                          ,
                                          ∀
                                          p
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (46)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                p
                                                =
                                                1
                                             
                                             
                                                P
                                                i
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                p
                                                t
                                             
                                             s
                                          
                                          ·
                                          
                                             q
                                             
                                                i
                                                p
                                             
                                             s
                                          
                                          ≤
                                          
                                             c
                                             i
                                          
                                          ,
                                          
                                          ∀
                                          i
                                          ,
                                          ∀
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (21a)
                           
                              
                                 
                                    
                                       
                                          
                                             r
                                             t
                                             s
                                          
                                          −
                                          
                                             (
                                             
                                                ξ
                                                t
                                                
                                                   
                                                      ω
                                                      s
                                                   
                                                   ˜
                                                
                                             
                                             −
                                             
                                                λ
                                                
                                                   
                                                      
                                                         ω
                                                         s
                                                      
                                                      ˜
                                                   
                                                
                                                s
                                             
                                             )
                                          
                                          ≤
                                          1
                                          ,
                                          
                                          ∀
                                          t
                                          ,
                                          ∀
                                          
                                             
                                                ω
                                                s
                                             
                                             ˜
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (21b)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      ω
                                                      s
                                                   
                                                   ˜
                                                
                                                =
                                                1
                                             
                                             
                                                
                                                   |
                                                
                                                
                                                   
                                                      Ω
                                                      ˜
                                                   
                                                   s
                                                
                                                
                                                   |
                                                
                                             
                                          
                                          
                                             λ
                                             
                                                
                                                   
                                                      ω
                                                      s
                                                   
                                                   ˜
                                                
                                             
                                             s
                                          
                                          ≥
                                          1
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (47)
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                             
                                                i
                                                p
                                                t
                                             
                                             s
                                          
                                          ≤
                                          
                                             g
                                             
                                                i
                                                p
                                                t
                                             
                                             s
                                          
                                          ,
                                          
                                          ∀
                                          i
                                          ,
                                          ∀
                                          p
                                          ,
                                          ∀
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (48)
                           
                              
                                 
                                    
                                       
                                          N
                                          ·
                                          
                                             x
                                             
                                                i
                                                p
                                                t
                                             
                                             s
                                          
                                          ≥
                                          
                                             g
                                             
                                                i
                                                p
                                                t
                                             
                                             s
                                          
                                          ,
                                          
                                          ∀
                                          i
                                          ,
                                          ∀
                                          p
                                          ,
                                          ∀
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (49)
                           
                              
                                 
                                    
                                       
                                          
                                             r
                                             
                                                t
                                             
                                             s
                                          
                                          ≤
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             I
                                          
                                          
                                             ∑
                                             
                                                p
                                                =
                                                1
                                             
                                             
                                                P
                                                i
                                             
                                          
                                          
                                             g
                                             
                                                i
                                                p
                                                t
                                             
                                             s
                                          
                                          ,
                                          
                                          ∀
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (50)
                           
                              
                                 
                                    
                                       
                                          N
                                          ·
                                          
                                             r
                                             
                                                t
                                             
                                             s
                                          
                                          ≥
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             I
                                          
                                          
                                             ∑
                                             
                                                p
                                                =
                                                1
                                             
                                             
                                                P
                                                i
                                             
                                          
                                          
                                             g
                                             
                                                i
                                                p
                                                t
                                             
                                          
                                          ,
                                          
                                          ∀
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (51)
                           
                              
                                 
                                    
                                       
                                          
                                             g
                                             
                                                i
                                                p
                                                t
                                             
                                             s
                                          
                                          ·
                                          
                                             (
                                             
                                                (
                                                s
                                                −
                                                1
                                                )
                                             
                                             ·
                                             T
                                             +
                                             t
                                             −
                                             
                                                d
                                                
                                                   i
                                                   p
                                                
                                             
                                             )
                                          
                                          ≥
                                          0
                                          ,
                                          
                                          ∀
                                          i
                                          ,
                                          ∀
                                          p
                                          ,
                                          ∀
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (52)
                           
                              
                                 
                                    
                                       
                                          
                                             g
                                             
                                                i
                                                p
                                                t
                                             
                                             s
                                          
                                          ≥
                                          
                                             g
                                             
                                                i
                                                p
                                                (
                                                t
                                                −
                                                1
                                                )
                                             
                                             s
                                          
                                          −
                                          
                                             ∑
                                             
                                                
                                                   t
                                                   ′
                                                
                                                =
                                                1
                                             
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                p
                                                
                                                   t
                                                   ′
                                                
                                             
                                             s
                                          
                                          +
                                          
                                             r
                                             t
                                             s
                                          
                                          −
                                          1
                                          ,
                                          
                                          ∀
                                          i
                                          ,
                                          ∀
                                          p
                                          ,
                                          ∀
                                          t
                                          >
                                          1
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (53)
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                             
                                                i
                                                p
                                                t
                                             
                                             s
                                          
                                          =
                                          
                                             x
                                             
                                                i
                                                p
                                                t
                                             
                                             s
                                          
                                          
                                             (
                                             
                                                x
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                
                                                   [
                                                   s
                                                   −
                                                   1
                                                   ]
                                                
                                             
                                             )
                                          
                                          ,
                                          
                                          ∀
                                          i
                                          ,
                                          ∀
                                          p
                                          ,
                                          ∀
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (54)
                           
                              
                                 
                                    
                                       
                                          
                                             g
                                             
                                                i
                                                p
                                                t
                                             
                                             s
                                          
                                          =
                                          
                                             g
                                             
                                                i
                                                p
                                                t
                                             
                                             s
                                          
                                          
                                             (
                                             
                                                g
                                                
                                                   i
                                                   p
                                                   t
                                                
                                                
                                                   [
                                                   s
                                                   −
                                                   1
                                                   ]
                                                
                                             
                                             )
                                          
                                          ,
                                          
                                          ∀
                                          i
                                          ,
                                          ∀
                                          p
                                          ,
                                          ∀
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (55)
                           
                              
                                 
                                    
                                       
                                          0
                                          ≤
                                          
                                             x
                                             
                                                i
                                                p
                                                t
                                             
                                             s
                                          
                                          ≤
                                          1
                                          ,
                                          
                                          ∀
                                          i
                                          ,
                                          ∀
                                          p
                                          ,
                                          ∀
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (56)
                           
                              
                                 
                                    
                                       
                                          
                                             r
                                             
                                                t
                                             
                                             s
                                          
                                          ,
                                          
                                             g
                                             
                                                i
                                                p
                                                t
                                             
                                             s
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          ,
                                          
                                          ∀
                                          i
                                          ,
                                          ∀
                                          p
                                          ,
                                          ∀
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                  

In order to solve the quality control problem 
                        
                           
                              P
                              s
                           
                           −
                           
                              step
                              MIP
                           
                           ,
                        
                      we propose the following proactive dynamic framework, given in Algorithm 1:


                     
                        
                           
                        
                     
                  

The interest of this paper was raised by a real-world crop quality control problem encountered at an agricultural cooperative society, situated in the region of Arcis-sur-Aube (France). Specifically, it is a cereal and oilseed agricultural cooperative, for which the wheat seed production amounts to around 45–60% of its total annual crop production.

Problem instances are derived from historical real data on the harvest of wheat crops provided by the agricultural cooperative case study. Usually, the harvest lasts about one month and a half (i.e. 
                        
                           25
                           ≤
                           
                              ∑
                              
                                 s
                                 =
                                 1
                              
                              S
                           
                           
                              T
                              s
                           
                           ≤
                           40
                        
                     ). During this period, meteorological uncertain data can be requested from the nearest weather stations with an acceptable reliability level at each time-step period of T = 5 consecutive days (the variance of the scenario random variables varies between 0.04 and 0.09, 
                        
                           
                              σ
                              ξ
                              2
                           
                           ∈
                           
                              [
                              0.04
                              ,
                              0.09
                              ]
                           
                        
                     ). The information related to ripeness dates and Hagberg falling numbers for each case study parcel have been provided by a technically competent organization in agronomy and, in particular, in crop agriculture. The tests were run for I = 19 agricultural holdings having a number of parcels Pi
                      which ranged from 2 to 20, with a daily harvest capacity varying between 80 and 381 tonnes. Data are modified slightly to ensure confidentiality.

The proposed proactive dynamic approach has been implemented by using the C++ programming language. The deterministic equivalent sub-problems corresponding to each step 
                        
                           
                              P
                              s
                           
                           −
                           
                              step
                              MIP
                           
                        
                      have been solved by using ILOG CPLEX (version 12.6.0) optimization software for a confidence level (1 − α) ≥ 0.8.

In order to verify the feasibility and effectiveness of the proposed proactive dynamic approach in a realistic environment, weather uncertainties and solution realizations at each step have been reproduced by using the commercial simulation language SIMAN in the Arena Rockwell Automation environment (version 13.0). The integration of ILOG CPLEX and Arena (both being commercially available off-the-shelf software packages) are realized via a user-written C++ application as depicted in Fig. 12
                     
                        1
                     
                     
                        1
                        
                           http://www.arenasimulation.com/
                        
                     
                     ,
                     
                        2
                     
                     
                        2
                        
                           http://www-01.ibm.com/software/commerce/optimization/cplex-optimizer/
                        
                     . Computational experiments have been carried out on an Intel(R) Core(TM) i7-2720QM CPU 2.20 gigahertz workstation.

In contrast to deterministic problems, where measuring the performance is tangible (e.g. solutions quality, running times, etc.), dynamic stochastic problems require the use of other metrics to evaluate the performance of a particular model or method (Pillac et al., 2013). In this sense, to assess the feasibility and robustness of the proposed rolling forward multi-step chance-constrained model, let us use the following comparison performance metrics:

                        
                           •
                           
                              ν(SRH): Expected value obtained from using the static stochastic model in a rolling framework (SRH) (Wagner & Berman, 1995). The decision process is approximated by optimal solutions obtained by repeatedly solving similar δ stochastic programs, which are rolled in time step-by-step. In this technique, neither the notion of system state nor transition constraints (43) and (44) are required, i.e. no solution realization adjustments are made. The value ν(SRH) has been calculated by solving δ static programs 
                                 
                                    P
                                    static
                                 
                               without constraints (5) for J = 5, where δ initially is fixed to 1 and incremented while the harvest process is not finished.


                              ν(PDF): Expected value obtained from using the proposed proactive dynamic framework.

OVS: Observed value after the PDF solutions implementation in a realistic environment, reproduced via a discrete event simulation model of the studied problem. For further information about the simulation model, refer to paper (Borodin, Bourtembourg, Hnaien, & Labadie, 2014a).

Firstly, let us discuss Table 2
                     , which reports the results for 10 case study inspired instances. The gap for an instance I and step s is defined as the ratio 
                        
                           
                              
                                 
                                    Θ
                                    s
                                 
                                 
                                    (
                                    I
                                    )
                                 
                                 −
                                 
                                    
                                       Θ
                                       ˜
                                    
                                    s
                                 
                                 
                                    (
                                    I
                                    )
                                 
                              
                              
                                 
                                    
                                       Θ
                                       ˜
                                    
                                    s
                                 
                                 
                                    (
                                    I
                                    )
                                 
                              
                           
                           ,
                        
                      where Θs
                     (I) represents the total quantity to be gathered found by the PDF approach at the step s and 
                        
                           
                              
                                 Θ
                                 ˜
                              
                              s
                           
                           
                              (
                              I
                              )
                           
                        
                      denotes the OVS total quantity value at the same step. Moreover, the fourth and sixth columns detail the expected liquefaction number 
                        
                           η
                           M
                           s
                        
                      
                     (42)
                     a of the gathered mixture at step s and its observed realization 
                        
                           
                              
                                 η
                                 ˜
                              
                              M
                              s
                           
                           ,
                        
                      respectively. Note that running CPU times for PDF are around 0.53 seconds on average for the calculation of one-step solution and 50 seconds for subsequent simulation, while simulation optimization transition times are negligible.

It can be seen from Table 2 that no solution gaps between PDF and OVS approaches are propagated across the different steps. The PDF approach adjusts the solution at following steps, if it is the case. Hence, the latter appears flexible and more immune to eventual unforeseen bad weather.


                     Table 3
                      compares PDF and SRH approaches. More precisely, the second and fourth column give the approach induced degree of dynamism δ, which represents the number of dynamic step requests. The third and fifth columns contain the average gaps against observed solution realization via simulation, over an induced number of steps per instance. These results show that PDF consistently and considerably outperforms the SRH approach. Even SRH sometimes induces a smaller δ, which of course entails smaller running times, PDF presents significantly more competitive results, on average 5.57 versus 26.44.

The harvest progress, while minimizing the expected liquefaction number of wheat mixture from all parcels, is further illustrated for all three approaches: SRH, PDF and OVS (see Figs. 2–11
                     
                     
                     
                     
                     
                     
                     
                     
                     
                     
                     ). Even SRH behaves adequately enough and pro-actively as attested by the appearance of the graphs, no steps solution adjustments are made, which disseminate past occurred solution gaps and has a considerable impact on the quality of the total harvested crop mixture. On the other hand, as attested in Figs. 2–11, PDF follows the realistic conjuncture modeled via OVS by proposing weather proactive solutions and remedying past recorded solution gaps.

This paper addresses the wheat quality control problem during the harvest season, modeled as a stochastic programming model rolled forward under probabilistic constraints. Moreover, a proactive dynamic framework is proposed and computational experiments are conducted and discussed for real-world inspired instances. As highlighted from obtained results, the proactive dynamic framework turns out to be flexible and responsive under eventual unforeseen weather circumstances. We argue that the solution methodology presented in this paper can address various exogenous stochastic scheduling problems arising from the agricultural sector, where harvesting is possible only before or after product ripeness dates respectively, for all considered parcels (e.g. grape harvest, etc.).

Future work would be devoted to solving the general case of the crop quality control problem, where both premature and delayed harvests are authorized simultaneously. In this case, the solution sub-optimal property is not yet true, and thus, the corresponding multi-step stochastic program cannot be represented as a Markov decision process. However, dynamic chance-constrained programming with a multi-step anticipatory approach, which seems to be a sound approach, would be tested, adapted and implemented if appropriate, in order to tackle the quality control problem for different families of cereal crops.

@&#ACKNOWLEDGEMENT@&#

The authors would like to acknowledge gratefully ARVALIS—Institut du végétal for providing a posteriori ripeness dates and Hagberg falling number for a number of case study parcels.

@&#REFERENCES@&#

