@&#MAIN-TITLE@&#A resource constrained scheduling problem with multiple independent producers and a single linking constraint: A coal supply chain example

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We model a RCSP with multiple producers and a single linking constraint.


                        
                        
                           
                           The problem is decomposed and solved with column generation techniques.


                        
                        
                           
                           Additional stabilisation techniques and improvements are explored.


                        
                        
                           
                           The CG algorithm is compared with a Lagrangian relaxation algorithm.


                        
                        
                           
                           Detailed computational experiments and results are also presented.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Distributed decision making

Coordinated scheduling

Resource constrained scheduling

Column generation

Job scheduling

@&#ABSTRACT@&#


               
               
                  This paper examines a resource constrained production planning and scheduling problem motivated by the coal supply chain. In this problem, multiple independent producers are connected with a resource availability (or, linking) constraint. A general description of such problems is provided, before decomposing the problem into two levels. In the first level, we deal with production planning and in the second level, we deal with tactical resource scheduling. A real-world coal supply chain example is presented to anchor the approach. The overall problem can be formulated as an integrated mixed integer programming model which, in several cases, struggles to find even a feasible solution in reasonable amount of time. This paper discusses a distributed decision making approach based on column generation (CG). Computational experiments show that, the CG scheme has significant advantages over the integrated model and a Lagrangian relaxation scheme proposed by Thomas et al. (2013). This paper concludes with detailed discussions on the results and future research directions.
               
            

@&#INTRODUCTION@&#

In this paper, we consider a resource constrained planning and scheduling problem in a supply chain in which many independent producers (or service providers) coordinate with a resource manager who provides resources such as trucks, trains or infrastructure, to transport products to their destinations. In such supply chains, producers independently make planning decisions and the resource manager (an independent decision maker) makes scheduling decisions that collectively affect the efficiency of the supply chain. The supply chain’s objective is to ensure a feasible allocation of resources that minimises total system cost.

There are several real-life supply chains of this sort. In coal supply chains, multiple independent mines (producers) are often connected to a shipping terminal via a shared rail network. A single rail operator (resource manager) often coordinates rail schedules with the mines, to schedule trains (or, trips) between the mines and the shipping terminal in order to meet shipping orders (or, demand) of each mine (see, for example, Singh et al., 2012 and Thomas et al., 2013). A similar problem is also observed in wine supply chains (see Singh et al., 2005) in which, each grower has contracts with many wineries. Each winery needs certain varieties of grapes based on their production requirements. These need to be delivered to them in a preferred sequence. The winery needs to coordinate harvesting and transport of grapes to minimise wastage and waiting time (reducing perishability) and to maximise resource utilisation (of crushers, fermenters). See Singh et al. (2005) for a detailed analysis of coordinated scheduling problems wine supply chains in Australia.

In a general problem, each independent producer receives a set of orders from their customers. These orders can be satisfied with different combinations of shared/common resources. The resources are often be grouped into classes based on their properties. The resource manager has a finite number of resources in each class. Therefore, there will be a conflict if the producers’ requests exceed the availability of these resources. At the production planning level, producers are not concerned about resource availability in each class. For producers, fulfilment of orders of all customers is of far greater importance. An optimal allocation and scheduling of resources is subsequently necessary to improve the overall performance, which can be achieved via either a cost minimisation, profit maximisation or a makespan or tardiness objective.

It is possible to formulate (and maybe solve) the above supply chain problem in an integrated manner. In such a model, we could consider a single decision-making problem that includes all producers and the resource manager. Such an integrated model is likely to be large and complex. Most scheduling problems are NP-hard (see Brucker and Knust, 2006; Lenstra et al., 1977). The integrated scheduling problem adds to this complexity because the producers and the resource manager are independent decision making entities who are often reluctant to coordinate fully and transparently, to share their competitive information.

In this paper, we develop an approach, using a customised column generation (CG) scheme, to solve resource allocation and resource scheduling problems. In the production planning stage, each producer defines a possible allocation of resources. This means that resource allocation and its scheduling can be carried out sequentially. Thus, the original problem is decomposed into smaller solvable sub-problems. Essentially, we develop a distributed decision making framework which is solved using a decomposition approach. Even though we explain the proposed solution approaches in the context of a coal supply chain, our method can be extended to other similar supply chains too. Section 2 provides a summary of related work. Section 3 describes the problem and its features. Section 4 explains the production planning problem for each producer. In Sections 5 and 6 we present a CG algorithm and its improvements, respectively. Section 7 gives an overview of the datasets and performance measures. Section 8 summarises detailed results and comparisons of the different modelling approaches.

@&#RELATED WORK@&#

Integrated models are often solved using decomposition techniques such as Lagrangian relaxation, column generation and Benders decomposition. The vast literature available in this topic highlights its advantages and practical applications. For example, decomposition approaches are able to handle the complexity of planning and scheduling problems (see Wang et al., 2008). Given the inherent complexity of distributed decision making problems, decomposition methods can be employed for solving these problems. Bracken and McGill (1973) introduced hierarchical optimisation as a generalisation of mathematical programming, where a series of optimisation problems are solved in a predetermined sequence. In this, independent decision makers are considered separately, thereby reducing the problem size and complexity of the integrated model. Decomposed optimisation techniques have been extended to job-shop scheduling problems (see Brandimarte and Calderini, 1995; Zribi et al., 2007), resource constrained scheduling problems (RCSP) (see Hans et al., 2007; Kelly and Zyngier, 2008), manufacturing problems (see Wu and Ierapetritou, 2007; Ebadian et al., 2009; Timm and Blecken, 2011). Pochet and Wolsey (2006) discuss different production planning models and mixed integer programming formulations. They suggest many practical reformulation techniques and polyhedral results to strengthen the model and solve it effectively.


                     Dantzig and Wolfe (1960) introduced an efficient decomposition algorithm for a special class of problems. Today, Dantzig–Wolfe decomposition (DWD) is a widely applied solution approach for solving large optimisation problems. Column generation (CG) methods have been incorporated along with the DWD to successfully solve many problems such as the cutting-stock problem, vehicle routing problem, crew scheduling problem, p-median problem, and graph colouring problem (see Borndorfer et al., 2005; Lubbecke and Desrosiers, 2005; Vanderbeck and Wolsey, 2010). Read Desrosiers and Lubbecke (2005) for an introduction to CG and its key features. Choi and Tcha (2007) proposed a CG approach to address a heterogeneous-fleet vehicle routing problem. Capone et al. (2010) compare two variants of CG schemes developed for a resource allocation problem in wireless mesh networks. All of these show that the CG scheme is effective for solving large problems. Wentges (1997) introduced a weighted DWD and presented some results on the convergence of this scheme under certain conditions. Pessoa et al. (2010) discuss a stronger convergence of this algorithm. The major issues concerned with DWD are slow convergence and stabilisation of dual prices. Ben Amor et al. (2009) and Vanderbeck and Wolsey (2010) analyse some of the latest (dual price) stabilisation techniques.


                     Thomas et al. (2013) propose a decomposition algorithm based on the Lagrangian relaxation (LR) to solve a similar problem. The main contributions of Thomas et al. (2013) are: (i) the mathematical models for production planning; (ii) distributed algorithm based on the LR and improvements with the Volume algorithm and the Wedelin algorithm; (iii) heuristics to compute the upper bound; and (iv) extensive computational experiments. The authors highlight the advantages of a distributed decision making approach over an integrated approach. Even though the LR algorithm performed better than the integrated model, it was time consuming for larger problems. Hence CG algorithms are explored to solve the integrated problem. A combination of multiple stabilisation methods are explored to improve the performance of the CG algorithm. Rather than directly applying the CG algorithm, we discuss and customise a few techniques that improve the computational efficiency.

Consider a model where a set of independent producers are connected with a single shared resource constraint. The constraints of each producer have some influence on the utilisation of the shared resource, which, in reality, is the independent decision of the resource manager. Since the resources are finite, these independent producers have to coordinate (implicitly) through the resource manager to achieve a better decision outcome for themselves. There are multiple ways to model and solve this problem. The first option is to model and solve this as a single large mixed integer programming problem. This model has to include all the constraints from the producers and the resource manager. Since this model integrates all the independent decision makers, we refer to it as the integrated model. Practical instances of such problems tend to be very large-sized. The integrated model has many solvable production planning sub-problems, and one resource scheduling problem linking the single resource manager and the (many) producers. Thus, we decompose the problem into two parts:
                        
                           •
                           
                              Production planning: Each producer plans its production based on its priorities and objective, and places a set of requests to the resource manager for a certain number of resources. In other words, each producer defines a set of requests (jobs) to meet its orders.


                              Resource scheduling: After receiving the requests (jobs) from the producers, the resource manager prepares a schedule based on resource availability. This problem is equivalent to a job scheduling problem.

As a result of this decomposition, decisions are separated and distributed across the many independent partners in the system. Therefore, in such distributed models, it is not necessary to share too much information between the independent partners; while this is, of course, necessary in the integrated model. To understand the formulation and solution approaches better, we explain the problem with the help of an example from a coal supply chain.

In a coal supply chain, many mines produce/mine coal based on the market demand and use a single rail operator to transport the coal to a shipping terminal. The coal supply chain has multiple independent mines (or, a collection of mines owned by different owners). For the sake of simplicity, in this paper, we assume that each mine belongs to an owner. Coal is transported from the mines (producers) to the terminal, mainly using the rail network. Therefore the common rail operator (resource manager) has to coordinate the independent mines to avoid conflicts in train scheduling. In this paper, we ignore all terminal operations.

Each mine receives a set of orders from their customers (or the terminal). Each order has a due-date and an order quantity associated with it. Each mine incurs an inventory cost at the mines, a stocking cost if the coal reaches the terminal before the due-date, and a demurrage cost for any late deliveries. A single rail operator provides the trains to move the coal from the mine to the terminal. Also, multiple train trips maybe required to fulfil any one order. Each of train trip is considered as a job. The orders at the mines need not have a one-to-one correspondence with jobs. Usually, more than one job is needed to complete an order. It is also possible that one job may satisfy two separate orders. In other words, mines do not know, a priori, which jobs are required for them; this is a decision that needs to be made. Each mine has to schedule production (subject to many constraints) and meet its orders at minimum cost.

It is assumed that all trains are fully loaded at the mines. Partial loading or mixing loads from different mines are not permitted due to operational reasons. For example, in Australia, mine sites can be almost 400–500kilometers
                           1
                           
                              http://www.hvccc.com.au.
                        
                        
                           1
                         away from the ports. Distances between mines and terminals are vast, coal trains are some 2–4kilometers long, and the transport of material requires excessive labour and fuel costs. Therefore it does not makes sense to have trains only ‘partially-loaded’. We assume that at most only one order can be tardy at the mines. There are two due-dates in this problem: (i) the due-date of an order associated with a mine, and (ii) the due-date of a job, which is an internal due-date, between the mine and the rail operator. Similarly, tardiness is also defined with respect to the job as well as the order. The due-date/tardiness of a mine and the rail operator are computed with respect to the order and the job respectively.

The rail operator has a pool of trains of different classes, classified based on the rake capacity and other features. Individual mines typically plan for and request trains of a particular class at appropriate times (so as to minimise their operational costs), irrespective of the demands from other mines. A mine is not necessarily concerned about the specific train that is allocated to it. The scheduling of specific trains that satisfy a set of jobs is a separate and non-trivial decision that needs to be made by the rail operator. The challenge here is that practical instances of such problems involve two sets of decisions: job-selection decisions and job-schedule decisions. In the job selection-scheduling problem, multiple mines could make simultaneous requests for the same class of trains thereby making the problem difficult. This can be viewed as a multi-resource constrained scheduling problem. The objective and constraints of this job scheduling problem are elaborated in Section 4.

@&#MOTIVATION@&#

Solution approaches that are developed for resource scheduling in a coal supply chain could be extended to other industries (airline, automobile manufacturing and the service industries). Hence it is important to study resource scheduling in a coal supply chain.

The scheduling problem with a single resource class itself is a complicated problem. It does not have analytical solutions for most of its variants (see Lenstra et al., 1977). In this paper, we consider a multi-resource constrained scheduling problem with the additional complexity of defining jobs based on the production planning decisions. The dependency between the orders and jobs makes this problem challenging. It cannot be modelled as a batch scheduling or a makespan minimisation problem. All of these relations can be captured in a single integrated model. But that will be too large and complex and would make it impossible to solve a single integrated model for large problem instances within a reasonable amount of computational time.

Hence the need for a computationally viable distributed decision making approach that is based on decomposition methods. There are two issues to consider while developing such an approach: (i) the right algorithm, and (ii) the right customisation. We develop a CG algorithm that significantly outperforms another popular decomposition algorithm based on Lagrangian relaxation. Multiple stabilisation techniques are implemented to overcome the weakness of the CG algorithm.

A decentralised decision making approach is an alternative. In such models we have (i) multiple partners, (ii) information asymmetry, (iii) conflict in objectives, and (iv) a negotiation protocol. We model a situation with multiple mines that do not interact/share-information with other mines but, constantly interact with the rail operator. The mines and the rail operator possess different sets of information. Hence our decision model has many players with an inherent information asymmetry and meets the first two requirements. The objectives of (each of) the mines and the rail operator are not same. Each mine expects the rail operator to send a train to it to load the coal and deliver it on-time at the terminal. However, the rail operator may have different priorities and constraints. Hence there is a conflict in objectives. We do not, however, incorporate the fourth requirement of negotiation protocols. In that sense, ours is not a truly decentralised decision making framework. A negotiation protocol is only partially implemented using the CG algorithm which is (in a sense) ‘controlled’ by the ‘honest broker’ rail operator. We made this assumption just so that we could converge to a solution to a very difficult real-world problem.

The core objective of this paper is to analyse the interaction between the production planning and resource scheduling. The experimental data sets assume that the base time unit is 1hour and the length of the planning horizon is either one week or one fortnight. This framework can be extended to include other complexities such as rolling horizon, different time units and longer time horizons.

The decomposition scheme allows us to solve the production planning problems separately. The production planning sub-problem described in this section has to be solved in every iteration of the CG algorithm. We may use the nouns mine and producer, train and resource or rail operator and resource manger interchangeably based on the context.

Let i
                     ∈{1,2,…,
                     I},
                     t
                     ∈{0,1,…,
                     T}, u
                     ∈{1,2,…,
                     U} and w
                     ∈{1,2,…,
                     W} be the indexes of mines, time periods, orders and train (resource) classes respectively. Let SP
                     
                        i
                      denote the production planning sub-problem of ith mine. The solution space corresponding to SP
                     
                        i
                      is denoted as 
                        
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                        
                     .
                        
                           
                              
                              
                              
                                 
                                    
                                       Parameters
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   w
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    cost incurred for requesting a train of class w at time t
                                    
                                 
                                 
                                    
                                       C
                                       
                                          t
                                       
                                    
                                    tardiness/demurrage cost of an order at time t
                                    
                                 
                                 
                                    
                                       O
                                       
                                          t
                                       
                                    
                                    overstock cost per unit quantity at the terminal at time t
                                    
                                 
                                 
                                    
                                       H
                                       
                                          t
                                       
                                    
                                    inventory holding cost per unit quantity at the mine at time t
                                    
                                 
                                 
                                    
                                       F
                                       
                                          u
                                       
                                    
                                    due date of order u
                                    
                                 
                                 
                                    
                                       Q
                                       
                                          u
                                       
                                    
                                    
                                       uth order quantity
                                 
                                 
                                    
                                       D
                                       
                                          t
                                       
                                    
                                    cumulative demand at time t
                                    
                                 
                                 
                                    
                                       P
                                    
                                    production capacity at the mine
                                 
                                 
                                    
                                       B
                                    
                                    inventory holding capacity at the mine
                                 
                                 
                                    
                                       V
                                       
                                          w
                                       
                                    
                                    capacity of the trains in class w
                                    
                                 
                                 
                                    
                                       K
                                       
                                          w
                                       
                                    
                                    number of trains in class w
                                    
                                 
                                 
                                    
                                       S
                                       
                                          w
                                       
                                    
                                    forward travel time required for the trains in class w to reach a mine from the terminal
                                 
                                 
                                    
                                       L
                                       
                                          w
                                       
                                    
                                    loading time required for the trains in class w
                                    
                                 
                                 
                                    
                                       R
                                       
                                          w
                                       
                                    
                                    return travel time required for the trains in class w, from a mine to the terminal
                                 
                                 
                                    
                                       E
                                       
                                          w
                                       
                                    
                                    = L
                                       
                                          w
                                       
                                       +
                                       R
                                       
                                          w
                                       , time required for loading and return travel to the terminal
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       Decision variables
                                    
                                 
                                 
                                    
                                       θ
                                       
                                          t
                                       
                                    
                                    Inventory level at the mine by the end of time t
                                    
                                 
                                 
                                    
                                       σ
                                       
                                          t
                                       
                                    
                                    Amount produced in period t
                                    
                                 
                                 
                                    
                                       ω
                                       
                                          t
                                       
                                    
                                    Over stock level of the product at the terminal by the end of time t
                                    
                                 
                                 
                                    
                                       ψ
                                       
                                          t
                                       
                                    
                                    Binary variable, equals to 1 if any order is tardy at time t. Zero indicates no order is tardy
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   η
                                                
                                                
                                                   w
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    Total number of trains from class w requested on or before time t
                                    
                                 
                              
                           
                        
                     
                  

A delivery order u from the terminal can be seen as an ordered pair of due date (F
                     
                        u
                     ) and quantity (Q
                     
                        u
                     ). Without loss of generality we assume that F
                     
                        u
                     
                     <
                     F
                     
                        u+1 and uth order must be met before satisfying the demand for (u
                     +1)th order. The cumulative demand for a mine at time t is defined as 
                        
                           
                              
                                 D
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 {
                                 u
                                 |
                                 
                                    
                                       F
                                    
                                    
                                       u
                                    
                                 
                                 ⩽
                                 t
                                 }
                              
                           
                           
                              
                                 Q
                              
                              
                                 u
                              
                           
                        
                     .


                     Objective: The overall objective, Z
                     
                        i
                     , is to minimise total system cost. This includes the cost of holding inventory at the mines, the overstock cost at the terminal, demurrage cost and total cost of requesting trains.
                        
                           (1)
                           
                              
                                 min
                              
                              
                              
                                 
                                    Z
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             H
                                          
                                          
                                             t
                                          
                                       
                                       +
                                       
                                          
                                             ω
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             O
                                          
                                          
                                             t
                                          
                                       
                                       +
                                       
                                          
                                             ψ
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             t
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                w
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      w
                                                   
                                                   
                                                      t
                                                   
                                                
                                                -
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      w
                                                   
                                                   
                                                      t
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             A
                                          
                                          
                                             w
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     Constraints: Eqs. (2)–(12) completely define the constraints of the model.

Total number of trains requested on or before time t is non-decreasing.
                        
                           (2)
                           
                              
                                 
                                    η
                                 
                                 
                                    w
                                 
                                 
                                    t
                                 
                              
                              ⩾
                              
                                 
                                    η
                                 
                                 
                                    w
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              
                              ∀
                              
                              w
                              ,
                              t
                           
                        
                     
                  

The amount produced at the mine at any time t is not more than its production capacity.
                        
                           (3)
                           
                              
                                 
                                    σ
                                 
                                 
                                    t
                                 
                              
                              ⩽
                              P
                              
                              ∀
                              
                              t
                           
                        
                     
                  

The inventory balancing constraint: Inventory at time t can be computed by subtracting the supply at time t from the sum of previous inventory and production at time t.
                        
                           (4)
                           
                              
                                 
                                    θ
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    θ
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              +
                              
                                 
                                    σ
                                 
                                 
                                    t
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       w
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             η
                                          
                                          
                                             w
                                          
                                          
                                             t
                                          
                                       
                                       -
                                       
                                          
                                             η
                                          
                                          
                                             w
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    w
                                 
                              
                              
                              ∀
                              
                              w
                              ,
                              t
                           
                        
                     
                  

The inventory at end of period t cannot be more than the holding capacity of the mine.
                        
                           (5)
                           
                              
                                 
                                    θ
                                 
                                 
                                    t
                                 
                              
                              ⩽
                              B
                              
                              ∀
                              
                              t
                           
                        
                     
                  

If a train of class w has to reach the terminal at time t, then it should reach the mine at t
                     −
                     E
                     
                        w
                     . Hence the cumulative supply at time t can be expressed as 
                        
                           
                              
                                 ∑
                              
                              
                                 w
                              
                           
                           
                              
                                 η
                              
                              
                                 w
                              
                              
                                 t
                                 -
                                 
                                    
                                       E
                                    
                                    
                                       w
                                    
                                 
                              
                           
                           
                              
                                 V
                              
                              
                                 w
                              
                           
                        
                     . If it is more than the mine’s demand, then it has an overstock.
                        
                           (6)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       w
                                    
                                 
                              
                              
                                 
                                    η
                                 
                                 
                                    w
                                 
                                 
                                    t
                                    -
                                    
                                       
                                          E
                                       
                                       
                                          w
                                       
                                    
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    w
                                 
                              
                              -
                              
                                 
                                    D
                                 
                                 
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    ω
                                 
                                 
                                    t
                                 
                              
                              
                              ∀
                              
                              t
                           
                        
                     (u
                     −1)th order must be delivered before the due-date of the uth order, F
                     
                        u
                     . This also implies that at any time t one order for a mine can be at the most tardy. In other words, cumulative supply at time F
                     
                        u
                      should be not less than the demand at time F
                     
                        u−1.
                        
                           (7)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       w
                                    
                                 
                              
                              
                                 
                                    η
                                 
                                 
                                    w
                                 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          u
                                       
                                    
                                    -
                                    
                                       
                                          E
                                       
                                       
                                          w
                                       
                                    
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    w
                                 
                              
                              ⩾
                              
                                 
                                    D
                                 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                    
                                 
                              
                              
                              ∀
                              
                              u
                           
                        
                     If the cumulative supply at time t is less than its demand then the mine needs to pay demurrage cost.
                        
                           (8)
                           
                              
                                 
                                    ψ
                                 
                                 
                                    t
                                 
                              
                              ⩾
                              1
                              -
                              1
                              /
                              
                                 
                                    D
                                 
                                 
                                    t
                                 
                              
                              ×
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       w
                                    
                                 
                              
                              
                                 
                                    η
                                 
                                 
                                    w
                                 
                                 
                                    t
                                    -
                                    
                                       
                                          E
                                       
                                       
                                          w
                                       
                                    
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    w
                                 
                              
                              
                              ∀
                              
                              t
                              ⩾
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                        
                     All orders must be met by the end of the planning horizon.
                        
                           (9)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       w
                                    
                                 
                              
                              
                                 
                                    η
                                 
                                 
                                    w
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    w
                                 
                              
                              ⩾
                              
                                 
                                    D
                                 
                                 
                                    T
                                 
                              
                           
                        
                     Only one train can load at the mine at a given time period.
                        
                           (10)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       w
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             η
                                          
                                          
                                             w
                                          
                                          
                                             t
                                          
                                       
                                       -
                                       
                                          
                                             η
                                          
                                          
                                             w
                                          
                                          
                                             t
                                             -
                                             
                                                
                                                   L
                                                
                                                
                                                   w
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ⩽
                              1
                              
                              ∀
                              
                              t
                           
                        
                     The total number of trains of a class w running at any time t cannot exceed the total number of trains in that class.
                        
                           (11)
                           
                              
                                 
                                    
                                       
                                          
                                             η
                                          
                                          
                                             w
                                          
                                          
                                             t
                                             +
                                             
                                                
                                                   S
                                                
                                                
                                                   w
                                                
                                             
                                          
                                       
                                       -
                                       
                                          
                                             η
                                          
                                          
                                             w
                                          
                                          
                                             t
                                             -
                                             
                                                
                                                   E
                                                
                                                
                                                   w
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ⩽
                              
                                 
                                    K
                                 
                                 
                                    w
                                 
                              
                              
                              ∀
                              
                              w
                              ,
                              t
                           
                        
                     Boundary conditions and scope.
                        
                           (12)
                           
                              
                                 
                                    η
                                 
                                 
                                    w
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    θ
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    ω
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    ψ
                                 
                                 
                                    u
                                 
                                 
                                    T
                                 
                              
                              =
                              0
                              ;
                              
                              
                                 
                                    θ
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    ω
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    t
                                 
                              
                              ⩾
                              0
                              ;
                              
                              
                                 
                                    ψ
                                 
                                 
                                    u
                                 
                                 
                                    t
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              ;
                              
                              
                                 
                                    η
                                 
                                 
                                    w
                                 
                                 
                                    t
                                 
                              
                              ∈
                              
                                 
                                    Z
                                 
                                 
                                    +
                                 
                              
                              .
                           
                        
                     
                     Additional Constraints: The above constraints are necessary to represent the model. A few more additional integer cuts and bounds have been generated and used to tighten the Mixed Integer Programming (MIP) formulation. These additional constraints are redundant in the MIP formulation, but, active in the linear programming relaxation of the MIP. Hence, an MIP solver should take less time to solve a problem that contains these additional constraints.

The cumulative supply at time t cannot be more than the total production, 
                        
                           
                              
                                 ∑
                              
                              
                                 w
                              
                           
                           
                              
                                 η
                              
                              
                                 w
                              
                              
                                 t
                              
                           
                           
                              
                                 V
                              
                              
                                 w
                              
                           
                           ⩽
                           tP
                        
                     . Due to holding costs at the mine and terminal, the mine does not want to supply more than D
                     
                        T
                     . Since (i) partial loading and order mixing are not permitted and (ii) D
                     
                        T
                      need not be a linear combination of train sizes, we need to allow a margin, V
                     max, in the final supply. Hence 
                        
                           
                              
                                 ∑
                              
                              
                                 w
                              
                           
                           
                              
                                 η
                              
                              
                                 w
                              
                              
                                 t
                              
                           
                           
                              
                                 V
                              
                              
                                 w
                              
                           
                           ⩽
                           
                              
                                 D
                              
                              
                                 T
                              
                           
                           +
                           
                              
                                 V
                              
                              
                                 max
                              
                           
                        
                     , where V
                     max
                     =max
                        w
                     {V
                     
                        w
                     }. From these two, we define an upper bound X
                     
                        t
                      for the cumulative supply.
                        
                           (13)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       w
                                    
                                 
                              
                              
                                 
                                    η
                                 
                                 
                                    w
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    w
                                 
                              
                              ⩽
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                              
                              ∀
                              
                              t
                              ,
                              
                              where
                              
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 min
                              
                              {
                              tP
                              ,
                              
                                 
                                    D
                                 
                                 
                                    T
                                 
                              
                              +
                              
                                 
                                    V
                                 
                                 
                                    max
                                 
                              
                              }
                           
                        
                     Since the supply is bounded, overstock also has to be bounded.
                        
                           (14)
                           
                              
                                 
                                    ω
                                 
                                 
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                              -
                              
                                 
                                    D
                                 
                                 
                                    t
                                 
                              
                              
                              ∀
                              
                              t
                           
                        
                     If a mine overstocks at the terminal then it cannot incur demurrage.
                        
                           (15)
                           
                              
                                 
                                    ψ
                                 
                                 
                                    t
                                 
                              
                              ⩽
                              1
                              -
                              
                                 
                                    ω
                                 
                                 
                                    t
                                 
                              
                              /
                              (
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                              -
                              
                                 
                                    D
                                 
                                 
                                    t
                                 
                              
                              )
                              
                              ∀
                              
                              t
                           
                        
                     
                  

Constraint (13) is similar to a Knapsack constraint and therefore can be further tightened with the integer cuts proposed by Atamtürk (2005). Let Λ
                     
                        w
                      be the upper bound of 
                        
                           
                              
                                 η
                              
                              
                                 w
                              
                              
                                 t
                              
                           
                        
                      which satisfies (13) after fixing all other variables to zero. The set C
                     ⊂{1,2,…,
                     N} is a ‘cover’ if 
                        
                           
                              
                                 ∑
                              
                              
                                 w
                                 ∈
                                 C
                              
                           
                           (
                           
                              
                                 Λ
                              
                              
                                 w
                              
                           
                           
                              
                                 V
                              
                              
                                 w
                              
                           
                           -
                           
                              
                                 X
                              
                              
                                 t
                              
                           
                           )
                           ⩾
                           0
                        
                     . Then a stronger cut can be derived as
                        
                           (16)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       w
                                       ∈
                                       C
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             Λ
                                          
                                          
                                             w
                                          
                                       
                                       -
                                       
                                          
                                             η
                                          
                                          
                                             w
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              ⩾
                              ⌈
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                              /
                              
                                 
                                    V
                                 
                                 
                                    ‾
                                 
                              
                              ⌉
                              
                              ∀
                              
                              t
                           
                        
                     where 
                        
                           
                              
                                 V
                              
                              
                                 ‾
                              
                           
                           =
                           
                              
                                 max
                              
                              
                                 {
                                 w
                                 ∈
                                 C
                                 }
                              
                           
                           
                              
                                 V
                              
                              
                                 w
                              
                           
                        
                      and Λ
                     
                        w
                     
                     =⌊X
                     
                        t
                     /V
                     
                        w
                     ⌋.

Similarly we can use an integer cut from constraint (8). Since both ψ and η are integer variables, this cut will help us to improve the relaxed solution.
                        
                           (17)
                           
                              (
                              1
                              -
                              
                                 
                                    ψ
                                 
                                 
                                    t
                                 
                              
                              )
                              ⌈
                              
                                 
                                    D
                                 
                                 
                                    t
                                 
                              
                              /
                              
                                 
                                    V
                                 
                                 
                                    min
                                 
                              
                              ⌉
                              ⩽
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       w
                                    
                                 
                              
                              
                                 
                                    η
                                 
                                 
                                    w
                                 
                                 
                                    t
                                    -
                                    
                                       
                                          E
                                       
                                       
                                          w
                                       
                                    
                                 
                              
                              ⌈
                              
                                 
                                    V
                                 
                                 
                                    w
                                 
                              
                              /
                              
                                 
                                    V
                                 
                                 
                                    min
                                 
                              
                              ⌉
                              
                              ∀
                              
                              u
                              ,
                              
                              
                                 
                                    F
                                 
                                 
                                    u
                                 
                              
                              ⩽
                              t
                              <
                              
                                 
                                    F
                                 
                                 
                                    u
                                    +
                                    1
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 D
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 {
                                 u
                                 |
                                 
                                    
                                       F
                                    
                                    
                                       u
                                    
                                 
                                 ⩽
                                 t
                                 }
                              
                           
                           
                              
                                 Q
                              
                              
                                 u
                              
                           
                        
                      and V
                     min
                     =min
                        w
                     {V
                     
                        w
                     }.

The demand changes only at the due-date of orders. Once the demand for an order was met in an interval, it stays as ‘met’ till the due-date of the next order. This gives
                        
                           (18)
                           
                              
                                 
                                    ψ
                                 
                                 
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    ψ
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              
                              ∀
                              
                              u
                              ,
                              
                              
                                 
                                    F
                                 
                                 
                                    u
                                 
                              
                              <
                              t
                              <
                              
                                 
                                    F
                                 
                                 
                                    u
                                    +
                                    1
                                 
                              
                              .
                           
                        
                     
                  

The constraints (1)–(18) are applicable for individual mines. Hence, the decision variables and the parameters corresponding to mine i are used with a subscript of i. For example 
                        
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 H
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 iw
                              
                              
                                 t
                              
                           
                        
                     , are used in the context of the integrated problem. Since the train is utilised across the mines. Hence the constraint (11) can be further tightened as
                        
                           (19)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             η
                                          
                                          
                                             iw
                                          
                                          
                                             t
                                             +
                                             
                                                
                                                   S
                                                
                                                
                                                   w
                                                
                                             
                                          
                                       
                                       -
                                       
                                          
                                             η
                                          
                                          
                                             iw
                                          
                                          
                                             t
                                             -
                                             
                                                
                                                   E
                                                
                                                
                                                   w
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ⩽
                              
                                 
                                    K
                                 
                                 
                                    w
                                 
                              
                              
                              ∀
                              
                              w
                              ,
                              t
                           
                        
                     
                  


                     Thomas et al. (2013) provide a Lagrangian relaxation (LR) approach for solving integrated decision problems. But, as discussed in Section 2, this has a few shortcomings. The LR approach does not solve large problems quickly. Moreover, the Lagrangian multipliers in any iteration relies only on the information that is available from the sub-problems at that iteration. This results in a slow convergence of the Lagrangian multipliers. Hence, there is a need for a more efficient approach to solve practical instances of such problems.

A CG algorithm has two components: master problem (MP) and sub-problems. We consider the train scheduling problem without any production considerations, as the MP. The production planning problem, described in Section 4, is considered in the sub-problems. Solutions (schedules) of each mine form the columns of the MP, from which a globally feasible solution is obtained. However, this MP can be very large. Therefore, we consider a restricted MP which has a smaller subset of the columns. The sub-problems iteratively generate new columns for the MP using the dual prices from the restricted MP. The different solutions to the MP imply different allocations of trains to the mines.

The master problem selects the best column for each mine which does not violate the resource availability constraint and minimises the total system cost. Index c denotes the columns.

Define,
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          V
                                          
                                             ic
                                          
                                       
                                       Value (cost) of column c of ith mine. For each column c, there exists a solution in 
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          . Hence V
                                          
                                             ic
                                           can be computed with the objective function (1)
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      χ
                                                   
                                                   
                                                      icw
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                       Number of servicing trains of class w for the ith mine with respect to column c at time t
                                       
                                    
                                    
                                       
                                          x
                                          
                                             ic
                                          
                                       
                                       1 if the column c of mine i is used, 0 otherwise
                                    
                                 
                              
                           
                        
                     

The parameters V
                        
                           ic
                         an 
                           
                              
                                 
                                    χ
                                 
                                 
                                    icw
                                 
                                 
                                    t
                                 
                              
                           
                         are precomputed for each column. x
                        
                           ic
                         is the only decision variable of the MP. Then the master problem is
                           
                              (20)
                              
                                 
                                    
                                       V
                                    
                                    
                                       MP
                                    
                                 
                                 =
                                 min
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ,
                                          c
                                       
                                    
                                 
                                 
                                    
                                       V
                                    
                                    
                                       ic
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ic
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 s.t.
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          c
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ic
                                    
                                 
                                 =
                                 1
                                 
                                 ∀
                                 
                                 i
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ,
                                          c
                                       
                                    
                                 
                                 
                                    
                                       χ
                                    
                                    
                                       icw
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ic
                                    
                                 
                                 ⩽
                                 
                                    
                                       K
                                    
                                    
                                       w
                                    
                                 
                                 
                                 ∀
                                 
                                 w
                                 ,
                                 t
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ic
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                              
                           
                        
                     

The objective (20) minimises the total value of selected columns. Constraint (21) ensures that exactly one column will be selected for each mine. All the selected columns must satisfy constraint (22). Each of the columns satisfies the corresponding mine’s constraints. Therefore the optimal solution of the master problem will be feasible for all mines and optimal for the system. In the relaxed master problem (RMP), the integer constraint (23) is relaxed as
                           
                              (24)
                              
                                 0
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       ic
                                    
                                 
                                 ⩽
                                 1
                                 .
                              
                           
                        
                     

At an iteration k, the number of columns will be finite and restricted to a subset of all the feasible columns. The restricted relaxed master problem at iteration k is represented as RMP
                        
                           k
                        .

Column generation algorithm solves the relaxed master problem iteratively. Initially it starts with a finite set of feasible columns and iteratively adds more columns. The penalty for violating the resource constraint is communicated to the sub-problems through the dual prices computed from the master problem.

Let 
                           
                              
                                 
                                    λ
                                 
                                 
                                    w
                                 
                                 
                                    t
                                 
                              
                           
                         be the dual price of resource constraint for class w at time t, then the sub-problems are solved with the modified LR objective function:
                           
                              (25)
                              
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 λ
                                 )
                                 =
                                 
                                    min
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                H
                                             
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                ω
                                             
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                O
                                             
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                ψ
                                             
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                C
                                             
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   w
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         i
                                                         ,
                                                         w
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         i
                                                         ,
                                                         w
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                w
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 where
                                 
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       w
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       i
                                       ,
                                       w
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          u
                                          =
                                          t
                                          -
                                          
                                             
                                                S
                                             
                                             
                                                w
                                             
                                          
                                       
                                       
                                          t
                                          +
                                          
                                             
                                                E
                                             
                                             
                                                w
                                             
                                          
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       w
                                    
                                    
                                       u
                                    
                                 
                                 .
                              
                           
                        Hence the lower bound at kth iteration is defined as 
                           
                              
                                 
                                    LB
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    Z
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    λ
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              )
                              -
                              
                                 
                                    ∑
                                 
                                 
                                    w
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             w
                                          
                                       
                                       ·
                                       
                                          
                                             λ
                                          
                                          
                                             w
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        .

The objective of the CG algorithm is to compute a better lower bound for the relaxed master problem. The lower bound from the integrated model and the CG will be the same if the integer relaxation of the problem was being solved, but in this case it is an MILP problem and therefore the quality of bound also depends on the cuts and how deep the branch and bound search is able to reach. We show in this paper through our decomposition techniques that our method is much better in achieving this.

In every iteration k, LB
                        
                           k
                         is less than or equal to 
                           
                              
                                 
                                    V
                                 
                                 
                                    RMP
                                 
                              
                           
                        . Once both values are equal, sub-problems will not add any new columns to the solution pool. Therefore the algorithm will not guarantee good integer solutions. Section 5.3 illustrates heuristic procedures to achieve a better upper bound by generating more numbers of globally feasible columns from the solutions of RMP
                        
                           k
                        .

In this section, we propose two heuristics procedures: (i) Job scheduling model, where the rail operator attempts to derive a feasible solution to the problem with inputs from all the mines, (ii) Leader–follower mechanism, where each mine attempts to make a better schedule after fixing certain columns (partial schedules) for all the other mines. In these heuristics, importance is given to global feasibility rather than cost minimisation. Heuristic 1 and Heuristic 2 receive inputs from the solutions of RMP, which consists of many partial schedules for each mine. Since these heuristics are customised to generate global feasible columns, it improves the upper bound UB
                        ∗.

A combination of the solutions from the sub-problems need not satisfy the resource constraint (22) of the master problem. Therefore the rail operator uses the available information from the sub-problem solution and attempts to prepare a globally feasible schedule which minimises deviation from expected schedules. The rail operator, upon receiving the requests from the mines, is aware of the train class combination and due-dates. Hence it defines the train trips (jobs) required by each class at this stage. Each job has three stages: (i) forward travel from the terminal to the mine; (ii) loading; and (iii) return journey with full load to the terminal. We define additional variables required for the job scheduling model:
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             Parameters
                                          
                                       
                                       
                                          
                                             j
                                          
                                          index of job
                                       
                                       
                                          
                                             M
                                             
                                                j
                                             
                                          
                                          mine associated with job j
                                          
                                       
                                       
                                          
                                             T
                                             
                                                j
                                             
                                          
                                          train class associated with job j
                                          
                                       
                                       
                                          
                                             S
                                             
                                                j
                                             
                                          
                                          forward travel time required for the job j
                                          
                                       
                                       
                                          
                                             L
                                             
                                                j
                                             
                                          
                                          loading time required for the job j
                                          
                                       
                                       
                                          
                                             R
                                             
                                                j
                                             
                                          
                                          return travel time required for the job j
                                          
                                       
                                       
                                          
                                             E
                                             
                                                j
                                             
                                          
                                          = L
                                             
                                                j
                                             
                                             +
                                             R
                                             
                                                j
                                             , time required for loading and return travel for the job j
                                          
                                       
                                       
                                          
                                             F
                                             
                                                j
                                             
                                          
                                          due date of job j
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                             
                                          
                                          tardiness weights of the job j, which reflect the importance of the job. Higher weight implies higher importance
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         E
                                                      
                                                   
                                                
                                             
                                          
                                          earliness weights of the job j
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          weighted tardiness of job j at time 
                                                
                                                   t
                                                   ,
                                                   
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   max
                                                   {
                                                   t
                                                   -
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ,
                                                   0
                                                   }
                                                
                                              for all j, t
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         O
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          weighted earliness of job j at time 
                                                
                                                   t
                                                   ,
                                                   
                                                   
                                                      
                                                         O
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         E
                                                      
                                                   
                                                   max
                                                   {
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   -
                                                   t
                                                   ,
                                                   0
                                                   }
                                                
                                              for all j, t
                                          
                                       
                                       
                                          
                                             K
                                             
                                                w
                                             
                                          
                                          number of trains with class w
                                          
                                       
                                       
                                          
                                             
                                          
                                       
                                       
                                          
                                             Decision Variables
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          = 
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     if
                                                                     
                                                                     the
                                                                     
                                                                     job
                                                                     
                                                                     j
                                                                     
                                                                     is
                                                                     
                                                                     completed
                                                                     
                                                                     on
                                                                     
                                                                     or
                                                                     
                                                                     before
                                                                     
                                                                     time
                                                                     
                                                                     t
                                                                     ,
                                                                  
                                                               
                                                               
                                                                  
                                                                     0
                                                                  
                                                                  
                                                                     otherwise
                                                                     .
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Each job j can be represented as a pair of the mine, M
                           
                              j
                           , and the corresponding train class, T
                           
                              j
                           , that is job(j)=(M
                           
                              j
                           ,
                           T
                           
                              j
                           ). The properties such as G
                           
                              j
                           , S
                           
                              j
                           , L
                           
                              j
                           , R
                           
                              j
                            are inherited from the corresponding train class. In other words, 
                              
                                 
                                    
                                       G
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       G
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                            and so on. Suppose a mine makes a request for a train from the class w at time t′, then 
                              
                                 
                                    
                                       η
                                    
                                    
                                       w
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       η
                                    
                                    
                                       w
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 =
                                 1
                              
                           . Therefore the corresponding job is expected to arrive at time t′. Hence its due date is F
                           
                              j
                           
                           =
                           t′+
                           E
                           
                              j
                           .

The weights 
                              
                                 
                                    
                                       W
                                    
                                    
                                       j
                                    
                                    
                                       E
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       W
                                    
                                    
                                       j
                                    
                                    
                                       T
                                    
                                 
                              
                            and costs 
                              
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       O
                                    
                                    
                                       j
                                    
                                    
                                       t
                                    
                                 
                              
                            are decided by the rail operator. In this section, the properties such as due-date, earliness, tardiness and weight are discussed only with respect to the jobs. These properties differ from the similar ones of the orders received from the terminal by the mines.


                           Objective: The objective of this job scheduling model is to minimise the total weighted tardiness and earliness. This guides the model to schedule the jobs as close to their due-dates as possible. If the earliness cost is greater than the tardiness cost, jobs will be advanced only if it is required to maintain feasibility.
                              
                                 (26)
                                 
                                    min
                                    
                                    
                                       
                                          Z
                                       
                                       
                                          R
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             >
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            t
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   O
                                                
                                                
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            t
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                           Constraints: Eqs. (27)–(33) denote the constraints of the model.

Cumulative supply from any mine should be less than its total possible production.
                              
                                 (27)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   j
                                                
                                             
                                             =
                                             i
                                          
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          j
                                       
                                       
                                          t
                                          +
                                          
                                             
                                                E
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                       
                                          V
                                       
                                       
                                          j
                                       
                                    
                                    ⩽
                                    
                                       
                                          tP
                                       
                                       
                                          i
                                       
                                    
                                    
                                    ∀
                                    
                                    i
                                    ,
                                    t
                                 
                              
                           At any time, there should not be more than one job for loading at any production location.
                              
                                 (28)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   j
                                                
                                             
                                             =
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   j
                                                
                                                
                                                   t
                                                   +
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   z
                                                
                                                
                                                   j
                                                
                                                
                                                   t
                                                   +
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    1
                                    
                                    ∀
                                    
                                    i
                                    ,
                                    t
                                 
                              
                           Once a job is completed it stays as completed.
                              
                                 (29)
                                 
                                    
                                       
                                          z
                                       
                                       
                                          j
                                       
                                       
                                          t
                                       
                                    
                                    ⩾
                                    
                                       
                                          z
                                       
                                       
                                          j
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                    
                                    
                                    ∀
                                    
                                    j
                                    ,
                                    t
                                 
                              
                           All jobs must be completed at the end of the planning horizon.
                              
                                 (30)
                                 
                                    
                                       
                                          z
                                       
                                       
                                          j
                                       
                                       
                                          T
                                       
                                    
                                    =
                                    1
                                    
                                    ∀
                                    
                                    j
                                    ∈
                                    J
                                 
                              
                           The number of trains in any class is limited. This is equivalent to constraints (19) and (22).
                              
                                 (31)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             |
                                             
                                                
                                                   T
                                                
                                                
                                                   j
                                                
                                             
                                             =
                                             w
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   j
                                                
                                                
                                                   t
                                                   +
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   z
                                                
                                                
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          K
                                       
                                       
                                          w
                                       
                                    
                                    
                                    ∀
                                    
                                    w
                                    ,
                                    t
                                 
                              
                           Every mine must satisfy (u
                           −1)th order before the due-date of the uth order.
                              
                                 (32)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   j
                                                
                                             
                                             =
                                             i
                                          
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          j
                                       
                                       
                                          
                                             
                                                F
                                             
                                             
                                                i
                                                ,
                                                u
                                             
                                          
                                       
                                    
                                    
                                       
                                          V
                                       
                                       
                                          j
                                       
                                    
                                    ⩾
                                    
                                       
                                          D
                                       
                                       
                                          
                                             
                                                F
                                             
                                             
                                                i
                                                ,
                                                u
                                                -
                                                1
                                             
                                          
                                       
                                    
                                    
                                    ∀
                                    
                                    i
                                    ,
                                    u
                                 
                              
                           Scope and boundary conditions.
                              
                                 (33)
                                 
                                    
                                       
                                          z
                                       
                                       
                                          j
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    0
                                    ;
                                    
                                    
                                       
                                          z
                                       
                                       
                                          j
                                       
                                       
                                          t
                                       
                                    
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    }
                                    
                                    ∀
                                    
                                    j
                                    ,
                                    t
                                 
                              
                           
                        

In general, this model will give us a feasible solution by advancing the jobs, unless the due-dates are very close and hence constraint (32) is violated. Once the job schedules are computed, the corresponding columns for each mine and their values can be computed easily.

As stated earlier, the resource constraint (22) is the only link between the mines. If we know a complete (or partial) schedule of all the other mines, then each mine can have a better understanding about the resource availability. Hence a particular mine can customise their schedule to obtain a globally feasible solution. In this case, constraint (11) can be modified as
                              
                                 (34)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   η
                                                
                                                
                                                   w
                                                
                                                
                                                   t
                                                   +
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         w
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   η
                                                
                                                
                                                   w
                                                
                                                
                                                   t
                                                   -
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         w
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                K
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          w
                                       
                                       
                                          t
                                       
                                    
                                    
                                    ∀
                                    
                                    w
                                    ,
                                    t
                                 
                              
                           where 
                              
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       w
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       w
                                    
                                 
                                 -
                                 (
                                 Trains
                                 
                                 reserved
                                 
                                 by
                                 
                                 other
                                 
                                 mines
                                 
                                 at
                                 
                                 time
                                 
                                 t
                                 )
                              
                           .

Solving the sub-problem with the above constraint will restrict the solution space and will increase the possibility of getting globally feasible columns. To achieve this, columns are randomly selected from the solution pool of RMP
                           
                              k
                            for a few mines and solve the job scheduling for others. Hence it will be restricted in a small neighbourhood of feasible solutions of the RMP. Adding these extra columns back to the pool will improve the UB
                           ∗.

We may get good integer solutions directly from the heuristics described in Section 5.3. Another option is to solve the integer version of the MP where the model will try to find optimal columns from the available pool. There is no guarantee that the optimal integer solution will be one among the optimal solutions of the RMP; some non-basic columns of RMP can also be in the optimal integer solution. To maintain a reasonable problem size, the CG algorithm removes a few non-contributing columns from the solution pool. Hence, there are chances of missing some good candidates for the optimal integer solution. To avoid this problem, we can have two versions of the solution pool 
                           
                              S
                           
                        ; one for the RMP and one for the integer MP. Unless there are memory restrictions, all columns from every iteration can be stored. But solving the integer MP with all columns is not advisable because of the size of the solution pool. Once the prices are stable, new columns will not be added to the solution pool. Then, we can filter the columns for the integer MP based on the current bounds such that they are within a neighbourhood of the relaxed solution. The basic column generation algorithm was implemented and tested on several randomly generated datasets (see Section 7). Even though CG showed significant improvement over the centralised model, there are multiple strengthening methods that can and must be explored.

The traditional CG algorithm can be improved through stabilisation and improvement techniques.

The major drawbacks of the basic CG scheme, as mentioned by Ben Amor et al. (2009) are (i) slow convergence and (ii) high oscillation of dual prices. Many stabilisation methods are proposed in the literature to overcome these problems. The reader can refer to Lubbecke and Desrosiers (2005), Ben Amor et al. (2009) and Vanderbeck and Wolsey (2010) for recent reviews. Stabilisation of dual price is centred around what is referred to as stability centre. In any iteration, the stability centre is the current best known dual price. Hence, we try to get dual prices close to the current stability centre. The concept of stability centre will minimise very high deviations in the dual prices and will eventually improve the quality of the solution. In our proposed scheme, we use the weighted Dantzig–Wolfe decomposition method discussed in Desrosiers and Lubbecke (2005) and Pessoa et al. (2010) along with a two-piece stability term motivated from Ben Amor et al. (2009). The weighted scheme stabilises the dual prices at the sub-problem level. The stability term added to the objective helps to stabilise the master problem. By introducing both methods we aim to minimise the instability of the scheme and achieve the optimal state in fewer number of iterations.

Let 
                           
                              
                                 
                                    λ
                                 
                                 
                                    ¯
                                 
                              
                           
                         be the stability centre. To stabilise the dual price, we penalise the difference between new dual prices λ and 
                           
                              
                                 
                                    λ
                                 
                                 
                                    ¯
                                 
                              
                           
                        . Fenchel’s conjugate of 
                           
                              D
                              (
                              λ
                              -
                              
                                 
                                    λ
                                 
                                 
                                    ¯
                                 
                              
                              )
                           
                         is added to the objective of the RMP as a stability term (see Ben Amor et al., 2009). Therefore the RMP can be updated as
                           
                              (35)
                              
                                 
                                    
                                       V
                                    
                                    
                                       RMP
                                    
                                 
                                 =
                                 min
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ,
                                          c
                                       
                                    
                                 
                                 
                                    
                                       V
                                    
                                    
                                       ic
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ic
                                    
                                 
                                 -
                                 
                                    
                                       λ
                                    
                                    
                                       ¯
                                    
                                 
                                 ·
                                 y
                                 +
                                 
                                    
                                       D
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 y
                                 )
                              
                           
                        
                        
                           
                              (36)
                              
                                 s.t.
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          c
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ic
                                    
                                 
                                 =
                                 1
                                 
                                 ∀
                                 
                                 i
                              
                           
                        
                        
                           
                              (37)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ,
                                          c
                                       
                                    
                                 
                                 
                                    
                                       χ
                                    
                                    
                                       icw
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ic
                                    
                                 
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       w
                                    
                                    
                                       t
                                    
                                 
                                 ⩽
                                 
                                    
                                       K
                                    
                                    
                                       w
                                    
                                 
                                 
                                 ∀
                                 
                                 w
                                 ,
                                 t
                                 
                                 (
                                 dual
                                 
                                 variables
                                 
                                 λ
                                 )
                              
                           
                        
                        
                           
                              (38)
                              
                                 
                                 0
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       ic
                                    
                                 
                                 ⩽
                                 1
                                 ,
                                 
                                 0
                                 ⩽
                                 
                                    
                                       y
                                    
                                    
                                       w
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        where 
                           
                              y
                              =
                              
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             w
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                         corresponds to the additional train provided for the class w at time t and the stability term is defined as
                           
                              (39)
                              
                                 
                                    
                                       D
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 y
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          w
                                          ,
                                          t
                                       
                                    
                                 
                                 g
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       w
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 ,
                                 
                                 where
                                 
                                 g
                                 (
                                 ν
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ν
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   0
                                                   ⩽
                                                   ν
                                                   ⩽
                                                   μ
                                                   ,
                                                
                                             
                                             
                                                
                                                   μ
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   ν
                                                   -
                                                   μ
                                                   )
                                                
                                                
                                                   if
                                                   
                                                   ν
                                                   >
                                                   μ
                                                   ,
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and M
                        1, M
                        2 are constants such that M
                        1
                        <
                        M
                        2.

In general, finding all possible solutions of each sub-problem is hard. The traditional CG algorithm considers only one optimal solution from the sub-problems. However, Huisman et al. (2005) suggest that faster convergence could be achieved by adding more columns. The complexity of MP and the additional time and computational resource required are the bottlenecks in using this option directly. A commercial solver, CPLEX 12.1, is used to perform the computational experiments. Instead of storing a single solution from each iteration, multiple solutions are recorded. CPLEX has the ability to generate more solutions, but at a higher cost and memory for each of the sub-problems and the MP. Hence the advantage of iterative improvement is lost. Therefore all computational experiments were performed with default settings.

The basic CG algorithm is strengthened with the stabilisation techniques and the improvement features discussed in Section 6.2. An improved version of it is presented in Algorithm 1.
                           Algorithm 1
                           Improved CG algorithm 
                                 
                                    
                                       
                                       
                                          
                                             1: Initialise 
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      =
                                                      0
                                                      ,
                                                      
                                                         
                                                            LB
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      =
                                                      0
                                                      ,
                                                      
                                                         
                                                            UB
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      =
                                                      ∞
                                                      ,
                                                      k
                                                      =
                                                      0
                                                      ,
                                                      α
                                                      =
                                                      0.5
                                                      ,
                                                      Time
                                                      
                                                      Limit
                                                      
                                                      TL
                                                      =
                                                      3600
                                                      ,
                                                      ∊
                                                      =
                                                      
                                                         
                                                            10
                                                         
                                                         
                                                            -
                                                            5
                                                         
                                                      
                                                      ,
                                                      μ
                                                      =
                                                      0.5
                                                      ,
                                                      eTime
                                                      =
                                                      elapsed
                                                      
                                                      time
                                                      
                                                      in
                                                      
                                                      seconds
                                                   
                                                .
                                          
                                          
                                             2: Initialise the solution pool 
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                 with a feasible solution.
                                          
                                          
                                             3: while (eTime
                                                <
                                                TL) do
                                             
                                          
                                          
                                             4: Solve the RMP
                                                
                                                   k
                                                 ( (35)–(38)) with solution pool 
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                 and the corresponding dual variables be λ
                                                (k).
                                          
                                          
                                             5: Set M
                                                2
                                                = (k/20)LB
                                                ∗ and M
                                                1
                                                =
                                                M
                                                2/10.0.
                                          
                                          
                                             6: Set 
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                      =
                                                      α
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                      +
                                                      (
                                                      1
                                                      -
                                                      α
                                                      )
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             7: For each i, solve SP
                                                
                                                   i
                                                 with 
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             8: Compute 
                                                   
                                                      
                                                         
                                                            LB
                                                         
                                                         
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                      )
                                                      -
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     K
                                                                  
                                                                  
                                                                     w
                                                                  
                                                               
                                                               ·
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     (
                                                                     k
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             9: Update solution pool with all the new columns.
                                          
                                          
                                             10: 
                                                if (LB
                                                
                                                   k
                                                
                                                >
                                                LB
                                                ∗) then
                                             
                                          
                                          
                                             11: Set LB
                                                ∗
                                                =
                                                LB
                                                
                                                   k
                                                .
                                          
                                          
                                             12: 
                                                
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                 
                                                /∗ Update the stability centre∗/
                                          
                                          
                                             13: Call the heuristics explained in Section 5.3 to create globally feasible columns.
                                          
                                          
                                             14: Remove columns which are non-basic and have no contribution to the optimal solution of the RMP for 10 consecutive iterations.
                                          
                                          
                                             15: 
                                                if 
                                                
                                                   
                                                      (
                                                      (
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            RMP
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      -
                                                      
                                                         
                                                            LB
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      )
                                                      /
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            RMP
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      <
                                                      ∊
                                                   
                                                ) then
                                             
                                          
                                          
                                             16: Evaluate the integer version of the MP to identify the best known upper bound UB
                                                ∗ and integer solution.
                                          
                                          
                                             17: 
                                                break
                                                /∗Since the bounds are close enough, there is scope to improve the dual prices∗/
                                          
                                          
                                             18: 
                                                k
                                                =
                                                k
                                                +1
                                          
                                          
                                             19: Report LB
                                                ∗,UB
                                                ∗ and gap
                                                = (UB
                                                ∗
                                                −
                                                LB
                                                ∗)/UB
                                                ∗.
                                          
                                       
                                    
                                 
                              
                           

In Algorithm 1, we apply stabilisation in two stages: (i) Stabilisation at sub-problem level is implemented by using a linear combination of previous and current dual prices (see Step 6) and (ii) Stabilisation at the master problem level is provided by adding a stabilisation term to the objective of the MP (see Section 6.1). Other than these stabilisation techniques, we implemented a feature to store and use multiple solutions (columns) at each iteration (see Step 9). Column management discussed in Section 5.4 is implemented in Step 14. Considering these two factors, Table 1
                         describes four different versions of Algorithm 1. The abbreviations ‘SS’ and ‘MS’ represent single solution and multiple solutions respectively.

In this section we compare the CG algorithm with the integrated model on a set of realistic problem instances. For convenience, the iterative CG Algorithm 1 is represented as ‘CG’. The integrated model is a collection of all sub-problems with an additional linking constraint. It can be expressed as
                        
                           (40)
                           
                              [
                              IM
                              ]
                              
                              
                                 min
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             Z
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      χ
                                                   
                                                   
                                                      iw
                                                   
                                                   
                                                      t
                                                   
                                                
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                ⩽
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      w
                                                   
                                                
                                                ,
                                                
                                                ∀
                                                
                                                w
                                                ,
                                                t
                                                ;
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                ∀
                                                
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where s
                     
                        i
                      corresponds to a schedule (column) of each mine from the solution pool 
                        
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                        
                     , which satisfies constraints (2)–(18) for all i. 
                        
                           
                              
                                 χ
                              
                              
                                 iw
                              
                              
                                 t
                              
                           
                           (
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                           )
                        
                      represents the number of active resources (trains) from the class w at time t for the mine i. The above integrated model is referred to as ‘IM’. The IM is implemented and solved using CPLEX 12.1.


                     Thomas et al. (2013) use 240 randomly generated instances used for a comparison between the LR algorithm and the IM. The same datasets are used for the results presented here. The IM and CG schemes were terminated when the optimal solution is found or when a CPU time limit of one hour is reached. An additional 0.1% tolerance was permitted in the final optimality gap for the IM and 0.005% for the lower bounds in CG (see Step 15 of Algorithm 1). However, sub-problems and job scheduling models were terminated at optimality. The lower bound of CG corresponds to the objective value of RMP and the upper bound is computed from the integer MP. Therefore we allow a 2% optimality gap in CG. The randomly generated instances were bundled in eight series with 30 instances per series. Each series represents a scenario with 5, 6, 7, 8, 9, 10, 12 or 15 mines (producers). The reader may refer to Thomas et al. (2013) for a detailed description of the datasets.

The optimal objective value of the problem depends on randomly generated demand and due-dates. Therefore it is not easy to capture the impact of the solution approaches on different datasets by comparing objective function face values. Therefore, a normalised performance measure is developed based on the t-test. The relative performance ratio for comparing the lower bounds and upper bounds obtained from CG and IM are defined as
                        
                           
                              LBR
                              
                              (
                              CG
                              ,
                              IM
                              )
                              =
                              
                                 
                                    
                                       
                                          LB
                                       
                                       
                                          CG
                                       
                                    
                                    -
                                    
                                       
                                          LB
                                       
                                       
                                          IM
                                       
                                    
                                 
                                 
                                    
                                       max
                                    
                                    (
                                    
                                       
                                          LB
                                       
                                       
                                          CG
                                       
                                    
                                    ,
                                    
                                       
                                          LB
                                       
                                       
                                          IM
                                       
                                    
                                    )
                                 
                              
                              
                              and
                              
                              UBR
                              
                              (
                              CG
                              ,
                              IM
                              )
                              =
                              
                                 
                                    
                                       
                                          UB
                                       
                                       
                                          CG
                                       
                                    
                                    -
                                    
                                       
                                          UB
                                       
                                       
                                          IM
                                       
                                    
                                 
                                 
                                    
                                       min
                                    
                                    (
                                    
                                       
                                          UB
                                       
                                       
                                          CG
                                       
                                    
                                    ,
                                    
                                       
                                          UB
                                       
                                       
                                          IM
                                       
                                    
                                    )
                                 
                              
                              .
                           
                        
                     A positive LB ratio (LBR) means that CG is better, as it has a higher lower bound. Similarly for the upper bound, a positive UB ratio (UBR) means that IM is better. In some cases UBR cannot be computed since the IM was not able to compute a single feasible solution within the time limit. However, the lower bound computation is very quick and hence, LBR is available for all problem instances. The estimated mean and 95% confidence interval (CI) for the same ratios are computed using the t-test. The CI boundaries and the mean are marked with thick lines.

@&#RESULTS AND DISCUSSIONS@&#

The results are summarised in two sections: Section 8.1 shows the impact of stabilisation of CG algorithms and we choose the best one for further analysis. In Section 8.3, we compare the results from the best CG algorithm with the results from the IM and the LR algorithm discussed in Thomas et al. (2013).

The following results compare the four different versions of the CG algorithm given in Table 1. Fig. 1
                         and Table 2
                         compare the relative gap and execution time of different CG versions computed on 240 problem instances.

We analyse the impact of two features: (i) multiple-solutions (MS) and (ii) stabilisation. MS algorithms have smaller relative gap than their SS equivalent versions. For example, in 91.3% of data instances, non-stabilised SS scheme has less than 10% relative gap. However the equivalent MS scheme has 95.8% of data instances with less than 10% relative gap. Similarly 95.4% is improved to 96.7% in the stabilised version. Having multiple solutions helps to improve the upper bound (integer solution). Sometimes in SS, the CG based algorithm may converge to a common lower bound with a worse integer solution. In the long run both approaches may yield the same solution. However, in a given time limit stabilised versions have smaller gaps. The relative gap computed by any CG algorithm is significantly better than the gap obtained by the IM. When we compare the mean and median execution time, stabilised MS is relatively better than any other models. In Table 2, the clustering around t
                        =3600 s is due to one of the termination criteria on the maximum CPU run time.

The best approach from the four versions is the multiple solutions version with the stabilised column generation scheme. A reduction of 1–5% in relative gap is observed by the application of stabilisation techniques in the 240 datasets. These problem sets have only 150/200 times periods and 3–4 orders per production unit. Therefore the advantage will be significantly higher in large problems.


                        Thomas et al. (2013) proposed a distributed solution approach based on the Lagrangian relaxation to solve this problem. This algorithm was strengthened with the Wedelin algorithm (Wedelin, 1995) and Volume algorithm (Barahona and Anbil, 2000). This iterative scheme is referred to as ‘LR’ in the rest of the paper. The same datasets and termination criteria were used to test this algorithm.

From the above runs, we identify that the stabilised multiple solutions method is the best among all CG versions. For convenience this version is henceforth referred to as ‘stabilised CG’ or in short CG, unless it is stated otherwise. The LBR (LR, IM) and UBR (LR, IM) were also defined similar to the ratios defined in Section 7. Some of the results and part of the discussions comparing the LR with IM are presented in Thomas et al. (2013). This section emphasise the new results and comparisons with the CG scheme.


                        Figs. 2 and 3
                        
                         compare LBR and UBR calculated with the stabilised CG, LR and IM. The observations are summarised below:
                           
                              1.
                              The UBR and LBR increase as the number of mines increases. The trend is identical in both, LR and CG, schemes. The highest LBR is observed for the series with 8 mines in both cases. The highest UBR is obtained for the series with 12 mines in both cases.

On an average, LBR for the CG is higher than that of the LR by 1–2%. However, the UBR varies up to 8% since the CG could get better upper bounds than that from the LR.

The lower bounds obtained by the CG are always at least 6% better than the lower bounds found by the IM. The difference was much more significant in instances with more than 7 mines; the quality of lower bounds found by the CG was at least 20% better.

For series with 5 or 6 mines, IM, LR and CG, were able to converge to a solution that is close to the optimal in the given time. Hence the UBR is close to zero for these series.

The CI for the UBR with 12 mines is relatively large. In 26 out of 30 instances; the IM could not find the solution. Therefore the CI has been computed from the remaining 4 values. That might be a reason for the larger interval.

The UBR and LBR increases as the number of mines increases. Figs. 2 and 3 show that the distributed algorithm, specially CG algorithm, is superior to the IM.


                        Table 3
                         compares the mean LBR, UBR from the two decomposed approaches. As we can see from Table 3, the LBR from the CG is always higher than that from the LR. This implies that the CG scheme is able to get tighter lower bound than that of the LR. The same is true for the upper bound too. For the instances with greater than 7 mines, the mean LBR is greater than 20% and the mean UBR is greater than 10% for both distributed algorithms. It shows the advantage of the distributed model over the integrated model. Fig. 4
                         shows the histogram of relative gap observed for IM, LR and CG on 240 data sets. Some of the key observations are.
                           
                              1.
                              The CG outperforms the LB and IM in all cases with significant difference. The number of cases versus relative gap is summarised for all the approaches as
                                    
                                       
                                          
                                          
                                          
                                          
                                          
                                             
                                                Relative Gap (%)
                                                
                                                   CG
                                                
                                                LR
                                                IM
                                             
                                          
                                          
                                             
                                                <2
                                                155/240
                                                80/240
                                                15/240
                                             
                                             
                                                <5
                                                216/240
                                                134/240
                                                17/240
                                             
                                             
                                                <10
                                                232/240
                                                198/240
                                                24/240
                                             
                                          
                                       
                                    
                                 
                              

When the CG achieves less than 5% gap in 89% of cases, the IM could not find a single solution in 111 (46% of) cases. Hence IM will be ineffective for larger problems.

The CG reaches 99% cumulative frequency with a relative gap less than 20% and the LR achieved the same with a relative gap less than 30%.


                                 Fig. 4 shows that the CG scheme converges faster than the LR scheme.


                        Table 4
                         compares the CPU run time of IM, LR and CG. It is evident that the CG has a clear advantage over the LR and IM in terms of run time. The clustering around t
                        =3600seconds is due to one of the termination criteria of fixing the maximum CPU run time to one hour.

@&#CONCLUSIONS@&#

We study a resource constrained scheduling problem (RCSP) with multiple producers and a single linking constraint. This is motivated from a real-world mining example. We present mathematical models for the integrated problem, which includes production planning and resource scheduling. The integrated problem is decomposed and solved with the column generation (CG) techniques and compared with a similar Lagrangian relaxation (LR) approach (see Thomas et al., 2013). The distributed modelling, solved using a decomposition approach has many advantages over the integrated modelling approach, in term of the quality of solutions and computational time. Computational experiments show that the CG outperforms LR and IM. Although the methods that have been developed in this paper are tested within the context of a coal supply chain, it can be extended to other general RCSPs in contexts such as airline, wine, automobile manufacturing and the service industry.

Two major decisions are considered in our approach: production planning and resource scheduling. The upper bound of the distributed model can be further strengthened by the proposed heuristics. Different stability functions can also be explored to further strengthen the performance of the CG. In future research, we plan to develop new algorithms for cases with partial information sharing and also for cases where there are multiple objectives. Ongoing research extends this study by including a third level of decision related to procurement and warehousing. For example, the coal supply chain problem can be extended to truck operations and terminal management operations. It is necessary to test the efficiency of our method on extensions that include more than two sets of decision makers.

An alternative approach is decentralised decision making which requires (i) multiple stakeholders, (ii) information asymmetry, (iii) conflict in objectives, and (iv) a negotiation protocol. Our model considers multiple mines that do not interact/share-information with other mines while they constantly interact with the rail operator. The mines and the rail operator possess different sets of information. Hence the decision model has an inherent information asymmetry. This means that the decision model meets the first two requirements. The objectives of (each of) the mines and the rail operator are not same. Every mine expects the rail operator to send a train to the mine to load the coal and deliver it on-time at the terminal. However, the rail operator may have different priorities and constraints. Hence there is a conflict in the objectives of the players. The fourth requirement of ‘negotiation mechanisms’ is not available in our model. In that sense, ours is not a decentralised decision making framework. In our approach, the negotiation protocol is only partially implemented using the CG algorithm which is (in a sense) ‘controlled’ by the ‘honest broker’ rail operator. We made this assumption just so that we could converge to a solution to that is in fact a very difficult real-world problem.

In this paper, we have proposed a solution approach for a distributed supply chain which has information asymmetries, and conflict in objectives amongst the partners. The distributed framework can be upgraded to a decentralised framework by introducing a honest broker. A decentralised framework would also have a negotiation scheme. The honest broker who manages the negotiation decides whether a decision is a wrong or right and manages the compensatory schemes for bad solutions that any one producer receives. In our paper, the negotiation protocol is only partially implemented using the CG algorithm which is (in a sense) ‘controlled’ by the ‘honest broker’ rail operator. Further research will need to include proper negotiation mechanisms and ensuring that the rail operator is no longer a ‘de facto honest broker’.

@&#ACKNOWLEDGEMENTS@&#

We thank the anonymous reviewers and the editors for their valuable contributions and inputs, which have greatly enhanced the quality of the manuscript.

@&#REFERENCES@&#

