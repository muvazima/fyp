@&#MAIN-TITLE@&#Recovery of gastrointestinal tract motility detection using Naive Bayesian and minimum statistics

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A method for detection of recovery of gastrointestinal track motility was proposed.


                        
                        
                           
                           Bowel activity statistics were obtained for patients who underwent abdominal surgery.


                        
                        
                           
                           Total burst duration and power in 100–200Hz band showed high predictive power.


                        
                        
                           
                           Tested on 59h of recordings and 94.15% recognition accuracy was observed.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Bowel sound

Electronic stethoscope

Real-time monitoring

Naive Bayesian

Kernel density estimation

@&#ABSTRACT@&#


               
               
                  Loss of gastrointestinal motility is a significant medical setback for patients who experience abdominal surgery and contributes to the most common reason for prolonged hospital stays. Recent clinical studies suggest that initiating feeding early after abdominal surgery is beneficial. Early feeding is possible when the patients demonstrate bowel motility in the form of bowel sounds (BS). This work provides a data collection, processing and analysis methodology for detection of recovery of gastrointestinal track motility by observing BSs in auscultation recordings. The approach is suitable for real-time long-term continuous monitoring in clinical environments. The system was developed using a Naive Bayesian algorithm for pattern classification, and Minimum Statistics and spectral subtraction for noise attenuation. The solution was tested on 59h of recordings and 94.15% recognition accuracy was observed.
               
            

@&#INTRODUCTION@&#

Gastrointestinal motility, or peristalsis, indicates the digestive tract׳s ability to contract and is essential for food intake. After major abdominal surgery, a temporary inhibition of gastrointestinal motility occurs. The inhibition duration correlates with the type of anesthesia used and the degree of surgical trauma [1]. In order to prevent postoperative nausea and vomiting, a period of fasting is commonly practiced and patients are fed with fluids following the recovery of motility [2].

Loss of gastrointestinal motility is a significant medical setback and contributes to the most common reason for delayed hospital discharge. Prolonged hospital stays have economic consequences but more importantly the discomfort experienced by the patients increases significantly. Recent studies suggest that initiation of early postoperative enteral feeding via oral or nasoenteric administration improves wound healing [3], reduces septic morbidity after abdominal trauma [4] and pancreatitis [5]. Early feeding is possible when the patients demonstrate bowel motility in the form of BSs.

Auscultation is commonly used for bowel motility assessment in hospital environments. It is easy, safe and requires only a stethoscope. However, due to high workload and lack of expert personnel, frequent patient visits are rarely possible, and feeding may be delayed.

Various researchers have investigated automatic detection and classification of BSs. The most promising techniques used for short-term BS analysis are fractal dimension [6], higher order statistics [7], wavelet decomposition [8] and artificial neural network [9]. Studies performed by Dimoulas et.al [10], Kim et.al. [11], Emoto et al. [12] focused on the long-term monitoring and temporal changes of the occurrence of BSs [13]. Hadjileontiadis [14,15] Dimoulas et al. [16] studied signal de-noising and wavelet based noise reduction. Also pioneering study by Dimoulsas et al. [17] used multimodal activity analysis using video surveillance.

Although many methods exist, high computational complexity hinders their applicability for real-time continuous processing and sensitivity to interfering noise in clinical environments reduces detection rates. The aim of this work is to propose a complete data collection, signal processing and analysis methodology which is suitable for detection of recovery of gastrointestinal track motility by observing BSs in continuous noisy auscultation recordings. Bowel and other interfering sounds were classified using a Naive Bayesian (NB) algorithm and noise estimation was performed by using Minimum Statistics (MS) and spectral subtraction. Both methods are computationally inexpensive and suitable for real-time processing.

This paper is a substantially extended version of the previous conference publication [18] and to the best of author׳s knowledge, there are no other studies on automatic detection of the recovery of gastrointestinal motility after major abdominal surgery. The main differences are detection is addressed as a classification problem, noise level is estimated for each frame, adaptive threshold is used for feature extraction and the system is tested on more subjects.

The sound produced by the bowel activity (BA) is usually observed as a non-stationary short-time signal with explosive character, occasionally contaminated by noise and other artifacts such as heartbeat, movement, breathing etc. [19]. The duration of an individual BA is typically between 0.02 and 0.1s. Sound level correlates with the intensity of the bowel movement. Typically, BSs are categorized into two activity classes: single burst (SB) and multiple bursts (MB) [19,20]. SB is result of short duration contractions and creates spiky sounds. MB consists of a cluster of SBs occurring side by side with tiny or no gaps. Quite periods (QP) are observed in the absence of BA or noise. Recent work by Dimoulas et al. [21] suggests a hierarchical taxonomy called abdominal sounds fine classification (ASFC) for abdominal sound pattern analysis and utilizes features of duration, spectral centroid and spectral bandwidth. In this taxonomy, the interfering sounds and noises are classified into five different classes; Additive Broadband Noise (ABN), Respiratory Related Noise (RRN), Movement and Friction Noise (SN), Examination Room Noises (AN) and Heart-Beat related noise (IHS). In this work, different than ASFC taxonomy, the respiratory sounds are also interference and classified as RRN. 
                     Fig. 1 depicts the observed sound types and their corresponding spectral signatures.

The number of bursts varies between subjects, and physical state. BA occurs approximately every 2–12 s in an irregular pattern. Reduced (hypoactive) bowel activity can be observed during sleep and after use of certain medication. Increased (hyperactive) BA occurs with diarrhea, gastroenteritis, inflammatory bowel disease, gastrointestinal bleeding and after feeding [22].

For clinical environments with various background noises, noise level estimation and attenuation is essential for successful detection of BAs. After testing different techniques, the MS method [23] was considered for noise estimation because it does not use any explicit threshold, is very sensitive to the periodic noise and computationally inexpensive. The MS method is based on the idea that the activity at interest and interfering noise are independent and noise-only signal is frequently observed.

Let x be the sum of the background noise bn and a clean signal bs. X, BN and BS represent the Discrete Fourier Transform (DFT) of each signal respectively
                        
                           (1)
                           
                              X
                              (
                              n
                              ,
                              k
                              )
                              =
                              BS
                              (
                              n
                              ,
                              k
                              )
                              +
                              BN
                              (
                              n
                              ,
                              k
                              )
                           
                        
                     where n is the time frame index and k is the frequency-bin index. During QPs, the signal power reduces to the background noise power and by tracking the minimum, it is possible to obtain an accurate noise power estimate [23]. Typically, the following smoothed periodogram P(n,k) is used to obtain the minimum of the local energy
                        
                           (2)
                           
                              P
                              (
                              n
                              ,
                              k
                              )
                              =
                              α
                              P
                              (
                              n
                              −
                              1
                              ,
                              k
                              )
                              +
                              (
                              1
                              −
                              α
                              )
                              |
                              X
                              (
                              n
                              ,
                              k
                              )
                              
                                 
                                    |
                                 
                                 2
                              
                           
                        
                     where α is the smoothing parameter, a value between 0 and 1. Finally, the noise power is estimated by searching the minimum value within a finite window length (L) as follows:
                        
                           (3)
                           
                              
                                 
                                    λ
                                 
                                 
                                    m
                                    i
                                    n
                                    ,
                                    N
                                 
                              
                              (
                              n
                              ,
                              k
                              )
                              =
                              
                              min
                              
                              [
                              P
                              (
                              n
                              ,
                              k
                              )
                              ,
                              P
                              (
                              n
                              −
                              1
                              ,
                              k
                              )
                              .
                              .
                              
                              P
                              (
                              n
                              −
                              L
                              ,
                              k
                              )
                              ]
                           
                        
                     where min is the minimum operator. The minimum statistics typically underestimates the noise power and requires a bias compensation factor. The unbiased noise power estimator is given by the following:
                        
                           (4)
                           
                              
                                 
                                    
                                       λ
                                       ^
                                    
                                 
                                 
                                    N
                                 
                                 
                                    M
                                    S
                                 
                              
                              (
                              n
                              ,
                              k
                              )
                              =
                              
                                 
                                    B
                                 
                                 
                                    m
                                    i
                                    n
                                 
                              
                              (
                              n
                              ,
                              k
                              )
                              
                                 
                                    λ
                                 
                                 
                                    m
                                    i
                                    n
                                    ,
                                    N
                                 
                              
                              (
                              n
                              ,
                              k
                              )
                           
                        
                     where B
                     
                        min
                     (n,k) is the bias compensation factor (BCF). Comprehensive studies on noise power spectral estimation and spectral subtraction can be found in [23–25].

@&#METHODOLOGY@&#

The BSs were obtained from 6 female and 4 male subjects between 26 and 65 years old who underwent abdominal surgery. The operation durations were between 2 and 3h. The post-operative nausea and vomiting was seen in two of the subjects. The recordings were performed using a modified stethoscope [18] in the General Surgery department of Akdeniz University hospital and digitized with 14bit precision at a sampling rate of 8192Hz with a data acquisition card (NI-USB 6009, National Instruments Corporation, USA) attached to the computer via USB port. The stethoscope was placed on the lower right abdomen, near the cecum. Duration of the auscultation recordings were between 1.13 and 10h. All the processing steps were performed by using Matlab 7.1 (Mathworks, Natick, MA). The study was approved by the Institutional Review Board of Akdeniz University and the informed consents of all the participants were obtained.

The recordings were filtered by a second-order Butterworth-type high-pass filter with 100Hz cut off frequency, a low-pass filter with 1000Hz cut off frequency and a 50Hz notch filter to attenuate known interferences introduced by activities such as inspiration, heartbeat and power line. The filters were applied in forward and backward directions to obtain a response with zero phase distortion. The recordings were segmented into non-overlapping one second frames, interfering background noise was estimated using MS algorithm (BCF=1, α=0.95, L=10). 
                        Fig. 2 shows the processing steps.

The non-stationary character, variation in duration and amplitude of BAs make identification a very complex task, and temporal and spectral features were utilized. For each frame, total burst duration (TBD), maximum amplitude (MA) and longest burst duration (LBD) were estimated using a Hilbert transform based amplitude envelope. The onset and offset of the bursts were identified as the time points when the Hilbert envelope magnitude intersects with the threshold. The threshold value was selected using a multiple of the MS noise estimate. Signal׳s root mean square (RMS) is a commonly used measure of noise and is also equal to the standard deviation (SD) of a zero mean signal [26,27]. According to Parseval׳s theorem, power of a signal in time domain equals to power in frequency domain as following:
                           
                              (5)
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    L
                                 
                                 |
                                 x
                                 (
                                 i
                                 )
                                 
                                    
                                       |
                                    
                                    2
                                 
                                 =
                                 
                                    1
                                    L
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       0
                                    
                                    L
                                 
                                 |
                                 X
                                 (
                                 k
                                 )
                                 
                                    
                                       |
                                    
                                    2
                                 
                              
                           
                        where X is the DFT of x and L is the length of the signal. Using Eq. (5), the SD of the noise (σ
                        
                           N,K
                        ) for kth frame is equal to MS noise power estimate in Eq. (4) as following:
                           
                              (6)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       N
                                       ,
                                       K
                                    
                                 
                                 =
                                 
                                    
                                       
                                          1
                                          
                                             
                                                
                                                   L
                                                
                                                2
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             n
                                             =
                                             0
                                          
                                          L
                                       
                                       |
                                       
                                          
                                             
                                                λ
                                                ^
                                             
                                          
                                          
                                             N
                                          
                                          
                                             M
                                             S
                                          
                                       
                                       (
                                       n
                                       ,
                                       k
                                       )
                                       
                                          
                                             |
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        where L is the length of the signal.

Burst detection threshold (Th) is selected using a multiple of the noise level. Different multiplier values were tested and 3 times the SD of the noise was used as the threshold value (Th=3σ
                        
                           N,K
                        ). Finally, very short threshold crossings (<0.01s) were assumed as noise and discarded. 
                        Fig. 3 shows an example of the burst detection using MS noise estimate and threshold crossing. Red dashed line indicates the threshold and detected bursts are highlighted with black arrows.

Using Eq. (1), the noise-free signal power was obtained by spectral subtraction as following:
                           
                              (7)
                              
                                 |
                                 BS
                                 (
                                 n
                                 ,
                                 k
                                 )
                                 |
                                 =
                                 |
                                 X
                                 (
                                 n
                                 ,
                                 k
                                 )
                                 |
                                 −
                                 |
                                 BN
                                 (
                                 n
                                 ,
                                 k
                                 )
                                 |
                              
                           
                        and used for spectral feature extraction. The frequency content of the BA is band-limited and around 97.5% of the signal energy is located between 100–500Hz [20], therefore, the following spectral features were estimated from the frequency spectrum between 100–500Hz.

The SC represents the balancing point of the spectral power distribution and is calculated as the weighted average power of the frequencies according to
                              
                                 (8)
                                 
                                    SC
                                    (
                                    n
                                    ,
                                    l
                                    ,
                                    u
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                l
                                             
                                             u
                                          
                                          k
                                          |
                                          BS
                                          (
                                          n
                                          ,
                                          k
                                          )
                                          
                                             
                                                |
                                             
                                             2
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                l
                                             
                                             u
                                          
                                          |
                                          BS
                                          (
                                          n
                                          ,
                                          k
                                          )
                                          
                                             
                                                |
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           where n is the time frame index, l and u are the lower and upper edges of the sub-band and BS(n,k) is the amplitude of the kth frequency bin of the noise-free spectrum.

The SBW is measured as the weighted average of the distances between the frequencies and the SC as following.
                              
                                 (9)
                                 
                                    SBW
                                    (
                                    n
                                    ,
                                    l
                                    ,
                                    u
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                l
                                             
                                             u
                                          
                                          
                                             
                                                (
                                                k
                                                −
                                                SC
                                                (
                                                n
                                                ,
                                                l
                                                ,
                                                u
                                                )
                                                )
                                             
                                             2
                                          
                                          
                                          |
                                          BS
                                          (
                                          n
                                          ,
                                          k
                                          )
                                          
                                             
                                                |
                                             
                                             2
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                l
                                             
                                             u
                                          
                                          |
                                          BS
                                          (
                                          n
                                          ,
                                          k
                                          )
                                          
                                             
                                                |
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        

Detailed examination of the frequency spectrum of SB and MB sound types revealed that signal energy is located in a frequency range between 100 and 200Hz. Thus, the frequency spectrum was divided into four equal disjoint sub-bands and normalized energy in each sub-band was calculated as following:
                              
                                 (10)
                                 
                                    SBNE
                                    (
                                    n
                                    ,
                                    l
                                    ,
                                    u
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                l
                                             
                                             u
                                          
                                          |
                                          BS
                                          (
                                          k
                                          )
                                          
                                             
                                                |
                                             
                                             2
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                          
                                          |
                                          BS
                                          (
                                          k
                                          )
                                          
                                             
                                                |
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        

The feature values were combined into a single vector and used for sound type classification. Different classification algorithms have been tested including Bayesian type classifiers which establish a statistical model of the system and predict the posterior probability of class membership based on the observations. In this work, NB approach with Kernel Density Estimate [28,29] was considered for the classification of BSs into the previously mentioned sound types. NB assumes that the features used for classification are statistically independent, therefore, with observed feature values x
                           1,…,x
                           
                              n
                           , the posterior probability of each class c is estimated as follows:
                              
                                 (11)
                                 
                                    p
                                    (
                                    x
                                    ,
                                    c
                                    )
                                    =
                                    p
                                    (
                                    c
                                    )
                                    
                                       ∏
                                       
                                          i
                                          =
                                          1
                                       
                                       D
                                    
                                    p
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    c
                                    )
                                 
                              
                           
                        

The class with the maximum posterior probability is assigned to the frame. During training, the algorithm learns the probability distribution of each class p(c) and the class dependent feature distribution p(x
                           
                              i
                           
                           |c).

The independence between features is rarely possible, empirical results show that the accuracy of the NB is surprisingly high in a wide range of applications, scales well with large number of features and calculation only requires multiplication of the probabilities [28–30]. Besides, NBs classification probabilities are easy to interpret and modifications are possible to incorporate expert knowledge.

The role of the detection algorithm is to raise the alarm indicating the return of gastrointestinal motility. For a reliable detection, an observation window was utilized as follows:
                           
                              (12)
                              
                                 
                                    
                                       z
                                    
                                    
                                       n
                                       ,
                                       l
                                    
                                 
                                 =
                                 
                                    1
                                    l
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       n
                                       −
                                       l
                                    
                                    n
                                 
                                 
                                    
                                       1
                                    
                                    
                                       {
                                       C
                                       
                                       ∈
                                       
                                       {
                                       SB
                                       ,
                                       MB
                                       }
                                       }
                                    
                                 
                                 >
                                 η
                              
                           
                        where C is the class, l indicates the number of frames to be considered, n is the current frame number, t
                        
                           a
                         denotes the threshold and 1
                        
                           {x}
                         is the indicator of event x. The decision 
                           
                              
                                 z
                              
                              
                                 n
                                 ,
                                 l
                              
                           
                         is formulated over multiple observations before the current frame. The value of t
                        
                           a
                         is a trade-off between the ability to detect recovery sooner and avoid raising alarm when no change occurred in the motility (low sensitivity to noise).

Any one-second frame with TBD value more than zero was classified into one of the seven sound types and was marked by an expert. Segments with zero TBD were marked as QP. The training and testing was performed ten times using ten-fold cross validation where the frames were randomly partitioned so that ten percent of them were used for testing and the rest were used for training.

A variety of performance measures have been introduced for the estimation of the classifier performance. The most commonly used one is the prediction accuracy (PA) which is simply calculated on a frame-by-frame basis as the ratio of the number of truly classified frames to the total number of frames.
                           
                              (13)
                              
                                 PA
                                 =
                                 
                                    
                                       true
                                       
                                       classification
                                    
                                    
                                       total
                                       
                                       classification
                                    
                                 
                                 ×
                                 100
                              
                           
                        
                     

Second key metric is time to detect (TTD) which indicates the time from when the gastrointestinal motility starts until it is detected. TTD is estimated as the time difference between the time of the first frame classified as IB or MB by the expert and the time the detection algorithm raised the alarm.

@&#RESULTS@&#

A total of 213.402s of recordings from ten subjects were used for training and testing. The most frequently observed BS type was QP (95.89%). ABN, SB, MB, SN and AN types were observed 1.23%, 0.89%, 0.61%, 0.32% and 1.05% respectively. 
                     Table 1 presents the PA results for each class. The overall PA was 94.15%. The lowest PA was observed for ABN type which was mostly confused with SN.


                     
                     Table 2 shows the mean and standard deviation of features used for classification. MB had longer TD (0.07±0.05s) than SB and, AN had the longest TD (0.14+0.09s). Spectral properties of SB and MB types were similar to each other and LBD were 0.04±0.02 and 0.03±0.02s respectively. The normalized energy in each sub-band was evenly distributed for the QP type and was significantly different for the noise and MB types. ANM typically had power in random frequency bins. For MB and SB types, the power was usually located in the frequency range between 100 and 200Hz. Feature relevance was determined using forward feature selection. TD and 100–200 showed the highest predictive power.


                     
                     Fig. 4 depicts the performance results of the detection algorithm for different observation window lengths (l in Eq. (13)). The threshold (t
                     
                        a
                     ) was set to two observations per minute (2/60) (after surgery, reduced bowel activity was observed). The alarm was raised for all the subjects when the observation window length was between 480 and 630 s and 90% of the subjects when it was between 660 and 1320s. The average TTDs were between 1631 and 3540s. The longer TTDs indicate a late detection of the recovery of motility. Shorter observation windows have tendency to detect the recovery sooner but the risk of raising false alarms increases.


                     
                     Fig. 5 shows the number of frames with burst sound (SB or MB) for the subject 6 when the observation window length was set to 630s. The red solid line indicates the threshold value. Star indicates the first frame marked by the expert as burst sound. The alarm was raised at 1344th second, 1287s after first frame marked as IB by the expert.

@&#CONCLUSION@&#

Gastrointestinal motility stops after major abdominal surgery and it has been a common practice to restrict the oral intake of patients until it returns. Recent studies by [3–5] indicate early feeding of the patients reduces the hospitalization duration. Early feeding is only possible after the reappearance of the regular bowel sounds which indicates the return of intestinal activity.

This work has introduced a monitoring system as a solution to the problem of detecting the recovery of gastrointestinal motility in noisy auscultation recordings. An alarm indicating the return of intestinal activity was raised by observing multiple occurrences of the burst sounds within an observation window. The system was tested on ten auscultation recordings performed in clinical environments and an overall 94.15% recognition performance was observed. To detect BAs in auscultation recordings, Dimoulas et al. used feed forward multilayer neural networks and observed a 95% overall recognition performance [19]. The algorithm was tested on multichannel auscultation recordings. Similarly, the method proposed by Ranta et al. also utilized six recording channels [20]. In this study, single stethoscope was used because placing multiple stethoscopes on different areas of the abdomen might not be possible due to the surgery wound. Long-term unsupervised monitoring approaches [10–12] and complex de-noising techniques [10,16] have been developed for BS analysis. Compared to those techniques, the proposed approach is computationally less expensive and suitable for real-time continuous monitoring.

Using forward feature selection, the feature relevance was determined. TD and normalized power in the frequency range between 100 and 200Hz showed the highest predictive power. Although, similar features such as duration, spectral centroid and spectral bandwidth were used by [19,21], the MS based noise estimation and adaptive thresholding increased their predictive power under noisy conditions.

Continuous monitoring of BSs is desirable to perform research on healing enhancement after surgery. Although, auscultation recordings of large diverse population are necessary to assess the clinical usefulness of the system, the results of this study are quite promising. In future work, Dimoulas et al. [10] used a state transition diagram for the detection and segmentation. Adopting a state transition approach might further extend the system performance.

None declared.

@&#ACKNOWLEDGMENT@&#

Author would like to express his gratitude to Prof. Murat Canpolat, Prof. Guner Ogunc, Muhittin Yaprak and Seyfettin Kazanir for their participation in hardware design, patient recruitment and data collection. This research has been supported by Akdeniz University Scientific Research Projects Unit.

@&#REFERENCES@&#

