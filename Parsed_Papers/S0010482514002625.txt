@&#MAIN-TITLE@&#Benefits of a new Metropolis–Hasting based algorithm, in non-linear regression for estimation of ex vivo antimalarial sensitivity in patients infected with two strains

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We model the antimalarial sensitivity in a blood sample with two strains of parasite.


                        
                        
                           
                           We develop a Metropolis–Hasting algorithm to estimate parameters of the model.


                        
                        
                           
                           We compare our estimation results with three other algorithms.


                        
                        
                           
                           We evaluate our algorithm on a simulation study, on in vitro and ex vivo data.


                        
                        
                           
                           For poor concentration design, our algorithm gives accurate results.


                        
                     
                  
               
            

@&#KEYPHRASES@&#




                     Plasmodium




                  

Modeling

Nonlinear regression

Gauss–Newton algorithms

Simulated annealing algorithms

Metropolis–Hasting algorithms

Antimalarials

Sensitivity

@&#ABSTRACT@&#


               
               
                  Malaria is one of the world׳s most widespread parasitic diseases. The parasitic protozoans of the genus Plasmodium have developed resistance to several antimalarial drugs. Some patients are therefore infected by two or more strains with different levels of antimalarial drug sensitivity. We previously developed a model to estimate the drug concentration 
                        (
                        
                           
                              IC
                           
                           
                              50
                           
                        
                        )
                      that inhibits 50% of the growth of the parasite isolated from a patient infected with one strain. We propose here a new Two-Slopes model for patients infected by two strains. This model involves four parameters: the proportion of each strain and their IC
                     50, and the sigmoidicity parameter. To estimate the parameters of this model, we have developed a new algorithm called PGBO (Population Genetics-Based Optimizer). It is based on the Metropolis–Hasting algorithm and is implemented in the statistical software R. We performed a simulation study and defined three evaluation criteria to evaluate its properties and compare it with three other algorithms (Gauss–Newton, Levenberg–Marquardt, and a simulated annealing). We also evaluated it using in vitro data and three ex vivo datasets from the French Malaria Reference Center.
                  Our evaluation criteria in the simulation show that PGBO gives good estimates of the parameters even if the concentration design is poor. Moreover, our algorithm is less sensitive than Gauss–Newton algorithms to initial values. Although parameter estimation is good, interpretation of the results can be difficult if the proportion of the second strain is close to 0 or 1. For these reasons, this approach cannot yet be implemented routinely.
               
            

@&#INTRODUCTION@&#

Malaria is one the main causes of death around the world. World Health Organization (WHO) estimates for 2010 put the number of deaths at more than 660000 (490000–836000) and the total number of cases at 219 (154–289) million [1]. Malaria is transmitted through the bite of a mosquito (Anopheles) infected by a parasite called Plasmodium: the infected female mosquito bites someone to feed itself and to enable the development of its eggs, and at the same time injects the parasite present in its saliva into the host. There are 5 species of Plasmodium responsible for malaria but the most dangerous is Plasmodium falciparum, which is the most prevalent species in Africa (98% [2]).

The fight against malaria consists of attempts to control mosquitoes, the main vector of the parasite and the use of antimalarial drugs. However depending on the targeted populations and the mode of treatment, mosquitoes are rapidly becoming resistant to insecticide, Plasmodium parasites are becoming resistant to antimalarial drugs, and these drugs, which are very effective for prevention and treatment, are expensive for some populations, especially the most affected [2].

Because of the increasing resistance of P. falciparum to antimalarial drugs, organizations such as the French Malaria Reference Center (CNRpalu), Drug Resistance and Containment (DRC/GMP/WHO), and the World Wide Antimalarial Resistance Network (WWARN) have decided to monitor antimalarial resistance. In France, CNRpalu records all cases of malaria reported cases in France, takes blood samples and performs ex vivo tests to evaluate the level of resistance to various antimalarial drugs: chloroquine, atovaquone, desethyl amodiaquine, dihydroartemisine, quinine, doxycycline, mefloquine. To determine if a parasite has decreased susceptibility to an antimalarial drug, the estimated concentration that inhibits 50% of the parasite׳s activity for a given drug is compared with a series of values for isolates that normally respond to treatment. For example the threshold for chloroquine is 100nmol/L [3]. In the CNRpalu, results from ex vivo tests are recorded in a data bank.

The concentration which inhibits 50% of the parasite׳s activity is called IC
                     50 (i.e., the in vitro drug 50% inhibitory concentration).The IC
                     50 for a given drug determines whether the parasite in the blood sample is resistant or not to this drug. To estimate IC
                     50 for a blood sample a web tool called ICEstimator [4] is used routinely at CNRpalu. ICEstimator, which was developed by our research group, provides an IC
                     50 estimation based on an E
                     
                        max
                      model [5]. It was written as an R [6] function with a nonlinear regression performed with nls in R for parameters estimation with the Gauss–Newton algorithm. This algorithm efficiently estimates IC
                     50 when there is a parasite population with homogeneous susceptibility.

Using molecular detection of resistance mutations, some biologists have noted that blood samples may contain two or more different strains of parasite with different levels of resistance to antimalarial drug and in this case the use of the E
                     
                        max
                      model is inappropriate due to the way it is written. The slow growing Plasmodium needs weeks to be cloned and so more time is needed for the selection process. An ex vivo Plasmodium susceptibility test then measures the response of a heterogeneous population (median number of clones with different levels of resistance to an antimalarial drug, in an infected patient, is 3 in Africa).

To analyze this type of data, we propose a new model, inspired by Willet et al. 
                     [7] the “Two Slopes” (TS) model which is a convex linear combination of two E
                     
                        max
                      models with the same sigmoidicity factor. This model contains two IC
                     50 values, one for each of the two parasite strains, which may havedifferent antimalarial drug resistance, and their proportions. As previously, parameters were estimated by non-linear regression. As the difficulty of finding good initial values hampers use of Gauss Newton algorithms in our case, we developed our own optimization algorithm, the Population Genetics Based Optimizer (PGBO), based on the Metropolis–Hasting (M–H) algorithm. PGBO was developed in order to optimize hundreds of parameters in complex neural network models [8]. To evaluate it, we compared it with three other algorithms: Gauss–Newton and Newton–Raphson which are respectively implemented in R functions nls and MarqLevAlg [9], and another algorithm based on Metropolis Hasting [10] which is implemented in the R package GenSA [11]. First, we evaluated estimations from our algorithms using simulation data, and then using the in vitro data of Kaddouri et al. in [12] and, finally, we illustrated our approach using three sets ex vivo data, from three different infected patients, given by the CNRpalu.

As with the ICEstimator, data were normalized as follows [4]: assuming that the average responses when the drug concentration is null (C
                        0) are equal to 100% and that the average responses when the drug concentration is the highest (C
                        
                           max
                        ) equal to 0%, we call 
                           E
                           (
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                           )
                         the average of the observed responses at C
                        0, 
                           E
                           (
                           
                              
                                 C
                              
                              
                                 max
                              
                           
                           )
                         the average of the observed responses at C
                        
                           max
                         and E
                        
                           i
                         the observed responses at C
                        
                           i
                        , therefore the relative effect RE
                        
                           i
                         at concentration C
                        
                           i
                         in percent is given by 
                           
                              
                                 RE
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       E
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             max
                                          
                                       
                                       )
                                    
                                    
                                       E
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       −
                                       E
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             max
                                          
                                       
                                       )
                                    
                                 
                                 ×
                                 100
                                 .
                              
                           
                        
                     

The TS model was developed to evaluate the sensitivity of two strains of parasite with different levels of antimalarial drug resistance. As in [7], the TS model is defined by
                           
                              (1)
                              
                                 RE
                                 (
                                 C
                                 ,
                                 Θ
                                 )
                                 =
                                 (
                                 1
                                 −
                                 P
                                 )
                                 [
                                 
                                    
                                       
                                          E
                                       
                                       
                                          MAX
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                MAX
                                             
                                          
                                          
                                             
                                                C
                                             
                                             
                                                γ
                                             
                                          
                                       
                                       
                                          
                                             
                                                C
                                             
                                             
                                                γ
                                             
                                          
                                          +
                                          
                                             
                                                IC
                                             
                                             
                                                50
                                                ,
                                                1
                                             
                                             
                                                γ
                                             
                                          
                                       
                                    
                                 
                                 ]
                                 +
                                 P
                                 [
                                 
                                    
                                       
                                          E
                                       
                                       
                                          MAX
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                MAX
                                             
                                          
                                          
                                             
                                                C
                                             
                                             
                                                γ
                                             
                                          
                                       
                                       
                                          
                                             
                                                C
                                             
                                             
                                                γ
                                             
                                          
                                          +
                                          
                                             
                                                IC
                                             
                                             
                                                50
                                                ,
                                                2
                                             
                                             
                                                γ
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        where Θ is the vector of parameters defined by 
                           Θ
                           =
                           (
                           
                              
                                 
                                    IC
                                 
                                 
                                    50
                                    ,
                                    1
                                 
                              
                              ,
                              
                                 
                                    IC
                                 
                                 
                                    50
                                    ,
                                    2
                                 
                              
                              ,
                              P
                              ,
                              γ
                           
                           )
                        , 
                           RE
                           (
                           C
                           ,
                           Θ
                           )
                         is the relative effect of the parasite activity at a concentration C of antimalarial drug for a given Θ, E
                        
                           MAX
                         is the maximal effect (here equals 100), 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 1
                              
                           
                         is the drug concentration that inhibits 50% of the activity of the parasite with the lowest drug resistance, 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 2
                              
                           
                         is the value that inhibits 50% of the activity of the parasite with the highest level of drug resistance (
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 1
                              
                           
                           <
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 2
                              
                           
                        ), P is the proportion of parasite that has the highest level of drug resistance, and γ is the sigmoidicity factor.

For P=0, P=1 or 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 2
                              
                           
                        , the TS model is equivalent to the simple one slope E
                        
                           max
                         model [5].


                        Fig. 1
                         displays five examples of the TS model with various parameter values. In this example, we consider that the black curve is the reference and the others were built from the reference by changing the value of one parameter.The higher the 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 1
                              
                           
                         the more the curve is on the right of the plot. The higher the γ, the steeper the slope. Also the closer the P is to 1 (respectively to 0), the higher (respectively lower) the second inflection point. For similar values of 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 1
                              
                           
                         and 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 2
                              
                           
                         the TS model corresponds to a one slope model. We consider the statistical model with an additive error as follows:
                           
                              (2)
                              
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 RE
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 Θ
                                 )
                                 +
                                 σ
                                 
                                    
                                       ϵ
                                    
                                    
                                       i
                                    
                                 
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                           
                        where C
                        
                           i
                         is the i
                        th concentration, Y
                        
                           i
                         the i
                        th normalized observation, 
                           
                              
                                 ϵ
                              
                              
                                 i
                              
                           
                           ~
                           N
                           (
                           0
                           ,
                           1
                           )
                        , 
                           σ
                           >
                           0
                         and n is the number of observations.

Because the error is additive and homoscedastic we estimate parameters using the Ordinary Least Square (OLS) method, which minimizes the sum of squared vertical distances between the observed responses in the dataset and the responses predicted by the model. Thus 
                           
                              
                                 OLS
                                 (
                                 Θ
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             Y
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       RE
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       Θ
                                       )
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        thus 
                           
                              
                                 
                                    
                                       Θ
                                    
                                    
                                       ^
                                    
                                 
                                 =
                                 arg
                                 
                                 min
                                 {
                                 
                                    Θ
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          +
                                       
                                       
                                          2
                                       
                                    
                                    ×
                                    [
                                    0
                                    ;
                                    1
                                    ]
                                    ×
                                    
                                       
                                          R
                                       
                                       
                                          +
                                       
                                    
                                    ,
                                    
                                    OLS
                                    (
                                    Θ
                                    )
                                 
                                 }
                              
                           
                        For linear models, the exact solution of the OLS method is well known, but our model is nonlinear. Therefore algorithms must be used to solve the OLS and approximate the solution. We used two kinds of algorithms: Newton type (NT) algorithms and Metropolis–Hasting (M–H) algorithms.

Two NT algorithms were implemented in R [6]:Gauss–Newton׳s algorithm was the default algorithm in the R function nls, andMarquardt–Leveberg׳s algorithm (which is based on the Newton–Raphson algorithm) was used in the R׳ package “MarqLevAlg” [9].

The Gauss–Newton algorithm can be described in several steps. The first step is the selection of an initial value for the vector of the parameter to initialize the algorithms. We call this vector Θ
                           0. Then, with iteration k to iteration 
                              k
                              +
                              1
                           , we have
                              
                                 (3)
                                 
                                    
                                       
                                          Θ
                                       
                                       
                                          (
                                          k
                                          +
                                          1
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          Θ
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   T
                                                
                                             
                                             (
                                             
                                                
                                                   Θ
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             )
                                             J
                                             (
                                             
                                                
                                                   Θ
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             )
                                          
                                          ]
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          J
                                       
                                       
                                          T
                                       
                                    
                                    (
                                    
                                       
                                          Θ
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    )
                                    r
                                    (
                                    
                                       
                                          Θ
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    )
                                 
                              
                           where 
                              J
                              =
                              
                                 
                                    (
                                    
                                       ∂
                                       RE
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       Θ
                                       )
                                       /
                                       ∂
                                       
                                          
                                             Θ
                                          
                                          
                                             j
                                          
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    ≤
                                    i
                                    ≤
                                    n
                                    ,
                                    1
                                    ≤
                                    j
                                    ≤
                                    4
                                 
                              
                            is the n×n Jacobian matrix of parameters, J
                           
                              T
                            is the transpose matrix of J and 
                              r
                              (
                              
                                 
                                    Θ
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              )
                              =
                              
                                 
                                    (
                                    
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             Θ
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       )
                                       ,
                                       ⋯
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       
                                          
                                             Θ
                                          
                                          
                                             (
                                             k
                                             )
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 
                                    T
                                 
                              
                            with 
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    Θ
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              )
                              =
                              
                                 
                                    Y
                                 
                                 
                                    i
                                 
                              
                              −
                              RE
                              (
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              )
                           . A stopping criterion is defined, for example in nls the algorithm stops when 
                              |
                              
                                 
                                    Θ
                                 
                                 
                                    (
                                    k
                                    +
                                    1
                                    )
                                 
                              
                              −
                              
                                 
                                    Θ
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              |
                              <
                              
                                 
                                    10
                                 
                                 
                                    −
                                    s
                                 
                              
                           , 
                              s
                              ∈
                              N
                            (with, s=5 by default). The matrix J
                           
                              T
                            
                           J should not be singular, hence the choice of the initial parameter vector is crucial.

The MarqLev method uses the Marquardt Levenberg algorithm [13–15], which is a mixture of a gradient algorithm and the Gauss Newton algorithm. This algorithm belongs to the set of the quasi-Newton algorithm. It was developed to be less sensitive to the initial value while remaining as fast as the Gauss Newton algorithm. This method is very similar to the Gauss Newton method, and in fact Eq. (3) can be re-written as
                              
                                 (4)
                                 
                                    
                                       
                                          Θ
                                       
                                       
                                          (
                                          k
                                          +
                                          1
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          Θ
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   T
                                                
                                             
                                             (
                                             
                                                
                                                   Θ
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             )
                                             J
                                             (
                                             
                                                
                                                   Θ
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             )
                                             +
                                             λ
                                             I
                                          
                                          ]
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          J
                                       
                                       
                                          T
                                       
                                    
                                    (
                                    
                                       
                                          Θ
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    )
                                    r
                                    (
                                    
                                       
                                          Θ
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    )
                                 
                              
                           for the Marquardt Levenberg algorithm, where λ is the so-called dumping parameter and I is the identity matrix. Due to the dumping parameter, this method is more stable and robust than the Gauss Newton method because it estimates parameters even if the initial values are far from the real ones. By using the default MarqLev method in R we did not choose the dumping parameter because it is not a required value. Thus the main difficulty in using these algorithms is finding the initial vector of the parameters.

Because, with our model and the associated data, it is not easy to find automatic initial values of parameters close to the real ones, we used stochastic algorithms.

Stochastic algorithms based on M–H algorithms [16] use a meta-heuristic method to approximate a global estimation of a given function by minimizing the OLS. Because we wanted to be as general as possible, we used two implementations of these types of algorithms: GenSA, an R implementation of the generalized simulated annealing algorithm [17], and our algorithm, PGBO, which was successfully used in a previous study to optimize parameters in a complex model [8].

GenSA has been commented on and used by [18].

PGBO is an algorithm based on an evolutionary process with mutation and selection to optimize the parameters of a function. It uses Markov dynamics within a Markov chain with transitions driven by the probability of fixation of a mutant in a population as described in [19] and modified for haploid populations by Sella and Hirsh [10]. In PGBO, biological terms are used to describe each component. We define a mutant as a set of parameters (
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                           ) and its fitness as an evaluation of how close the parameters are to the optimal solution. We define the resident (
                              
                                 
                                    Θ
                                 
                                 
                                    R
                                 
                              
                           ) as the latest mutant selected by the algorithm. Based on the mutant fitness 
                              
                                 
                                    fit
                                 
                                 
                                    
                                       
                                          
                                             
                                                Θ
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                 
                              
                            relative to the resident fitness 
                              
                                 
                                    fit
                                 
                                 
                                    
                                       
                                          
                                             
                                                Θ
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          R
                                       
                                    
                                 
                              
                           , the mutant either immediately invaded the population and became the new resident or disappeared. The probability of invasion 
                              P
                              (
                              
                                 
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       R
                                    
                                 
                                 →
                                 
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       M
                                    
                                 
                              
                              )
                            depended on the evolving population size N and the difference between the fitness of the resident and the fitness of the invader: 
                              
                                 
                                    P
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   Θ
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             R
                                          
                                       
                                       →
                                       
                                          
                                             
                                                
                                                   Θ
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             M
                                          
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          1
                                          −
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  fit
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Θ
                                                                           
                                                                           
                                                                              ^
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        R
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  fit
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Θ
                                                                           
                                                                           
                                                                              ^
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        M
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          1
                                          −
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  fit
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Θ
                                                                           
                                                                           
                                                                              ^
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        R
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  fit
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Θ
                                                                           
                                                                           
                                                                              ^
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        M
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                                N
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    fit
                                 
                                 
                                    
                                       
                                          Θ
                                       
                                       
                                          ^
                                       
                                    
                                 
                              
                            is defined from the OLS as 
                              
                                 
                                    e
                                 
                                 
                                    −
                                    β
                                    OLS
                                    (
                                    
                                       
                                          Θ
                                       
                                       
                                          ^
                                       
                                    
                                    )
                                 
                              
                            and β is the specific drift parameter.

While simulated annealing uses its temperature parameter to avoid getting stuck too quickly in local minima and to maximize the exploration of the solution space, the strategy used in PGBO is to maintain a balance between the probability of escaping the local minima and the efficiency of converging to optima. To maintain this equilibrium, N was set to 40 and β was adjusted every 1000 iterations to keep 
                              
                                 
                                    fit
                                 
                                 
                                    
                                       
                                          Θ
                                       
                                       
                                          ^
                                       
                                    
                                 
                              
                            near 0.03 [8].The value of 
                              N
                              =
                              40
                            was chosen arbitrarily to facilitate fast exploration and reduce local optima issues. After 
                              5
                              ×
                              
                                 
                                    10
                                 
                                 
                                    5
                                 
                              
                            iterations the algorithm was stopped and the 
                              
                                 
                                    
                                       
                                          Θ
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                            with the highest 
                              
                                 
                                    fit
                                 
                                 
                                    
                                       
                                          Θ
                                       
                                       
                                          ^
                                       
                                    
                                 
                              
                            was kept as the best solution.

We simulated data from the TS model and a homoscedastic error as it was described in Eq. (2) with σ = 5. Two concentration designs were studied: n=10 and n=30; the concentrations were regularly spaced with a regular step in log10 scale between 0 and 105. We called a design with 10 concentrations “poor” (P) and a design with 30 concentrations “rich” (R). We defined k as the ratio between 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 2
                              
                           
                         and 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 1
                              
                           
                        . We called a ratio with k=100 “large” (L), and a ratio with k=10 “small” (S). We simulated 10 datasets for each design and each ratio, i.e., a total of 40 datasets.

To limit P to between 0 and 1 and to limit 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 2
                              
                           
                         to be greater than 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 1
                              
                           
                        , we did not estimate P and 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 2
                              
                           
                         but we estimated Q and α which are defined by
                           
                              
                                 Q
                                 =
                                 logit
                                 (
                                 P
                                 )
                                 
                                 where
                                 
                                 logit
                                 (
                                 P
                                 )
                                 =
                                 ln
                                 (
                                 
                                    
                                       
                                          P
                                       
                                       
                                          1
                                          −
                                          P
                                       
                                    
                                 
                                 )
                                 α
                                 =
                                 ln
                                 (
                                 k
                                 −
                                 1
                                 )
                                 ,
                                 
                                 where
                                 
                                 k
                                 =
                                 
                                    
                                       
                                          
                                             IC
                                          
                                          
                                             50
                                             ,
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             IC
                                          
                                          
                                             50
                                             ,
                                             1
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Finally we estimated 4 parameters: 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 1
                              
                           
                        , α, Q, and γ, so Θ is now defined by 
                           
                              
                                 Θ
                                 =
                                 (
                                 
                                    
                                       IC
                                    
                                    
                                       50
                                       ,
                                       1
                                    
                                 
                                 ,
                                 α
                                 ,
                                 Q
                                 ,
                                 γ
                                 )
                              
                           
                        
                     

To evaluate the sensitivity of the initial value of the algorithms, we simulated 100 vectors Θ of initial parameters randomized as
                           
                              
                                 
                                    
                                       IC
                                    
                                    
                                       50
                                       ,
                                       1
                                    
                                 
                                 ~
                                 U
                                 [
                                 1
                                 ;
                                 100
                                 ]
                                 α
                                 =
                                 ln
                                 (
                                 k
                                 −
                                 1
                                 )
                                 
                                 with
                                 
                                 k
                                 ~
                                 U
                                 [
                                 1
                                 +
                                 e
                                 ;
                                 100
                                 ]
                                 Q
                                 =
                                 logit
                                 (
                                 P
                                 )
                                 
                                 with
                                 
                                 P
                                 ~
                                 U
                                 [
                                 0.02
                                 ;
                                 0.98
                                 ]
                                 γ
                                 ~
                                 U
                                 [
                                 0.5
                                 ;
                                 10
                                 ]
                              
                           
                        where 
                           U
                           [
                           a
                           ,
                           b
                           ]
                         is the uniform distribution between a and b.

For each of the 40 simulated datasets, we estimated Θ using the 4 algorithms, with each initial value of the vector. Thus, each parameter of Θ was estimated 400 times.

To estimate parameters by means of M–H algorithms, we defined the maximum number of iterations (It), 
                           It
                           =
                           5
                           ×
                           
                              
                                 10
                              
                              
                                 5
                              
                           
                        , the temperature (T), 
                           T
                           =
                           
                              
                                 10
                              
                              
                                 3
                              
                           
                        , and the bounds for Θ: lower bounds were (1, 1, −4, 0.5) and upper bounds were (500, 7, 4, 10). The MarqLev algorithm was used as a “booster” as described in [9] and the Gauss–Newton algorithm was used by default in the nls function.

The estimated standard deviation for the model was computed as
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       n
                                       −
                                       4
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          RE
                                          (
                                          
                                             
                                                C
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                Θ
                                             
                                             
                                                ^
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        For the vector of each estimated parameter, the standard error (SE) was determined by taking the square roots of the diagonal elements of the inverse of the Fisher matrix (F) where 
                           F
                           =
                           
                              
                                 J
                              
                              
                                 T
                              
                           
                           (
                           
                              
                                 Θ
                              
                              
                                 ^
                              
                           
                           )
                           J
                           (
                           
                              
                                 Θ
                              
                              
                                 ^
                              
                           
                           )
                           /
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 2
                              
                           
                        .

To evaluate the estimation properties of the four algorithms, we used 3 criteria for each set of simulated data. For a ratio r, a design d, a dataset l, and an initial value of the vector v, we defined 
                           
                              
                                 
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       r
                                       ,
                                       d
                                       ,
                                       l
                                       ,
                                       v
                                    
                                    
                                       A
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       1
                                       ,
                                       r
                                       ,
                                       d
                                       ,
                                       l
                                       ,
                                       v
                                    
                                    
                                       A
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       2
                                       ,
                                       r
                                       ,
                                       d
                                       ,
                                       l
                                       ,
                                       v
                                    
                                    
                                       A
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       3
                                       ,
                                       r
                                       ,
                                       d
                                       ,
                                       l
                                       ,
                                       v
                                    
                                    
                                       A
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       4
                                       ,
                                       r
                                       ,
                                       d
                                       ,
                                       l
                                       ,
                                       v
                                    
                                    
                                       A
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    
                                       Θ
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 r
                                 ,
                                 d
                                 ,
                                 l
                                 ,
                                 v
                              
                           
                         is the parameter estimated of 
                           
                              
                                 Θ
                              
                              
                                 r
                                 ,
                                 d
                                 ,
                                 l
                                 ,
                                 v
                              
                           
                         by the algorithm A and 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 r
                                 ,
                                 d
                                 ,
                                 l
                                 ,
                                 v
                              
                              
                                 A
                              
                           
                         is the estimated standard deviation of the model.

The first criterion is the estimated standard deviation of the error model 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 r
                                 ,
                                 d
                                 ,
                                 l
                                 ,
                                 v
                              
                              
                                 A
                              
                           
                        . To simplify the notation, we write 
                           
                              
                                 σ
                              
                              
                                 ^
                              
                           
                         for the algorithm A, instead of 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 r
                                 ,
                                 d
                                 ,
                                 l
                                 ,
                                 v
                              
                              
                                 A
                              
                           
                        .

The second evaluation criterion is the relative median error of each component of 
                           Θ
                           =
                           (
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 4
                              
                           
                           )
                        , for each ratio, each design and each algorithm.

Hence, for a given ratio, a given design, and a given algorithm, because of the 100 initial values and the 10 datasets, there are 1000 estimates of each component p of Θ. Let 
                           
                              
                                 L
                              
                              
                                 p
                              
                           
                           =
                           (
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 p
                                 ,
                                 r
                                 ,
                                 d
                                 ,
                                 1
                                 ,
                                 1
                              
                              
                                 A
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 p
                                 ,
                                 r
                                 ,
                                 d
                                 ,
                                 1
                                 ,
                                 100
                              
                              
                                 A
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 p
                                 ,
                                 r
                                 ,
                                 d
                                 ,
                                 10
                                 ,
                                 1
                              
                              
                                 A
                              
                           
                           ,
                           …
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 p
                                 ,
                                 r
                                 ,
                                 d
                                 ,
                                 10
                                 ,
                                 100
                              
                              
                                 A
                              
                           
                           )
                        , we define 
                           
                              
                                 R
                              
                              
                                 med
                              
                           
                           (
                           
                              
                                 θ
                              
                              
                                 p
                                 ,
                                 r
                                 ,
                                 d
                              
                              
                                 A
                              
                           
                           )
                         as
                           
                              (6)
                              
                                 
                                    
                                       R
                                    
                                    
                                       med
                                    
                                 
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       p
                                       ,
                                       r
                                       ,
                                       d
                                    
                                    
                                       A
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       Median
                                       (
                                       
                                          
                                             L
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       −
                                       
                                          
                                             θ
                                          
                                          
                                             p
                                          
                                       
                                    
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                              
                           
                        where θ
                        
                           p
                         is the true value.

If an algorithm did not give an estimation of the parameters for a dataset we set the parameters to the initial value.

The third criterion is a score used to compare two algorithms (A
                        1 and A
                        2). For each 
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 p
                                 ,
                                 r
                                 ,
                                 d
                                 ,
                                 l
                                 ,
                                 v
                              
                              
                                 A
                              
                           
                        , (
                           p
                           =
                           1
                           
                              ,
                              ⋯
                           
                           4
                         and 
                           A
                           =
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                         or A
                        2) we calculate the distance between 
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 p
                                 ,
                                 r
                                 ,
                                 d
                                 ,
                                 l
                                 ,
                                 v
                              
                              
                                 A
                              
                           
                         and 
                           
                              
                                 θ
                              
                              
                                 p
                                 ,
                                 r
                                 ,
                                 d
                                 ,
                                 l
                                 ,
                                 v
                              
                           
                        .

Thus for a parameter p, the algorithm A
                        1 gains 1 point if 
                           |
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 p
                                 ,
                                 r
                                 ,
                                 d
                                 ,
                                 l
                                 ,
                                 v
                              
                              
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           −
                           
                              
                                 θ
                              
                              
                                 p
                                 ,
                                 r
                                 ,
                                 d
                                 ,
                                 l
                                 ,
                                 v
                              
                           
                           |
                         is lower than 
                           |
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 p
                                 ,
                                 r
                                 ,
                                 d
                                 ,
                                 l
                                 ,
                                 v
                              
                              
                                 
                                    
                                       A
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           −
                           
                              
                                 θ
                              
                              
                                 p
                                 ,
                                 r
                                 ,
                                 d
                                 ,
                                 l
                                 ,
                                 v
                              
                           
                           |
                         and the other has 0 point. By repeating this for the four parameters, an algorithm may have a maximum of 4 points.

Thus we define
                           
                              (7)
                              
                                 
                                    
                                       sc
                                    
                                    
                                       r
                                       ,
                                       d
                                       ,
                                       l
                                       ,
                                       v
                                    
                                    
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       =
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       |
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             p
                                             ,
                                             r
                                             ,
                                             d
                                             ,
                                             l
                                             ,
                                             v
                                          
                                          
                                             A
                                          
                                       
                                       −
                                       
                                          
                                             θ
                                          
                                          
                                             p
                                             ,
                                             r
                                             ,
                                             d
                                             ,
                                             l
                                             ,
                                             v
                                          
                                       
                                       |
                                       =
                                       
                                          
                                             min
                                          
                                          
                                             A
                                             ∈
                                             (
                                             
                                                
                                                   A
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       |
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             p
                                             ,
                                             r
                                             ,
                                             d
                                             ,
                                             l
                                             ,
                                             v
                                          
                                          
                                             A
                                          
                                       
                                       −
                                       
                                          
                                             θ
                                          
                                          
                                             p
                                             ,
                                             r
                                             ,
                                             d
                                             ,
                                             l
                                             ,
                                             v
                                          
                                       
                                       |
                                    
                                 
                                 
                                 such
                                 
                                 as
                                 
                                 
                                    
                                       sc
                                    
                                    
                                       r
                                       ,
                                       d
                                       ,
                                       l
                                       ,
                                       v
                                    
                                    
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 4
                                 −
                                 
                                    
                                       sc
                                    
                                    
                                       r
                                       ,
                                       d
                                       ,
                                       l
                                       ,
                                       v
                                    
                                    
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        The score for the ratio r, the design d and the algorithm A is
                           
                              (8)
                              
                                 
                                    
                                       S
                                    
                                    
                                       r
                                       ,
                                       d
                                    
                                    
                                       A
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       10
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       v
                                       =
                                       1
                                    
                                    
                                       100
                                    
                                 
                                 
                                    
                                       sc
                                    
                                    
                                       r
                                       ,
                                       d
                                       ,
                                       l
                                       ,
                                       v
                                    
                                    
                                       A
                                    
                                 
                              
                           
                        
                     

We also evaluated the algorithms using more realistic data, the in vitro data of Kaddouri et al. 
                        [12].These data are from 7 different mixtures of two P. falciparum strains: HB3 and FCM29 with different proportions (in percent): 0/100; 10/90; 30/70; 50/50; 70/30; 90/10; 100/0 such as HB3 is chloroquine resistant and FCM29 is sensitive to chloroquine. Each mixture was studied in duplicate.

These 14 experiments were tested using the microtest [12], which quantifies the parasite effect for a given drug concentration.

A blood sample is washed and cultured [20]. To test an antimalarial drug concentration, it is mixed with 
                           100
                           
                           μ
                           L
                         of washed blood with hypoxanthine which is a marker for monitoring the growth of the parasite and put in a hole of a 24 well plate. The plates are incubated for 42h at 37°C in a CO2 incubator and then frozen and kept at −20°C [20]. After thawing of the plates, the contents of each well are harvested on fiber filter disks. The fiber filter papers disk is washed and dried and mixed with 2mL of scintillation fluid, and incorporation of radioactivity (in counts per minute) into the parasite is measured with a liquid scintillation counter [20].

Ten chloroquine concentrations from 0 to 3200nM were used, each in duplicate or triplicate. We first normalized the data, as described in Section 2.1, and then estimated parameters with the four algorithms, taking the initial vector value as 
                           
                              
                                 Θ
                              
                              
                                 0
                              
                           
                           =
                           (
                           100
                           ,
                           1
                           ,
                           0
                           ,
                           1
                           )
                        .

Because these data are artificial, we know exactly the proportion of FCM29 in each mixture which is estimated by P in the TS model, and we also know the usual IC
                        50 of HB3 and of FCM29, 50 and 1100 respectively, with a ratio of 22.

From the CNRpalu 2011 database, we chose three patients infected by malaria to illustrate our approach. For each patient, one blood sample was divided into eight samples for testing [4] with eight different drugs. The process described in Section 2.6 was used.

Among the eight tested drugs, we focused on the atovaquone, and so have a dataset of concentrations versus effects for each patient.

Twenty two concentrations of atovaquone from 0 to 24000nmol/L were each tested once, except for the null concentration which was done 8 times. We therefore had 22 effects. As with the in vitro data we normalized the ex vivo data by the process described in Section 2.1, and then estimated parameters using the four algorithms. The vector of the initial values was 
                           
                              
                                 Θ
                              
                              
                                 0
                              
                           
                           =
                           (
                           100
                           ,
                           1
                           ,
                           0
                           ,
                           1
                           )
                        .

@&#RESULTS@&#

First we present boxplots of parameter estimates (Fig. 2
                           ). For the ratio L and the R design (Fig. 2a), boxplots were much less spread when the estimation was done using an M–H algorithm than done using an NT.

For the ratio S and the R design (Fig. 2b) or P (Fig. 2d), and for the ratio L and the P design (Fig. 2c), boxplots obtained with NT algorithms were widely spread, so we decided not to display them. By looking at Fig. 2a, b, which shows boxplots of estimated parameters for scenarios with a rich design, the parameters estimated using the two M–H algorithms were almost equivalent and consistent even if the ratio was S.Lastly, for a P design (Fig. 2c, d)the boxplots of all estimated parameters for M–H algorithms, for the ratio L (Fig. 2c), were more flattened than for S (Fig. 2d); except for 
                              
                                 
                                    IC
                                 
                                 
                                    50
                                    ,
                                    2
                                 
                              
                            where the interquartile boxplot was smaller with PGBO than with GenSA.

Second, we plotted boxplot of 
                              
                                 
                                    σ
                                 
                                 
                                    ^
                                 
                              
                            (the first criterion) for all datasets and all initial values of each ratio, each design, and each algorithm (Fig. 3
                           ). For the ratio L and the R design, Fig. 3a shows that the boxplots for NT algorithms are larger than those obtained using M–H algorithms. We decided not to show the 
                              
                                 
                                    σ
                                 
                                 
                                    ^
                                 
                              
                            boxplots obtained with NT for the other ratios and designs. For the R design, the boxplots of 
                              
                                 
                                    σ
                                 
                                 
                                    ^
                                 
                              
                            are equivalent for both M–H algorithms: medians of 
                              
                                 
                                    σ
                                 
                                 
                                    ^
                                 
                              
                            were slightly overestimated if the ratio was L and slightly underestimated if the scenario was S. Moreover, for a P design and ratio S the boxplot interquartiles of 
                              
                                 
                                    σ
                                 
                                 
                                    ^
                                 
                              
                            for those two scenarios were equivalent for the two algorithms.

In this section we compared estimation parameters and the adequacy of the model for the four algorithms used. Now we will compare the two M–H algorithms using our two other criteria.

We plotted the relative error median, R
                           
                              med
                           , for each ratio and design for each parameter (Fig. 4
                           ). All R
                           
                              med
                            in absolute values were less than 40%. For the R design (green), the relative median from both algorithms was equivalent and close to zero. The main distinction between these algorithms was estimations of 
                              
                                 
                                    IC
                                 
                                 
                                    50
                                    ,
                                    1
                                 
                              
                            and 
                              
                                 
                                    IC
                                 
                                 
                                    50
                                    ,
                                    2
                                 
                              
                            for the scenario with the P design (red). For a P design and ratio L, R
                           
                              med
                            of 
                              
                                 
                                    IC
                                 
                                 
                                    50
                                    ,
                                    1
                                 
                              
                            was smaller with PGBO than with GenSA whereas R
                           
                              med
                            of 
                              
                                 
                                    IC
                                 
                                 
                                    50
                                    ,
                                    2
                                 
                              
                            was higher with GenSA.For ratio S and a P design, R
                           
                              med
                            of 
                              
                                 
                                    IC
                                 
                                 
                                    50
                                    ,
                                    1
                                 
                              
                            and 
                              
                                 
                                    IC
                                 
                                 
                                    50
                                    ,
                                    2
                                 
                              
                            was smaller with PGBO.

The scores for comparison of the M–H algorithms are shown in Table 1
                           . For an R design, the scores of both algorithms were equivalent, whereas for a P design, the PGBO score was higher than the GenSA score. Moreover for ratio S, the PGBO score was twice the GenSA score.

TS model parameters estimations, using the in vitro data, were done for all 14 curves. We chose to present results only for 4 mixtures HB3/FCM29: 50/50 (Fig. 5
                        a), 70/30 (Fig. 5b), 90/10 (Fig. 5c), 100/0 (Fig. 5d). The parameters estimations for each of these mixtures are shown in Table 2
                        .

The first observation is that the Gauss Newton algorithm did not give any parameters estimates (see Fig. 5, all four purple curves are the same), so those results are not given in Table 2. The second remark is that MarqLev always gave parameter estimates, but in one case (90/10) standard errors could not be calculated, due to the singular Fisher matrix which is used to calculate SE parameters.

Thirdly, for both M–H algorithms, estimates of P, 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 1
                              
                           
                         and 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 2
                              
                           
                         were rather close to those expected and were equivalent for the first three mixtures. For the last mixture 100/0, the estimates of P, 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 1
                              
                           
                         and 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 2
                              
                           
                         by GenSA were 0.02, 48.2 nmol/L and 2592.9 nmol/L respectively, while PGBO gave estimates of P0.9, 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 1
                              
                           
                         at 15.1 nmol/L. and the 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 2
                              
                           
                         56 nmol/L. Both M–H algorithms yielded estimates for IC
                        50 close to 50, but for GenSA the IC
                        50 was the 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 2
                              
                           
                         and for PGBO the IC
                        50 was 
                           
                              
                                 IC
                              
                              
                                 50
                                 ,
                                 1
                              
                           
                        .

Data for the three patients are plotted in Fig. 6
                         and parameter estimates are given in Table 3
                        .


                        Fig. 6 shows that the Gauss Newton algorithm does not converge in parameter estimates, and in fact the curve does not follow the observed data, so we chose not to give the estimated parameters in Table 3 that would have been the initial parameters. In Table 3, the estimates obtained with the MarqLev algorithm differed from the initial value only for patient 1 and the M–H algorithms give the same estimates for the three patients.

The results show that patients 1 and 2 had at least 2 different strains with two different IC
                        50, whereas patient 3 have strains with the same IC
                        50. For patient 1, the proportion of the second strain was 0.4 .The 50% inhibitory concentration was 25.4nmol/L (3.8) for the first parasite and 5400nmol/L (1200) for the second, where numbers in parentheses are SE values.

For patient 2 the proportion of the second strain was 0.2. The 50% inhibitory concentration was 1.6nmol/L (0.3) for the first parasite and 1760nmol/L (1180) for the second.

For patient 3, the estimated proportion of the first parasite was 0.98 (0.03). The 50% inhibitory concentration for the first parasite was 2.15nmol/L (0.26).

@&#DISCUSSION@&#

To monitor antimalarial resistance, scientists need to estimate the sensitivity of Plasmodium to drugs in infected patients. Molecular detection of resistance mutations shows that a patient can be infected by more than one strain of parasite with different levels of resistance to antimalarial drugs [21]. In a blood sample, to analyze a mixture with at least two parasite strains with two levels of drug resistance, we have developed a pharmacodynamic model (TS model) inspired by [7]. This model can be used to estimate the proportion of each of two parasites with different levels of drug resistance and their IC
                     50.Our results show that NT algorithms are inefficient in estimating the four parameters of the TS model. Indeed most of our estimations with the Gauss–Newton and MarqLev algorithms failed. The main explanation is that NT algorithms are too sensitive to initial values because the Jacobian (or Hessian) matrix is singular. This shows that NT algorithms are inefficient without approximations or strategies to set initial values, and illustrates the necessity to find another way to estimate parameters.

We therefore developed a new M–H based algorithm to estimate the parameters of the TS model in order to monitor antimalarial drug resistance as accurately as possible.Initially our simulation study was intended to compare the performance of the two M–H algorithms versus the two NT algorithms. Subsequently, we compared the two M–H algorithms themselves. In the two scenarios for a rich design, results from both M–H algorithms were equivalent for the three comparison criteria that we chose: 
                        
                           
                              σ
                           
                           
                              ^
                           
                        
                     , R
                     
                        med
                      and the score. Whereas, for the scenario with a poor design, the results were quite different. More precisely, for the S scenario and P design, the GenSA estimation of σ has smaller interquartile range (Fig. 3c) than that obtained with PGBO. And PGBO parameter estimates (Fig. 2) are slightly closer to the expected values. This shows us that it is possible to have a small 
                        
                           
                              σ
                           
                           
                              ^
                           
                        
                      and poor parameters estimates. We should therefore be careful about assuming goodness of fit based only on the σ estimation. Table 1 shows that parameter estimates obtained with PGBO algorithm are closer to those expected when the design is poor (10 points), a result that should be underscored because generally the number of data is not large.

To test the TS model and the method of estimation using in vitro data, we used mixtures of two different strains of P. falciparum produced in vitro by Kaddouri et al. 
                     [12].These mixtures were made artificially with samples containing strains of P. falciparum (FCM29 and HB3) in different proportions. We therefore knew the exact proportion of each parasite in each mixture. Moreover as these data were obtained using two strains with well known IC
                     50, we know the real concentration of chloroquine which inhibits 50% of the parasite׳s activity. The expected IC
                     50 for HB3 is close to 50 and for FCM29 it should be close to 1100. As presented above, the results obtained with each algorithm were quite different: the two NT algorithms again proved inefficient whereas the other two were very effective. The parameters estimated with Gauss Newton algorithm are equal to the initial values, which means that the algorithm yielded no result. The estimations obtained using the MarqLev algorithm are quite good except for the 90/10 mixture: in the third line of Table 2c, the estimated 
                        
                           
                              IC
                           
                           
                              50
                              ,
                              1
                           
                        
                      is approximately equal to the estimated 
                        
                           
                              IC
                           
                           
                              50
                              ,
                              2
                           
                        
                     , so it fits an E
                     
                        max
                      instead of a TS model. This is confirmed by the estimated P which is equal to 1, whereas the expected value for P is 0.1. This corroborates our statement that NT algorithms are inefficient in estimating TS model parameters without a priori knowledge of the initial values, and it is better to use M–H algorithms with this kind of data.


                     
                        
                           
                              IC
                           
                           
                              50
                              ,
                              1
                           
                        
                      and 
                        
                           
                              IC
                           
                           
                              50
                              ,
                              2
                           
                        
                      values estimated using the two M–H algorithms are similar for the first three selected mixtures (Fig. 2), and estimates of P are very close to the expected values.The SEs of the parameters are equal for the PGBO and GenSA estimates except for the fourth case (fourth line in Table 2d). In this case, the TS model is used as an E
                     
                        max
                      model, but since the TS model has two more parameters than an E
                     
                        max
                     , there is overfitting of the data. This is seen with mixture d, with PGBO, where an artifactual value of IC
                     50 value appears. Indeed, in the fourth line in Table 2d, the PGBO estimation of 
                        
                           
                              IC
                           
                           
                              50
                              ,
                              2
                           
                        
                      is near to 50 and an estimation of 
                        
                           
                              IC
                           
                           
                              50
                              ,
                              1
                           
                        
                      is close to 15 but with an SE close to 3. In this case 
                        
                           
                              IC
                           
                           
                              50
                              ,
                              2
                           
                        
                      is then the true IC
                     50 value of the parasite. It may be difficult in these circumstances to detect artifactual values, and the SE of the IC
                     50 may help in this. PGBO with two more degrees of freedom gave a smaller σ estimate (2.48) than GenSA (3.37) but with a different estimate of IC
                     50 (56.06 versus 48.89). As we have already noted, this example shows that much care is needed when drawing conclusions based only on 
                        
                           
                              σ
                           
                           
                              ^
                           
                        
                      and when the estimated P is close to unity we should always model data with an E
                     
                        max
                      model.

Finally we applied the four methods to three sets of ex vivo data. We used the same initial parameters as used for the in vitro data. We could have chosen to use a series of random initial parameters, but we decided to simplify this study by avoiding policies for the choice of the initial values. Hence, with the two first ex vivo data samples, the M–H algorithm indicated that the proportion P is not equal to zero, which means there are at least two different strains with two different levels of resistance to atovaquone. Thus the treatment of the patient will not be the same as if there was only one strain. To be more precise, if the data analysis detects only one strain, the physician will administer drug for this strain, and the untouched second strain will remain. This shows the importance of using the TS model instead of the E
                     
                        max
                      model and of using M–H algorithms to estimate parameters of the TS model.

In future work, it will be interesting to update the ICEstimator online tools by implementing the TS model. However, as we have seen for the mixture d, it is not easy to interpret the parameter estimates of a TS model. We need to find a statistical test to discriminate an E
                     
                        max
                      model from a TS model. Because E
                     
                        max
                      and TS are nested models, an LRT test could be appropriate in most cases, but in other cases further help in interpreting the estimates is needed.

A plug-in will be soon implemented in the ICEstimator with the PGBO algorithm, to allowusers to establish whether a blood sample contains one or two strains of parasite and to determine their IC
                     50, even if the design of the data is poor.

None declared.

@&#REFERENCES@&#

