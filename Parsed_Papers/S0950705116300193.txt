@&#MAIN-TITLE@&#Improving short text classification by learning vector representations of both words and hidden topics

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We exploit the knowledge from a topic-consistent corpus for topic modeling and use the topics to enrich the corpus and the short texts.


                        
                        
                           
                           We learn the vector representations of both words and topics interactively on the enriched corpus.


                        
                        
                           
                           We use the vectors of the words and topics to represent the features of short texts for training and classification.


                        
                        
                           
                           Our method performs better than many baselines.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Short texts

Topic model

Data enrich

Word and topic vectors

@&#ABSTRACT@&#


               
               
                  This paper presents a general framework for short text classification by learning vector representations of both words and hidden topics together. We refer to a large-scale external data collection named ”corpus” which is topic consistent with short texts to be classified and then use the corpus to build topic model with Latent Dirichlet Allocation (LDA). For all the texts of the corpus and short texts, topics of words are viewed as new words and integrated into texts for data enriching. On the enriched corpus, we can learn vector representations of both words and topics. In this way, feature representations of short texts can be performed based on vectors of both words and topics for training and classification. On an open short text classification data set, learning vectors of both words and topics can significantly help reduce the classification error comparing with learning only word vectors. We also compared the proposed classification method with various baselines and experimental results justified the effectiveness of our word/topic vector representations.
               
            

@&#INTRODUCTION@&#

The popular use of the Internet demands the technology for short text classification [1–3] to deal with the daily/history big data such as search snippets, communication messages, product titles and so on. The bag-of-words (BOW) feature representation has achieved satisfactory results for the analysis of normal text/document based on machine learning methods [4,5] such as SVM, kNN, maximum entropy and so on. But the BOW feature has very little sense about semantics of words and so fails to achieve desired classification accuracy on short texts [6] which do not provide sufficient word co-occurrence or context shared information for effective similarity measure. Therefore, it is necessary to conduct in-depth study on feature representations for short texts.

To tackle the data sparseness problem of short texts, various methods have been proposed in literatures. Zelikovitz et al. [7] described a method for improving the classification of short text strings using a combination of labeled training data plus a secondary corpus of unlabeled but related longer documents. Hu et al. [8] enriched document representations with Wikipedia concepts and category information by mapping text documents to Wikipedia concepts, and further to Wikipedia categories. For query classification, Cao et al. [9] used neighboring queries and their corresponding clicked URLs (Web pages) in search sessions as the context information and incorporated the context information into the problem of query classification by using conditional random field (CRF) models. He et al. [10] employed a supervised-learning method to learn hint verbs, and considered URL and title information to classify snippets into three coarse categories. Dhillon et al. [11] studied a certain spherical k-means algorithm for clustering large sparse text data. Phan et al. [12] derived a set of hidden topics through topic model LDA from one large existing Web corpus for short text expansion. Vo et al. [13] also used LDA model for topic analysis but presented new methods for enhancing features by combining external texts modeled from various types of universal datasets.

Recently, word vector representations have been demonstrated to be able to produce outstanding results in some short text classification work such as sentiment analysis [14–17]. Word vectors can be learned via language modeling [18] or encoding word meaning (semantics) [14] with a probabilistic modeling approach. Based on word vectors, the text feature can be represented as the average of vector representations(mean representation vector) for all the words in the document [14] or learned in an unsupervised framework based on continuous distributed vector representations for the document [17]. The text feature can be used for many document analysis work such as clustering, classification and retrieval. Besides of document analysis, word vectors can be also used in NLP applications such as named entity recognition, word sense disambiguation, parsing, tagging and machine translation.

Following the trend of short text enriching and word vector learning, we attempt to learn vector representations of both words and topics to improve short text classification. During the learning of topic model, each word from texts on the corpus is assigned with a topic [12] and these word-topic assignments (each pair of the word and its assigned topic is denoted as a word-topic assignment) at the end of topic learning are used to enrich texts on the corpus (corpus with text enriching is denoted as enriched corpus). Then both topic and word vectors can be learned on the enriched corpus by modifying traditional methods. In short text classification, short texts are enriched in a similar way as the text enriching on corpus: by doing topic inference on short texts, each word of short texts is also assigned with a topic [12] and these word-topic assignments at the end of topic inference are used to enrich short texts (short texts enriched with topics are denoted as enriched short texts). Then, features of short texts can be represented based on vectors of not only words but also topics. By exploiting benefits of topic models for text enriching and the vector based feature representation, our method can achieve the superior performance over many exiting references such as topic feature, knowledge enriching, and traditional word vector learning. The idea of learning word vectors together with topics is similar to models of topical word embeddings (TWE) [42]. TWE models view topics as pseudo words to predict contextual words, while we view topics as new words in the text and learn vectors of words and topics more interactively. Enriching short texts with topics has been successfully proposed in a different way [12] with us. In our framework, enriching texts with topics can not only overcome the data sparseness problem of short texts but also make it possible to learn vector representations of words and topics together.

The rest of this paper is organized as follows: in Section 2, we give a brief review of related works on short text classification. Section 3 gives an overview of the proposed theoretical framework. Section 4 describes the topic modeling with LDA and text enriching with topics. Section 5 gives the algorithm on learning vector representations of both words and topics. Section 6 validate the proposed system over an open data set and Section 7 offers concluding remarks and future work.

@&#RELATED WORKS@&#

In this section, we briefly summarize related works on the basic text representation i.e. the BOW model, the content/feature extension for short texts, word-vector based text classification methods which are more related to ours.

The use of popular text representation known as BOW can trace back to Harris’s 1954 article on ”Distributional structure” [23] and widely used for text classification, clustering and retrieval. In the BOW representation, it is common to weigh terms by various schemes such as TF, TF-IDF [24] and its variants [25–27]. Using these word-based feature representations in the high dimensional space, a great many text classification techniques have been proposed such as Bayesian techniques, k-nearest neighbors (kNN), the so-called Rocchio algorithm from information retrieval, artificial neural networks (ANN), support vector machines (SVM), hidden Markov models (HMMs), and decision tree (DT).

Most existing short text classification methods focus on the content/feature extension to overcome the data sparseness. One way is to expand short texts by fetching external text/knowledge. Authors in [28–30] use the short text as the query and expand the content by results returned form the search engine. Some works [31–33] exploit Wikipedia as external knowledge to enrich the short text representation with additional features. Others in [34–36] add external concepts from the knowledge base, such as Wordnet and Probase, as additional features. For feature expansion, another way is to model the latent structure of topics to connect the short text through these topics. Phan et al. [12] first build a general framework to learn classifiers with short text features combined with hidden topics. Chen et al. [38] put forward a solution by exploiting topics of multi-granularity and present a systematic way to seamlessly integrate topics and produce discriminative features for short text classification. To overcome the severe data sparsity in the short text, Cheng and Yan et al. [39] propose the biterm topic model (BTM) to learn topics by directly modeling the generation of word co-occurrence patterns (biterms) on the whole corpus.

In the formulation of word vectors induced by language model [18–21], each word is represented by a vector which is concatenated or averaged with other word vectors in a context and the resulting vector is used to predict other words in the context. Based on word vector representations, the text level vector can be achieved in various ways. Maas et al. [14] simply used the average of all the word vectors in the document. Socher et al. [22] combined word vectors in an order given by a parse tree of a sentence, using matrix-vector operations. Le et al. [17] learned the document vector and word vectors together by concatenating the document vector with several word vectors in the document and predict the following word in the given context. All of these works learn only word vectors, while in this paper, we learn vectors of both words and topics. Compared with TWE models [42], our learning method considers more interactions between words and topics.

In Fig. 1
                     , we present the proposed framework consisting of three parts: topic learning, word/topic vector learning and short text classification. The topic model is estimated with LDA from the corpus, resulting in the topic model for new text inference and topic assignments of words (word-topic assignments) in each text. These word-topic assignments are used to enrich texts on the corpus for learning vectors of words and topics together. After word and topic vector learning, words and topics can be represented as vectors for text feature representation in short text classification. At the beginning of short text classification, topic inference is performed on short texts. During topic inference, each word in short texts is assigned with a topic and word-topic assignments at the end of topic inference are used to enrich each short text. Then, vectors of words and topics can be used to represent text features with more semantic information on enriched short texts. Text features are used for classifier training and new text classification. The whole framework consists of the following issues:

                        
                           (1)
                           Topic modeling on the corpus.

Enriching the corpus and short texts with hidden topics.

Learning vector representations of both words and topics on the enriched corpus.

Feature representations of enriched short texts based on word and topic vectors.

Building the classifier with text features.

The collection of topic-consistent (corpus_tc) corpus is shown in Fig. 2
                     . Querying by each topic-oriented keyword, pages of Wikipedia are crawled using the JWikiDocs tool [40]. After preprocessing raw transactions, resulting clean texts are stored as topic-consistent corpus. For topic modeling of the corpus, we use latent Dirichlet allocation (LDA) proposed in [12]. The LDA is more complete than probabilistic latent semantic analysis (pLSA) in such a way that it follows a full generation process for document collection [37]. Each word in both the corpus and short texts is assigned with a topic which is integrated into the text for data enriching. On the enriched corpus, each topic can be viewed as a new word and so we can learn word and topic vectors together. Proposed vector learning algorithms are modified from two popular methods i.e. continuous bag-of-words (CBOW) and the skip-gram [16]. With the CBOW model, we use the sequence of contextual words and topics to predict the current word or topic. With the skip-gram model, we use the current word or topic to predict contextual words and topics. Given word and topic vectors, the feature of each short text is represented based on the mean representation vector (average of word/topic vectors in the text) which is robust for text representation. We choose one of widely used machine learning algorithms i.e. linear SVM for classifier training and text classification.

LDA [12,37] is a generative probabilistic model for text corpora. Topics in LDA are drawn from a conjugate Dirichlet prior that remains the same for all the documents. For each document d in a corpus D, LDA assumes the following generative process:

                        
                           (1)
                           Sample document length Nd
                               from a Poisson distribution Poiss(ξ).

Pick a topic distribution 
                                 
                                    
                                       θ
                                       →
                                    
                                    d
                                 
                               from a Dirichlet distribution Dir(α).

For the n-th word in the Nd
                               words:
                                 
                                    (a)
                                    Choose a topic z
                                       
                                          d, n
                                        from multinomial distribution 
                                          
                                             M
                                             u
                                             l
                                             t
                                             (
                                             
                                                
                                                   θ
                                                   →
                                                
                                                d
                                             
                                             )
                                          
                                       .

Choose a word w
                                       
                                          d, n
                                        from multinomial distribution 
                                          
                                             M
                                             u
                                             l
                                             t
                                             (
                                             
                                                
                                                   φ
                                                   →
                                                
                                                
                                                   z
                                                   
                                                      d
                                                      ,
                                                      n
                                                   
                                                
                                             
                                             )
                                          
                                        with the topic-word distribution 
                                          
                                             
                                                φ
                                                →
                                             
                                             
                                                z
                                                
                                                   d
                                                   ,
                                                   n
                                                
                                             
                                          
                                        sampled from a Dirichlet distribution Dir(β).

Topic inference for new documents is also performed by Gibbs Sampling. Let 
                        
                           w
                           →
                        
                      and 
                        
                           z
                           →
                        
                      be all the words and their topic assignments on the corpus, and 
                        
                           
                              w
                              ′
                           
                           →
                        
                      and 
                        
                           
                              z
                              ′
                           
                           →
                        
                      be all the words and their topic assignments of the new data. The topic assignment for the word w′ depends on the current topics of all the other words in 
                        
                           
                              w
                              ′
                           
                           →
                        
                      and topics of all the words in 
                        
                           w
                           →
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          P
                                          (
                                          
                                             
                                                
                                                   z
                                                   ′
                                                
                                             
                                             
                                                w
                                                ′
                                             
                                          
                                          =
                                          k
                                          |
                                          
                                             
                                                
                                                   z
                                                   ′
                                                
                                                →
                                             
                                             
                                                −
                                                
                                                   w
                                                   ′
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                w
                                                ′
                                             
                                             →
                                          
                                          ,
                                          
                                             z
                                             →
                                          
                                          ,
                                          
                                             w
                                             →
                                          
                                          ,
                                          α
                                          ,
                                          β
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          =
                                          
                                             
                                                
                                                   n
                                                   
                                                      k
                                                      ,
                                                      
                                                         w
                                                         ′
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         n
                                                         ′
                                                      
                                                   
                                                   
                                                      k
                                                      ,
                                                      −
                                                      
                                                         w
                                                         ′
                                                      
                                                   
                                                
                                                +
                                                β
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      v
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         |
                                                      
                                                      
                                                         w
                                                         →
                                                      
                                                      
                                                         |
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            n
                                                            
                                                               k
                                                               ,
                                                               v
                                                            
                                                         
                                                         +
                                                         
                                                            n
                                                            ′
                                                         
                                                      
                                                      
                                                         k
                                                         ,
                                                         v
                                                      
                                                   
                                                   +
                                                   β
                                                   )
                                                
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         n
                                                         ′
                                                      
                                                   
                                                   
                                                      
                                                         d
                                                         ′
                                                      
                                                      ,
                                                      −
                                                      
                                                         w
                                                         ′
                                                      
                                                   
                                                   k
                                                
                                                +
                                                α
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   K
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            n
                                                            ′
                                                         
                                                      
                                                      
                                                         
                                                            d
                                                            ′
                                                         
                                                      
                                                      j
                                                   
                                                   +
                                                   α
                                                   )
                                                
                                                −
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 z
                                 ′
                              
                              →
                           
                           
                              −
                              
                                 w
                                 ′
                              
                           
                        
                      denotes the topic assignments of all the words on the new data except the current assignment, 
                        
                           n
                           
                              k
                              ,
                              
                                 w
                                 ′
                              
                           
                        
                      is the number of times topic k assigned to the word w′ on the corpus in topic learning, 
                        
                           
                              
                                 n
                                 ′
                              
                           
                           
                              k
                              ,
                              −
                              
                                 w
                                 ′
                              
                           
                        
                      is the number of times topic k assigned to the word w′ on the new data except the current assignment, 
                        
                           
                              ∑
                              
                                 v
                                 =
                                 1
                              
                              
                                 
                                    |
                                 
                                 
                                    w
                                    →
                                 
                                 
                                    |
                                 
                              
                           
                           
                              
                                 
                                    n
                                    ′
                                 
                              
                              
                                 k
                                 ,
                                 v
                              
                           
                           −
                           1
                        
                      is the total number of times topic k assigned to all the words on the new data except the current assignment, 
                        
                           
                              
                                 n
                                 ′
                              
                           
                           
                              
                                 d
                                 ′
                              
                              ,
                              −
                              
                                 w
                                 ′
                              
                           
                           k
                        
                      is the number of words in document d′ assigned to topic k except the current assignment, 
                        
                           
                              ∑
                              
                                 j
                                 =
                                 1
                              
                              K
                           
                           
                              
                                 
                                    n
                                    ′
                                 
                              
                              
                                 
                                    d
                                    ′
                                 
                              
                              j
                           
                           −
                           1
                        
                      is the total number of words in document d′ except the current word. At the end of Gibbs Sampling on short texts, we use word-topic assignments for further text enriching and classification.

After topic inference, each word in the short text is assigned a topic which is inserted into the text for data enriching. Fig. 3
                     (a) shows the example of the enriched short text where the “Short text_b” denotes texts from class “business” and “Short text_s” for class “sports”. Fig. 3(b) demonstrates visualization of shared topics among the same class snippets and fewer shared topics among different classes. We can see that most topics are shared in texts from the same class and almost not appear in the other classes. Some topics are shared in all the texts of the same class and almost not in the different classes such as Topic_3 and Topic_45. After text enriching, more words are shared by texts from the same class in a semantic way. Compared to the classification method in [42] which uses topical word vectors, the enriching of short texts can make text features less sparse and more discriminative for classification by integrating topics into texts, making the data more related for the same class and less for different classes.

In this section, we first give an overview of the two word vector learning methods i.e. CBOW and skip-gram. Then we show how to reply on CBOW and skip-gram for learning vectors of both words and topics. At the end, the parameter optimization process conducted by stochastic gradient descent are described in details.

The two well known frameworks for learning word vectors [16] are shown in Fig. 4
                        . In the CBOW framework, both history and future words are used to predict the current word denoted as wt
                        . Contexts are usually fixed-length and sampled from a sliding window sized as s over the text. There are three layers in the CBOW learning framework: input, projection and output. The projection layer is a vector (denoted as a bar with shading in Fig. 4), which is an average of input word vectors to predict the output word. Given a word sequence w
                        1, w
                        2, ..., wT
                        , the objective of the CBOW model is to maximize the average log probability

                           
                              (3)
                              
                                 
                                    
                                       1
                                       T
                                    
                                    
                                       ∑
                                       
                                          t
                                          =
                                          1
                                       
                                       T
                                    
                                    l
                                    o
                                    g
                                    P
                                    
                                       (
                                       
                                          w
                                          t
                                       
                                       |
                                       
                                          w
                                          
                                             t
                                             −
                                             s
                                          
                                       
                                       ,
                                       .
                                       .
                                       .
                                       ,
                                       
                                          w
                                          
                                             t
                                             −
                                             1
                                          
                                       
                                       ,
                                       
                                          w
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       ,
                                       .
                                       .
                                       .
                                       ,
                                       
                                          w
                                          
                                             t
                                             +
                                             s
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        and the prediction probability is computed by soft-max

                           
                              (4)
                              
                                 
                                    P
                                    
                                       (
                                       
                                          w
                                          t
                                       
                                       |
                                       
                                          w
                                          
                                             t
                                             −
                                             s
                                          
                                       
                                       ,
                                       .
                                       .
                                       .
                                       ,
                                       
                                          w
                                          
                                             t
                                             −
                                             1
                                          
                                       
                                       ,
                                       
                                          w
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       ,
                                       .
                                       .
                                       .
                                       ,
                                       
                                          w
                                          
                                             t
                                             +
                                             s
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          e
                                          
                                             y
                                             
                                                w
                                                t
                                             
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             W
                                          
                                          
                                             e
                                             
                                                y
                                                
                                                   w
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where W is the word vocabulary size, 
                           
                              y
                              
                                 w
                                 i
                              
                           
                         is the un-normalized score for output word wi
                         and computed as follows, with parameters b and U:

                           
                              (5)
                              
                                 
                                    y
                                    =
                                    b
                                    +
                                    U
                                    ·
                                    h
                                    (
                                    S
                                    e
                                    q
                                    )
                                    ,
                                 
                              
                           
                        where Seq is the sequence of input words and the function h is constructed by an average of the input word vectors. For fast learning, the techniques of hierarchical soft-max and negative sampling are used.

In the skip-gram framework, the current word wt
                         is used to predict both history and future words. There are also three layers in the skip-gram framework: input, projection and output. The projection layer is the vector of the input word. The objective is to maximize the average log probability

                           
                              (6)
                              
                                 
                                    
                                       1
                                       T
                                    
                                    
                                       ∑
                                       
                                          t
                                          =
                                          1
                                       
                                       T
                                    
                                    
                                       ∑
                                       
                                          −
                                          s
                                          ≤
                                          c
                                          ≤
                                          s
                                          ,
                                          c
                                          ≠
                                          0
                                       
                                    
                                    l
                                    o
                                    g
                                    P
                                    
                                       (
                                       
                                          w
                                          
                                             t
                                             +
                                             c
                                          
                                       
                                       |
                                       
                                          w
                                          t
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        The probability 
                           
                              P
                              (
                              
                                 w
                                 
                                    t
                                    +
                                    c
                                 
                              
                              |
                              
                                 w
                                 t
                              
                              )
                           
                         is also formulated using a soft-max function

                           
                              (7)
                              
                                 
                                    P
                                    
                                       (
                                       
                                          w
                                          
                                             t
                                             +
                                             c
                                          
                                       
                                       |
                                       
                                          w
                                          t
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          e
                                          
                                             
                                                V
                                                
                                                   w
                                                   
                                                      t
                                                      +
                                                      c
                                                   
                                                
                                             
                                             ·
                                             
                                                V
                                                
                                                   w
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             W
                                          
                                          
                                             e
                                             
                                                
                                                   V
                                                   
                                                      w
                                                      j
                                                   
                                                
                                                ·
                                                
                                                   V
                                                   
                                                      w
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where Vw
                         is the word vector of word w. The learning of skip-gram is also performed with hierarchical soft-max and negative sampling.

After LDA based topic inference, each word in the text is assigned with a topic which is integrated following the word for data enriching. By data enriching, topics can be viewed as new words. Then traditional word vector learning algorithms can be modified with different objective functions to learn vectors of both words and topics together. Fig. 5
                         shows examples of the enriched text and word/topic vector learning.

Given a word/topic sequence w
                        1, p
                        1, w
                        2, p
                        2, ..., wT, pT
                        , the objective under CBOW model is defined to maximize the following average log probability:

                           
                              (8)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                1
                                                T
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                T
                                             
                                             
                                                {
                                                l
                                                o
                                                g
                                                P
                                             
                                             
                                                (
                                                
                                                   w
                                                   t
                                                
                                                |
                                                
                                                   w
                                                   
                                                      t
                                                      
                                                      −
                                                      
                                                      s
                                                   
                                                
                                                ,
                                                
                                                   p
                                                   
                                                      t
                                                      −
                                                      s
                                                   
                                                
                                                ,
                                                .
                                                .
                                                .
                                                ,
                                                
                                                   w
                                                   
                                                      t
                                                      −
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   p
                                                   
                                                      t
                                                      
                                                      −
                                                      
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   p
                                                   t
                                                
                                                ,
                                                
                                                   w
                                                   
                                                      t
                                                      
                                                      +
                                                      
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   p
                                                   
                                                      t
                                                      
                                                      +
                                                      
                                                      1
                                                   
                                                
                                                ,
                                                .
                                                .
                                                .
                                                ,
                                                
                                                   w
                                                   
                                                      t
                                                      +
                                                      s
                                                   
                                                
                                                ,
                                                
                                                   p
                                                   
                                                      t
                                                      +
                                                      s
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             +
                                             l
                                             o
                                             g
                                             P
                                             (
                                             
                                                p
                                                t
                                             
                                             |
                                             
                                                w
                                                
                                                   t
                                                   −
                                                   s
                                                
                                             
                                             ,
                                             
                                                p
                                                
                                                   t
                                                   −
                                                   s
                                                
                                             
                                             ,
                                             .
                                             .
                                             .
                                             ,
                                             
                                                w
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             
                                                p
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             
                                                w
                                                t
                                             
                                             ,
                                             
                                                w
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                p
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             .
                                             .
                                             .
                                             ,
                                             
                                                w
                                                
                                                   t
                                                   +
                                                   s
                                                
                                             
                                             ,
                                             
                                                p
                                                
                                                   t
                                                   +
                                                   s
                                                
                                             
                                             )
                                             }
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             =
                                             
                                                1
                                                T
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                T
                                             
                                             
                                                {
                                                l
                                                o
                                                g
                                                P
                                                
                                                   (
                                                   
                                                      w
                                                      t
                                                   
                                                   |
                                                   
                                                      S
                                                      
                                                         w
                                                         t
                                                      
                                                   
                                                   )
                                                
                                                +
                                                l
                                                o
                                                g
                                                P
                                                
                                                   (
                                                   
                                                      p
                                                      t
                                                   
                                                   |
                                                   
                                                      S
                                                      
                                                         p
                                                         t
                                                      
                                                   
                                                   )
                                                
                                                }
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             =
                                             
                                                1
                                                T
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                T
                                             
                                             
                                                ∑
                                                
                                                   
                                                      x
                                                      t
                                                   
                                                   ∈
                                                   
                                                      {
                                                      
                                                         w
                                                         t
                                                      
                                                      ,
                                                      
                                                         p
                                                         t
                                                      
                                                      }
                                                   
                                                
                                             
                                             l
                                             o
                                             g
                                             P
                                             
                                                (
                                                
                                                   x
                                                   t
                                                
                                                |
                                                
                                                   S
                                                   
                                                      x
                                                      t
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 S
                                 
                                    w
                                    t
                                 
                              
                              ,
                           
                        
                        
                           
                              S
                              
                                 p
                                 t
                              
                           
                         and 
                           
                              S
                              
                                 x
                                 t
                              
                           
                         respectively denote the input word/topic sequence to predict wt, pt
                         and xt
                        . Compared with Eq. (3) using context words to predict the current word, the proposed objective also use topics of the current and context words. Besides, topics are viewed as new words and so each topic is also predicted in a similar way.

The prediction probability in Eq. (8) is computed by soft-max

                           
                              (9)
                              
                                 
                                    P
                                    
                                       (
                                       
                                          x
                                          t
                                       
                                       |
                                       
                                          S
                                          
                                             x
                                             t
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          e
                                          
                                             Y
                                             (
                                             
                                                x
                                                t
                                             
                                             ,
                                             
                                                S
                                                
                                                   x
                                                   t
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             W
                                          
                                          
                                             e
                                             
                                                Y
                                                (
                                                
                                                   w
                                                   i
                                                
                                                ,
                                                
                                                   S
                                                   
                                                      x
                                                      t
                                                   
                                                
                                                )
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          
                                             e
                                             
                                                Y
                                                (
                                                
                                                   p
                                                   k
                                                
                                                ,
                                                
                                                   S
                                                   
                                                      x
                                                      t
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where K is the total topic number, 
                           
                              Y
                              (
                              
                                 x
                                 o
                              
                              ,
                              
                                 S
                                 
                                    x
                                    t
                                 
                              
                              )
                           
                         is the un-normalized score for output word/topic xo
                         with 
                           
                              S
                              
                                 x
                                 t
                              
                           
                         as input computed as follows, with parameters b and U:

                           
                              (10)
                              
                                 
                                    Y
                                    
                                       (
                                       
                                          x
                                          o
                                       
                                       ,
                                       
                                          S
                                          
                                             x
                                             t
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       b
                                       
                                          x
                                          o
                                       
                                    
                                    +
                                    
                                       U
                                       
                                          x
                                          o
                                       
                                    
                                    ·
                                    h
                                    
                                       (
                                       
                                          S
                                          
                                             x
                                             t
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        where the function h is constructed by an average of input word/topic vectors.

For learning vectors of both words and topics, the objective under skip-gram model is defined to maximize the following average log probability:

                           
                              (11)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                1
                                                T
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                T
                                             
                                             
                                                {
                                                
                                                   ∑
                                                   
                                                      −
                                                      s
                                                      ≤
                                                      c
                                                      ≤
                                                      s
                                                      ,
                                                      c
                                                      ≠
                                                      0
                                                   
                                                
                                                
                                                   (
                                                   l
                                                   o
                                                   g
                                                   P
                                                   
                                                      (
                                                      
                                                         w
                                                         
                                                            t
                                                            +
                                                            c
                                                         
                                                      
                                                      |
                                                      
                                                         w
                                                         t
                                                      
                                                      )
                                                   
                                                   +
                                                   l
                                                   o
                                                   g
                                                   P
                                                   
                                                      (
                                                      
                                                         p
                                                         
                                                            t
                                                            +
                                                            c
                                                         
                                                      
                                                      |
                                                      
                                                         w
                                                         t
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                +
                                                l
                                                o
                                                g
                                                P
                                                
                                                   (
                                                   
                                                      p
                                                      t
                                                   
                                                   |
                                                   
                                                      w
                                                      t
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             +
                                             
                                                
                                                   ∑
                                                   
                                                      −
                                                      s
                                                      ≤
                                                      c
                                                      ≤
                                                      s
                                                      ,
                                                      c
                                                      ≠
                                                      0
                                                   
                                                
                                                
                                                   (
                                                   l
                                                   o
                                                   g
                                                   P
                                                   
                                                      (
                                                      
                                                         w
                                                         
                                                            t
                                                            +
                                                            c
                                                         
                                                      
                                                      |
                                                      
                                                         p
                                                         t
                                                      
                                                      )
                                                   
                                                   +
                                                   l
                                                   o
                                                   g
                                                   P
                                                   
                                                      (
                                                      
                                                         p
                                                         
                                                            t
                                                            +
                                                            c
                                                         
                                                      
                                                      |
                                                      
                                                         p
                                                         t
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                +
                                                l
                                                o
                                                g
                                                P
                                                
                                                   (
                                                   
                                                      w
                                                      t
                                                   
                                                   |
                                                   
                                                      p
                                                      t
                                                   
                                                   )
                                                
                                                }
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             =
                                             
                                                1
                                                T
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                T
                                             
                                             
                                                ∑
                                                
                                                   −
                                                   s
                                                   ≤
                                                   c
                                                   ≤
                                                   s
                                                
                                             
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               
                                                                  i
                                                                  n
                                                               
                                                            
                                                            ∈
                                                            
                                                               {
                                                               
                                                                  x
                                                                  t
                                                               
                                                               ,
                                                               
                                                                  p
                                                                  t
                                                               
                                                               }
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               o
                                                            
                                                            ∈
                                                            
                                                               {
                                                               
                                                                  w
                                                                  
                                                                     t
                                                                     +
                                                                     c
                                                                  
                                                               
                                                               ,
                                                               
                                                                  p
                                                                  
                                                                     t
                                                                     +
                                                                     c
                                                                  
                                                               
                                                               }
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               
                                                                  i
                                                                  n
                                                               
                                                            
                                                            ≠
                                                            
                                                               x
                                                               o
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             l
                                             o
                                             g
                                             P
                                             
                                                (
                                                
                                                   x
                                                   o
                                                
                                                |
                                                
                                                   x
                                                   
                                                      i
                                                      n
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where xin
                         and xo
                         are input and output words or topics. Compared with Eq. (6) using the current word to predict context words, the proposed objective also predicts topics of the current and context words. Besides, topics are viewed as new words and so each topic is also used to predict context words and topics together with the current word.

The probability in Eq. (11) is also formulated using the soft-max function:

                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             P
                                             
                                                (
                                                
                                                   x
                                                   o
                                                
                                                |
                                                
                                                   x
                                                   in
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      
                                                         V
                                                         
                                                            
                                                               x
                                                               o
                                                            
                                                         
                                                         ′
                                                      
                                                      ·
                                                      
                                                         V
                                                         
                                                            x
                                                            in
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      W
                                                   
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         
                                                            V
                                                            
                                                               
                                                                  w
                                                                  i
                                                               
                                                            
                                                            ′
                                                         
                                                         ·
                                                         
                                                            V
                                                            
                                                               x
                                                               in
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      K
                                                   
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         
                                                            V
                                                            
                                                               
                                                                  p
                                                                  j
                                                               
                                                            
                                                            ′
                                                         
                                                         ·
                                                         
                                                            V
                                                            
                                                               x
                                                               in
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The parameter optimization process is conducted by stochastic gradient descent which can be defined as

                           
                              (13)
                              
                                 
                                    θ
                                    ←
                                    θ
                                    +
                                    α
                                    
                                       
                                          ∂
                                          L
                                       
                                       
                                          ∂
                                          θ
                                       
                                    
                                    ,
                                 
                              
                           
                        where L is the objective function to maximize and θ is the set of parameters. In the proposed CBOW model, at current word wt
                         and topic pt
                        , parameters θcbow
                         can be updated by stochastic gradient descent as follows:

                           
                              (14)
                              
                                 
                                    
                                       θ
                                       
                                          c
                                          b
                                          o
                                          w
                                       
                                    
                                    ←
                                    
                                       θ
                                       
                                          c
                                          b
                                          o
                                          w
                                       
                                    
                                    +
                                    α
                                    
                                       
                                          ∂
                                          (
                                          
                                             L
                                             t
                                             
                                                c
                                                b
                                                o
                                                w
                                             
                                          
                                          )
                                       
                                       
                                          ∂
                                          
                                             θ
                                             
                                                c
                                                b
                                                o
                                                w
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 L
                                 t
                                 
                                    c
                                    b
                                    o
                                    w
                                 
                              
                              =
                              
                                 ∑
                                 
                                    
                                       x
                                       t
                                    
                                    ∈
                                    
                                       {
                                       
                                          w
                                          t
                                       
                                       ,
                                       
                                          p
                                          t
                                       
                                       }
                                    
                                 
                              
                              l
                              o
                              g
                              P
                              
                                 (
                                 
                                    x
                                    t
                                 
                                 |
                                 
                                    S
                                    
                                       x
                                       t
                                    
                                 
                                 )
                              
                           
                        . In the proposed skip-gram model, at current word wt
                         and topic pt
                        , parameters θskg
                         can be updated by stochastic gradient descent as follows:

                           
                              (15)
                              
                                 
                                    
                                       θ
                                       
                                          s
                                          k
                                          g
                                       
                                    
                                    ←
                                    
                                       θ
                                       
                                          s
                                          k
                                          g
                                       
                                    
                                    +
                                    α
                                    
                                       
                                          ∂
                                          (
                                          
                                             L
                                             t
                                             
                                                s
                                                k
                                                g
                                             
                                          
                                          )
                                       
                                       
                                          ∂
                                          
                                             θ
                                             
                                                s
                                                k
                                                g
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where

                           
                              (16)
                              
                                 
                                    
                                       L
                                       t
                                       
                                          s
                                          k
                                          g
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          −
                                          s
                                          ≤
                                          c
                                          ≤
                                          s
                                       
                                    
                                    
                                       ∑
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      
                                                         i
                                                         n
                                                      
                                                   
                                                   ∈
                                                   
                                                      {
                                                      
                                                         x
                                                         t
                                                      
                                                      ,
                                                      
                                                         p
                                                         t
                                                      
                                                      }
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                      o
                                                   
                                                   ∈
                                                   
                                                      {
                                                      
                                                         w
                                                         
                                                            t
                                                            +
                                                            c
                                                         
                                                      
                                                      ,
                                                      
                                                         p
                                                         
                                                            t
                                                            +
                                                            c
                                                         
                                                      
                                                      }
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                      
                                                         i
                                                         n
                                                      
                                                   
                                                   ≠
                                                   
                                                      x
                                                      o
                                                   
                                                
                                             
                                          
                                       
                                    
                                    l
                                    o
                                    g
                                    P
                                    
                                       (
                                       
                                          x
                                          o
                                       
                                       |
                                       
                                          x
                                          
                                             i
                                             n
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        From Eqs. (9) and (12), it is easy to see that derivative computation of model parameters in Eqs. (14) and (15) is proportional to the sum of topic and vocabulary size, which is often very large. To solve the computational complexity of derivatives, we use hierarchical softmax and negative sampling as efficient approximation of the full softmax for fast learning.

In this paper, the hierarchical softmax uses a binary Huffman tree representation of the output layer with the W words and K topics as its leaves and explicitly represents the relative probabilities of the child nodes for each node. On the binary tree, each word or topic x can be reached by an appropriate path from the root of the tree. Let n(x, i) be the i-th node on the path with length L(x) from the root to x. Then n(x, 1) is the root and n(x, L(x)) is x. In addition, let rch(n) is the right child node of node n.

For the CBOW model, the new prediction probabilities in Eq. (8) can be computed by hierarchical softmax as follows:

                              
                                 (17)
                                 
                                    
                                       
                                          
                                             
                                                P
                                                (
                                                
                                                   x
                                                   t
                                                
                                                |
                                                
                                                   S
                                                   
                                                      x
                                                      t
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∏
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      L
                                                      (
                                                      
                                                         x
                                                         t
                                                      
                                                      )
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   σ
                                                   (
                                                
                                                
                                                   [
                                                   
                                                      [
                                                      n
                                                      
                                                         (
                                                         
                                                            x
                                                            t
                                                         
                                                         ,
                                                         i
                                                         +
                                                         1
                                                         )
                                                      
                                                      =
                                                      r
                                                      c
                                                      h
                                                      
                                                         (
                                                         n
                                                         
                                                            (
                                                            
                                                               x
                                                               t
                                                            
                                                            ,
                                                            i
                                                            )
                                                         
                                                         )
                                                      
                                                      ]
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                ×
                                                (
                                                
                                                   U
                                                   
                                                      n
                                                      (
                                                      
                                                         x
                                                         t
                                                      
                                                      ,
                                                      i
                                                      )
                                                   
                                                
                                                h
                                                
                                                   (
                                                   
                                                      S
                                                      
                                                         x
                                                         t
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   b
                                                   
                                                      n
                                                      (
                                                      
                                                         x
                                                         t
                                                      
                                                      ,
                                                      i
                                                      )
                                                   
                                                
                                                )
                                                )
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 σ
                                 
                                    (
                                    χ
                                    )
                                 
                                 =
                                 
                                    1
                                    
                                       1
                                       +
                                       e
                                       x
                                       p
                                       (
                                       −
                                       χ
                                       )
                                    
                                 
                                 ,
                              
                            and [[χ]] is 1 if χ is true or -1. It is easy to see that the cost of prediction probabilities and their derivatives is proportional to 
                              
                                 L
                                 
                                    (
                                    
                                       w
                                       t
                                    
                                    )
                                 
                                 +
                                 L
                                 
                                    (
                                    
                                       p
                                       t
                                    
                                    )
                                 
                              
                            which is not greater than 
                              
                                 
                                    l
                                    o
                                    g
                                 
                                 (
                                 W
                                 +
                                 K
                                 )
                              
                           . Also, unlike the standard softmax formulation of the CBOW model where the hidden nodes connect to the words/topics, the hierarchical softmax formulation has connections from the hidden nodes to the inner nodes on the binary tree with parameters 
                              
                                 
                                    θ
                                    
                                       c
                                       b
                                       o
                                       w
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       U
                                       n
                                    
                                    ,
                                    
                                       b
                                       n
                                    
                                    ,
                                    
                                       V
                                       x
                                    
                                    }
                                 
                              
                           . Then derivatives in Eq. (14) can be computed as

                              
                                 (18)
                                 
                                    
                                       
                                          
                                             ∂
                                             (
                                             
                                                L
                                                t
                                                
                                                   c
                                                   b
                                                   o
                                                   w
                                                
                                             
                                             )
                                          
                                          
                                             ∂
                                             
                                                U
                                                
                                                   n
                                                   (
                                                   
                                                      x
                                                      t
                                                   
                                                   ,
                                                   i
                                                   )
                                                
                                             
                                          
                                       
                                       =
                                       
                                          (
                                          1
                                          −
                                          
                                             f
                                             
                                                n
                                                (
                                                
                                                   x
                                                   t
                                                
                                                ,
                                                i
                                                )
                                             
                                          
                                          )
                                       
                                       
                                          [
                                          
                                             [
                                             n
                                             
                                                (
                                                
                                                   x
                                                   t
                                                
                                                ,
                                                i
                                                +
                                                1
                                                )
                                             
                                             =
                                             r
                                             c
                                             h
                                             
                                                (
                                                n
                                                
                                                   (
                                                   
                                                      x
                                                      t
                                                   
                                                   ,
                                                   i
                                                   )
                                                
                                                )
                                             
                                             ]
                                          
                                          ]
                                       
                                       ·
                                       h
                                       
                                          (
                                          
                                             S
                                             
                                                x
                                                t
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 (19)
                                 
                                    
                                       
                                          
                                             ∂
                                             (
                                             
                                                L
                                                t
                                                
                                                   c
                                                   b
                                                   o
                                                   w
                                                
                                             
                                             )
                                          
                                          
                                             ∂
                                             
                                                b
                                                
                                                   n
                                                   (
                                                   
                                                      x
                                                      t
                                                   
                                                   ,
                                                   i
                                                   )
                                                
                                             
                                          
                                       
                                       =
                                       
                                          (
                                          1
                                          −
                                          
                                             f
                                             
                                                n
                                                (
                                                
                                                   x
                                                   t
                                                
                                                ,
                                                i
                                                )
                                             
                                          
                                          )
                                       
                                       
                                          [
                                          
                                             [
                                             n
                                             
                                                (
                                                
                                                   x
                                                   t
                                                
                                                ,
                                                i
                                                +
                                                1
                                                )
                                             
                                             =
                                             r
                                             c
                                             h
                                             
                                                (
                                                n
                                                
                                                   (
                                                   
                                                      x
                                                      t
                                                   
                                                   ,
                                                   i
                                                   )
                                                
                                                )
                                             
                                             ]
                                          
                                          ]
                                       
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 (20)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   (
                                                   
                                                      L
                                                      t
                                                      
                                                         c
                                                         b
                                                         o
                                                         w
                                                      
                                                   
                                                   )
                                                
                                                
                                                   ∂
                                                   
                                                      V
                                                      
                                                         x
                                                         
                                                            i
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                                  t
                                                               
                                                               ∈
                                                               
                                                                  {
                                                                  
                                                                     w
                                                                     t
                                                                  
                                                                  ,
                                                                  
                                                                     p
                                                                     t
                                                                  
                                                                  }
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                                  t
                                                               
                                                               ≠
                                                               
                                                                  x
                                                                  
                                                                     i
                                                                     n
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   {
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         L
                                                         (
                                                         
                                                            x
                                                            t
                                                         
                                                         )
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         f
                                                         
                                                            n
                                                            (
                                                            
                                                               x
                                                               t
                                                            
                                                            ,
                                                            i
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                ×
                                                
                                                   [
                                                   
                                                      [
                                                      n
                                                      
                                                         (
                                                         
                                                            x
                                                            t
                                                         
                                                         ,
                                                         i
                                                         +
                                                         1
                                                         )
                                                      
                                                      =
                                                      r
                                                      c
                                                      h
                                                      
                                                         (
                                                         n
                                                         
                                                            (
                                                            
                                                               x
                                                               t
                                                            
                                                            ,
                                                            i
                                                            )
                                                         
                                                         )
                                                      
                                                      ]
                                                   
                                                   ]
                                                
                                                
                                                   U
                                                   
                                                      n
                                                      (
                                                      
                                                         x
                                                         t
                                                      
                                                      ,
                                                      i
                                                      )
                                                   
                                                
                                                }
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where xin
                            is any input word or topic, and 
                              
                                 
                                    f
                                    
                                       n
                                       (
                                       
                                          x
                                          t
                                       
                                       ,
                                       i
                                       )
                                    
                                 
                                 =
                                 σ
                                 
                                    (
                                    
                                       [
                                       
                                          [
                                          n
                                          
                                             (
                                             
                                                x
                                                t
                                             
                                             ,
                                             i
                                             +
                                             1
                                             )
                                          
                                          =
                                          r
                                          c
                                          h
                                          
                                             (
                                             n
                                             
                                                (
                                                
                                                   x
                                                   t
                                                
                                                ,
                                                i
                                                )
                                             
                                             )
                                          
                                          ]
                                       
                                       ]
                                    
                                    
                                       (
                                       
                                          U
                                          
                                             n
                                             (
                                             
                                                x
                                                t
                                             
                                             ,
                                             i
                                             )
                                          
                                       
                                       h
                                       
                                          (
                                          
                                             S
                                             
                                                x
                                                t
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          b
                                          
                                             n
                                             (
                                             
                                                x
                                                t
                                             
                                             ,
                                             i
                                             )
                                          
                                       
                                       )
                                    
                                    )
                                 
                              
                           .

For the skip-gram model, the new prediction probabilities in Eq. (11) can be computed by hierarchical softmax as follows:

                              
                                 (21)
                                 
                                    
                                       P
                                       
                                          (
                                          
                                             x
                                             o
                                          
                                          |
                                          
                                             x
                                             
                                                i
                                                n
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          ∏
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             L
                                             (
                                             
                                                x
                                                o
                                             
                                             )
                                             −
                                             1
                                          
                                       
                                       σ
                                       
                                          (
                                          
                                             [
                                             
                                                [
                                                n
                                                
                                                   (
                                                   
                                                      x
                                                      o
                                                   
                                                   ,
                                                   i
                                                   +
                                                   1
                                                   )
                                                
                                                =
                                                r
                                                c
                                                h
                                                
                                                   (
                                                   n
                                                   
                                                      (
                                                      
                                                         x
                                                         o
                                                      
                                                      ,
                                                      i
                                                      )
                                                   
                                                   )
                                                
                                                ]
                                             
                                             ]
                                          
                                          
                                             (
                                             
                                                V
                                                
                                                   n
                                                   (
                                                   
                                                      x
                                                      o
                                                   
                                                   ,
                                                   i
                                                   )
                                                
                                                
                                                   
                                                   ′
                                                
                                             
                                             ·
                                             
                                                V
                                                
                                                   x
                                                   
                                                      i
                                                      n
                                                   
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       ,
                                    
                                 
                              
                           it can be seen that the cost of prediction probabilities and their derivatives is proportional to 
                              
                                 L
                                 
                                    (
                                    
                                       w
                                       t
                                    
                                    )
                                 
                                 +
                                 L
                                 
                                    (
                                    
                                       p
                                       t
                                    
                                    )
                                 
                              
                            which is not greater than 
                              
                                 
                                    l
                                    o
                                    g
                                 
                                 (
                                 W
                                 +
                                 K
                                 )
                              
                           . Besides, unlike the standard softmax formulation of the skip-gram which assigns word representations Vx
                            to each word or topic x, the hierarchical softmax formulation also has one representation Vn
                            for each inner node n of the binary tree resulting in 
                              
                                 
                                    θ
                                    
                                       s
                                       k
                                       g
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       V
                                       x
                                    
                                    ,
                                    
                                       V
                                       n
                                    
                                    }
                                 
                              
                           . Then derivatives in Eq. (15) can be computed as

                              
                                 (22)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      L
                                                      t
                                                      
                                                         s
                                                         k
                                                         g
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      V
                                                      
                                                         n
                                                         (
                                                         
                                                            x
                                                            o
                                                         
                                                         ,
                                                         i
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                                  
                                                                     i
                                                                     n
                                                                  
                                                               
                                                               ∈
                                                               
                                                                  {
                                                                  
                                                                     x
                                                                     t
                                                                  
                                                                  ,
                                                                  
                                                                     p
                                                                     t
                                                                  
                                                                  }
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                                  
                                                                     i
                                                                     n
                                                                  
                                                               
                                                               ≠
                                                               
                                                                  x
                                                                  o
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      f
                                                      
                                                         n
                                                         (
                                                         
                                                            x
                                                            o
                                                         
                                                         ,
                                                         i
                                                         )
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                ×
                                                
                                                   [
                                                   
                                                      [
                                                      n
                                                      
                                                         (
                                                         
                                                            x
                                                            o
                                                         
                                                         ,
                                                         i
                                                         +
                                                         1
                                                         )
                                                      
                                                      =
                                                      r
                                                      c
                                                      h
                                                      
                                                         (
                                                         n
                                                         
                                                            (
                                                            
                                                               x
                                                               o
                                                            
                                                            ,
                                                            i
                                                            )
                                                         
                                                         )
                                                      
                                                      ]
                                                   
                                                   ]
                                                
                                                
                                                   V
                                                   
                                                      x
                                                      
                                                         i
                                                         n
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (23)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      L
                                                      t
                                                      
                                                         s
                                                         k
                                                         g
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      V
                                                      
                                                         x
                                                         
                                                            i
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      −
                                                      s
                                                      ≤
                                                      c
                                                      ≤
                                                      s
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                                  o
                                                               
                                                               ∈
                                                               
                                                                  {
                                                                  
                                                                     w
                                                                     
                                                                        t
                                                                        +
                                                                        c
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     p
                                                                     
                                                                        t
                                                                        +
                                                                        c
                                                                     
                                                                  
                                                                  }
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                                  o
                                                               
                                                               ≠
                                                               
                                                                  x
                                                                  
                                                                     i
                                                                     n
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      L
                                                      (
                                                      
                                                         x
                                                         o
                                                      
                                                      )
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      f
                                                      
                                                         n
                                                         (
                                                         
                                                            x
                                                            o
                                                         
                                                         ,
                                                         i
                                                         )
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                ×
                                                
                                                   [
                                                   
                                                      [
                                                      n
                                                      
                                                         (
                                                         
                                                            x
                                                            o
                                                         
                                                         ,
                                                         i
                                                         +
                                                         1
                                                         )
                                                      
                                                      =
                                                      r
                                                      c
                                                      h
                                                      
                                                         (
                                                         n
                                                         
                                                            (
                                                            
                                                               x
                                                               o
                                                            
                                                            ,
                                                            i
                                                            )
                                                         
                                                         )
                                                      
                                                      ]
                                                   
                                                   ]
                                                
                                                
                                                   V
                                                   
                                                      n
                                                      (
                                                      
                                                         x
                                                         o
                                                      
                                                      ,
                                                      i
                                                      )
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    f
                                    
                                       n
                                       (
                                       
                                          x
                                          o
                                       
                                       ,
                                       i
                                       )
                                    
                                 
                                 =
                                 σ
                                 
                                    (
                                    
                                       [
                                       
                                          [
                                          n
                                          
                                             (
                                             
                                                x
                                                o
                                             
                                             ,
                                             i
                                             +
                                             1
                                             )
                                          
                                          =
                                          r
                                          c
                                          h
                                          
                                             (
                                             n
                                             
                                                (
                                                
                                                   x
                                                   o
                                                
                                                ,
                                                i
                                                )
                                             
                                             )
                                          
                                          ]
                                       
                                       ]
                                    
                                    
                                       (
                                       
                                          V
                                          
                                             n
                                             (
                                             
                                                x
                                                o
                                             
                                             ,
                                             i
                                             )
                                          
                                          
                                             
                                             ′
                                          
                                       
                                       ·
                                       
                                          V
                                          
                                             x
                                             
                                                i
                                                n
                                             
                                          
                                       
                                       )
                                    
                                    )
                                 
                              
                           .

As a simple alternative to the hierarchical softmax, negative sampling is an extremely simple training method with Neg(x) negative samples for each positive sample x.

For the CBOW model, the predicting probability with negative sampling is defined as

                              
                                 (24)
                                 
                                    
                                       P
                                       
                                          (
                                          
                                             x
                                             t
                                          
                                          |
                                          
                                             S
                                             
                                                x
                                                t
                                             
                                          
                                          )
                                       
                                       =
                                       σ
                                       
                                          (
                                          
                                             U
                                             
                                                x
                                                t
                                             
                                          
                                          h
                                          
                                             (
                                             
                                                S
                                                
                                                   x
                                                   t
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             b
                                             
                                                x
                                                t
                                             
                                          
                                          )
                                       
                                       
                                          ∏
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                             e
                                             g
                                             (
                                             
                                                x
                                                t
                                             
                                             )
                                          
                                       
                                       σ
                                       
                                          (
                                          −
                                          
                                             U
                                             
                                                x
                                                i
                                             
                                          
                                          h
                                          
                                             (
                                             
                                                S
                                                
                                                   x
                                                   t
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             b
                                             
                                                x
                                                i
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                              
                           and derivatives in Eq. (14) can be computed as

                              
                                 (25)
                                 
                                    
                                       
                                          
                                             ∂
                                             (
                                             
                                                L
                                                t
                                                
                                                   c
                                                   b
                                                   o
                                                   w
                                                
                                             
                                             )
                                          
                                          
                                             ∂
                                             
                                                U
                                                
                                                   x
                                                   t
                                                
                                             
                                          
                                       
                                       =
                                       
                                          (
                                          1
                                          −
                                          
                                             f
                                             
                                                x
                                                t
                                             
                                          
                                          )
                                       
                                       h
                                       
                                          (
                                          
                                             S
                                             
                                                x
                                                t
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 (26)
                                 
                                    
                                       
                                          
                                             ∂
                                             (
                                             
                                                L
                                                t
                                                
                                                   c
                                                   b
                                                   o
                                                   w
                                                
                                             
                                             )
                                          
                                          
                                             ∂
                                             
                                                b
                                                
                                                   x
                                                   t
                                                
                                             
                                          
                                       
                                       =
                                       1
                                       −
                                       
                                          f
                                          
                                             x
                                             t
                                          
                                       
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 (27)
                                 
                                    
                                       
                                          
                                             ∂
                                             (
                                             
                                                L
                                                t
                                                
                                                   c
                                                   b
                                                   o
                                                   w
                                                
                                             
                                             )
                                          
                                          
                                             ∂
                                             
                                                U
                                                
                                                   x
                                                   i
                                                
                                             
                                          
                                       
                                       =
                                       
                                          (
                                          
                                             f
                                             
                                                x
                                                i
                                             
                                          
                                          −
                                          1
                                          )
                                       
                                       h
                                       
                                          (
                                          
                                             S
                                             
                                                x
                                                t
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 (28)
                                 
                                    
                                       
                                          
                                             ∂
                                             (
                                             
                                                L
                                                t
                                                
                                                   c
                                                   b
                                                   o
                                                   w
                                                
                                             
                                             )
                                          
                                          
                                             ∂
                                             
                                                b
                                                
                                                   x
                                                   i
                                                
                                             
                                          
                                       
                                       =
                                       
                                          f
                                          
                                             x
                                             i
                                          
                                       
                                       −
                                       1
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 (29)
                                 
                                    
                                       
                                          
                                             ∂
                                             (
                                             
                                                L
                                                t
                                                
                                                   c
                                                   b
                                                   o
                                                   w
                                                
                                             
                                             )
                                          
                                          
                                             ∂
                                             
                                                V
                                                
                                                   x
                                                   
                                                      i
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         t
                                                      
                                                      ∈
                                                      
                                                         {
                                                         
                                                            w
                                                            t
                                                         
                                                         ,
                                                         
                                                            p
                                                            t
                                                         
                                                         }
                                                      
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                         t
                                                      
                                                      ≠
                                                      
                                                         x
                                                         
                                                            i
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          {
                                          
                                             (
                                             1
                                             −
                                             
                                                f
                                                
                                                   x
                                                   t
                                                
                                             
                                             )
                                          
                                          
                                             U
                                             
                                                x
                                                t
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                                e
                                                g
                                                (
                                                
                                                   x
                                                   t
                                                
                                                )
                                             
                                          
                                          
                                             (
                                             
                                                f
                                                
                                                   x
                                                   i
                                                
                                             
                                             −
                                             1
                                             )
                                          
                                          
                                             U
                                             
                                                x
                                                i
                                             
                                          
                                          }
                                       
                                       ,
                                    
                                 
                              
                           where xin
                            is any input word or topic and 
                              
                                 
                                    f
                                    x
                                 
                                 =
                                 σ
                                 
                                    (
                                    
                                       U
                                       x
                                    
                                    h
                                    
                                       (
                                       
                                          S
                                          
                                             x
                                             t
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       b
                                       x
                                    
                                    )
                                 
                              
                           .

For the skip-gram model, the predicting probability with negative sampling is defined as

                              
                                 (30)
                                 
                                    
                                       P
                                       
                                          (
                                          
                                             x
                                             o
                                          
                                          |
                                          
                                             x
                                             
                                                i
                                                n
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          σ
                                          (
                                          
                                             V
                                             
                                                x
                                                o
                                             
                                             
                                                
                                                ′
                                             
                                          
                                          ·
                                          
                                             V
                                             
                                                x
                                                
                                                   i
                                                   n
                                                
                                             
                                          
                                          )
                                       
                                       
                                          
                                             ∏
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                N
                                                e
                                                g
                                                (
                                                
                                                   x
                                                   o
                                                
                                                )
                                             
                                          
                                          σ
                                          
                                             (
                                             −
                                             
                                                V
                                                
                                                   x
                                                   j
                                                
                                                
                                                   
                                                   ′
                                                
                                             
                                             ·
                                             
                                                V
                                                
                                                   x
                                                   
                                                      i
                                                      n
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           and then derivatives in Eq. (15) can be computed as

                              
                                 (31)
                                 
                                    
                                       
                                          
                                             ∂
                                             
                                                L
                                                t
                                                
                                                   s
                                                   k
                                                   g
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                V
                                                
                                                   x
                                                   o
                                                
                                             
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         
                                                            i
                                                            n
                                                         
                                                      
                                                      ∈
                                                      
                                                         {
                                                         
                                                            x
                                                            t
                                                         
                                                         ,
                                                         
                                                            p
                                                            t
                                                         
                                                         }
                                                      
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                         
                                                            i
                                                            n
                                                         
                                                      
                                                      ≠
                                                      
                                                         x
                                                         o
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          (
                                          1
                                          −
                                          
                                             f
                                             
                                                x
                                                o
                                             
                                             
                                                
                                                ′
                                             
                                          
                                          )
                                       
                                       
                                          V
                                          
                                             x
                                             
                                                i
                                                n
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 (32)
                                 
                                    
                                       
                                          
                                             ∂
                                             
                                                L
                                                t
                                                
                                                   s
                                                   k
                                                   g
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                V
                                                
                                                   x
                                                   j
                                                
                                             
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         
                                                            i
                                                            n
                                                         
                                                      
                                                      ∈
                                                      
                                                         {
                                                         
                                                            x
                                                            t
                                                         
                                                         ,
                                                         
                                                            p
                                                            t
                                                         
                                                         }
                                                      
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                         
                                                            i
                                                            n
                                                         
                                                      
                                                      ≠
                                                      
                                                         x
                                                         o
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          (
                                          
                                             f
                                             
                                                x
                                                j
                                             
                                             
                                                
                                                ′
                                             
                                          
                                          −
                                          1
                                          )
                                       
                                       
                                          V
                                          
                                             x
                                             
                                                i
                                                n
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 (33)
                                 
                                    
                                       
                                          
                                             ∂
                                             
                                                L
                                                t
                                                
                                                   s
                                                   k
                                                   g
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                V
                                                
                                                   x
                                                   
                                                      i
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             −
                                             s
                                             ≤
                                             c
                                             ≤
                                             s
                                          
                                       
                                       
                                          ∑
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         o
                                                      
                                                      ∈
                                                      
                                                         {
                                                         
                                                            w
                                                            
                                                               t
                                                               +
                                                               c
                                                            
                                                         
                                                         ,
                                                         
                                                            p
                                                            
                                                               t
                                                               +
                                                               c
                                                            
                                                         
                                                         }
                                                      
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                         o
                                                      
                                                      ≠
                                                      
                                                         x
                                                         
                                                            i
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                       
                                       
                                       
                                          {
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                N
                                                e
                                                g
                                                (
                                                
                                                   x
                                                   o
                                                
                                                )
                                             
                                          
                                          
                                             (
                                             
                                                f
                                                
                                                   x
                                                   j
                                                
                                                
                                                   
                                                   ′
                                                
                                             
                                             
                                             −
                                             
                                             1
                                             )
                                          
                                          
                                             V
                                             
                                                x
                                                j
                                             
                                          
                                          
                                          +
                                          
                                          
                                             (
                                             1
                                             
                                             −
                                             
                                             
                                                f
                                                
                                                   x
                                                   o
                                                
                                                
                                                   
                                                   ′
                                                
                                             
                                             )
                                          
                                          
                                             V
                                             
                                                x
                                                o
                                             
                                          
                                          }
                                       
                                       ,
                                    
                                 
                              
                           where 
                              
                                 
                                    f
                                    x
                                    
                                       
                                       ′
                                    
                                 
                                 =
                                 σ
                                 
                                    (
                                    
                                       V
                                       x
                                       
                                          
                                          ′
                                       
                                    
                                    ·
                                    
                                       V
                                       
                                          x
                                          
                                             i
                                             n
                                          
                                       
                                    
                                    )
                                 
                              
                           .

The idea of learning both words and topics under skip-gram model is similar to the topical word vectors named TWE [42] shown in Fig. 6
                        . The TWE-1 uses both the word and its assigned topic to predict context words in skip-gram, but not considering the immediate interaction between a word and its assigned topic for learning. The TWE-2 considers the inner interaction by viewing the word/topic pair as a pseudo word and learning the pseudo word vectors (topical word embeddings) directly, but it suffers from the sparsity issue. TWE-3 builds the vector of each word-topic pair by concatenating the corresponding word and topic vectors and each word-topic pair is predicted by the contextual word-topic pairs. The TWE-3 provides trade-off between discrimination and sparsity, but topic embeddings will influence the corresponding word embeddings during the learning process and may make those words in the same topic less discriminative.

Here, we regard each topic as a new word and insert the topics into the corpus. The vectors of both words and topics are learned on the enriched texts together. Compared to TWE-1, each word is predicted by not only the contextual words together with topics but also the topic assigned to the output word in topic learning. TWE-1 only predicts words but our method regards topics as new words which are also added to the output layer for vector learning. TWE-1 learns embeddings of words and topics separately, while our method learns words and topics together. So our method considers the inner interaction between a word and its assigned topic for learning. TWE-2 divides occurrences of each word into multiple topics, the learning of embeddings may suffer from more sparsity issue. In our learning framework, parameters of each word and the assigned topic are shared over all word-topic pairs compared with TWE-2 where each word-topic pair has their own parameters. So our method alleviates the sparsity problem over TWE-2. TWE-3 concatenates embeddings of the word and the assigned topic for learning, but may make those words in the same topic less discriminative compared with our method.

In Table 1
                        , we show the complexity of our method and the three TWE models, including the number of model parameters and computational complexity. In this table, vector lengths of words and topics are both L, orignal corpus length M and window size s. We can see that, compared with TWE models, our method requires no more parameters and the computational complexity does not increase too much.

@&#EXPERIMENTAL RESULTS@&#

We evaluated the performance of the proposed short text classification method on a database of web search snippets [12] which are very short, sparse, noisy and less topic-focused. The data set consists of two subsets, named short texts and Corpus. We want to classify short texts, drawing support from the Corpus for topic modeling and word/topic vector learning. The corpus was collected by crawling pages with topic-related seed words so that it is topic-consistent with the short texts. We report macro-averaging precision, recall and F1 as the performance metrics.

The search snippets were selected from results of web search transaction using predefined phrases of different domains. For each query phrase put into Google search engine, the top 20 or 30 ranked web search snippets were collected. Then the class label of the collected search snippets was assigned as the same as that of the issued phrase. Some basic statistics of these search snippets are summarized in Table 2
                           .

To collect the topic-consistent corpus, some seed keywords were prepared coming from different domains. For each seed keyword, JWikiDocs tool [40] was run to download the corresponding Wikipedia page and crawl relevant pages by following outgoing hyperlinks. Each crawling transaction was limited by the total number of download pages or the maximum depth (4 in the experiment) of hyperlinks. The seed keywords and the statistics of the crawled Wikipedia data are shown as follows:


                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             Topic-oriented keywords for crawling Wikipedia
                                          
                                          
                                       
                                    
                                    
                                       
                                          
                                             Arts architecture, fine, art, dancing, fashion, film, music ...
                                          
                                       
                                       
                                          
                                             Business advertising, e-commerce, finance, investment ...
                                          
                                       
                                       
                                          
                                             Computers hardware, software, database, multimedia ...
                                          
                                       
                                       
                                          
                                             Education course, graduate, professor, university ...
                                          
                                       
                                       
                                          
                                             Engineering automobile, telecommunication, civil, eng. ...
                                          
                                       
                                       
                                          
                                             Entertainment book, music, movie, painting, photos ...
                                          
                                       
                                       
                                          
                                             Health diet, therapy, healthcare, treatment, nutrition ...
                                          
                                       
                                       
                                          
                                             Mass-media news, newspaper, journal, television ...
                                          
                                       
                                       
                                          
                                             Politics government, legislation, party, regime, military ...
                                          
                                       
                                       
                                          
                                             Science biology, physics, chemistry, ecology, laboratory ...
                                          
                                       
                                       
                                          
                                             Sports baseball, cricket, football, tennis, olympic games ...
                                          
                                       
                                       
                                          
                                             Misc. association, development, environment ...
                                          
                                       
                                       
                                          
                                             Statistics of the crawled Wikipedia data
                                          
                                          
                                       
                                       
                                          
                                             Raw data: 3.5GB; 
                                                |
                                             docs
                                                |
                                              = 471,177
                                          
                                       
                                       
                                          
                                             Preprocessing: removing duplicate docs, HTML tags, navigation links, stop and rare words
                                          
                                       
                                       
                                          
                                             Final data: 240MB; 
                                                |
                                             docs
                                                |
                                              = 71,986; 
                                                |
                                             paragraphs
                                                |
                                              =882,376; 
                                                |
                                             vocabulary
                                                |
                                              = 60,649; 
                                                |
                                             total words
                                                |
                                              = 30,492,305
                                          
                                       
                                    
                                 
                              
                           
                        

The more consistent between the corpus and short texts to be classified, the more effective is the corpus for topic modeling and word vector learning. To verify the effectiveness of the topic-consistent corpus, we use the latest Wikipedia dump as the general corpus for comparison. For simplification, only word vectors are learned on the two corpora with skip-gram and CBOW. Word vectors are learned by a particular tool named word2vec [16]. The text feature is the mean representation vector and the classifier is linear SVM. The classification results are shown in Table 3
                         and we can see that the topic-consistent corpus (tc-) is more effective than the general (gr-).

We estimate topic models based on LDA (implemented with the package named GibbsLDA++ [12]) through Gibbs Sampling on the collected corpus. We set 
                           
                              α
                              =
                              50
                              /
                              K
                           
                         and 
                           
                              β
                              =
                              0.01
                           
                        . The number of topics ranges from 30, 40, 50...to 80, 90, and 100. To estimate parameters of each model, we run 2000 Gibbs Sampling iterations, and save the estimated model at every 200 iterations. After topic modeling, we perform topic inference with 50 Gibbs Sampling iterations on both training and testing data, using topic distributions as features and building SVM classifiers for training and classification. The results are shown in Table 4
                         and we can see the best results are achieved at 
                           
                              K
                              =
                              50
                           
                        . So we set topic number as 50 to learn the topic model for further experiments.

With hierarchical softmax and negative sampling proposed in Section 5.3, we learn vector representations of both words and topics by CBOW and skip-gram models. Four sets of vectors are resulted in i.e. CBOW with hierarchical softmax (hs-CBOW), CBOW with negative sampling (ns-CBOW), skip-gram with hierarchical softmax (hs-skip-gram), skip-gram with negative sampling (ns-skip-gram). To verify the effectiveness of hierarchical softmax and negative sampling, we respectively use the four sets of vectors to perform short text classification. The classification results are shown in Table 5
                           . It can be seen that the best results are achieved with vectors learned by skip-gram with hierarchical softmax, which are used to perform the resulting experiments.

To verify the effectiveness of learning word and topic vectors together, we perform short text classification with three sets of vectors i.e. only word vectors, only topic vectors, both word and topic vectors. The word vectors are learned on the original corpus using traditional skip-gram with hierarchical softmax. The topic vectors are produced by removing the word vectors from the word/topic vectors which are learned by the proposed skip-gram with hierarchical softmax. The classification results are shown in Table 6
                           . We can see that learning word and topics vectors together can improve the classification results compared with using word or topic only.

We consider the following baselines which have been proposed on the snippet dataset in other literatures:


                        BOW
                     

The BOW model represents each document as a bag of words and the term weighting scheme is TF-IDF. The classifier training method is the linear SVM.


                        LDA+MaxEnt 
                        [12]
                     

LDA is used to discover a set of hidden topics from the corpus. These topics are used as features to enrich the representation of short text and the classifier is Maximum Entropy (MaxEnt) which is very fast in both training and inference.


                        Multi-Topics 
                        [38]
                     

LDA is run on the corpus to generate topic models with respect to different topic number. Then, a subset of all the generated topic models is chosen to form the topic space of multiple granularity. The features of the multi-granularity topics are used to generate features for short text classification.


                        Classifier integration 
                        [43]
                     

The short texts are enriched with LDA based topics and respectively learned with SVM and MaxEnt. The results of the two classifiers are integrated for a comprehensive prediction.


                        Link analysis 
                        [45]
                     

The BOW feature is enriched with the most topic related words based on the link analysis of the topic-word graph. The enriched feature is used for classifier training and text classification with SVM.


                        CNN 
                        [44]
                     

The word vectors are first clustered to discover semantic cliques. Then, multi-scale semantic units are detected under the supervision of semantic cliques, which introduce useful external knowledge for short texts. These meaningful semantic units are combined and fed into convolutional neural networks (CNN), followed by max-pooling operation.

The comparisons are shown in Table 7
                         and we can see the superiority of our method. The BOW feature has very little sense about the semantics of the words and so performs poorly on short texts which provide insufficient word co-occurrence. The methods of LDA+MaxEnt, Multi-topics and the classifier integration (Cls-integration in Table 7) try to discover the LDA based topics for semantic enriching and use the topic features for classification. But the emphasis in LDA is on modeling topics not word meanings with no guarantee that the representations are sensible as points in the feature space. The link analysis method tries to enrich the short text with topic related words and use BOW model for classification. But the expanded words are based on the link analysis on the word-topic graph derived from LDA still not modeling word meanings. The CNN based classification method uses only the word vetors without the embeddings of topics and the word vectors are learned on the general corpus not topic-consistent with the short texts. Our method follows the benefit of enriching texts with topics and further learn vectors of both words and topics on the topic-consistent corpus for text representation and classification.

To evaluate the significance of the performance differences between the proposed method and the baselines, we conduct the paired t-test with 
                           
                              α
                              =
                              0.05
                           
                         on the results of 5-fold cross validation. The corresponding accuracy means (AM), standard deviations (STD) and test results (TR) are shown in Table 8
                        . The test results are denoted by Y or N. Y means the performance difference between the proposed and the compared methods is significant and N not. We can see that the proposed method performed significantly better than the compared methods.

Our method is similar to the topical word embeddings [42] in learning both word and topic vectors. Because TWE models have not been used for short text classification, we compare TWE models with our method specially not together with other baselines. Table 9
                         shows the results of the comparison between our method and the three TWE models. The TWE-1 model achieves the best performance among the three TWE models and our method performs better than all the TWE models.

TWE-1 uses the assigned topic to predict the contextual words and so does not consider the immediate interaction between the word and its assigned topic in learning. TWE-2 regards the word-topic pair as a pseudo word and the inner interaction of the pair is considered, but it suffers from the sparsity issue because the occurrences of each word are rigidly discriminated into different topics. TWE-3 provides trade-off between discrimination and sparsity by concatenating the embeddings of the word and the assigned topic for learning, but topic embeddings will influence the corresponding word embeddings, which may make those words in the same topic less discriminative. Our method regards the topics as the new words in the text, and learns the vectors of both words and vectors together by integrating the topics with the current and the contextual words. So our learning method benefits more interactions between the words and the topics than TWE-1 while avoids the sparse problem compared with TWE-2 and does not make the words in the same topic less discriminative compared with TWE-3.

To evaluate the significance of the performance differences between the proposed method and TWE models, we conduct the paired t-test with 
                           
                              α
                              =
                              0.05
                           
                         on the results of 5-fold cross validation. The corresponding accuracy means (AM), standard deviations (STD) and test results (TR) are shown in Table 10
                        . We can see that the proposed method performed significantly better than the three TWE methods.

@&#CONCLUSIONS AND FUTURE WORK@&#

In this paper, we improve the task of short text classification by learning vector representations of not only words but also their topics. We estimate the topic model with LDA on the corpus and enrich texts with the word topics. On the enriched corpus, viewing topics as new words, vectors of both words and topics are learned together. For short text classification, we do topic inference on each text and also enrich the text with topics. Then features of short texts are represented based on vectors of both words and topics for training and classification. The experimental results demonstrate the superiority of our methods over various baselines. There are some other issues that are missing in this paper. The future work will explore more tasks in our framework such as topic learning for short texts, discriminative representations of short texts based on vectors of words and topics, collecting corpus more topic-consistent with the classified short texts.

@&#ACKNOWLEDGMENT@&#

This work has been supported by the National Natural Science Foundation of China (NSFC) under grants No. 61403385 and No. 61403353, the Open Project Program of the National Laboratory of Pattern Recognition (NLPR) and the Fundamental Research Funds for the Central Universities of China. We also give great thanks to Peng Wang for his useful discussions.

@&#REFERENCES@&#

