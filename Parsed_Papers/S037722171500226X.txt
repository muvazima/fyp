@&#MAIN-TITLE@&#A linear programming decomposition focusing on the span of the nondegenerate columns

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We identify the limits of the existing improved primal simplex (IPS).


                        
                        
                           
                           We revise every step of the dynamic reduction implemented in IPS.


                        
                        
                           
                           We show how basic solutions can be built to warm start the solution of each problem.


                        
                        
                           
                           A simple and fast procedure can test the potential for improvement of the algorithm.


                        
                        
                           
                           The algorithm outperforms IPS and CPLEX’s primal simplex on a large benchmark.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Linear programming

Degeneracy

Improved primal simplex

Decomposition

Primal algorithms

@&#ABSTRACT@&#


               
               
                  The improved primal simplex (IPS) was recently developed by Elhalaloui et al. to take advantage of degeneracy when solving linear programs with the primal simplex. It implements a dynamic constraint reduction based on the compatible columns, i.e., those that belong to the span of a given subset of basic columns including the nondegenerate ones. The identification of the compatible variables may however be computationally costly and a large number of linear programs are solved to enlarge the subset of basic variables. In this article, we first show how the positive edge criterion of Raymond et al. can be included in IPS for a fast identification of the compatible variables. Our algorithm then proceeds through a series of reduction and augmentation phases until optimality is reached. In a reduction phase, we identify compatible variables and focus on them to make quick progress toward optimality. During an augmentation phase, we compute one greatest normalized improving direction and select a subset of variables that should be considered in the reduced problem. Compared with IPS, the linear program that is solved to find this direction involves the data of the original constraint matrix. This new algorithm is tested over Mittelmann’s benchmark for linear programming and on instances arising from industrial applications. The results show that the new algorithm outperforms the primal simplex of CPLEX on most highly degenerate instances in which a sufficient number of nonbasic variables are compatible. In contrast, IPS has difficulties on the eleven largest Mittelmann instances.
               
            

@&#INTRODUCTION@&#

We consider a linear program (LP) in standard form:

                        
                           
                              
                                 
                                    (
                                    P
                                    )
                                 
                              
                           
                           
                              
                                 {
                                 
                                    
                                       
                                          min
                                       
                                       
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                T
                                             
                                             x
                                          
                                       
                                       
                                       
                                    
                                    
                                       
                                          s.t.
                                       
                                       
                                       
                                          
                                             A
                                             x
                                          
                                       
                                       
                                          
                                             =
                                             b
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          x
                                       
                                       
                                          
                                             ≥
                                             
                                                0
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           x
                           ,
                           c
                           ∈
                           
                              R
                              n
                           
                        
                     , 
                        
                           b
                           ∈
                           
                              R
                              m
                           
                           ,
                        
                      and 
                        
                           A
                           ∈
                           
                              R
                              
                                 m
                                 ×
                                 n
                              
                           
                        
                     . We assume that 
                        A
                      is of full rank m with m ≤ n and that the feasible domain 
                        
                           
                              F
                              P
                           
                           =
                           
                              {
                              x
                              ≥
                              
                                 0
                              
                              :
                              A
                              x
                              =
                              b
                              }
                           
                        
                      is nonempty. A basis is a set of m independent columns of 
                        A
                     , and the associated variables are said to be basic. Starting from the indices 
                        B
                      of the basic variables and 
                        N
                      of the remaining nonbasic variables, the associated basic solution is obtained by setting

                        
                           (1)
                           
                              
                                 
                                    x
                                    B
                                 
                                 =
                                 
                                    A
                                    
                                       ·
                                       B
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 b
                                 
                                 
                                 and
                                 
                                 
                                 
                                    x
                                    N
                                 
                                 =
                                 
                                    0
                                 
                                 ,
                              
                           
                        
                     where for any set of indices 
                        
                           J
                           ,
                        
                     
                     
                        
                           A
                           
                              ·
                              J
                           
                        
                      is the set of columns of 
                        A
                      indexed by 
                        
                           J
                           ,
                        
                      and 
                        
                           x
                           J
                        
                      is the corresponding subvector of variables. More generally, the submatrix of 
                        A
                      containing the rows indexed by 
                        I
                      and the columns indexed by 
                        J
                      will be denoted 
                        
                           A
                           
                              I
                              J
                           
                        
                     . The basic solution is feasible if and only if 
                        
                           
                              x
                              B
                           
                           ≥
                           
                              0
                           
                        
                     . If 
                        
                           {
                           j
                           ∈
                           B
                           :
                           
                              x
                              j
                           
                           =
                           0
                           }
                        
                      is not empty, the solution is said to be degenerate, and all the variables indexed by this set are degenerate. The remaining nonzero basic variables are the nondegenerate variables.

Starting from a basic feasible solution, the primal simplex algorithm (see Dantzig, 1955) monotonically improves the objective value by going through a sequence of neighboring feasible bases until optimality is reached. One theoretical limitation of the algorithm is that an iteration may not lead to any progress in the objective value if the solution is degenerate. Geometrically, a degenerate vertex of the n-dimensional feasible polytope of an LP is the intersection of more than n constraints of this LP. In terms of the simplex algorithm, this means that a single vertex can correspond to several bases. The difficulty is that sometimes many iterations move from one basis to another associated with the same vertex. As a consequence, the theoretical convergence of the simplex cannot be guaranteed without a pivoting rule such as those described in Bland (1977) and Charnes (1952).

Although cycling is rarely an issue in practice, the risk of stalling is real. Several techniques have been developed to limit the negative effects of degeneracy (Benichou, Gauthier, Hentges, & Ribiere, 1977; Charnes, 1952; Gal, 1993; Gill, Murray, Saunders, & Wright, 1989; Greenberg, 1978), but recently there has been a growing interest in methods that take advantage of degeneracy. These studies all rely on the idea that degeneracy corresponds to a local excess of information, since degenerate basic variables are not needed to characterize a vertex of the polytope. Perold (1980) exploits this to develop a degeneracy structure in the LU decomposition of the basis, which involves fewer calculations when performing degenerate pivots. Pan (1998) took another important step in this direction by generalizing the concept of a basis. He defines a deficient basis to be a set of less than m independent columns of 
                           A
                         whose range contains 
                           b
                        . If the current solution is degenerate, it is sufficient to consider the deficient basis that contains only the positive variables. Degeneracy therefore becomes a potential opportunity to solve smaller linear systems at each iteration. Using deficient bases, Pan develops a simplex-like algorithm (Pan, 2008) and a dual projective algorithm (Pan, 2005) that show promising results in an experimental comparison with MINOS 5 (Murtagh & Saunders, 1983).


                        Elhallaoui, Metrane, Soumis, and Desaulniers (2010); Elhallaoui, Villeneuve, Soumis, and Desaulniers (2005) also take advantage of degeneracy to speed up the solution of set partitioning problems by aggregating the original constraints into clusters of constraints. The feasibility of the solution is ensured by keeping only the variables that are compatible with the clusters, i.e., the variables that are either present in or absent from every constraint of each cluster. When no improvement can be made by considering the compatible variables, some clusters are broken up or combined to include new improving directions in the aggregated problem. The strength of this dynamic constraint aggregation is the focus on a problem with many fewer constraints than the original one. The improved primal simplex (IPS) (Elhallaoui, Metrane, Desaulniers, & Soumis, 2011) extends this approach to general linear programming. A reduced problem is formed by keeping only the nondegenerate and compatible variables. In this context, a variable is compatible when the corresponding column of 
                           A
                         is in the range of the p nondegenerate columns. With the incompatible variables removed, m − p constraints are redundant and thus ignored. Once the optimal solution of the reduced problem has been found, a complementary problem is solved to prove the optimality of the original LP or to identify a sequence of pivots ending with an improvement in the objective value. The authors report that IPS significantly outperforms CPLEX
                           1
                        
                        
                           1
                           CPLEX is freely available for academic and research purposes under the IBM academic initiative: http://www-03.ibm.com/ibm/university/academic
.
                         on flight assignment (FA), combined vehicle and crew scheduling (VCS), and uncapacitated facility location (UFL) problems, and Raymond, Soumis, and Orban (2010) describe implementation techniques that improve the performance of the algorithm.

One important limitation of IPS is that compatible variables are identified through costly algebraic operations similar to those performed when computing a simplex tableau. As highlighted by Omer, Rosat, Raymond, and Soumis (2014), these operations are also useful when solving the complementary problem since they allow us to search for an improving direction in a reduced space, as is done in reduced gradient methods (Murtagh & Saunders, 1978). However, their tests on a diversified benchmark show that these operations cause IPS not to perform well on every highly degenerate LP. Raymond, Soumis, Metrane, and Desrosiers (2010) address this issue with a stochastic test requiring as many operations as the computation of a reduced cost to identify all the compatible variables. The authors apply this test to develop a partial pricing algorithm focusing on the compatible variables first. They report good results on the aforementioned VCS and FA instances, but their procedure struggles with two families of instances represented in Mittelmann’s benchmark. Based on this test, Towhidi, Desrosiers, and Soumis (2014) implement the positive edge pricing criterion within COIN-OR LP solver
                           2
                        
                        
                           2
                           
                              https://projects.coin-or.org/Clp
.
                         (CLP). Their results show significant improvement with regards to the devex pricing criterion (Harris, 1973) for the most degenerate Mittelmann instances, but their comparison focuses on CLP, which is known to be less efficient than most commercial LP solvers. More importantly, the articles by Towhidi et al. (2014) and Raymond, Soumis, Metrane et al. (2010) show how a fast compatibility test can be used to cope with degeneracy, but they do not take advantage of degeneracy, since the size of the linear system solved at each simplex pivot is not reduced.

Although the dual simplex and barrier algorithms often solve LPs more efficiently than the primal simplex, the latter has a strong advantage when a good feasible solution is available. As a consequence, the primal simplex is still used for reoptimization after modifications in the objective function, or after adding columns in the master problem in a column-generation procedure. Our work thus focuses on improving the primal simplex by taking advantage of degeneracy.

Our main contribution is a new dynamic reduction algorithm that overcomes the difficulties that IPS encounters on large instances. This algorithm not only yields substantial improvement on many degenerate instances but also provides a fast procedure to test the potential for improvement in advance. To achieve this, we modify IPS to include the fast compatibility test described in Raymond, Soumis, Metrane et al. (2010). One negative effect is that the complementary problem cannot be reduced without doing the algebraic operations that we are trying to avoid. The algorithm thus focuses on a complementary problem involving the original constraints of 
                           
                              P
                              ,
                           
                         and it involves a new mode of alternation between the reduced and the complementary problems that is more efficient on large LPs. We then show how good basic solutions can be built to warm-start both the reduced and the complementary problems. The practical impact of these modifications is studied on a large benchmark including the VCS, FA, and UFL instances used in Omer et al. (2014) and 45 Mittelmann instances. The purpose is to evaluate our new algorithm by comparing it with IPS and the primal simplex of CPLEX, and to show that it is possible to identify quickly the instances that offer a strong potential for faster solution. The results show the potential of the algorithm for an implementation as an adaptive strategy in a state-of-the-art primal simplex code.

In Section 2 we describe IPS as a necessary background for the rest of the article. The new algorithm based on a fast compatibility test is developed in Section 3. The results of the experimental tests are presented and analyzed in Section 4, and in Section 5 we discuss directions for future research.

In this section, we summarize the theoretical foundations and the practical implementation of IPS as a background for the new algorithm developed in Section 3. Although efficient implementations of linear programming algorithms should focus on LPs with bounded variables, we consider an LP in standard form to clarify and shorten the presentation. Omer et al. (2014) show the generalization to an LP with bounded variables, and the implementations tested in Section 4 use this generalization.

Let 
                        
                           x
                           ∈
                           
                              F
                              P
                           
                        
                      be a basic feasible solution of 
                        P
                     . The variables’ indices can be partitioned into two sets 
                        
                           P
                           =
                           {
                           j
                           :
                           
                              x
                              j
                           
                           >
                           0
                           }
                        
                      and 
                        
                           L
                           =
                           {
                           j
                           :
                           
                              x
                              j
                           
                           =
                           0
                           }
                        
                     . Since 
                        x
                      is a basic solution, the variables indexed by 
                        P
                      are basic, and the columns of 
                        
                           A
                           
                              ·
                              P
                           
                        
                      are linearly independent. The cardinality of 
                        
                           P
                           ,
                        
                     
                     
                        
                           p
                           =
                           
                              |
                              P
                              |
                           
                           ,
                        
                      thus satisfies p ≤ m. Moreover, 
                        
                           
                              x
                              L
                           
                           =
                           
                              0
                           
                           ,
                        
                      so the range of 
                        
                           A
                           
                              ·
                              P
                           
                        
                      contains 
                        b
                     .

                        Remark 1
                        If p < m, 
                              
                                 A
                                 
                                    ·
                                    P
                                 
                              
                            satisfies the definition of a deficient basis given by Pan (1998).

Assuming that 
                           
                              x
                              ∈
                              
                                 F
                                 P
                              
                              ,
                           
                         a primal algorithm iteratively improves the objective value by following a sequence of feasible improving directions as introduced below.

                           Definition 1
                           feasible direction


                           
                              
                                 
                                    d
                                    ∈
                                    
                                       R
                                       n
                                    
                                 
                               is a feasible direction at 
                                 x
                               if there exists ρ > 0 such that 
                                 
                                    x
                                    +
                                    ρ
                                    ·
                                    d
                                    ∈
                                    
                                       F
                                       P
                                    
                                 
                              .


                              
                                 
                                    d
                                    ∈
                                    
                                       R
                                       n
                                    
                                 
                               is an improving direction if 
                                 c
                              
                              
                                 T
                              
                              
                                 d
                               < 0, i.e., if taking a positive step along 
                                 d
                               yields an improvement in the objective value.

An improving vector is characterized by any pair (
                           d
                        , ρ) such that 
                           d
                         is a feasible improving direction and ρ > 0. 
                           d
                         can thus be normalized at will as long as ρ is chosen to satisfy 
                           
                              x
                              +
                              ρ
                              ·
                              d
                              ∈
                              
                                 F
                                 P
                              
                           
                        . One way to make a step toward optimality is to follow a normalized feasible improving direction that maximizes the rate of improvement in the objective value. The greatest normalized improvement (GNI) program finds one of these directions:

                           
                              
                                 
                                    
                                       (
                                       
                                          G
                                          n
                                          i
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                      d
                                                   
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   T
                                                
                                                d
                                             
                                          
                                       
                                       
                                          
                                             
                                                s.t.
                                                
                                             
                                          
                                          
                                             
                                                A
                                                d
                                                
                                                
                                                =
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   w
                                                   L
                                                   T
                                                
                                                
                                                   d
                                                   L
                                                
                                                ≤
                                                1
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   d
                                                   L
                                                
                                                ≥
                                                0
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 w
                                 L
                              
                              >
                              0
                           
                         is a normalization vector.

                           Proposition 1
                           
                              
                                 
                                    G
                                    n
                                    i
                                 
                               
                              has an optimal solution 
                              
                                 d
                              
                              ⋆. Moreover, denoting
                              
                                 
                                    
                                       I
                                       −
                                    
                                    =
                                    
                                       {
                                       i
                                       ∈
                                       P
                                       :
                                       
                                          d
                                          i
                                          ☆
                                       
                                       <
                                       0
                                       }
                                    
                                    ,
                                 
                              
                              
                                 
                                    •
                                    
                                       
                                          x
                                        
                                       is an optimal solution of
                                       
                                          P
                                        
                                       if and only if 
                                       
                                          c
                                       
                                       
                                          T
                                       
                                       
                                          d
                                       
                                       ⋆ = 0;


                                       
                                          d
                                       
                                       ⋆ 
                                       is an optimal ray of
                                       
                                          P
                                        
                                       if and only if 
                                       
                                          c
                                       
                                       
                                          T
                                       
                                       
                                          d
                                       
                                       ⋆ < 0 and
                                       
                                          
                                             
                                                I
                                                −
                                             
                                             =
                                             ∅
                                          
                                       ;


                                       if 
                                       
                                          c
                                       
                                       
                                          T
                                       
                                       
                                          d
                                       
                                       ⋆ < 0 and
                                       
                                          
                                             
                                                I
                                                −
                                             
                                             ≠
                                             ∅
                                             ,
                                          
                                        
                                       the maximal feasible step along 
                                       
                                          d
                                       
                                       ⋆ 
                                       is performed by setting 
                                       
                                          x
                                        ← 
                                          x
                                        + ρ
                                       max  · 
                                          d
                                       
                                       ⋆, where
                                       
                                          
                                             
                                                ρ
                                                max
                                             
                                             =
                                             
                                                min
                                                
                                                   i
                                                   ∈
                                                   
                                                      I
                                                      −
                                                   
                                                
                                             
                                             
                                                {
                                                
                                                   
                                                      
                                                         x
                                                         i
                                                      
                                                      
                                                         d
                                                         i
                                                      
                                                   
                                                
                                                }
                                             
                                          
                                       . This step leads to an improvement ρ
                                       max 
                                       
                                          c
                                       
                                       
                                          T
                                       
                                       
                                          d
                                       
                                       ⋆ 
                                       in the objective value.


                              
                                 d
                               = 
                                 0
                               is feasible, so 
                                 
                                    G
                                    n
                                    i
                                 
                               is feasible. Assuming that 
                                 
                                    G
                                    n
                                    i
                                 
                               is unbounded, it admits a feasible ray 
                                 r
                               with 
                                 c
                              
                              
                                 T
                              
                              
                                 r
                               < 0. ∀λ ≥ 0, λ · 
                                 r
                               is feasible, so 
                                 
                                    λ
                                    
                                       w
                                       L
                                       T
                                    
                                    
                                       r
                                       L
                                    
                                    ≤
                                    1
                                    ,
                                 
                               with 
                                 
                                    
                                       r
                                       L
                                    
                                    ≥
                                    0
                                 
                               and 
                                 
                                    
                                       w
                                       L
                                    
                                    >
                                    0
                                    ,
                                 
                               hence 
                                 
                                    
                                       r
                                       L
                                    
                                    =
                                    
                                       0
                                    
                                 
                              . It follows that 
                                 
                                    
                                       A
                                       
                                          ·
                                          P
                                       
                                    
                                    
                                       r
                                       P
                                    
                                    =
                                    
                                       0
                                    
                                    ,
                                 
                               with 
                                 
                                    A
                                    
                                       ·
                                       P
                                    
                                 
                               of full rank, so 
                                 
                                    
                                       r
                                       P
                                    
                                    =
                                    
                                       0
                                    
                                 
                              . This contradicts 
                                 c
                              
                              
                                 T
                              
                              
                                 r
                               > 0. 
                                 
                                    G
                                    n
                                    i
                                 
                               is thus bounded and has an optimal solution 
                                 d
                              
                              ⋆.

Next, assume that 
                                 c
                              
                              
                                 T
                              
                              
                                 d
                              
                              ⋆ < 0. 
                                 d
                              
                              ⋆ is an optimal ray of 
                                 P
                               if and only if 
                                 d
                              
                              ⋆ ≥ 
                                 0
                              , or equivalently 
                                 
                                    ⇔
                                    
                                       I
                                       −
                                    
                                    =
                                    ∅
                                 
                              . If 
                                 
                                    
                                       I
                                       −
                                    
                                    ≠
                                    ∅
                                    ,
                                 
                               it is easy to verify that ρ
                              max  > 0 is the largest step such that 
                                 x
                               + ρ
                              max 
                              
                                 d
                              
                              ⋆ ≥ 
                                 0
                               is feasible, and that it leads to an improvement ρ
                              max 
                              
                                 c
                              
                              
                                 T
                              
                              
                                 d
                              
                              ⋆ < 0 in the objective value. 
                                 x
                               is not an optimal solution of 
                                 
                                    P
                                    ,
                                 
                               so 
                                 x
                               optimal ⇒
                                 d
                              
                              ⋆ ≥ 0.

Finally, if 
                                 c
                              
                              
                                 T
                              
                              
                                 d
                              
                              ⋆ ≥ 0, no improving feasible direction exists at 
                                 x
                              , so 
                                 x
                               is an optimal solution of 
                                 P
                               if and only if 
                                 c
                              
                              
                                 T
                              
                              
                                 d
                              
                              ⋆ = 0.□

To take advantage of degeneracy, Omer et al. (2014) decompose 
                           
                              G
                              n
                              i
                           
                         by referring to the following concept of compatibility.

                           Definition 3
                           compatible variable


                           A variable xj
                               is compatible with a deficient basis 
                                 P
                               if and only if the corresponding column in 
                                 A, a
                              
                              
                                 j
                              , is in 
                                 
                                    Span
                                    
                                       (
                                       
                                          A
                                          
                                             ·
                                             P
                                          
                                       
                                       )
                                    
                                 
                              .

The zero variables can then be partitioned into compatible and incompatible variables whose sets of indices are respectively denoted 
                           C
                         and 
                           I
                        . Based on this partition, 
                           
                              G
                              n
                              i
                           
                         is decomposed into the reduced-
                           
                              G
                              n
                              i
                           
                         (
                           
                              R
                              −
                              G
                              n
                              i
                           
                        ) and the complementary-
                           
                              G
                              n
                              i
                           
                         (
                           
                              C
                              −
                              G
                              n
                              i
                           
                        ) that respectively focus on the compatible and incompatible variables:

                           
                              
                                 
                                    
                                       (
                                       
                                          R
                                          −
                                          G
                                          n
                                          i
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            min
                                                            
                                                               (
                                                               
                                                                  d
                                                                  P
                                                               
                                                               ,
                                                               
                                                                  d
                                                                  C
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                         
                                                            c
                                                            P
                                                            T
                                                         
                                                         
                                                            d
                                                            P
                                                         
                                                      
                                                   
                                                   
                                                      +
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            C
                                                            T
                                                         
                                                         
                                                            d
                                                            C
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      s.t.
                                                   
                                                   
                                                      
                                                         
                                                         
                                                            A
                                                            
                                                               ·
                                                               P
                                                            
                                                         
                                                         
                                                            d
                                                            P
                                                         
                                                      
                                                   
                                                   
                                                      +
                                                   
                                                   
                                                      
                                                         
                                                            A
                                                            
                                                               ·
                                                               C
                                                            
                                                         
                                                         
                                                            d
                                                            C
                                                         
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                   
                                                      
                                                         
                                                            w
                                                            C
                                                            T
                                                         
                                                         
                                                            d
                                                            C
                                                         
                                                      
                                                   
                                                   
                                                      ≤
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                   
                                                      
                                                         
                                                            d
                                                            C
                                                         
                                                         ≥
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       (
                                       
                                          C
                                          −
                                          G
                                          n
                                          i
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            min
                                                            
                                                               (
                                                               
                                                                  d
                                                                  P
                                                               
                                                               ,
                                                               
                                                                  d
                                                                  I
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                         
                                                            c
                                                            P
                                                            T
                                                         
                                                         
                                                            d
                                                            P
                                                         
                                                      
                                                   
                                                   
                                                      +
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            I
                                                            T
                                                         
                                                         
                                                            d
                                                            I
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      s.t.
                                                   
                                                   
                                                      
                                                         
                                                         
                                                            A
                                                            
                                                               ·
                                                               P
                                                            
                                                         
                                                         
                                                            d
                                                            P
                                                         
                                                      
                                                   
                                                   
                                                      +
                                                   
                                                   
                                                      
                                                         
                                                            A
                                                            
                                                               ·
                                                               I
                                                            
                                                         
                                                         
                                                            d
                                                            I
                                                         
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                   
                                                      
                                                         
                                                            w
                                                            I
                                                            T
                                                         
                                                         
                                                            d
                                                            I
                                                         
                                                      
                                                   
                                                   
                                                      ≤
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                   
                                                      
                                                         
                                                            d
                                                            I
                                                         
                                                         ≥
                                                         0
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The validity of this decomposition is justified by the following theorem of Omer et al. (2014), which extends to general LPs a result proved by Rosat, Elhallaoui, Soumis, and Lodi (2013) for set partitioning problems.

                           Theorem 1
                           
                              Let
                              
                                 
                                    
                                       z
                                       
                                          G
                                          n
                                          i
                                       
                                       ☆
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       z
                                       
                                          R
                                          −
                                          G
                                          n
                                          i
                                       
                                       ☆
                                    
                                    ,
                                 
                               
                              and
                              
                                 
                                    z
                                    
                                       C
                                       −
                                       G
                                       n
                                       i
                                    
                                    ☆
                                 
                               
                              be the optimal objective values of
                              
                                 
                                    
                                       G
                                       n
                                       i
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       R
                                       −
                                       G
                                       n
                                       i
                                    
                                    ,
                                 
                               
                              and
                              
                                 
                                    C
                                    −
                                    G
                                    n
                                    i
                                 
                              ; then we have
                              
                                 
                                    
                                       
                                          
                                             z
                                             
                                                G
                                                n
                                                i
                                             
                                             ☆
                                          
                                          =
                                          min
                                          
                                             {
                                             
                                                z
                                                
                                                   R
                                                   −
                                                   G
                                                   n
                                                   i
                                                
                                                ☆
                                             
                                             ,
                                             
                                                z
                                                
                                                   C
                                                   −
                                                   G
                                                   n
                                                   i
                                                
                                                ☆
                                             
                                             }
                                          
                                          .
                                       
                                    
                                 
                              
                           


                        Theorem 1 ensures that an optimal solution of 
                           
                              G
                              n
                              i
                           
                         can be found by solving 
                           
                              R
                              −
                              G
                              n
                              i
                           
                         and 
                           
                              C
                              −
                              G
                              n
                              i
                           
                         separately.

One key feature of the decomposition is that 
                           
                              R
                              −
                              G
                              n
                              i
                           
                         can be further reduced. If the current solution is degenerate, i.e., if p < m, the rank of the constraint matrix of 
                           
                              R
                              −
                              G
                              n
                              i
                           
                         (p) is lower than the number of constraints (m), so m − p constraints of 
                           
                              R
                              −
                              G
                              n
                              i
                           
                         are redundant. Assume that the rows and columns are permuted so that the first p columns correspond to the nonzero variables and the first p rows correspond to independent rows of 
                           
                              A
                              
                                 ·
                                 P
                              
                           
                        ; then 
                           
                              R
                              −
                              G
                              n
                              i
                           
                         is equivalent to

                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                   
                                                      (
                                                      
                                                         d
                                                         P
                                                      
                                                      ,
                                                      
                                                         d
                                                         C
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   c
                                                   P
                                                   T
                                                
                                                
                                                   d
                                                   P
                                                
                                             
                                          
                                          
                                             +
                                          
                                          
                                             
                                                
                                                   c
                                                   C
                                                   T
                                                
                                                
                                                   d
                                                   C
                                                
                                             
                                          
                                       
                                       
                                          
                                             s.t.
                                          
                                          
                                             
                                                
                                                
                                                   A
                                                   
                                                      P
                                                      P
                                                   
                                                
                                                
                                                   d
                                                   P
                                                
                                             
                                          
                                          
                                             +
                                          
                                          
                                             
                                                
                                                   A
                                                   
                                                      P
                                                      C
                                                   
                                                
                                                
                                                   d
                                                   C
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                          
                                          
                                          
                                             
                                                
                                                   w
                                                   C
                                                   T
                                                
                                                
                                                   d
                                                   C
                                                
                                             
                                          
                                          
                                             ≤
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                          
                                          
                                          
                                             
                                                
                                                   d
                                                   C
                                                
                                                ≥
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The practical benefit of the decomposition is that an efficient solution process can focus on the easy subproblem 
                           
                              R
                              −
                              G
                              n
                              i
                           
                         until 
                           
                              
                                 z
                                 
                                    R
                                    −
                                    G
                                    n
                                    i
                                 
                                 ☆
                              
                              =
                              0
                              ,
                           
                         and then solve 
                           
                              C
                              −
                              G
                              n
                              i
                           
                         to find an improving direction involving several incompatible variables or to prove the optimality of the current solution.

One important step of the decomposition is the identification of the compatible variables. In IPS, the deficient basis 
                           
                              A
                              
                                 ·
                                 P
                              
                           
                         is completed with m − p independent vectors to form a basis 
                           B
                         of 
                           
                              R
                              m
                           
                        . Let 
                           
                              
                                 P
                                 ¯
                              
                              =
                              
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 }
                              
                              ∖
                              P
                           
                        . The compatible variables are then identified using the following result.

                           Proposition 2
                           
                              
                                 
                                    v
                                    ∈
                                    
                                       R
                                       m
                                    
                                 
                               
                              is compatible with
                              
                                 P
                               
                              if and only if
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                B
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          v
                                          )
                                       
                                       
                                          P
                                          ¯
                                       
                                    
                                    =
                                    
                                       0
                                    
                                 
                              .


                              
                                 
                                    v
                                    ∈
                                    
                                       R
                                       m
                                    
                                 
                               is written uniquely in the basis 
                                 B
                               as 
                                 
                                    (
                                    
                                       
                                          (
                                          
                                             
                                                B
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          v
                                          )
                                       
                                       P
                                    
                                    ,
                                    
                                       
                                          (
                                          
                                             
                                                B
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          v
                                          )
                                       
                                       
                                          P
                                          ¯
                                       
                                    
                                    )
                                 
                              . 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                B
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          v
                                          )
                                       
                                       P
                                    
                                    ∈
                                    Span
                                    
                                       (
                                       
                                          A
                                          
                                             ·
                                             P
                                          
                                       
                                       )
                                    
                                 
                               gives the coordinates of 
                                 v
                               corresponding to 
                                 
                                    
                                       A
                                       
                                          ·
                                          P
                                       
                                    
                                    ,
                                 
                               so 
                                 
                                    v
                                    ∈
                                    Span
                                    (
                                    
                                       A
                                       
                                          ·
                                          P
                                       
                                    
                                    )
                                 
                               if and only if 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                B
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          v
                                          )
                                       
                                       
                                          P
                                          ¯
                                       
                                    
                                    =
                                    
                                       0
                                    
                                 
                              .□

A computationally efficient completion of 
                           
                              A
                              
                                 ·
                                 P
                              
                           
                         uses vectors of the canonical basis of 
                           
                              R
                              m
                           
                        . Assuming a convenient reordering of the rows, 
                           B
                         and its inverse are given by

                           
                              
                                 
                                    B
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   A
                                                   
                                                      P
                                                      P
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                   
                                                      
                                                         P
                                                         ¯
                                                      
                                                      P
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                      I
                                                      
                                                         m
                                                         −
                                                         p
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ⇔
                                    
                                       
                                          B
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   A
                                                   
                                                      P
                                                      P
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   
                                                      A
                                                      
                                                         
                                                            P
                                                            ¯
                                                         
                                                         P
                                                      
                                                   
                                                   
                                                      A
                                                      
                                                         P
                                                         P
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                      I
                                                      
                                                         m
                                                         −
                                                         p
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                           
                        The compatible variables of 
                           L
                         are thus identified by searching for the zero columns of

                           
                              
                                 
                                    
                                       A
                                       ¯
                                    
                                    =
                                    −
                                    
                                       A
                                       
                                          
                                             P
                                             ¯
                                          
                                          P
                                       
                                    
                                    
                                       A
                                       
                                          P
                                          P
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       A
                                       
                                          P
                                          L
                                       
                                    
                                    +
                                    
                                       A
                                       
                                          
                                             P
                                             ¯
                                          
                                          L
                                       
                                    
                                    .
                                 
                              
                           
                        
                     


                        
                           
                              A
                              ¯
                           
                         is a restriction of the simplex tableau to the m − p rows of 
                           
                              
                                 P
                                 ¯
                              
                              ,
                           
                         and it is well known that the tableau version of the simplex had to be abandoned because of these algebraic operations. A practical implementation of IPS thus requires us to limit the number of times that the compatible variables are identified, and to take advantage of the knowledge of 
                           
                              A
                              ¯
                           
                        .


                        Omer et al. (2014) show that solving 
                           
                              R
                              −
                              G
                              n
                              i
                           
                         and following the resulting improving direction is equivalent to performing a simplex pivot in the original LP restricted to the nondegenerate and compatible variables, 
                           
                              P
                              C
                           
                        . The redundant constraints of 
                           
                              P
                              C
                           
                         are identified by performing a LU decomposition of 
                           
                              A
                              
                                 ·
                                 P
                              
                           
                         using UMFPACK (Davis & Duff, 1997). Denoting 
                           U
                         the upper triangle matrix provided by the decomposition, a set of dependent rows of 
                           
                              A
                              
                                 ·
                                 P
                              
                           
                         is deduced from the rows of 
                           U
                         with at least one nonzero element. After removing the redundant constraints, this reduced LP is

                           
                              
                                 
                                    
                                       (
                                       
                                          P
                                          C
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                min
                                                
                                             
                                          
                                          
                                             
                                                
                                                   c
                                                   P
                                                   T
                                                
                                                
                                                   x
                                                   P
                                                
                                                +
                                                
                                                   c
                                                   C
                                                   T
                                                
                                                
                                                   x
                                                   C
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                s.t.
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                   
                                                      P
                                                      P
                                                   
                                                
                                                
                                                   x
                                                   P
                                                
                                                +
                                                
                                                   A
                                                   
                                                      P
                                                      C
                                                   
                                                
                                                
                                                   x
                                                   C
                                                
                                                =
                                                
                                                   b
                                                   P
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   x
                                                   P
                                                
                                                ≥
                                                
                                                   0
                                                
                                                ,
                                                
                                                   x
                                                   C
                                                
                                                ≥
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The variable pivoted into the basis minimizes the normalized pricing criterion 
                           
                              
                                 
                                    c
                                    ¯
                                 
                                 i
                              
                              /
                              
                                 w
                                 i
                              
                              ,
                           
                         where 
                           
                              
                                 
                                    c
                                    ¯
                                 
                                 T
                              
                              =
                              
                                 
                                    c
                                 
                                 T
                              
                              −
                              
                                 c
                                 P
                                 T
                              
                              
                                 A
                                 
                                    P
                                    P
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 A
                                 
                                    P
                                    C
                                 
                              
                           
                        . As a consequence, if the partition 
                           
                              (
                              P
                              ,
                              C
                              ,
                              I
                              )
                           
                         is not updated after the solution of 
                           
                              
                                 R
                                 −
                                 G
                                 n
                                 i
                              
                              ,
                           
                         this problem may be solved several times by performing as many simplex pivots in 
                           
                              P
                              C
                           
                        . The drawback is that some basic variables may take a zero value, in which case degenerate pivots may occur. However, this risk is compensated for by the time saved on the update of 
                           
                              A
                              ¯
                           
                        . Unless the optimal solution is found, the solution of 
                           
                              P
                              C
                           
                         is interrupted after an arbitrary number of pivots, and 
                           
                              (
                              P
                              ,
                              C
                              ,
                              I
                              )
                           
                         is updated if two conditions that formulate the expected benefit of a new partition are satisfied. In Omer et al. (2014), IPS interrupts the solution of 
                           
                              P
                              C
                           
                         every m iterations, and in order to update 
                           
                              (
                              P
                              ,
                              C
                              ,
                              I
                              )
                           
                         it requires that at least 10 percent of the basic variables of 
                           
                              P
                              C
                           
                         are degenerate and 30 percent of the nondegenerate variables do not belong to 
                           P
                        .

Once an optimal solution of 
                           
                              P
                              C
                           
                         has been found, 
                           
                              C
                              −
                              G
                              n
                              i
                           
                         is solved to find a new improving direction or to prove the optimality of the current solution. In C-Gni, the linear constraints 
                           
                              
                                 A
                                 
                                    ·
                                    P
                                 
                              
                              
                                 d
                                 P
                              
                              +
                              
                                 A
                                 
                                    ·
                                    I
                                 
                              
                              
                                 d
                                 I
                              
                              =
                              
                                 0
                              
                           
                         can be interpreted as follows: the weighted combination of the columns 
                           
                              
                                 A
                                 
                                    ·
                                    I
                                 
                              
                              
                                 d
                                 I
                              
                           
                         that potentially enter the basis must be compatible. According to Proposition 2, another way of putting this condition is 
                           
                              
                                 
                                    A
                                    ¯
                                 
                                 
                                    ·
                                    I
                                 
                              
                              
                                 d
                                 I
                              
                              =
                              
                                 0
                              
                           
                        . For a given 
                           
                              d
                              I
                           
                         satisfying this condition, the unique vector 
                           
                              d
                              P
                           
                         satisfying 
                           
                              
                                 A
                                 
                                    ·
                                    P
                                 
                              
                              
                                 d
                                 P
                              
                              +
                              
                                 A
                                 
                                    ·
                                    I
                                 
                              
                              
                                 d
                                 I
                              
                              =
                              
                                 0
                              
                           
                         is then given by 
                           
                              
                                 d
                                 P
                              
                              =
                              −
                              
                                 A
                                 
                                    P
                                    P
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 A
                                 
                                    P
                                    I
                                 
                              
                              
                                 d
                                 I
                              
                           
                        . Since 
                           
                              
                                 A
                                 ¯
                              
                              
                                 ·
                                 I
                              
                           
                         was computed when the compatible variables were identified, 
                           
                              C
                              −
                              G
                              n
                              i
                           
                         can be modified without additional operations to search for an optimal solution by solving a smaller LP that involves only the variables of 
                           
                              d
                              I
                           
                        :

                           
                              
                                 
                                    
                                       (
                                       
                                          C
                                          r
                                          −
                                          G
                                          n
                                          i
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                z
                                                
                                                   C
                                                   −
                                                   G
                                                   n
                                                   i
                                                
                                                ☆
                                             
                                             =
                                          
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   d
                                                   I
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   c
                                                   ¯
                                                
                                                
                                                   I
                                                
                                                T
                                             
                                             
                                                d
                                                I
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          s.t.
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                   ¯
                                                
                                                
                                                   ·
                                                   I
                                                
                                             
                                             
                                                d
                                                I
                                             
                                             =
                                             0
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                w
                                                I
                                                T
                                             
                                             
                                                d
                                                I
                                             
                                             ≤
                                             1
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                d
                                                I
                                             
                                             ≥
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Let 
                           
                              d
                              I
                              ☆
                           
                         be an optimal solution of 
                           
                              C
                              r
                              −
                              G
                              n
                              i
                           
                        . If 
                           
                              (
                              P
                              ,
                              C
                              ,
                              I
                              )
                           
                         is not updated before 
                           
                              C
                              r
                              −
                              G
                              n
                              i
                           
                         is solved, the compatibility of the combination 
                           
                              
                                 A
                                 
                                    ·
                                    I
                                 
                              
                              
                                 d
                                 I
                              
                           
                         does not necessarily imply that the optimal solution of 
                           
                              C
                              r
                              −
                              G
                              n
                              i
                           
                         corresponds to a feasible direction for 
                           P
                        . This is not a real issue in IPS, because this solution is not used to produce a strict improvement in the objective value but instead to select columns that should be added to the reduced problem. Since 
                           
                              d
                              I
                              ☆
                           
                         indicates an interesting direction in most cases, we select every variable indexed by 
                           
                              
                                 I
                                 +
                              
                              =
                              
                                 {
                                 j
                                 ∈
                                 I
                                 :
                                 
                                    d
                                    j
                                    ☆
                                 
                                 >
                                 0
                                 }
                              
                           
                        . 
                           
                              C
                              r
                              −
                              G
                              n
                              i
                           
                         is then updated by removing the variables indexed by 
                           
                              I
                              +
                           
                         and solved several times until at least 10 percent of the variables of 
                           I
                         are selected.


                        Algorithm 1 summarizes the overall procedure. In this procedure, IPS solves 
                           P
                         using a dynamic reduction of the problem. The algorithm performs major iterations (steps 4–22) composed of a reduction phase (steps 4–12) and an augmentation phase (steps 13–22), until optimality is reached. At each major iteration, IPS performs simplex pivots on the reduced problem 
                           
                              
                                 R
                                 e
                                 d
                              
                              ,
                           
                         and, depending on the state of the solution, the number of rows and columns in 
                           
                              R
                              e
                              d
                           
                         may increase and/or decrease. The motivation for developing the dynamic reduction is that the solution may be accelerated if the majority of the pivots can be performed on a problem smaller than the original one.

In this implementation, 
                           
                              R
                              e
                              d
                           
                         is always set to 
                           
                              P
                              C
                           
                         after an update of 
                           
                              
                                 (
                                 P
                                 ,
                                 C
                                 ,
                                 I
                                 )
                              
                              ,
                           
                         and it is gradually augmented with new columns after each solution of the complementary problem. Rows are added together with the columns to ensure that the constraints of 
                           P
                         that do not appear in 
                           
                              R
                              e
                              d
                           
                         are the redundant ones (this does not appear explicitly in the algorithm).

To ensure that the interruptions and subsequent warm starts are done efficiently, every LP is solved with a simplex algorithm. To be specific, 
                           
                              R
                              e
                              d
                           
                         is solved with the primal simplex and 
                           
                              C
                              r
                              −
                              G
                              n
                              i
                           
                         is solved with the dual simplex. Raymond, Soumis, and Orban (2010) justify the choice of the dual simplex for 
                           
                              C
                              r
                              −
                              G
                              n
                              i
                           
                         by a large number of computational tests. A more qualitative reason is that the initial solution of 
                           
                              C
                              r
                              −
                              G
                              n
                              i
                           
                         is usually degenerate. Using the dual simplex offers an opportunity to escape from a highly degenerate vertex without going through a long sequence of degenerate pivots. From this perspective, IPS is a primal–dual algorithm that switches to the dual simplex when no improvement can be achieved in the subspace spanned by the variables of 
                           P
                        .

In this section, we develop a new dynamic reduction process to include a fast compatibility test that does not require the computation of 
                        
                           A
                           ¯
                        
                     . This new algorithm, called IPSO, maintains the global structure of IPS: reduction and augmentation phases are iteratively performed until optimality is reached. However, the reduction and augmentation phases are both revised to operate with no access to the information contained in 
                        
                           A
                           ¯
                        
                     . To characterize the differences between IPS and IPSO, we may bring out an analogy with the differences between Dantzig’s primal simplex and the revised simplex method. In its initial description, the primal simplex computes the simplex tableau 
                        
                           A
                           ¯
                        
                      and updates it with each pivot. To avoid spending too much time in the computation of 
                        
                           
                              A
                              ¯
                           
                           ,
                        
                      the revised simplex records only the indices of the basic variables and it solves two linear systems to identify the entering and exiting variables at each iteration. Similarly to the revised simplex, IPSO records only the indices of the compatible variables and updates them by solving linear systems. One issue with this new process is that IPS also uses 
                        
                           A
                           ¯
                        
                      to reduce the complementary problem. As a consequence, one important difference between IPSO and IPS is that the augmentation phase is completely redesigned to limit the time spent in the solution of the complementary problem.


                     Algorithm 2 summarizes the new dynamic reduction process. The key features of IPSO include the adaptation of the positive edge criterion for fast identification of the compatible variables (steps 6 and 13) and a heuristic augmentation procedure that requires only one solution of the complementary problem at each phase (steps 13–27). Warm-starting the reduced and complementary problems is another essential contribution for an efficient transition between the phases (steps 16, 19 and 27). These important steps of the algorithm are detailed below.

In steps 6 and 13 of Algorithm 2, we adapt the positive edge criterion of Raymond, Soumis, Metrane et al. (2010) for a fast identification of the compatible variables. More generally, this criterion can be viewed as a stochastic test of membership in the range of a set of independent vectors. As for IPS, Raymond, Soumis, Metrane et al. (2010) complete the deficient basis 
                           
                              A
                              
                                 ·
                                 P
                              
                           
                         with vectors of the canonical basis of 
                           
                              R
                              m
                           
                         to form a basis 
                           B
                         of 
                           
                              R
                              m
                           
                        . Let j ∈ {1, …, n}, and 
                           
                              
                                 
                                    a
                                    ¯
                                 
                                 j
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          B
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       a
                                       j
                                    
                                    )
                                 
                                 
                                    P
                                    ¯
                                 
                              
                           
                        . The essence of the positive edge criterion is then given by the following proposition.

                           Proposition 3
                           
                              Let 
                              
                                 v
                               
                              be a vector of m − p continuous random variables. Then, either 
                              
                                 a
                              
                              
                                 j
                               
                              is compatible with
                              
                                 P
                               
                              and
                              
                                 
                                    
                                       
                                          
                                             v
                                          
                                          T
                                       
                                       ·
                                       
                                          
                                             a
                                             ¯
                                          
                                          j
                                       
                                       =
                                       0
                                    
                                    ,
                                 
                               
                              or 
                              
                                 a
                              
                              
                                 j
                               
                              is incompatible and
                              
                                 
                                    P
                                    (
                                    
                                       
                                          v
                                       
                                       T
                                    
                                    
                                       
                                          a
                                          ¯
                                       
                                       j
                                    
                                    =
                                    0
                                    )
                                    =
                                    0
                                 
                              .

If 
                                 a
                              
                              
                                 j
                               is compatible with 
                                 
                                    P
                                    ,
                                 
                               
                              Proposition 2 states that 
                                 
                                    
                                       
                                          a
                                          ¯
                                       
                                       j
                                    
                                    =
                                    
                                       0
                                    
                                    ,
                                 
                               hence 
                                 
                                    
                                       
                                          v
                                       
                                       T
                                    
                                    
                                       
                                          a
                                          ¯
                                       
                                       j
                                    
                                    =
                                    0
                                 
                              . Otherwise, 
                                 
                                    
                                       
                                          v
                                       
                                       T
                                    
                                    
                                       
                                          a
                                          ¯
                                       
                                       j
                                    
                                 
                               is a nonzero continuous random variable, which implies that the probability it takes a particular value is zero.□

Given 
                           
                              v
                              ∈
                              
                                 R
                                 
                                    m
                                    −
                                    p
                                 
                              
                              ,
                           
                         let 
                           
                              w
                              ∈
                              
                                 R
                                 m
                              
                           
                         be the solution of 
                           w
                        
                        
                           T
                        
                        
                           B
                         = (
                           0, v
                        
                        
                           T
                        ), i.e., 
                           
                              
                                 
                                    w
                                 
                                 T
                              
                              =
                              
                                 
                                    v
                                 
                                 T
                              
                              
                                 
                                    (
                                    
                                       
                                          B
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    P
                                    ¯
                                 
                              
                           
                        . 
                           
                              
                                 
                                    v
                                 
                                 T
                              
                              
                                 
                                    a
                                    ¯
                                 
                                 j
                              
                              =
                              
                                 
                                    w
                                 
                                 T
                              
                              
                                 a
                                 j
                              
                              ,
                           
                         so the compatible variables may be identified by solving one linear system of m equations 
                           w
                        
                        
                           T
                        
                        
                           B
                         = (
                           0, v
                        
                        
                           T
                        ) and computing one matrix/vector product 
                           
                              
                                 
                                    w
                                 
                                 T
                              
                              
                                 A
                                 
                                    ·
                                    L
                                 
                              
                              ,
                           
                         which requires the same number of operations as the computation of a reduced cost vector. Compared with the operations performed by IPS, this test divides the complexity of the update of 
                           
                              (
                              P
                              ,
                              C
                              ,
                              I
                              )
                           
                         by n − p.

                           Remark 2
                           In practice, the bit representation of floating points implies that the probability of mistakenly identifying a variable as compatible is greater than zero. This case is problematic if a false-compatible variable is positive in the solution of 
                                 
                                    
                                       R
                                       e
                                       d
                                    
                                    ,
                                 
                               because it may result in this solution being outside 
                                 
                                    F
                                    P
                                 
                              . Since the primal feasibility of 
                                 x
                               is an essential assumption for the convergence of Algorithm 2, it is necessary to check that the solution of 
                                 
                                    R
                                    e
                                    d
                                 
                               is in 
                                 
                                    F
                                    P
                                 
                              . If 
                                 
                                    x
                                    ∉
                                    
                                       F
                                       P
                                    
                                    ,
                                 
                               feasibility is recovered by performing a few dual simplex pivots on 
                                 
                                    P
                                    C
                                 
                               with every constraint of 
                                 P
                              .

In steps 4–12 of Algorithm 2, 
                           
                              R
                              e
                              d
                           
                         is solved to optimality, and reduced if needed. An augmentation phase is then executed from step 13 to step 27. Two slightly different augmentation phases may be executed depending on whether or not 
                           
                              R
                              e
                              d
                           
                         has been reduced at step 7 since the last augmentation phase.

Since constraints were removed during the reduction, 
                              
                                 R
                                 e
                                 d
                              
                            includes 
                              
                                 
                                    |
                                    
                                       P
                                       0
                                    
                                    |
                                 
                                 <
                                 m
                              
                            rows. Referring to the test at step 14, the complementary problem 
                              
                                 C
                                 −
                                 G
                                 n
                                 i
                              
                            is then used to select the variables of 
                              I
                            that should be included in 
                              
                                 R
                                 e
                                 d
                              
                           . Since the positive edge criterion is used to identify the compatible variables, 
                              
                                 A
                                 ¯
                              
                            is no longer available to form the reduced complementary problem 
                              
                                 C
                                 r
                                 −
                                 G
                                 n
                                 i
                              
                           . While this implies that the complementary problem may take longer to solve, it also means that 
                              
                                 (
                                 P
                                 ,
                                 C
                                 ,
                                 I
                                 )
                              
                            may be updated before we solve 
                              
                                 C
                                 −
                                 G
                                 n
                                 i
                              
                           . With this update, the following proposition holds.

                              Proposition 4
                              
                                 The solution of
                                 
                                    
                                       C
                                       −
                                       G
                                       n
                                       i
                                    
                                  
                                 at step 19 of 
                                 
                                    Algorithm 2
                                  
                                 provides a feasible improving direction for
                                 
                                    P
                                  
                                 if
                                 
                                    
                                       
                                          z
                                          
                                             
                                                C
                                                −
                                                G
                                                n
                                                i
                                             
                                          
                                          ☆
                                       
                                       <
                                       0
                                       ,
                                    
                                  
                                 or proves that the current solution 
                                 
                                    x
                                  
                                 is optimal if
                                 
                                    
                                       
                                          z
                                          
                                             C
                                             −
                                             G
                                             n
                                             i
                                          
                                          ☆
                                       
                                       =
                                       0
                                    
                                 .

Let 
                                    
                                       (
                                       
                                          P
                                          0
                                       
                                       ,
                                       
                                          C
                                          0
                                       
                                       ,
                                       
                                          I
                                          0
                                       
                                       )
                                    
                                  be the partition computed during the last execution of step 6, 
                                    
                                       (
                                       P
                                       ,
                                       C
                                       ,
                                       I
                                       )
                                    
                                  the partition computed at step 13, and 
                                    
                                       R
                                       −
                                       G
                                       n
                                       i
                                    
                                  and 
                                    
                                       C
                                       −
                                       G
                                       n
                                       i
                                    
                                  the complementary and reduced problems corresponding to 
                                    
                                       (
                                       P
                                       ,
                                       C
                                       ,
                                       I
                                       )
                                    
                                 . 
                                    
                                       P
                                       ⊂
                                       
                                          P
                                          0
                                       
                                       ∪
                                       
                                          C
                                          0
                                       
                                       ,
                                    
                                  so 
                                    
                                       
                                          A
                                          
                                             ·
                                             P
                                          
                                       
                                       ⊂
                                       Span
                                       
                                          (
                                          
                                             A
                                             
                                                ·
                                                
                                                   P
                                                   0
                                                
                                             
                                          
                                          )
                                       
                                    
                                  and 
                                    
                                       C
                                       ⊂
                                       
                                          P
                                          0
                                       
                                       ∪
                                       
                                          C
                                          0
                                       
                                    
                                 . Therefore, (
                                    
                                       R
                                       e
                                       d
                                    
                                  is solved to optimality) 
                                    
                                       ⇒
                                       
                                          z
                                          
                                             R
                                             −
                                             G
                                             n
                                             i
                                          
                                          ☆
                                       
                                       =
                                       0
                                    
                                 . From Theorem 1, it follows that 
                                    
                                       
                                          z
                                          
                                             G
                                             n
                                             i
                                          
                                          ☆
                                       
                                       =
                                       
                                          z
                                          
                                             C
                                             −
                                             G
                                             n
                                             i
                                          
                                          ☆
                                       
                                    
                                 . Proposition 1 then gives the result.□

In IPSO, to avoid spending too much time in the augmentation phase, we solve the complementary problem just once before focusing again on the reduced problem. Assuming that 
                              
                                 
                                    z
                                    
                                       
                                          C
                                          −
                                          G
                                          n
                                          i
                                       
                                    
                                    ☆
                                 
                                 <
                                 0
                                 ,
                              
                            the primal solution of 
                              
                                 C
                                 −
                                 G
                                 n
                                 i
                              
                            then provides an improving feasible direction at 
                              x
                           . Let 
                              
                                 (
                                 
                                    d
                                    P
                                    ☆
                                 
                                 ,
                                 
                                    d
                                    I
                                    ☆
                                 
                                 )
                              
                            be an optimal solution of 
                              
                                 C
                                 −
                                 G
                                 n
                                 i
                              
                           ; we may complete it with zeros to obtain 
                              d
                           
                           ⋆. The solution is then updated via 
                              x
                            ← 
                              x
                            + ρ
                           max  · 
                              d
                           
                           ⋆ for an improvement 
                              
                                 
                                    ρ
                                    max
                                 
                                 
                                    z
                                    
                                       C
                                       −
                                       G
                                       n
                                       i
                                    
                                    ☆
                                 
                              
                            in the objective value, with ρ
                           max  computed as in Proposition 1.

The augmentation itself then relies on the dual solution of 
                              
                                 C
                                 −
                                 G
                                 n
                                 i
                              
                           . Let (
                              π
                           , λ) be the dual variables of 
                              
                                 C
                                 −
                                 G
                                 n
                                 i
                              
                           . The dual of the complementary problem is

                              
                                 
                                    
                                       
                                          (
                                          
                                             C
                                             d
                                             −
                                             G
                                             n
                                             i
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      max
                                                      
                                                         (
                                                         
                                                            π
                                                         
                                                         ,
                                                         λ
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                   λ
                                                
                                             
                                             
                                          
                                          
                                             
                                                s.t.
                                             
                                             
                                                
                                                   
                                                   
                                                      a
                                                      j
                                                      T
                                                   
                                                   
                                                      π
                                                   
                                                   +
                                                   
                                                      w
                                                      j
                                                   
                                                   λ
                                                   ≤
                                                   
                                                      c
                                                      j
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                   ∀
                                                   j
                                                   ∈
                                                   I
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      a
                                                      j
                                                      T
                                                   
                                                   
                                                      π
                                                   
                                                   =
                                                   
                                                      c
                                                      j
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                   ∀
                                                   j
                                                   ∈
                                                   P
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   λ
                                                   ≤
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              Proposition 5
                              
                                 Let (
                                    π
                                 
                                 ⋆, λ
                                 ⋆) be the optimal solution of
                                 
                                    
                                       C
                                       d
                                       −
                                       G
                                       n
                                       i
                                    
                                  
                                 and
                                 
                                    
                                       
                                          I
                                          −
                                       
                                       =
                                       
                                          {
                                          j
                                          ∈
                                          I
                                          :
                                          
                                             c
                                             j
                                          
                                          −
                                          
                                             a
                                             j
                                             T
                                          
                                          
                                             
                                                π
                                             
                                             ☆
                                          
                                          <
                                          0
                                          }
                                       
                                    
                                 . Then
                                 
                                    
                                       1.
                                       
                                          
                                             
                                                
                                                   I
                                                   −
                                                
                                                =
                                                ∅
                                             
                                           if 
                                             
                                                
                                                   z
                                                   
                                                      C
                                                      −
                                                      G
                                                      n
                                                      i
                                                   
                                                   ☆
                                                
                                                ≥
                                                0
                                             
                                          .


                                          
                                             
                                                
                                                   I
                                                   −
                                                
                                                ⊃
                                                
                                                   {
                                                   j
                                                   ∈
                                                   I
                                                   :
                                                   
                                                      d
                                                      j
                                                      ☆
                                                   
                                                   >
                                                   0
                                                   }
                                                
                                                
                                                
                                                   (
                                                   ≠
                                                   ∅
                                                   )
                                                
                                             
                                           if 
                                             
                                                
                                                   z
                                                   
                                                      C
                                                      −
                                                      G
                                                      n
                                                      i
                                                   
                                                   ☆
                                                
                                                <
                                                0
                                             
                                          .

Recall that 
                                    
                                       
                                          w
                                          j
                                       
                                       >
                                       0
                                       ,
                                       ∀
                                       j
                                       ∈
                                       L
                                    
                                 . Since λ is maximized in 
                                    
                                       
                                          C
                                          d
                                          −
                                          G
                                          n
                                          i
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          λ
                                          ☆
                                       
                                       =
                                       
                                          z
                                          
                                             C
                                             −
                                             G
                                             n
                                             i
                                          
                                          ☆
                                       
                                    
                                 . The first set of constraints of 
                                    
                                       C
                                       d
                                       −
                                       G
                                       n
                                       i
                                    
                                  thus implies that 
                                    
                                       
                                          c
                                          j
                                       
                                       −
                                       
                                          a
                                          j
                                          T
                                       
                                       
                                          
                                             π
                                          
                                          ☆
                                       
                                       ≥
                                       
                                          w
                                          j
                                       
                                       
                                          z
                                          
                                             C
                                             −
                                             G
                                             n
                                             i
                                          
                                          ☆
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       ∀
                                       j
                                       ∈
                                       I
                                    
                                 . It follows that 
                                    
                                       
                                          I
                                          −
                                       
                                       =
                                       ∅
                                    
                                  if 
                                    
                                       
                                          z
                                          
                                             C
                                             −
                                             G
                                             n
                                             i
                                          
                                          ☆
                                       
                                       ≥
                                       0
                                    
                                 .

Assume that 
                                    
                                       
                                          z
                                          
                                             C
                                             −
                                             G
                                             n
                                             i
                                          
                                          ☆
                                       
                                       <
                                       0
                                    
                                 . For 
                                    
                                       j
                                       ∈
                                       I
                                    
                                  such that 
                                    
                                       
                                          d
                                          j
                                          *
                                       
                                       >
                                       0
                                       ,
                                    
                                  the complementary slackness ensures that 
                                    
                                       
                                          c
                                          j
                                       
                                       −
                                       
                                          a
                                          j
                                          T
                                       
                                       
                                          π
                                       
                                       =
                                       
                                          w
                                          j
                                       
                                       
                                          z
                                          
                                             C
                                             −
                                             G
                                             n
                                             i
                                          
                                          ☆
                                       
                                       <
                                       0
                                       ,
                                    
                                  so 
                                    
                                       j
                                       ∈
                                       
                                          I
                                          −
                                       
                                    
                                 . As a consequence, 
                                    
                                       
                                          {
                                          j
                                          ∈
                                          I
                                          :
                                          
                                             d
                                             i
                                             ☆
                                          
                                          >
                                          0
                                          }
                                       
                                       ⊂
                                       
                                          I
                                          −
                                       
                                    
                                 .□

The optimal solution of 
                              
                                 C
                                 d
                                 −
                                 G
                                 n
                                 i
                              
                            provides a dual solution of 
                              
                                 P
                                 ,
                              
                            
                           
                              π
                           
                           ⋆, that satisfies the complementarity conditions 
                              
                                 
                                    x
                                    j
                                 
                                 ·
                                 
                                    (
                                    
                                       c
                                       j
                                    
                                    −
                                    
                                       a
                                       j
                                       T
                                    
                                    
                                       π
                                    
                                    )
                                 
                                 =
                                 0
                                 ,
                              
                            
                           j = 1, …, n, and maximizes the minimum normalized reduced cost 
                              
                                 
                                    (
                                    
                                       c
                                       j
                                    
                                    −
                                    
                                       a
                                       j
                                       T
                                    
                                    
                                       π
                                    
                                    )
                                 
                                 /
                                 
                                    w
                                    j
                                 
                                 ,
                              
                            
                           j = 1, …, n. Proposition 5 thus suggests a heuristic augmentation strategy that selects the variables that will potentially lead to the greatest improvements in the objective value. We initialize the columns of 
                              
                                 R
                                 e
                                 d
                              
                            with those indexed by 
                              
                                 
                                    P
                                    0
                                 
                                 ∪
                                 
                                    C
                                    0
                                 
                              
                            at step 7, and we enlarge the problem by including the variables of 
                              
                                 I
                                 −
                              
                            at each augmentation phase. Proposition 5 then ensures that every incompatible variable taking a positive value in the improving direction 
                              d
                           
                           ⋆ is included in 
                              
                                 R
                                 e
                                 d
                              
                           .

One last important issue of this augmentation phase is the update of the rows of 
                              
                                 R
                                 e
                                 d
                              
                           . Since 
                              
                                 I
                                 −
                              
                            may contain a large number of variables, the restriction of 
                              P
                            to the variables indexed by 
                              
                                 P
                                 ∪
                                 C
                                 ∪
                                 
                                    I
                                    −
                                 
                              
                            does not necessarily have redundant constraints. The operations that would be necessary to identify the redundant rows are thus skipped, and all the rows of 
                              P
                            are included in 
                              
                                 R
                                 e
                                 d
                              
                           .

Since every row is added to the reduced problem at the end of an augmentation phase (step 27), 
                              
                                 
                                    |
                                    B
                                    |
                                 
                                 =
                                 m
                              
                           . The test performed at step 14 thus concludes that 
                              
                                 G
                                 n
                                 i
                              
                            will be used to select the variables of 
                              I
                            that should be included in 
                              
                                 R
                                 e
                                 d
                              
                           .

To explain this alternative in Algorithm 2, we denote by 
                              
                                 (
                                 P
                                 ,
                                 C
                                 ,
                                 I
                                 )
                              
                            the partition computed at step 13. Nothing was done during the previous augmentation phase(s) to ensure that the columns compatible with 
                              P
                            were included in 
                              
                                 R
                                 e
                                 d
                              
                           . If the columns indexed by 
                              C
                            are not included in 
                              
                                 
                                    R
                                    e
                                    d
                                 
                                 ,
                              
                            solving Red to optimality does not necessarily imply that 
                              
                                 
                                    z
                                    
                                       R
                                       −
                                       G
                                       n
                                       i
                                    
                                    ☆
                                 
                                 =
                                 0
                                 ,
                              
                            so Proposition 4 does not hold. As a consequence, the complete direction search problem 
                              
                                 G
                                 n
                                 i
                              
                            is solved instead of 
                              
                                 C
                                 −
                                 G
                                 n
                                 i
                              
                           . After we replace 
                              
                                 C
                                 −
                                 G
                                 n
                                 i
                              
                            with 
                              
                                 
                                    G
                                    n
                                    i
                                 
                                 ,
                              
                            
                           Proposition 4 holds and the remainder of the augmentation is unchanged.

Since 
                              
                                 C
                                 −
                                 G
                                 n
                                 i
                              
                            and 
                              
                                 G
                                 n
                                 i
                              
                            play the same role in Algorithm 2, they are both referred to as the complementary problem. This simplifies the presentation and emphasizes the correspondence with the complementary problem of IPS.

As in IPS, 
                           
                              R
                              e
                              d
                           
                         is solved with the primal simplex, and 
                           
                              C
                              −
                              G
                              n
                              i
                           
                         is solved with the dual simplex. An essential point for the efficiency of the overall algorithm is a good dual feasible basic solution to warm-start 
                           
                              C
                              −
                              G
                              n
                              i
                           
                         (or 
                           
                              G
                              n
                              i
                           
                        ). We thus describe how such a basis is computed at steps 16 and 19 of Algorithm 2. In the following discussion, we extend the term basis to the set of indices 
                           B
                         when the corresponding set of columns 
                           
                              A
                              
                                 ·
                                 B
                              
                           
                         is a basis.

                           Proposition 6
                           
                              Let
                              
                                 B
                               
                              be a basis of
                              
                                 
                                    P
                                    ,
                                 
                               
                              
                                 x
                               
                              and
                              
                                 
                                    c
                                    ¯
                                 
                               
                              the corresponding basic solution and reduced cost vector, and
                              
                                 
                                    (
                                    P
                                    ,
                                    C
                                    ,
                                    I
                                    )
                                 
                               
                              the partition corresponding to 
                              
                                 x
                              .

                                 
                                    1.
                                    
                                       Let
                                       
                                          
                                             b
                                             =
                                             
                                                argmin
                                                
                                                   j
                                                   ∈
                                                   L
                                                
                                             
                                             
                                                {
                                                
                                                   
                                                      
                                                         c
                                                         ¯
                                                      
                                                      j
                                                   
                                                   
                                                      w
                                                      j
                                                   
                                                
                                                }
                                             
                                          
                                       ; then
                                       
                                          
                                             B
                                             ∪
                                             {
                                             b
                                             }
                                          
                                        
                                       is a dual feasible basis of
                                       
                                          
                                             G
                                             n
                                             i
                                          
                                        
                                       whose objective value is
                                       
                                          
                                             
                                                z
                                                
                                                   G
                                                   n
                                                   i
                                                
                                             
                                             =
                                             
                                                min
                                                
                                                   j
                                                   ∈
                                                   L
                                                
                                             
                                             
                                                {
                                                
                                                   
                                                      
                                                         c
                                                         ¯
                                                      
                                                      j
                                                   
                                                   
                                                      w
                                                      j
                                                   
                                                
                                                }
                                             
                                          
                                       .


                                       Let
                                       
                                          
                                             
                                                b
                                                I
                                             
                                             =
                                             
                                                argmin
                                                
                                                   j
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                {
                                                
                                                   
                                                      
                                                         c
                                                         ¯
                                                      
                                                      j
                                                   
                                                   
                                                      w
                                                      j
                                                   
                                                
                                                }
                                             
                                          
                                       ; then
                                       
                                          
                                             B
                                             ∪
                                             {
                                             
                                                b
                                                I
                                             
                                             }
                                          
                                        
                                       is a dual feasible basis of
                                       
                                          
                                             C
                                             −
                                             G
                                             n
                                             i
                                          
                                        
                                       whose objective value is
                                       
                                          
                                             
                                                z
                                                
                                                   C
                                                   −
                                                   G
                                                   n
                                                   i
                                                
                                             
                                             =
                                             
                                                min
                                                
                                                   j
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                {
                                                
                                                   
                                                      
                                                         c
                                                         ¯
                                                      
                                                      j
                                                   
                                                   
                                                      w
                                                      j
                                                   
                                                
                                                }
                                             
                                          
                                       .

A proof of the second point is given in Omer et al. (2014); it can easily be adapted to show the first point.□

At step 16 of Algorithm 2, 
                           
                              R
                              e
                              d
                           
                         has m rows, so its optimal basis is also a basis of 
                           
                              P
                              ,
                           
                         hence Proposition 6 shows that 
                           
                              B
                              ∪
                              {
                              b
                              }
                           
                         can be used to warm-start 
                           
                              G
                              n
                              i
                           
                        . If 
                           
                              R
                              e
                              d
                           
                         contains 
                           
                              
                                 |
                                 
                                    P
                                    0
                                 
                                 |
                              
                              =
                              
                                 p
                                 0
                              
                           
                         rows, its optimal basis, 
                           
                              
                                 B
                                 0
                              
                              ,
                           
                         must be completed with m − p
                        0 columns to form a basis of 
                           P
                        . In IPS, 
                           
                              B
                              0
                           
                         is completed with m − p
                        0 vectors of the canonical basis of 
                           
                              R
                              m
                           
                         to form a basis 
                           
                              B
                              1
                           
                         of 
                           P
                        . This corresponds to adding slack variables to 
                           P
                         and enforcing zero lower and upper bounds. These slack variables are systematically added by CPLEX, so no additional operation is required in our implementation. The dual feasible basis 
                           
                              
                                 B
                                 1
                                 D
                              
                              =
                              
                                 B
                                 1
                              
                              ∪
                              
                                 {
                                 
                                    b
                                    I
                                 
                                 }
                              
                           
                         is then a valid candidate to warm-start 
                           
                              C
                              −
                              G
                              n
                              i
                           
                        .

The basis 
                           
                              B
                              1
                              D
                           
                         represents a neutral but poor initial guess for 
                           
                              C
                              −
                              G
                              n
                              i
                           
                         since it reflects only the dual information gathered when solving 
                           
                              R
                              e
                              d
                           
                        . In particular, the dual solution does not take into account the rows indexed by 
                           
                              P
                              ¯
                           
                        . Another completion is thus considered.

                           Proposition 7
                           
                              Let
                              
                                 B
                               
                              be a feasible basis of
                              
                                 P
                               
                              and
                              
                                 
                                    (
                                    P
                                    ,
                                    C
                                    ,
                                    I
                                    )
                                 
                               
                              be the partition associated with the corresponding basic solution. Let
                              
                                 
                                    A
                                    
                                       ·
                                       
                                          B
                                          0
                                       
                                    
                                 
                               
                              be a set of independent columns spanning
                              
                                 
                                    
                                       A
                                       
                                          ·
                                          P
                                       
                                    
                                    ,
                                 
                               
                              and let
                              
                                 
                                    
                                       P
                                       ¯
                                    
                                    =
                                    B
                                    ∖
                                    P
                                 
                              . Then
                              
                                 
                                    A
                                    
                                       ·
                                       
                                          B
                                          0
                                       
                                       ∪
                                       
                                          P
                                          ¯
                                       
                                    
                                 
                               
                              is a basis of
                              
                                 
                                    R
                                    m
                                 
                              . Moreover, if
                              
                                 
                                    B
                                    0
                                 
                               
                              is a feasible basis of
                              
                                 
                                    
                                       P
                                       
                                          C
                                          0
                                       
                                    
                                    ,
                                 
                               
                              then
                              
                                 
                                    
                                       B
                                       0
                                    
                                    ∪
                                    
                                       P
                                       ¯
                                    
                                 
                               
                              is a feasible basis of
                              
                                 P
                              .


                              
                                 
                                    A
                                    
                                       ·
                                       B
                                    
                                 
                               is a basis of 
                                 
                                    
                                       R
                                       m
                                    
                                    ,
                                 
                               so 
                                 
                                    Span
                                    
                                       (
                                       
                                          A
                                          
                                             ·
                                             P
                                          
                                       
                                       )
                                    
                                    ⊕
                                    Span
                                    
                                       (
                                       
                                          A
                                          
                                             ·
                                             
                                                P
                                                ¯
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       R
                                       m
                                    
                                    ,
                                 
                               which implies that 
                                 
                                    A
                                    
                                       ·
                                       
                                          B
                                          0
                                       
                                       ∪
                                       
                                          P
                                          ¯
                                       
                                    
                                 
                               is a basis of 
                                 
                                    R
                                    m
                                 
                              .

If 
                                 
                                    B
                                    0
                                 
                               is a feasible basis of 
                                 
                                    
                                       P
                                       
                                          C
                                          0
                                       
                                    
                                    ,
                                 
                               then 
                                 
                                    b
                                    =
                                    
                                       A
                                       
                                          ·
                                          
                                             B
                                             0
                                          
                                       
                                    
                                    
                                       x
                                       
                                          B
                                          0
                                       
                                    
                                 
                               with 
                                 
                                    
                                       x
                                       
                                          B
                                          0
                                       
                                    
                                    ≥
                                    0
                                 
                              . As a consequence, any completion of 
                                 
                                    B
                                    0
                                 
                               is a feasible basis of 
                                 P
                              .□

Since Algorithm 2 starts with a basic feasible solution, a complete basis 
                           B
                         of 
                           P
                         is always known. At step 19, a completion of 
                           B
                         based on Proposition 7 is thus possible. Let 
                           
                              B
                              2
                           
                         be this basis of 
                           
                              P
                              ,
                           
                         and 
                           
                              
                                 B
                                 2
                                 D
                              
                              =
                              
                                 B
                                 2
                              
                              ∪
                              
                                 {
                                 
                                    b
                                    I
                                 
                                 }
                              
                           
                        . Then 
                           
                              B
                              1
                              D
                           
                         and 
                           
                              B
                              2
                              D
                           
                         are two valid candidates to warm-start 
                           
                              C
                              −
                              G
                              n
                              i
                           
                        . Since 
                           
                              C
                              d
                              −
                              G
                              n
                              i
                           
                         is a maximization problem, the basic solution with the higher objective value is chosen.

As for the complementary problem, it is important to start solving 
                           
                              R
                              e
                              d
                           
                         with a basis corresponding to the current solution. We must therefore find a basis corresponding to the updated solution after the augmentation (step 28).

                           Proposition 8
                           
                              Assume that
                              
                                 P
                               
                              is bounded and that the current solution 
                              
                                 x
                               
                              at step 13 is not optimal. Let
                              
                                 
                                    B
                                    ☆
                                 
                               
                              and 
                              
                                 d
                              
                              ⋆ 
                              be the optimal basis and solution of the complementary problem, and
                              
                                 
                                    b
                                    ∈
                                    {
                                    j
                                    ∈
                                    P
                                    :
                                    
                                       x
                                       j
                                    
                                    +
                                    
                                       ρ
                                       max
                                    
                                    
                                       
                                          d
                                       
                                       j
                                       ☆
                                    
                                    =
                                    0
                                    }
                                 
                              . Then
                              
                                 
                                    B
                                    =
                                    
                                       B
                                       ☆
                                    
                                    ∖
                                    
                                       {
                                       b
                                       }
                                    
                                 
                               
                              is a feasible basis of
                              
                                 P
                               
                              and the corresponding basic solution is 
                              
                                 x
                               + ρ
                              max 
                              
                                 d
                              
                              ⋆.

According to Proposition 1, 
                                 x
                               is not optimal implies that 
                                 d
                              
                              ⋆ ≠ 
                                 0
                               and 
                                 P
                               bounded implies that ρ
                              max  < +∞, which shows that 
                                 
                                    {
                                    j
                                    ∈
                                    P
                                    :
                                    
                                       x
                                       j
                                    
                                    +
                                    
                                       ρ
                                       max
                                    
                                    
                                       
                                          d
                                       
                                       j
                                       ☆
                                    
                                    =
                                    0
                                    }
                                 
                               is not empty. Next, 
                                 d
                              
                              ⋆ is the basic solution of 
                                 
                                    G
                                    n
                                    i
                                 
                               associated with 
                                 
                                    
                                       B
                                       ☆
                                    
                                    ,
                                 
                               so 
                                 
                                    
                                       A
                                       
                                          ·
                                          
                                             B
                                             ☆
                                          
                                       
                                    
                                    
                                       d
                                       ☆
                                    
                                    =
                                    0
                                    ,
                                 
                               and 
                                 
                                    
                                       A
                                       
                                          ·
                                          B
                                       
                                    
                                    
                                       
                                          d
                                       
                                       B
                                       ☆
                                    
                                    =
                                    −
                                    
                                       d
                                       b
                                       ☆
                                    
                                    
                                       a
                                       b
                                    
                                 
                              . Since db
                               ≠ 0, 
                                 
                                    
                                       a
                                       b
                                    
                                    ∈
                                    Span
                                    
                                       (
                                       
                                          A
                                          
                                             ·
                                             B
                                          
                                       
                                       )
                                    
                                 
                               and the rank of 
                                 
                                    A
                                    
                                       ·
                                       B
                                    
                                 
                               and 
                                 
                                    A
                                    
                                       ·
                                       
                                          B
                                          ☆
                                       
                                    
                                 
                               are the same. Moreover, 
                                 
                                    A
                                    
                                       ·
                                       
                                          B
                                          ☆
                                       
                                    
                                 
                               is obtained by removing one row from the basic matrix of 
                                 
                                    
                                       G
                                       n
                                       i
                                    
                                    ,
                                 
                               whose rank is equal to m + 1, so the ranks of 
                                 
                                    A
                                    
                                       ·
                                       
                                          B
                                          ☆
                                       
                                    
                                 
                               and 
                                 
                                    A
                                    
                                       ·
                                       B
                                    
                                 
                               are equal to m. As a consequence, 
                                 B
                               is a basis of 
                                 P
                              .

To see that 
                                 x
                               + ρ
                              max 
                              
                                 d
                              
                              ⋆ is the corresponding basic solution, first recall that the initial basis of 
                                 
                                    G
                                    n
                                    i
                                 
                               includes 
                                 P
                               and that the variables of 
                                 
                                    d
                                    P
                                 
                               are unbounded. These variables cannot be chosen as the exiting variable in a dual pivot and thus remain in the basis until optimality, so 
                                 
                                    
                                       B
                                       ☆
                                    
                                    ⊃
                                    
                                       {
                                       j
                                       :
                                       
                                          x
                                          j
                                       
                                       >
                                       0
                                       }
                                    
                                    ∪
                                    
                                       {
                                       j
                                       :
                                       
                                          d
                                          j
                                          ☆
                                       
                                       ≠
                                       0
                                       }
                                    
                                 
                              . As a consequence, 
                                 
                                    
                                       A
                                       
                                          ·
                                          B
                                       
                                    
                                    
                                       (
                                       x
                                       +
                                       
                                          ρ
                                          max
                                       
                                       
                                          d
                                          B
                                          ☆
                                       
                                       )
                                    
                                    =
                                    b
                                    +
                                    
                                       0
                                    
                                 
                               and 
                                 
                                    B
                                    ⊃
                                    {
                                    j
                                    :
                                    
                                       x
                                       j
                                    
                                    +
                                    
                                       ρ
                                       max
                                    
                                    
                                       d
                                       j
                                       ☆
                                    
                                    >
                                    0
                                    }
                                    ,
                                 
                               which completes the proof.□

With this last proposition, it is finally possible to address the convergence of the overall algorithm.

                           Theorem 2
                           Let 
                                 P
                               be a feasible LP. Assuming that the primal and dual simplex are finite, Algorithm 2 is finite and returns either an optimal solution of 
                                 P
                               if it is bounded, or an optimal ray if it is unbounded.

If Algorithm 2 is finite, it either ends because 
                                 
                                    R
                                    e
                                    d
                                 
                               is found to be unbounded, or because the optimal solution of 
                                 
                                    G
                                    n
                                    i
                                 
                               satisfies either 
                                 
                                    
                                       z
                                       
                                          G
                                          n
                                          i
                                       
                                       ☆
                                    
                                    =
                                    0
                                 
                               or 
                                 d
                              
                              ⋆ ≥ 
                                 0
                              . If an optimal ray of 
                                 
                                    R
                                    e
                                    d
                                 
                               is found, it can be completed with zeros to form an optimal ray of 
                                 P
                              . Otherwise, let 
                                 x
                              
                              ⋆ be the result of the algorithm. If 
                                 
                                    
                                       z
                                       
                                          G
                                          n
                                          i
                                       
                                       ☆
                                    
                                    =
                                    0
                                 
                               or 
                                 d
                              
                              ⋆ ≥ 
                                 0
                              , Proposition 1 ensures that 
                                 x
                              
                              ⋆ is respectively an optimal solution or an optimal ray of 
                                 P
                              .

To prove that the algorithm is finite, we first notice that each step is finite if the primal and dual simplex are assumed to be finite. For the same reason, the loop covering steps 4 –12 eventually end with an optimal solution of 
                                 
                                    
                                       R
                                       e
                                       d
                                    
                                    ,
                                 
                               so the algorithm performs finite major iterations starting at step 4 and ending at step 27. Let 
                                 x
                               be the current solution before solving 
                                 
                                    C
                                    −
                                    G
                                    n
                                    i
                                 
                               or 
                                 
                                    G
                                    n
                                    i
                                 
                              ; Proposition 4 shows that if 
                                 x
                               is not optimal, then 
                                 d
                              
                              ⋆ is an improving feasible direction. Moreover, Proposition 8 ensures that 
                                 x
                               + ρ
                              max  · 
                                 d
                              
                              ⋆ is a basic solution of 
                                 P
                              . As a consequence, each major iteration ends with a basic feasible solution providing a strict improvement in the objective value. Since the number of basic solutions is finite, so is Algorithm 2.□

In this section, we evaluate IPSO by comparing it to the primal simplex of CPLEX 12.4. The pricing criterion is systematically set to an approximate version of the steepest edge described by Goldfarb and Reid (1977) (CPX_PARAM_PRIIND=3), because it has similar performance to that of the automatic default pricing of CPLEX but allows for a consistent analysis of the results (see Omer et al., 2014). The other CPLEX parameters are set to their default values. We finally compare the performance of IPSO with that of IPS and with that reported by Towhidi et al. (2014) for the primal simplex with the positive edge pricing criterion.

The tests are all performed on an OpenSuse operating system with an Intel(R) Core(TM) i7-3770 CPU @ 3.40 gigahertz processor, and all the LPs, including 
                        
                           
                              R
                              e
                              d
                           
                           
                           ,
                        
                     
                     
                        
                           
                              C
                              −
                              G
                              n
                              i
                           
                           ,
                        
                      and 
                        
                           
                              C
                              r
                              −
                              G
                              n
                              i
                           
                           ,
                        
                      are solved with the simplex of CPLEX. The initial basic feasible solutions used by every algorithm are obtained by the primal simplex phase I of CPLEX. We set the time limit to 10 hours for every tested algorithm.

Unless otherwise specified, CPLEX refers to the primal simplex of the LP solver in the rest of the article.

In their analysis of the performance of IPS, Omer et al. (2014) emphasize that the algorithm was designed with some particular classes of highly degenerate problems in mind. It would be unrealistic to expect that it would achieve the impressive performance described in Elhallaoui et al. (2011); Raymond, Soumis, and Orban (2010) on every LP. Omer et al. (2014) identify three major reasons that IPS may not perform well on some instances. The first two relate to degeneracy. If only a few simplex pivots are degenerate (
                           
                              <
                              30
                              
                              percent
                           
                        ), then interrupting the primal simplex may be counterproductive. Otherwise, if only a few variables are degenerate (
                           
                              <
                              20
                           
                         percent), then reducing 
                           
                              P
                              
                           
                         is unlikely to lead to a faster solution of the problem. Moreover, after a reduction of 
                           
                              
                                 R
                                 e
                                 d
                              
                              ,
                           
                         the problem contains only the positive and compatible variables. If 
                           
                              R
                              e
                              d
                           
                         contains only a few compatible variables, it is again likely that the whole process of dynamic reduction will not be advantageous. Referring to Omer et al. (2014), IPS does not perform well when 
                           
                              
                                 |
                                 
                                    C
                                    0
                                 
                                 |
                              
                              ≤
                              0.5
                              
                                 |
                                 
                                    P
                                    0
                                 
                                 |
                              
                           
                        . In IPS, identifying 
                           C
                         is time-consuming, but this is not the case if the positive edge criterion is used. As a consequence, one important contribution of IPSO is that we can test its potential for improvement in advance.

In practice, Algorithm 3 is run before Algorithm 2 to take into consideration the conclusions of Omer et al. (2014). This algorithm iteratively tests the potential of IPSO and perform simplex pivots on 
                           P
                         until the potential of IPSO is shown or optimality is reached. A few pivots are done before the first time that the numbers of degenerate and compatible variables are tested to estimate the percentage of degenerate pivots. The maximum number of pivots M is then increased after each interruption of the simplex to limit the number of these interruptions when the tests are unsuccessful.

If Algorithm 3 reaches step 14, IPSO will potentially improve the primal simplex, so the current solution 
                           x
                        
                        0 is used to initialize 
                           x
                         at step 2 of Algorithm 2. Otherwise, the complete solution of the problem is done in Algorithm 3 with primal simplex pivots on 
                           P
                        . In the latter case, the difference with an ordinary execution of the primal simplex is that the algorithm is interrupted a limited number of times to make unsuccessful tests. The only costly operation in the tests of Algorithm 3 is the identification of the compatible variables when building the partition 
                           
                              (
                              
                                 P
                                 0
                              
                              ,
                              
                                 C
                                 0
                              
                              ,
                              
                                 I
                                 0
                              
                              )
                           
                        . As is stated in Section 3.1, this requires a similar number of operations as computing the reduced costs, so the complexity of the tests is the same as that of a simplex pivot. For a very small computational cost, Algorithm 3 may thus prevent from starting the dynamic reduction of IPSO on instances that should be solved more efficiently with the primal simplex.

Another improvement ensures that IPSO performs well on highly degenerate LPs with only a few compatible variables. When the number of compatible variables is not sufficient to start IPSO, but the simplex performs a large number of degenerate pivots, it is interrupted every time it remains stuck on the same vertex for more than some large number of pivots. No reduction is done, but 
                           
                              G
                              n
                              i
                           
                         is then solved to find a feasible improving direction. In our tests, this process is triggered when more than 95 percent degenerate pivots are performed overall and the objective value stalls for more than 1000 pivots.

The benchmark includes the VCS, UBFA, and UFL instances used in Omer et al. (2014), and 45 instances of Mittelmann’s benchmark
                           3
                        
                        
                           3
                           These instances are available online: http://plato.asu.edu/ftp/lpcom.html
 (last visited on 14.01.15).
                        . For Mittelmann’s benchmark, we exclude only two instances that take less than 1 second to solve. As in Omer et al. (2014), we added the dual formulation of four LPs (neos1, neos2, neos3, rlfprim) whose number of constraints is much larger than the number of variables. The characteristics of the benchmark appear in Table 1
                        , which includes the dimensions (n × m) and the density (ρ
                        
                           
                              A
                           
                        ) of 
                           A
                        , and the main statistics for the phase II of the primal simplex of CPLEX, i.e., the number of pivots (piv), the percentage of degenerate pivots (degen piv), and the computational time (cpu). The CPLEX statistics result from two separate optimization runs for each model: the number of pivots and the total runtime are obtained with the default options, but the perturbations had to be disabled to compute the fraction of degenerate pivots. The column “phase I” indicates how much time is spent in phase I to find an initial feasible solution. Since the time and pivots spent in this phase I are common to every algorithm, they are excluded from the subsequent comparisons.

In our first evaluation of IPSO we present detailed statistics on its execution and compare it with the primal simplex of CPLEX. The tests described in Algorithm 3 are performed before starting the dynamic reduction. The results of the instances solved with the dynamic reduction are reported in Table 2
                        . The instances that are not degenerate enough or have too few compatible variables appear in Table 3
                        . In both tables, we do not report the time spent in testing the potential of IPSO, because it is negligible compared to the solution times of IPSO and CPLEX.

We first focus on Table 2, where “aug” is the number of augmentation phases, and 
                           
                              
                                 m
                                 −
                                 p
                              
                              m
                           
                         and 
                           
                              
                                 |
                                 C
                                 |
                              
                              
                                 |
                                 P
                                 |
                              
                           
                         are the average percentages of degenerate and compatible variables. The next four columns detail the time spent and the numbers of pivots performed when solving the reduced and the complementary problems. The remaining runtime is that spent in identifying the compatible variables and the redundant constraints of 
                           
                              P
                              C
                           
                        ; we do not report it in Table 2, because it is negligible when compared to the solution time of the reduced and complementary problems. The last two columns contain the ratios of the total number of pivots and runtime of CPLEX relative to those of IPSO, thus indicating improvement factors. The cpu improvement column shows that IPSO significantly (
                           ≥
                        30 percent) outperforms CPLEX on 33 of 38 instances while CPLEX never outperforms IPSO, which means that Algorithm 3 successfully filters out the unfavorable cases. Moreover, IPSO divided the computational time by a factor larger than two on all the VCS and UBFA instances and on nine Mittelmann instances. Most of the computational time was spent in the reduced problem, which is consistent with the fact that only one complementary problem is solved at each augmentation phase. Finally, the six instances buildingen, neos1, neos2, neos3’, rlfprim’, and stat96v1 have very low 
                           
                              
                                 
                                    |
                                    C
                                    |
                                 
                                 
                                    |
                                    P
                                    |
                                 
                              
                              ,
                           
                         so 
                           P
                         is never reduced during the solution with IPSO. The improvement in runtime is achieved by solving one or more complementary problems to find improving feasible directions, as described in Section 4.1.


                        Table 3 details the degeneracy and compatibility values when the tests in Algorithm 3 are not successful. The instances are organized according to the test that fails, and we report the highest observed values. IPS and IPSO are designed to take advantage of degeneracy, so it seems logical that the first 12 instances should not be tested. On the other hand, when solving the last ten instances, the primal simplex struggles with degeneracy, and the number of degenerate variables would allow for an advantageous reduction of 
                           P
                        . IPSO was thus executed without testing the number of compatible variables to evaluate the relevance of the chosen threshold. For eight instances out of ten, IPSO is outperformed by CPLEX although the improvement factor is significant in only five cases. This shows that the decomposition based on compatibility does not allow us to take advantage of degeneracy for every degenerate LP (only 21 of 34 degenerate Mittelmann instances), but it is possible to test the potential efficiency of IPSO before starting the dynamic reduction. Moreover, this test is fast, since the positive edge criterion allows us to find the number of compatible variables within a computational time that compares to that of a simplex pivot. As a consequence, the algorithm could be used as an adaptive strategy integrated in an efficient primal simplex.

For a more general view on the available LP solvers, we compared IPSO and the primal simplex of CPLEX with the barrier and dual simplex algorithms of CPLEX. These comparisons focus on the solution times from scratch. The results show that the dual simplex and the barrier algorithm respectively outperform IPSO by an average 1.55 and 2.15 factor, whereas they outperform the primal simplex by an average 2.90 and 4.10 factor. Even though IPSO is clearly more competitive than the primal simplex, the improvement is not sufficient to make it the most efficient algorithm when solving an LP from scratch. Despite this, IPSO provides the best solution time for 10 percent of the instances, whereas the primal simplex outperforms the other three algorithms for only one instance. IPSO may then be useful as one of the concurrent methods used in the default behavior of CPLEX. Moreover, as highlighted in the introduction, the main benefit of the primal simplex is that it can be used to efficiently optimize an LP when a good feasible solution is available, so IPSO should be the best option in a large number of such situations.

In this section we compare IPSO with the latest version of IPS described in Omer et al. (2014) and with the results reported by Towhidi et al. (2014) for the primal simplex of CLP including the positive edge pricing criterion (PE).


                        Table 4 gives the computational time spent identifying the compatible variables (“
                           PCI
                        ”) and solving the reduced problems (“
                           
                              R
                              e
                              d
                           
                        ”) and the complementary problem (“
                           
                              C
                              r
                              −
                              G
                              n
                              i
                           
                        ”) during the execution of IPS, and total runtime of IPS (“total”). The last three columns give the cpu improvement of IPS, IPSO, and PE (when available in Towhidi et al. (2014)). The cpu improvement of IPS and IPSO are the ratios of the runtime of the primal simplex of CPLEX relative to those of IPS and IPSO, respectively. The cpu improvement of PE is the ratio of the runtime of CLP’s primal simplex relative to that of PE. In our tests IPS is started from the same phase I feasible solution as IPSO, whereas PE uses a different solution generated by CLP in Towhidi et al. (2014). Only the Mittelmann instances with sufficient degeneracy are included, and they are divided into two different groups depending on whether or not the compatibility test fails (
                           
                              
                                 
                                    |
                                    C
                                    |
                                 
                                 
                                    |
                                    P
                                    |
                                 
                              
                              <
                              50
                           
                         percent). The instances are then organized by increasing number of rows.

The improvement factors show that IPS and IPSO have similar performance on the VCS and UFL problems. IPS outperforms IPSO on the UBFA instances, but the improvement factors are still high. Focusing on the first group of Mittelmann instances, IPS matches the performance of IPSO in four of sixteen cases but is significantly outperformed in the other twelve cases. Moreover, IPS experiences serious difficulties on the largest instances, while there is no obvious correlation between the performance of IPSO and the size of the instance. To explain the difficulties of IPS, we observe that the identification of compatible variables alone takes more time than the complete solution by CPLEX for buildingen, dbic1, neos3, pds-100, storm_125, storm_1000, watson_1, and watson_2. Moreover, 
                           
                              C
                              r
                              −
                              G
                              n
                              i
                           
                         must be solved a large number of times during the augmentation phases to select a significant number of incompatible variables. Finally, IPS does not perform better on the instances that would fail the compatibility test, but this test is time-consuming if 
                           
                              A
                              ¯
                           
                         has to be computed.


                        Towhidi et al. (2014) use the positive edge criterion as a pricing criterion to select the compatible variables. More precisely, if 
                           
                              
                                 j
                                 C
                              
                              =
                              argmin
                              
                                 {
                                 
                                    
                                       c
                                       ¯
                                    
                                    j
                                 
                                 :
                                 j
                                 ∈
                                 C
                                 }
                              
                           
                         and 
                           
                              
                                 j
                                 I
                              
                              =
                              argmin
                              
                                 {
                                 
                                    
                                       c
                                       ¯
                                    
                                    j
                                 
                                 :
                                 j
                                 ∈
                                 I
                                 }
                              
                              ,
                           
                         the entering variable is 
                           
                              x
                              
                                 j
                                 C
                              
                           
                         if 
                           
                              
                                 
                                    c
                                    ¯
                                 
                                 
                                    j
                                    C
                                 
                              
                              <
                              ψ
                              
                                 
                                    c
                                    ¯
                                 
                                 
                                    j
                                    I
                                 
                              
                           
                         and 
                           
                              x
                              
                                 j
                                 I
                              
                           
                         otherwise (0 < ψ < 1). They thus use the concept of compatibility to reduce the number of degenerate steps, but they do not take advantage of degeneracy by removing constraints from the LP. The comparison with PE is presented simply to indicate global trends, because the available data is partial and, more importantly, because the improvement factors of PE refer to CLP. Nevertheless, if we focus on the instances that satisfy the compatibility test, we see that IPSO’s improvement factors range from two to six for rail4284, neos1, neos2, and watson-2 whereas PE fails to improve the computational time of CLP. For rail4284 and watson-2, the success of IPSO is due to the reduction of 
                           
                              P
                              ,
                           
                         but for neos1 and neos2, solving 
                           
                              G
                              n
                              i
                           
                         to find improving feasible directions makes the difference. On the other hand, PE clearly outperforms IPSO on all the instances that failed the compatibility test. In these cases, the advantage of PE is its flexibility. In contrast with IPSO, it does not exclusively focus on the compatible variables and does not need to rely on a heuristic augmentation phase. PE selects a compatible variable when its reduced cost is negative enough and an incompatible variable otherwise.

@&#CONCLUSION@&#

The improved primal simplex (IPS) is a dynamic constraint reduction algorithm that takes advantage of degeneracy in LPs. Among the pitfalls that remain to be addressed are the costly matrix product performed when identifying the compatible variables, and the numerous solutions of the complementary problem at each augmentation phase. In this work, we introduce two major modifications to overcome these pitfalls. The first is the use of the positive edge criterion (Raymond, Soumis, Metrane et al., 2010) as a fast stochastic compatibility test. This test allows for a fast reduction of the LP during the solution process, and it also offers an opportunity to rapidly test the potential performance of our method prior to starting it. The second is the revision of the whole augmentation phase to focus on a complementary problem involving the original coefficients of the matrix, which is solved only once per phase. We also describe how to build good dual and primal feasible bases to warm-start respectively the complementary and the reduced problems. The resulting algorithm, referred to as IPSO, is evaluated on a benchmark including 45 Mittelmann instances. This evaluation shows that the preemptive test efficiently identifies the instances that have a limited potential for improvement with IPSO. When this test is successful, IPSO outperforms the primal simplex of CPLEX on all but five instances, and improvement factors greater than two are found in 20 of 38 cases. IPSO also outperforms IPS on all but two Mittelmann instances. To be specific, IPS has difficulties on the largest Mittelmann instances, whereas the improvement factor of IPSO is not correlated to the size of the instance. Finally, the comparison with the PE that Towhidi et al. (2014) implemented in the primal simplex of COIN-OR’s CLP offers important insight into future improvements of the algorithm. The reduction of the number of constraints is clearly an advantage of IPSO when there is a large number of compatible variables. On the other hand, the possibility of considering incompatible variables when the compatible variables do not have good reduced costs allows PE to perform well on every highly degenerate LP of Mittelmann’s benchmark.

In future work, we will look into the possibility of a hybrid procedure combining IPSO and PE in COIN-OR’s CLP. Although the primal simplex of CLP is not as fast as that of CPLEX, it has the great advantage of being an open code. The algorithm could then be implemented as an internal procedure, and the analysis would take advantage of the availability of the code. Another possibility is to extend the algorithm to the simplex phase I with a method similar to that of Pan and Pan (2001). It would also be interesting to investigate a dual version of IPSO. Pan (2005) takes advantage of primal degeneracy in a dual algorithm, but he does not treat dual degeneracy. Finally, another decomposition algorithm (Gleixner, 2012) reduces the size of the basis by giving special treatment to slack variables. A study of the interaction of IPSO with this decomposition could lead to additional improvements of the primal simplex.

@&#REFERENCES@&#

