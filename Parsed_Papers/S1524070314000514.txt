@&#MAIN-TITLE@&#Structure-aligned guidance estimation in surface parameterization using eigenfunction-based cross field

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present an eigenfunction-based method for surface parameterization.


                        
                        
                           
                           The generated parametric lines are aligned with mutliscale structural features.


                        
                        
                           
                           A new anisotropic parameterization scheme is presented.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Surface parameterization

Eigenfunctions

Multi-scale features

Anisotropic parameterization

Cross field

@&#ABSTRACT@&#


               
               
                  In this paper, we present a structure-aligned approach for surface parameterization using eigenfunctions from the Laplace–Beltrami operator. Several methods are designed to combine multiple eigenfunctions using isocontours or characteristic values of the eigenfunctions. The combined gradient information of eigenfunctions is then used as a guidance for the cross field construction. Finally, a global parameterization is computed on the surface, with an anisotropy enabled by adapting the cross field to non-uniform parametric line spacings. By combining the gradient information from different eigenfunctions, the generated parametric lines are automatically aligned with the structural features at various scales, and they are insensitive to local detailed features on the surface when low-mode eigenfunctions are used.
               
            

@&#INTRODUCTION@&#

Surface parameterization is of great importance for many applications, such as quadrilateral meshing [1], texture mapping and synthesis [2,3]. An important issue for surface parameterization is how to align parametric lines with the feature directions. Some simplification techniques [4–6] were developed to generate very coarse domain meshes with a good user control. Although feature alignment was achieved in a certain degree [4], it is difficult to control the simplification process to preserve surface features. Using the harmonic field [7,8], features can be captured, but feature alignment is limited due to the difficulty in generating the field and placing singularities. In recent years, methods based on the cross field have been introduced [7,9–12]. Generally, the captured features in the cross field are represented by the principal curvatures, which are sensitive to the local detailed features and may fail in capturing structural features of an object at desired scales.

Eigenfunctions of the Laplace–Beltrami operator (LBO) are well-known for their property of capturing the shape behavior and structural feature of an object [13–16]. Eigenfunctions with respect to different eigenvalues reflect structural features at different scales, which has been utilized in surface segmentation and reconstruction [14,17]. The eigenfunctions vary along the object surface and are invariant to different poses, which makes them ideal for describing the structural feature of the object. A variety of applications have been introduced taking the advantages of eigenfunctions, such as pose-invariant Reeb graph [16], shape matching [13] or registration [18], and the Shape-DNA [15]. Another important application of eigenfunctions is surface quadrangulation or parameterization [19]. For example, the Morse-Smale complexes [20–22] were built by connecting the saddle and extrema of eigenfunctions, dividing the surface into several coarse quadrilateral patches. Despite of these developments, feature alignment is still a challenging problem in surface parameterization.

In this paper, we introduce a novel method to define a guidance for cross field generation using eigenfunctions, and generate a structure-aligned parameterization for the input triangle mesh. A guidance is first constructed using the gradient of multiple eigenfunctions of the LBO to capture the structural feature at various scales. Then a smooth cross field is built following the guidance, based on which a surface parameterization is computed. The main contributions of our work include:
                        
                           1.
                           A novel structure-aligned approach is developed for surface parameterization using eigenfunctions, which is insensitive to local detailed surface features.

Multiscale structural features are captured using the gradient of multiple eigenfunctions as a guidance for cross field generation.

A new algorithm is introduced to enable anisotropy in the parameterization by adapting the cross field to non-uniform parametric line spacings.

The remainder of the paper is organized as follows. Section 2 describes eigenfunctions. Section 3 explains how to define the guidance for cross field construction using the gradient of multiple eigenfunctions. Section 4 discusses cross field construction and surface parameterization. Section 5 shows some results. Finally, Section 6 draws conclusions and points out future work.

Given a 
                        
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                        
                      smooth surface S, the eigenproblem of LBO is to find the eigenvalues 
                        
                           λ
                        
                      and their corresponding eigenfunctions f defined on it, such that
                        
                           (1)
                           
                              -
                              
                                 
                                    Δ
                                 
                                 
                                    S
                                 
                              
                              f
                              =
                              λ
                              f
                              ,
                           
                        
                     where 
                        
                           
                              
                                 Δ
                              
                              
                                 S
                              
                           
                        
                      is the LBO defined on surface S. Since 
                        
                           -
                           
                              
                                 Δ
                              
                              
                                 S
                              
                           
                        
                      is a self-adjoint and semi-positive definite operator, the eigenvalues of 
                        
                           -
                           
                              
                                 Δ
                              
                              
                                 S
                              
                           
                        
                      are real and nonnegative. Eigenfunctions of the LBO provide a set of convenient basis to describe the shape behavior or structural feature of an object. Let M be a triangulation of surface 
                        
                           S
                           ,
                           
                           
                              
                                 {
                                 x
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                        
                      be the vertex set of M. A class of discretization scheme [23–25] for the LBO can be represented as
                        
                           (2)
                           
                              
                                 
                                    Δ
                                 
                                 
                                    S
                                 
                              
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              ≈
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       N
                                       (
                                       i
                                       )
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    ij
                                 
                              
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              )
                              ,
                              
                              
                                 
                                    w
                                 
                                 
                                    ij
                                 
                              
                              ∈
                              R
                              ,
                           
                        
                     where 
                        
                           N
                           (
                           i
                           )
                        
                      contains the 1-ring neighborhood of 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        
                     , and 
                        
                           
                              
                                 w
                              
                              
                                 ij
                              
                           
                        
                      are the weights defined in different discretizations of the LBO. The eigenproblem becomes
                        
                           (3)
                           
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       N
                                       (
                                       i
                                       )
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    ij
                                 
                              
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              )
                              =
                              λ
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                           
                        
                     or in matrix form,
                        
                           (4)
                           
                              -
                              WF
                              =
                              λ
                              F
                              ,
                           
                        
                     where 
                        
                           F
                           =
                           
                              
                                 
                                    
                                       f
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       ,
                                       …
                                       ,
                                       f
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 T
                              
                           
                        
                      and W is the coefficient matrix defined by 
                        
                           
                              
                                 w
                              
                              
                                 ij
                              
                           
                        
                     . Eq. (4) yields n modes, each corresponds to an eigenvalue and eigenfunction. Let 
                        
                           
                              
                                 λ
                              
                              
                                 k
                              
                           
                        
                      and 
                        
                           
                              
                                 F
                              
                              
                                 k
                              
                           
                        
                      
                     
                        
                           (
                           k
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           n
                           -
                           1
                           )
                        
                      be the 
                        
                           k
                           th
                        
                      eigenvalue and the corresponding eigenfunction, we have
                        
                           (5)
                           
                              0
                              =
                              
                                 
                                    λ
                                 
                                 
                                    0
                                 
                              
                              ⩽
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              ⩽
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              ⩽
                              ⋯
                              ⩽
                              
                                 
                                    λ
                                 
                                 
                                    n
                                    -
                                    1
                                 
                              
                              .
                           
                        
                     
                     
                        
                           
                              
                                 λ
                              
                              
                                 0
                              
                           
                           =
                           0
                        
                      represents a rigid-body mode, its eigenfunction 
                        
                           
                              
                                 F
                              
                              
                                 0
                              
                           
                        
                      is a constant-scalar field.

Various methods have been developed for the discretization of LBO. In this paper, we use the cotangent scheme [13,26–29]. This discretization provides a symmetric matrix, which makes all the resulting eigenvalues and eigenfunctions real. However, the cotangent scheme was proved to be not convergent for irregular nodes, and it cannot deal with non-uniform meshes well [25]. There are some research conducted on convergent discretization of the LBO. For example, a k-nearest neighbor of a vertex was considered using a truncated heat kernel [30]. In [25], the Laplace matrix was constructed based on a quadratic fitting and its convergence rate was proved to be linear [31]. This discretization provides a non-symmetric matrix, resulting in complex eigenvalues and eigenfunctions. In this paper we use the cotangent scheme LBO to obtain real eigenfunctions.

Different eigenfunctions reflect surface features at different scales [14]. Compared with the high-mode eigenfunctions used in [20–22], the low-mode eigenfunctions are less sensitive to the detailed surface features and capture the major structure of the object. In this paper, we will use multiple low-mode eigenfunctions to design a direction guidance and then build a cross field, from which we can obtain a structure-aligned surface parameterization.

The gradient of the eigenfunctions can be used to represent structural features. For example in the Hand model in Fig. 1
                     , the gradient of the first and second eigenfunctions (black arrows) reflects the slim cylindrical structure of the fingers. However, a single eigenfunction may only reflect features in certain regions well. For example in (b), the gradient of Mode 1 eigenfunction follows the middle finger and the thumb very well, but not the little finger because the gradient magnitude is very small on it. Similarly in (c), the gradient of Mode 2 eigenfunction follows the index, third and little fingers well but not the thumb. From Fig. 1, we can observe that each eigenfunction plays a dominant role in certain regions, where the gradient of this eigenfunction reflects the structural features at a certain scale. We call such region a feature region of that eigenfunction. By combining the gradient in the feature regions from multiple eigenfunctions, we can build a structure-aligned guidance for the cross field construction. For example, we can define the middle finger and the thumb as the feature region of Mode 1 and the index, third and little finger as the feature region of Mode 2. Then the slim cylindrical structure of all five fingers can be captured using these two modes.

Then, the next problem is how to represent the feature region for each eigenfunction. Here, we design two different ways to represent the feature regions: isocontours and characteristic values.

Isocontours of eigenfunction f can locate important structural features, and they are often used for shape identification and segmentation [13,14]. For each eigenfunction, we first generate several representative isocontours, and then form the feature bands using the intersecting triangles to represent the feature region of that mode. For example in Fig. 2
                        (a), the isocontours from Mode 1 (green curves) and Mode 2 (blue curves) are generated. The green and blue bands in Fig. 2(b) represent the feature bands of the two eigenfunctions. The guidance for the cross field is defined as the gradient directions on triangles in the feature band, which we call the guidance directions. These triangles are called the guidance triangles. The guidance direction in each feature band follows the gradient of the eigenfunctions (black arrows).

To combine different modes using isocontours, we need to provide isovalues. One common choice is zero-isovalue because the corresponding isocontour represents the static region of a standing wave on the surface [13]. The gradient at the zero-isocontour of some eigenfunctions may have a very small magnitude, and thus a large numerical error may happen in the gradient calculation. The region with the extreme value is not a good choice either due to the same reason. For example in Fig. 3
                        , the gradient magnitude is very small in Region A (the black zero-isocontour) and Region B (the red
                           1
                           For interpretation of color in Figs. 3, 7, 10, 15 and 17, the reader is referred to the web version of this article.
                        
                        
                           1
                         area with the maximum eigenfunction value), and the gradient directions vary intensively due to the large numerical error. The gradient usually follows the structure well for an isocontour with an isovalue away from the extreme and zero eigenfunction values, such as the orange area (Region C) surrounding the white curve. To choose proper isovalues automatically, we define
                           
                              (6)
                              
                                 
                                    
                                       α
                                    
                                    
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       min
                                    
                                 
                                 +
                                 r
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       max
                                    
                                 
                                 -
                                 
                                    
                                       f
                                    
                                    
                                       min
                                    
                                 
                                 )
                                 ,
                              
                           
                        and
                           
                              (7)
                              
                                 
                                    
                                       α
                                    
                                    
                                       u
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       max
                                    
                                 
                                 -
                                 r
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       max
                                    
                                 
                                 -
                                 
                                    
                                       f
                                    
                                    
                                       min
                                    
                                 
                                 )
                                 ,
                              
                           
                        where 
                           
                              r
                              ∈
                              (
                              0
                              ,
                              0.5
                              )
                           
                         is the parameter adjusting the location of the isocontours to define a good direction guidance, and 
                           
                              
                                 
                                    f
                                 
                                 
                                    min
                                 
                              
                           
                         and 
                           
                              
                                 
                                    f
                                 
                                 
                                    max
                                 
                              
                           
                         are the minimal and maximal eigenfunction values. Here we choose 
                           
                              r
                              =
                              0.125
                           
                        .

Generally if the guidance directions are very different in the adjacent triangles, the smoothness of the cross field will be affected. This may happen when the adjacent guidance triangles are from feature bands of different eigenfunctions. For example in Fig. 4
                        , the blue and red isocontours on the wrist intersect with each other, defining very different guidance directions for the triangles around the intersection. In this paper, we define the guidance directions in adjacent triangles as non-consistent if these triangles are from feature bands of different eigenfunctions. Such a non-consistent situation can be avoided by adjusting the r value in Eqs. (6) and (7) to separate isocontours from different modes.

Given certain modes, although the isocontours can be adjusted easily by modifying the isovalues, it is difficult to avoid non-consistent situations automatically. To resolve this problem, we need to leave enough space between guidance triangles in different feature bands. In the following, we will talk about another method to represent the feature region, which can automatically separate guidance triangles in different feature bands.

Instead of using isocontours, another way to represent the feature region is to divide the surface into patches, and each patch represents a feature region. Here, we define a positive characteristic value 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                           
                         for each triangle 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                         of the 
                           
                              k
                              th
                           
                         mode. For a set of mode indices 
                           
                              K
                           
                        , triangle 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                         is assigned to the 
                           
                              k
                              th
                           
                         mode if
                           
                              (8)
                              
                                 k
                                 =
                                 
                                    
                                       arg max
                                    
                                    
                                       j
                                       ∈
                                       K
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 .
                              
                           
                        A feature patch is formed by the triangles assigned to the same mode.

In this paper, we use the gradient magnitude of the eigenfunctions as the characteristic value. An eigenfunction usually has a large gradient magnitude at certain regions with special structural features. For example in Fig. 5
                        , Modes 3 and 4 of the Cow model have a large gradient magnitude on the rear and front legs, while almost zero gradient everywhere else. Therefore, we define the characteristic value as 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              =
                              ‖
                              ∇
                              
                                 
                                    F
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              ‖
                           
                        , where
                           
                              
                                 ∇
                                 
                                    
                                       F
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       4
                                       
                                          
                                             A
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 {
                                 
                                    
                                       F
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 
                                    
                                       
                                          γ
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                a
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                b
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                c
                                             
                                          
                                          )
                                          +
                                          γ
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                a
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                c
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                b
                                             
                                          
                                          )
                                       
                                    
                                 
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       b
                                    
                                 
                                 )
                                 
                                    
                                       
                                          γ
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                b
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                c
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                a
                                             
                                          
                                          )
                                          +
                                          γ
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                b
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                a
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                c
                                             
                                          
                                          )
                                       
                                    
                                 
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       c
                                    
                                 
                                 )
                                 
                                    
                                       
                                          γ
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                c
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                a
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                b
                                             
                                          
                                          )
                                          +
                                          γ
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                c
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                b
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                a
                                             
                                          
                                          )
                                       
                                    
                                 
                                 }
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                           
                         denotes the area of 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              γ
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    b
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    c
                                 
                              
                              )
                              =
                              〈
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    b
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    b
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    c
                                 
                              
                              〉
                              (
                              
                                 
                                    x
                                 
                                 
                                    c
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                           
                        .


                        Fig. 6
                        (a) shows the obtained feature patches from Modes 1–2 using the characteristic value. In each feature patch, the Dijkstra distance d from the center of each triangle to the patch boundary is computed, which is shown in Fig. 6(b). Suppose the maximum distance in Patch k is 
                           
                              
                                 
                                    D
                                 
                                 
                                    k
                                 
                              
                           
                        , we choose triangles with distance 
                           
                              0.45
                              
                                 
                                    D
                                 
                                 
                                    k
                                 
                              
                              <
                              d
                              <
                              0.55
                              
                                 
                                    D
                                 
                                 
                                    k
                                 
                              
                           
                         as the guidance triangles (red triangles inside each feature patch, they form a feature band). The guidance directions are the gradient of the 
                           
                              k
                              th
                           
                         eigenfunctions (black arrows). In this method, triangles with a small gradient magnitude (
                           
                              ⩽
                              
                                 
                                    10
                                 
                                 
                                    -
                                    6
                                 
                              
                           
                        ) are ignored to avoid large numerical error in the gradient directions, see the grey regions in Fig. 6(a).
                           Discussion 3.1
                           Compared with the feature bands defined by the isocontours, feature bands caused by different modes are separated using the characteristic value and thus non-consistent guidance directions are avoided automatically. For example in Fig. 7(a), when the first six modes are used, non-consistent directions happen on the wrist due to the intersecting isocontours and feature bands (green and magenta bands) from Modes 1 and 4. However in Fig. 7
                              (b), there is no intersecting feature band because each feature band lies inside a feature patch and is also away from the patch boundary. Another difference is that the feature bands from the characteristic value also depend on the normalization of eigenfunctions. In this paper, all the eigenfunctions are normalized such that 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          
                                             
                                                f
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    1
                                 
                              . A different normalization may improve the parameterization results, and this can be an interesting problem for the future work.

Using the guidance created from eigenfunctions, in this section we build a cross field via a smoothing process, and generate a surface parameterization following the mixed integer method [9]. Similar to [10,32], we also enable a tradeoff control between the guidance alignment and the field smoothness. Differently, we further introduce a new algorithm to adapt the cross field to non-uniform parametric line spacings, enabling an anisotropy in the parameterization.

Let 
                           
                              
                                 
                                    T
                                 
                                 
                                    g
                                 
                              
                           
                         be the set of guidance triangles, and 
                           
                              
                                 
                                    T
                                 
                                 
                                    f
                                 
                              
                           
                         be the set of free triangles on the surface. A smooth cross field is constructed based on the guidance directions. The guidance direction and the cross field in triangle 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                         can be represented as 
                           
                              (
                              
                                 
                                    θ
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         and 
                           
                              (
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        , where 
                           
                              
                                 
                                    θ
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                              
                           
                         are defined as a module of 
                           
                              π
                              /
                              2
                           
                        , and 
                           
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                           
                         is the reference edge in triangle 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                        . Similar to [10], our smoothness energy of the cross field on M is defined as
                           
                              (9)
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                e
                                             
                                             
                                                ij
                                             
                                          
                                          ∈
                                          E
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   i
                                                
                                             
                                             +
                                             
                                                
                                                   κ
                                                
                                                
                                                   ij
                                                
                                             
                                             +
                                             
                                                
                                                   π
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   p
                                                
                                                
                                                   ij
                                                
                                             
                                             -
                                             
                                                
                                                   θ
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       ¯
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          
                                             
                                                T
                                             
                                             
                                                g
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             γ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    e
                                 
                                 
                                    ij
                                 
                              
                           
                         is the edge shared by triangle 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    T
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                              E
                           
                         is the set of all the edges in the mesh, 
                           
                              
                                 
                                    κ
                                 
                                 
                                    ij
                                 
                              
                           
                         is the angle between the reference edges of triangle 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    T
                                 
                                 
                                    j
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    p
                                 
                                 
                                    ij
                                 
                              
                           
                         is the integer valued period jump of the cross field across 
                           
                              
                                 
                                    e
                                 
                                 
                                    ij
                                 
                              
                           
                        . A parameter 
                           
                              
                                 
                                    λ
                                 
                                 
                                    ¯
                                 
                              
                           
                         is used to control the tradeoff between the alignment to the guidance directions and the field smoothness. The smooth cross field is obtained by minimizing the energy function. We solve the minimization problem using the mixed-integer solver introduced in [33].


                        Fig. 8
                        (a) shows the built cross field using the guidance defined in Fig. 6(b). Red dots are the singularities of the field. The surface is cut into a disk-like planar region and all the singularities should be on the boundary of the planar region [9], see Fig. 8(b). In the disk-like planar region, the parametric coordinates 
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         can be taken as two scalar fields, and two directions 
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         in each triangle 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                         are defined as the gradient of these two scalar fields, see blue and red arrows in Region A (singular) and Region B (regular) in Fig. 8(a). 
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                           
                         is chosen as one of the four directions of the cross field in triangle 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                        , which is forced to be consistent with the neighboring triangles. 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         is defined by rotating 
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                           
                         by 
                           
                              π
                              /
                              2
                           
                         following the clockwise direction.

The parametric coordinates 
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         of Vertex 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           
                         are computed by minimizing an orientation energy [9]
                        
                           
                              (10)
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       o
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          M
                                       
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          ∥
                                          h
                                          
                                             
                                                ∇
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                ∥
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          ∥
                                          h
                                          
                                             
                                                ∇
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                ∥
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where h is a parameter controlling the spacing of the parametric coordinates, 
                           
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                           
                         is the area of triangle 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    ∇
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ∇
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         are two gradients. Integer constraints are set on the parametric coordinates for the other vertices on the planar region boundary to ensure that the integer-value parametric lines meet at the boundary. In this way, a quadrangulation of the surface can be generated directly from the parametric lines. For example in Fig. 8(c), the blue and red lines represent the integer-value parametric lines of u and v, respectively.
                           Discussion 4.1
                           As the cross field follows the guidance directions defined by eigenfunctions, the resulting parametric lines align with structural features automatically. As shown in Figs. 2(b), 6(b) and 7(a, b), the guidance directions are defined using the isocontours and the characteristic values. They all yield parametric lines aligned with the five fingers, see Figs. 2(d), 7(c, d) and 8(c). Compared with Fig. 7(b) and (a) contains non-consistent guidance directions generated using the isocontours. Generally, consistent guidance directions yield good feature-aligned parameterization, see Fig. 7(d), while non-consistent guidance may introduce distortions. On the wrist of the hand in Fig. 7(c), there is a foldover in the parametric lines, where the resulting 
                                 
                                    
                                       
                                          ∇
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          ∇
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                 
                               are very different with 
                                 
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                 
                              . This can be improved by assigning larger weights for the triangles in this region when minimizing the orientation energy [9].

Reducing the distortion is an important issue for surface parameterization. In previous literature [34,35], the distortion was reduced by evolving a pre-defined metric on the surface. Differently, we reduce the distortion mainly by using the characteristic value to avoid non-consistent guidance directions and also modifying 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                               in Eq. (9) to balance the tradeoff between guidance alignment and field smoothness. A small 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                               value can relax the constraint and thus the distortion is reduced, although the feature alignment may be sacrificed at certain extent. Fig. 9
                               shows the parameterization results corresponding to different 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                               values. When a small 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                               is chosen, the parametric lines fail in aligning with the index finger, but the distortions in the wrist region are avoided (Fig. 9(a)). As 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                               becomes larger, the parametric lines align with the index finger better but distortions happen in the wrist region as shown in Figs. 9(b) and 7(c) (
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          ¯
                                       
                                    
                                    →
                                    ∞
                                 
                              ).

While the alignment of the parametric lines are determined by the cross field, the spacing of them depends on the parameter h in Eq. (10). A smaller h value results in denser parametric lines which correspond to the integer value of the parametric coordinates u and v. Using a constant h, we obtain uniform parametric lines. While using a non-uniform h from a sizing field [36], the local spacing of the parametric lines can be controlled to achieve adaptive and anisotropic parameterization at certain extent. But the parametric lines with different spacings may not be compatible with each other. In this paper we introduce a new method to modify the original cross field and make it adapt to the variation of the parametric line spacings.

First, we define a region that must follow the original direction as the invariant region, and regions between invariant regions as the transition region. In each iteration, the cross field in the transition regions is modified according to the difference between the resulting 
                           
                              
                                 
                                    ∇
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                           
                        , or 
                           
                              
                                 
                                    ∇
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                        . Given that the four directions of the cross field are perpendicular or parallel with each other, the modification of the cross field can be represented by the modification in one of its directions. If 
                           
                              
                                 
                                    ∣
                                    
                                       
                                          ∇
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    ·
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    ∣
                                 
                                 
                                    ‖
                                    
                                       
                                          ∇
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    ‖
                                 
                              
                              <
                              
                                 
                                    ∣
                                    
                                       
                                          ∇
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    ·
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    ∣
                                 
                                 
                                    ‖
                                    
                                       
                                          ∇
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    ‖
                                 
                              
                           
                        ,
                           
                              (11)
                              
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       r
                                    
                                    
                                       c
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                ‖
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ‖
                                             
                                          
                                          -
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        else
                           
                              (12)
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       r
                                    
                                    
                                       c
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                ‖
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ‖
                                             
                                          
                                          -
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    r
                                 
                                 
                                    c
                                 
                              
                              ∈
                              (
                              0
                              ,
                              1
                              )
                           
                         is a pre-defined parameter and here we choose 
                           
                              
                                 
                                    r
                                 
                                 
                                    c
                                 
                              
                              =
                              0.2
                           
                        .

Generally, a large gradient magnitude indicates an intensive varying of the field, so the resulting mesh should be dense along that gradient direction. Therefore, we set the anisotropy where 
                           
                              ‖
                              
                                 
                                    ∇
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                                 
                                    a
                                 
                              
                              ‖
                              >
                              0.5
                              
                              ∗
                              
                              max
                              
                                 
                                    
                                       ‖
                                       
                                          
                                             ∇
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             a
                                          
                                       
                                       ‖
                                    
                                 
                              
                           
                         (the region pointed by the red arrow in Fig. 10
                        (a)). Here, 
                           
                              
                                 
                                    ∇
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                                 
                                    a
                                 
                              
                           
                         is the gradient of 
                           
                              
                                 
                                    F
                                 
                                 
                                    a
                                 
                              
                           
                         in triangle 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                        . The h values in 
                           
                              u
                              ,
                              
                              v
                           
                         directions are defined as
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   u
                                                   ,
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∣
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ·
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  F
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  a
                                                               
                                                            
                                                            ∣
                                                         
                                                         
                                                            ‖
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  F
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  a
                                                               
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               1
                                                               -
                                                               
                                                                  
                                                                     ∣
                                                                     
                                                                        
                                                                           u
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     ·
                                                                     
                                                                        
                                                                           ∇
                                                                        
                                                                        
                                                                           T
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           F
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           a
                                                                        
                                                                     
                                                                     ∣
                                                                  
                                                                  
                                                                     ‖
                                                                     
                                                                        
                                                                           ∇
                                                                        
                                                                        
                                                                           T
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           F
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           a
                                                                        
                                                                     
                                                                     ‖
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   h
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   v
                                                   ,
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∣
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ·
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  F
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  a
                                                               
                                                            
                                                            ∣
                                                         
                                                         
                                                            ‖
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  F
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  a
                                                               
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               1
                                                               -
                                                               
                                                                  
                                                                     ∣
                                                                     
                                                                        
                                                                           v
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     ·
                                                                     
                                                                        
                                                                           ∇
                                                                        
                                                                        
                                                                           T
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           F
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           a
                                                                        
                                                                     
                                                                     ∣
                                                                  
                                                                  
                                                                     ‖
                                                                     
                                                                        
                                                                           ∇
                                                                        
                                                                        
                                                                           T
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           F
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           a
                                                                        
                                                                     
                                                                     ‖
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   h
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    r
                                 
                                 
                                    a
                                 
                              
                           
                         is a parameter controlling the ratio of line spacing in 
                           
                              u
                              ,
                              v
                           
                         directions, and 
                           
                              
                                 
                                    h
                                 
                                 
                                    0
                                 
                              
                           
                         defines the base size. We choose 
                           
                              
                                 
                                    r
                                 
                                 
                                    a
                                 
                              
                              =
                              0.2
                           
                         in this paper. Fig. 10 shows an example of anisotropic parameterization. (a) shows the input field 
                           
                              
                                 
                                    F
                                 
                                 
                                    a
                                 
                              
                           
                         (Mode 1 eigenfunction). Using the original cross field in (c), the parameterization fails because the line spacing varies intensively, see (e). To adapt the cross field, a transition region is defined where 
                           
                              0.45
                              
                              ∗
                              
                              max
                              
                                 
                                    
                                       ‖
                                       
                                          
                                             ∇
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             a
                                          
                                       
                                       ‖
                                    
                                 
                              
                              <
                              ‖
                              
                                 
                                    ∇
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                                 
                                    a
                                 
                              
                              ‖
                              <
                              0.5
                              
                              ∗
                              
                              max
                              
                                 
                                    
                                       ‖
                                       
                                          
                                             ∇
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             a
                                          
                                       
                                       ‖
                                    
                                 
                              
                           
                        , as shown in (b). After adapting the cross field, a valid parameterization is obtained with 
                           
                              
                                 
                                    r
                                 
                                 
                                    c
                                 
                              
                              =
                              0.1
                           
                         and 40 iterations, as shown in (d) and (f). In the invariant region, the parametric lines keep aligned to the input field, while in the transition region the alignment is sacrificed and more singularities are introduced. As a result in the region pointed by the red arrow in (a), the red parametric lines (perpendicular with the gradient direction) are much denser than the blue ones.
                           Discussion 4.3
                           In our anisotropic parameterization scheme, we define a novel transition region on the surface and adapt the cross field in this region to connect parametric lines with different line spacings smoothly. Although extra singularities may be yielded in the transition region, the orthogonality of the cross field is preserved during the entire adaptation process and the 
                                 
                                    u
                                    ,
                                    
                                    v
                                 
                               parametric lines are automatically aligned to two perpendicular directions, resulting in quadrilateral elements with good quality. While the previous anisotropic parameterization methods [7,37] seldom consider the quality of the output quadrilateral elements. For example in [7], the orthogonality was sacrificed to achieve the anisotropy, resulting in extremely small angles in the mesh.

@&#RESULTS AND DISCUSSION@&#

Our surface parameterization algorithm has been applied to various models based on the guidance of eigenfunctions. The resulting parametric lines differ when different eigenfunctions are used. Table 1
                      shows a summary of the number of singularities and the computational time for each model. The results were obtained using a computer with an Intel Xeo E5-1620 CPU and 16GB of memory.

Using eigenfunctions to design guidance directions for cross field, multiscale structural features can be captured. Generally speaking, major structural features can be captured with a few low modes. For example, using only the first two modes, all the five fingers of the Hand model are captured in Fig. 8(c); the Bunny ears are aligned in Fig. 11
                     (d), and the parametric lines are aligned well with the limbs of Armadillo in Fig. 12
                     (c). As high modes are considered, more features can be captured. Therefore based on the guidance directions that capture the major structural features, we can add more detailed features by simply including more modes. For example in Fig. 13
                     (b–d), the legs are captured by the first four modes, but the parametric lines can be aligned better on the face and ear when Modes 5 and 6 are included, see Fig. 13(e–g). In Fig. 12(g) for the Armadillo, when the first six rather than two modes are considered, the parametric lines follow the face better. For the Bunny model, an additional mode makes the parametric lines more uniform, see Fig. 11(f). We have also tested our algorithm on two biomedical structures. Fig. 14
                      shows a vascular Aneurysm model (Aneurysm A). Compared with (b, e), the two branches next to the aneurysm dome are aligned well as shown in (c, f) with Modes 3–4 considered, and the two short branches at the bottom are also aligned when more modes are included, see (d, g). Fig. 15
                      shows the parameterization results for the Thin Filament protein in the human heart muscle. The overall structure of the protein can be easily captured using the first two modes as shown in (d). When more modes are included in (e–f), more detailed features are captured on the actin (yellow region), which is an essential component for the cardiac contractile mechanism.

The principal curvatures have been applied in various applications to capture surface features at different scales [9,10]. Here, we also compare our scheme with the principal curvature guided methods. The curvatures are estimated using a common technique introduced in [9,10,38]. Similarly, we measure the relative anisotropy of the principal curvatures using
                        
                           
                              τ
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            κ
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      
                                                         
                                                            κ
                                                         
                                                         
                                                            min
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   κ
                                                
                                                
                                                   max
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                
                                                   κ
                                                
                                                
                                                   min
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     and the principal directions in the region with 
                        
                           τ
                           >
                           0.8
                        
                      are defined as the guidance for the parameterization. Generally, both principal curvatures and eigenfunctions can be used to capture the structural feature of an object. Compared to principal curvatures, eigenfunctions especially low-mode ones are less sensitive to the local detailed features or noise on the surface. This property can be observed from the comparisons in five tested models, see Figs. 11(f vs h, i vs j), 15(d vs g) and 16. For the Bunny model without stamp in Fig. 11(f vs h), the results from both eigenfunctions and principal curvatures follow the major structure of the object roughly with similar number of singularities (34 vs 38). When a stamp is added on the surface as shown in Fig. 11(i vs j), the principal curvature guided method introduces more singular points in the stamped region to capture the local detailed features, while these features are ignored by the low-mode eigenfunctions (Modes 1–3) and the resulting parametric lines still follow the similar directions as in (f) with the same number of singularities. Although the overall eigenfunction patterns are very similar in Fig. 11(a) and (b), the gradient directions are different in some local regions. Therefore, the resulting layouts of singularities are different in (f) and (j). For the Thin Filament model in Fig. 15(d vs g), the trunk of the structure is full of sags and crests. Compared with the results from principal curvatures, the parametric lines from the eigenfunctions (Modes 1–2) are aligned to the axial direction of the object very well, ignoring the detailed sags and crests. Similarly in the Fertility model (without and with a defect on the arm) and two Aneurysm models in Fig. 16
                     , eigenfunctions (Modes 1–3, 1 or 1–7) align the parametric lines to the major cylindrical structure of the arm or vessel branches rather than the detailed irregular shapes of the defect or aneurysms, which cannot be avoided by the principal curvatures with more singularities introduced. Therefore, our eigenfunction-based method could be a better choice when the users intend to exclude the influence of local detailed features and small changes on the surface.

As discussed in Section 3, it is more likely to generate non-consistent guidance directions using the isocontours than the characteristic value. However, the isocontours are more flexible for the user operation. The location of the isocontours can be easily changed by modifying the corresponding isovalues, and the resulting field direction around the isocontours is easy to predict, since the guidance directions are always perpendicular with the isocontours. To take the advantages of both methods, the users can utilize the characteristic value to capture the basic structural features of the object, and use the isocontours to add additional features according to their specific intentions. Fig. 17
                     (a–c) shows an example of combining both methods for the Cow model. The embossing around the eyes is reflected in the 
                        
                           18
                           th
                        
                      mode, which can be captured by the isocontours shown in Fig. 17(a) (the red and blue lines). The guidance directions introduced by these two isocontours are added to the directions shown in Fig. 13(e). As a result, the corresponding parameterization results is very similar with Fig. 13(f), except the regions around the eyes.

The guidance directions defined by different eigenfunctions produce different numbers of singularities in the resulting surface parameterization. As discussed in [39], the optimal number of singularities is hard to achieve by minimizing the energy defined in Eq. (9). However, the guidance from the eigenfunction gradient can help in controlling it. Figs. 18 and 19
                     
                      show the direction guidance and surface parameterization for the Torus and Eight models. Different number of eigenfunctions results in various numbers of singularities. Theoretically for the Torus (genus 1) and Eight (genus 2) models, the least number of singularities are 0 and 8 [40], which can be achieved using the first three and five eigenfunctions, respectively. Although it is difficult to predict the number of singularities directly, we provide a versatile option for the user to make a selection.

Besides combining different modes to capture the overall structure of the object, we can also construct anisotropic parameterization using the algorithm introduced in Section 4.2. For an eigenfunction, denser parametric lines along one certain direction can be generated in the region with large gradient magnitudes, achieving the anisotropy defined in Eq. (13). In these regions, the parametric lines are still aligned to the structure feature. Fig. 17(d–f) shows an example of anisotropic parameterization for the Mode 2 eigenfunction of the Cow model. In the region around the neck and the front legs, the red parametric lines (perpendicular to the gradient direction) are much denser than the blue lines.

Our algorithm also has some limitations. Generally, the parametric lines align well with the structural features using the guidance directions from eigenfunctions. However, there are two factors that may affect the alignment results. Firstly, as discussed in [36] the cross field generated by minimizing the smoothness energy (Eq. (9)) may be affected by the input mesh quality, and the directions of the cross field may even fail to follow the guidance. Secondly, the parametric coordinates u and v are computed by minimizing the orientation energy (Eq. (10)), and the resulting parametric lines are not guaranteed to align with the cross field due to the integer constraints. The anisotropic parameterization is also limited by the input mesh. As shown in Fig. 10(f), the anisotropy is achieved with more singularities introduced in the transition region. Generally, stronger anisotropy requires more singularities. As the singularities locate on the mesh vertices, the possible anisotropy is limited by the distribution of vertices in the input mesh. The number of singularities can be reduced if T-junctions are allowed in parameterization. Finally, as all the other eigenfunction-based algorithms, we need users to provide which modes to be used, which is not fully-automatic. Although eigenfunctions of the LBO operator have a clear multi-scale behavior, they do not provide an immediate access to what a human would call different structural scales on an object, so it is still difficult to decide which combination of modes is reasonable.

@&#CONCLUSIONS AND FUTURE WORK@&#

In this paper, we have introduced a novel approach to define guidance directions for cross field-based surface parameterization. Two methods are designed to combine the gradient information from different eigenfunctions. Based on the guidance from multiple eigenfunctions, a cross field is built with a tradeoff between the guidance alignment and the field smoothness. As a result, the parametric lines are aligned with the structural features at multiple scales, also enabling an anisotropy by adapting the cross field to non-uniform parametric line spacings. In the future, we intend to continue working on anisotropic parameterization and also extend our structure-aligned surface parameterization to T-spline surface modeling.

@&#ACKNOWLEDGMENTS@&#

T. Liao and Y. Zhang were supported in part by PECASE Award N000141410234 and NSF CAREER Award OCI-1149591. G. Xu was supported in part by NSFC under the Grants (11101401, 81173663), and NSFC Fund for Creative Research Groups of China (Grant No. 11321061).

@&#REFERENCES@&#

