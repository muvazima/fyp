@&#MAIN-TITLE@&#Application of a Time-Scale Local Hurst Exponent analysis to time series

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present a method for estimating a time-scale local Hurst exponent on time series.


                        
                        
                           
                           The method has proven to be sensitive to sudden behavior changes on time series.


                        
                        
                           
                           Lower scales evaluate short-range correlations.


                        
                        
                           
                           Larger scales evaluate long-range correlations.


                        
                        
                           
                           The analysis evaluates pattern changes regardless the amplitude and scale.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Time-Scale Local Hurst Exponent

Multi-scale rescaled-range analysis

Fractional Brownian motion series

Seismic traces

@&#ABSTRACT@&#


               
               
                  This paper introduces a method to perform a Time-Scale Local Hurst Exponent (TS-LHE) analysis for time series. The traditional Hurst exponent methods usually analyze time series as a whole, providing a single value that characterizes their global behavior. In contrast, the methods based on the Local Hurst Exponent allow the evaluation of the fractal structure of a time series on local events. However, a critical parameter in these methods is the selection of scale. Here, a TS-LHE method is presented, based on a systematic implementation of the rescaled-range (R/S) method, in a set of sliding windows of different sizes. This method allows calculating instantaneous values of Local Hurst Exponents at different scales, associating them with individual samples of a time series. This paper is organized as follows: first, an overview of the TS-LHE is provided; then, a proof-of-concept of this analysis is presented, considering (a) different fractional Brownian motion series, (b) a synthetic seismic signal under different noise conditions, and (c) a group of real seismic traces. Finally, the obtained results show that the TS-LHE analysis is particularly sensitive to sudden behavior changes of the time series, such as frequency or phase variations. This sensitivity is independent of the amplitude of the data, and thus, it can be used to identify pattern changes as well as long- and short-range correlations within a time series.
               
            

@&#INTRODUCTION@&#

Fractal analysis has become a regular procedure for finding correlations in time series. Several different applications have been reported in the literature, in fields such as seismic analysis [1–3], economics [4–6], or medical applications [7–9]. Commonly, fractal analysis provides a means to measure signals complexity, by estimating the short or long-range correlations between values of the time series [10], independently of the amplitude of data [11].

The Hurst Exponent is a parameter normally used to study self-similarities in time series. It is a value that indicates the level of persistence of the series, and is based on scaling-law statistics [7,12]. Several different methods have been proposed for estimating the Hurst Exponent, such as the Rescaled-Range (
                        R
                        /
                        S
                     ) analysis method [4,13,14], the Detrended Fluctuation Analysis (DFA) [8,15], or the Fourier Spectral technique [16]. The main particularity of these methods is that they generally analyze the time series as a whole, providing a single value of Hurst Exponent that characterizes times series globally.

Several approaches for estimating a Local Hurst Exponent (LHE) have been reported in the literature [1,2,6,17]. Mostly, they are based on a moving window that slides through the data, with or without overlapping, locally calculating the Hurst Exponent within each window. Hence, these methods are sensitive to the size of the window.

This paper provides a systematic method for time-scale analysis of the Local Hurst Exponent. Such a method aids in the identification of changes in the scale properties of time series, detecting singular events by estimating short- and long-range correlations. Also, it can be used as an analysis tool to highlight frequency or phase variations in the series. In this method, the LHE is calculated for windows with different sizes, and plotted as a function of the position of each window within the time series, and of its size, by using a color code. As proof-of-concept, the method is applied to fractional Brownian motion series, and to seismic data.

The performance of the TS-LHE method is compared here with the Continuous Wavelet Transform (CWT), which is a conventional method for analyzing time series. A fundamental difference between both methods is that CWT analyzes features of time series dependent on time and frequency, while the proposed TS-LHE method analyzes features dependent on time, and on short- and long-range correlations within the time series.

The method here is related to the Hölder Exponent [18,19], since both can show the multifractal behavior of a time series, when there are different scaling patterns in it. However, the main difference is that the Hölder Exponent measures the strength of the scaling patterns, known as singularities, while the Hurst exponent measures the rate at which the correlation of neighbor samples change as the lag between them increases, that is, it is a long memory test for the time series [9].

This paper is organized as follows: Section 2 describes the basics of the TS-LHE method; Section 3 presents some testing data sets: a group of fractional Brownian motions series, a synthetic seismogram under different noise conditions, and finally, a real seismic gather. Section 4 presents the results of the analysis. Finally, the last section provides some conclusions and remarks.

Hurst introduces the rescaled-range (
                           R
                           /
                           S
                        ) analysis [13] to study the hydrology of the Nile River, and particularly, to estimate the reservoir required to hold the floodwater. In order to compute the (
                           R
                           /
                           S
                        ) method, first the time series (
                           y
                           (
                           n
                           )
                        , 
                           n
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           N
                        ) is divided into k non-overlapping segments (
                           
                              
                                 y
                              
                              
                                 k
                              
                           
                        ) of size 
                           T
                           =
                           ⌊
                           N
                           /
                           k
                           ⌋
                        , with 
                           T
                           ∈
                           
                              
                                 Z
                              
                              
                                 +
                              
                           
                         and 
                           k
                           ∈
                           
                              
                                 Z
                              
                              
                                 +
                              
                           
                        . Notice that in this approach some samples may not be considered in the analysis, due to the round of T. Then, the method continues by calculating the mean values of each segment 
                           
                              
                                 y
                              
                              
                                 k
                              
                           
                        :
                           
                              (1)
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          k
                                       
                                    
                                    ¯
                                 
                                 =
                                 
                                    1
                                    T
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    T
                                 
                                 
                                    
                                       y
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 j
                                 )
                                 ,
                                 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 ⌊
                                 N
                                 /
                                 T
                                 ⌋
                                 .
                              
                           
                         The integrated subseries departed from the mean are computed for each segment 
                           
                              
                                 y
                              
                              
                                 k
                              
                           
                         as:
                           
                              (2)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 i
                                 )
                                 =
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    i
                                 
                                 
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    j
                                    )
                                    −
                                    
                                       
                                          
                                             y
                                          
                                          
                                             k
                                          
                                       
                                       ¯
                                    
                                    )
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 T
                                 .
                              
                           
                         To calculate the 
                           
                              
                                 (
                                 R
                                 /
                                 S
                                 )
                              
                              
                                 T
                              
                           
                        , associated to the size T, first the ranges 
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                         are computed for each interval 
                           
                              
                                 ϕ
                              
                              
                                 k
                              
                           
                        , and then, divided by the local standard deviations 
                           
                              
                                 S
                              
                              
                                 k
                              
                           
                         of each original segments, 
                           
                              
                                 y
                              
                              
                                 k
                              
                           
                        :
                           
                              (3)
                              
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       1
                                       ≤
                                       i
                                       ≤
                                       T
                                    
                                 
                                 
                                 
                                    (
                                    ϕ
                                    (
                                    i
                                    )
                                    )
                                 
                                 −
                                 
                                    
                                       min
                                    
                                    
                                       1
                                       ≤
                                       i
                                       ≤
                                       T
                                    
                                 
                                 
                                 
                                    (
                                    ϕ
                                    (
                                    i
                                    )
                                    )
                                 
                                 ,
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       S
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          1
                                          T
                                       
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          T
                                       
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             
                                                y
                                             
                                             
                                                k
                                             
                                          
                                          ¯
                                       
                                       )
                                    
                                 
                                 .
                              
                           
                         Then, the mean rescaled-range for the corresponding T length is calculated:
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                R
                                                S
                                             
                                             )
                                          
                                          ¯
                                       
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    1
                                    k
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    k
                                 
                                 
                                    (
                                    
                                       
                                          
                                             R
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             S
                                          
                                          
                                             j
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         These calculations are repeated for all possible segments sizes T. The statistics of 
                           
                              
                                 
                                    
                                       (
                                       R
                                       /
                                       S
                                       )
                                    
                                    ¯
                                 
                              
                              
                                 T
                              
                           
                         follows a power law in relation to the T size:
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                R
                                                S
                                             
                                             )
                                          
                                          ¯
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ∝
                                 
                                    
                                       T
                                    
                                    
                                       H
                                    
                                 
                                 ,
                              
                           
                         where H is the Hurst scaling exponent, and it is calculated as the slope of the straight line that best fits 
                           
                              
                                 
                                    
                                       (
                                       R
                                       /
                                       S
                                       )
                                    
                                    ¯
                                 
                              
                              
                                 T
                              
                           
                         on a log–log plot. The Hurst exponent H is related to the fractal dimension of the series 
                           y
                           (
                           n
                           )
                         by 
                           D
                           =
                           2
                           −
                           H
                         
                        [3], and it can be interpreted as a measure of the correlation of neighbor samples.

Computing the 
                           R
                           /
                           S
                         statistics of a time series provides a single value, an estimation of the Hurst Exponent, which provides a global description of such a time series. Here, a systematic method to locally evaluate the Hurst Exponent is proposed, so a deeper insight of the behavior of the time series is obtained. This method allows studying the Hurst Exponent as a function of time and scale, 
                           H
                           (
                           n
                           ,
                           
                              Ws
                           
                           )
                        .

The main idea within this method is to make use of a moving window (
                           
                              
                                 Ψ
                              
                              
                                 Ws
                              
                           
                        ) of different size, defined by Ws, that runs along the entire series. Having 
                           
                              
                                 Ψ
                              
                              
                                 Ws
                              
                           
                         centered at the i-th sample of the series, for a given size Ws, the 
                           R
                           /
                           S
                         is computed for all the samples within the window 
                           
                              
                                 Ψ
                              
                              
                                 Ws
                              
                           
                        . The obtained Hurst Exponent is treated as the Local Hurst exponent 
                           H
                           (
                           i
                           ,
                           
                              Ws
                           
                           )
                         due to scale Ws on the i-th sample. The process implies sliding the window one sample each time, repeating the calculations until the end of the time series is reached. After this, Ws size is increased and the process is repeated again, until a defined maximum Ws is attained. Details of the procedure are described as follows:
                           
                              i)
                              First, define the scale range (
                                    
                                       
                                          Ws
                                       
                                       
                                          min
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          Ws
                                       
                                       
                                          max
                                       
                                    
                                 ) for which the TS-LHE is to be calculated. The purpose of these scales Ws is to define the extent to which the short- and long-range correlations in the time series are estimated. The minimum window size (
                                    
                                       
                                          Ws
                                       
                                       
                                          min
                                       
                                    
                                 ) can be as small as the minimum number of samples that the 
                                    R
                                    /
                                    S
                                  method requires to estimate the exponent H (this is, the slope of the best line that fits 
                                    R
                                    /
                                    S
                                 ). In the limit, a minimum of two points is required to estimate H. Thus, 
                                    
                                       
                                          Ws
                                       
                                       
                                          min
                                       
                                    
                                    =
                                    4
                                 . Here, it is suggested that 
                                    
                                       
                                          Ws
                                       
                                       
                                          min
                                       
                                    
                                    ≥
                                    8
                                 , in order to have at least 4 points to estimate H.

On the other hand, the maximum window size (
                                    
                                       
                                          Ws
                                       
                                       
                                          max
                                       
                                    
                                 ) defines the extent of the long-range analysis, and it can be larger than the actual number of samples of the time series under analysis (from an algorithmic point of view). However, the purpose of scales Ws is to evaluate correlations within the time series, and thus, setting 
                                    
                                       
                                          Ws
                                       
                                       
                                          max
                                       
                                    
                                    >
                                    N
                                  simply does not contribute to the scope of this analysis. Based on this consideration: 
                                    
                                       
                                          Ws
                                       
                                       
                                          min
                                       
                                    
                                    <
                                    
                                       
                                          Ws
                                       
                                       
                                          max
                                       
                                    
                                    ≤
                                    N
                                 .

A padded series 
                                    
                                       
                                          y
                                       
                                       
                                          Pad
                                       
                                    
                                    (
                                    n
                                    )
                                  is obtained by adding 
                                    L
                                    =
                                    ⌊
                                    
                                       Ws
                                    
                                    /
                                    2
                                    ⌋
                                  reflected samples at each end-point of the time series 
                                    y
                                    (
                                    n
                                    )
                                 , as shown Fig. 1
                                 (A) and (B). Thus, the resulting length of 
                                    
                                       
                                          y
                                       
                                       
                                          Pad
                                       
                                    
                                    (
                                    n
                                    )
                                  is 
                                    N
                                    +
                                    2
                                    L
                                 . Padding considerations are discussed later, at the end of this section.
                                    
                                       (7)
                                       
                                          
                                             
                                                y
                                             
                                             
                                                P
                                                a
                                                d
                                             
                                          
                                          (
                                          n
                                          )
                                          =
                                          
                                             {
                                             y
                                             (
                                             L
                                             +
                                             1
                                             )
                                             ,
                                             y
                                             (
                                             L
                                             )
                                             ,
                                             …
                                             ,
                                             y
                                             (
                                             2
                                             )
                                             ,
                                             y
                                             (
                                             n
                                             )
                                             ,
                                             y
                                             (
                                             N
                                             −
                                             1
                                             )
                                             ,
                                             
                                             y
                                             (
                                             N
                                             −
                                             2
                                             )
                                             ,
                                             …
                                             ,
                                             y
                                             (
                                             N
                                             −
                                             L
                                             )
                                             }
                                          
                                          ;
                                       
                                    
                                  where 
                                    n
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                    +
                                    2
                                    L
                                 .

The sliding window 
                                    
                                       
                                          Ψ
                                       
                                       
                                          Ws
                                       
                                    
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          s
                                       
                                    
                                    )
                                  is defined for 
                                    
                                       
                                          n
                                       
                                       
                                          s
                                       
                                    
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       Ws
                                    
                                 ; it is centered at the j-th sample of 
                                    
                                       
                                          y
                                       
                                       
                                          Pad
                                       
                                    
                                    (
                                    n
                                    )
                                 , which is aligned with the i-th sample of 
                                    y
                                    (
                                    n
                                    )
                                 , as it is illustrated on Fig. 1(A) and (B).

For each sliding window 
                                    
                                       
                                          Ψ
                                       
                                       
                                          Ws
                                       
                                    
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          s
                                       
                                    
                                    )
                                 , the corresponding 
                                    
                                       
                                          (
                                          R
                                          /
                                          S
                                          )
                                       
                                       ¯
                                    
                                  is calculated. The resulting Hurst Exponent is the Local Hurst Exponent, 
                                    H
                                    (
                                    i
                                    ,
                                    
                                       Ws
                                    
                                    )
                                 , associated to the i-th sample on 
                                    y
                                    (
                                    n
                                    )
                                 , and a window size Ws, as shown in Fig. 1(C).

Move the window 
                                    
                                       
                                          Ψ
                                       
                                       
                                          Ws
                                       
                                    
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          s
                                       
                                    
                                    )
                                  one sample on 
                                    
                                       
                                          y
                                       
                                       
                                          P
                                          a
                                          d
                                       
                                    
                                    (
                                    n
                                    )
                                 , starting at sample 
                                    j
                                    =
                                    1
                                  and ending at 
                                    j
                                    =
                                    N
                                    −
                                    L
                                 , as shown on Fig. 1(B). The idea is to align the first sample of 
                                    y
                                    (
                                    n
                                    )
                                  with the central sample of 
                                    
                                       
                                          Ψ
                                       
                                       
                                          Ws
                                       
                                    
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          s
                                       
                                    
                                    )
                                  at the initial position. Similarly, with 
                                    
                                       
                                          Ψ
                                       
                                       
                                          W
                                          s
                                       
                                    
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          s
                                       
                                    
                                    )
                                  at the final position, its central sample will be aligned with the last sample of 
                                    y
                                    (
                                    n
                                    )
                                 . Repeat ii) to v). The procedure finishes when Ws is maximum.

At the end of the procedure, the result is a matrix 
                           H
                           (
                           n
                           ,
                           
                              Ws
                           
                           )
                           ∈
                           [
                           0
                           ,
                           1
                           ]
                           :
                           
                              
                                 R
                              
                              
                                 N
                                 ×
                                 
                                    Ws
                                 
                              
                           
                        , which contains the TS-LHE estimates associated to the time series 
                           y
                           (
                           n
                           )
                        . The TS-LHE estimates depend on windows size, and therefore, the LHE characterizes the data bounded by the window only. When the correlation of samples within the window changes due perhaps to a fast frequency or phase fluctuations, the LHE presents a deviation on a specific time and scale. The advantage of such a situation is that the TS-LHE method allows detecting these changes on time series patterns at specific times, as well as the extent of influence on neighbor samples. As the windows size increases, the LHE estimate approaches the value of the global Hurst Exponent. Considering the computational complexity of this method, the algorithm presents a complexity of 
                           O
                           (
                           
                              
                                 N
                              
                              
                                 2
                              
                           
                           log
                           ⁡
                           (
                           N
                           )
                           )
                        .

In order to analyze the samples at the end points of the series, some padding is required. However, the padding affects 
                           
                              Ws
                           
                           /
                           2
                         values at the edges of the 
                           H
                           (
                           n
                           ,
                           
                              Ws
                           
                           )
                        . Thus, it is important to consider a suitable filling strategy for padding. In this case, a reflected-sample-padding allows analyzing samples at the end points with data from the same series that are in their vicinity. Despite the fact that it still affects the results, the calculated 
                           H
                           (
                           n
                           ,
                           
                              Ws
                           
                           )
                         is related to the same data. Other options, as zero-padding or random-padding, have the drawback that the TS-LHE analysis tests correlations between samples of different type, leading to results that are not meaningful for a correlation analysis.

In order to evaluate the TS-LHE method, some time series from fractional Brownian motions, synthetic seismograms, and real seismic data are analyzed.

A fractional Brownian motion (
                           
                              
                                 B
                              
                              
                                 H
                              
                           
                           (
                           t
                           )
                        ), also known as a “random walk process”, is a self-similar Gaussian process, in which the distribution is similar at different scales [14]. The fBm presents a uniform scaling behavior, and it is generally parameterized through the Hurst Exponent, 
                           H
                           ∈
                           (
                           0
                           ,
                           1
                           )
                        . The parameter H can be seen as a measure of the dependence of each increment in 
                           
                              
                                 B
                              
                              
                                 H
                              
                           
                           (
                           t
                           )
                         with neighboring samples:
                           
                              –
                              If 
                                    H
                                    ≥
                                    0.5
                                 , then the increments are persistent (the trend pattern of previous step is likely to be maintained).

If 
                                    H
                                    ≤
                                    0.5
                                 , then the increments are anti-persistent (the trend pattern of previous step is likely to be inverted). These represent an oscillating process.

If 
                                    H
                                    =
                                    0.5
                                 , then each step is independent from previous ones, and the increment function, 
                                    x
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          B
                                       
                                       
                                          H
                                       
                                    
                                    (
                                    t
                                    +
                                    1
                                    )
                                    −
                                    
                                       
                                          B
                                       
                                       
                                          H
                                       
                                    
                                    (
                                    t
                                    )
                                 , which represents the fractional Gaussian noise (fGn), corresponds to white noise.

This behavior is illustrated in Fig. 2
                        , from (A) to (F), where the fBm series has H values from 0.5 to 1.0, and a length of 500 samples. As the H value increases, the fBm series becomes smoother.

The application of the TS-LHE method is tested for two other cases. The first is a synthetic seismogram, computed as the convolution between the Ricker wavelet and a series of randomly distributed spikes with random amplitudes. In this case, four configurations are tested, as shown in Fig. 3
                        (A) to (D); the first is noise free, and the other three have a signal-to-noise ratio (SNR) of 10, 5, and 2 dB, respectively. The noise signal is the same in all cases. Only the amplitude has been changed in order to reach the specified SNR. In all cases, the sampling interval is set to 2 ms, the wavelet central frequency is 35 Hz, and the length of the series is 500 samples, for a simulation time of 1 second.

The second case corresponds to a real seismic gather, composed of 28 traces, as shown in Fig. 4
                        (A), and obtained from a seismic survey on an oil field in central Mexico. The sampling interval is 4 ms, the time interval comprises from 1 to 6 seconds (1250 samples). The traces have offsets which increase by 100 m each time. This gather has been selected due to the features present in the signal, one clearly observable at around 2 seconds.

@&#RESULTS@&#


                        Fig. 2 shows the results of the TS-LHE analysis for different fBm series, with H values ranging from 0.5 to 1.0. Here, the TS-LHE analysis has been computed for windows sizes of 
                           
                              Ws
                           
                           =
                           [
                           8
                           –
                           200
                           ]
                        , which means that at 
                           
                              
                                 Ws
                              
                              
                                 max
                              
                           
                        , the analysis shows a degree of correlation of the i-th sample in the time series, with the previous and posterior 100 samples.

In Fig. 2(A), 
                           
                              
                                 fBm
                              
                              
                                 H
                                 =
                                 0.5
                              
                           
                        , the TS-LHE analysis shows that the time series is predominantly close to 
                           H
                           =
                           0.5
                        , a random walk. Nevertheless, the analysis also shows that the time series presents various degrees of correlation at different scales. At lower scales (below scale 20) most of the signal shows short-range dependencies, because the values of H are close to 0.9 at specific points. Also, other areas indicate that the time series has correlations up to the scale 70, which means that dependencies on these regions can span up to 35 samples around, as it is the case of the area highlighted in the red square, at samples 70 to 170. Even if the time series has a global characteristic of 
                           H
                           =
                           0.5
                        , the TS-LHE shows that, at particular points, there may be local correlations among samples.

Likewise, in Fig. 2(B) to (F), the TS-LHE analysis shows that fBm series has different degrees of dependencies. In general, all time series present short-range correlations at lower scales (up to scale 20), with values of H reaching 0.9 at specific locations. On the other hand, as the global H of the fBm series increases, the TS-LHE analysis also shows higher values of local H's, independently of the scale.

These results indicate that the TS-LHE could reveal local dependencies in sections of a time series. Also, in TS-LHE analysis, the scales play a role analogue to scales in multi-resolution wavelet transforms, in which a pseudo-frequency can be estimated. In the case of the TS-LHE, the scales role is to indicate the range of dependencies in the time series. For example, lower scales evaluate short-range correlations, and as the scale increases, longer-range correlations are tested.


                        Fig. 3(A) to (D) shows the TS-LHE analysis of a synthetic seismogram under four SNR conditions. In all cases, the TS-LHE has been obtained for scales 
                           
                              Ws
                           
                           =
                           [
                           8
                           –
                           100
                           ]
                        . Also, the mean TS-LHE between scales 15 to 30 is shown (mean H), together with a continuous wavelet transform, performed with the Daubechies 4 wavelet, for scales 1 to 64. The resulting synthetic has attenuated spikes, some of which are not easily observable. Thus, small red marks, located at the time position of the spikes, are shown in the left of the time series, and in the right of the mean H.

In general, in Fig. 3, the TS-LHE analysis shows that at lower scales (
                           
                              Ws
                           
                           ≤
                           25
                        ) the values of H are larger than 0.7, which indicates a persistent behavior. As the scales increases, the H value decreases, except in the areas where the long-range correlations of the signal are present, as those shown at times 0.2 s or 0.5 to 0.6 s, where values of 
                           H
                           ∼
                           0.7
                         can reach scales of 
                           
                              Ws
                           
                           =
                           100
                        .

In Fig. 3(A), the TS-LHE analysis is performed to the noise free synthetic. Here, the mean H is used to see where behavior changes take place in the synthetic. These are characterized by abrupt variations of the values of H, in this case, from 
                           H
                           =
                           0.7
                         to 
                           H
                           =
                           0.5
                         (deflection to the left). It is worth to mention that the analysis detects the behavior changes, regardless the amplitude of the spikes, some of which are strongly attenuated. Also, due to the similarity of the patterns in the TS-LHE and the mean H, it is fair to say that all detected events have similar characteristics, excluding the amplitude.

The synthetic seismograms with added noise are shown in Fig. 3(B) to (D), with SNR of 10, 5 and 2 dB, respectively. From the TS-LHE analysis and the mean H, it is possible to observe the influence of the noise. In all cases, the patterns of the TS-LHE image are similar. Nevertheless, by observing the mean H in Fig. 3(B) to (D), it is not clear where all the events in the synthetic are. Following the behavior observed in Fig. 3(A), where deflections to the left of the mean H can be used to detect events, in some cases, false positives can be considered. In order to estimate the ability to correctly identify an event, a simple precision analysis is proposed. It consists of counting the true positives (TP), that is, the spikes correctly identified, and the false positives (FP), which are the spikes incorrectly identified. The precision is obtained as 
                           P
                           =
                           
                              TP
                           
                           /
                           (
                           
                              TP
                           
                           +
                           
                              FP
                           
                           )
                        . The results for the present experiments are shown in Fig. 5
                        . For the noise free seismogram, all the events are correctly detected, with no false positives. This contrast with the results obtained from the other three cases, where around half of the detections are false.

The TS-LHE results are compared with a CWT analysis, where the presence of some spikes is unmistakable, and correctly detected, particularly those with higher energy. However, the spikes with lower energy are not easily spotted. In contrast, the TS-LHE analysis is not sensitive to the amplitude, but only to pattern changes in the time series. On the other hand, the TS-LHE is more sensitive to noise than the CWT analysis, which provides more stable results under the tested conditions. It is therefore important to use data with high SNR in the proposed method.


                        Fig. 4(A) shows a real seismic gather with 28 traces, as well as the amplitude spectrum of the stacked gather (Fig. 4(B)). The dotted line corresponds to the shallow section from 1 to 3.5 s, and the continuous line to the remaining part, from 3.5 to 6 s.

On Fig. 6
                        (A) to (F), the TS-LHE analyzes of the individual traces 1, 7, 14, 19, 21 and 28, respectively, are shown. These traces are selected to show the spatial behavior of the TS-LHE analysis for a seismic gather. For comparison purposes, the CWT, together with the instantaneous frequency and phase [20] are also obtained. The mean value of the TS-LHE, between scales 40 to 80, is included. The TS-LHE is calculated for scales 
                           
                              Ws
                           
                           =
                           [
                           8
                           –
                           150
                           ]
                        , and the CWT is obtained with the Daubechies 4 wavelet, for scales from 1 to 64.

Different features present in the gather are noticeable, one clearly identifiable at 2 seconds, corresponding to a high seismic energy pattern. Other events are not easily detectable from a visual inspection. Nevertheless, from the TS-LHE analysis shown in Fig. 6, it is possible to suggest where other patterns are likely to be present in the trace, due to changes in the behavior of the signal, which are detected as fast variations of the TS-LHE analysis.

In Fig. 6, the mean value of the Local Hurst Exponent, between scales 40 to 80, is used to highlight the areas where the traces have behavioral changes within 20 to 40 samples, around each time-step. Five of them have been numbered, shown between it and the TS-LHE graph. These areas correspond to zones where the mean H has fast variations, which are related to changes in the frequency or phase of the signal. This can be appreciated in the instantaneous frequency and phase shown in Fig. 6(A) to (F).

The global behavior of the TS-LHE in the six traces (Fig. 6) can be considered through the numbered areas, and by observing the patterns in the TS-LHE images. In all cases, the area I is around time 1.5 s; area II is close to time 2 to 2.5 s; area III ranges from time 3 to 3.5 s; area IV is around 4 to 4.5 s; and area V is between 5 and 5.5 s. Comparison of these results with the CWT shows that the latter also highlights some of these patterns, specifically those with high energy. This is the case of the areas marked as II and V, which are clearly visible in Fig. 6(B) to (F). The other areas are not so clear in the CWT analysis. However, in Fig. 6(D) to (F), signs of patterns related to areas III and IV can be appreciated. This shows that there is a spatial coherence in the results of the TS-LHE, which is consistent with the seismic image of the gather, and with the CWT analysis.

The TS-LHE is also useful for spotting signals variations transcending over scales. At higher scales, the analysis aids to draw attention to the sections of the seismic trace that have long-range correlations, as those around 3 to 4 seconds in Fig. 6(A) to (F), in which the TS-LHE values are larger than 0.7. This indicates a degree of persistence, meaning that in this area the patterns have a long-range correlation, up to 100 samples. A different case can be observed in the high energy event at 2 seconds, which has no long range correlations, because H is near 0.5 for 
                           
                              Ws
                           
                           >
                           20
                        .

@&#CONCLUSIONS@&#

In this paper, a systematic method for estimating the Time-Scale Local Hurst Exponent is presented and tested. The preliminary results applying this TS-LHE to fBm and seismic time series show that it is possible to identify changes on series behavior, such as frequency or phase variations. Because the LHE is a function of time, this information is related to the time when the changes occur.

Also, it is shown that even if the features are strongly attenuated in the time series, the TS-LHE method detects them, allowing comparisons between sections of the time series. In order to detect changes on series behavior, it is necessary to observe how the Local Hurst Exponent fluctuates along the time series: if it is mainly constant, regardless of its value, it means that the series behavior is also constant; when the variation is fast, it means that the series has suffered a sudden change as well. As a general rule, small scales lead to results related to short-range correlations. As scales increase, long-range correlations tend to be more significant, and very large scales are similar to a global Hurst Exponent evaluation.

Regarding the applications of the TS-LHE to seismic analysis, it can be useful as an additional tool that provides extra information on the complexity of the seismic data. Furthermore, temporal and scale variations of the local Hurst exponent may be a sensitive indicator capable of providing information on the fractal structure of seismic events present in the series.

It has been observed that the TS-LHE method is notably sensitive to noise. Therefore, the SNR of the data needs to be considered. Also, the algorithm complexity is relevant, leading to a significant computational cost, particularly if the aim is to analyze a very large range of scales.

A key difference between the proposed TS-LHE method and the CWT is that, in the latter, the energy of the signal has a strong influence on the results of the analysis. However, it may be difficult to detect singularities with relatively small amplitudes in the time series. In the case of the TS-LHE analysis, the amplitude does not influence the results, because it only tests and emphasizes the correlations and changes in patterns behavior, regardless their amplitude.

@&#ACKNOWLEDGEMENTS@&#

Author EMMR thanks the Mexican National Council for Science and Technology (CONACYT) for its Postdoctoral financial support. The authors acknowledge the support of projects PAPIIT 
                  IN100813 and CONACYT 
                  176556. The authors also thank the reviewers for their constructive comments.

Supplementary material related to this article can be found online at http://dx.doi.org/10.1016/j.dsp.2014.11.007.

The following is the Supplementary material related to this article.
                        
                           MMC 1
                           
                              Analysis results of the 28 traces of the seismic gather. In all cases, the time series is in the first column. The following columns show the instantaneous frequency and phase, smoothed with a simple moving average of 4 samples; the mean TS-LHE from scales [40–80], and smoothed with a simple moving average of 4 samples; the TS-LHE analysis with scales Ws
                                 =[8–150]; and finally, the continuous wavelet transform (Daubechis 4, scales from 1 to 64).
                           
                           
                        
                     
                  

@&#REFERENCES@&#

