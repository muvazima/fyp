@&#MAIN-TITLE@&#All-integer column generation for set partitioning: Basic principles and extensions

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Column generation without making a linear programming relaxation.


                        
                        
                           
                           All-integer method based on simplex pivots between unimodular bases.


                        
                        
                           
                           Column generation tailored for finding columns that enable all-integer pivots.


                        
                        
                           
                           Allows the inclusion of any method for finding improved integer solutions.


                        
                        
                           
                           Customised optimality conditions to determine when the restricted master problem contains an optimal solution.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Integer programming

Column generation

Set partitioning

Quasi-integrality

All-integer pivots

@&#ABSTRACT@&#


               
               
                  Column generation, combined with an appropriate integer programming technique, has shown to be a powerful tool for solving huge integer programmes arising in various applications. In these column generation approaches, the master problem is often of a set partitioning type.
                  The set partitioning polytope has the quasi-integrality property, which enables the use of simplex pivots for finding improved integer solutions, each of which is associated with a linear programming basis. By combining such pivots with column generation, one obtains a method where each found solution to a restricted master problem is feasible, integer, and associated with a dual solution that can be used in a column generation step.
                  This paper presents a framework for such an all-integer column generation approach to set partitioning problems. We give the basic principles of all-integer pivots and all-integer column generation. We also state optimality conditions and introduce means for preserving a basis in the event that a heuristic is applied to the master problem. These extensions introduce flexibility in the design of a specific solution scheme of this kind, and with proper settings optimal or approximate solutions can be sought for.
               
            

@&#INTRODUCTION@&#

Column generation is a linear programming method that is designed for solving problems that have huge numbers of variables, but also a certain structure. When complemented with a suitable integer programming technique, column generation has proven to be successful in solving many large scale integer programmes. A well known strategy of this type is branch-and-price, where column generation is embedded in a branch-and-bound scheme, see Barnhart, Johnson, Nemhauser, Savelsbergh, and Vance (1998) and Vanderbeck (2011). For surveys of column generation and applications within integer programming, see Lübbecke and Desrosiers (2005) and Wilhelm (2001). Our work originates from the fact that many applications of column generation give rise to master problems of a set partitioning type, as for example aircrew rostering problems, see Gamache, Soumis, Marquis, and Desrosiers (1999), and the generalised assignment problem, see Barnhart et al. (1998).

The feasible set of the linear programming relaxation of the set partitioning problem possesses the quasi-integrality property, which means that for the polytope of feasible solutions, every edge of the convex hull of the integer points is also an edge of the polytope itself. This property makes it possible to utilise linear programming techniques for finding improved integer solutions, an idea which was first explored by Trubin (1969). It was later somewhat more thoroughly described and named the integral simplex method in Yemelichev, Kovalev, and Kravtsov (1984). The integral simplex method only acts as a local search method, but complemented with a branching strategy, as in the implementation made by Thompson (2002), the finding of an optimal solution can be ensured. In Rönnberg and Larsson (2009), based on results in Balas and Padberg (1972), it is shown how the column generation principle can be integrated with the integral simplex method, and how a branching strategy can be used to ensure the finding of an optimal solution.

The work to be presented in this paper is a continuation of the research published in Rönnberg and Larsson (2009), Rönnberg (2012, 2008), although we here consider more general pivots than those used in the integral simplex method and Rönnberg and Larsson (2009); these are called all-integer pivots. We develop the basic principles of all-integer column generation for set partitioning problems, together with several extensions.

To be more precise, we consider column generation problems that are consistent with all-integer pivots, state optimality conditions for the integer problem and use the concept of over-generation of columns, which means generating not only an optimal column but several, by generating near-optimal solutions to a regular column generation subproblem. This can be used as an additional way to augment the master problem, or for generating enough columns for guaranteeing that the master problem can provide an integer optimal solution.

Further, so called surrogate columns are introduced. These facilitate the use of combinatorial heuristics on the master problem within a framework of all-integer column generation. This feature is of interest because strategies for how to combine column generation and heuristics are not very well explored in the literature, although the development of such strategies seem to attract more attention; see for example (Joncour, Michel, Sadykov, Sverdlov, & Vanderbeck, 2010), which gives an overview, and also the SearchCol project (Metaheuristic Search by Column Generation, 2013) on this topic.

Although the overall approach is primarily introduced as being of a metaheuristic nature, criteria for determining whether a solution is optimal or near-optimal are also available. Key characteristics of the approach are that all successively found solutions are feasible and integral, and that the integrality requirement on the variables are handled differently from what has previously been described in the column generation literature.

The outline of the paper is as follows. Section 2 introduces notations and other prerequisites. Section 3 presents the foundations and principles of all-integer column generation for set partitioning: the quasi-integrality property, all-integer pivots, and all-integer column generation. The pivoting step naturally separates into the non-degenerate and degenerate cases, which aim at a primal and a dual improvement of the solution respectively. The same cases hold for the column generation step, and we show how the all-integer column generation subproblem can be tailored to produce columns enabling either non-degenerate or degenerate pivots.

Section 4.1 derives the surrogate column pivot, which enables making an all-integer pivot from an integer feasible solution with a known basis, to another integer feasible solution for which no basis is known. Section 4.2 gives optimality conditions for the integer problem and outlines the over-generation strategy. In Section 4.3, the generalised assignment problem is used to illustrate the formulation of the all-integer column generation subproblems and how to transform the subproblems into a more suitable form. This transformation is believed to be of critical importance from a computational point of view. Also presented in this section are some simple computational experiments that illustrate the behaviour of the core components of the all-integer column generation approach. Some reflections on the overall methodology follows in Section 5, together with some ideas for future work.

Before proceeding with our presentation we would like to mention that one of the reviewers drew our attention to an interesting parallel work of Zaghrouti, Soumis, and El Hallaoui (2013). The similarity to our work is that they utilise the quasi-integrality property to come up with an efficient way to generate linear programming pivots leading to integer extreme points. For this purpose they use a direction-finding subproblem that can be solved efficiently and they present excellent computational results for set partitioning problems with up to 500,000 variables. The main difference is that (Zaghrouti et al., 2013) do not consider a column generation setting.

The set partitioning problem to be solved is
                        
                           
                              
                                 
                                    
                                       
                                          [
                                          
                                             
                                                SPP
                                             
                                             
                                                N
                                             
                                          
                                          ]
                                          
                                          
                                             
                                                z
                                             
                                             
                                                ∗
                                             
                                          
                                          =
                                          
                                       
                                    
                                    
                                       
                                          
                                             min
                                          
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   N
                                                
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                          
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   N
                                                
                                             
                                          
                                          
                                             
                                                a
                                             
                                             
                                                ij
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                          =
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                          i
                                          ∈
                                          M
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                          ∈
                                          {
                                          0
                                          ,
                                          1
                                          }
                                          ,
                                          
                                          j
                                          ∈
                                          N
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Here, 
                        
                           N
                        
                      and M
                     ={1, …, m} are the sets of indices for the variables respective constraints. Further, c
                     
                        j
                     
                     ∈
                     R, 
                        
                           j
                           ∈
                           N
                           ,
                           
                           
                              
                                 a
                              
                              
                                 ij
                              
                           
                           ∈
                           {
                           0
                           ,
                           1
                           }
                           ,
                           
                           i
                           ∈
                           M
                           ,
                           
                           j
                           ∈
                           N
                        
                     , and e
                     
                        i
                     
                     =1, i
                     ∈
                     M. We assume that 
                        
                           |
                           N
                           |
                           ⩾
                           m
                        
                      and that the problem is feasible. Let a
                     
                        j
                     
                     =(a
                     1j
                     , …, a
                     
                        mj
                     )T, 
                        
                           j
                           ∈
                           N
                        
                     , and assume, with no loss of generality, that the matrix 
                        
                           (
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 a
                              
                              
                                 |
                                 N
                                 |
                              
                           
                           )
                        
                      has no zero column and full rank.

In a column generation setting, problem 
                        
                           
                              
                                 SPP
                              
                              
                                 N
                              
                           
                        
                      is referred to as the complete master problem. Let 
                        
                           P
                           =
                           {
                           (
                           
                              
                                 c
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 j
                              
                           
                           )
                           :
                           j
                           ∈
                           N
                           }
                           ⊆
                           Z
                           ×
                           
                              
                                 {
                                 0
                                 ,
                                 1
                                 }
                              
                              
                                 m
                              
                           
                        
                      be the set of columns. This set typically corresponds to the set of feasible solutions to an optimisation problem and it is typically huge. In an application there might be columns that are identical except for their costs, and in such cases, only the cheapest one will be contained in 
                        
                           P
                        
                     ; hence a
                     
                        j
                     
                     ≠
                     a
                     
                        k
                      whenever j
                     ≠
                     k.

Let SPP
                        N
                      be a restricted set partitioning problem, or restricted master problem, where the variables with indices 
                        
                           N
                           =
                           {
                           1
                           ,
                           …
                           ,
                           n
                           }
                           ⊂
                           N
                        
                      are at hand. It is assumed that n
                     ⩾
                     m, that SPP
                        N
                      is feasible, and that the matrix A
                     =(a
                     1, …, a
                     
                        n
                     ) has full rank. An optimal solution and the optimal objective value of SPP
                        N
                      are denoted by 
                        
                           
                              
                                 x
                              
                              
                                 ̃
                              
                           
                        
                      and 
                        
                           
                              
                                 z
                              
                              
                                 ̃
                              
                           
                        
                     , respectively.

Let 
                        
                           
                              
                                 SPP
                              
                              
                                 N
                              
                              
                                 LP
                              
                           
                        
                      be the linear programming relaxation of SPP
                        N
                     , with x
                     
                        j
                     
                     ∈{0, 1} replaced by x
                     
                        j
                     
                     ⩾0, j
                     ∈
                     N. Because the feasible set is contained within the unit hypercube, all feasible integer points will be extreme points of the polytope describing the feasible set of 
                        
                           
                              
                                 SPP
                              
                              
                                 N
                              
                              
                                 LP
                              
                           
                        
                     . For an extreme point to 
                        
                           
                              
                                 SPP
                              
                              
                                 N
                              
                              
                                 LP
                              
                           
                        
                     , denote a basis by B
                     ⊆{a
                     1, …, a
                     
                        n
                     }; if an extreme point is degenerate, it is associated with more than one basis. For a given basis, let I and J denote the corresponding sets of basic and non-basic columns respectively, let x
                     
                        B
                     
                     =(x
                     
                        j
                     )
                        j∈I
                      and x
                     
                        N
                     
                     =(x
                     
                        j
                     )
                        j∈J
                      be the corresponding basic and non-basic components of x, and let Q
                     ⊆
                     I be the set of basic variables that take the value one. The notations B, I, J and Q will sometimes be used together with a superscript referring to the extreme point with which they are associated. Further, let 
                        
                           
                              
                                 e
                              
                              
                                 ¯
                              
                           
                           =
                           
                              
                                 B
                              
                              
                                 -
                                 1
                              
                           
                           e
                        
                     , where e
                     =(e
                     1, …, e
                     
                        m
                     )T, and 
                        
                           
                              
                                 
                                    
                                       a
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 j
                              
                           
                           =
                           
                              
                                 B
                              
                              
                                 -
                                 1
                              
                           
                           
                              
                                 a
                              
                              
                                 j
                              
                           
                           ,
                           
                           j
                           ∈
                           N
                        
                     , be the updated right-hand-side and constraint columns respectively. The complementary dual solution is 
                        
                           
                              
                                 u
                              
                              
                                 T
                              
                           
                           =
                           
                              
                                 c
                              
                              
                                 B
                              
                              
                                 T
                              
                           
                           
                              
                                 B
                              
                              
                                 -
                                 1
                              
                           
                        
                     , where c
                     
                        B
                     
                     =(c
                     
                        j
                     )
                        j∈I
                     , and the reduced costs are 
                        
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 j
                              
                           
                           =
                           
                              
                                 c
                              
                              
                                 j
                              
                           
                           -
                           
                              
                                 u
                              
                              
                                 T
                              
                           
                           
                              
                                 a
                              
                              
                                 j
                              
                           
                           ,
                           
                           j
                           ∈
                           J
                        
                     .

For 
                        
                           
                              
                                 SPP
                              
                              
                                 N
                              
                              
                                 LP
                              
                           
                        
                     , with basis B and dual solution u, the column generation subproblem
                        
                           
                              
                                 
                                    
                                       
                                          [
                                          CG
                                          ]
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                p
                                             
                                          
                                          =
                                          
                                       
                                    
                                    
                                       
                                          
                                             min
                                          
                                          
                                          c
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                a
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                          
                                          
                                          (
                                          c
                                          ,
                                          a
                                          )
                                          ∈
                                          P
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     is used to produce a column (c
                     
                        p
                     , a
                     
                        p
                     ) that can be added to the restricted master problem. For future reference, we note that if the column generation is made using a dual feasible solution with respect to the problem 
                        
                           
                              
                                 SPP
                              
                              
                                 N
                              
                              
                                 LP
                              
                           
                        
                     , then the generated column (c
                     
                        p
                     , a
                     
                        p
                     ) is never already included in the restricted master problem SPP
                        N
                      (unless dual feasibility holds also in 
                        
                           
                              
                                 SPP
                              
                              
                                 N
                              
                              
                                 LP
                              
                           
                        
                     , in which case 
                        
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 p
                              
                           
                           =
                           0
                        
                     ). If however, the column generation is made using a dual infeasible solution with respect to 
                        
                           
                              
                                 SPP
                              
                              
                                 N
                              
                              
                                 LP
                              
                           
                        
                     , then it might happen that the column (c
                     
                        p
                     , a
                     
                        p
                     ) is already included in the restricted master problem.

@&#BACKGROUND@&#

This section presents the theoretical background needed for the results to be presented in this paper. The first results are on the polyhedral structure of the set partitioning problem and trace all the way back to the sixties (Trubin, 1969), followed by recent results from Rönnberg and Larsson (2009) that introduce a way of utilising this polyhedral structure in a column generation setting.

One way of finding an improved solution to the restricted master problem is to use the integrality preserving pivots to be presented in this section. This approach is possible because the polytope of feasible solutions of 
                           
                              
                                 
                                    SPP
                                 
                                 
                                    N
                                 
                                 
                                    LP
                                 
                              
                           
                         has the quasi-integrality property, which implies that all integer extreme points can be reached by making simplex pivots between integer extreme points; this is referred to as the integral simplex method. The difficulty lies in the finding of bases that enable such pivots that lead to improved solutions, and if no such basis is found, the method will stop at a local optimum.

The following definition is from Yemelichev et al. (1984).
                           Definition 1
                           Let X be a polytope and X
                              
                                 I
                               its set of integer points. The polytope X is called quasi-integral if every edge of the convex hull of X
                              
                                 I
                               is also an edge of X.

The quasi-integrality property holds if each pair of integer extreme points belongs to an integral face of the polytope describing the set of feasible solutions to the linear programming relaxation of the integer problem (Yemelichev et al., 1984). By an integral face is meant a face that has the integrality property, which holds if the face can be described by constraints of which the matrix is totally unimodular. The following theorem was first shown by Trubin (1969).
                           Theorem 1
                           
                              The feasible polytope of 
                              
                                 
                                    
                                       
                                          SPP
                                       
                                       
                                          N
                                       
                                       
                                          LP
                                       
                                    
                                 
                               
                              is quasi-integral.
                           

A movement between two integer extreme points can be achieved algebraically through a non-degenerate simplex pivot on a one entry. Not all bases associated with an integer extreme point enable such a pivot, and because of degeneracy it can be difficult to find a basis that does. In the implementation of the integral simplex method made by Thompson (2002), which is the only one that we know of, the method starts from an artificial basis and then performs simplex pivots on one-entries. A pivot on a one-entry is henceforth referred to as a pivot-on-one, and it can be either degenerate or non-degenerate. When making pivots-on-one only, it is possible to reach a basis that is non-optimal and where it is not possible to perform a pivot-on-one; this situation is referred to as a local optimum. Another difficulty is that there is no known way to prevent cycling in the integral simplex method. For more information on quasi-integrality and the integral simplex method, see Trubin (1969); Yemelichev et al. (1984); Thompson (2002); and Rönnberg and Larsson (2009).

We consider a slight extension of pivots-on-one, called all-integer pivots, see Rönnberg (2012). It is motivated by the results below. For future reference, we begin with the following definition.
                           Definition 2
                           A linear programming basis B is unimodular if ∣det(B)∣=1.

Unimodular bases are of special interest when working with integer solutions to set partitioning problems, as stated in the following lemma, the proof of which is elementary using Cramer’s rule.
                           Lemma 1
                           
                              If some basis for an extreme point to 
                              
                                 
                                    
                                       
                                          SPP
                                       
                                       
                                          N
                                       
                                       
                                          LP
                                       
                                    
                                 
                               
                              is unimodular, then the extreme point is integral.
                           

This sufficient condition for an extreme point to be integral is not necessary however, and there are even cases where none integer extreme point is associated with a unimodular basis; for an example of this, see Rönnberg (2012).

To preserve integrality when pivoting, a sufficient condition is to restrict the pivots to be between unimodular bases only, and this observation naturally leads to the following definition.
                           Definition 3
                           Given a unimodular basis associated with a feasible solution to 
                                 
                                    
                                       
                                          SPP
                                       
                                       
                                          N
                                       
                                       
                                          LP
                                       
                                    
                                 
                               and an s
                              ∈
                              J such that 
                                 
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          s
                                       
                                    
                                    <
                                    0
                                 
                              . An all-integer pivot is,
                                 
                                    (i)
                                    in the non-degenerate case a pivot made on an entry 
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   rs
                                                
                                             
                                             =
                                             1
                                          
                                        such that
                                          
                                             
                                                
                                                   
                                                      
                                                         min
                                                      
                                                      
                                                         i
                                                         ∈
                                                         M
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           e
                                                                        
                                                                        
                                                                           ¯
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           a
                                                                        
                                                                        
                                                                           ¯
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     is
                                                                  
                                                               
                                                            
                                                         
                                                         :
                                                         
                                                            
                                                               
                                                                  
                                                                     a
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                            
                                                               is
                                                            
                                                         
                                                         >
                                                         0
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  e
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            rs
                                                         
                                                      
                                                   
                                                
                                                =
                                                1
                                                ;
                                             
                                          
                                       
                                    

in the degenerate case a pivot made on an entry 
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   rs
                                                
                                             
                                             =
                                             ±
                                             1
                                          
                                        such that 
                                          
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   r
                                                
                                             
                                             =
                                             0
                                          
                                       .

The following theorem states a sufficient condition for a sequence of pivots to be between integer solutions only. The proof is straightforward, using that the determinant of the pivot matrix (see e.g. Murty, 1983, p. 141) is ±1, and can be found in Rönnberg (2012).
                           Theorem 2
                           
                              Starting from a feasible unimodular basis for 
                              
                                 
                                    
                                       
                                          SPP
                                       
                                       
                                          N
                                       
                                       
                                          LP
                                       
                                    
                                 
                              
                              , a sufficient condition for a sequence of pivots to yield a path of integer extreme points is that the pivots are all-integer.
                           

A non-degenerate pivot-on-one from a basis which is not unimodular can lead to a non-integer extreme point, as shown in an example in Rönnberg (2012).

If the column chosen to enter the basis has a negative reduced cost, then a non-degenerate pivot-on-one at a unimodular basis associated with an integer extreme point will lead to another integer extreme point and yield a primal improvement. A degenerate pivot, on the other hand, will not yield any primal improvement; instead the purpose of a degenerate pivot, if it is not also dual degenerate, is to decrease the dual infeasibility.

In the integral simplex method implemented by Thompson (2002), only pivots on positive entries are allowed to be made. Our extension, to also allow the degenerate pivots to be on a minus one entry, increases the number of possible pivots and could therefore decrease the risk of getting trapped at a local optimum. We do not know of an anti-cycling rule for the all-integer pivots, and we consider this to be a challenging topic for future research.

We here present the all-integer column generation strategy for augmenting the restricted master problem with new columns. This strategy employs a column generation problem that is restricted to find only such columns that will enable all-integer pivots, either non-degenerate or degenerate. All-integer column generation relies on that a basis, and thereby also a dual solution, for the current integer extreme point is available. The results below are based on those in Sections 2.1.1 and 2.1.2 of Rönnberg and Larsson (2009).

To begin with the non-degenerate case, the corollary to follow was originally presented as Corollary 4 in Rönnberg and Larsson (2009), which in turn is an adaptation of Corollary 2.1 of Balas and Padberg (1972) to the setting used in Rönnberg and Larsson (2009), and now also in this paper. The corollary provides necessary and sufficient conditions for a column to enable a non-degenerate pivot-on-one.
                           Corollary 1
                           
                              Given an integer extreme point to 
                              
                                 
                                    
                                       
                                          SPP
                                       
                                       
                                          N
                                       
                                       
                                          LP
                                       
                                    
                                 
                               
                              and an associated unimodular basis B, then, a column 
                              
                                 
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          s
                                       
                                    
                                    ,
                                    
                                       
                                          a
                                       
                                       
                                          s
                                       
                                    
                                    )
                                    ,
                                    s
                                    ∈
                                    N
                                    ⧹
                                    I
                                 
                              
                              , enables a non-degenerate pivot-on-one if and only if
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             is
                                          
                                       
                                       ∈
                                       [
                                       -
                                       1
                                       +
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ]
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         [
                                                         0
                                                         ,
                                                         1
                                                         ]
                                                         ,
                                                      
                                                      
                                                         i
                                                         ∈
                                                         M
                                                         :
                                                         
                                                            
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         =
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         [
                                                         -
                                                         1
                                                         ,
                                                         0
                                                         ]
                                                         ,
                                                      
                                                      
                                                         i
                                                         ∈
                                                         M
                                                         :
                                                         
                                                            
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              holds.
                           

Due to the unimodularity of B and the integrality of a
                        
                           s
                        , the value of 
                           
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    s
                                 
                              
                           
                         is always integral. By adding the condition of Corollary 1 as side constraints to CG, the non-degenerate all-integer column generation problem, AICG-ND, can be stated as follows.
                           
                              
                                 
                                    
                                       
                                          
                                             [
                                             AICG
                                             -
                                             ND
                                             ]
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                             =
                                             
                                          
                                       
                                       
                                          
                                             
                                                min
                                             
                                             
                                             c
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ∈
                                                      M
                                                   
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                             
                                             
                                             (
                                             c
                                             ,
                                             a
                                             )
                                             ∈
                                             P
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                   a
                                                   )
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               [
                                                               0
                                                               ,
                                                               1
                                                               ]
                                                               ,
                                                            
                                                            
                                                               i
                                                               ∈
                                                               M
                                                               :
                                                               
                                                                  
                                                                     
                                                                        
                                                                           e
                                                                        
                                                                        
                                                                           ¯
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               =
                                                               1
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               [
                                                               -
                                                               1
                                                               ,
                                                               0
                                                               ]
                                                               ,
                                                            
                                                            
                                                               i
                                                               ∈
                                                               M
                                                               :
                                                               
                                                                  
                                                                     
                                                                        
                                                                           e
                                                                        
                                                                        
                                                                           ¯
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               =
                                                               0
                                                               .
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        If 
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    p
                                 
                              
                              <
                              0
                           
                         holds for a solution (c
                        
                           p
                        , a
                        
                           p
                        ) to AICG-ND, then this column can be added to SPP
                        
                           N
                         and there enable a non-degenerate pivot-on-one, by letting its corresponding variable enter the basis.

In order to enable a degenerate all-integer pivot with a variable x
                        
                           s
                         entering the basis, it is sufficient to find a pivot element 
                           
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    rs
                                 
                              
                              =
                              ±
                              1
                           
                         for a row r
                        ∈
                        M such that 
                           
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    r
                                 
                              
                              =
                              0
                           
                        . Adding this requirement to CG, the degenerate all-integer column generation problem, AICG-D, becomes as follows.
                           
                              
                                 
                                    
                                       
                                          
                                             [
                                             AICG
                                             -
                                             D
                                             ]
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                             =
                                             
                                          
                                       
                                       
                                          
                                             
                                                min
                                             
                                             
                                             c
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ∈
                                                      M
                                                   
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                             
                                             
                                             (
                                             c
                                             ,
                                             a
                                             )
                                             ∈
                                             P
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                   a
                                                   )
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             ±
                                             1
                                             
                                             for
                                             
                                             some
                                             
                                             i
                                             ∈
                                             M
                                             :
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        If 
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    p
                                 
                              
                              <
                              0
                           
                         holds for a solution (c
                        
                           p
                        , a
                        
                           p
                        ) to AICG-D, then this column can be added to SPP
                        
                           N
                         and there enable a degenerate pivot-on-one, by letting its corresponding variable enter the basis. In Rönnberg and Larsson (2009) it is shown how the extra restriction added in AICG-D can be stated as linear constraints by using auxiliary binary variables.

For a specific application of all-integer column generation to the problem 
                           
                              
                                 
                                    SPP
                                 
                                 
                                    N
                                 
                              
                           
                        , where the column set 
                           
                              P
                           
                         is described by regular constraints, the side constrained column generation problems AICG-ND and AICG-D can be restated as linear integer programmes, in a straightforward way.

The results presented above provide a platform for an all-integer column generation approach for set paritioning problems. The possibilites for how to design an algorithm based only on this approach are however limited. This section presents the theoretical foundations for extensions which give more options in the design of an all-integer column generation algorithm. The first extention presented gives means for how to combine this approach with any method for finding improved integer feasible solutions to the restricted master problem. The second extension provides optimality conditions for when the restricted master problem contains all the columns necessary for finding an optimal solution to 
                        
                           
                              
                                 SPP
                              
                              
                                 N
                              
                           
                        
                     . These optimality conditions are used to derive a column over-generation strategy for guaranteeing that an optimal solution can be found without the use of a branching strategy.

As observed in a computational experiment described in Section 4.3.3, the linear integer programming formulations of AICG-ND and AICG-D can be poorly conditioned due to ill-conditioning of the basis matrix B. These complications can however be overcome by performing a transformation introduced and illustrated on the generalised assignment problem in Section 4.3.2.

The subproblem used in column generation relies on dual information from the restricted master problem, and if a basis for the current extreme point is at hand, this dual information is readily available. In this section, it is shown that if an improved integer solution to SPP
                           N
                         is at hand, without an associated basis for this extreme point being known, then a basis can be constructed by performing a non-degenerate pivot-on-one.

We assume that a current integer extreme point x
                        
                           c
                         and an associated unimodular basis B
                        
                           c
                         are known. Further, let x
                        
                           n
                         be another integer extreme point, to be visited next but for which there is no known basis. The latter point could typically have been found by applying a heuristic to SPP
                           N
                        . The superscripts c and n will in the following be used to refer to various quantities related to the integer extreme points x
                        
                           c
                         and x
                        
                           n
                         respectively.

The following lemma describes the requirements for a non-degenerate pivot-on-one to lead to a unimodular basis at x
                        
                           n
                        .
                           Lemma 2
                           
                              Let x
                              
                                 c
                               
                              and x
                              
                                 n
                               
                              be two integer extreme points to 
                              
                                 
                                    
                                       
                                          SPP
                                       
                                       
                                          N
                                       
                                       
                                          LP
                                       
                                    
                                 
                              
                              . A pivot on the entry 
                              
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          rs
                                       
                                       
                                          c
                                       
                                    
                                 
                               
                              from the unimodular basis B
                              
                                 c
                               
                              at x
                              
                                 c
                               
                              is a non-degenerate pivot-on-one leading to a unimodular basis at x
                              
                                 n
                               
                              if and only if
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             is
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                      
                                                         i
                                                         =
                                                         r
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         ,
                                                      
                                                      
                                                         i
                                                         ∈
                                                         M
                                                         ⧹
                                                         {
                                                         r
                                                         }
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

For a non-degenerate pivot-on-one 
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          rs
                                       
                                       
                                          c
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                e
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          r
                                       
                                       
                                          c
                                       
                                    
                                    =
                                    1
                                 
                               holds, and by definition of a simplex pivot, for 
                                 
                                    i
                                    ∈
                                    M
                                    ⧹
                                    {
                                    r
                                    }
                                    ,
                                    
                                       
                                          
                                             
                                                e
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                e
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          c
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   is
                                                
                                                
                                                   c
                                                
                                             
                                             /
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   rs
                                                
                                                
                                                   c
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                e
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          r
                                       
                                       
                                          c
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                e
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          c
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          is
                                       
                                       
                                          c
                                       
                                    
                                 
                              , that is, 
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          is
                                       
                                       
                                          c
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                e
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          c
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                e
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                 
                              . □

If there is no such updated column, then it is not possible to pivot directly from the basis B
                        
                           c
                         of x
                        
                           c
                         to x
                        
                           n
                        . By augmenting SPP
                           N
                         with a properly chosen auxiliary variable, y, whose column fulfils the requirements of Lemma 2, it is however possible to make a pivot leading to a unimodular basis B
                        
                           n
                         at an extreme point (x, y)
                           n
                         of the augmented problem. As shown below, the auxiliary column will always be of the kind specified in the following definition.
                           Definition 4
                           Let S
                              ⊆
                              N with ∣S∣⩾2. Then a positive linear combination of the columns (c
                              
                                 j
                              , a
                              
                                 j
                              ), j
                              ∈
                              S, is called a surrogate column.

The name surrogate column stems from that a linear combination of constraints is known as a surrogate constraint, see e.g. Taha (1975), and that a linear combination of columns is the dual correspondence thereof. A simplex pivot on a surrogate column corresponds to moving through the relative interior of the feasible set, and in linear programming, this idea is far from new; already in 1951 the so-called feasible direction method was introduced by Brown and Koopmans (1951). Further work along this line has been carried out for example by Eiselt and Sandblom (1985) and Murty and Fathi (1984).

If the surrogate column shall be of a set partitioning type, the only viable alternative is that it is a sum of orthogonal original columns. The value of a surrogate variable can easily be re-expressed in terms of values of the original variables, as shown in the following lemma.
                           Lemma 3
                           
                              Let the columns {a
                              
                                 j
                              }
                                 j∈S⊆N
                               
                              be orthogonal and suppose that 
                              
                                 
                                    
                                       
                                          SPP
                                       
                                       
                                          N
                                       
                                       
                                          LP
                                       
                                    
                                 
                               
                              is augmented with the surrogate column
                              
                                 
                                    
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             y
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             y
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                S
                                             
                                          
                                       
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                 
                              
                              and its corresponding variable, denoted by y. Let 
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                 
                               
                              be an integer solution to the augmented problem. Then 
                              
                                 
                                    x
                                    =
                                    P
                                    (
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    ,
                                    S
                                    )
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              , with
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             P
                                          
                                          
                                             j
                                          
                                       
                                       (
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       ,
                                       S
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                         ,
                                                      
                                                      
                                                         j
                                                         ∈
                                                         S
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     ˆ
                                                                  
                                                               
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         ,
                                                      
                                                      
                                                         j
                                                         ∈
                                                         N
                                                         ⧹
                                                         S
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              is an integer solution to 
                              
                                 
                                    
                                       
                                          SPP
                                       
                                       
                                          N
                                       
                                       
                                          LP
                                       
                                    
                                 
                              
                              .
                           

The theorem to follow is instrumental for the construction of a surrogate column that represents the movement from x
                        
                           c
                         to x
                        
                           n
                        .
                           Theorem 3
                           
                              For 
                              
                                 
                                    
                                       
                                          SPP
                                       
                                       
                                          N
                                       
                                       
                                          LP
                                       
                                    
                                 
                              
                              , assume that an integer extreme point x
                              
                                 c
                              
                              , with an associated unimodular basis B
                              
                                 c
                              
                              , is known. Further, let x
                              
                                 n
                               
                              be another integer solution. Suppose that 
                              
                                 
                                    
                                       
                                          SPP
                                       
                                       
                                          N
                                       
                                       
                                          LP
                                       
                                    
                                 
                               
                              is augmented with the surrogate column
                              
                                 
                                    
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             y
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             y
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      c
                                                   
                                                
                                                ∩
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                 
                              
                              and its corresponding variable, denoted by y. Then, a pivot with the column a
                              
                                 y
                               
                              entering the basis is a non-degenerate pivot-on-one leading to a unimodular basis B
                              
                                 n
                               
                              at an integer extreme point 
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                ˆ
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                ˆ
                                             
                                          
                                          )
                                       
                                       
                                          n
                                       
                                    
                                    
                                    ≠
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          c
                                       
                                    
                                    ,
                                    0
                                    )
                                 
                               
                              of the augmented problem. Furthermore, 
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    P
                                    (
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                ˆ
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                ˆ
                                             
                                          
                                          )
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          J
                                       
                                       
                                          c
                                       
                                    
                                    ∩
                                    
                                       
                                          Q
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                              
                              .
                           

In a feasible integer solution, the columns of the variables that take the value one will cover each row exactly once, and when an all-integer pivot is performed, the variables that change value from zero to one, and from one to zero, must cover the same rows, that is,
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                (
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      c
                                                   
                                                
                                                ⧹
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      c
                                                   
                                                
                                                )
                                                ∩
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      c
                                                   
                                                
                                                ∩
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      c
                                                   
                                                
                                                ∩
                                                (
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ⧹
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      n
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      c
                                                   
                                                
                                                ∩
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                       .
                                    
                                 
                              
                           


                              Lemma 2 states the necessary properties for an updated column, if pivoted into the basis, to yield a non-degenerate pivot-on-one from x
                              
                                 c
                               to x
                              
                                 n
                              . Using the notation 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                               to refer to the column of the ith basic variable, the conditions of Lemma 2 can be rewritten as
                                 
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             is
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                      
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ∈
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         ∩
                                                         
                                                            
                                                               J
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         =
                                                         1
                                                         -
                                                         0
                                                         =
                                                         1
                                                         ,
                                                      
                                                      
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ∈
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         ∩
                                                         (
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         ⧹
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         )
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         =
                                                         1
                                                         -
                                                         1
                                                         =
                                                         0
                                                         ,
                                                      
                                                      
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ∈
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         ∩
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         =
                                                         0
                                                         -
                                                         0
                                                         =
                                                         0
                                                         ,
                                                      
                                                      
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ∈
                                                         (
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         ⧹
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         )
                                                         ∩
                                                         (
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         ⧹
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         )
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         =
                                                         0
                                                         -
                                                         1
                                                         =
                                                         -
                                                         1
                                                         ,
                                                      
                                                      
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ∈
                                                         (
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         ⧹
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         )
                                                         ∩
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              For s
                              ∈
                              J it holds that 
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          s
                                       
                                    
                                    =
                                    
                                       
                                          B
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          a
                                       
                                       
                                          s
                                       
                                    
                                 
                              , that is, 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          s
                                       
                                    
                                    =
                                    B
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          s
                                       
                                    
                                 
                              . The pivot that leads from B
                              
                                 c
                               to B
                              
                                 n
                               must have the following column entering the basis.
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             s
                                          
                                       
                                       =
                                       
                                          
                                             B
                                          
                                          
                                             c
                                          
                                       
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             s
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             s
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                M
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             is
                                          
                                          
                                             c
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      c
                                                   
                                                
                                                ∩
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      c
                                                   
                                                
                                                ∩
                                                (
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ⧹
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      n
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                (
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      c
                                                   
                                                
                                                ⧹
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      c
                                                   
                                                
                                                )
                                                ∩
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      c
                                                   
                                                
                                                ∩
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             a
                                          
                                          
                                             y
                                          
                                       
                                       .
                                    
                                 
                              
                           

Hence, letting y enter the basis will yield a non-degenerate pivot-on-one leading to a unimodular basis B
                              
                                 n
                               for the augmented problem. According to Lemma 1, the extreme point associated with this basis is integral.


                              Lemma 3, with S
                              =
                              J
                              
                                 c
                              
                              ∩
                              Q
                              
                                 n
                              , yields how x
                              
                                 n
                               can be reconstructed in terms of original variables. □

In the remainder of this section we discuss the effects that the introduction of a surrogate column will have on the properties of the restricted master problem. By its construction, the augmented problem is also a set partitioning problem. The dual problem of 
                           
                              
                                 
                                    SPP
                                 
                                 
                                    N
                                 
                                 
                                    LP
                                 
                              
                           
                         is
                           
                              
                                 
                                    max
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          M
                                       
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 
                                 s
                                 .
                                 t
                                 .
                                 
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          M
                                       
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 j
                                 ∈
                                 N
                                 .
                              
                           
                        Introducing the primal variable y, adds the surrogate constraint
                           
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                J
                                             
                                             
                                                c
                                             
                                          
                                          ∩
                                          
                                             
                                                Q
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                j
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                a
                                             
                                             
                                                ij
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 0
                              
                           
                        to the dual problem. With y being a basic variable, equality holds in this constraint and the sum of the reduced costs of the variables j
                        ∈
                        J
                        
                           c
                        
                        ∩
                        Q
                        
                           n
                         is zero. This can of course hold without each and one of these reduced costs being zero, and the consequences of this will be discussed further.

Set partitioning problems are typically highly degenerate, and the introduction of a surrogate column raises the degree of degeneracy; hence the extreme point 
                           
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                 
                                 
                                    n
                                 
                              
                           
                         is likely to be highly degenerate, and therefore associated with several bases. These bases are associated with different dual extreme points, and for all of these, the dual surrogate constraint is fulfilled with equality, but the fulfilment of the original dual constraints can differ, that is, the values 
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    j
                                 
                                 
                                    n
                                 
                              
                              ,
                              j
                              ∈
                              
                                 
                                    J
                                 
                                 
                                    c
                                 
                              
                              ∩
                              
                                 
                                    Q
                                 
                                 
                                    n
                                 
                              
                           
                        , can be both positive and negative, and this can of course be the case even if 
                           
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                 
                                 
                                    n
                                 
                              
                           
                         is an optimal solution.

The above line of reasoning motivates that the original columns contained in the surrogate column should, if possible, be pivoted into the basis. It is probable that most of these pivots will be degenerate, which motivates the use of the degenerate all-integer pivots, introduced in Definition 3.

Since the cost of the surrogate column is the sum of the costs of the columns that it comprises, there are no incentives not to use the surrogate column. One way to prioritise the original columns over a surrogate column is to slightly penalise the latter. If more than one surrogate column is present, a ranking can be created by letting this penalty be proportional to the number of columns contained in the surrogate column, that is, by letting
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       y
                                    
                                 
                                 =
                                 |
                                 
                                    
                                       J
                                    
                                    
                                       c
                                    
                                 
                                 ∩
                                 
                                    
                                       Q
                                    
                                    
                                       n
                                    
                                 
                                 |
                                 ∊
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                J
                                             
                                             
                                                c
                                             
                                          
                                          ∩
                                          
                                             
                                                Q
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 ,
                              
                           
                        where ∊
                        >0 is a value, smaller than anything to which it is compared.

If a surrogate column leaves the basis, it is no longer needed and can be removed from the problem. If, on the other hand, a surrogate column is still in the basis when the algorithm terminates, the solution can be translated into the original variables using the result in Lemma 3.

In a traditional linear programming column generation setting, each restricted master problem is solved to optimality, so that the column generation subproblem is provided with a dual feasible solution for the restricted problem. Because of this, the sign of the reduced cost of a generated column can solely be used as an indicator for optimality also in the complete master problem. Further, a generated column can be already present in the restricted master problem if and only if this problem already contains an optimal solution to the complete problem.

When applying column generation in an all-integer pivoting setting, the situation is quite different. Characteristic for this setting is that a linear programming optimal basis for the restricted master problem 
                           
                              
                                 
                                    SPP
                                 
                                 
                                    N
                                 
                                 
                                    LP
                                 
                              
                           
                         is typically not available. The column generation subproblem using the dual variables of a non-optimal basis might then very well produce a column already present in the restricted master problem, and adding this column does of course not give any progress. Further, this might happen both in the situation when the current restricted master problem contains an optimal solution to the complete problem and when this is not the case.

To be able to solve the problem 
                           
                              
                                 
                                    SPP
                                 
                                 
                                    N
                                 
                              
                           
                         to optimality by using an all-integer column generation approach, two essential questions therefore remain to be answered: “When is the restricted master problem ensured to contain an optimal solution to the complete master problem and how can it be ensured that it eventually will?”

The purpose of this section is to provide an optimality condition tailored for the all-integer column generation setting; a more generic version of this optimality condition is introduced in Rönnberg (2012). Also described in this section is the concept of over-generation of columns, which is a strategy for eventually complying with the presented optimality condition.

The optimality condition presented here can be used to determine when the restricted master problem 
                              
                                 
                                    
                                       SPP
                                    
                                    
                                       N
                                    
                                    
                                       LP
                                    
                                 
                              
                            is sufficiently large to be able to also give an optimal solution to the complete master problem, given any basis B and associated dual solution u.

To apply the result in Rönnberg (2012), some new quantities need to be calculated. Let 
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 min
                                 {
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 :
                                 j
                                 ∈
                                 N
                                 ⧹
                                 N
                                 }
                              
                           . (If the given basis for 
                              
                                 
                                    
                                       SPP
                                    
                                    
                                       N
                                    
                                    
                                       LP
                                    
                                 
                              
                            is not dual feasible, the reduced cost 
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                              
                            might be non-optimal in the column generation problem [CG], and it can therefore be more cumbersome to calculate; see Section 4.2.2.) We denote a lower bound on the optimal objective value of SPP
                              N
                            by 
                              z
                           
                           
                              R
                            under the condition that x
                           
                              k
                           
                           =1 shall hold, and by 
                              z
                            if x
                           
                              k
                           
                           =0 shall hold. To derive such bounds, we let 
                              
                                 X
                                 ⊆
                                 
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                       |
                                       N
                                       |
                                    
                                 
                              
                            be a set containing all feasible solutions to 
                              
                                 
                                    
                                       SPP
                                    
                                    
                                       N
                                    
                                 
                              
                            and let Y
                           ⊆[0, 1]
                              n
                            be a set containing the orthogonal projection of X onto {0, 1}
                              n
                           . Further, assuming that assigning x
                           
                              k
                           
                           =1 imposes a restriction on the possible values of the variables in SPP
                              N
                           , let the set R be chosen such that the following implication holds.
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       
                                          j
                                          ∈
                                          N
                                       
                                    
                                    ∈
                                    X
                                    ∩
                                    {
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       
                                          j
                                          ∈
                                          N
                                       
                                    
                                    :
                                    
                                       
                                          x
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    1
                                    }
                                    ⇒
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       
                                          j
                                          ∈
                                          N
                                       
                                    
                                    ∈
                                    R
                                    ⊆
                                    
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                       
                                          n
                                       
                                    
                                    .
                                 
                              
                           
                        

The lower bounds then become
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ̲
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             M
                                          
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       min
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      ∈
                                                      N
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   j
                                                
                                             
                                             :
                                             
                                                
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                
                                                
                                                   j
                                                   ∈
                                                   N
                                                
                                             
                                             ∈
                                             Y
                                          
                                       
                                    
                                 
                              
                           and
                              
                                 
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                ̲
                                             
                                          
                                       
                                       
                                          R
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             M
                                          
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       min
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      ∈
                                                      N
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   j
                                                
                                             
                                             :
                                             
                                                
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                
                                                
                                                   j
                                                   ∈
                                                   N
                                                
                                             
                                             ∈
                                             Y
                                             ∩
                                             R
                                          
                                       
                                    
                                    .
                                 
                              
                           Further introduce their difference, Δ
                           =
                           
                              z
                           
                           
                              R
                           
                           −
                           
                              z
                           .

Another quantity needed in the optimality condition is an upper bound on the optimal objective value of 
                              
                                 
                                    
                                       SPP
                                    
                                    
                                       N
                                    
                                 
                              
                           , denoted 
                              
                                 
                                    
                                       z
                                    
                                    
                                       ¯
                                    
                                 
                              
                           . A natural choice is to use the current solution to SPP
                              N
                           .

The optimality condition then is as follows; for a more thorough motivation and a proof the reader is referred to Rönnberg (2012).
                              Theorem 4
                              
                                 If 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                       ⩾
                                       0
                                    
                                  
                                 and
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          Δ
                                          ⩾
                                          
                                             
                                                z
                                             
                                             
                                                ¯
                                             
                                          
                                          -
                                          
                                             
                                                z
                                             
                                             
                                                ̲
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 hold, then an optimal solution to SPP
                                 
                                    N
                                  
                                 is also an optimal solution to 
                                 
                                    
                                       
                                          
                                             SPP
                                          
                                          
                                             N
                                          
                                       
                                    
                                 
                                 .
                              

The optimality condition of the theorem is alternatively expressed on the form 
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 ⩾
                                 
                                    
                                       z
                                    
                                    
                                       ¯
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ̲
                                          
                                       
                                    
                                    
                                       R
                                    
                                 
                              
                           ; which of the forms that is easiest interpreted depends on the setting, as illustrated by the examples below. If assigning x
                           
                              k
                           
                           =1 imposes no clear restriction on the possible values of the variables in SPP
                              N
                           , the only possible choice is R
                           =[0, 1]
                              n
                           , in which case Y
                           ∩
                           R
                           =
                           Y, 
                              z
                           
                           
                              R
                           
                           =
                           
                              z
                           , and Δ
                           =0 hold, so that the condition reduces to 
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 ⩾
                                 
                                    
                                       z
                                    
                                    
                                       ¯
                                    
                                 
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       ̲
                                    
                                 
                              
                           .

There might of course be different ways to obtain lower bounds, depending on the specific application under consideration and the amount of computations that can be allowed. Presented below are two examples of how to obtain lower bounds.
                              Example 1
                              Let the set X be defined by a cardinality constraint on the number of variables that can take the value one in a solution, that is,
                                    
                                       
                                          X
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         j
                                                         ∈
                                                         N
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         {
                                                         0
                                                         ,
                                                         1
                                                         }
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   :
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            ∈
                                                            N
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ⩽
                                                   L
                                                
                                             
                                          
                                          .
                                       
                                    
                                 It follows directly from the set partitioning constraints that one may choose L
                                 =
                                 m, but often the application at hand can facilitate a tighter choice.

It is then natural to choose Y as the orthogonal projection of X onto the set {0, 1}
                                    N
                                 , that is,
                                    
                                       
                                          Y
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         j
                                                         ∈
                                                         N
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         {
                                                         0
                                                         ,
                                                         1
                                                         }
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   :
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            ∈
                                                            N
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ⩽
                                                   L
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 and the following restriction imposed by assigning x
                                 
                                    k
                                 
                                 =1,
                                    
                                       
                                          R
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         j
                                                         ∈
                                                         N
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         {
                                                         0
                                                         ,
                                                         1
                                                         }
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   :
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            ∈
                                                            N
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ⩽
                                                   L
                                                   -
                                                   1
                                                
                                             
                                          
                                          .
                                       
                                    
                                 If the variables in SPP
                                    N
                                  are sorted such that 
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ⩽
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ⩽
                                       ⋯
                                       ⩽
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             n
                                          
                                       
                                    
                                 , the quantities to be calculated are
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                ̲
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   L
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ̲
                                                   
                                                
                                             
                                             
                                                R
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   L
                                                   -
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                          and
                                          
                                          Δ
                                          =
                                          -
                                          
                                             min
                                          
                                          {
                                          0
                                          ,
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                L
                                             
                                          
                                          }
                                          ,
                                       
                                    
                                 and the optimality condition of Theorem 4 becomes 
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                       -
                                       min
                                       {
                                       0
                                       ,
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             L
                                          
                                       
                                       }
                                       ⩾
                                       
                                          
                                             z
                                          
                                          
                                             ¯
                                          
                                       
                                       -
                                       
                                          
                                             z
                                          
                                          
                                             ̲
                                          
                                       
                                    
                                 .

A case similar to the above example is when the variables of the problem 
                              
                                 
                                    
                                       SPP
                                    
                                    
                                       N
                                    
                                 
                              
                            are partitioned in groups and the variables within each group is included in a convexity constraint. In this case the convexity constraints can similarly be used to define the sets X and R.

Another example, that is likely to yield a tighter bound but which requires some more calculations than the previous example, is as follows.
                              Example 2
                              Let the set X be obtained from the original feasible set by replacing the set partitioning constraints with set packing constraints and let the set Y be obtained from of the orthogonal projection of X onto {0, 1}
                                    N
                                  by relaxing the integrality restrictions on the variables. Then, a restriction imposed by assigning x
                                 
                                    k
                                 
                                 =1 is
                                    
                                       
                                          R
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         j
                                                         ∈
                                                         N
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         [
                                                         0
                                                         ,
                                                         1
                                                         ]
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   :
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            ∈
                                                            N
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         ik
                                                      
                                                   
                                                   ,
                                                   
                                                   i
                                                   ∈
                                                   M
                                                
                                             
                                          
                                          .
                                       
                                    
                                 Expressing the optimality condition as 
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ̲
                                                
                                             
                                          
                                          
                                             R
                                          
                                       
                                       ⩾
                                       
                                          
                                             z
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  and using that Y
                                 ∩
                                 R
                                 =
                                 R holds, we obtain the optimality condition
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             min
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            ∈
                                                            N
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   :
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         j
                                                         ∈
                                                         N
                                                      
                                                   
                                                   ∈
                                                   Y
                                                   ∩
                                                   R
                                                
                                             
                                          
                                          ⩾
                                          
                                             
                                                z
                                             
                                             
                                                ¯
                                             
                                          
                                          .
                                       
                                    
                                 In order to check its fulfilment, a linear programme thus needs to be solved.

To ensure progress of the all-integer approach, even though a column generated by the subproblem [CG] might already be included in the restricted master problem, one possibility is to apply over-generation of columns, which means that the restricted master problem is augmented with a set of columns instead of just an optimal column. Over-generation can also be used to determine if it is guaranteed that the restricted master problem is sufficient for producing an optimal solution to 
                              
                                 
                                    
                                       SPP
                                    
                                    
                                       N
                                    
                                 
                              
                           , or to ensure that all columns needed to solve the problem 
                              
                                 
                                    
                                       SPP
                                    
                                    
                                       N
                                    
                                 
                              
                            can eventually be found.
                              Definition 5
                              Let the integer K
                                 ⩾2. The strategy of finding the K best solutions to the column generation subproblem [CG] and including them all in the restricted master problem is referred to as over-generation. With exhaustive over-generation we refer to the strategy of choosing the value of K so large that the optimality condition of Theorem 4 becomes fulfilled.

Clearly, over-generation strategies can alternatively be defined in terms of finding all ε-optimal solutions to the subproblem [CG], for some ε
                           >0. Exhaustive over-generation is obtained for the choice 
                              
                                 ε
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       ¯
                                    
                                 
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       ̲
                                    
                                 
                                 -
                                 Δ
                                 -
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                              
                           , with the reduced cost 
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                              
                            given by the column generation subproblem [CG].

If the basis in the restricted master problem is not dual feasible, the reduced cost 
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 min
                                 {
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 :
                                 j
                                 ∈
                                 N
                                 ⧹
                                 N
                                 }
                              
                           , used in the optimality condition in Theorem 4, is not obtained automatically from the subproblem [CG], since its solution might violate the requirement 
                              
                                 k
                                 ∈
                                 N
                                 ⧹
                                 N
                              
                           . This requirement can then be made fulfilled through over-generation of solutions to [CG].

The origin of the over-generation strategy can be found in a paper written by Sweeney and Murphy (1979). The computational results presented in their paper might no longer be of much interest, but the strategy introduced there has been applied as a vital component in a method presented in a more recent paper by Baldacci, Christofides, and Mingozzi (2008), where they successfully have solved vehicle routing problems. A theoretical justification for the over-generation principle can be found in Larsson and Patriksson (2006), where it is however mainly discussed in a Lagrangian relaxation context.

The number of columns generated in an exhaustive over-generation, which guarantees that the restricted master problem 
                              
                                 
                                    
                                       SPP
                                    
                                    
                                       N
                                    
                                    
                                       LP
                                    
                                 
                              
                            can give an optimal solution to the set partitioning problem 
                              
                                 
                                    
                                       SPP
                                    
                                    
                                       N
                                    
                                 
                              
                           , depends on the quality of a lower bound. There might be several ways to obtain such a bound, but the tighter it is, the fewer columns will be required to be added to the restricted master problem. In practice, one needs to balance how much effort is put into the finding of a high quality lower bound and the over-generation of columns respectively.

It is not likely to be efficient to try to generate all columns with a reduced cost up to 
                              
                                 
                                    
                                       z
                                    
                                    
                                       ¯
                                    
                                 
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       ̲
                                    
                                 
                                 -
                                 Δ
                              
                            if the current integer solution to 
                              
                                 
                                    
                                       SPP
                                    
                                    
                                       N
                                    
                                    
                                       LP
                                    
                                 
                              
                            is known to be far from optimal in 
                              
                                 
                                    
                                       SPP
                                    
                                    
                                       N
                                    
                                 
                              
                           , because the information contained in the dual variables will then probably not be a reliable guide for which columns are useful in finding an optimal solution to 
                              
                                 
                                    
                                       SPP
                                    
                                    
                                       N
                                    
                                 
                              
                           . Later in the search, with a near-optimal integer solution to 
                              
                                 
                                    
                                       SPP
                                    
                                    
                                       N
                                    
                                 
                              
                            and a basis with a near-feasible dual solution, the information contained in the dual variables should improve.

When preparing this paper, some preliminary computational experiments were made for the generalised assignment problem in order to illustrate the practical behaviour of the core components of the all-integer column generation concept. These experiments revealed a risk of numerical difficulties in the column generation subproblem due to ill-conditioning of B; as new columns entered the basis the condition number increased until the subproblems could no longer be solved (by CPLEX 12.2) and the algorithm had to be terminated prematurely. At a first glance the matrix B looks harmless since it comprises set partitioning master columns, with zeros and ones only, and it is typically also sparse, but when the condition number becomes high (of the order 1016 for the instances used below) B
                        −1 becomes dense with elements that range from very low to very high values (of the order from −106 to 107 for the instances used below), which makes the subproblem challenging.

This section begins with introducing the transformation used to overcome these numerical difficulties. Here, the transformation is made for the generalised assignment problem, but it can be done in the same manner for any subproblem formulated as a linear integer programme. Thereafter we present the implementation (made in C++) which consists only of all-integer column generation, using CPLEX 12.2 for solving the subproblems.

The generalised assignment problem (GAP) is to assign n jobs to m agents at minimal cost. Each item should be assigned to one agent and the capacities of the agents should be respected. Let the capacity of agent i be denoted by b
                           
                              i
                           , and let p
                           
                              ij
                            and q
                           
                              ij
                            denote the cost and the claim of capacity respectively, when item j is assigned to agent i,
                           i
                           =1, …, m, j
                           =1, …, n.

A formulation of GAP that can be used in a column generation setting is as follows, which yields a set partitioning master problem and knapsack subproblems. Let K
                           
                              i
                            be an index set for the feasible assignments of jobs to agent i
                           =1, …, m and define the variables
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      assignment
                                                      
                                                      k
                                                      
                                                      of
                                                      
                                                      agent
                                                      
                                                      i
                                                      
                                                      is
                                                      
                                                      used
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                   
                                                      otherwise
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    k
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    m
                                    .
                                 
                              
                           A feasible assignment k
                           =1, …, K
                           
                              i
                            for an agent i
                           =1, …, m is represented by the master problem column
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ij
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      item
                                                      
                                                      j
                                                      
                                                      is
                                                      
                                                      assigned
                                                      
                                                      to
                                                      
                                                      agent
                                                      
                                                      i
                                                      
                                                      in
                                                      
                                                      assignment
                                                      
                                                      k
                                                      ,
                                                      
                                                      j
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      item
                                                      
                                                      j
                                                      
                                                      is
                                                      
                                                      not
                                                      
                                                      assigned
                                                      
                                                      to
                                                      
                                                      agent
                                                      
                                                      i
                                                      
                                                      in
                                                      
                                                      assignment
                                                      
                                                      k
                                                      ,
                                                      
                                                      j
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      1
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      j
                                                      =
                                                      n
                                                      +
                                                      i
                                                      
                                                      holds
                                                      ,
                                                      
                                                      j
                                                      =
                                                      n
                                                      +
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      +
                                                      m
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      j
                                                      
                                                      ≠
                                                      
                                                      n
                                                      +
                                                      i
                                                      
                                                      holds
                                                      ,
                                                      
                                                      j
                                                      =
                                                      n
                                                      +
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      +
                                                      m
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where the elements 
                              
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 j
                                 =
                                 n
                                 +
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 +
                                 m
                              
                           , are introduced to simplify the notation by keeping track of which columns that belong to which agent i.

The master problem is
                              
                                 
                                    
                                       
                                          
                                             
                                                [
                                                MP
                                                :
                                                SPP
                                                ]
                                                
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                =
                                                
                                             
                                          
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               K
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  j
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               ij
                                                            
                                                         
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               ij
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                s
                                                .
                                                t
                                                .
                                                
                                                
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               K
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ,
                                                
                                                j
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                +
                                                m
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ∈
                                                {
                                                0
                                                ,
                                                1
                                                }
                                                ,
                                                
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                m
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where e
                           
                              j
                           
                           =1, j
                           =1, …, n
                           +
                           m. Denote the dual variables for the set partitioning constraints by u
                           
                              j
                           , j
                           =1, …, n
                           +
                           m. The ordinary column generation subproblem can be formulated as follows, for each agent i
                           =1, …, m.
                              
                                 
                                    
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      SUB
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ]
                                                
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                =
                                                
                                             
                                          
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                         +
                                                         m
                                                      
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ij
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                s
                                                .
                                                t
                                                .
                                                
                                                
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                ∈
                                                {
                                                0
                                                ,
                                                1
                                                }
                                                ,
                                                
                                                j
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                =
                                                1
                                                ,
                                                
                                                when
                                                
                                                j
                                                =
                                                n
                                                +
                                                i
                                                ,
                                                
                                                j
                                                =
                                                n
                                                +
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                +
                                                m
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                =
                                                0
                                                ,
                                                
                                                when
                                                
                                                j
                                                
                                                ≠
                                                
                                                n
                                                +
                                                i
                                                ,
                                                
                                                j
                                                =
                                                n
                                                +
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                +
                                                m
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           The variables indexed j
                           =
                           n
                           +1, …, n
                           +
                           m are kept in the model, although they have fixed values, in order to simplify the transformation to be presented.

In an all-integer column generation setting, the subproblem is tailored to produce a column that enables either a non-degenerate or a degenerate all-integer pivot by adding the side constraints introduced in Section 3.2. To formulate these side constraints, B denotes the current master problem basis matrix, which is of size (n
                           +
                           m)×(n
                           +
                           m), and 
                              
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 l
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 +
                                 m
                              
                           , denote the updated right-hand-sides of the master problem.

Since the two types of side constraints are similar, we can form a common constraint for both the non-degenerate and degenerate cases and distinguish between them by changing the left-hand-side and the right-hand-side of the constraint. For each i
                           =1, …, m this common constraint is stated as
                              
                                 
                                    
                                       
                                          lhs
                                       
                                       
                                          l
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             n
                                             +
                                             m
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                B
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          lj
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          ij
                                       
                                    
                                    ⩽
                                    
                                       
                                          rhs
                                       
                                       
                                          l
                                       
                                    
                                    ,
                                    
                                    l
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    +
                                    m
                                    .
                                 
                              
                           In the non-degenerate case, 
                              
                                 
                                    
                                       lhs
                                    
                                    
                                       l
                                    
                                 
                                 =
                                 -
                                 1
                                 +
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       l
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       rhs
                                    
                                    
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 l
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 +
                                 m
                              
                           . In the degenerate case, two subproblems are formed for each r such that 
                              
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       r
                                    
                                 
                                 =
                                 0
                              
                           , r
                           =1, …, n
                           +
                           m, by using
                              
                                 
                                    
                                       
                                          lhs
                                       
                                       
                                          l
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ±
                                                      1
                                                      ,
                                                   
                                                   
                                                      for
                                                      
                                                      l
                                                      =
                                                      r
                                                   
                                                
                                                
                                                   
                                                      -
                                                      ∞
                                                      ,
                                                   
                                                   
                                                      for
                                                      
                                                      l
                                                      
                                                      ≠
                                                      
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    l
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    +
                                    m
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          rhs
                                       
                                       
                                          l
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ±
                                                      1
                                                      ,
                                                   
                                                   
                                                      for
                                                      
                                                      l
                                                      =
                                                      r
                                                   
                                                
                                                
                                                   
                                                      ∞
                                                      ,
                                                   
                                                   
                                                      for
                                                      
                                                      l
                                                      
                                                      ≠
                                                      
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    l
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    +
                                    m
                                    .
                                 
                              
                           
                        

The all-integer column generation subproblem for each agent i
                           =1, …, m then is [SUB
                              i
                           ] augmented with the side constraint. The numerical difficulties in this formulation are overcome by eliminating B
                           −1 from the subproblem using the following linear transformation. For each i
                           =1, …, m, let
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          l
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             n
                                             +
                                             m
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                B
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          lj
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          ij
                                       
                                    
                                    ,
                                    
                                    l
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    +
                                    m
                                    ,
                                 
                              
                           be the variables in the transformed subproblem, which is constructed by substituting
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ij
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             l
                                             =
                                             1
                                          
                                          
                                             n
                                             +
                                             m
                                          
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          jl
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          l
                                       
                                    
                                    ,
                                    
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    +
                                    m
                                    ,
                                 
                              
                           in the original side constrained subproblem. By making this substitution, B
                           −1 is eliminated from the side constrained subproblem. Further, the binary restrictions on x
                           
                              ij
                           , j
                           =1, …, n
                           +
                           m, translate into requiring that the variables s
                           
                              l
                           , l
                           =1, …, n
                           +
                           m, shall take integer values (without sign restrictions). The transformed side constrained column generation subproblem then becomes
                              
                                 
                                    
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      AICG
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ]
                                                
                                                
                                                   min
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         l
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                         +
                                                         m
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  j
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               ij
                                                            
                                                         
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               jl
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  
                                                                     B
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               l
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      l
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                s
                                                .
                                                t
                                                .
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         l
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                         +
                                                         m
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  j
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               ij
                                                            
                                                         
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               jl
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      l
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                0
                                                ⩽
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         l
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                         +
                                                         m
                                                      
                                                   
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      jl
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      l
                                                   
                                                
                                                ⩽
                                                1
                                                ,
                                                
                                                j
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         l
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                         +
                                                         m
                                                      
                                                   
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      jl
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      l
                                                   
                                                
                                                =
                                                1
                                                ,
                                                
                                                j
                                                =
                                                n
                                                +
                                                i
                                                ,
                                                
                                                j
                                                =
                                                n
                                                +
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                +
                                                m
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         l
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                         +
                                                         m
                                                      
                                                   
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      jl
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      l
                                                   
                                                
                                                =
                                                0
                                                ,
                                                
                                                j
                                                
                                                ≠
                                                
                                                n
                                                +
                                                i
                                                ,
                                                
                                                j
                                                =
                                                n
                                                +
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                +
                                                m
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      lhs
                                                   
                                                   
                                                      l
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      l
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      rhs
                                                   
                                                   
                                                      l
                                                   
                                                
                                                
                                                and
                                                
                                                integer
                                                ,
                                                
                                                l
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                +
                                                m
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           for each agent i
                           =1, …, m.

This section presents the results of a preliminary implementation made for illustrating the behaviour of core components of the all-integer column generation concept for the generalised assignment problem. As test instances we used the five gap 9 problems in the OR-library (Beasley, 2011); these are the largest of the most sparse instances, with 10 agents and 30 jobs. (Worth noting is that a drawback of using the generalised assignment problem for illustrating all-integer column generation is that the master problem is in this case more dense that in a typical applications of column generation.)

The implementation is based on making all-integer pivots on columns generated by solving AICG
                              i
                           . The search is started from a purely artificial basis. A new column is generated and pivoted on by using the schema presented in Fig. 1
                           , and the algorithm is terminated after a predetermined number of iterations, or if it is not possible to perform any all-integer pivot.

When solving AICG
                              i
                           , the agent and, in the degenerate case, the row are chosen at random. The algorithm was set to run 10,000 iterations for each of the five instances, without any special effort spent on tuning the parameters of the algorithm. The result is shown in Fig. 2
                            which displays, for each iteration, the deviation in objective value between the current best solution and a known optimal one. The performance observed is like expected.

In the search for a column for agent i, the problem AICG
                              i
                            needs to be solved at most 1+2n times; once for the non-degenerate case and in the degenerate case twice for each degenerate row. (There are n
                           +
                           m master problem rows, but since there are m different subproblems, at least m rows must be non-degenerate.) The strategy of consecutively solving these subproblems until a profitable column is found is feasible (but not necessarily efficient) for a small scale problem, but for a large scale problem more specialised strategies need to be designed.

The basic principles of all-integer column generation for set partitioning problems and the extensions presented are summarised in Fig. 3
                      together with possible interactions between the components of the methodology. The strategies for solving and augmenting the restricted master problem can be combined to create both heuristic and exact methods.

The key characteristics of the all-integer column generation approach are the same as those of combinatorial metaheuristics, in that all successively found solutions are integral and feasible. Since the integrality requirements are maintained, the search can be interrupted at any time with a current best solution that is integral and feasible. The price to be paid for preserving integrality is that the all-integer pivots only serve as a local search method, and that, compared to traditional branch-and-price, the column generation subproblems are more complex.

Worth noting is that the surrogate column construction allows the use of any available and efficient method for finding improved integer solutions to the restricted master problem. In combination with for example a heuristic, the surrogate column pivots therefore enable a flexibility in the design of a specific implementation.

For the overall method to be exact, it must be guaranteed that an optimal solution to 
                        
                           
                              
                                 SPP
                              
                              
                                 N
                              
                           
                        
                      will eventually be contained in SPP
                        N
                     , for example by ensuring that the optimality condition in Theorem 4 become fulfilled through over-generation of columns, and that an optimal solution to SPP
                        N
                      is eventually found; further, if degenerate all-integer pivots are used, cycling must be prevented. We do not know of any anti-cycling rule for the all-integer pivots, but the use of surrogate column pivots serves as a safeguard that prevents cycling implicitly. Further, it is not sufficient to know when an optimal solution to the complete master problem is contained in its restriction; an optimal solution must also be found, and this can be achieved by applying any suitable integer programming strategy. One way to guarantee optimality in SPP
                        N
                      would be to use the branching strategy tailored to the integral simplex method that is presented by Thompson (2002).

The example given in Section 4.3.3 serves as an illustration of how the framework presented can be applied and also introduces a transformation which we believe to be very important from a computational point of view. The computational results are merely used to illustrate the behaviour of the core components of the method and show that they behave as desired. It remains for future work to make a proper implementation of a method within our framework.

We believe that the all-integer column generation approach has its main potential as a metaheuristic scheme for sparse large-scale set partitioning problems. In such a metaheuristic use of the approach, several feasible and successively improved solutions should be provided during the course of the solution process. The actual performance of a method within our framework will depend on a number of factors. Critical questions to address are how efficiently the column generation subproblems can be solved in the application at hand and the performance of the all-integer pivot search, as well as on the efficiency of the auxiliary method for finding improved integer solutions.

@&#ACKNOWLEDGEMENTS@&#

The authors were financially supported by a grant from the Swedish Research Council (Grant No. 621-2005-2874). We also thank the referees whose valuable comments inspired major changes of the presentation of the paper.

@&#REFERENCES@&#

