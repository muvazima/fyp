@&#MAIN-TITLE@&#Scenario-based model predictive control for multi-echelon supply chain management

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           New method based on recent, groundbreaking results in scenario optimization.


                        
                        
                           
                           Applicable to many different models in operations research/supply chain mgt.


                        
                        
                           
                           Handles uncertain parameters of a very general type and distribution.


                        
                        
                           
                           Computationally efficient, hence applicable to large problem instances.


                        
                        
                           
                           Many open theoretical questions and a large range of further applications.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Stochastic programming

Applied probability

Model predictive control

Scenario-based optimization

Randomized algorithms

@&#ABSTRACT@&#


               
               
                  Policies for managing multi-echelon supply chains can be considered mathematically as large-scale dynamic programs, affected by uncertainty and incomplete information. Except for a few special cases, optimal solutions are computationally intractable for systems of realistic size. This paper proposes a novel approximation scheme using scenario-based model predictive control (SCMPC), based on recent results in scenario-based optimization. The presented SCMPC approach can handle supply chains with stochastic planning uncertainties from various sources (demands, lead times, prices, etc.) and of a very general nature (distributions, correlations, etc.). Moreover, it guarantees a specified customer service level, when applied in a rolling horizon fashion. At the same time, SCMPC is computationally efficient and able to tackle problems of a similar scale as manageable by deterministic optimization. For a large class of supply chain models, SCMPC may therefore offer substantial advantages over robust or stochastic optimization.
               
            

@&#INTRODUCTION@&#

Methods for the automated management of supply chains continue to attract significant research attention (Sarimveis, Patrinos, Tarantilis, & Kiranoudis, 2008). The main reason is that even small improvements carry an enormous potential for cost savings and performance enhancement in actual supply chain systems (Geoffrion & Powers, 1995). However, the mathematical formulations of multi-echelon supply chain problems poses great challenges for modern theories of optimization and control. In essence, these formulations represent large-scale dynamic optimization problems, affected by uncertainty and incomplete information.

The difficulty of these problems precludes the exact computation of stochastic optimal control policies, except for very special cases (Federgruen, 1993; Li & Marlin, 2009; Sarimveis et al., 2008). A variety of approximation approaches have therefore been proposed, and shown to be effective for certain problem types. One promising direction are methods related to model predictive control (MPC); see Mayne, Rawlings, Rao, and Scokaert (2000) for an overview. Various studies have demonstrated the potentials of MPC to reduce the operation costs of inventory systems and supply chains, e.g., Perea-López, Ydstie, and Grossmann (2003), Rasku, Rantala, and Koivisto (2006), Sarimveis et al. (2008), and Maestre, Muñoz de la Peña, Camacho, and Alamo (2011). Moreover, MPC-based algorithms have successfully been applied for inventory control in pharmacies (Jurado et al., 2016), the semiconductor industry (Wang, Rivera, & Kempf, 2005), and drinking water networks (Grosso, Ocampo-Martínez, Puig, & Joseph, 2014).

MPC assumes that a model of the actual supply chain is available to the decision maker. This model is used to predict the state of the system (inventories, service level, etc.) over a fixed time horizon, and to optimize the operational decisions (production, shipments, etc.) through an optimization program. The model, however, may contain inaccurate parameters (capacities, etc.) or uncertain quantities (demands, lead times, etc.). MPC is known to have good robustness properties with respect to mismatches between model and system parameters (Braun, Rivera, Carlyle, & Kempf, 2003a; Braun, Rivera, Flores, Carlyle, & Kempf, 2003b). Another advantage of MPC is that available forecasts on uncertain quantities can easily be integrated into the planning problem (Bose & Pekny, 2000).

The MPC theory is concerned with dynamic control – i.e., using numerical optimization in a rolling horizon implementation to optimize the long-term performance of the supply chain. In particular, the objective of MPC is to minimize the long-term costs of operation, while respecting the capacity constraints and maintaining a specific customer service level (Bose & Pekny, 2000). In this respect, it is well known that an explicit uncertainty model generally improves the performance of MPC over a deterministic-equivalent approach (Li & Marlin, 2009; Sohdi & Tang, 2012). This is because the uncertainty model conveys important information about the variability of uncertain quantities, as compared to substituting them by their expected or the most likely values.

Two uncertainty models have previously been considered for integration into MPC: robust models and stochastic models; see Bertsimas and Thiele (2004) and Sohdi and Tang (2012). Robust models consider uncertainties to be set-bounded, so the resulting decisions are made irrespective of the probability of scenarios (Li & Marlin, 2009). Stochastic models have difficulties in handling multiple types of uncertainties with general correlations, or they are computationally intractable for realistic systems (Yıldırım, Tan, & Karaesmen, 2006).

This paper presents a novel way of handling uncertainty in MPC, namely by considering sampled uncertainty scenarios. Hence the approach is called scenario-based model predictive control (SCMPC). As the sampled scenarios are eventually fixed, SCMPC can handle uncertainties from various sources (demands, lead times, prices, etc.) and of a very general nature (distributions, correlations, etc.). The underlying theory configures SCMPC to satisfy a specified customer service level in its rolling horizon implementation. At the same time, SCMPC is computationally efficient. It is able to tackle problems of a similar scale as manageable by deterministic optimization.

The paper is organized as follows. The remainder of Section 1 provides a brief review on existing approaches for supply chain management and an introduction to the proposed method. Section 2 introduces an exemplary supply chain model, which is considered as a case study throughout the paper. The novel method described in Section 3 is indeed far more general, since it can be applied to a large variety of different models. For a demonstration of its properties, Section 4 presents some results obtained from numerical experiments. Finally, Section 5 provides a brief summary and conclusion.

Since the seminal work of Clark and Scarf (1960), a great variety of quantitative methods have been proposed for the management of multi-echelon supply chains. Two fundamental approaches can be distinguished according to Federgruen (1993): centralized approaches and decentralized approaches. Both approaches are discussed briefly below.

In a decentralized approach, each node of the supply chain network manages its inventory locally, typically as a pull system. The local replenishment decisions are commonly based on a base-stock policy or a (s, S)-policy (Simpson, 1958). The placement of safety stocks constitutes a strategic and centralized decision of supply chain design, with a critical effect on the overall performance of the system (Graves & Willems, 2003).

A key advantage of the decentralized approach is that – after the base stock or order levels have been determined – the supply chain operation is simple and requires little computations. Therefore, well-tuned decentralized base-stock policies have been successfully deployed in several industrial applications (Graves & Willems, 2003). The base-stock policies can also be adjusted to cope with non-stationary demands, as shown by Graves and Willems (2008). Moreover, they can also account for capacity constraints, as in Schoenmeyr and Graves (2009a), and for evolving demand forecasts, as in Schoenmeyr and Graves (2009b).

However, decentralized approaches face a number of potential drawbacks. First, multiple products may share a single capacity constraints for processing or transportation. Then it remains unclear how these products should be prioritized or how long they should be procured in advance. Second, base-stock policies are unable to choose between multiple sources for their supply. Therefore they are limited to simple network topologies. Third, the base-stock levels may have to be adapted in a dynamic manner. But these adjustments may cause the undesirable bullwhip effect, as described by Lee, Padmanabhan, and Whang (1997) and Sarimveis et al. (2008). In fact, higher demands lead to higher base stocks levels at all stages of the supply chain, and hence a disproportionate wave of replenishments propagates upwards through the supply chain. Fourth, the manufacturing stages may not have the flexibility to adjust their production as an instantaneous reaction to customer demand. Sohdi (2005) argues, for example, that for the consumer electronics industry the production schedule must usually be fixed several weeks in advance.

Some of these shortcomings have been addressed by decentralized MPC, where separate MPC policies are designed for the local use in multiple parts of the supply chain; see, e.g., Bose and Pekny (2000) and Perea-López et al. (2003). The design typically assumes a cooperative management, as opposed to a non-cooperative management (Subramanian, Rawlings, Maravelias, Flores-Cerrillo, & Megan, 2013). This means that the local decisions are made with the intent to optimize the overall performance of the supply chain. The goal of decentralized MPC is then to recover, as closely as possible, the performance of centralized MPC, while lowering its computational burden.

Centralized approaches can address the aforementioned issues by optimizing the decisions for the entire supply chain. They are often organized as push systems. A fundamental requirement is the existence of a central coordinator, who has access to all local information, and the authority to make all relevant decisions throughout the network (Perea-López et al., 2003).

For centralized approaches, the decisions of each node are usually determined by solving one (or several) comprehensive mathematical program(s) for the entire supply chain. To this end, a large variety of mathematical models have been proposed; see, e.g., Mula, Peidro, Díaz-Madroñero, and Vicens (2010) for a survey.

Centralized approaches may potentially reap the benefits from coordinated action of all nodes in the supply chain network. They are able to allocate limited capacities to multiple products and also to handle multiple suppliers with possibly different prices (Chen & Wang, 1997). Moreover, they can cope with very general network topologies and the integration of forecasts is straightforward (Rømo et al., 2009; Sohdi, 2005). They have also been successfully implemented in industrial applications (Lababidi, Ahmed, Alatiqi, & Al-Enzi, 2004; Sohdi, 2005).

The main bottleneck of centralized approaches lies in the numerical solution to a typically large-scale mathematical program. In particular, the problem dimensions grow with the time horizon, the number of products, and the network size. Furthermore, the problem becomes distinctly more difficult if it also accounts for uncertain parameters (Sohdi & Tang, 2012). Therefore many existing contributions have chosen a certainty-equivalence approach, where uncertain quantities are substituted by fixed values (e.g., their expected or most likely values). However, this may lead to a considerable performance degradation, as shown by Li and Marlin (2009)
                            and Sohdi and Tang (2012).

This paper presents a novel centralized approach for multi-echelon supply chain management. Its key merit is the inclusion of uncertain parameters of very general nature, while it retains a computational complexity that is similar to deterministic approaches. The presented method can be used with a great variety of different supply chain models. It builds on recent results of Campi and Garatti (2008) on the scenario-based optimization approach (scenario approach) and of Schildbach, Fagiano, Frei, and Morari (2014) on scenario-based model predictive control (SCMPC).

SCMPC solves, repeatedly, an optimal planning problem over a finite time horizon. Unlike most centralized approaches, SCMPC analyzes its rolling horizon implementation rather than just the finite horizon optimal solution. In the long run, SCMPC keeps capacity constraints as well as pre-specified customer service levels, which are defined as the fraction of time steps in which customer demands are met from available inventory (Bitran & Yanasse, 1984; Bookbinder & Tan, 1988). At the same time it aims at keeping the long-term operational costs low.

SCMPC can handle supply chains with multiple operational uncertainties over the planning horizon – such as demand quantities, lead times, production yields, perishable inventories, backlog carry-overs, prices, etc. (Oke & Gopalakrishnan, 2009). For notational convenience, they are combined into a large random uncertainty vector δt
                         ∈ Δ. SCMPC can also incorporate estimations or forecasts on these uncertainties. In this case, δt
                         represents the random deviation from the nominal forecast that is available. The distribution of δt
                         is completely arbitrary – as long as a sufficient number K of independent samples (i.e., the scenarios) can be obtained in each time step t. In particular, there are no restrictions on the dimension of δt
                        , nor on the type of distribution or on the correlations. The distribution of δt
                         may also be time-varying and correlated in time.

SCMPC bases its decisions on a particular number K of sampled scenarios. Since the scenarios are sampled at random, SCMPC is essentially a randomized algorithm. After this randomization, however, the optimization problem becomes deterministic and fixed. The key advantage of this procedure is computational efficiency, allowing SCMPC to handle problems of similar scale as those within the reach of deterministic algorithms. Moreover, it means that the included uncertainty variables can be of arbitrary dimension and follow any joint distribution function, as long as fixed samples can be obtained for it.

The number of sampled scenarios K can be shown to stand in a precise inverse relationship to the desired service level. Moreover, K turns out to be relatively small for most problems and does not grow with the horizon or problem dimensions. Compared to multi-stage stochastic optimization, SCMPC thus avoids the combinatorial complexity arising e.g., from the exhaustive sampling from a (binary) scenario tree used by Sohdi and Tang (2012). Compared to robust optimization, SCMPC accounts for the probability of scenarios and needs to handle only a finite uncertainty set in the computations; compare Bertsimas and Thiele (2004).

The SCMPC method proposed in this paper can be used with a great variety of supply chain models (Schildbach et al., 2014). Here a concrete case study is introduced for illustration purposes, which is comparable in size and type to the deterministic model of Perea-López et al. (2003). Its basic structure is depicted in Fig. 1.

The supply chain model has been selected as a typical example of models that may appear across several industries (Geoffrion & Powers, 1995), such as consumer electronics (Sohdi, 2005), chemical products (Perea, Grossmann, Ydstie, & Tahmassebi, 2000), or retail goods (Simchi-Levi, Kaminsky, and Simchi-Levi, 2008, Cha. 2). The time period T over which the system is operated is considered to be ‘very long’; that is much longer than a sensible planning horizon.

The supply chain model has a tree-like structure with simple loops, three supply chain stages (or echelons) and multiple facilities per stage. The first echelon consists of 
                           
                              L
                              =
                              3
                           
                         
                        suppliers or production facilities
                        
                           
                              l
                              ∈
                              L
                              :
                              =
                              {
                              1
                              ,
                              …
                              ,
                              L
                              }
                           
                        ; the second echelon consists of 
                           
                              M
                              =
                              5
                           
                         
                        warehouses or distribution centers
                        
                           
                              m
                              ∈
                              M
                              :
                              =
                              {
                              1
                              ,
                              …
                              ,
                              M
                              }
                           
                        ; and the third echelon consists of 
                           
                              N
                              =
                              15
                           
                         
                        customers or retail stores
                        
                           
                              n
                              ∈
                              N
                              :
                              =
                              {
                              1
                              ,
                              …
                              ,
                              N
                              }
                           
                        .

Products can be shipped along the pre-defined routes, as indicated by arrows in Fig. 1. These routes could vary with time, but here they are assumed to be constant. Mainly downstream shipments are considered, with the additional possibility for a re-distribution of products from the retailers over the warehouse level. For notational convenience, the sets of routes

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                S
                                                
                                                   l
                                                   ,
                                                   m
                                                
                                             
                                             ⊆
                                             L
                                             ×
                                             M
                                             ,
                                             
                                             
                                                S
                                                
                                                   m
                                                   ,
                                                   m
                                                
                                             
                                             ⊆
                                             M
                                             ×
                                             M
                                             ,
                                             
                                             
                                                S
                                                
                                                   m
                                                   ,
                                                   n
                                                
                                             
                                             ⊆
                                             M
                                             ×
                                             N
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                S
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             ⊆
                                             N
                                             ×
                                             M
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        are defined as subsets of ordered tuples of an origin and a target destination. The set of all shipment routes is denoted 
                           
                              S
                              :
                              =
                              
                                 S
                                 
                                    l
                                    ,
                                    m
                                 
                              
                              ∪
                              
                                 S
                                 
                                    m
                                    ,
                                    m
                                 
                              
                              ∪
                              
                                 S
                                 
                                    m
                                    ,
                                    n
                                 
                              
                              ∪
                              
                                 S
                                 
                                    n
                                    ,
                                    m
                                 
                              
                           
                        .

Time is separated into discrete periods 
                           
                              t
                              ∈
                              T
                              :
                              =
                              {
                              1
                              ,
                              …
                              ,
                              T
                              }
                           
                        . There are multiple 
                           
                              J
                              =
                              2
                           
                         
                        products
                        
                           
                              j
                              ∈
                              J
                              :
                              =
                              {
                              1
                              ,
                              …
                              ,
                              J
                              }
                           
                         that can be manufactured by the production facilities (or sourced from suppliers) 
                           
                              l
                              ∈
                              L
                              ,
                           
                         at given production costs γ
                        
                           t, j, l
                        . Each production facility 
                           
                              l
                              ∈
                              L
                           
                         has a limited production capacity of Cl
                        , of which one product 
                           
                              j
                              ∈
                              J
                           
                         consumes c
                        
                           j, l
                        . The finished products 
                           
                              j
                              ∈
                              J
                           
                         can then be shipped along the routes 
                           
                              s
                              ∈
                              S
                              ,
                           
                         incurring shipment costs of σ
                        
                           t, j, s
                        . They can also be stored at each node, up to its storage capacity Pl
                         (for production facilities 
                           
                              l
                              ∈
                              L
                           
                        ), Wm
                         (for warehouses 
                           
                              m
                              ∈
                              M
                           
                        ), or Rn
                         (for retail stores 
                           
                              n
                              ∈
                              N
                           
                        ); e.g., represented by the storage volume. Each product 
                           
                              j
                              ∈
                              J
                           
                         has a storage coefficient p
                        
                           j, l
                        , w
                        
                           j, m
                        , and r
                        
                           j, n
                        , respectively, indicating the amount of storage capacity needed for one unit of that product; e.g., proportional to its size. The storage cost for product 
                           
                              j
                              ∈
                              J
                           
                         amounts to ϕ
                        
                           j, l
                         (for production facilities 
                           
                              l
                              ∈
                              L
                           
                        ), ω
                        
                           j, m
                         (for warehouses 
                           
                              m
                              ∈
                              M
                           
                        ), or ρ
                        
                           j, n
                         (for retail stores 
                           
                              n
                              ∈
                              N
                           
                        ) per time step.

Before the end of each period 
                           
                              t
                              ∈
                              T
                           
                         and for each product 
                           
                              j
                              ∈
                              J
                              ,
                           
                         first the decisions about the production y
                        
                           t, j, l
                         at 
                           
                              l
                              ∈
                              L
                           
                         and the shipments x
                        
                           t, j, s
                         along 
                           
                              s
                              ∈
                              S
                           
                         are taken. Shipped products leave the respective inventory
                        
                           
                              
                                 I
                                 
                                    t
                                    −
                                    1
                                    ,
                                    j
                                    ,
                                    l
                                 
                              
                              ,
                           
                        
                        
                           
                              
                                 I
                                 
                                    t
                                    −
                                    1
                                    ,
                                    j
                                    ,
                                    m
                                 
                              
                              ,
                           
                         or 
                           
                              I
                              
                                 t
                                 −
                                 1
                                 ,
                                 j
                                 ,
                                 n
                              
                           
                         of their origin s
                        1 immediately.

The shipments x
                        
                           t, j, s
                         arrive at their destination s
                        2 after a transportation lead time of λ
                        
                           t, s
                         for route 
                           
                              s
                              ∈
                              S
                           
                        . The productions y
                        
                           t, j, l
                         have a lead time λ
                        
                           t, l
                         at 
                           
                              l
                              ∈
                              L
                           
                        . Moreover, the production schedule must be determined Tprod
                         time steps in advance (Sohdi, 2005). This means that at each time t, the next Tprod
                         production quantities for 
                           
                              t
                              +
                              1
                              ,
                              …
                              ,
                              t
                              +
                              
                                 T
                                 
                                    p
                                    r
                                    o
                                    d
                                 
                              
                           
                         are already fixed by previous decisions, while previous transportation decisions from all production facilities 
                           
                              l
                              ∈
                              L
                           
                         can still be changed.

After the shipments for the period 
                           
                              t
                              ∈
                              T
                           
                         are dispatched, the shipments and produced quantities from previous periods are received, and then the demand quantities d
                        
                           t, j, n
                         for product 
                           
                              j
                              ∈
                              J
                           
                         at the retail store 
                           
                              n
                              ∈
                              N
                           
                         are observed. Any demand that is higher than the corresponding inventory level I
                        
                           t, j, n
                         is backordered. However, more involved constructions of handling unmet demand, such as random backlog carry-over (Sohdi, 2005), could alternatively be incorporated.

In this case study, the demand quantities 
                           
                              
                                 δ
                                 t
                              
                              :
                              =
                              
                                 {
                                 
                                    d
                                    
                                       t
                                       ,
                                       j
                                       ,
                                       n
                                    
                                 
                                 
                                 |
                                 
                                 j
                                 ∈
                                 J
                                 ,
                                 
                                 n
                                 ∈
                                 N
                                 }
                              
                           
                         are considered as the main source of uncertainty. In many practical cases, however, SCM has to cope also with different uncertainties (Simchi-Levi et al., 2008; Sohdi & Tang, 2012). Any additional uncertainties can be incorporated the SCMPC approach, as long as they meet the following condition.

                           Assumption 1
                           The uncertainties in the SCM model formulation must be such that the resulting optimization problem (objective function and constraints, see below) would become convex if all uncertain variables were known and fixed.

SCMPC is generally more suited for high-probability low-impact operational risks – such as demand quantities, lead times, production yields, perishable inventories, backlog carry-overs, prices, etc. – rather than low-probability high-impact disruption risks (Oke & Gopalakrishnan, 2009). Furthermore, without loss of generality, joint forecasts for all uncertain variables in the form of scenarios are assumed to exist. They may be inexact (Simchi-Levi et al., 2008), but nonetheless contain some information that is valuable for operational planning.

More precisely, let δt
                         be the set of all uncertainties at time 
                           
                              t
                              ∈
                              T
                           
                         (i.e., not only the demands, in general). Let 
                           
                              δ
                              
                                 t
                                 +
                                 τ
                                 −
                                 1
                                 |
                                 t
                                 −
                                 1
                              
                           
                         be the forecast for the uncertainty over the Tplan
                         next time steps, 
                           
                              τ
                              =
                              1
                              ,
                              …
                              ,
                              
                                 T
                                 
                                    p
                                    l
                                    a
                                    n
                                 
                              
                              ,
                           
                         conditional on the information available at time 
                           
                              t
                              −
                              1
                           
                         when the decisions for periods 
                           
                              t
                              ,
                              t
                              +
                              1
                              ,
                              …
                           
                         have to be made. Here Tplan
                         ≪ T represents a rolling planning horizon, which is much shorter than the total operation time T for the supply chain.

                           Assumption 2
                           At each time step t, 
                                 
                                    (
                                    t
                                    +
                                    1
                                    )
                                    ∈
                                    T
                                    ,
                                 
                               a ‘sufficient number’ 
                                 
                                    k
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    K
                                 
                               of random samples 
                                 
                                    δ
                                    
                                       t
                                       +
                                       τ
                                       |
                                       t
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                               of the uncertainty 
                                 
                                    δ
                                    
                                       t
                                       +
                                       τ
                                       |
                                       t
                                    
                                 
                               is available, over the entire planning horizon 
                                 
                                    τ
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       T
                                       
                                          p
                                          l
                                          a
                                          n
                                       
                                    
                                 
                              . In particular, combining 
                                 
                                    δ
                                    
                                       t
                                       +
                                       τ
                                       |
                                       t
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                               for all 
                                 
                                    k
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    K
                                    }
                                 
                               together with 
                                 
                                    δ
                                    
                                       t
                                       +
                                       τ
                                       |
                                       t
                                    
                                 
                               forms a set of independent and identically distributed (i.i.d.) random variables, for all 
                                 
                                    τ
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       T
                                       
                                          p
                                          l
                                          a
                                          n
                                       
                                    
                                    }
                                 
                              .

For notational convenience, the forecasts over one planning are combined into multi-samples (or scenarios):

                           
                              
                                 
                                    
                                       Ω
                                       t
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    :
                                    =
                                    
                                       {
                                       
                                          δ
                                          
                                             t
                                             +
                                             1
                                             |
                                             t
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       ,
                                       
                                          δ
                                          
                                             t
                                             +
                                             2
                                             |
                                             t
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          δ
                                          
                                             t
                                             +
                                             
                                                T
                                                
                                                   p
                                                   l
                                                   a
                                                   n
                                                
                                             
                                             
                                                |
                                                t
                                             
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       }
                                    
                                    
                                    ∀
                                    
                                    
                                    k
                                    ∈
                                    K
                                    :
                                    =
                                    
                                       {
                                       1
                                       ,
                                       …
                                       ,
                                       K
                                       }
                                    
                                    .
                                 
                              
                           
                        
                     


                        Assumption 2 poses no restriction on the joint distribution of each 
                           
                              δ
                              
                                 t
                                 +
                                 τ
                                 |
                                 t
                              
                              
                                 (
                                 k
                                 )
                              
                           
                        . In fact, it is quite plausible that future demands at different retail stores 
                           
                              n
                              ∈
                              N
                           
                         and between different products 
                           
                              j
                              ∈
                              J
                           
                         are (positively or negatively) correlated. Similarly, the forecasted uncertainties in the scenarios 
                           
                              Ω
                              t
                              
                                 (
                                 k
                                 )
                              
                           
                         can be correlated in time. Furthermore, the distributions of the forecasts are allowed to change over time; e.g., the distribution of 
                           
                              δ
                              
                                 t
                                 +
                                 2
                                 |
                                 t
                              
                           
                         need not be the same as that of 
                           
                              δ
                              
                                 t
                                 +
                                 2
                                 |
                                 t
                                 +
                                 1
                              
                           
                        . In particular, the variance of forecasted demands may decrease due to new market information becoming available over time.


                        Assumption 2 also does not require exact knowledge of the distributions of any future uncertainties. It suffices to have a ‘sufficient number’ of scenarios available (the exact number will be derived in Section 3). These scenarios may be obtained, for instance, from a stochastic prediction model or based on historical data.

For SCM, the supply chain system has to be operated over the time steps 
                           
                              t
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              T
                              }
                           
                         by a control policy, that is a function mapping all available information (past demands, forecasts, etc.) into a possible decision at time 
                           
                              t
                              −
                              1
                           
                         (about production and shipments). The objective is to minimize the expected sum of stage costs

                           
                              (1)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            t
                                                            ∈
                                                            T
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            j
                                                            ∈
                                                            J
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            l
                                                            ∈
                                                            L
                                                         
                                                      
                                                      
                                                         γ
                                                         
                                                            t
                                                            ,
                                                            j
                                                            ,
                                                            l
                                                         
                                                      
                                                      
                                                         y
                                                         
                                                            t
                                                            ,
                                                            j
                                                            ,
                                                            l
                                                         
                                                      
                                                   
                                                   ︸
                                                
                                                
                                                   production
                                                   
                                                   costs
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            t
                                                            ∈
                                                            T
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            j
                                                            ∈
                                                            J
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            s
                                                            ∈
                                                            S
                                                         
                                                      
                                                      
                                                         σ
                                                         
                                                            t
                                                            ,
                                                            j
                                                            ,
                                                            s
                                                         
                                                      
                                                      
                                                         x
                                                         
                                                            t
                                                            ,
                                                            j
                                                            ,
                                                            s
                                                         
                                                      
                                                   
                                                   ︸
                                                
                                                
                                                   shipment
                                                   
                                                   costs
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            t
                                                            ∈
                                                            T
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            j
                                                            ∈
                                                            J
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            ∑
                                                            
                                                               l
                                                               ∈
                                                               L
                                                            
                                                         
                                                         
                                                            ϕ
                                                            
                                                               j
                                                               ,
                                                               l
                                                            
                                                         
                                                         
                                                            I
                                                            
                                                               t
                                                               ,
                                                               j
                                                               ,
                                                               l
                                                            
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               m
                                                               ∈
                                                               M
                                                            
                                                         
                                                         
                                                            ω
                                                            
                                                               j
                                                               ,
                                                               l
                                                            
                                                         
                                                         
                                                            I
                                                            
                                                               t
                                                               ,
                                                               j
                                                               ,
                                                               m
                                                            
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               n
                                                               ∈
                                                               N
                                                            
                                                         
                                                         
                                                            ρ
                                                            
                                                               j
                                                               ,
                                                               l
                                                            
                                                         
                                                         
                                                            I
                                                            
                                                               t
                                                               ,
                                                               j
                                                               ,
                                                               n
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   ︸
                                                
                                                
                                                   inventory
                                                   
                                                   holding
                                                   
                                                   costs
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The production and shipments costs result directly from the decision variables. For the holding costs, the inventory quantities in (1) are recursively computed as

                           
                              (2a)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                I
                                                
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   l
                                                
                                             
                                             =
                                             
                                                I
                                                
                                                   t
                                                   −
                                                   1
                                                   ,
                                                   j
                                                   ,
                                                   l
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            s
                                                            ∈
                                                            S
                                                            ,
                                                            
                                                               s
                                                               1
                                                            
                                                            =
                                                            l
                                                         
                                                      
                                                      
                                                         x
                                                         
                                                            t
                                                            ,
                                                            j
                                                            ,
                                                            s
                                                         
                                                      
                                                   
                                                   ︸
                                                
                                                
                                                   shipments
                                                   
                                                   outbound
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               s
                                                               ∈
                                                               S
                                                            
                                                         
                                                      
                                                      
                                                         y
                                                         
                                                            t
                                                            −
                                                            
                                                               λ
                                                               t
                                                            
                                                            ,
                                                            j
                                                            ,
                                                            l
                                                         
                                                      
                                                   
                                                   ︸
                                                
                                                production
                                             
                                             
                                             ∀
                                             
                                             
                                             l
                                             ∈
                                             L
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2b)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                I
                                                
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   m
                                                
                                             
                                             =
                                             
                                                I
                                                
                                                   t
                                                   −
                                                   1
                                                   ,
                                                   j
                                                   ,
                                                   m
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            s
                                                            ∈
                                                            S
                                                            ,
                                                            
                                                               s
                                                               1
                                                            
                                                            =
                                                            m
                                                         
                                                      
                                                      
                                                         x
                                                         
                                                            t
                                                            ,
                                                            j
                                                            ,
                                                            s
                                                         
                                                      
                                                   
                                                   ︸
                                                
                                                
                                                   shipments
                                                   
                                                   outbound
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            s
                                                            ∈
                                                            S
                                                            ,
                                                            
                                                               s
                                                               2
                                                            
                                                            =
                                                            m
                                                         
                                                      
                                                      
                                                         x
                                                         
                                                            t
                                                            −
                                                            
                                                               λ
                                                               
                                                                  t
                                                                  ,
                                                                  s
                                                               
                                                            
                                                            ,
                                                            j
                                                            ,
                                                            s
                                                         
                                                      
                                                   
                                                   ︸
                                                
                                                
                                                   shipments
                                                   
                                                   inbound
                                                
                                             
                                             
                                             ∀
                                             
                                             
                                             m
                                             ∈
                                             M
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2c)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                I
                                                
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   n
                                                
                                             
                                             =
                                             
                                                I
                                                
                                                   t
                                                   −
                                                   1
                                                   ,
                                                   j
                                                   ,
                                                   n
                                                
                                             
                                             
                                             −
                                             
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            s
                                                            ∈
                                                            S
                                                            ,
                                                            
                                                               s
                                                               1
                                                            
                                                            =
                                                            n
                                                         
                                                      
                                                      
                                                         x
                                                         
                                                            t
                                                            ,
                                                            j
                                                            ,
                                                            s
                                                         
                                                      
                                                   
                                                   ︸
                                                
                                                
                                                   shipments
                                                   
                                                   outbound
                                                
                                             
                                             
                                             +
                                             
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            s
                                                            ∈
                                                            S
                                                            ,
                                                            
                                                               s
                                                               2
                                                            
                                                            =
                                                            n
                                                         
                                                      
                                                      
                                                         x
                                                         
                                                            t
                                                            −
                                                            
                                                               λ
                                                               
                                                                  t
                                                                  ,
                                                                  s
                                                               
                                                            
                                                            ,
                                                            j
                                                            ,
                                                            s
                                                         
                                                      
                                                   
                                                   ︸
                                                
                                                
                                                   shipments
                                                   
                                                   inbound
                                                
                                             
                                             
                                             −
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               s
                                                               ∈
                                                               S
                                                            
                                                         
                                                      
                                                      
                                                         d
                                                         
                                                            t
                                                            ,
                                                            j
                                                            ,
                                                            n
                                                         
                                                      
                                                   
                                                   ︸
                                                
                                                demand
                                             
                                             
                                             
                                             ∀
                                             
                                             n
                                             ∈
                                             N
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                     

for all 
                           
                              j
                              ∈
                              J
                           
                         and 
                           
                              t
                              ∈
                              T
                           
                        .

The control policy has to respect constraints on the production quantities and the shipment quantities

                           
                              (3a)
                              
                                 
                                    
                                       
                                       
                                          
                                             0
                                             ≤
                                             
                                                y
                                                
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   l
                                                
                                             
                                             ,
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                c
                                                j
                                             
                                             
                                                y
                                                
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   l
                                                
                                             
                                             ≤
                                             
                                                C
                                                l
                                             
                                             
                                             ∀
                                             
                                             
                                             l
                                             ∈
                                             L
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3b)
                              
                                 
                                    
                                       
                                       
                                          
                                             0
                                             ≤
                                             
                                                x
                                                
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   s
                                                
                                             
                                             
                                             ∀
                                             
                                             
                                             s
                                             ∈
                                             S
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                     

for all 
                           
                              j
                              ∈
                              J
                           
                         and 
                           
                              t
                              ∈
                              T
                           
                        . Analogous to the maximum production capacities in (3a), constraints on the maximum shipment quantities in (3b) could be incorporated. However, they are not considered for this case study.

Finally, the following constraints on the inventory holdings at the production sites and the warehouses must be observed,

                           
                              (4a)
                              
                                 
                                    
                                       
                                          
                                             0
                                             ≤
                                             
                                                I
                                                
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   l
                                                
                                             
                                             ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                p
                                                j
                                             
                                             
                                                I
                                                
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   l
                                                
                                             
                                             ≤
                                             
                                                P
                                                l
                                             
                                             
                                             ∀
                                             
                                             
                                             l
                                             ∈
                                             L
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4b)
                              
                                 
                                    
                                       
                                          
                                             0
                                             ≤
                                             
                                                I
                                                
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   m
                                                
                                             
                                             ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                w
                                                j
                                             
                                             
                                                I
                                                
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   m
                                                
                                             
                                             ≤
                                             
                                                W
                                                m
                                             
                                             
                                             ∀
                                             
                                             
                                             m
                                             ∈
                                             M
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4c)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                r
                                                j
                                             
                                             
                                                I
                                                
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   n
                                                
                                             
                                             ≤
                                             
                                                R
                                                n
                                             
                                             
                                             ∀
                                             
                                             
                                             n
                                             ∈
                                             N
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                     

for all 
                           
                              j
                              ∈
                              J
                           
                         and 
                           
                              t
                              ∈
                              T
                           
                        . For the retail stores, despite of the uncertainty about the inventory levels, the inventory capacity constraint can be kept by sufficiently careful order placements.

Unless reliable upper bounds on the demands d
                        
                           t, j, n
                         are known, a robust satisfaction of the demands at all times cannot be ensured. Moreover, in practice, such a policy is often too conservative (Schildbach et al., 2014), in the sense that it entails very high inventory holding costs. Instead, constraints on minimum service levels of the supply chain shall be imposed:

                           
                              (5)
                              
                                 
                                    
                                       1
                                       T
                                    
                                    
                                       ∑
                                       
                                          t
                                          ∈
                                          T
                                       
                                    
                                    1
                                    
                                       (
                                       
                                          I
                                          
                                             t
                                             ,
                                             j
                                             ,
                                             n
                                          
                                       
                                       <
                                       0
                                       )
                                    
                                    ≤
                                    
                                       
                                          ɛ
                                       
                                       
                                          j
                                          ,
                                          n
                                       
                                    
                                    
                                    ∀
                                    
                                    
                                    j
                                    ∈
                                    J
                                    ,
                                    
                                    n
                                    ∈
                                    N
                                    .
                                 
                              
                           
                        
                        1(·) denotes an indicator function that equals to 1 if its argument condition is true and to 0 if it is false. The values of ε
                           j, n
                         ∈ (0, 1) represent the prescribed service levels of product 
                           
                              j
                              ∈
                              J
                           
                         at store 
                           
                              n
                              ∈
                              N
                           
                         over the operation time 
                           
                              t
                              ∈
                              T
                           
                        . Note that (5) essentially corresponds to the concept of an α-service level (Bitran & Yanasse, 1984; Bookbinder & Tan, 1988), except that it is considered as the time-average over a long period T rather than a forward-looking probability.

The generic supply chain model described in Section 2 can be considered as a linear control system (Schildbach et al., 2014). The level of all inventories at time 
                        
                           t
                           ∈
                           T
                        
                      represent the state of the system, the decision variables the input of the system, and the inventory update Eq. (2) the (uncertain) dynamics.

The SCMPC policy operates the supply chain in a rolling horizon planning framework, as illustrated in Fig. 2. Besides the planning horizon Tplan
                        , it involves a decision horizon Tdec
                         ≪ Tplan
                         (usually 
                           
                              
                                 T
                                 
                                    d
                                    e
                                    c
                                 
                              
                              =
                              1
                           
                        ) and a fixed production schedule Tprod
                         ≪ Tplan
                        .

In each decision step
                        
                           
                              t
                              =
                              
                                 (
                                 i
                                 −
                                 1
                                 )
                              
                              
                                 T
                                 
                                    d
                                    e
                                    c
                                 
                              
                           
                         where 
                           
                              i
                              ∈
                              {
                              1
                              ,
                              2
                              ,
                              ⋯
                              }
                              ,
                           
                         it computes the optimal decisions for the next Tplan
                         time steps, which satisfy the constraints and guarantee demand satisfaction under all scenarios 
                           
                              k
                              ∈
                              K
                           
                        .

The corresponding Rolling Horizon Scenario Program (RHSCP) reads as follows:

                           
                              (6a)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                             min
                                             
                                             
                                             
                                             
                                                1
                                                K
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                             [
                                             
                                                ∑
                                                
                                                   τ
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                   
                                                      p
                                                      l
                                                      a
                                                      n
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   L
                                                
                                             
                                             
                                                γ
                                                
                                                   t
                                                   +
                                                   τ
                                                   ,
                                                   j
                                                   ,
                                                   l
                                                
                                             
                                             
                                                y
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   l
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   τ
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                   
                                                      p
                                                      l
                                                      a
                                                      n
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                σ
                                                
                                                   t
                                                   +
                                                   τ
                                                   ,
                                                   j
                                                   ,
                                                   s
                                                
                                             
                                             
                                                x
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                                ∑
                                                
                                                   τ
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                   
                                                      p
                                                      l
                                                      a
                                                      n
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      l
                                                      ∈
                                                      L
                                                   
                                                
                                                
                                                   ϕ
                                                   
                                                      j
                                                      ,
                                                      l
                                                   
                                                
                                                
                                                   I
                                                   
                                                      t
                                                      +
                                                      τ
                                                      |
                                                      t
                                                      ,
                                                      j
                                                      ,
                                                      l
                                                   
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      m
                                                      ∈
                                                      M
                                                   
                                                
                                                
                                                   ω
                                                   
                                                      j
                                                      ,
                                                      l
                                                   
                                                
                                                
                                                   I
                                                   
                                                      t
                                                      +
                                                      τ
                                                      |
                                                      t
                                                      ,
                                                      j
                                                      ,
                                                      m
                                                   
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      n
                                                      ∈
                                                      N
                                                   
                                                
                                                
                                                   ρ
                                                   
                                                      j
                                                      ,
                                                      l
                                                   
                                                
                                                
                                                   I
                                                   
                                                      t
                                                      +
                                                      τ
                                                      |
                                                      t
                                                      ,
                                                      j
                                                      ,
                                                      n
                                                   
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                
                                                )
                                             
                                             ]
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6b)
                              
                                 
                                    
                                       
                                          s.t.
                                       
                                       
                                          
                                             
                                             
                                             
                                                I
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   l
                                                
                                             
                                             =
                                             
                                                I
                                                
                                                   t
                                                   +
                                                   τ
                                                   −
                                                   1
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   l
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                   ,
                                                   
                                                      s
                                                      1
                                                   
                                                   =
                                                   l
                                                
                                             
                                             
                                                x
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   s
                                                
                                             
                                             +
                                             
                                                y
                                                
                                                   t
                                                   +
                                                   τ
                                                   −
                                                   
                                                      λ
                                                      t
                                                   
                                                   
                                                      |
                                                      t
                                                      ,
                                                      j
                                                      ,
                                                      l
                                                   
                                                
                                             
                                             
                                             ∀
                                             
                                             
                                             l
                                             ∈
                                             L
                                             ,
                                             
                                             
                                             
                                             
                                                a
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6c)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             
                                                I
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                I
                                                
                                                   t
                                                   +
                                                   τ
                                                   −
                                                   1
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   m
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                   ,
                                                   
                                                      s
                                                      1
                                                   
                                                   =
                                                   m
                                                
                                             
                                             
                                                x
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                   =
                                                   m
                                                
                                             
                                             
                                                x
                                                
                                                   t
                                                   +
                                                   τ
                                                   −
                                                   
                                                      λ
                                                      
                                                         t
                                                         ,
                                                         s
                                                      
                                                   
                                                   
                                                      |
                                                      t
                                                      ,
                                                      j
                                                      ,
                                                      s
                                                   
                                                
                                             
                                             
                                             ∀
                                             
                                             
                                             m
                                             ∈
                                             M
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6d)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             
                                                I
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   n
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                I
                                                
                                                   t
                                                   +
                                                   τ
                                                   −
                                                   1
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   n
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                   ,
                                                   
                                                      s
                                                      1
                                                   
                                                   =
                                                   n
                                                
                                             
                                             
                                                x
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                   =
                                                   n
                                                
                                             
                                             
                                                x
                                                
                                                   t
                                                   +
                                                   τ
                                                   −
                                                   
                                                      λ
                                                      
                                                         t
                                                         ,
                                                         s
                                                      
                                                   
                                                   
                                                      |
                                                      t
                                                      ,
                                                      j
                                                      ,
                                                      s
                                                   
                                                
                                             
                                             −
                                             
                                                d
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   n
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             
                                             ∀
                                             
                                             
                                             n
                                             ∈
                                             N
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6e)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             0
                                             ≤
                                             
                                                y
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   l
                                                
                                             
                                             ,
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                c
                                                j
                                             
                                             
                                                y
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   l
                                                
                                             
                                             ≤
                                             
                                                C
                                                l
                                             
                                             
                                             ∀
                                             
                                             
                                             l
                                             ∈
                                             L
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6f)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             0
                                             ≤
                                             
                                                x
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   s
                                                
                                             
                                             
                                             ∀
                                             
                                             
                                             s
                                             ∈
                                             S
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6g)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             0
                                             ≤
                                             
                                                I
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   l
                                                
                                             
                                             ,
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                p
                                                j
                                             
                                             
                                                I
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   l
                                                
                                             
                                             ≤
                                             
                                                P
                                                l
                                             
                                             
                                             ∀
                                             
                                             
                                             l
                                             ∈
                                             L
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6h)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             0
                                             ≤
                                             
                                                I
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   m
                                                
                                             
                                             ,
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                w
                                                j
                                             
                                             
                                                I
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   m
                                                
                                             
                                             ≤
                                             
                                                W
                                                m
                                             
                                             
                                             ∀
                                             
                                             
                                             m
                                             ∈
                                             M
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6i)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             0
                                             ≤
                                             
                                                I
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   n
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             ,
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                r
                                                j
                                             
                                             
                                                I
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   n
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             ≤
                                             
                                                R
                                                n
                                             
                                             
                                             ∀
                                             
                                             
                                             n
                                             ∈
                                             N
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                     

where the constraints (6b–i) must hold for all 
                           
                              k
                              ∈
                              K
                              ,
                           
                        
                        
                           
                              j
                              ∈
                              J
                              ,
                           
                         and 
                           
                              τ
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              
                                 T
                                 
                                    p
                                    l
                                    a
                                    n
                                 
                              
                              }
                           
                        . The minimization refers to the decisions of shipments and productions,

                           
                              (7)
                              
                                 
                                    
                                       x
                                       
                                          t
                                          +
                                          τ
                                          |
                                          t
                                          ,
                                          j
                                          ,
                                          s
                                       
                                    
                                    
                                    and
                                    
                                    
                                       y
                                       
                                          t
                                          +
                                          τ
                                          |
                                          t
                                          ,
                                          j
                                          ,
                                          l
                                       
                                    
                                    
                                    ∀
                                    
                                    
                                    τ
                                    ∈
                                    
                                       {
                                       1
                                       ,
                                       …
                                       ,
                                       
                                          T
                                          
                                             p
                                             l
                                             a
                                             n
                                          
                                       
                                       }
                                    
                                    ,
                                    
                                    
                                    j
                                    ∈
                                    J
                                    ,
                                    
                                    
                                    s
                                    ∈
                                    S
                                    ,
                                    
                                    
                                    l
                                    ∈
                                    L
                                    ,
                                 
                              
                           
                        except that the productions 
                           
                              y
                              
                                 t
                                 +
                                 τ
                                 |
                                 t
                                 ,
                                 j
                                 ,
                                 s
                              
                           
                         for 
                           
                              τ
                              =
                              1
                              ,
                              …
                              ,
                              
                                 T
                                 
                                    p
                                    r
                                    o
                                    d
                                 
                              
                           
                         are already fixed. Moreover, the initial inventory levels I
                        
                           t|t, j, l
                        , I
                        
                           t|t, j, m
                        , 
                           
                              I
                              
                                 t
                                 |
                                 t
                                 ,
                                 j
                                 ,
                                 n
                              
                              
                                 (
                                 k
                                 )
                              
                           
                         are given from previous steps.

In (6), the 
                           
                              k
                              =
                              1
                              ,
                              …
                              ,
                              K
                           
                         uncertainty scenarios 
                           
                              Ω
                              t
                              
                                 (
                                 k
                                 )
                              
                           
                         have been substituted to obtain a deterministic and convex optimization program. The cost function (6 a) intends to approximate the expectation in (1) by taking the average costs over all K scenarios.

In this particular case study, the demand scenarios 
                           
                              d
                              
                                 t
                                 +
                                 τ
                                 |
                                 t
                                 ,
                                 j
                                 ,
                                 n
                              
                              
                                 (
                                 k
                                 )
                              
                           
                         lead to scenario-specific inventory levels 
                           
                              I
                              
                                 t
                                 +
                                 τ
                                 |
                                 t
                                 ,
                                 j
                                 ,
                                 n
                              
                              
                                 (
                                 k
                                 )
                              
                           
                         for the retail stores. An artificial scenario 
                           
                              K
                              +
                              1
                              ,
                           
                         in which all demands 
                           
                              d
                              
                                 t
                                 +
                                 τ
                                 |
                                 t
                                 ,
                                 j
                                 ,
                                 n
                              
                              
                                 (
                                 K
                                 +
                                 1
                                 )
                              
                           
                         are zero, can be introduced to ensure the satisfaction of the retail storage capacity constraints with certainty. If other uncertainties are present – such as lead times, production yields, perishable inventories, or backlog carry-overs – they must also be included in the RHSCP, by adding a scenario-specific superscript to all scenario-dependent variables.

The overall algorithm of SCMPC can be summarized as follows.


                        
                           
                              
                           
                        
                     

As the number K of scenarios increases, the operation of the supply chain by SCMPC becomes more conservative – i.e., the service levels are expected to improve while the total storage costs are expected to increase. A quantitative analysis of this intuitive relationship is provided below. In particular, a lower bound on K is derived such that the desired service level constraints (5) are satisfied. In order to minimize the long-term operational costs, and also to keep the computational efforts low, K should be selected equal to that lower bound.

                           Remark 3
                           In the RHSCP, the future decisions 
                                 
                                    x
                                    
                                       t
                                       +
                                       τ
                                       |
                                       t
                                       ,
                                       j
                                       ,
                                       s
                                    
                                 
                               for 
                                 
                                    τ
                                    ∈
                                    {
                                    2
                                    ,
                                    …
                                    ,
                                    
                                       T
                                       
                                          p
                                          l
                                          a
                                          n
                                       
                                    
                                    }
                                 
                               and 
                                 
                                    y
                                    
                                       t
                                       +
                                       τ
                                       |
                                       t
                                       ,
                                       j
                                       ,
                                       l
                                    
                                 
                               for 
                                 
                                    τ
                                    ∈
                                    {
                                    
                                       T
                                       
                                          p
                                          r
                                          o
                                          d
                                       
                                    
                                    +
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       T
                                       
                                          p
                                          l
                                          a
                                          n
                                       
                                    
                                    }
                                 
                               are assumed as ‘here-and-now’ decisions. They may also be implemented as ‘wait-and-see’ decisions; i.e., by reacting to the information that becomes available until time 
                                 
                                    t
                                    +
                                    τ
                                    −
                                    1
                                 
                               (Skaf & Boyd, 2009). In fact, they can be modeled as the sum of (arbitrary) basis functions of the past uncertainties 
                                 
                                    
                                       δ
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       δ
                                       
                                          t
                                          +
                                          τ
                                          −
                                          1
                                       
                                    
                                 
                               (Schildbach et al., 2014, Rem. 7).

The subsequent analysis examines the behavior of the SCMPC policy over the entire operation time 
                           
                              t
                              ∈
                              T
                           
                        . The theory draws heavily on the results of Campi and Garatti (2008) and Schildbach, Fagiano, and Morari (2013), as well as on the SCMPC approach presented in Schildbach et al. (2014). Note that the mathematical statements are kept brief, and the reader is referred to the previous work for further details. The following basic assumption is made throughout.

                           Assumption 4
                           The RHSCP remains a feasible optimization program at each decision step 
                                 
                                    t
                                    =
                                    
                                       (
                                       i
                                       −
                                       1
                                       )
                                    
                                    
                                       T
                                       
                                          d
                                          e
                                          c
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    i
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    ⋯
                                    }
                                 
                               (Schildbach et al., 2014, Ass. 5).


                        Assumption 4 appears to be restrictive from a theoretical point of view. However, it is quite reasonable for many practical applications. It presumes that the supply chain is ‘well designed’ with regards to the available capacities. Moreover, it requires that a ‘back-up decision rule’ is available for cases when the demands cannot be fulfilled; e.g., by replacing the lower inventory constraints with high penalties on stockout quantities. This soft constrained approach shall be used for the simulation results in Section 4 (Qin & Badgwell, 2003).

                           Definition 5
                           (a) An uncertain convex program is a general optimization program with one (or multiple) uncertain constraint(s), that becomes convex if any possible value of the uncertainty were fixed. (b) The scenario program derives from the uncertain convex program by replacing the uncertain constraint with a finite number of sampled versions of this constraint, which are obtained by substituting fixed samples of the uncertainty (Campi and Garatti, 2008, Sec. 1).

Observe that the RHSCP is a scenario program, with the retail inventory levels (6 i) being the sampled constraints. It can be shown that the solution of a scenario program (scenario solution) has certain generalization properties with respect to the original uncertain convex program (Campi & Garatti, 2008). Only some of these aspects, however, are relevant for the theory of this paper.

                           Definition 6
                           (a) The unconstrained subspace of a sampled constraint in a scenario program is the largest linear subspace (in a set inclusion sense) of the decision space that remains unconstrained by the sampled instances of this constraint. (b) The support rank of a sampled constraint in a scenario program is the co-dimension of its unconstrained subspace (Schildbach et al., 2013, Def. 3.6).


                              Let
                              
                                 
                                    ζ
                                    
                                       t
                                       +
                                       τ
                                       |
                                       t
                                       ,
                                       j
                                       ,
                                       n
                                    
                                 
                               
                              be the support rank of the sampled retail inventory constraint (
                              
                                 6
                              
                              i) of the RHSCP, for
                              
                                 
                                    τ
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       T
                                       
                                          d
                                          e
                                          c
                                       
                                    
                                    }
                                 
                               
                              and any
                              
                                 
                                    t
                                    =
                                    
                                       (
                                       i
                                       −
                                       1
                                       )
                                    
                                    
                                       T
                                       
                                          d
                                          e
                                          c
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    i
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    ⋯
                                    }
                                    ,
                                 
                              
                              
                                 
                                    j
                                    ∈
                                    J
                                    ,
                                 
                              
                              
                                 
                                    n
                                    ∈
                                    N
                                 
                              
                              . Then, for any value of these indices,
                              
                                 
                                    
                                       ζ
                                       
                                          t
                                          +
                                          τ
                                          |
                                          t
                                          ,
                                          j
                                          ,
                                          n
                                       
                                    
                                    =
                                    1
                                 
                              
                              .
                           

Consider the sampled retail inventory constraint (6 i) of the RHSCP, for a fixed 
                                 
                                    τ
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       T
                                       
                                          d
                                          e
                                          c
                                       
                                    
                                    }
                                 
                               and any 
                                 
                                    t
                                    =
                                    
                                       (
                                       i
                                       −
                                       1
                                       )
                                    
                                    
                                       T
                                       
                                          d
                                          e
                                          c
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    i
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    ⋯
                                    }
                                    ,
                                 
                              
                              
                                 
                                    j
                                    ∈
                                    J
                                    ,
                                 
                              
                              
                                 
                                    n
                                    ∈
                                    N
                                 
                              . Of all the decision variables (7), the constraint directly affects only the subsets

                                 
                                    (8)
                                    
                                       
                                          
                                             {
                                             −
                                             
                                                x
                                                
                                                   t
                                                   +
                                                   α
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   s
                                                
                                             
                                             |
                                             α
                                             ≤
                                             τ
                                             ,
                                             
                                             
                                                s
                                                1
                                             
                                             =
                                             n
                                             }
                                          
                                          
                                          
                                          and
                                          
                                          
                                          
                                             {
                                             
                                                x
                                                
                                                   t
                                                   +
                                                   α
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   s
                                                
                                             
                                             |
                                             α
                                             +
                                             
                                                λ
                                                
                                                   t
                                                   +
                                                   α
                                                   ,
                                                   s
                                                
                                             
                                             ≤
                                             τ
                                             ,
                                             
                                             
                                                s
                                                2
                                             
                                             =
                                             n
                                             }
                                          
                                          .
                                       
                                    
                                 
                              Moreover, the sampled constraints require that the sum of all decision variables in (8) must be greater than or equal to the quantities

                                 
                                    (9)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      τ
                                                   
                                                   
                                                      d
                                                      
                                                         t
                                                         +
                                                         i
                                                         |
                                                         t
                                                         ,
                                                         j
                                                         ,
                                                         n
                                                      
                                                      
                                                         (
                                                         k
                                                         )
                                                      
                                                   
                                                
                                                ︸
                                             
                                             
                                                sum
                                                
                                                of
                                                
                                                demands
                                             
                                          
                                          
                                          −
                                          
                                             
                                                
                                                   I
                                                   
                                                      t
                                                      |
                                                      t
                                                      ,
                                                      j
                                                      ,
                                                      n
                                                   
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                
                                                ︸
                                             
                                             
                                                initial
                                                
                                                inventory
                                             
                                          
                                          
                                          for
                                          
                                          all
                                          
                                          samples
                                          
                                          k
                                          ∈
                                          K
                                          .
                                       
                                    
                                 
                              For all 
                                 
                                    k
                                    ∈
                                    K
                                    ,
                                 
                               the sum of all decision variables in (8) is equivalent to a vector product of the entire decision vector with a fixed vector (of zeros, ones, and negative ones). This fixed vector has a null space of co-dimension one (Schildbach et al., 2013, Ex. 3.5), and hence the result follows.□

Let 
                                 
                                    t
                                    =
                                    
                                       (
                                       i
                                       −
                                       1
                                       )
                                    
                                    
                                       T
                                       
                                          d
                                          e
                                          c
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    i
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    }
                                    ,
                                 
                              
                              
                                 
                                    j
                                    ∈
                                    J
                                    ,
                                 
                              
                              
                                 
                                    n
                                    ∈
                                    N
                                 
                               be fixed. For any 
                                 
                                    τ
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       T
                                       
                                          d
                                          e
                                          c
                                       
                                    
                                    }
                                    ,
                                 
                               the violation probability
                              
                                 
                                    
                                       V
                                       
                                          t
                                          +
                                          τ
                                          |
                                          t
                                          ,
                                          j
                                          ,
                                          n
                                       
                                    
                                    ∈
                                    
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                    
                                 
                               is the probability with the inventory at 
                                 
                                    t
                                    +
                                    τ
                                 
                               becomes negative if the scenario solution of the RHSCP at time step t is applied to the supply chain (Campi and Garatti, 2008, Def. 1.1).

For the first part of the analysis, fix an arbitrary state of the supply chain at time t; see Fig. 3
                        . Note that each violation probability 
                           
                              V
                              
                                 t
                                 +
                                 τ
                                 |
                                 t
                                 ,
                                 j
                                 ,
                                 n
                              
                           
                         is then a function of the scenarios 
                           
                              Ω
                              
                                 t
                              
                              
                                 (
                                 k
                                 )
                              
                           
                         for 
                           
                              k
                              ∈
                              K
                           
                         extracted at time t. Since the scenarios are random, 
                           
                              V
                              
                                 t
                                 +
                                 τ
                                 |
                                 t
                                 ,
                                 j
                                 ,
                                 n
                              
                           
                         is itself a random variable (Schildbach et al., 2014, Sec. 4.2).

                           Theorem 9
                           
                              Let 
                              
                                 Assumptions 2
                               
                              and 
                              
                                 4
                               
                              hold and an arbitrary state of the supply chain at time
                              
                                 
                                    t
                                    =
                                    
                                       (
                                       i
                                       −
                                       1
                                       )
                                    
                                    
                                       T
                                       
                                          d
                                          e
                                          c
                                       
                                    
                                    ,
                                 
                               
                              where
                              
                                 
                                    i
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    ⋯
                                    }
                                    ,
                                 
                               
                              be fixed. Then for any
                              
                                 
                                    j
                                    ∈
                                    J
                                    ,
                                 
                              
                              
                                 
                                    n
                                    ∈
                                    N
                                    ,
                                 
                               
                              and
                              
                                 
                                    τ
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       T
                                       
                                          d
                                          e
                                          c
                                       
                                    
                                    }
                                 
                               
                              the random violation probability satisfies
                              
                                 
                                    (10)
                                    
                                       
                                          
                                             E
                                             
                                                Ω
                                                
                                                   t
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          
                                             [
                                             
                                                V
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   n
                                                
                                             
                                             ]
                                          
                                          ≤
                                          
                                             
                                                ζ
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   n
                                                
                                             
                                             
                                                K
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             1
                                             
                                                K
                                                +
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                              where the expectation
                              
                                 
                                    
                                       E
                                       
                                          Ω
                                          
                                             t
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                    
                                       [
                                       ·
                                       ]
                                    
                                 
                               
                              refers to the random scenarios
                              
                                 
                                    
                                       Ω
                                       
                                          t
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    k
                                    ∈
                                    K
                                 
                              
                              .
                           

By Lemma 7, for any 
                                 
                                    t
                                    =
                                    
                                       (
                                       i
                                       −
                                       1
                                       )
                                    
                                    
                                       T
                                       
                                          d
                                          e
                                          c
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    i
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    ⋯
                                    }
                                    ,
                                 
                              
                              
                                 
                                    j
                                    ∈
                                    J
                                    ,
                                 
                              
                              
                                 
                                    n
                                    ∈
                                    N
                                    ,
                                 
                              
                              
                                 
                                    τ
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       T
                                       
                                          d
                                          e
                                          c
                                       
                                    
                                    }
                                 
                               the support rank of the corresponding sampled constraint in (6 i) is 
                                 
                                    
                                       ζ
                                       
                                          t
                                          +
                                          τ
                                          |
                                          t
                                          ,
                                          j
                                          ,
                                          n
                                       
                                    
                                    =
                                    1
                                 
                              . By (Schildbach et al., 2013, Thm. 4.1), the distribution of 
                                 
                                    V
                                    
                                       t
                                       +
                                       τ
                                       |
                                       t
                                       ,
                                       j
                                       ,
                                       n
                                    
                                 
                               is therefore upper bounded by

                                 
                                    (11)
                                    
                                       
                                          
                                             P
                                             
                                                Ω
                                                
                                                   t
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          
                                             [
                                             
                                                V
                                                
                                                   t
                                                   +
                                                   τ
                                                   |
                                                   t
                                                   ,
                                                   j
                                                   ,
                                                   n
                                                
                                             
                                             ≥
                                             ν
                                             ]
                                          
                                          ≤
                                          B
                                          
                                             (
                                             ν
                                             ;
                                             0
                                             ,
                                             K
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              where B( · ; ·, ·) denotes the beta distribution (Abramowitz & Stegun, 1970, Sec. 26.5.3,26.5.7). An integration of this distribution yields the desired result.□

As a result of Theorem 9, the lower bound on K that is required for the service level constraint (5) is given by

                           
                              (12)
                              
                                 
                                    
                                       1
                                       
                                          K
                                          +
                                          1
                                       
                                    
                                    ≤
                                    
                                       ɛ
                                    
                                    
                                    ⟺
                                    
                                    K
                                    ≥
                                    
                                       1
                                       
                                          ɛ
                                       
                                    
                                    −
                                    1
                                    .
                                 
                              
                           
                        For the remainder of the section, it is therefore assumed that the sample size K is chosen according to (12).

After the scenarios 
                           
                              Ω
                              t
                              
                                 (
                                 k
                                 )
                              
                           
                         at 
                           
                              t
                              =
                              
                                 (
                                 i
                                 −
                                 1
                                 )
                              
                              
                                 T
                                 
                                    d
                                    e
                                    c
                                 
                              
                           
                         are fixed, the actual violations 
                           
                              1
                              (
                              
                                 I
                                 
                                    t
                                    +
                                    τ
                                    ,
                                    j
                                    ,
                                    n
                                 
                              
                              <
                              0
                              )
                           
                         over the decision horizon 
                           
                              τ
                              =
                              1
                              ,
                              …
                              ,
                              
                                 T
                                 
                                    d
                                    e
                                    c
                                 
                              
                           
                         are random variables with (now fixed) parameters 
                           
                              
                                 V
                                 
                                    t
                                    +
                                    τ
                                    |
                                    t
                                    ,
                                    j
                                    ,
                                    n
                                 
                              
                              ,
                           
                         respectively. Their outcome is determined by the actual uncertainties 
                           
                              δ
                              
                                 t
                                 +
                                 τ
                              
                           
                         over 
                           
                              τ
                              =
                              1
                              ,
                              …
                              ,
                              
                                 T
                                 
                                    d
                                    e
                                    c
                                 
                              
                           
                         and they satisfy

                           
                              (13)
                              
                                 
                                    
                                       E
                                       
                                          Ω
                                          t
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                    
                                       [
                                       
                                          E
                                          
                                             δ
                                             
                                                t
                                                +
                                                τ
                                             
                                          
                                       
                                       
                                          [
                                          1
                                          
                                             (
                                             
                                                I
                                                
                                                   t
                                                   +
                                                   τ
                                                   ,
                                                   j
                                                   ,
                                                   n
                                                
                                             
                                             <
                                             0
                                             )
                                          
                                          ]
                                       
                                       ]
                                    
                                    =
                                    
                                       
                                          
                                             
                                                E
                                                
                                                   Ω
                                                   
                                                      t
                                                   
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                
                                             
                                             
                                                [
                                                
                                                   V
                                                   
                                                      t
                                                      +
                                                      τ
                                                      |
                                                      t
                                                      ,
                                                      j
                                                      ,
                                                      n
                                                   
                                                
                                                ]
                                             
                                          
                                          ︸
                                       
                                       
                                          ≤
                                          
                                             ɛ
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 E
                                 
                                    δ
                                    
                                       t
                                       +
                                       τ
                                    
                                 
                              
                              
                                 [
                                 ·
                                 ]
                              
                           
                         refers to the expectation with respect to the uncertainties 
                           
                              
                                 δ
                                 
                                    t
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 δ
                                 
                                    t
                                    +
                                    
                                       T
                                       
                                          d
                                          e
                                          c
                                       
                                    
                                 
                              
                           
                        . Note that (13) holds because 
                           
                              1
                              (
                              
                                 I
                                 
                                    t
                                    +
                                    τ
                                    ,
                                    j
                                    ,
                                    n
                                 
                              
                              <
                              0
                              )
                           
                         is a generic binomial random variable with parameter 
                           
                              
                                 V
                                 
                                    t
                                    +
                                    τ
                                    |
                                    t
                                    ,
                                    j
                                    ,
                                    n
                                 
                              
                              ,
                           
                         once 
                           
                              V
                              
                                 t
                                 +
                                 τ
                                 |
                                 t
                                 ,
                                 j
                                 ,
                                 n
                              
                           
                         is fixed.

In general, the random variables 
                           
                              1
                              (
                              
                                 I
                                 
                                    t
                                    +
                                    τ
                                    ,
                                    j
                                    ,
                                    n
                                 
                              
                              <
                              0
                              )
                           
                         for 
                           
                              τ
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              
                                 T
                                 
                                    d
                                    e
                                    c
                                 
                              
                              }
                              ,
                           
                        
                        
                           
                              j
                              ∈
                              J
                              ,
                           
                        
                        
                           
                              n
                              ∈
                              N
                           
                         are correlated. Nonetheless, by linearity of expectation, they satisfy

                           
                              (14)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                E
                                                
                                                   Ω
                                                   t
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                
                                             
                                             
                                                [
                                                
                                                   E
                                                   
                                                      δ
                                                      
                                                         t
                                                         +
                                                         τ
                                                      
                                                   
                                                
                                                
                                                   [
                                                   1
                                                   
                                                      (
                                                      
                                                         I
                                                         
                                                            t
                                                            +
                                                            1
                                                            ,
                                                            j
                                                            ,
                                                            n
                                                         
                                                      
                                                      <
                                                      0
                                                      )
                                                   
                                                   +
                                                   ⋯
                                                   +
                                                   1
                                                   
                                                      (
                                                      
                                                         I
                                                         
                                                            t
                                                            +
                                                            
                                                               T
                                                               
                                                                  d
                                                                  e
                                                                  c
                                                               
                                                            
                                                            ,
                                                            j
                                                            ,
                                                            n
                                                         
                                                      
                                                      <
                                                      0
                                                      )
                                                   
                                                   ]
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             =
                                             
                                                E
                                                
                                                   Ω
                                                   
                                                      t
                                                   
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                
                                             
                                             
                                                [
                                                
                                                   V
                                                   
                                                      t
                                                      +
                                                      1
                                                      |
                                                      t
                                                      ,
                                                      j
                                                      ,
                                                      n
                                                   
                                                
                                                ]
                                             
                                             +
                                             ⋯
                                             +
                                             
                                                E
                                                
                                                   Ω
                                                   
                                                      t
                                                   
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                
                                             
                                             
                                                [
                                                
                                                   V
                                                   
                                                      t
                                                      +
                                                      
                                                         T
                                                         
                                                            d
                                                            e
                                                            c
                                                         
                                                      
                                                      
                                                         |
                                                         t
                                                         ,
                                                         j
                                                         ,
                                                         n
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             ≤
                                             
                                                T
                                                
                                                   d
                                                   e
                                                   c
                                                
                                             
                                             ·
                                             
                                                ɛ
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

With the above observations, it is possible to analyze the sequence of identical decision periods, see Fig. 3. Hence the following fundamental result for the long-term properties of SCMPC is obtained.

                           Theorem 10
                           
                              Let 
                              
                                 Assumptions 2
                               
                              and 
                              
                                 4
                               
                              hold and consider the supply chain over a sequence
                              
                                 
                                    i
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    T
                                    /
                                    
                                       T
                                       
                                          d
                                          e
                                          c
                                       
                                    
                                    }
                                 
                               
                              of decision periods. Then
                              
                                 
                                    (15)
                                    
                                       
                                          
                                             lim sup
                                             
                                                i
                                                →
                                                ∞
                                             
                                          
                                          
                                          
                                             1
                                             i
                                          
                                          
                                             (
                                             1
                                             
                                                (
                                                
                                                   I
                                                   
                                                      t
                                                      +
                                                      1
                                                      ,
                                                      j
                                                      ,
                                                      n
                                                   
                                                
                                                <
                                                0
                                                )
                                             
                                             +
                                             ⋯
                                             +
                                             1
                                             
                                                (
                                                
                                                   I
                                                   
                                                      t
                                                      +
                                                      
                                                         T
                                                         
                                                            d
                                                            e
                                                            c
                                                         
                                                      
                                                      ,
                                                      j
                                                      ,
                                                      n
                                                   
                                                
                                                <
                                                0
                                                )
                                             
                                             )
                                          
                                          ≤
                                          
                                             T
                                             
                                                d
                                                e
                                                c
                                             
                                          
                                          ·
                                          
                                             ɛ
                                          
                                       
                                    
                                 
                              
                              for any
                              
                                 
                                    j
                                    ∈
                                    J
                                 
                               
                              and
                              
                                 
                                    n
                                    ∈
                                    N
                                    ,
                                 
                               
                              almost surely.
                           

Note that Theorem 10 is essentially the same as saying

                           
                              (16)
                              
                                 
                                    
                                       lim sup
                                       
                                          T
                                          →
                                          ∞
                                       
                                    
                                    
                                    
                                       1
                                       T
                                    
                                    
                                       ∑
                                       
                                          t
                                          ∈
                                          T
                                       
                                    
                                    1
                                    
                                       (
                                       
                                          I
                                          
                                             t
                                             ,
                                             j
                                             ,
                                             n
                                          
                                       
                                       <
                                       0
                                       )
                                    
                                    ≤
                                    
                                       ɛ
                                    
                                 
                              
                           
                        almost surely, except for the minor requirement that the time length T be divisible by Tdec
                        . The limit supremum in (15) and (16) refers to the sequence of time-average constraint violations. Therefore (16) means satisfaction of the service level constraint (5) in the strongest sense possible: namely, SCMPC keeps the service level of 
                           
                              1
                              −
                              
                                 ɛ
                              
                           
                         almost surely as time goes to infinity.

                           Proof
                           The violations of each decision period 
                                 
                                    i
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    T
                                    /
                                    
                                       T
                                       
                                          d
                                          e
                                          c
                                       
                                    
                                    }
                                 
                               are generally dependent on the decisions and uncertainty outcomes of the previous time periods. However, they are independent conditionally on a fixed state of the system in the time period 
                                 
                                    
                                       (
                                       i
                                       −
                                       1
                                       )
                                    
                                    
                                       T
                                       
                                          d
                                          e
                                          c
                                       
                                    
                                    ,
                                 
                               respectively.


                              Theorem 9 holds identically for all states at the beginning of each time period 
                                 
                                    
                                       (
                                       i
                                       −
                                       1
                                       )
                                    
                                    
                                       T
                                       
                                          d
                                          e
                                          c
                                       
                                    
                                    ,
                                 
                               under Assumptions 2 and 4. Therefore, the actual violations (14) over the decision periods 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    ⋯
                                 
                               form a sequence of martingale differences (Hall & Heyde, 1980). The result now follows by noting that the left-hand side of (15) is the sum of martingale differences (Schildbach et al., 2014, Lem. 16 and Thm. 17).□

In general, the service levels ε
                                 j, n
                               ∈ (0, 1) can be chosen individually for each product 
                                 
                                    j
                                    ∈
                                    J
                                 
                               and retail store 
                                 
                                    n
                                    ∈
                                    N
                                 
                              . However, then individual sample sizes K
                              
                                 j, n
                               must be selected accordingly (Schildbach et al., 2014). Henceforth, a universal service level 
                                 
                                    
                                       
                                          ɛ
                                       
                                       
                                          j
                                          ,
                                          n
                                       
                                    
                                    =
                                    
                                       ɛ
                                    
                                 
                               is assumed in this paper, for all 
                                 
                                    j
                                    ∈
                                    J
                                 
                               and 
                                 
                                    n
                                    ∈
                                    N
                                 
                              .

This case study considers the supply chain model introduced in Section 2 under the SCMPC algorithm described in Section 3. First, the numerical parameters of the model are specified. Thereafter, the results of the simulation experiments are presented and discussed.

The numerical values of the simulation model are given in Table 1
                        . The costs are assumed to be in any unit currency, and the time steps 
                           
                              t
                              ∈
                              T
                           
                         can be considered to be weeks. The planning horizon is 
                           
                              
                                 T
                                 
                                    p
                                    l
                                    a
                                    n
                                 
                              
                              =
                              26
                              
                              weeks
                              ,
                           
                         the decision horizon is 
                           
                              
                                 T
                                 
                                    d
                                    e
                                    c
                                 
                              
                              =
                              1
                              
                              week
                              ,
                           
                         and the production schedule is fixed 
                           
                              
                                 T
                                 
                                    p
                                    r
                                    o
                                    d
                                 
                              
                              =
                              4
                              
                              weeks
                           
                         in advance. The simulations are run for a total operation time of two years (
                           
                              T
                              =
                              104
                              
                              weeks
                           
                        ).

The demand quantities d
                        
                           t, 1, n
                         for product 
                           
                              j
                              =
                              1
                           
                         are modeled as the sum of a constant, a seasonal, and a random component. The random component is given by an autoregressive model with stationary, uniformly distributed innovations. In contrast, product 
                           
                              j
                              =
                              2
                           
                         is assumed to have a finite life cycle, such that the demand quantities d
                        
                           t, 2, n
                         peak around 
                           
                              t
                              =
                              40
                           
                         to 
                           
                              t
                              =
                              60
                           
                        . However, the size and the time of the peak are uncertain. For an illustration of the demand patterns, Fig. 4
                        
                         depicts a few random sample paths.

Consider the case where the service level of 
                              
                                 
                                    ɛ
                                 
                                 =
                                 5
                                 %
                              
                            is fixed. Fig. 5 depicts a typical trajectory for the productions by the facilities 
                              
                                 l
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                              
                           . Observe that during the weeks around the peak demand of product 
                              
                                 j
                                 =
                                 2
                                 ,
                              
                            its production (long dashed lines) utilizes almost all of the available capacities (solid lines).


                           Fig. 6
                            depicts the inventories of the warehouses 
                              
                                 m
                                 ∈
                                 M
                              
                            and retail stores 
                              
                                 n
                                 ∈
                                 N
                              
                            during the simulation period. Observe that for product 
                              
                                 j
                                 =
                                 1
                              
                            the retail inventory levels are fairly constant, and for product 
                              
                                 j
                                 =
                                 2
                              
                            the retail inventory levels are distinctly higher during the peak demand period; see Fig. 6(c and d). The explanation is that the retail inventories serve as a buffer against the demand uncertainty, while they are unrelated to the demand level. In particular, for product 
                              
                                 j
                                 =
                                 1
                              
                            the demand uncertainty is constant over time, while there are seasonal fluctuations in the demand level. For product 
                              
                                 j
                                 =
                                 2
                                 ,
                              
                            the highest demand uncertainty is around the peak of the life cycle; see Fig. 4.

Some safety stocks are also kept on the warehouse level, where inventory holding costs are significantly lower; see Fig. 6(a and b). However, an additional peak can be observed in the inventory, in particular of product 
                              
                                 j
                                 =
                                 1
                                 ,
                              
                            around weeks 40 to 50. This is due the anticipated bottleneck in the production capacity during weeks 40–60; compare Fig. 5. Since the inventory holding cost per production capacity coefficient is cheaper for product 
                              
                                 j
                                 =
                                 1
                                 ,
                              
                            the peak demand for product 
                              
                                 j
                                 =
                                 2
                              
                            induces a pre-production of product 
                              
                                 j
                                 =
                                 1
                              
                           .

For the simulation run in Fig. 6, the average service levels of all retail stores 
                              
                                 n
                                 ∈
                                 N
                              
                            (i.e., the fraction of time steps in with stockout) are 
                              
                                 
                                    
                                       
                                          ɛ
                                       
                                       ¯
                                    
                                    
                                       1
                                       ,
                                       n
                                    
                                 
                                 =
                                 4.68
                                 %
                              
                            for product 
                              
                                 j
                                 =
                                 1
                              
                            and 
                              
                                 
                                    
                                       
                                          ɛ
                                       
                                       ¯
                                    
                                    
                                       2
                                       ,
                                       n
                                    
                                 
                                 =
                                 4.04
                                 %
                              
                            for product 
                              
                                 j
                                 =
                                 2
                              
                           . Hence they satisfy the desired service level of ε1, n
                           , ε2, n
                            ≤ 5%.

The results of a more extensive study is summarized in Table 2
                           . For a variety of sample sizes K and its corresponding guaranteed service levels ε
                              j, n
                           , the empirical service levels 
                              
                                 
                                    
                                       ɛ
                                    
                                    ¯
                                 
                                 
                                    j
                                    ,
                                    n
                                 
                              
                            are evaluated based on one hundred simulation runs. Observe that in all cases the theoretical services level bounds of 
                              
                                 
                                    1
                                    
                                       K
                                       +
                                       1
                                    
                                 
                                 ,
                              
                            as derived in (12), are matched quite tightly by the empirical service levels.

A comparison of the performance of SCMPC to other approaches is not straightforward, because they are difficult to apply in this setting. Indeed, the uncertainty consists of 30 demand quantities d
                           
                              t, j, n
                            (for 2 products at 15 stores) at each time step over the planning horizon 
                              
                                 τ
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 26
                              
                           . Moreover, the demand quantities evolve in time by an autoregressive process – therefore, they are correlated in time and an explicit distribution is not available.


                           Stochastic optimization would have to handle a general multi-variate (30-dimensional), continuous, time-varying demand distribution at each stage 
                              
                                 τ
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 26
                              
                            that is conditionally dependent on the uncertainty of previous stages. Since this is generally impossible, an approximation by a much simpler stochastic model, e.g., a binary scenario tree, is required. Yet even this simple model consists of 226 ≈ 67.1 million scenarios, so the computations would become intractable (Sohdi & Tang, 2012).


                           Robust optimization would have to (optimally) fit uncertainty sets for the 30-dimensional demand quantities, in particular such that these sets contain 
                              
                                 (
                                 1
                                 −
                                 
                                    ɛ
                                 
                                 )
                              
                            of the multi-variate probability mass. In general, this problem is extremely hard and it must be solved repeatedly for the time-varying distribution (Bertsimas & Thiele, 2004).

However, robust optimization can make a simple, conservative approximation (ROPT). Each uncertain demand quantity d
                           
                              t, j, n
                            is independently set to its 
                              
                                 (
                                 1
                                 −
                                 
                                    ɛ
                                 
                                 )
                              
                            
                           quantile; that is, the value that it will not exceed with a probability of more than ε. This procedure is simple and tractable, e.g., by a Monte Carlo simulation. However, it is conservative because, for instance, the 
                              
                                 (
                                 1
                                 −
                                 
                                    ɛ
                                 
                                 )
                              
                            quantile of the sum of demands (over some stores 
                              
                                 n
                                 ∈
                                 N
                              
                            or periods 
                              
                                 t
                                 ∈
                                 T
                              
                           ) is much lower than the sum of their 
                              
                                 (
                                 1
                                 −
                                 
                                    ɛ
                                 
                                 )
                              
                            quantiles (except if they are perfectly correlated).


                           Table 3
                            compares the performances of SCMPC to ROPT, regarding the total transportation costs Htran
                            and total storage costs Hstor
                           . Observe that the transportation costs remain fairly constant between SCMPC and ROPT, and across all service levels. However, the storage costs rise for an increasing service level, both within SCMPC and ROPT. Finally, SCMPC shows significant savings in the storage cost compared to ROPT for all service levels.

@&#CONCLUSION@&#

This paper has presented a new scenario-based model predictive control (SCMPC) approach for the coordinated management of a large variety of supply chains. SCMPC can handle very general stochastic uncertainties in the system and guarantees a pre-specified customer service level. It is computationally efficient, as it requires only a few sample scenarios in each time step. Therefore, SCMPC may offer substantial advantages over existing approaches based on stochastic or robust optimization.

The effectiveness of the SCMPC approach has been demonstrated in a case study. It has been shown that the decisions of the method are reasonable and keep the desired service level constraints accurately, in the long run. Moreover, SCPMC has achieved substantial cost savings as compared to a computationally tractable robust optimization approach.

@&#ACKNOWLEDGMENTS@&#

The authors thank the Associate Editor and three anonymous Referees for sharing their knowledgable insights and helpful suggestions to improve the paper.

@&#REFERENCES@&#

