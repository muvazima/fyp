@&#MAIN-TITLE@&#EM-GPA: Generalized Procrustes analysis with hidden variables for 3D shape modeling

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose EM-GPA algorithm to handle shapes with missing data.


                        
                        
                           
                           EM GPA combines GPA and the expectation-maximization (EM) algorithm.


                        
                        
                           
                           2D shapes can be considered as 3D shapes with missing depth information.


                        
                        
                           
                           EM-GPA finds scales, rotations and 3D shapes along with their mean and covariance.


                        
                        
                           
                           The method accurately estimates the 3D mean and covariance matrix for 3D shape modeling.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Shape alignment

Procrustes analysis

Non-rigid structure from motion

Virtual 3D shape model

@&#ABSTRACT@&#


               
               
                  Aligning shapes is essential in many computer vision problems and generalized Procrustes analysis (GPA) is one of the most popular algorithms to align shapes. However, if some of the shape data are missing, GPA cannot be applied. In this paper, we propose EM-GPA, which extends GPA to handle shapes with hidden (missing) variables by using the expectation-maximization (EM) algorithm. For example, 2D shapes can be considered as 3D shapes with missing depth information due to the projection of 3D shapes into the image plane. For a set of 2D shapes, EM-GPA finds scales, rotations and 3D shapes along with their mean and covariance matrix for 3D shape modeling. A distinctive characteristic of EM-GPA is that it does not enforce any rank constraint often appeared in other work and instead uses GPA constraints to resolve the ambiguity in finding scales, rotations, and 3D shapes. The experimental results show that EM-GPA can recover depth information accurately even when the noise level is high and there are a large number of missing variables. By using the images from the FRGC database, we show that EM-GPA can successfully align 2D shapes by taking the missing information into consideration. We also demonstrate that the 3D mean shape and its covariance matrix are accurately estimated. As an application of EM-GPA, we construct a 2D+3D AAM (active appearance model) using the 3D shapes obtained by EM-GPA, and it gives a similar success rate in model fitting compared to the method using real 3D shapes. EM-GPA is not limited to the case of missing depth information, but it can be easily extended to more general cases.
               
            

@&#INTRODUCTION@&#

In computer vision, the study of shape using a set of landmark points is an important issue which appears in many application, such as image registration [1–3], gait recognition [4,5], shape modeling [6,7], motion analysis [8,9,4,5], and stereo reconstruction [10]. According to Kendall’s definition [11], the shape of an object is the geometrical information that remains after the effects of the Euclidean similarity transformations (rigid transforms) are filtered out. In many cases, this information can be found by aligning a set of shapes to a common reference, using generalized Procrustes analysis (GPA) [12,13]. GPA performs Euclidean similarity transforms on a set of shapes to minimize the sum of squared distances between all shapes and a reference shape. In many recent applications [14–17], however, a set of shapes have to be aligned with some missing information, which induces several problems. For example, GPA cannot be applied when aligning some rotated 3D shapes with missing depth information. If, somehow, we can align the 3D shapes by aligning 2D points with probabilistic information on depth, it will be very useful in many applications [18–21]. This can be considered to be equivalent to recovering 3D shapes and motion from a set of 2D shapes (non-rigid structure from motion, NRSfM), and many studies have solved this by using factorization methods [22–24,17]. However, those methods have ambiguity in the solution and require additional constraints to find a unique solution [25]. Recently, Torresani et al. [15,16] proposed an approach (EM-PPCA) using probabilistic principal components analysis which simultaneously estimates 3D shapes and rotations from 2D shape streams. Paladini et al. [17] proposed a least-squares approach (MP) associated with a globally optimal projection step onto the manifold of metric constraints to recover 3D shapes and motion of deformable and articulated objects. Both methods constrain the rank of deformation space to resolve the ambiguity. However, it is difficult to know the rank correctly beforehand.

Unlike the other work that put a constraint on the deformation space, we conjecture that it is better to put constraints on the rigid transforms so that they are not affected by the characteristics of the deformation space. Based on this conjecture, we extend GPA, a shape alignment algorithm based on the Euclidean measure, to the case with hidden (missing) variables by using the expectation-maximization (EM) algorithm, which will be called EM-GPA hereafter. In E-step of EM-GPA, the missing information is modeled as a Gaussian distribution, and in M-step of EM-GPA, the maximum likelihood (ML) solution of the parameters is obtained by using the distribution of hidden variables computed from E-step. During M-step, some constraints that reflect the characteristics of GPA are enforced to resolve the ambiguity. These constraints align shapes with respect to (w.r.t.) the Euclidean measure, which makes the parameters related to the rigid transforms less affected by the parameters related to deformation. We show experimentally that, without any rank constraint such as in [15–17], EM-GPA can find correct solutions even in the presence of noise. EM-GPA is not limited to the case of missing depth information, but it can be easily extended to more general cases.

Only with observed 2D facial shapes, EM-GPA can find scales, rotations, the mean and covariance matrix of 3D shapes, and consequently 3D shapes. The reconstructed depth information is sufficiently accurate as demonstrated in Section 5.1. The experimental results shows that EM-GPA performs excellently even for high noise and a large number of missing variables. In Section 5.2 and 5.3, we show that the mean and covariance matrix of 3D shapes obtained by EM-GPA can be used to build a 3D shape model instead of using those trained by a real 3D landmark data, which usually requires extra efforts to produce.

The rest of this paper is organized as follows. Section 2 introduces some background materials on GPA. In Section 3, we formulate the problem of performing GPA with hidden variables, and propose EM-GPA. Experimental results are shown in Section 5 and the paper is concluded in Section 6.

@&#BACKGROUND@&#

GPA is one of the most popular algorithms to align shapes to a common reference. Given a set of shapes 
                           
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    m
                                    ×
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              ,
                              i
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    s
                                 
                              
                           
                        , consisting of n
                        
                           p
                         landmarks 
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    m
                                 
                              
                              ,
                              j
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    p
                                 
                              
                           
                        , GPA superimposes the shapes to their mean shape 
                           
                              
                                 
                                    S
                                 
                                 
                                    ¯
                                 
                              
                           
                         by optimally translating, rotating and scaling [12,13]. If shapes are identical, the shapes adjusted though GPA coincide exactly. When all the shapes S
                        
                           i
                        ’s are translated to have the origin 
                           
                              
                                 
                                    [
                                    0
                                    ,
                                    …
                                    ,
                                    0
                                    ]
                                 
                                 
                                    T
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    m
                                 
                              
                           
                         as a common center, the problem can be formulated to minimize the shape differences from all shapes S
                        
                           i
                        ’s to the mean shape 
                           
                              
                                 
                                    S
                                 
                                 
                                    ¯
                                 
                              
                           
                         w.r.t. scales and rotations, i.e.,
                           
                              (1)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   arg min
                                                
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             ‖
                                             
                                                
                                                   ρ
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   R
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   S
                                                
                                                
                                                   ¯
                                                
                                             
                                             
                                                
                                                   ‖
                                                
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                             
                                             
                                                
                                                   R
                                                
                                                
                                                   i
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   R
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             I
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   ρ
                                                
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             ‖
                                             
                                                
                                                   S
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   ‖
                                                
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             1
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where R
                        
                           i
                         is an orthogonal matrix, ρ
                        
                           i
                         is a scale factor and 
                           
                              ‖
                              ·
                              ‖
                           
                        
                        
                           F
                         is the Frobenius norm [26], i.e., 
                           
                              ‖
                              A
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              =
                              tr
                              (
                              
                                 
                                    A
                                 
                                 
                                    T
                                 
                              
                              A
                              )
                           
                        . It is noted that the objective function has the minimum value when all ρ
                        
                           i
                        s and 
                           
                              
                                 
                                    S
                                 
                                 
                                    ¯
                                 
                              
                           
                         are zero, which is not a desired solution. We need the second constraint in (1) to avoid this trivial solution.

The procedure of GPA can be summarized as follows [12]:
                           
                              1.
                              All the shapes are moved to a common center, the origin 
                                    
                                       
                                          
                                             [
                                             0
                                             ,
                                             …
                                             ,
                                             0
                                             ]
                                          
                                          
                                             T
                                          
                                       
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             m
                                          
                                       
                                    
                                 .

Scale each S
                                 
                                    i
                                 , i
                                 =1,…,
                                 n
                                 
                                    s
                                 , by ζ so that
                                    
                                       
                                          ζ
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                             
                                          
                                          tr
                                          (
                                          
                                             
                                                S
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                S
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                          )
                                          =
                                          1
                                          .
                                       
                                    
                                 
                              

To initialize the mean shape, set 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ¯
                                          
                                       
                                       =
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                    
                                 . For i
                                 =2,3,…,
                                 n
                                 
                                    s
                                 , rotate S
                                 
                                    i
                                  to fit 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 , re-evaluate 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  as the mean of 
                                    
                                       (
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             S
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                       )
                                    
                                 . Evaluate initial residual sum-of-squares 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             r
                                          
                                       
                                       =
                                       
                                          
                                             n
                                          
                                          
                                             s
                                          
                                       
                                       (
                                       1
                                       -
                                       tr
                                       (
                                       
                                          
                                             
                                                
                                                   SS
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       )
                                       )
                                    
                                  and set ρ
                                 
                                    i
                                 
                                 =1,i
                                 =1,2,…,
                                 n
                                 
                                    s
                                 .

For i
                                 =1,2,…,
                                 n
                                 
                                    s
                                 , rotate the current shape S
                                 
                                    i
                                  to fit 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  giving 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                    
                                 . Here, 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             V
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             U
                                          
                                          
                                             i
                                          
                                          
                                             T
                                          
                                       
                                    
                                 , where U
                                 
                                    i
                                  and V
                                 
                                    i
                                  are obtained by the singular value decomposition of 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       =
                                       
                                          
                                             U
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             V
                                          
                                          
                                             i
                                          
                                          
                                             T
                                          
                                       
                                    
                                 . After setting 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       ⟵
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 , compute the mean shape 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 .

For i
                                 =1,2,…,
                                 n
                                 
                                    s
                                 , scale 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             ρ
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                    
                                 . Here, the scale factor ρ
                                 
                                    i
                                  is
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      tr
                                                      (
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      tr
                                                      (
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      )
                                                      tr
                                                      (
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 After setting 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       ←
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 , compute 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  and new residual sum-of-squares 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             r
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 .

If 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             r
                                          
                                       
                                       -
                                       
                                          
                                             S
                                          
                                          
                                             r
                                          
                                          
                                             ′
                                          
                                       
                                       >
                                       tolerance
                                    
                                 , set 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             r
                                          
                                       
                                       =
                                       
                                          
                                             S
                                          
                                          
                                             r
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  and go to step 4, otherwise the iteration stops.

Before formulating the problem addressed in this paper, we define notations used in this paper. We define the vectorization operator of 
                        vec(A), which transforms a matrix 
                           
                              A
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    ×
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                         into a vector as
                           
                              
                                 vec
                                 (
                                 A
                                 )
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                          
                                             T
                                          
                                       
                                       
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                          
                                             T
                                          
                                       
                                       
                                       …
                                       
                                       
                                          
                                             A
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       ]
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        where A
                        
                           i
                         is the ith column of A. The Frobenious norm can be expressed as 
                           
                              ‖
                              A
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              =
                              vec
                              
                                 
                                    (
                                    A
                                    )
                                 
                                 
                                    T
                                 
                              
                              vec
                              (
                              A
                              )
                           
                        .

Now, we explain the proposed algorithm that extends GPA to the case with hidden variables by using the EM algorithm. To make the explanation simple, we describe EM-GPA only for the case of missing depth information, but this algorithm can be easily extended to a more general case, where some of the landmarks are missing, as shown in Section 5.1. Given a set of shapes S
                        
                           i
                        , i
                        =1,2,…,
                        n
                        
                           s
                        , GPA finds scales ρ
                        
                           i
                         and rotations R
                        
                           i
                         that most closely map the shapes S
                        
                           i
                         to its mean 
                           
                              
                                 
                                    S
                                 
                                 
                                    ¯
                                 
                              
                           
                         
                        [12]. To express shapes including hidden variables, we define a shape S
                        
                           i
                         in 3D space, which consists of n
                        
                           p
                         landmarks, as
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       3
                                       ×
                                       
                                          
                                             n
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where each column of 
                           
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                    ×
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              =
                              (
                              
                                 
                                    h
                                 
                                 
                                    i
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    h
                                 
                                 
                                    
                                       
                                          in
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    1
                                    ×
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                           
                         correspond to the coordinates (x,
                        y)
                           T
                         and z, respectively. D
                        
                           i
                         and h
                        
                           i
                         are translated so that 
                           
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                              1
                              =
                              0
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              1
                              =
                              0
                              ∈
                              R
                           
                        , where 
                           
                              1
                              =
                              
                                 
                                    [
                                    1
                                    ,
                                    …
                                    ,
                                    1
                                    ]
                                 
                                 
                                    T
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                           
                        . When gathering position information on the landmarks from 2D images, D
                        
                           i
                         is observable whereas h
                        
                           i
                         is not. We name h
                        
                           i
                         as a hidden vector. Since shape deformation is not dramatic in many cases, such as for human face, we assume an aligned shape to be a Gaussian distribution, which can be expressed as
                           
                              (2)
                              
                                 p
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 Θ
                                 )
                                 ∝
                                 exp
                                 
                                    
                                       
                                          -
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          vec
                                          
                                             
                                                (
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                )
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                Σ
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          vec
                                          (
                                          
                                             
                                                ρ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                S
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                S
                                             
                                             
                                                ¯
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                        where Θ is a parameter set consisting of scale ρ
                        
                           i
                        , rotation R
                        
                           i
                        , 3D mean shape 
                           
                              
                                 
                                    S
                                 
                                 
                                    ¯
                                 
                              
                           
                        , and covariance matrix Σ. Note that all the shapes are aligned to have a common center at the origin, i.e., 
                           
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              1
                              =
                              0
                              
                              ∈
                              
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                           
                        . In this case, the covariance matrix (Σ) cannot be full rank. To deal with the singularity of the covariance matrix, we reformulate (2) as follows. Let 
                           
                              
                                 
                                    P
                                 
                                 
                                    N
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    [
                                    
                                       
                                          I
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          I
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          I
                                       
                                       
                                          3
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    3
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                    ×
                                    3
                                 
                              
                           
                         be the basis matrix corresponding to the translation and let 
                           
                              P
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    3
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                    ×
                                    3
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                    -
                                    1
                                    )
                                 
                              
                           
                         be an orthogonal matrix that satisfies P
                        
                           T
                        
                        P
                        
                           N
                        
                        =
                        0, then the reduced covariance matrix can be represented as 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    P
                                 
                                 
                                    T
                                 
                              
                              Σ
                              P
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    3
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                    -
                                    1
                                    )
                                    ×
                                    3
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                    -
                                    1
                                    )
                                 
                              
                           
                        . We redefine the parameter set as 
                           
                              Θ
                              =
                              {
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    S
                                 
                                 
                                    ¯
                                 
                              
                              ,
                              
                                 
                                    Σ
                                 
                                 
                                    ′
                                 
                              
                              }
                              ,
                           
                         
                        
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    s
                                 
                              
                           
                        . Then, the distribution of shapes (D
                        
                           i
                        , h
                        
                           i
                        ) becomes
                           
                              (3)
                              
                                 p
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 Θ
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             (
                                             2
                                             π
                                             )
                                          
                                          
                                             
                                                
                                                   3
                                                   (
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   -
                                                   1
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       |
                                       
                                          
                                             Σ
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          -
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                l
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                          P
                                          
                                             
                                                
                                                   
                                                      Σ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                P
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                l
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       Π
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       3
                                    
                                 
                                 δ
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                Nj
                                             
                                             
                                                T
                                             
                                          
                                          
                                          
                                             
                                                l
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    l
                                 
                                 
                                    i
                                 
                              
                              =
                              vec
                              (
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    [
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              -
                              
                                 
                                    S
                                 
                                 
                                    ¯
                                 
                              
                              )
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    3
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                           
                         which is the shape difference from the mean shape, and δ(·) is a delta function [27] and P
                        
                           Nj
                         is the jth column of P
                        
                           N
                        , i.e., P
                        
                           N
                        
                        =[P
                        
                           N1
                        
                        P
                        
                           N2
                        
                        P
                        
                           N3].

We find the parameters that maximize the log-likelihood of p(D
                        
                           i
                        ,
                        h
                        
                           i
                        ∣Θ) by using the EM algorithm under the assumption that all the shapes S
                        
                           i
                         are independent. In E-step, we estimate the distribution of hidden vector h
                        
                           i
                         in the form of p(h
                        
                           i
                        ∣D
                        
                           i
                        ,
                        Θ). Then, in M-step, the maximum likelihood (ML) solution of the parameters is obtained by using the distribution of hidden variables computed from E-step and additional constraints as follows.
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Θ
                                                
                                                
                                                   ∗
                                                
                                             
                                          
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   argmax
                                                
                                                
                                                   Θ
                                                
                                             
                                             
                                                
                                                   
                                                      ∏
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                             p
                                             (
                                             
                                                
                                                   D
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   h
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                             Θ
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   argmax
                                                
                                                
                                                   Θ
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                
                                             
                                             ∫
                                             ln
                                             (
                                             p
                                             (
                                             
                                                
                                                   D
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   h
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                             Θ
                                             )
                                             )
                                             p
                                             (
                                             
                                                
                                                   h
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                             
                                                
                                                   D
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   Θ
                                                
                                                
                                                   old
                                                
                                             
                                             )
                                             
                                                
                                                   dh
                                                
                                                
                                                   i
                                                   1
                                                
                                             
                                             ⋯
                                             
                                                
                                                   dh
                                                
                                                
                                                   
                                                      
                                                         in
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     R
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       D
                                                                                    
                                                                                    
                                                                                       i
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       h
                                                                                    
                                                                                    
                                                                                       i
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           S
                                                                        
                                                                        
                                                                           ¯
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     T
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             is positive semi-definite,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   E
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     ρ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          
                                                                                             
                                                                                                
                                                                                                   D
                                                                                                
                                                                                                
                                                                                                   i
                                                                                                
                                                                                             
                                                                                          
                                                                                       
                                                                                       
                                                                                          
                                                                                             
                                                                                                
                                                                                                   h
                                                                                                
                                                                                                
                                                                                                   i
                                                                                                
                                                                                             
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     F
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             =
                                             1
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The constraints in (4), which will be called the GPA constraints, force ρ
                        
                           i
                         and R
                        
                           i
                         to be determined in a manner that is analogous to GPA in (1). Note that the second constraint is equivalent to the second constraint in (1). The first constraint in (4), which is a rotation constraint, can be shown to be equivalent to the solution of the following optimization problem:
                           
                              
                                 
                                    
                                       arg min
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ρ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     R
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       D
                                                                                    
                                                                                    
                                                                                       i
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       h
                                                                                    
                                                                                    
                                                                                       i
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     S
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         F
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              [
                              ‖
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    [
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              -
                              
                                 
                                    S
                                 
                                 
                                    ¯
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              ]
                              =
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              [
                              ‖
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    [
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              ]
                              -
                              2
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              [
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    [
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              ]
                              +
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              [
                              ‖
                              
                                 
                                    S
                                 
                                 
                                    ¯
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              ]
                           
                        .

This is equivalent to maximizing 
                           
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              [
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    [
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              ]
                           
                        , and it can be readily proved that the optimal rotation makes 
                           
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              [
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    [
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              ]
                           
                         positive semi-definite [12]. In fact, the feasible rotation for the constant in (4) is unique when 
                           
                              
                                 
                                    [
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                           
                         is full rank, which is true in most of the cases. These constraints make the expectations of 3D shapes aligned w.r.t. the Euclidean measure, which is the core of GPA. These E-step and M-step constitute the parameter updating rule for Θ, which are executed iteratively until the parameters converge. In the next subsections, we explain E-step and M-step.

Here, we explain how to estimate the distribution of h
                        
                           i
                         in the kth step. From Bayes’ theorem, the distribution of h
                        
                           i
                         can be written as follows:
                           
                              (5)
                              
                                 p
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Θ
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       p
                                       (
                                       
                                          
                                             D
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             h
                                          
                                          
                                             i
                                          
                                       
                                       |
                                       
                                          
                                             Θ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    
                                       ∫
                                       p
                                       (
                                       
                                          
                                             D
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             h
                                          
                                          
                                             i
                                          
                                       
                                       |
                                       
                                          
                                             Θ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       
                                          
                                             dh
                                          
                                          
                                             i
                                             1
                                          
                                       
                                       ⋯
                                       
                                          
                                             dh
                                          
                                          
                                             
                                                
                                                   in
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Since we assumed that S
                        
                           i
                         is Gaussian, h
                        
                           i
                         is also Gaussian, which can be represented as
                           
                              (6)
                              
                                 p
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Θ
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ∝
                                 exp
                                 
                                    
                                       
                                          -
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          
                                             
                                                C
                                             
                                             
                                                i
                                             
                                             
                                                k
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                           
                         are the mean and covariance matrix of h
                        
                           i
                         conditioned on D
                        
                           i
                        , respectively. As for shapes S
                        
                           i
                         in (2), the hidden vector h
                        
                           i
                         should have origin at the center, i.e., h
                        
                           i
                         1=0 and its covariance matrix 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                           
                         becomes singular. To address the singularity of the covariance matrix of h
                        
                           i
                        , we reformulate (6) as follows. Let 
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          h
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    [
                                    1
                                    ,
                                    1
                                    ,
                                    …
                                    ,
                                    1
                                    ]
                                 
                                 
                                    T
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                           
                         be the basis vector for the translation of h
                        
                           i
                         and let 
                           
                              
                                 
                                    P
                                 
                                 
                                    h
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                    ×
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                    -
                                    1
                                    )
                                 
                              
                           
                         be an orthogonal matrix that satisfies 
                           
                              
                                 
                                    P
                                 
                                 
                                    h
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          h
                                       
                                    
                                 
                              
                              =
                              0
                           
                        , then 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                           
                         can be expressed as 
                           
                              
                                 
                                    P
                                 
                                 
                                    h
                                 
                              
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    h
                                 
                                 
                                    T
                                 
                              
                           
                         and the distribution of h
                        
                           i
                         can be represented as
                           
                              (7)
                              
                                 p
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Θ
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             (
                                             2
                                             π
                                             )
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   -
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          -
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                P
                                             
                                             
                                                h
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                P
                                             
                                             
                                                h
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                             
                                             
                                                kT
                                             
                                          
                                       
                                    
                                 
                                 δ
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                P
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      h
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                           
                        , which is the difference of h
                        
                           i
                         from its mean in the kth step. By comparing (3) and (7), we obtain the following proposition.
                           Proposition 1
                           
                              The mean 
                              
                                 
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                 
                               
                              and covariance matrix 
                              
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                 
                               
                              of 
                              h
                              
                                 i
                               
                              can be found from 
                              
                                 (3), (5), and (7)
                               
                              as
                              
                                 
                                    (8)
                                    
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   i
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Ψ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   P
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     Σ
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         Ψ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       
                                          
                                             ρ
                                          
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       vec
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   [
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         i
                                                         1
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         i
                                                         2
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ]
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       P
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             Ψ
                                          
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   i
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             h
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      i
                                                      1
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      i
                                                      2
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      i
                                                      3
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             Ψ
                                          
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      h
                                                   
                                                
                                                ⊗
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      i
                                                      3
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              where 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ij
                                       
                                       
                                          k
                                       
                                    
                                 
                               is the jth column of 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                 
                               and the symbol ⊗ denotes the Kronecker product [28].

See A.□

We will calculate (
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              ,
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                           
                        ) in M-step. From now on, we will omit the superscript (k
                        +1) if no confusion arises.

In this maximization step, the ML solution of parameters Θ is obtained by using the distribution of hidden variables computed from E-step. Let us denote Θ
                        
                           k
                         as the parameters in the kth iteration. Then by applying (3) and (7) to (4) with Θ
                        
                           old
                        
                        =
                        Θ
                        
                           k
                        , the objective function can be expressed as
                           
                              (9)
                              
                                 Q
                                 (
                                 
                                    
                                       Θ
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       Θ
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 =
                                 -
                                 
                                    
                                       n
                                    
                                    
                                       s
                                    
                                 
                                 ln
                                 |
                                 
                                    
                                       Σ
                                    
                                    
                                       ′
                                    
                                 
                                 |
                                 -
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 tr
                                 
                                    
                                       
                                          
                                             
                                                Ψ
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                          P
                                          
                                             
                                                
                                                   
                                                      Σ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                P
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                Ψ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 P
                                 
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ,s.t.
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           D
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           h
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 is positive semi-definite,
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       D
                                                                                    
                                                                                    
                                                                                       i
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       h
                                                                                    
                                                                                    
                                                                                       i
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         F
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 1
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          l
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              vec
                              (
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    [
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          kT
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              -
                              
                                 
                                    S
                                 
                                 
                                    ¯
                                 
                              
                              )
                           
                        , which is the expected value of l
                        
                           i
                         with respect to h
                        
                           i
                        . Finally, we can obtain the solution by maximizing the objective function (9) with respect to parameters Θ as follows.
                           Proposition 2
                           
                              If 
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ¯
                                       
                                    
                                    [
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          kT
                                       
                                    
                                    ]
                                 
                               
                              is not singular, the solution that maximizes Q(Θ
                              
                                 k+1
                              ∣Θ
                              
                                 k
                              
                              ) in 
                              
                                 (9)
                               
                              with respect to 
                              R
                              
                                 i
                               
                              is
                              
                                 
                                    (10)
                                    
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             U
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             V
                                          
                                          
                                             i
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                    
                                 
                              where U
                              
                                 i
                               and V
                              
                                 i
                               are obtained from the singular value decomposition of the matrix 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ¯
                                       
                                    
                                    [
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          kT
                                       
                                    
                                    ]
                                 
                              .

Note that 
                                 
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    [
                                    
                                       
                                          R
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          [
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                          
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                          ]
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                    ]
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          [
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                          ]
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          V
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          Γ
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                 
                              . In order for this expression to be positive semi-definite, R
                              
                                 i
                              
                              V
                              
                                 i
                               should be equal to U
                              
                                 i
                              , if Γ
                              
                                 i
                               is full rank. Hence 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          V
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                 
                              , which is the only feasible solution. □

In most cases, 
                           
                              
                                 
                                    S
                                 
                                 
                                    ¯
                                 
                              
                              [
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    kT
                                 
                              
                              ]
                           
                         is not singular. If Γ
                        
                           i
                         has zero diagonal entries, 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    MV
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                           
                         is also feasible, where M is a diagonal matrix whose diagonal elements are 1 for the entries that corresponds to non-zero Γ
                        
                           i
                         elements, and ±1 for the other diagonal entries. In this case, M is chosen so that the likelihood is maximized.
                           Proposition 3
                           
                              The solution that maximizes Q(Θ
                              
                                 k+1
                              ∣Θ
                              
                                 k
                              
                              ) in 
                              
                                 (9)
                               
                              with respect to ρ
                              
                                 i
                               
                              is the eigenvector of the smallest eigenvalue obtained from the following generalized eigenvalues problem:
                              
                                 
                                    (11)
                                    
                                       G
                                       ρ
                                       =
                                       λ
                                       F
                                       ρ
                                       s.t.
                                       
                                       
                                          
                                             ρ
                                          
                                          
                                             T
                                          
                                       
                                       F
                                       ρ
                                       =
                                       1
                                       ,
                                    
                                 
                              where
                                 
                                    (12)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   G
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           G
                                                                        
                                                                        
                                                                           ii
                                                                        
                                                                     
                                                                     =
                                                                     tr
                                                                     (
                                                                     
                                                                        
                                                                           Ψ
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           T
                                                                        
                                                                     
                                                                     P
                                                                     
                                                                        
                                                                           Σ
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ′
                                                                              
                                                                              
                                                                                 -
                                                                                 1
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           P
                                                                        
                                                                        
                                                                           T
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           Ψ
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           C
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ′
                                                                              
                                                                              
                                                                                 k
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     )
                                                                     +
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 1
                                                                                 -
                                                                                 
                                                                                    
                                                                                       1
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             n
                                                                                          
                                                                                          
                                                                                             s
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           T
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           q
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           T
                                                                        
                                                                     
                                                                     P
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 Σ
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           -
                                                                           1
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           P
                                                                        
                                                                        
                                                                           T
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           q
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           G
                                                                        
                                                                        
                                                                           ij
                                                                        
                                                                     
                                                                     =
                                                                     -
                                                                     
                                                                        
                                                                           1
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 n
                                                                              
                                                                              
                                                                                 s
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           q
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           T
                                                                        
                                                                     
                                                                     P
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 Σ
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           -
                                                                           1
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           P
                                                                        
                                                                        
                                                                           T
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           q
                                                                        
                                                                        
                                                                           j
                                                                        
                                                                     
                                                                     fori
                                                                     
                                                                     ≠
                                                                     
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   vec
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    D
                                                                                 
                                                                                 
                                                                                    i
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          h
                                                                                       
                                                                                       
                                                                                          ¯
                                                                                       
                                                                                    
                                                                                 
                                                                                 
                                                                                    i
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   F
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           F
                                                                        
                                                                        
                                                                           ii
                                                                        
                                                                     
                                                                     =
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          
                                                                                             
                                                                                                
                                                                                                   
                                                                                                      
                                                                                                         D
                                                                                                      
                                                                                                      
                                                                                                         i
                                                                                                      
                                                                                                   
                                                                                                
                                                                                             
                                                                                             
                                                                                                
                                                                                                   
                                                                                                      
                                                                                                         h
                                                                                                      
                                                                                                      
                                                                                                         ¯
                                                                                                      
                                                                                                   
                                                                                                
                                                                                             
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           F
                                                                        
                                                                        
                                                                           2
                                                                        
                                                                     
                                                                     +
                                                                     tr
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          C
                                                                                       
                                                                                       
                                                                                          i
                                                                                       
                                                                                       
                                                                                          ′
                                                                                       
                                                                                    
                                                                                 
                                                                                 
                                                                                    k
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           F
                                                                        
                                                                        
                                                                           ij
                                                                        
                                                                     
                                                                     =
                                                                     0
                                                                     
                                                                     for
                                                                     
                                                                     ≠
                                                                     
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

See B.□

Also the solution that maximizes Q(Θ
                        
                           k+1∣Θ
                        
                           k
                        ) in (9) with respect to 
                           
                              
                                 
                                    S
                                 
                                 
                                    ¯
                                 
                              
                           
                         and Σ is found by differentiating the objective function in (9) w.r.t. 
                           
                              
                                 
                                    S
                                 
                                 
                                    ¯
                                 
                              
                           
                         and Σ and equating them to zero, which are
                           
                              (13)
                              
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       Σ
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                Ψ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                Ψ
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                                 P
                                 .
                              
                           
                        
                     

These E-step and M-step constitute the parameter updating rule for Θ, which are executed iteratively until the parameters converge.

Here, we investigate the effect of the covariance matrix during the process of parameter update. The covariance matrix represents the modes for shape variations that is separated from rigid transforms. However, if the rotations and scales are not correct, then the covariance matrix derived from them will also be incorrect, and the separation between rigid transformation and non-rigid deformation may not be successful. Here, we want to obtain the covariance matrix that only includes deformation information of the Procrustes aligned 3D shapes, removing the effect of rotation and scale. However, since the EM framework is an iterative procedure, we have to align the shapes by using the rotations and scales estimated from the current step and calculate the covariance matrix using the misaligned shapes. Therefore, in early iteration steps, the covariance matrix is usually corrupted by incorrect information on rotations and scales, which may reduce the need to update the rotations and scales properly in the next steps. That is, in the process of maximizing the log-likelihood, the EM algorithm may adjust the covariance matrix too much and rotations and scales not properly. It makes EM-GPA fail to estimate the distribution of hidden vector correctly.


                        Fig. 1
                         shows the estimated 3D mean shape by EM-GPA with randomly selected initial parameters. We can see that the estimated mean shape is almost two dimensional. Since this is due to the incorrect estimation of the covariance matrix, which is corrupted by the information on rotations and scales, we need to obtain relatively accurate rotations and scales before estimating the covariance matrix. To do this, we introduce another EM algorithm for preprocessing, where we set the covariance matrix to diagonal with the same variance, i.e., 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    I
                                 
                                 
                                    3
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                    -
                                    1
                                    )
                                 
                              
                           
                        . Then (3) can be represented as
                           
                              (14)
                              
                                 p
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 Θ
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             (
                                             2
                                             π
                                             )
                                          
                                          
                                             
                                                
                                                   3
                                                   (
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   -
                                                   1
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             3
                                             (
                                             
                                                
                                                   n
                                                
                                                
                                                   p
                                                
                                             
                                             -
                                             1
                                             )
                                          
                                       
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          -
                                          
                                             
                                                1
                                             
                                             
                                                2
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                l
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                l
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       Π
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       3
                                    
                                 
                                 δ
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                Nj
                                             
                                             
                                                T
                                             
                                          
                                          
                                          
                                             
                                                l
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Although this formulation does not reflect the modes in shape variation, we can obtain approximate rotations and scales which minimize the Euclidean measure between all shapes and their mean shape (the Frobenius norm of the shape differences l
                        
                           i
                        ). Using this rotations and scales as initial parameters, we can perform EM-GPA more effectively. We call this procedure as the preprocessing stage and it is summarized as follows.
                           
                              •
                              E-step
                                    
                                       (15)
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                I
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      i
                                                      3
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          -
                                          
                                             
                                                ρ
                                             
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                          [
                                          
                                             
                                                R
                                             
                                             
                                                i
                                                1
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                R
                                             
                                             
                                                i
                                                2
                                             
                                             
                                                k
                                             
                                          
                                          ]
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          .
                                       
                                    
                                 
                              

M-step
                                    
                                       (16)
                                       
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                S
                                             
                                             
                                                ¯
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        h
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  kT
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                Γ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                          ,
                                          
                                             
                                                ρ
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               j
                                                               =
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  j
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                S
                                             
                                             
                                                ¯
                                             
                                          
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                ρ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        h
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                          σ
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                3
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      s
                                                   
                                                
                                                (
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                1
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   tr
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        C
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 where 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       tr
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   D
                                                
                                                
                                                   j
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   j
                                                
                                                
                                                   kT
                                                
                                             
                                             ]
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       )
                                    
                                  and 
                                    
                                       
                                          
                                             g
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       ‖
                                       
                                          
                                             [
                                             
                                                
                                                   D
                                                
                                                
                                                   j
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   j
                                                
                                                
                                                   kT
                                                
                                             
                                             ]
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             ‖
                                          
                                          
                                             F
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       tr
                                       (
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   j
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 .

We omit the derivation of this procedure, because the solution procedure for (14) is a special case of the procedure for (3). The preprocessing stage iterates until 
                           
                              ‖
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                              
                           
                         becomes less than a prespecified threshold. After convergence, we use the estimated rotation R
                        
                           i
                        , scale ρ
                        
                           i
                        , 3D mean shape 
                           
                              
                                 
                                    S
                                 
                                 
                                    ¯
                                 
                              
                           
                        , and reduced covariance matrix 
                           
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    I
                                 
                                 
                                    3
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                    -
                                    1
                                    )
                                 
                              
                           
                         as the initial parameters for EM-GPA.

For a similar reason as in Section 4.1, it is better to update the covariance matrix with a small update rate.
                           Proposition 4
                           
                              Let
                              
                                 
                                    (17)
                                    
                                       Z
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      Ψ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                   
                                                      Ψ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      T
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                          
                                       
                                       P
                                       ,
                                    
                                 
                              
                              then for any 
                              
                                 
                                    0
                                    ⩽
                                    α
                                    ⩽
                                    1
                                    ,
                                    
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    =
                                    α
                                    Z
                                    +
                                    (
                                    1
                                    -
                                    α
                                    )
                                    
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                 
                               
                              increases the log-likelihood of EM-GPA.
                           

See C.□

In the experiments in Section 5, α was set to 0.01. Fig. 2
                         shows an example of the objective function in (9) during the iterative process.

The EM-GPA algorithm is summarized in Algorithm 1.
                           Algorithm 1
                           EM-GPA
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: 2D shapes 
                                                   
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ∈
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            2
                                                            ×
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  p
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      i
                                                      =
                                                      1
                                                      ,
                                                      2
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Output: Reconstructed 3D shapes S
                                                
                                                   i
                                                , i
                                                =1,2,…,
                                                n
                                                
                                                   s
                                                
                                             
                                          
                                          
                                             
                                                A set of parameters for EM-GPA 
                                                   
                                                      Θ
                                                      =
                                                      {
                                                      R
                                                      ,
                                                      ρ
                                                      ,
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            Σ
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             1: 
                                                   
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  p
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            11
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      ,
                                                      i
                                                      =
                                                      1
                                                      ,
                                                      2
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                 (Translate to the origin).
                                          
                                          
                                             2: Initialize a set of parameters 
                                                   
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      =
                                                      {
                                                      R
                                                      ,
                                                      ρ
                                                      ,
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      ,
                                                      σ
                                                      }
                                                   
                                                 by using the method in Section 5.
                                          
                                          
                                             3: Set k to 1.
                                          
                                          
                                             4: repeat
                                             
                                          
                                          
                                             5: Calculate 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                 using (15).
                                          
                                          
                                             6: Calculate 
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                , and σ
                                                
                                                   k+1 using (16).
                                          
                                          
                                             7: Set k to k +1
                                          
                                          
                                             8: until convergence
                                          
                                          
                                             9: Set k to 1 and initialize Θ using Θ
                                                
                                                   p
                                                , where 
                                                   
                                                      
                                                         
                                                            Σ
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            3
                                                            (
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  p
                                                               
                                                            
                                                            -
                                                            1
                                                            )
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             10: repeat
                                             
                                          
                                          
                                             11: Calculate 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                 using (8).
                                          
                                          
                                             12: Calculate 
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                , and Σ
                                                ′
                                                
                                                   k+1 using Eqs. 10,11,13, 17.
                                          
                                          
                                             13: Set k to k +1
                                          
                                          
                                             14: until convergence
                                          
                                       
                                    
                                 
                              
                           

@&#EXPERIMENTS@&#

We perform three experiments to demonstrate the performance of EM-GPA. In the first experiment, we recovered 3D shapes from 2D landmark samples by using EM-GPA and compared it with the ground truth. Also, we show that EM-GPA can align 2D shapes by taking the missing information into consideration. In the second experiment, we estimated the mean and covariance matrix of 3D shapes and compared them to the ground truth. In the third experiment, we constructed a 2D+3D AAM [25,20] by using a 3D shape model obtained by EM-GPA and compared it with a 2D AAM [29] and another 2D+3D AAM where the 3D shape model was constructed using real 3D shapes.

We initialize the parameters of EM-GPA as follows. To initialize R
                     
                        i
                     , we first generated a 3×3 matrix R
                     
                        initial
                     , whose elements were pseudorandom numbers drawn from the standard normal distribution. Then, by the QR decomposition of R
                     
                        initial
                     , we obtained an orthogonal matrix R
                     
                        i
                     . We initialized the scales ρ
                     
                        i
                      as 
                        
                           
                              
                                 ρ
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 1
                              
                              
                                 ‖
                                 
                                    
                                       n
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                 
                              
                           
                        
                     , where missing (hidden) variables h
                     
                        i
                     ’s in S
                     
                        i
                      were set to zero. 
                        
                           
                              
                                 S
                              
                              
                                 ¯
                              
                           
                        
                      was calculated using ρ
                     
                        i
                      and R
                     
                        i
                      as 
                        
                           
                              
                                 S
                              
                              
                                 ¯
                              
                           
                           =
                           
                              
                                 1
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       s
                                    
                                 
                              
                           
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       s
                                    
                                 
                              
                           
                           
                              
                                 ρ
                              
                              
                                 i
                              
                           
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                        
                     . The preprocessing stage continues until 
                        
                           ‖
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           -
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 k
                              
                           
                           
                              
                                 ‖
                              
                              
                                 F
                              
                           
                        
                      becomes less than 10−5, and then the optimization process in EM-GPA iterates for 100 times.

We now describe the experiments of recovering 3D shapes from two face shape data, the motion capture data set [15,16]) and the Face Recognition Grand Challenge (FRGC) 2.0 database [30]. To recover 3D shapes, we used the expected value of hidden variables 
                           
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                         obtained from (8). As in [15], the reconstruction performance is evaluated by
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       ∣
                                       
                                          
                                             h
                                          
                                          
                                             ij
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ij
                                          
                                       
                                       |
                                    
                                    
                                       
                                          max
                                       
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             i
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                       -
                                       
                                          min
                                       
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             i
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                    
                                 
                                 .
                              
                           
                        
                     

In order to avoid the bias in the depth dimension, the centroid of each ground truth shape is set to the origin. Also to resolve reflection ambiguity, the same test was repeated for inverted shapes, and the rotation giving a smaller error was selected. We evaluated the performance of the algorithm under various noise and missing data. To generate noisy data, shape data were corrupted with the zero mean additive Gaussian noise with standard deviation σ
                        
                           noise
                        
                        =
                        βd
                        
                           max
                        /100 where β (0⩽
                        β
                        ⩽1) is the noise strength and d
                        
                           max
                         is defined as max
                           i,m,n
                        {∣D
                        
                           min
                        ∣} in pixels. We ran experiments for noise levels of up to 4%. To simulate the case of missing data, each landmark was randomly set to be missing with a probability γ,γ
                        =0,0.3,0.4,0.5. Each case was tested ten times and the results were averaged. We compared the proposed algorithm with the EM-PPCA method [15,16] and MP method [17]. Since these methods are not sensitive to the rank K of deformation space [15,16], which is a design parameter, we set K to 5 as in [17]. For EM-PPCA [15,16] and MP [17], we used the implementation provided by the authors.

For this experiment, we used the face shapes used in [15,16]. The face shape data were obtained from a Vicon optical motion capture system, with 40 markers attached to the subject’s face. The subject performed a range of facial expressions and dialogue and 2D shapes were generated for a sequence of 316 frames by orthographic projection. As shown in Figs. 3 and 4
                           
                           , EM-PPCA is sensitive to missing data, compared to the other algorithms. Here, we can confirm that EM-GPA performs best, and the reconstruction results of EM-GPA are very similar to the ground truth even for the case of 50% missing data corresponding to γ
                           =0.5.

Unlike the motion capture data set, we used a single sample for each subject from the FRGC data. In this case, the rank of deformation space is more than a few dozens because the 3D shapes have relatively larger variations, which may not satisfy the rank assumptions of EM-PPCA and MP. For the experiment, we generated arbitrary rotated 2D shapes as follows. From the FRGC database, we selected 400 subjects and manually located 62 landmarks in each subject to construct a set of 3D shapes 
                              
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                    
                                       ∗
                                    
                                 
                              
                            as shown in Figs. 5 and 5
                           . Note that the centroid of each 3D shape is moved to the origin. Then, we generated a set of 2D shapes D
                           
                              i
                            by randomly rotating the 3D shapes in the range of 
                              
                                 
                                    
                                       
                                          0
                                          ,
                                          
                                             
                                                π
                                             
                                             
                                                4
                                             
                                          
                                       
                                    
                                 
                              
                            and projecting them in the z direction as shown in Fig. 5.

We reconstructed 3D shapes from these 2D shapes using the three algorithms in the above and evaluated their performances. As can be seen in Fig. 6
                           , EM-GPA shows the best performance compared to EM-PPCA and MP. Since EM-GPA does not assume that the 3D shapes lie on a low-dimensional subspace unlike EM-PPCA and MP, it can be applied to a subject that has a larger shape variation.

We investigate how well EM-GPA aligns 2D shapes by taking the missing information into consideration. We calculated the error distances from the aligned 2D shapes 
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       aligned
                                       ,
                                       i
                                    
                                 
                              
                            by EM-GPA to the ground truth 
                              
                                 
                                    
                                       D
                                    
                                    
                                       aligned
                                       ,
                                       i
                                    
                                    
                                       ∗
                                    
                                 
                              
                           , which was obtained by performing GPA to real 3D shapes 
                              
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                    
                                       ∗
                                    
                                 
                              
                            and then projecting them in the z direction, i.e.,
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          aligned
                                          ,
                                          i
                                       
                                       
                                          ∗
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ×
                                    
                                       
                                          S
                                       
                                       
                                          aligned
                                          ,
                                          i
                                       
                                       
                                          ∗
                                       
                                    
                                    .
                                 
                              
                           The reconstructed 3D shape is represented as 
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             D
                                          
                                          
                                             i
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                          
                                             T
                                          
                                       
                                       ]
                                    
                                    
                                       T
                                    
                                 
                              
                            and it can be aligned as 
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       aligned
                                       ,
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                              
                           . However, since there is a rotation ambiguity between the estimated 3D mean shape 
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ¯
                                    
                                 
                              
                            and the ground truth 3D mean shape 
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                              
                           , we calculated a rotation R
                           
                              c
                            between them by using Procrustes analysis (PA) to superimpose these 3D mean shapes. To obtain the aligned 2D shapes 
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       aligned
                                       ,
                                       i
                                    
                                 
                              
                           , we rotated and projected 
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       aligned
                                       ,
                                       i
                                    
                                 
                              
                            in the z direction, i.e.,
                              
                                 
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          aligned
                                          ,
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ×
                                    
                                       
                                          R
                                       
                                       
                                          c
                                       
                                    
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          aligned
                                          ,
                                          i
                                       
                                    
                                    .
                                 
                              
                           Then, to evaluate alignment performance, we used the alignment error calculated as
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          aligned
                                          ,
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  ^
                                                               
                                                            
                                                         
                                                         
                                                            aligned
                                                            ,
                                                            i
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            aligned
                                                            ,
                                                            i
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                F
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            aligned
                                                            ,
                                                            i
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                F
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

As can be seen in Fig. 7
                           , the aligned 2D shape 
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       aligned
                                       ,
                                       i
                                    
                                 
                              
                            is very similar to the aligned ground truth 2D shape 
                              
                                 
                                    
                                       D
                                    
                                    
                                       aligned
                                       ,
                                       i
                                    
                                    
                                       ∗
                                    
                                 
                              
                           , and the alignment error e
                           
                              aligned
                            is 0.0572 on average. It demonstrates that EM-GPA can successfully align arbitrary rotated 2D shapes by taking the missing information into consideration.

Here, we check the validity of the estimated mean and covariance matrix. To do this, we obtained the ground truth 3D mean shape 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                           
                         and the covariance matrix Σ
                        ∗ of 
                           
                              vec
                              (
                              
                                 
                                    S
                                 
                                 
                                    aligned
                                    ,
                                    i
                                 
                                 
                                    ∗
                                 
                              
                              )
                           
                         by performing GPA on 3D shapes 
                           
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                                 
                                    ∗
                                 
                              
                           
                        ’s. Since there was a rotation ambiguity between the estimated 3D mean shape 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ¯
                                 
                              
                           
                         and the ground truth 3D mean shape 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                           
                        , we calculated a rotation R
                        
                           c
                         between them by using Procrustes analysis (PA) to superimpose these 3D mean shapes. The estimation error of 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ¯
                                 
                              
                           
                         with respect to 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ∗
                                       
                                    
                                 
                                 
                                    ¯
                                 
                              
                           
                         was calculated as
                           
                              (18)
                              
                                 e
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               ∗
                                                            
                                                         
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             F
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               ∗
                                                            
                                                         
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             F
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

As can be seen in Fig. 8
                        , the estimated 3D mean shape 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ¯
                                 
                              
                           
                         is very similar to the ground truth 3D mean shape 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                           
                        , and the estimation error e is 0.0052.

Also, we eliminated the rotation ambiguity between the estimated covariance matrix 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    ˆ
                                 
                              
                           
                         and the ground truth Σ
                        ∗ by 
                           
                              
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    c
                                 
                              
                              =
                              (
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              ⊗
                              
                                 
                                    R
                                 
                                 
                                    c
                                 
                              
                              )
                              
                                 
                                    Σ
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    ⊗
                                    
                                       
                                          R
                                       
                                       
                                          c
                                       
                                    
                                    )
                                 
                                 
                                    T
                                 
                              
                           
                        . The performance of the estimated covariance matrix 
                           
                              
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    c
                                 
                              
                           
                         was evaluated in terms of the canonical correlations, which are cosines of principal angles between two linear subspaces 
                           
                              
                                 
                                    L
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           
                         that are spanned by 
                           
                              
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    c
                                 
                              
                           
                        and Σ
                        ∗. The canonical correlation are defined for k
                        =1,…,n
                        
                           e
                        , i.e.,
                           
                              
                                 cos
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       u
                                       ∈
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       max
                                    
                                    
                                       v
                                       ∈
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 s.t.
                                 
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       k
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 1
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 k
                                 -
                                 1
                                 .
                              
                           
                        Here the vectors in 
                           
                              {
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          e
                                       
                                    
                                 
                              
                              }
                           
                         and 
                           
                              {
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          e
                                       
                                    
                                 
                              
                              }
                           
                         are the principle vectors constituting 
                           
                              
                                 
                                    L
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           
                         spaces, respectively. The canonical correlations show the proximity between the vectors that constitute the two linear subspaces. We used the singular value decomposition (SVD) to solve this problem [31]. We calculated canonical correlations between the two linear subspaces, which was consisted of the eigenvectors corresponding to the n
                        
                           e
                         largest eigenvalues in descending order. n
                        
                           e
                         was set to 114 to satisfy the relation 
                           
                              (
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          e
                                       
                                    
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              )
                              /
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    3
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              >
                              0.99
                           
                        , where λ
                        
                           i
                         is the eigenvalues of Σ. About 80% of the canonical correlations between the eigenvectors of 
                           
                              
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    c
                                 
                              
                           
                         and Σ
                        ∗ are bigger than 0.85. To see how close 
                           
                              
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    c
                                 
                              
                           
                         is to Σ
                        ∗, we also calculated another canonical correlations between the eigenvectors of two covariance matrices computed from the two sets of 200 real 3D shapes in the FRGC database. As can be seen in Fig. 9
                        , the canonical correlations computed from the covariance matrices of two real data sets show similar characteristics to the canonical correlation computed between those of EM-GPA and a real data set. From this result, we conclude that 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    ˆ
                                 
                              
                           
                         is a reasonable estimate of Σ
                        ∗.

Although AAM can be used to fit a 2D image of a 3D object, it is a difficult problem and becomes much more challenging when the 3D object undergoes a large rotation from the frontal position. This is because 2D AAM can generate model instances that are not possible in reality [25,20]. Xiao et al. [25,20] proposed 2D+3D AAM, which constrains the model parameters of 2D AAM based on a 3D shape model. To show how the virtual 3D shape model constructed by EM-GPA can be applied in AAM fitting, we constructed a 2D+3D AAM based on the virtual 3D shape model, and compared it to a 2D AAM [29] and a 2D+3D AAM based on a real 3D shape model.

To construct a 2D shape model, we used the PF07 database [32], which includes 100 male and 100 female subjects captured in 5 different poses. The pose variation consists of front, left, right, up, and down, and the angle between the frontal pose and the other poses is 22.5degr. We selected 200 images, one for each subject, allocating 40 images in each pose, and located 62 landmarks in each image. We also constructed two 3D shape models (virtual/real) based on the FRGC database. Each 2D+3D AAM was built by using four 2D shape basis vectors, 122 appearance basis vectors and three 3D shape basis vectors, which accounted for 85%,95% and 40% of their corresponding variations, respectively. In all the cases, each appearance image A(x) [29] used to construct an appearance model had a resolution of 40×40pixels for each of RGB, resulting in 
                           
                              A
                              (
                              x
                              )
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    4800
                                 
                              
                           
                        . We tested AAM fitting for 100 test images from the PF07 database, which were not used in training the three AAMs, and the number of faces in each pose was 20. Following [33], we used the 2D mean shapes as the initial shape, whose position was displaced from the ground-truth position by [−20,−10,0,10,20]pixels in the x direction. Because the 2D mean shape was 40 pixels wide and a face in the test images was about 160pixels wide on average, the 2D mean shape was scaled up by 4 times. The AAM fitting process stopped when the maximum shape displacement between two consecutive iterations was less than 0.5pixel. We define the average error of landmarks from their ground-truth positions as
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       landmark
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   j
                                                
                                             
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   j
                                                
                                                
                                                   ∗
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   j
                                                
                                             
                                             -
                                             
                                                
                                                   y
                                                
                                                
                                                   j
                                                
                                                
                                                   ∗
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where (x
                        
                           j
                        ,
                        y
                        
                           j
                        ) is the position of landmark j in the estimated shape, and 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                                 
                                    ∗
                                 
                              
                              )
                           
                         is the position of landmark j in the ground truth, which was obtained manually. Also, we computed the rate of successful convergence, which corresponds to the case of e
                        
                           landmark
                         less than 6pixels. Fig. 10
                         shows an example where the model fitting was successful for 2D+3D AAM/real_shape and 2D+3D AAM/virtual_shape, but not for 2D AAM. Table 1
                         shows the fitting performance of three AAMs. We can see that both of 2D+3D AAMs are about 17% better than the 2D AAM in the convergence rate. In Table 1, e
                        
                           landmark
                         was computed by using only the data of successful convergence cases. Table 2
                         shows the rate of successful convergence of the three algorithms for pose variations. We can see that the two 3D models show better convergence rate compared to 2D AAM regardless of pose variation, and the convergence rate of 2D+3D/virtual_shape is almost the same as that using the 2D+3D AAM/real_shape. This demonstrates that EM-GPA can construct an accurate 3D shape model, which can be applied in the algorithms that need a 3D shape model.

@&#CONCLUSION@&#

In this paper, we proposed EM-GPA, which is a novel way of performing GPA when some variables are hidden. EM-GPA combines GPA and the EM algorithm to estimate the scales, rotations and 3D shapes along with their mean and covariance matrix from multiple images. EM-GPA can accurately recover 3D shapes even when data are corrupted with noise and some of them are missing. Also, EM-GPA can align rotated 2D shapes successfully by taking the missing information into consideration. The virtual 3D shape model created by EM-GPA can be successfully applied to AAM. It is straightforward to apply EM-GPA to the geometric shapes whose dimension is greater three.

@&#ACKNOWLEDGMENT@&#

This research was supported by Basic Science Research Program through the National Research Foundation of Korea (NRF) funded by the Ministry of Education (NRF-2013R1A1A2009348).

To explain how to estimate the distribution of h
                     
                        i
                      in E-step, we use (3) and (7). From Bayes’ theorem, the distribution of h
                     
                        i
                      can be written as
                        
                           (A.1)
                           
                              p
                              (
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                              ,
                              Θ
                              )
                              =
                              
                                 
                                    p
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    Θ
                                    )
                                 
                                 
                                    ∫
                                    p
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    Θ
                                    )
                                    
                                       
                                          dh
                                       
                                       
                                          i
                                          1
                                       
                                    
                                    ⋯
                                    
                                       
                                          dh
                                       
                                       
                                          
                                             
                                                in
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                (
                                                2
                                                π
                                                )
                                             
                                             
                                                
                                                   
                                                      3
                                                      (
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      -
                                                      1
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          |
                                          
                                             
                                                Σ
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                |
                                             
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    exp
                                    
                                       
                                          
                                             -
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   l
                                                
                                                
                                                   i
                                                
                                                
                                                   T
                                                
                                             
                                             P
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   P
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   l
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          Π
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          3
                                       
                                    
                                    δ
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   Nj
                                                
                                                
                                                   T
                                                
                                             
                                             
                                             
                                                
                                                   l
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    ∫
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                (
                                                2
                                                π
                                                )
                                             
                                             
                                                
                                                   
                                                      3
                                                      (
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      -
                                                      1
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          |
                                          
                                             
                                                Σ
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                |
                                             
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    exp
                                    
                                       
                                          
                                             -
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   l
                                                
                                                
                                                   i
                                                
                                                
                                                   T
                                                
                                             
                                             P
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   P
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   l
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          Π
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          3
                                       
                                    
                                    δ
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   Nj
                                                
                                                
                                                   T
                                                
                                             
                                             
                                             
                                                
                                                   l
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          dh
                                       
                                       
                                          i
                                          1
                                       
                                    
                                    ⋯
                                    
                                       
                                          dh
                                       
                                       
                                          
                                             
                                                in
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     Since h
                     
                        i
                      is a Gaussian distribution, it can be represented as
                        
                           (A.2)
                           
                              p
                              (
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                              ,
                              Θ
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          (
                                          2
                                          π
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                1
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                              exp
                              
                                 
                                    
                                       -
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             h
                                          
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   i
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             h
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                              
                              δ
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   h
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                (
                                                2
                                                π
                                                )
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      -
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          |
                                          
                                             
                                                C
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                |
                                             
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    exp
                                    
                                       
                                          
                                             -
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   P
                                                
                                                
                                                   h
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   P
                                                
                                                
                                                   h
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                                
                                                   T
                                                
                                             
                                             +
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    δ
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   P
                                                
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    ∫
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                (
                                                2
                                                π
                                                )
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      -
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          |
                                          
                                             
                                                C
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                |
                                             
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    exp
                                    
                                       
                                          
                                             -
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   P
                                                
                                                
                                                   h
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   P
                                                
                                                
                                                   h
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                                
                                                   T
                                                
                                             
                                             +
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    δ
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   P
                                                
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          dh
                                       
                                       
                                          i
                                          1
                                       
                                    
                                    ⋯
                                    
                                       
                                          dh
                                       
                                       
                                          
                                             
                                                in
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  

An arbitrary constant t
                     
                        i
                      does not have any effect on p(h
                     
                        i
                     —D
                     
                        i
                     ,
                     Θ), because it is both on the numerator and denominator of the above equation. From (A.1) and (A.2), we can write
                        
                           (A.3)
                           
                              
                                 
                                    l
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                              P
                              
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    l
                                 
                                 
                                    i
                                 
                              
                              =
                              vec
                              
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                R
                                             
                                             
                                                i
                                                3
                                             
                                          
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              P
                              
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    T
                                 
                              
                              vec
                              
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             i
                                             3
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              +
                              2
                              vec
                              
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         i
                                                         1
                                                      
                                                   
                                                   
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         i
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                S
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              P
                              
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    T
                                 
                              
                              vec
                              
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             i
                                             3
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              +
                              vec
                              
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         i
                                                         1
                                                      
                                                   
                                                   
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         i
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                S
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              P
                              
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    T
                                 
                              
                              vec
                              
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      i
                                                      1
                                                   
                                                
                                                
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      i
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             D
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             S
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     and
                        
                           (A.4)
                           
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    h
                                 
                              
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    h
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                              +
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    h
                                 
                              
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    h
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                              -
                              2
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    h
                                 
                              
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    h
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    h
                                 
                              
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    h
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                              +
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              .
                           
                        
                     
                  

Comparing the first term in (A.3) and (A.4) and using the relation 
                        
                           vec
                           (
                           
                              
                                 R
                              
                              
                                 i
                                 3
                              
                           
                           
                              
                                 h
                              
                              
                                 i
                              
                           
                           )
                           =
                           (
                           
                              
                                 I
                              
                              
                                 3
                                 
                                    
                                       n
                                    
                                    
                                       p
                                    
                                 
                              
                           
                           ⊗
                           
                              
                                 R
                              
                              
                                 i
                                 3
                              
                           
                           )
                           
                              
                                 h
                              
                              
                                 i
                              
                              
                                 T
                              
                           
                        
                     and 
                        
                           (
                           
                              
                                 I
                              
                              
                                 3
                                 
                                    
                                       n
                                    
                                    
                                       p
                                    
                                 
                              
                           
                           ⊗
                           
                              
                                 R
                              
                              
                                 i
                                 3
                              
                           
                           )
                           
                              
                                 P
                              
                              
                                 h
                              
                           
                           =
                           (
                           
                              
                                 P
                              
                              
                                 h
                              
                           
                           ⊗
                           
                              
                                 R
                              
                              
                                 i
                                 3
                              
                           
                           )
                           =
                           
                              
                                 Ψ
                              
                              
                                 i
                              
                           
                        
                     , we can express 
                        
                           
                              
                                 C
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                        
                      as
                        
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                Ψ
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                          P
                                          
                                             
                                                
                                                   
                                                      Σ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                P
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                Ψ
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    -
                                    1
                                 
                              
                              .
                           
                        
                     
                  

Also, comparing the second term in (A.3) and (A.4), we can express 
                        
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 i
                              
                           
                        
                      as
                        
                           
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                              
                              vec
                              
                                 
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                ¯
                                             
                                          
                                          -
                                          
                                             
                                                ρ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         i
                                                         1
                                                      
                                                   
                                                   
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         i
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              P
                              
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    Ψ
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    h
                                 
                                 
                                    T
                                 
                              
                              .
                           
                        
                     
                  

To find the optimal 
                        
                           
                              
                                 ρ
                              
                              
                                 i
                              
                              
                                 ∗
                              
                           
                        
                     , we rewrite the objective function (9) as
                        
                           (B.1)
                           
                              Q
                              =
                              -
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                 
                              
                              
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              tr
                              
                                 
                                    
                                       
                                          
                                             Ψ
                                          
                                          
                                             i
                                          
                                          
                                             T
                                          
                                       
                                       P
                                       
                                          
                                             
                                                
                                                   Σ
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             Ψ
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          l
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                              P
                              
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          l
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              +
                              λ
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             ρ
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    D
                                                                                 
                                                                                 
                                                                                    i
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          h
                                                                                       
                                                                                       
                                                                                          ¯
                                                                                       
                                                                                    
                                                                                 
                                                                                 
                                                                                    i
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      F
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                tr
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       -
                                       1
                                    
                                 
                              
                              .
                           
                        
                     By substituting 13 to B.1, it becomes a generalized eigenvalue problem and ρ
                     ∗ corresponds to the eigenvector of the smallest eigenvalue in the following.
                        
                           (B.2)
                           
                              
                                 
                                    ρ
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    argmin
                                 
                                 
                                    ρ
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    T
                                 
                              
                              G
                              ρ
                              
                              s.t.
                              
                              
                                 
                                    ρ
                                 
                                 
                                    T
                                 
                              
                              F
                              ρ
                              =
                              1
                              ,
                           
                        
                     where G, Ψ
                     
                        i
                     , q
                     
                        i
                     , and F are given in (12). (B.2) gives (11).

To ensure that Σ
                     ′k+1
                     =
                     α
                     Z
                     + (1−
                     α)Σ′
                        k
                      does increase the log-likelihood, we have to verify that the Frobenius inner product of 
                        
                           
                              
                                 
                                    
                                       
                                          ∂
                                          Q
                                       
                                       
                                          ∂
                                          
                                             
                                                Σ
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∣
                                       
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          α
                                          Z
                                          +
                                          (
                                          1
                                          -
                                          α
                                          )
                                          
                                             
                                                
                                                   
                                                      Σ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    Z
                                    -
                                    
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           
                        
                      is positive for all 0⩽
                     α
                     ⩽1 (the inner product of the gradient and the direction to the optimal point from the current Σ′
                        k
                      should be positive.). Note that
                        
                           (C.1)
                           
                              tr
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         Q
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               Σ
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∣
                                                      
                                                      
                                                         
                                                            
                                                               Σ
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         =
                                                         α
                                                         Z
                                                         +
                                                         (
                                                         1
                                                         -
                                                         α
                                                         )
                                                         
                                                            
                                                               
                                                                  
                                                                     Σ
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                Z
                                                -
                                                
                                                   
                                                      
                                                         
                                                            Σ
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              tr
                              (
                              
                                 
                                    (
                                    Z
                                    -
                                    
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    T
                                 
                              
                              (
                              -
                              
                                 
                                    n
                                 
                                 
                                    s
                                 
                              
                              
                                 
                                    (
                                    α
                                    Z
                                    +
                                    (
                                    1
                                    -
                                    α
                                    )
                                    
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    -
                                    1
                                 
                              
                              +
                              
                                 
                                    (
                                    α
                                    Z
                                    +
                                    (
                                    1
                                    -
                                    α
                                    )
                                    
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    -
                                    1
                                 
                              
                              Z
                              
                                 
                                    (
                                    α
                                    Z
                                    +
                                    (
                                    1
                                    -
                                    α
                                    )
                                    
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    -
                                    1
                                 
                              
                              )
                              )
                              .
                           
                        
                     
                  

Let W be the generalized eigenvector matrix of Z and Σ
                     ′
                     
                        k
                      such that
                        
                           (C.2)
                           
                              
                                 
                                    W
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              W
                              =
                              I
                              ,
                              
                              
                                 
                                    W
                                 
                                 
                                    T
                                 
                              
                              ZW
                              =
                              Λ
                              .
                           
                        
                     Substituting (C.2) into (C.1), we can obtain
                        
                           
                              
                                 
                                    n
                                 
                                 
                                    s
                                 
                              
                              (
                              1
                              -
                              α
                              )
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                λ
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                n
                                             
                                             
                                                s
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          (
                                          α
                                          
                                             
                                                λ
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          (
                                          1
                                          -
                                          α
                                          )
                                          
                                             
                                                n
                                             
                                             
                                                s
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  

Since n
                     
                        s
                      (1−
                     α)⩾0 and 
                        
                           
                              
                                 ∑
                              
                              
                                 i
                              
                           
                           
                              
                                 
                                    
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             n
                                          
                                          
                                             s
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 
                                    
                                       (
                                       α
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       α
                                       )
                                       
                                          
                                             n
                                          
                                          
                                             s
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           ⩾
                           0
                        
                      for 0⩽
                     α
                     ⩽1, (C.1) is always positive for all 0⩽
                     α
                     ⩽1.

@&#REFERENCES@&#

