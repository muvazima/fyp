@&#MAIN-TITLE@&#A short identity-based proxy ring signature scheme from RSA

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The first short and efficient identity-based proxy ring signature scheme without bilinear pairings has been proposed.


                        
                        
                           
                           It is provably secure in the random oracle model under RSA assumption.


                        
                        
                           
                           It has a proper advantage in security reduction compared to those from RSA.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Identity-based proxy ring signature

Random oracle model

RSA assumption

@&#ABSTRACT@&#


               
               
                  Identity-based proxy ring signature concept was introduced by Cheng et al. in 2004. This primitive is useful where the privacy of proxy signers is required. In this paper, the first short provably secure identity-based proxy ring signature scheme from RSA assumption has been proposed. In addition, the security of the proposed scheme tightly reduces to the RSA assumption, and therefore, the proposed scheme has a proper advantage in security reduction compared to the ones from RSA. The proposed scheme not only outperforms the existing schemes in terms of efficiency and practicality, but also does not suffer from the proxy key exposure attack due to the use of the sequential aggregation paradigm.
               
            

@&#INTRODUCTION@&#

The notion of proxy signatures was introduced by Mambo et al. [1] in 1996. In a proxy signature scheme, an original signer delegates her signing right for signing messages to a proxy signer. This kind of signature supports ensuring service availability for the customers in distributed networks to avoid the dependency to a single server. Since the introduction of the notion of proxy signatures, several variants of proxy signatures such as proxy signatures from RSA and integer factorization problem [2–7], designated-verifier proxy signatures [8–10], short proxy signature [11], proxy verifiably encrypted signatures [12], proxy signature schemes without random oracles [13] and proxy ring signatures [14–18] have been proposed.

In a proxy ring signature scheme, an original signer delegates her signing right for signing messages to a group of proxy signers with different public keys, called the proxy agent, such that they can generate proxy ring signatures on behalf of the original signer while he could be anonymous. This type of signature not only supports ensuring service availability for the customers in distributed networks to avoid the dependency to a single server but also supports preserving privacy of proxy signers. As mentioned in [14–16], this primitive can be used when the requirement of proxy signer's privacy protection is necessary. For example, it is assumed that a parliament member would like to reveal an important news on behalf of the cabinet, while he wants to be anonymous. The other practical motivation for this primitive is electronic voting protocols, where just eligible voters anonymously can cast their ballots after authenticating themselves. The voting authority (an original signer) in the voting protocol authenticates eligible voters and issues certificates (generates valid delegations) for them. Voters (proxy signers) anonymously cast their ballots (generates proxy ring signatures). On the one hand, employing identity-based proxy signatures violates the most important property of voting protocols, voter privacy. Additionally, employing blind signatures in voting protocols enables the malicious voting authority to cast its ballot instead of abstained voters, and so violates accuracy of the election. Proxy ring signatures incorporate three requirements (privacy of voters, authentication and accuracy) at the same time. We should highlight that some access control mechanisms are necessary in the voting protocol to provide uniqueness property. Indeed, this primitive is a solution to the problem of electronic voting protocols based on blind signatures in which a malicious voting authority can vote instead of abstained voters.

To facilitate public key certificate management of proxy ring signatures, Cheng et al. for the first time presented an identity-based proxy ring signature [19] in which signers' identities are used instead of their public keys and certificates. Subsequently, there have been some follow-up works for identity-based proxy ring signatures [20–26], but unfortunately, none of them supports provable security, and also all of them are designed based on bilinear paring. In 2014, Asaar et al. [27] presented the first formal definition and security model for identity-based proxy ring signature schemes, and also proposed the first provably secure identity-based proxy ring signature scheme without incorporating bilinear pairings, and showed that it is secure under RSA assumption in the random oracle model. Since breaking the unforgeability of the scheme with high probability leads to solving the RSA problem with too small probability, the security reduction is loose. Therefore, the guarantee on the signature scheme can be quite weak.

In addition, previous identity-based proxy ring signature schemes proposed in [20–22,19,23–26] are vulnerable to the proxy key exposure attack [28] presented by Schuldt et al. in 2008. In fact, in previous schemes, if temporal secret keys of proxy signers are leaked, their long term secret keys will be compromised.

In this paper, we present the first short identity-based proxy ring signature scheme from RSA. The proposed scheme is proved secure under the RSA assumption, a widely accepted assumption, in the random oracle model. The advantages of the proposed scheme are threefold. First, it is the shortest identity-based proxy ring signature scheme without bilinear pairings. Second, it has a proper advantage in security reduction since a reduction of the proposed scheme is independent of the number of members in a proxy ring. Third, it is as efficient as or more efficient than the existing identity-based proxy ring signature schemes. Furthermore, the proxy key exposure attack [28] cannot be applied to our scheme since the paradigm used in designing this primitive is sequential aggregation of an identity-based signature and an identity-based ring signature scheme.

One may think that it is possible to build short and efficient identity-based proxy ring signature schemes without bilinear pairings from the idea of concatenated Schnorr signatures [29]. We should emphasize that if we use this idea in designing this primitive, the result scheme is no longer identity-based since public keys according this idea are not just identities of signers, and in this primitive, each proxy signer needs to interact before signature generation to attain proxy signers' public keys, and cannot easily use identities of other proxy signers to generate an identity-based proxy ring signature.

The rest of this paper is organized as follows. Section 2 presents notations and RSA complexity assumption employed as the signature foundation. The security model of identity-based proxy ring signature including outline of the identity-based proxy signature scheme and its security properties are given in Section 2. The proposed scheme and its formal security proofs are presented in Section 3. Section 4 presents the comparison and discussion. Conclusion and future work are given in Section 5.

@&#BACKGROUND@&#

In this section, first we give notations used throughout the paper and review the RSA assumption, and then we present the outline and security definitions for the identity-based proxy ring signature schemes [27].

If X is a set, then 
                           x
                           
                              ←
                              $
                           
                           X
                         denotes the operation of assigning to x an element of X chosen uniformly at random. If x
                        1, x
                        2,… are objects then x
                        1||x
                        2||… denotes an encoding of them as strings from which the constituent objects are effectively recoverable. Let ⊥ be an empty string, |x| be the bit length of x, and θ
                        ←
                        C(x
                        1,…) stands for the operation of assigning the output of the algorithm C on inputs x
                        1, … to θ. Let A be an algorithm which has access to H, K, KeyExtract, DelegationGen and ProxyRingSign oracles of a signature scheme, and can win a game in which a security property of the scheme is violated by A. If algorithm A is (t, qh
                        , qk
                        , qe
                        , qd
                        , qprs
                        , ϵ)-bounded, we mean that the algorithm A which runs in time at most t, makes at most qh
                         queries to random oracle H, qk
                         queries to random oracle K, qe
                         queries to KeyExtract oracle, qd
                         queries to DelegationGen and qprs
                         queries to ProxyRingSign oracle can win the game with probability at least ϵ.

An RSA key generator KGrsa
                         is an algorithm that generates triplets (N, e, d) such that N is the product of two large primes p and q and ed
                        =1 mod φ(N), where φ(N)=(p–1)(q–1). The advantage of an algorithm B in breaking the one-wayness of RSA related to KGrsa
                         is defined as
                           
                              (1)
                              
                                 Ad
                                 
                                    v
                                    
                                       K
                                       
                                          G
                                          
                                             r
                                             s
                                             a
                                          
                                       
                                    
                                    
                                       o
                                       w
                                       −
                                       r
                                       s
                                       a
                                    
                                 
                                 
                                    B
                                 
                                 =
                                 Pr
                                 
                                    
                                       
                                          
                                             
                                                N
                                                e
                                                d
                                             
                                             
                                                ←
                                                $
                                             
                                             K
                                             
                                                G
                                                
                                                   r
                                                   s
                                                   a
                                                
                                             
                                             ;
                                             γ
                                             
                                                ←
                                                $
                                             
                                             
                                                ℤ
                                                N
                                             
                                             ;
                                          
                                       
                                       
                                          
                                             y
                                             =
                                             
                                                γ
                                                e
                                             
                                             mod
                                             N
                                             :
                                          
                                       
                                       
                                          
                                             γ
                                             ←
                                             B
                                             
                                                N
                                                e
                                                y
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

We say that B, (t', ϵ')-breaks the one-wayness of RSA with respect to KGrsa
                         if it runs in time at most t' and has advantage 
                           Ad
                           
                              v
                              
                                 K
                                 
                                    G
                                    
                                       r
                                       s
                                       a
                                    
                                 
                              
                              
                                 o
                                 w
                                 −
                                 r
                                 s
                                 a
                              
                           
                           
                              B
                           
                           ≥
                           
                              ϵ
                              ′
                           
                        . We say that the RSA function associated to KGrsa
                         is (t', ϵ')-one-way if there is no algorithm B that can (t', ϵ')-break it.

Let the identity of each original signer be presented by ID
                        0, and identity set of a proxy agent and each subset of that be denoted by ID and 
                           
                              ID
                              ˜
                           
                        , respectively. An identity-based proxy ring signature scheme consists of six algorithms: Setup, KeyExtract, DelegationGen, DelegationVer, ProxyRingSign and ProxyRingVer as follows [27].
                           
                              -
                              Setup: The input of this algorithm is the system security parameter l and its outputs are the system's parameters Para and the system's master key (msk, mpk), i.e. (Para, (msk, mpk))←
                                 ParaGen (l).

KeyExtract: The inputs of this algorithm are Para, mpk, msk, and an identity IDu
                                 , and its output is the corresponding secret key xu
                                  for the identity IDu
                                 , i.e. xu
                                 
                                 ←
                                 KeyExtract (Para, mpk, msk, IDu
                                 ).

DelegationGen: This algorithm is employed if an original signer with the identity IDo
                                  would like to delegate its signing right to a proxy agent with the identity set ID. The inputs of this algorithm are Para, mpk, IDo
                                  and ID the original signer's secret key xo
                                 , and a message space descriptor w
                                 ⊆{0, 1}⁎, and its output is a delegation σo
                                 , i.e. σo
                                 
                                 ←
                                 DelegationGen (Para, mpk, IDo
                                 , ID, w, xo
                                 ).

DelegationVer: The inputs of this algorithm are Para, IDo
                                 , ID, w and σo
                                 , and its output is 1 if σo
                                  is a valid delegation and is 0 otherwise, i.e. {0, 1}←
                                 DelegationVer (Para, mpk, IDo
                                 , ID, w, σo
                                 ).

ProxyRingSign: The inputs of this algorithm are Para, mpk, the identity set 
                                    
                                       ID
                                       ˜
                                    
                                  of proxy signers including at least two identities, a valid delegation σo
                                  for w and ID such that 
                                    
                                       ID
                                       ˜
                                    
                                    ⊆
                                    ID
                                 , a proxy signer's secret key xj
                                  corresponding to an identity 
                                    I
                                    
                                       D
                                       j
                                    
                                    
                                       ←
                                       $
                                    
                                    
                                       ID
                                       ˜
                                    
                                    ⊆
                                    ID
                                  and a message m ϵ w. Its output is an identity-based proxy ring signature θ, i.e. θ
                                 ←
                                 ProxyRingSign(Para, mpk, IDo
                                 , ID, 
                                    
                                       ID
                                       ˜
                                    
                                 , (m, w, σo
                                 ), xj
                                 ).

ProxyRingVer: The inputs of this algorithm are Para, IDo
                                 , ID, 
                                    
                                       ID
                                       ˜
                                    
                                 , w, m and θ, and its output is 1 if θ is a valid identity-based proxy ring signature and is 0 otherwise, i.e. {0,1}←
                                 ProzyRingVer(Para, mpk. IDo
                                 , ID, 
                                    
                                       ID
                                       ˜
                                    
                                 , w, m, θ).

An identity-based proxy ring signature must satisfy two independent notions of security: unforgeability and privacy of proxy signer' identity. To achieve existential unforgeability against adaptive chosen message (chosen warrant: chosen message space descriptor and identity set of proxy signers) and chosen identity attack for identity-based proxy ring signature schemes, three types of potential adversaries as mentioned in [14] are considered. Type I adversaries, AI
                        , that only have identities of the original signer and proxy signers, Type II adversaries, AII
                        , that have secret keys of some (one/all) proxy signers in a proxy group in addition to the capabilities of AI
                        , and Type III adversaries that have the secret key of the original signer in addition to the capabilities of AI
                        . All types of adversaries aim to forge a valid identity-based proxy ring signature w.r.t. identities of the original signer and proxy signers.

Clearly, if an identity-based proxy ring signature scheme is secure against Type II (or Type III) adversaries then it is also secure against Type I adversary. Unforgeability against Type I, Type II and Type III adversaries (AI
                        , AII
                         and AIII
                        ) is formalized using the following game between a challenger C and an adversary A.
                           
                              1.
                              Setup: The challenger C runs the ParaGen algorithm with a security parameter l to obtain system's parameter para and the master key (mpk, msk), then it sends (mpk, para) to A.


                                 A issues a polynomially bounded number of queries to the following oracles adaptively:

KeyExtract queries: A can ask for the secret key corresponding to each identity IDu
                                 , then C returns the private key xu
                                  to the adversary with running the KeyExtract algorithm.

DelegationGen queries: Adversary A can request a delegation under the identity IDo
                                  of an original signer on a message space descriptor w and an identity set ID of its choice for which the original signer with identity IDo
                                  delegates its signing right on w to a proxy agent with identity set ID. In response, C runs the KeyExtract algorithm to obtain the secret key xo
                                  of the original signer, and returns σo
                                 
                                 ←
                                 DelegationGen(Para, mpk, IDo, 
                                 ID
                                 , w, xo
                                 ) to A.

ProxyRingSign queries: Adversary A can request the proxy ring signature of m w.r.t. 
                                    
                                       ID
                                       ˜
                                    
                                  to C.

In addition, adversary A provides a delegation σo
                                  of an original signer with identity IDo
                                  for a message space descriptor w and an identity set ID of proxy signers. This delegation was obtained from DelegationGen algorithm or was generated by adversary A.

Algorithm C checks that σo
                                  is a valid delegation in which the original signer with identity IDo
                                  delegates its signing right for the message space descriptor w to the proxy agent with identity set ID; that 
                                    
                                       ID
                                       ˜
                                    
                                    ⊆
                                    ID
                                 ; and that m ϵ w. If any of these fails to hold, returns ⊥. Otherwise, C runs the KeyExtract algorithm to obtain the secret key xj
                                  corresponding to one of the proxy signers with identity IDj
                                  such that 
                                    I
                                    
                                       D
                                       j
                                    
                                    
                                       ←
                                       $
                                    
                                    
                                       ID
                                       ˜
                                    
                                 . Next, C runs ProxyRingSign algorithm θ
                                 ←
                                 ProxyRingSign(Para, mpk, IDo
                                 , ID, 
                                    
                                       ID
                                       ˜
                                    
                                 , (m, w, σo
                                 ), xj
                                 ) to generate the proxy ring signature θ and returns it to the adversary A.

Finally, A outputs a valid identity-based proxy ring signature (m*,
                                 w*,
                                 θ*) w.r.t. original signer's identity IDo
                                 
                                 ⁎ and proxy signers' identity sets ID
                                 ⁎ and 
                                    
                                       
                                          I
                                          
                                             D
                                             *
                                          
                                       
                                       ˜
                                    
                                    ⊆
                                    I
                                    
                                       D
                                       *
                                    
                                    \
                                    
                                       
                                          I
                                          
                                             D
                                             *
                                          
                                       
                                       ^
                                    
                                 , where 
                                    
                                       ID
                                       ^
                                    
                                  is the set of corrupted proxy signers, and wins the game if the following conditions hold.

For A
                                 =
                                 AI
                                 :
                                    
                                       -
                                       
                                          E
                                          0: IDo
                                          
                                          ⁎ and all identities in 
                                             
                                                
                                                   I
                                                   
                                                      D
                                                      *
                                                   
                                                
                                                ˜
                                             
                                           have not been requested to the KeyExtract oracle which means that AI
                                           does not have secret keys corresponding to them.


                                          E
                                          1: The pair (w*,
                                          ID*) has not been requested as one of the DelegationGen queries under the identity IDo
                                          
                                          ⁎.


                                          E
                                          2: m
                                          ⁎ has not been requested as one of the ProxyRingSign queries under the identity set 
                                             
                                                
                                                   I
                                                   
                                                      D
                                                      *
                                                   
                                                
                                                ˜
                                             
                                          .

The formal definition of existential unforgeability against adversary AI
                         
                        [27] is expressed in Definition 1.
                           Definition 1
                           An identity-based proxy ring signature is (t, qh, qe, qd, qprs, ϵ) existentially unforgeable against adaptive chosen message (warrant) and chosen identity attack if there is no (t, qh, qe, qd, qprs, ϵ)-bounded adversary A which wins the aforementioned game.

For A
                        =
                        AII
                        :
                           
                              -
                              
                                 E
                                 0: IDo
                                 
                                 ⁎ has not been requested as one of the KeyExtract queries.


                                 E
                                 1: The pair (w*,
                                 ID*) has not been requested as one of the DelegationGen queries under the identity IDo
                                 
                                 ⁎.

The formal definition of existential unforgeability against adversary AII
                         
                        [27] is expressed in Definition 2.
                           Definition 2
                           An identity-based proxy ring signature is (t, qh, qe, qd, ϵ)-existentially unforgeable against adaptive chosen message (warrant) and chosen identity attack if there is no (t, qh, qe, qd, ϵ)-bounded adversary A which wins the aforementioned game.

For A=AIII
                        :
                           
                              -
                              
                                 E
                                 0: Each identity in 
                                    
                                       
                                          I
                                          
                                             D
                                             *
                                          
                                       
                                       ˜
                                    
                                  has not been requested as one of the KeyExtract queries.


                                 E
                                 1: m
                                 ⁎ has not been requested as one of the ProxyRingSign queries under identity set 
                                    
                                       
                                          I
                                          
                                             D
                                             *
                                          
                                       
                                       ˜
                                    
                                    ⊆
                                    I
                                    
                                       D
                                       *
                                    
                                 .

The formal definition of existential unforgeability against adversary AIII
                         
                        [27] is expressed in Definition 3.
                           Definition 3
                           An identity-based proxy ring signature is (t, qh, qe, qprs, ϵ)-existentially unforgeable against adaptive chosen message (warrant) and chosen identity attack if there is no (t, qh, qe, qprs, ϵ)-bounded adversary A which wins the aforementioned game.

Privacy of proxy signer's identity (PPSI) in an identity-based proxy ring signature means that it should be infeasible for any probabilistic polynomial time (PPT) distinguisher D to tell which proxy signer in a proxy group generates θ on a message m. To have a formal definition for this property consider the following game between a challenger C and a distinguisher D.
                           
                              1.
                              Setup: The challenger C runs the ParaGen algorithm with a security parameter l to obtain system's parameter para and the master key (mpk, msk), then it sends (mpk, para) to D.

The distinguisher D makes KeyExtract, DelegationGen and ProxyRingSign queries adaptively as explained in the forgery game.

The distinguisher D chooses two honest identities ID
                                 0 and ID
                                 1 (D never make KeyExtract query for these two identities), and makes a DelegationGen and ProxyRingSign query on (w, ID) under an identity ID
                                 0 and on the message m ϵ w under the identity set 
                                    
                                       ID
                                       ˜
                                    
                                    =
                                    
                                       
                                          I
                                          
                                             D
                                             0
                                          
                                          ,
                                          I
                                          
                                             D
                                             1
                                          
                                       
                                    
                                    ⊆
                                    ID
                                 , respectively. In response, C chooses 
                                    j
                                    
                                       ←
                                       $
                                    
                                    
                                       0
                                       1
                                    
                                 , runs DelegationGen on (w, ID) under the identity ID
                                 0 to obtain σo
                                 , next, runs ProxyRingSign on 
                                    
                                       
                                          ID
                                          ˜
                                       
                                       m
                                    
                                  to attain θ, and then returns θ to D.

Finally, the distinguisher D outputs j' and wins the game if j'=j'.

The formal definition for privacy of proxy signer's identity [27] is given in Definition 4.
                           Definition 4
                           Privacy of the proxy signer's identity


                           An identity-based proxy ring signature scheme is (t,qh
                              ,qe
                              ,qd
                              ,qprs ϵ+½)-PPSI-secure if there is no (t,qh
                              ,qe
                              ,qd
                              ,qprs ϵ+½)-bounded adversary D which can win the aforementioned game.

If the probability is equal to ½, the scheme satisfies privacy of the proxy signer's identity perfectly.

In this section, we present an identity-based proxy ring signature scheme using sequential aggregation of GQ identity-based signature [30] and the identity-based ring signature scheme [31]. Our scheme generates an identity-based proxy ring signature scheme in a way that a delegation is original signer's GQ identity-based signature on a message space descriptor and proxy signers' identities concatenated with 11, and a proxy ring signature is sequential aggregation of a delegation and a ring signature generated by one of the proxy signers on a message, belonged to the message space descriptor concatenated with 11. Indeed, concatenation with 11 prevents trivial attacks as suggested by Boldyreva et al. [32].

In this section, we present the details of our scheme. When describing the signature scheme, let the identity of each original signer be IDo
                        , and identity set of each proxy agent and each subset of that be ID and 
                           
                              ID
                              ˜
                           
                        , respectively.

It is assumed that n
                        ≥2 and z
                        ≥2 are the number of identities for proxy signers in the proxy agent and the size of each subset 
                           
                              ID
                              ˜
                           
                         of ID, respectively. Our scheme consists of Setup, KeyExtract, DelegationGen, DelegationVer, ProxyRingSign and ProxyRingVer algorithms as described below.
                           
                              1.
                              Setup: The system parameters are as follows. Let l
                                 0, l
                                 1 and l
                                 N 
                                 ϵ ℕ, and let K
                                 0:{0,1}⁎
                                 →{0,1}
                                    l0, K
                                 0:{0,1}⁎
                                 →{0,1}
                                    l1, and H
                                 :{0,1}*→ℤ
                                    N
                                 
                                 ⁎ be random oracles. Let KGrsa
                                  be a RSA key pair generator that outputs triplets (N, e, d) such that φ(N)>2
                                    ln
                                  and with prime encryption exponents e of length strictly greater than l
                                 0 and l
                                 1 bits. The key distribution center runs KGrsa
                                  to generate RSA parameters (N, e, d). It publishes mpk
                                 =(N, e) as the master public key, and keeps the master secret key msk
                                 =
                                 d secret. Therefore, public parameters are Para
                                 ={K
                                 0, K
                                 1, H} and mpk.

KeyExtract: On input master secret key msk
                                 =
                                 d and the user identity IDu
                                 , the key distribution center computes xu
                                 
                                 =
                                 H(IDu
                                 )
                                    d
                                  mod N, and sends the user secret key xu
                                  over a secure and authenticated channel to the user with identity IDu
                                 .

DelegationGen: Let w be a message space descriptor for which an original signer with identity IDo
                                  would like to delegate her signing right to a group of proxy signers with an identity set ID, the delegation is 
                                    
                                       σ
                                       
                                          o
                                          =
                                       
                                    
                                    
                                       
                                          R
                                          o
                                       
                                       
                                          s
                                          o
                                       
                                    
                                    =
                                    
                                       
                                          
                                             r
                                             o
                                             e
                                          
                                          mod
                                          N
                                          ,
                                          
                                             r
                                             o
                                          
                                          
                                             x
                                             o
                                             
                                                c
                                                o
                                             
                                          
                                          mod
                                          N
                                       
                                    
                                 , where 
                                    
                                       r
                                       o
                                    
                                    
                                       ←
                                       $
                                    
                                    
                                       ℤ
                                       N
                                       *
                                    
                                  and c
                                 
                                    o
                                 
                                 =
                                 K
                                 
                                    o
                                 (R
                                 
                                    o
                                 ‖w‖ID‖11). Then, the original signer publishes the delegation σo
                                  on (w, ID).

DelegationVer: Given the identity IDo
                                  of an original signer and identity set ID of the proxy signers, a message space descriptor w and a delegation σo
                                 , a verifier checks if the relation 
                                    
                                       s
                                       o
                                       e
                                    
                                    =
                                    
                                       R
                                       o
                                    
                                    H
                                    
                                       
                                          
                                             I
                                             
                                                D
                                                o
                                             
                                          
                                       
                                       
                                          c
                                          o
                                       
                                    
                                  holds, where c
                                 
                                    o
                                 
                                 =
                                 K
                                 
                                    o
                                 (R
                                 
                                    o
                                 ‖w‖ID‖11). If so, the delegation is valid; otherwise, it is not valid.

ProxyRingSign: A proxy signer with identity 
                                    I
                                    
                                       D
                                       j
                                    
                                    
                                       ←
                                       $
                                    
                                    
                                       ID
                                       ˜
                                    
                                    ⊆
                                    ID
                                    
                                       
                                          j
                                          ∈
                                          
                                             
                                                0
                                                ,
                                                …
                                                ,
                                                z
                                                −
                                                a
                                             
                                          
                                       
                                    
                                  can sign a message m ϵ w anonymously on behalf of the original signer with the identity IDo
                                  with his secret key xj
                                  and a valid delegation σo
                                  as follows.
                                    
                                       -
                                       The proxy signer IDj
                                           chooses 
                                             r
                                             
                                                ←
                                                $
                                             
                                             
                                                ℤ
                                                N
                                                *
                                             
                                          , computes R
                                          =
                                          r
                                          e mod N and 
                                             
                                                c
                                                
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             =
                                             
                                                K
                                                1
                                             
                                             
                                                
                                                   R
                                                   
                                                      
                                                         ID
                                                         
                                                            
                                                               ID
                                                               ˜
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                               
                                                                  D
                                                                  j
                                                               
                                                            
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            m
                                                         
                                                         
                                                            11
                                                         
                                                      
                                                   
                                                
                                             
                                          .

For j
                                          +1≤
                                          u
                                          ≤
                                          j-1 (let the index u be module z), the proxy signer IDj
                                           chooses 
                                             
                                                r
                                                u
                                             
                                             
                                                ←
                                                $
                                             
                                             
                                                ℤ
                                                N
                                                *
                                             
                                          , and computes Ru
                                          
                                          =
                                          r
                                          e mod N and 
                                             
                                                c
                                                
                                                   u
                                                   +
                                                   1
                                                
                                             
                                             =
                                             
                                                K
                                                1
                                             
                                             
                                                
                                                   
                                                      R
                                                      u
                                                   
                                                   H
                                                   
                                                      
                                                         
                                                            I
                                                            
                                                               D
                                                               u
                                                            
                                                         
                                                      
                                                      
                                                         c
                                                         u
                                                      
                                                   
                                                   
                                                      R
                                                      o
                                                   
                                                   H
                                                   
                                                      
                                                         
                                                            I
                                                            
                                                               D
                                                               o
                                                            
                                                         
                                                      
                                                      
                                                         c
                                                         o
                                                      
                                                   
                                                   
                                                      ID
                                                   
                                                   
                                                      
                                                         ID
                                                         ˜
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                         
                                                            D
                                                            u
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            m
                                                         
                                                         
                                                            11
                                                         
                                                      
                                                   
                                                
                                             
                                          .

The proxy signer IDj
                                           computes 
                                             
                                                r
                                                j
                                             
                                             =
                                             
                                                
                                                   r
                                                   
                                                      
                                                         s
                                                         o
                                                      
                                                      
                                                         
                                                            x
                                                            j
                                                         
                                                         
                                                            c
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             mod
                                             N
                                          .

The proxy ring signature is θ
                                          =(R
                                          
                                             o
                                          ,
                                          r
                                          0
                                          …,
                                          r
                                          
                                             z
                                             −1,
                                          c
                                          0) on the message m and the message space descriptor w under original signer's identity ID
                                          0 and an identity subset 
                                             
                                                ID
                                                ˜
                                             
                                             ⊆
                                             ID
                                           of proxy signers.

ProxyRingVer: Given the identity IDo
                                  of an original signer and the identity sets ID and 
                                    
                                       ID
                                       ˜
                                    
                                  of the proxy signers, a message space descriptor w, a message m, and a proxy ring signature θ, a verifier operates as follows:
                                    
                                       -
                                       Checks if m ϵ w, otherwise, it stops.

Checks if 
                                             
                                                ID
                                                ˜
                                             
                                             ⊆
                                             ID
                                          , otherwise, it stops.

For 0≤
                                          u
                                          ≤
                                          z-1, computes Ru
                                          
                                          =
                                          ru
                                             e
                                           and 
                                             
                                                C
                                                
                                                   u
                                                   +
                                                   1
                                                
                                             
                                             =
                                             
                                                K
                                                1
                                             
                                             
                                                
                                                   
                                                      R
                                                      u
                                                   
                                                   H
                                                   
                                                      
                                                         
                                                            I
                                                            
                                                               D
                                                               u
                                                            
                                                         
                                                      
                                                      
                                                         c
                                                         u
                                                      
                                                   
                                                   
                                                      R
                                                      o
                                                   
                                                   H
                                                   
                                                      
                                                         
                                                            I
                                                            
                                                               D
                                                               o
                                                            
                                                         
                                                      
                                                      
                                                         c
                                                         o
                                                      
                                                   
                                                   
                                                      ID
                                                   
                                                   
                                                      ID
                                                      ˜
                                                   
                                                   
                                                      
                                                         I
                                                         
                                                            D
                                                            u
                                                         
                                                      
                                                   
                                                   w
                                                   
                                                      m
                                                   
                                                   11
                                                
                                             
                                          , and accepts the signature if and only if c
                                          z
                                          =
                                          c
                                          0, where c
                                          
                                             o
                                          
                                          =
                                          K
                                          0(‖w‖ID‖11).

In this section, we verify the correctness, and prove the privacy of the proxy signer's identity and existential unforgeability of the proposed scheme in the random oracle model (see [33] for the background). In order to prove unforgeability of the proposed scheme, we need to show that it is unforgeable against adversaries of Types II and III (as defined in Section 2.4).

To prove unforgeability of our proposed scheme, and by contradiction, assuming an adversary A
                        
                           ζII
                           +(1−
                           ζ)III
                        , ζ
                        ∈{0,1}, (the parameter ζ makes difference between adversaries AII
                         and AIII
                        ) we show that there is a solver (algorithm B) that can solve a random instance of the RSA problem with a non-negligible probability. To do this, we show that B can simulate the signature scheme without knowing the secret key(s) of the honest signer(s), and runs the adversary A
                        
                           ζII
                           +(1−
                           ζ)III
                         as its sub-routine. In this regard, we compute the run-time and a lower-bound for the success probability of this simulator in terms of the run-time and success probability of the adversary and the number of queries to the oracles. Then, B uses the oracle replay technique [34] to solve an instance N,e,y of the RSA problem, using a useful pair that B returns when the same random strings and different random oracles are used in signature simulation. In this case, we compute a lower bound for the probability of producing such a useful pair and solving the RSA instance.

To start let us verify the correctness of the proposed scheme, and we use the fact that u is module z. Note that, all computations are done modulo N, but we omit this for simplicity.
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             r
                                             j
                                             e
                                          
                                          H
                                          
                                             
                                                
                                                   I
                                                   
                                                      D
                                                      j
                                                   
                                                
                                             
                                             
                                                c
                                                j
                                             
                                          
                                          
                                             R
                                             o
                                          
                                          H
                                          
                                             
                                                
                                                   I
                                                   
                                                      D
                                                      o
                                                   
                                                
                                             
                                             
                                                c
                                                o
                                             
                                          
                                       
                                    
                                    
                                       
                                          =
                                          
                                             
                                                
                                                   r
                                                   
                                                      
                                                         s
                                                         o
                                                      
                                                      
                                                         x
                                                         j
                                                         
                                                            c
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             e
                                          
                                          H
                                          
                                             
                                                
                                                   I
                                                   
                                                      D
                                                      j
                                                   
                                                
                                             
                                             
                                                c
                                                j
                                             
                                          
                                          
                                             R
                                             o
                                          
                                          H
                                          
                                             
                                                
                                                   I
                                                   
                                                      D
                                                      o
                                                   
                                                
                                             
                                             
                                                c
                                                o
                                             
                                          
                                       
                                    
                                    
                                       
                                          =
                                          
                                             
                                                r
                                                
                                                   
                                                      s
                                                      o
                                                      e
                                                   
                                                   
                                                      x
                                                      j
                                                      
                                                         e
                                                         
                                                            c
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          H
                                          
                                             
                                                
                                                   I
                                                   
                                                      D
                                                      j
                                                   
                                                
                                             
                                             
                                                c
                                                j
                                             
                                          
                                          
                                             R
                                             o
                                          
                                          H
                                          
                                             
                                                
                                                   I
                                                   
                                                      D
                                                      o
                                                   
                                                
                                             
                                             
                                                c
                                                o
                                             
                                          
                                       
                                    
                                    
                                       
                                          =
                                          
                                             R
                                             
                                                
                                                   R
                                                   o
                                                
                                                H
                                                
                                                   
                                                      
                                                         I
                                                         
                                                            D
                                                            o
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      o
                                                   
                                                
                                                H
                                                
                                                   
                                                      
                                                         I
                                                         
                                                            D
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      j
                                                   
                                                
                                             
                                          
                                          H
                                          
                                             
                                                
                                                   I
                                                   
                                                      D
                                                      j
                                                   
                                                
                                             
                                             
                                                c
                                                j
                                             
                                          
                                          
                                             R
                                             o
                                          
                                          H
                                          
                                             
                                                
                                                   I
                                                   
                                                      D
                                                      o
                                                   
                                                
                                             
                                             
                                                c
                                                o
                                             
                                          
                                       
                                    
                                    
                                       
                                          =
                                          R
                                       
                                    
                                 
                              
                           
                        
                     

Also, in what follows we will be needing the following Splitting lemma.
                           Lemma 1
                           
                              [34]. Let A
                              ⊂
                              X
                              ×
                              Y such that Pr[(x,
                              y)∈
                              A]≥
                              δ. For any α<δ, define 
                              
                                 B
                                 =
                                 
                                    
                                       
                                          x
                                          y
                                       
                                       
                                          
                                             ∈
                                             X
                                             ×
                                             Y
                                          
                                       
                                       
                                          Pr
                                          
                                             
                                                y
                                                ′
                                             
                                             ∈
                                             Y
                                          
                                       
                                       
                                          
                                             
                                                x
                                                
                                                   y
                                                   ′
                                                
                                             
                                             ∈
                                             A
                                          
                                       
                                       ≥
                                       δ
                                       −
                                       α
                                    
                                 
                               
                              and 
                              
                                 
                                    B
                                    ¯
                                 
                                 =
                                 
                                    
                                       X
                                       ×
                                       Y
                                    
                                 
                                 \
                                 B
                              
                              , then the following statements hold:
                              
                                 
                                    -
                                    Pr[B]≥
                                       α
                                    


                                       
                                          ∀
                                          
                                             x
                                             y
                                          
                                          ∈
                                          B
                                          ,
                                          
                                             Pr
                                             
                                                
                                                   y
                                                   ′
                                                
                                                ∈
                                                Y
                                             
                                          
                                          
                                             
                                                
                                                   x
                                                   
                                                      y
                                                      ′
                                                   
                                                
                                                ∈
                                                A
                                             
                                          
                                          ≥
                                          δ
                                          −
                                          α
                                       
                                    


                                       
                                          Pr
                                          
                                             
                                                B
                                                
                                                   A
                                                
                                             
                                          
                                          ≥
                                          
                                             α
                                             δ
                                          
                                          .
                                       
                                    


                              The proposed scheme is (t,qH
                              ,q
                              
                                 Ko,qd
                              ,ϵ)-secure against an adversary AII if the RSA function associated to Kgrsa is (t',ϵ')-one-way, and
                              
                                 
                                    (3)
                                    
                                       
                                          
                                             
                                                
                                                   ϵ
                                                   ′
                                                
                                                ≥
                                                
                                                   
                                                      
                                                         ϵ
                                                         2
                                                         2
                                                      
                                                      
                                                         
                                                            1
                                                            −
                                                            2
                                                            
                                                               −
                                                               
                                                                  l
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      4
                                                      
                                                         
                                                            
                                                               q
                                                               
                                                                  K
                                                                  0
                                                               
                                                            
                                                            +
                                                            q
                                                            d
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   t
                                                   ′
                                                
                                                ≤
                                                2
                                                
                                                   
                                                      t
                                                      +
                                                      
                                                         
                                                            
                                                               q
                                                               H
                                                            
                                                            +
                                                            
                                                               q
                                                               E
                                                            
                                                            +
                                                            2
                                                            
                                                               q
                                                               d
                                                            
                                                         
                                                      
                                                      t
                                                      e
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                              where 
                              
                                 
                                    ϵ
                                    2
                                 
                                 ≥
                                 
                                    ϵ
                                    
                                       4
                                       
                                          q
                                          E
                                       
                                    
                                 
                                 −
                                 q
                                 d
                                 
                                    
                                       2
                                       
                                          q
                                          d
                                       
                                       +
                                       q
                                       
                                          K
                                          0
                                       
                                    
                                 
                                 
                                    2
                                    
                                       −
                                       
                                          l
                                          N
                                       
                                    
                                 
                                 −
                                 
                                    2
                                    
                                       −
                                       
                                          l
                                          0
                                       
                                    
                                 
                                 ,
                                 
                                    t
                                    e
                                 
                              
                              , is the time of an exponentiation in ℤ
                                 N
                              
                              ⁎
                              , and, 
                              
                                 
                                    q
                                    H
                                 
                                 ,
                                 
                                    q
                                    
                                       K
                                       0
                                    
                                 
                                 ,
                                 
                                    q
                                    E
                                 
                              
                              , and qd are the number of queries to the oracles H, K
                              0
                              , KeyExtract and DelegationGen, respectively.
                           

Given the adversary AII
                              , we construct another algorithm B which runs AII
                               on inputs (N, e, y
                              =γ
                                 e
                              ). The B's goal is to output 
                                 γ
                                 =
                                 
                                    y
                                    
                                       1
                                       e
                                    
                                 
                                 mod
                                 N
                              . Algorithm B runs AII
                              , which breaks existential unforgeability of the proposal, on inputs mpk
                              =(N,e) and answers AII
                              's oracle queries. Since AII
                               has secret keys of all proxy signers, it can simulate proxy ring signatures by itself, and the oracle access to ProxyRingSign is not necessary. It is assumed that algorithm 
                                 
                                    C
                                    
                                       A
                                       
                                          I
                                          I
                                       
                                    
                                 
                               maintains initially empty associative arrays T[.] and 
                                 
                                    T
                                    
                                       K
                                       0
                                    
                                 
                                 
                                    .
                                 
                              , and answers AII
                              's oracle queries as follows.
                                 
                                    -
                                    
                                       K
                                       0(R
                                       
                                          o
                                       ‖w‖ID‖11) queries: If 
                                          
                                             T
                                             
                                                K
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   R
                                                   o
                                                
                                                
                                                   w
                                                
                                                
                                                   ID
                                                
                                                11
                                             
                                          
                                        is defined, then B returns its value; otherwise, B chooses 
                                          
                                             T
                                             
                                                K
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   R
                                                   o
                                                
                                                
                                                   w
                                                
                                                
                                                   ID
                                                
                                                11
                                             
                                          
                                          
                                             ←
                                             $
                                          
                                          
                                             
                                                0
                                                1
                                             
                                             
                                                l
                                                0
                                             
                                          
                                       , and returns 
                                          
                                             T
                                             
                                                K
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   R
                                                   o
                                                
                                                
                                                   w
                                                
                                                
                                                   ID
                                                
                                                11
                                             
                                          
                                        to AII
                                       .


                                       H(IDu
                                       ) queries: If T[IDu
                                       ]=(b,xu
                                       ,Xu
                                       ) then B returns Xu
                                       . If this entry is not yet defined, it chooses 
                                          
                                             x
                                             u
                                          
                                          
                                             ←
                                             $
                                          
                                          
                                             ℤ
                                             N
                                             *
                                          
                                        and tosses a biased coin b so that b
                                       =0 with probability β and b
                                       =1 with probability 1−
                                       β. If b
                                       =0, then B sets Xu
                                       
                                       =
                                       xu
                                          e
                                        mod N; if b
                                       =1, it sets Xu
                                       
                                       =
                                       xu
                                          ey mod N. It stores T[IDu
                                       ]←(b,xu
                                       ,Xu
                                       ) and returns Xu
                                        to AII
                                       .

KeyExtract queries for IDu
                                       : Algorithm B looks up T[IDu]=(b,xu,Xu), if this entry is not yet defined, it performs a query H(IDu). If b
                                       =0, then B returns xu
                                       ; otherwise, it sets badKE
                                       
                                       ←
                                       true and aborts the execution of AII
                                       .

DelegationGen queries for (w, ID) under identity IDo
                                       : Algorithm B performs a query H(IDo
                                       ) and looks up T[IDo
                                       ]=
                                       b, xo
                                       , Xo
                                       . If b=0, then B simulates the delegation of IDo
                                        with the DelegationGen algorithm σ
                                       
                                          o
                                       
                                       ←
                                       DelegationGen(Para,
                                       mpk,
                                       x
                                       
                                          o
                                       ,
                                       w,
                                       ID) since B knows xo
                                       , the original signer's secret key. If b
                                       =1, B first chooses 
                                          
                                             c
                                             o
                                          
                                          
                                             ←
                                             $
                                          
                                          
                                             
                                                0
                                                1
                                             
                                             
                                                l
                                                0
                                             
                                          
                                        and 
                                          
                                             s
                                             o
                                          
                                          
                                             ←
                                             $
                                          
                                          
                                             ℤ
                                             N
                                             ∗
                                          
                                       , and computes 
                                          
                                             R
                                             o
                                          
                                          ←
                                          
                                             s
                                             o
                                             e
                                          
                                          
                                             X
                                             o
                                             
                                                −
                                                
                                                   c
                                                   o
                                                
                                             
                                          
                                          
                                          mod
                                          
                                          N
                                       . If 
                                          
                                             T
                                             
                                                K
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   R
                                                   o
                                                
                                                |
                                                |
                                                w
                                                |
                                                |
                                                ID
                                                |
                                                |
                                                11
                                             
                                          
                                        has already been defined, then B sets badDG
                                       
                                       ←
                                       true and halts; otherwise, it sets 
                                          
                                             T
                                             
                                                K
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   R
                                                   o
                                                
                                                |
                                                |
                                                w
                                                |
                                                |
                                                ID
                                                |
                                                |
                                                11
                                             
                                          
                                          ←
                                          
                                             c
                                             o
                                          
                                       , and returns σ
                                       
                                          o
                                       
                                       =(R
                                       
                                          o
                                       ,
                                       s
                                       
                                          o
                                       ,
                                       c
                                       
                                          o
                                       ) to AII
                                       .

Finally, it is assumed that AII
                         outputs a valid forgery in the form of (R
                        
                           o
                        ,
                        s
                        
                           o
                        ,
                        c
                        
                           o
                        ) on a message m and a warrant w under original signer's identity IDo
                         with probability at least ϵ in time bound t provided that B does not abort in signature simulation. First, we compute the lower-bound of the probability that B does not abort at answering to queries of AII
                        , we need to compute η
                        =
                        Pr[¬
                        bad
                        
                           KE
                        ]Pr[¬
                        bad
                        
                           DG
                        |¬
                        bad
                        
                           KE
                        ], where events badKE
                         and badDG
                         indicate that B aborts in signature simulation as a result of AII
                        's KeyExtract and DelegationGen queries, respectively. These probabilities are computed as follows.
                           Claim 1
                           
                              
                                 Pr
                                 
                                    
                                       ¬
                                       ba
                                       
                                          d
                                          
                                             K
                                             E
                                          
                                       
                                    
                                 
                                 ≥
                                 
                                    β
                                    
                                       q
                                       E
                                    
                                 
                              
                           


                              
                                 Proof
                                 The value of Pr[¬
                                    bad
                                    
                                       KE
                                    ] is the probability of B's abortion in AII
                                    's KeyExtract queries. For a KeyExtract query, when b
                                    =1, B aborts and badKE
                                    
                                    ←
                                    true with probability 1−
                                    β. Therefore, for one KeyExtract query, Pr[¬
                                    bad
                                    
                                       KE
                                    ] is β, and for at most qE
                                     queries, the value of this probability is at least 
                                       
                                          β
                                          
                                             q
                                             E
                                          
                                       
                                    .


                              
                                 Pr
                                 
                                    
                                       ¬
                                       ba
                                       
                                          d
                                          
                                             D
                                             G
                                          
                                       
                                       |
                                       ¬
                                       ba
                                       
                                          d
                                          
                                             K
                                             E
                                          
                                       
                                    
                                 
                                 ≥
                                 1
                                 −
                                 
                                    q
                                    d
                                 
                                 
                                    
                                       
                                          
                                             
                                                q
                                                d
                                             
                                             +
                                             
                                                q
                                                
                                                   K
                                                   0
                                                
                                             
                                          
                                       
                                       
                                          2
                                          
                                             −
                                             
                                                l
                                                N
                                             
                                          
                                       
                                    
                                 
                                 −
                                 
                                    q
                                    d
                                    2
                                 
                                 
                                    2
                                    
                                       −
                                       
                                          l
                                          N
                                       
                                    
                                 
                              
                           


                              
                                 Proof
                                 Events ¬
                                    bad
                                    
                                       KE
                                     and ¬
                                    bad
                                    
                                       DG
                                     are independent, so we have Pr[¬
                                    bad
                                    
                                       DG
                                    |¬
                                    bad
                                    
                                       KE
                                    ]=
                                    Pr[¬
                                    bad
                                    
                                       DG
                                    ]. The value of Pr[¬
                                    bad
                                    
                                       DG
                                    ] is the probability of B's abortion in DelegationGen queries. If for one DelegationGen query badDG
                                    
                                    ←
                                    true, B aborts, and the probability of this event consists of the probability that (R
                                    
                                       o
                                    ||w||ID||11) generated in a DelegationGen simulation has been occurred by chance in a previous query to the oracle K
                                    0, and the probability that B previously used the same randomness Ro
                                     in one DelegationGen simulation. The probability of the former for qd
                                     DelegationGen queries is at most 
                                       
                                          q
                                          d
                                       
                                       
                                          
                                             
                                                q
                                                d
                                             
                                             +
                                             
                                                q
                                                
                                                   K
                                                   0
                                                
                                             
                                          
                                       
                                       
                                          2
                                          
                                             −
                                             
                                                l
                                                N
                                             
                                          
                                       
                                    , and the probability of the latter for qd
                                     DelegationGen queries is at most 
                                       
                                          q
                                          d
                                          2
                                       
                                       
                                          2
                                          
                                             −
                                             
                                                l
                                                N
                                             
                                          
                                       
                                    .

Therefore, the probability that B does not halt in signature simulation is at least 
                           η
                           ≥
                           
                              β
                              
                                 q
                                 E
                              
                           
                           −
                           
                              q
                              d
                           
                           
                              
                                 2
                                 
                                    q
                                    d
                                 
                                 +
                                 
                                    q
                                    
                                       K
                                       0
                                    
                                 
                              
                           
                           
                              2
                              
                                 −
                                 
                                    l
                                    N
                                 
                              
                           
                        .

Since the forgery is valid, we have 
                           
                              s
                              o
                              e
                           
                           =
                           
                              R
                              o
                           
                           
                              
                                 
                                    H
                                    
                                       
                                          I
                                          
                                             D
                                             o
                                          
                                       
                                    
                                 
                              
                              
                                 c
                                 o
                              
                           
                        , AII
                         has not asked the warrant (w||ID) from DelegationGen algorithm under original signer's identity IDo
                         and IDo
                         has not asked as a KeyExtract query. Also, the probability of having H(ID
                        
                           o
                        )=
                        x
                        
                           o
                        
                        
                           e
                        
                        y is 1−
                        β. Then, B looks up T[.] for IDo
                         to obtain the value xo
                        , and returns a useful output (R
                        
                           o
                        ,
                        s
                        
                           o
                        ,
                        c
                        
                           o
                        ,
                        x
                        
                           o
                        ) with probability 
                           
                              ϵ
                              1
                           
                           ≥
                           ϵ
                           
                              
                                 1
                                 −
                                 β
                              
                           
                           η
                           ≥
                           ϵ
                           
                              
                                 1
                                 −
                                 β
                              
                           
                           
                              β
                              
                                 q
                                 E
                              
                           
                           −
                           
                              q
                              d
                           
                           
                              
                                 2
                                 
                                    q
                                    d
                                 
                                 +
                                 
                                    q
                                    
                                       K
                                       0
                                    
                                 
                              
                           
                           
                              2
                              
                                 −
                                 
                                    l
                                    N
                                 
                              
                           
                        . The value of 
                           
                              β
                              
                                 q
                                 E
                              
                           
                           
                              
                                 1
                                 −
                                 β
                              
                           
                         is maximized for 
                           β
                           =
                           
                              
                                 
                                    q
                                    E
                                 
                                 
                                    
                                       q
                                       E
                                    
                                    +
                                    1
                                 
                              
                           
                        . With substituting the value of β, we obtain 
                           
                              β
                              
                                 q
                                 E
                              
                           
                           
                              
                                 1
                                 −
                                 β
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          q
                                          E
                                       
                                       
                                          
                                             q
                                             E
                                          
                                          +
                                          1
                                       
                                    
                                 
                              
                              
                                 q
                                 E
                              
                           
                           
                              
                                 1
                                 
                                    
                                       q
                                       E
                                    
                                    +
                                    1
                                 
                              
                           
                           =
                           
                              
                                 1
                                 
                                    q
                                    E
                                 
                              
                           
                           
                              
                                 
                                    1
                                    −
                                    
                                       
                                          1
                                          
                                             
                                                q
                                                E
                                             
                                             +
                                             1
                                          
                                       
                                    
                                 
                              
                              
                                 1
                                 +
                                 
                                    q
                                    E
                                 
                              
                           
                        . If q
                        
                           E
                        
                        =0, this value is 1 and 
                           
                              
                                 
                                    1
                                    −
                                    
                                       
                                          1
                                          
                                             
                                                q
                                                E
                                             
                                             +
                                             1
                                          
                                       
                                    
                                 
                              
                              
                                 1
                                 +
                                 
                                    q
                                    E
                                 
                              
                           
                         is a monotonically increasing sequence for q
                        
                           E
                        
                        ≥1. Therefore, the lower bound of 
                           
                              β
                              
                                 q
                                 E
                              
                           
                           
                              
                                 1
                                 −
                                 β
                              
                           
                         is 
                           
                              
                                 1
                                 
                                    4
                                    
                                       q
                                       E
                                    
                                 
                              
                           
                        . As a consequence, B returns a useful output (R
                        
                           o
                        ,
                        s
                        
                           o
                        ,
                        c
                        
                           o
                        ,
                        x
                        
                           o
                        ) with probability 
                           
                              ϵ
                              1
                           
                           ≥
                           
                              
                                 ϵ
                                 
                                    4
                                    
                                       q
                                       E
                                    
                                 
                              
                           
                           −
                           
                              q
                              d
                           
                           
                              
                                 2
                                 
                                    q
                                    d
                                 
                                 +
                                 
                                    q
                                    
                                       K
                                       0
                                    
                                 
                              
                           
                           
                              2
                              
                                 −
                                 
                                    l
                                    N
                                 
                              
                           
                        .

Since K
                        0 is a random oracle, the probability of the event that c
                        
                           o
                        
                        =
                        K
                        0(R
                        
                           o
                        ||w||ID||11)) is less than 
                           
                              2
                              
                                 −
                                 
                                    l
                                    0
                                 
                              
                           
                        , unless it is asked during the attack. Hence, in what follows it is likely that query (R
                        
                           o
                        ||w||ID||11) has been asked during a successful attack. The lower bound of probability of producing a valid forgery after making query to K
                        0 oracle is 
                           
                              ϵ
                              2
                           
                           ≥
                           
                              ϵ
                              1
                           
                           −
                           
                              2
                              
                                 −
                                 
                                    l
                                    0
                                 
                              
                           
                        . Then, B uses the oracle replay technique [34] to solve the RSA problem.

Algorithm B employs two copies of AII
                        , guesses a fixed index 
                           1
                           ≤
                           κ
                           ≤
                           
                              
                                 
                                    q
                                    
                                       K
                                       0
                                    
                                 
                                 +
                                 
                                    q
                                    d
                                 
                              
                           
                         and hopes that κ be the index of query (R
                        
                           o
                        ||w||ID||11) to oracle K
                        0 for which AII
                         forges a delegation, and the probability of a good guess by chance is 
                           
                              
                                 1
                                 
                                    
                                       
                                          q
                                          
                                             K
                                             0
                                          
                                       
                                       +
                                       
                                          q
                                          d
                                       
                                    
                                 
                              
                           
                        . Algorithm B gives the same system parameters, the same identities and the same sequence of random bits to the two copies of AII
                        , and responds with the same random answers to their queries for the oracles until they ask the oracle K
                        0 for κth query. At that point (the κth query to the oracle K
                        0), B gives two random answers co
                         and c
                        
                           o
                        ′ such that c
                        
                           o
                        
                        ≠
                        c
                        
                           o
                        ′ to the hash queries Kκ
                        (forking). Hence, B obtains two useful outputs (a useful pair) (R
                        
                           o
                        ,
                        s
                        
                           o
                        ,
                        c
                        
                           o
                        ,
                        x
                        
                           o
                        ) and (R
                        
                           o
                        ,
                        s
                        
                           o
                        ′,
                        c
                        
                           o
                        ′,
                        x
                        
                           o
                        ) after AII
                         asks the same query (R
                        
                           o
                        ||w||ID||11) from K
                        0. We employ Splitting Lemma to compute the probability of B in returning a useful pair.

It is assumed that Γ denotes the set of successful executions of AII
                        , and its success probability of B in returning a useful output is taken over the space (X,Y), where X is the set of random bits and random oracle responses that B takes up except for randomness related to the oracle K
                        0, and Y is the set of random oracle responses to the oracle K
                        0. Hence, we have Pr[(X,
                        Y)∈
                        Γ]=ϵ2. With Splitting Lemma, we split the randomness Y related to K
                        0 to (Y′,
                        c
                        
                           o
                        ), where Y is the set of all random responses to different queries of K
                        0 except for κth query whose answer is denoted as co
                        . The Splitting Lemma ensures the existence of a subset of executions Ω such that 
                           Pr
                           
                              
                                 Ω
                                 |
                                 Γ
                              
                           
                           ≥
                           
                              
                                 γ
                                 δ
                              
                           
                           =
                           
                              
                                 1
                                 2
                              
                           
                        , and for each (X,
                        Y)∈
                        Ω, 
                           P
                           
                              r
                              
                                 
                                    c
                                    o
                                    ′
                                 
                              
                           
                           
                              
                                 
                                    X
                                    
                                       Y
                                       ′
                                    
                                    
                                       
                                          c
                                          o
                                          ′
                                       
                                    
                                 
                                 ∈
                                 Γ
                              
                           
                           ≥
                           δ
                           −
                           γ
                           =
                           
                              
                                 
                                    ϵ
                                    2
                                 
                                 
                                    2
                                    
                                       
                                          
                                             q
                                             
                                                K
                                                0
                                             
                                          
                                          +
                                          
                                             q
                                             d
                                          
                                       
                                    
                                 
                              
                           
                        . If B replays the attack with fixed (X,Y') and a randomly chosen 
                           
                              
                                 c
                                 o
                                 ′
                              
                           
                           ∈
                           
                              
                                 0
                                 1
                              
                              
                                 l
                                 0
                              
                           
                        , it gets another successful pair ((X,
                        Y′),
                        c
                        
                           o
                        ′) such that c
                        
                           o
                        
                        ≠
                        c
                        
                           o
                        ′ with probability 
                           
                              
                                 
                                    
                                       ϵ
                                       2
                                    
                                    
                                       
                                          1
                                          −
                                          
                                             2
                                             
                                                −
                                                
                                                   l
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    4
                                    
                                       
                                          
                                             q
                                             
                                                K
                                                0
                                             
                                          
                                          +
                                          
                                             q
                                             d
                                          
                                       
                                    
                                 
                              
                           
                        .

After two successful executions of AII
                        , B obtains ((X,
                        Y′),
                        c
                        
                           o
                        ) and ((X,
                        Y′),
                        c
                        
                           o
                        ′), c
                        
                           o
                        
                        ≠
                        c
                        
                           o
                        ′ which means that it obtains a useful pair (R
                        
                           o
                        ,
                        s
                        
                           o
                        ,
                        c
                        
                           o
                        ,
                        x
                        
                           o
                        ) and (R
                        
                           o
                        ,
                        s
                        
                           o
                        ′,
                        c
                        
                           o
                        ′,
                        x
                        
                           o
                        ) with probability 
                           
                              ϵ
                              ′
                           
                           ≥
                           
                              
                                 
                                    
                                       ϵ
                                       2
                                       2
                                    
                                    
                                       
                                          1
                                          −
                                          
                                             2
                                             
                                                −
                                                
                                                   l
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    4
                                    
                                       
                                          
                                             q
                                             
                                                K
                                                0
                                             
                                          
                                          +
                                          
                                             q
                                             d
                                          
                                       
                                    
                                 
                              
                           
                        , where 
                           
                              ϵ
                              2
                           
                           ≥
                           
                              ϵ
                              1
                           
                           −
                           
                              2
                              
                                 −
                                 
                                    l
                                    0
                                 
                              
                           
                        .

From the useful pair (R
                        
                           o
                        ,
                        s
                        
                           o
                        ,
                        c
                        
                           o
                        ,
                        x
                        
                           o
                        ) and (R
                        
                           o
                        ,
                        s
                        
                           o
                        ′,
                        c
                        
                           o
                        ′,
                        x
                        
                           o
                        ), B computes the RSA inversion of y as follows. Since these useful outputs are derived from valid forgeries, we have
                           
                              
                                 
                                    s
                                    o
                                    e
                                 
                                 =
                                 
                                    R
                                    o
                                 
                                 
                                    
                                       
                                          
                                             x
                                             o
                                             e
                                          
                                          y
                                       
                                    
                                    
                                       c
                                       o
                                    
                                 
                              
                           
                        and
                           
                              
                                 
                                    
                                       
                                          s
                                          ′
                                       
                                       o
                                       e
                                    
                                 
                                 =
                                 
                                    R
                                    o
                                 
                                 
                                    
                                       
                                          
                                             x
                                             o
                                             e
                                          
                                          y
                                       
                                    
                                    
                                       
                                          c
                                          o
                                          ′
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

By dividing the two aforementioned equations, we obtain 
                           
                              
                                 
                                    
                                       x
                                       o
                                       
                                          
                                             
                                                
                                                   c
                                                   o
                                                   ′
                                                
                                             
                                             −
                                             
                                                c
                                                o
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             o
                                          
                                          
                                             
                                                s
                                                o
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                              e
                           
                           =
                           
                              y
                              
                                 
                                    
                                       c
                                       o
                                    
                                    −
                                    
                                       
                                          c
                                          o
                                          ′
                                       
                                    
                                 
                              
                           
                           
                           mod
                           
                           N
                        . Since 
                           
                              c
                              o
                           
                           ≠
                           
                              
                                 c
                                 o
                                 ′
                              
                           
                           ∈
                           
                              
                                 0
                                 1
                              
                              
                                 l
                                 0
                              
                           
                         and e is a prime of length strictly greater than l
                        0, we have e
                        >(c
                        
                           o
                        
                        −
                        c
                        
                           o
                        ′) and therefore gcd(e,(c
                        
                           o
                        
                        −
                        c
                        
                           o
                        ′))=1. Using the extended Euclidean algorithm, one can find a,b ϵ ℤ such that ae
                        +
                        b(c
                        
                           o
                        
                        −
                        c
                        
                           o
                        ′)=1. Hence, we have 
                           y
                           =
                           
                              y
                              
                                 a
                                 e
                                 +
                                 b
                                 
                                    
                                       
                                          c
                                          o
                                       
                                       −
                                       
                                          
                                             c
                                             o
                                             ′
                                          
                                       
                                    
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       y
                                       a
                                    
                                    
                                       
                                          
                                             
                                                x
                                                o
                                                
                                                   
                                                      
                                                         
                                                            c
                                                            o
                                                            ′
                                                         
                                                      
                                                      −
                                                      
                                                         c
                                                         o
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   s
                                                   
                                                      s
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       b
                                    
                                 
                              
                              e
                           
                           
                           mod
                           
                           N
                        . Therefore, algorithm B outputs 
                           
                              
                                 
                                    y
                                    a
                                 
                                 
                                    
                                       
                                          
                                             x
                                             o
                                             
                                                
                                                   
                                                      
                                                         c
                                                         o
                                                         ′
                                                      
                                                   
                                                   −
                                                   
                                                      c
                                                      o
                                                   
                                                
                                             
                                          
                                          
                                             
                                                s
                                                
                                                   s
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    b
                                 
                              
                           
                         as the RSA inversion of y with probability ϵ'.

Algorithm B's run-time t' is twice of AII
                        's run-time, t, plus the time required to respond to hash queries, qE
                         KeyExtract and qd
                         DelegationGen queries. To estimate the required time of signature simulation, it is assumed that a (multi-) exponentiation in ℤ
                           N
                         takes te
                         time while all other operations take zero time. Since each random oracle H or KeyExtract query takes at most one exponentiation, a delegation simulation takes 2 exponentiations, B's run-time is t′≤2(t
                        +(q
                        
                           H
                        
                        +
                        q
                        
                           E
                        
                        +2q
                        
                           d
                        )t
                        
                           e
                        ). This completes the proof.
                           Theorem 2
                           
                              The proposed scheme is 
                              
                                 
                                    t
                                    
                                       q
                                       H
                                    
                                    
                                       q
                                       
                                          K
                                          1
                                       
                                    
                                    
                                       q
                                       E
                                    
                                    
                                       q
                                       
                                          p
                                          r
                                          s
                                       
                                    
                                    ϵ
                                 
                              
                              -secure against an adversary AIII if the RSA function associated to Kgrsa is (t',ϵ')-one-way, and
                              
                                 
                                    (4)
                                    
                                       
                                          
                                             
                                                
                                                   ϵ
                                                   ′
                                                
                                                ≥
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ϵ
                                                                     1
                                                                  
                                                                  −
                                                                  z
                                                                  
                                                                     2
                                                                     
                                                                        −
                                                                        
                                                                           l
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            2
                                                         
                                                         
                                                            
                                                               1
                                                               −
                                                               
                                                                  2
                                                                  
                                                                     −
                                                                     
                                                                        l
                                                                        1
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         8
                                                         
                                                            
                                                               
                                                                  q
                                                                  
                                                                     K
                                                                     1
                                                                  
                                                               
                                                               +
                                                               
                                                                  q
                                                                  
                                                                     p
                                                                     r
                                                                     s
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  q
                                                                  
                                                                     K
                                                                     1
                                                                  
                                                               
                                                               +
                                                               
                                                                  q
                                                                  
                                                                     p
                                                                     r
                                                                     s
                                                                  
                                                               
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   t
                                                   ′
                                                
                                                ≤
                                                2
                                                
                                                   
                                                      t
                                                      +
                                                      
                                                         
                                                            
                                                               q
                                                               H
                                                            
                                                            +
                                                            
                                                               q
                                                               E
                                                            
                                                            +
                                                            
                                                               
                                                                  2
                                                                  z
                                                                  +
                                                                  1
                                                               
                                                            
                                                            
                                                               q
                                                               
                                                                  p
                                                                  r
                                                                  s
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                         e
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                              where 
                              
                                 
                                    ϵ
                                    1
                                 
                                 ≥
                                 
                                    
                                       
                                          
                                             ϵ
                                             
                                                4
                                                
                                                   q
                                                   E
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             2
                                             
                                                q
                                                
                                                   p
                                                   r
                                                   s
                                                
                                                2
                                             
                                             +
                                             
                                                q
                                                
                                                   p
                                                   r
                                                   s
                                                
                                             
                                             
                                                q
                                                
                                                   K
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          2
                                          
                                             −
                                             
                                                l
                                                N
                                             
                                          
                                       
                                    
                                 
                              
                              , te is the time of an exponentiation in ℤ
                                 N
                              
                              ⁎
                              , and qH, 
                              
                                 
                                    q
                                    
                                       K
                                       0
                                    
                                 
                              
                              , 
                              
                                 
                                    q
                                    
                                       K
                                       1
                                    
                                 
                              
                              , qE and qprs are the number of queries to the oracles H, K
                              0
                              , K
                              1
                              , KeyExtract and ProxyRingSign, respectively.
                           

Given the adversary AIII
                              , we construct another algorithm B which runs AIII
                               on inputs (N,e,y
                              =
                              ye
                               mod N). The B's goal is to output 
                                 γ
                                 =
                                 
                                    y
                                    
                                       
                                          1
                                          e
                                       
                                    
                                 
                                 
                                 mod
                                 
                                 N
                              . Algorithm B runs AIII
                              , which breaks existential unforgeability of the proposal, on inputs mpk
                              =(N,e) and answers AIII
                              's oracle queries. Since AIII
                               has the secret key of the original signer, it can simulate delegations by itself, and the oracle access to DelegationGen is not necessary. It is assumed that algorithm B maintains initially empty associative arrays T[.], 
                                 
                                    T
                                    
                                       K
                                       0
                                    
                                 
                                 
                                    .
                                 
                               and 
                                 
                                    T
                                    
                                       K
                                       1
                                    
                                 
                                 
                                    .
                                 
                              , and answers AIII
                              's oracle queries as follows.
                                 
                                    -
                                    
                                       K
                                       0(R
                                       
                                          o
                                       ||w||ID||11) queries: If 
                                          
                                             T
                                             
                                                K
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   R
                                                   o
                                                
                                                |
                                                |
                                                w
                                                |
                                                |
                                                ID
                                                |
                                                |
                                                11
                                             
                                          
                                        is defined then B returns its value, otherwise B chooses 
                                          
                                             T
                                             
                                                K
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   R
                                                   o
                                                
                                                |
                                                |
                                                w
                                                |
                                                |
                                                ID
                                                |
                                                |
                                                11
                                             
                                          
                                          
                                             ←
                                             $
                                          
                                          
                                             
                                                0
                                                1
                                             
                                             
                                                l
                                                0
                                             
                                          
                                       , and returns 
                                          
                                             T
                                             
                                                K
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   R
                                                   o
                                                
                                                |
                                                |
                                                w
                                                |
                                                |
                                                ID
                                                |
                                                |
                                                11
                                             
                                          
                                        to AIII
                                       .


                                       
                                          
                                             K
                                             1
                                          
                                          
                                             
                                                
                                                   R
                                                   u
                                                
                                                H
                                                
                                                   
                                                      
                                                         I
                                                         
                                                            D
                                                            u
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      u
                                                   
                                                
                                                
                                                   R
                                                   o
                                                
                                                H
                                                
                                                   
                                                      
                                                         I
                                                         
                                                            D
                                                            o
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      o
                                                   
                                                
                                                |
                                                |
                                                ID
                                                |
                                                |
                                                
                                                   ID
                                                   ˜
                                                
                                                |
                                                |
                                                I
                                                
                                                   D
                                                   u
                                                
                                                |
                                                |
                                                w
                                                |
                                                |
                                                m
                                                |
                                                |
                                                11
                                             
                                          
                                        queries: If 
                                          
                                             T
                                             
                                                K
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   R
                                                   u
                                                
                                                H
                                                
                                                   
                                                      
                                                         I
                                                         
                                                            D
                                                            u
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      u
                                                   
                                                
                                                
                                                   R
                                                   o
                                                
                                                H
                                                
                                                   
                                                      
                                                         I
                                                         
                                                            D
                                                            o
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      o
                                                   
                                                
                                                |
                                                |
                                                ID
                                                |
                                                |
                                                
                                                   ID
                                                   ˜
                                                
                                                |
                                                |
                                                I
                                                
                                                   D
                                                   u
                                                
                                                |
                                                |
                                                w
                                                |
                                                |
                                                m
                                                |
                                                |
                                                11
                                             
                                          
                                        is defined then B returns its value; otherwise, B chooses 
                                          
                                             T
                                             
                                                K
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   R
                                                   u
                                                
                                                H
                                                
                                                   
                                                      
                                                         I
                                                         
                                                            D
                                                            u
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      u
                                                   
                                                
                                                
                                                   R
                                                   o
                                                
                                                H
                                                
                                                   
                                                      
                                                         I
                                                         
                                                            D
                                                            o
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      o
                                                   
                                                
                                                |
                                                |
                                                ID
                                                |
                                                |
                                                
                                                   ID
                                                   ˜
                                                
                                                |
                                                |
                                                I
                                                
                                                   D
                                                   u
                                                
                                                |
                                                |
                                                w
                                                |
                                                |
                                                m
                                                |
                                                |
                                                11
                                             
                                          
                                          
                                             ←
                                             $
                                          
                                          
                                             
                                                0
                                                1
                                             
                                             
                                                l
                                                1
                                             
                                          
                                       , and returns 
                                          
                                             T
                                             
                                                K
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   R
                                                   u
                                                
                                                H
                                                
                                                   
                                                      
                                                         I
                                                         
                                                            D
                                                            u
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      u
                                                   
                                                
                                                
                                                   R
                                                   o
                                                
                                                H
                                                
                                                   
                                                      
                                                         I
                                                         
                                                            D
                                                            o
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      o
                                                   
                                                
                                                |
                                                |
                                                ID
                                                |
                                                |
                                                
                                                   ID
                                                   ˜
                                                
                                                |
                                                |
                                                I
                                                
                                                   D
                                                   u
                                                
                                                |
                                                |
                                                w
                                                |
                                                |
                                                m
                                                |
                                                |
                                                11
                                             
                                          
                                        to AIII
                                       .

H(IDu
                                       ) queries: If T[ID
                                       
                                          u
                                       ]=(b,
                                       x
                                       
                                          u
                                       ,
                                       X
                                       
                                          u
                                       ) then B returns Xu
                                       . If this entry is not yet defined, it chooses 
                                          
                                             x
                                             u
                                          
                                          
                                             ←
                                             $
                                          
                                          
                                             ℤ
                                             N
                                             ∗
                                          
                                        and tosses a biased coin b so that b
                                       =0 with probability β and b
                                       =1 with probability 1−
                                       β. If b
                                       =0, then B sets X
                                       
                                          u
                                       
                                       =
                                       x
                                       
                                          u
                                       
                                       
                                          e
                                       
                                       
                                       modN; if b
                                       =1, it sets X
                                       
                                          u
                                       
                                       =
                                       x
                                       
                                          u
                                       
                                       
                                          e
                                       
                                       ymodN. It stores T[ID
                                       
                                          u
                                       ]←(b,
                                       x
                                       
                                          u
                                       ,
                                       X
                                       
                                          u
                                       ) and returns Xu
                                        to AIII
                                       .

KeyExtract queries for IDu
                                       : Algorithm B looks up T[ID
                                       
                                          u
                                       ]=(b,
                                       x
                                       
                                          u
                                       ,
                                       X
                                       
                                          u
                                       ), if this entry is not yet defined, it performs a query H(IDu
                                       ). If b
                                       =0, then B returns xu
                                       ; otherwise, it sets badKE
                                       
                                       ←
                                       true and aborts the execution of AIII
                                       .

ProxyRingSign queries for a message m w.r.t. 
                                          
                                             ID
                                             ˜
                                          
                                       : Adversary AIII
                                        provides a delegation σo
                                        on a message space descriptor w and an identity set ID. Algorithm B first checks if the delegation for (w, ID) is valid under identity IDo
                                       , if m ϵ w and if 
                                          
                                             ID
                                             ˜
                                          
                                          ⊆
                                          ID
                                       . If so, B proceeds as follows. If bu
                                       
                                       =0 for some 0≤
                                       u
                                       ≤
                                       z
                                       −1, B knows some xu
                                        and can generate a valid proxy ring signature following ProxyRingSign algorithm. If for all 0≤
                                       u
                                       ≤
                                       z
                                       −1, we have bu
                                       
                                       =1, B chooses 
                                          
                                             c
                                             0
                                          
                                          
                                             ←
                                             $
                                          
                                          
                                             
                                                0
                                                1
                                             
                                             
                                                l
                                                1
                                             
                                          
                                        and 
                                          
                                             r
                                             u
                                          
                                          
                                             ←
                                             $
                                          
                                          
                                             ℤ
                                             N
                                             ∗
                                          
                                        for 0≤
                                       u
                                       ≤
                                       z
                                       −1, and computes R
                                       
                                          u
                                       
                                       =
                                       r
                                       
                                          u
                                       
                                       
                                          e
                                       
                                       
                                       modN. For 0≤
                                       u
                                       ≤
                                       z
                                       −2, computes 
                                          
                                             c
                                             u
                                          
                                          =
                                          
                                             K
                                             1
                                          
                                          
                                             
                                                
                                                   R
                                                   u
                                                
                                                H
                                                
                                                   
                                                      
                                                         I
                                                         
                                                            D
                                                            u
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      u
                                                   
                                                
                                                
                                                   R
                                                   o
                                                
                                                H
                                                
                                                   
                                                      
                                                         I
                                                         
                                                            D
                                                            o
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      o
                                                   
                                                
                                                |
                                                |
                                                ID
                                                |
                                                |
                                                
                                                   ID
                                                   ˜
                                                
                                                |
                                                |
                                                I
                                                
                                                   D
                                                   u
                                                
                                                |
                                                |
                                                w
                                                |
                                                |
                                                m
                                                |
                                                |
                                                11
                                             
                                          
                                       , if 
                                          
                                             T
                                             
                                                K
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   R
                                                   
                                                      z
                                                      −
                                                      1
                                                   
                                                
                                                H
                                                
                                                   
                                                      
                                                         I
                                                         
                                                            D
                                                            
                                                               z
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      
                                                         z
                                                         −
                                                         1
                                                      
                                                   
                                                
                                                
                                                   R
                                                   o
                                                
                                                H
                                                
                                                   
                                                      
                                                         I
                                                         
                                                            D
                                                            o
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      o
                                                   
                                                
                                                |
                                                |
                                                ID
                                                |
                                                |
                                                
                                                   ID
                                                   ˜
                                                
                                                |
                                                |
                                                I
                                                
                                                   D
                                                   
                                                      z
                                                      −
                                                      1
                                                   
                                                
                                                |
                                                |
                                                w
                                                |
                                                |
                                                m
                                                |
                                                |
                                                11
                                             
                                          
                                        has already been defined, then B sets badPS
                                       
                                       ←
                                       true and halts; otherwise, it sets 
                                          
                                             T
                                             
                                                K
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   R
                                                   
                                                      z
                                                      −
                                                      1
                                                   
                                                
                                                H
                                                
                                                   
                                                      
                                                         I
                                                         
                                                            D
                                                            
                                                               z
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      
                                                         z
                                                         −
                                                         1
                                                      
                                                   
                                                
                                                
                                                   R
                                                   o
                                                
                                                H
                                                
                                                   
                                                      
                                                         I
                                                         
                                                            D
                                                            o
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      o
                                                   
                                                
                                                |
                                                |
                                                ID
                                                |
                                                |
                                                
                                                   ID
                                                   ˜
                                                
                                                |
                                                |
                                                I
                                                
                                                   D
                                                   
                                                      z
                                                      −
                                                      1
                                                   
                                                
                                                |
                                                |
                                                w
                                                |
                                                |
                                                m
                                                |
                                                |
                                                11
                                             
                                          
                                          ←
                                          
                                             c
                                             0
                                          
                                        and returns the proxy ring signature θ
                                       =(R
                                       
                                          o
                                       ,
                                       r
                                       0
                                       …,
                                       r
                                       
                                          z
                                          −1,
                                       c
                                       0) on the message m and the message space descriptor w w.r.t. original signer's identity IDo
                                        and two identity sets ID and 
                                          
                                             ID
                                             ˜
                                          
                                        for proxy signers to AIII
                                       .

Finally, it is assumed that AIII
                         outputs a valid forgery θ
                        =(R
                        
                           o
                        ,
                        r
                        0
                        …,
                        r
                        
                           z
                           −1,
                        c
                        0) on a message m and the message space descriptor w under the original signer's identity IDo
                         and the proxy signers' identity sets ID and 
                           
                              ID
                              ˜
                           
                         with probability at least ϵ in time bound t provided that B does not abort in signature simulation. To lower-bound the probability that B does not abort at answering to queries of AIII
                        , we need to compute η
                        =
                        Pr[¬
                        bad
                        
                           KE
                        ]Pr[¬
                        bad
                        
                           PS
                        |¬
                        bad
                        
                           KE
                        ], where events badKE
                         and badPS
                         indicate that B aborts in signature simulation as a result of any of AIII
                        's KeyExtract and ProxyRingSign queries, respectively. These probabilities are computed as follows.
                           Claim 3
                           Pr[¬
                              bad
                              
                                 KE
                              ]≥
                              β
                              
                                 qE
                              .


                              
                                 Proof
                                 The proof is similar to the proof of Claim 1.


                              
                                 Pr
                                 
                                    
                                       ¬
                                       ba
                                       
                                          d
                                          
                                             P
                                             S
                                          
                                       
                                       
                                          
                                             ¬
                                             ba
                                             
                                                d
                                                
                                                   K
                                                   E
                                                
                                             
                                          
                                       
                                    
                                 
                                 ≥
                                 1
                                 −
                                 
                                    q
                                    
                                       p
                                       r
                                       s
                                    
                                 
                                 
                                    
                                       
                                          q
                                          
                                             p
                                             r
                                             s
                                          
                                       
                                       +
                                       
                                          q
                                          
                                             K
                                             1
                                          
                                       
                                    
                                 
                                 
                                    2
                                    
                                       −
                                       
                                          l
                                          N
                                       
                                    
                                 
                                 −
                                 
                                    q
                                    
                                       p
                                       r
                                       s
                                    
                                    2
                                 
                                 
                                    2
                                    
                                       −
                                       
                                          l
                                          N
                                       
                                    
                                 
                              .


                              
                                 Proof
                                 Events ¬
                                    bad
                                    
                                       KE
                                     and ¬
                                    bad
                                    
                                       PS
                                     are independent, so Pr[¬
                                    bad
                                    
                                       PS
                                    |¬
                                    bad
                                    
                                       KE
                                    ]=
                                    Pr[¬
                                    bad
                                    
                                       PS
                                    ]. The value of Pr[¬
                                    bad
                                    
                                       PS
                                    ] is the probability of B's abortion in ProxyRingSign queries. If for one ProxyRingSign query badPS
                                    
                                    ←
                                    true, B aborts, and the probability of this event consists of the probability that 
                                       
                                          
                                             
                                                R
                                                u
                                             
                                             H
                                             
                                                
                                                   
                                                      I
                                                      
                                                         D
                                                         u
                                                      
                                                   
                                                
                                                
                                                   c
                                                   u
                                                
                                             
                                             
                                                R
                                                o
                                             
                                             H
                                             
                                                
                                                   
                                                      I
                                                      
                                                         D
                                                         o
                                                      
                                                   
                                                
                                                
                                                   c
                                                   o
                                                
                                             
                                             |
                                             |
                                             ID
                                             |
                                             |
                                             
                                                ID
                                                ˜
                                             
                                             |
                                             |
                                             I
                                             
                                                D
                                                u
                                             
                                             |
                                             |
                                             w
                                             |
                                             |
                                             m
                                             |
                                             |
                                             11
                                          
                                       
                                     generated in ProxyRingSign simulation has been occurred by chance in a previous query to the oracle K
                                    1 and the probability that B previously used the same randomness Ru
                                     in one ProxyRingSign simulation. The probability of the former for at most qprs
                                     queries is at most 
                                       
                                          q
                                          
                                             p
                                             r
                                             s
                                          
                                       
                                       
                                          
                                             
                                                q
                                                
                                                   p
                                                   r
                                                   s
                                                
                                             
                                             +
                                             
                                                q
                                                
                                                   K
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          2
                                          
                                             −
                                             
                                                l
                                                N
                                             
                                          
                                       
                                    , and the probability of the latter for at most qprs
                                     ProxyRingSign queries is at most 
                                       
                                          q
                                          
                                             p
                                             r
                                             s
                                          
                                          2
                                       
                                       
                                          2
                                          
                                             −
                                             
                                                l
                                                N
                                             
                                          
                                       
                                    .

Since the forgery is valid, we have Ru
                        
                        =
                        ru
                           e
                        , 
                           
                              c
                              
                                 u
                                 +
                                 1
                              
                           
                           =
                           
                              K
                              1
                           
                           
                              
                                 
                                    R
                                    u
                                 
                                 H
                                 
                                    
                                       
                                          I
                                          
                                             D
                                             u
                                          
                                       
                                    
                                    
                                       c
                                       u
                                    
                                 
                                 
                                    R
                                    o
                                 
                                 H
                                 
                                    
                                       
                                          I
                                          
                                             D
                                             o
                                          
                                       
                                    
                                    
                                       c
                                       o
                                    
                                 
                                 |
                                 |
                                 ID
                                 |
                                 |
                                 
                                    ID
                                    ˜
                                 
                                 |
                                 |
                                 I
                                 
                                    D
                                    u
                                 
                                 |
                                 |
                                 w
                                 |
                                 |
                                 m
                                 |
                                 |
                                 11
                              
                           
                         for 0≤
                        u
                        ≤
                        z-1, and cz
                        
                        =
                        c
                        0, and also AIII
                         has not asked the message m from ProxyRingSign algorithm under proxy signer's identity set 
                           
                              ID
                              ˜
                           
                           ⊆
                           ID
                         and it has not asked identities in the proxy signers' identity set 
                           
                              ID
                              ˜
                           
                         from KeyExtract algorithm. In addition, with probability 1–β, we have H(IDu
                        
                        =
                        xu
                           ey mod N), 0≤
                        u
                        ≤
                        z-1.

Algorithm B performs additional random oracle queries H(IDu
                        ) for identities in the forgery to find T[IDu
                        ]=(b,xu
                        ,Xu
                        ) for them, and returns (R
                        
                           o
                        ,
                        r
                        0
                        …,
                        r
                        
                           z
                           −1,
                        c
                        0,{x
                        
                           u
                        }0≤
                           u
                           ≤
                           z
                           −1,
                        x
                        
                           o
                        ,
                        m,
                        w). As a result, the probability of returning a useful output is at least 
                           ϵ
                           
                              
                                 1
                                 −
                                 β
                              
                           
                           η
                           ≥
                           ϵ
                           
                              
                                 1
                                 −
                                 β
                              
                           
                           
                              β
                              
                                 q
                                 E
                              
                           
                           −
                           
                              q
                              
                                 p
                                 r
                                 s
                              
                           
                           
                              
                                 2
                                 
                                    q
                                    
                                       p
                                       r
                                       s
                                    
                                 
                                 +
                                 
                                    q
                                    
                                       K
                                       1
                                    
                                 
                              
                           
                           
                              2
                              
                                 −
                                 
                                    l
                                    N
                                 
                              
                           
                        . The value of 
                           
                              β
                              
                                 q
                                 E
                              
                           
                           
                              
                                 1
                                 −
                                 β
                              
                           
                         is maximized for 
                           β
                           =
                           
                              
                                 
                                    q
                                    E
                                 
                                 
                                    
                                       q
                                       E
                                    
                                    +
                                    1
                                 
                              
                           
                        . With substituting the value of β, we have 
                           
                              β
                              
                                 q
                                 E
                              
                           
                           
                              
                                 1
                                 −
                                 β
                              
                           
                           ≥
                           
                              
                                 1
                                 
                                    4
                                    
                                       q
                                       E
                                    
                                 
                              
                           
                        .

Since K
                        1 is a random oracle, the probability of the event
                           
                              
                                 
                                    c
                                    
                                       u
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    K
                                    1
                                 
                                 
                                    
                                       
                                          R
                                          u
                                       
                                       H
                                       
                                          
                                             
                                                I
                                                
                                                   D
                                                   u
                                                
                                             
                                          
                                          
                                             c
                                             u
                                          
                                       
                                       
                                          R
                                          o
                                       
                                       H
                                       
                                          
                                             
                                                I
                                                
                                                   D
                                                   o
                                                
                                             
                                          
                                          
                                             c
                                             o
                                          
                                       
                                       |
                                       |
                                       ID
                                       |
                                       |
                                       
                                          ID
                                          ˜
                                       
                                       |
                                       |
                                       I
                                       
                                          D
                                          u
                                       
                                       |
                                       |
                                       w
                                       |
                                       |
                                       m
                                       |
                                       |
                                       11
                                    
                                 
                              
                           
                        for 0≤
                        μ
                        ≤
                        z–1 is less than z2−l1, unless they are asked during the attack. Hence, it is likely that questions 
                           
                              
                                 
                                    R
                                    u
                                 
                                 H
                                 
                                    
                                       
                                          I
                                          
                                             D
                                             u
                                          
                                       
                                    
                                    
                                       c
                                       u
                                    
                                 
                                 
                                    R
                                    o
                                 
                                 H
                                 
                                    
                                       
                                          I
                                          
                                             D
                                             o
                                          
                                       
                                    
                                    
                                       c
                                       o
                                    
                                 
                                 |
                                 |
                                 ID
                                 |
                                 |
                                 
                                    ID
                                    ˜
                                 
                                 |
                                 |
                                 I
                                 
                                    D
                                    u
                                 
                                 |
                                 |
                                 w
                                 |
                                 |
                                 m
                                 |
                                 |
                                 11
                              
                           
                         for 0≤
                        μ
                        ≤
                        z-1 are asked during a successful attack. The lower bound of probability of producing a useful output after making queries to K
                        1 oracle is ϵ
                        2
                        ≥
                        ϵ
                        1–z2−l1.

It is assumed that ϒ denotes the set of successful executions of A
                           III
                        , and its success probability of B in returning a useful output after making query to K
                        1 is taken over the space (X,Y), where X is the set of random bits and random oracle responses that B takes up except for the randomness related to the oracle K
                        1, and Y is the set of random oracle responses to the oracle K
                        1. Hence, we have Pr[(X,Y)∈ϒ]=
                        ε
                        2. There is at least one index v ∈ (0, …, z-1) such that the query 
                           
                              Q
                              u
                           
                           =
                           
                              
                                 
                                    R
                                    v
                                 
                                 H
                                 
                                    
                                       
                                          I
                                          
                                             D
                                             v
                                          
                                       
                                    
                                    
                                       c
                                       v
                                    
                                 
                                 
                                    R
                                    o
                                 
                                 H
                                 
                                    
                                       
                                          I
                                          
                                             D
                                             o
                                          
                                       
                                    
                                    
                                       c
                                       o
                                    
                                 
                                 |
                                 |
                                 ID
                                 |
                                 |
                                 
                                    ID
                                    ˜
                                 
                                 |
                                 |
                                 I
                                 
                                    D
                                    v
                                 
                                 |
                                 |
                                 w
                                 |
                                 |
                                 m
                                 |
                                 |
                                 11
                              
                           
                         was made to the oracle K
                        1 before query 
                           
                              Q
                              v
                           
                           =
                           
                              
                                 
                                    R
                                    
                                       v
                                       −
                                       1
                                    
                                 
                                 H
                                 
                                    
                                       
                                          I
                                          
                                             D
                                             
                                                v
                                                −
                                                1
                                             
                                          
                                       
                                    
                                    
                                       c
                                       
                                          v
                                          −
                                          1
                                       
                                    
                                 
                                 
                                    R
                                    o
                                 
                                 H
                                 
                                    
                                       
                                          I
                                          
                                             D
                                             o
                                          
                                       
                                    
                                    
                                       c
                                       o
                                    
                                 
                                 |
                                 |
                                 ID
                                 |
                                 |
                                 
                                    ID
                                    ˜
                                 
                                 |
                                 |
                                 I
                                 
                                    D
                                    
                                       v
                                       −
                                       1
                                    
                                 
                                 |
                                 |
                                 w
                                 |
                                 |
                                 m
                                 |
                                 |
                                 11
                              
                           
                           .
                         The pair (u,v) is called a gap index. If there are more than one gap index for a forged proxy ring signature, only the pair with smallest value for u is considered.

The cardinality of the set ϒ
                        
                           u,v
                         as a subset of ϒ with gap index (u,v) is 
                           π
                           =
                           
                              
                                 
                                    
                                       q
                                       
                                          K
                                          1
                                       
                                       +
                                       
                                          q
                                          
                                             p
                                             r
                                             s
                                          
                                       
                                    
                                 
                                 
                                    
                                       q
                                       
                                          K
                                          1
                                       
                                       +
                                       
                                          q
                                          
                                             p
                                             r
                                             s
                                          
                                       
                                       +
                                       1
                                    
                                 
                              
                              2
                           
                        . This gives us a partition of ϒ in exactly π classes. Let I be the set of most likely gap indices, 
                           I
                           =
                           
                              
                                 
                                    u
                                    v
                                 
                                 
                                    
                                       Pr
                                       
                                          
                                             
                                                ϒ
                                                
                                                   u
                                                   ,
                                                   v
                                                
                                                ′
                                             
                                             
                                                ϒ
                                             
                                          
                                       
                                       ≥
                                       
                                          1
                                          2
                                       
                                       
                                          1
                                          π
                                       
                                    
                                 
                              
                           
                        . Hence, for each (u,v) ϵ I ϒ
                        
                           u,v
                         is denoted as ϒ
                        
                           u,v
                        , we have 
                           Pr
                           
                              
                                 ϒ
                                 
                                    u
                                    ,
                                    v
                                 
                                 ′
                              
                           
                           =
                           Pr
                           
                              
                                 
                                    ϒ
                                    
                                       u
                                       ,
                                       v
                                    
                                    ′
                                 
                                 
                                    ϒ
                                 
                              
                           
                           Pr
                           
                              ϒ
                           
                           ≥
                           
                              
                                 ϵ
                                 2
                              
                              
                                 2
                                 π
                              
                           
                        .

With Splitting Lemma, we split the randomness Y related to K
                        1 to (Y'cv
                        ), where Y' is the set of all random responses to different queries of K
                        1 except for query Qv
                         whose answer is denoted as cv
                        . This lemma ensures the existence of a subset Ω
                           u,v
                         of executions (X,Y) such that 
                           Pr
                           
                              
                                 
                                    
                                       Ω
                                       
                                          u
                                          ,
                                          v
                                       
                                    
                                 
                                 
                                    ϒ
                                    
                                       u
                                       ,
                                       v
                                    
                                    ′
                                 
                              
                           
                           ≥
                           
                              α
                              δ
                           
                           =
                           
                              1
                              2
                           
                         and for each 
                           
                              X
                              Y
                           
                           ∈
                           
                           
                              Ω
                              
                                 u
                                 ,
                                 v
                              
                           
                           ,
                           Pr
                           
                              c
                              v
                              ′
                           
                           
                              
                                 
                                    ω
                                    
                                       
                                          ρ
                                          ′
                                       
                                       
                                          c
                                          v
                                          ′
                                       
                                    
                                 
                                 ∈
                                 
                                    ϒ
                                    
                                       u
                                       ,
                                       v
                                    
                                    ′
                                 
                              
                           
                           ≥
                           δ
                           −
                           a
                           =
                           
                              
                                 ϵ
                                 2
                              
                              
                                 4
                                 π
                              
                           
                           .
                        
                     

Since ϒ
                        
                           u,v
                        ′ are disjoint, and we have 
                           
                              
                                 
                                    
                                       Pr
                                       
                                          X
                                          Y
                                       
                                    
                                    
                                       
                                          ∃
                                          
                                             u
                                             v
                                          
                                          ∈
                                          I
                                          
                                          s
                                          .
                                          t
                                          .
                                          
                                          
                                             Ω
                                             
                                                u
                                                ,
                                                v
                                             
                                          
                                          ∩
                                          
                                             ϒ
                                             
                                                u
                                                ,
                                                v
                                             
                                             ′
                                          
                                          
                                             ϒ
                                          
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             
                                                u
                                                v
                                             
                                             ∈
                                             I
                                          
                                       
                                       
                                          Pr
                                          
                                             
                                                
                                                   Ω
                                                   
                                                      u
                                                      ,
                                                      v
                                                   
                                                
                                                ∩
                                                
                                                   Ω
                                                   
                                                      u
                                                      ,
                                                      v
                                                   
                                                
                                                ∩
                                                
                                                   ϒ
                                                   
                                                      u
                                                      ,
                                                      v
                                                   
                                                   ′
                                                
                                                
                                                   ϒ
                                                
                                             
                                          
                                          =
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          ∑
                                          
                                             
                                                u
                                                v
                                             
                                             ∈
                                             I
                                          
                                       
                                       
                                          Pr
                                          
                                             
                                                
                                                   Ω
                                                   
                                                      u
                                                      ,
                                                      v
                                                   
                                                
                                                
                                                   ϒ
                                                   
                                                      u
                                                      ,
                                                      v
                                                   
                                                   ′
                                                
                                             
                                          
                                          Pr
                                          
                                             
                                                
                                                   ϒ
                                                   
                                                      u
                                                      ,
                                                      v
                                                   
                                                   ′
                                                
                                                
                                                   ϒ
                                                
                                             
                                          
                                          ≥
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         
                                                            u
                                                            v
                                                         
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      Pr
                                                      
                                                         
                                                            
                                                               ϒ
                                                               
                                                                  u
                                                                  ,
                                                                  v
                                                               
                                                               ′
                                                            
                                                            
                                                               ϒ
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             2
                                          
                                       
                                    
                                    ≥
                                    
                                       1
                                       4
                                    
                                    .
                                 
                              
                           
                         Therefore, with probability at least 
                           
                              1
                              4
                           
                        , (u,v) ϵ I and (X,Y) ∈Ω
                           u,v
                        
                        ∩
                        ϒ
                        
                           u,v
                        ′. If we replay the attack with fixed (X,Y') and a randomly chosen c
                        
                           v
                        ′, we get another successful pair (X,(Y′,
                        c
                        
                           v
                        ′)) such that c
                        
                           v
                        
                        ≠
                        c
                        
                           v
                        ′ with probability 
                           
                              
                                 ε
                                 2
                                 
                                    
                                       1
                                       −
                                       
                                          2
                                          
                                             −
                                             
                                                l
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 4
                                 π
                              
                           
                        .

Hence, after two successful executions of AIII
                        , the algorithm B obtains ((X,
                        Y′),
                        c
                        
                           v
                        ) and ((X,
                        Y′),
                        c
                        
                           v
                        ′) with probability 
                           
                              ϵ
                              ′
                           
                           ≥
                           
                              
                                 
                                    ϵ
                                    2
                                    2
                                 
                                 
                                    
                                       1
                                       −
                                       
                                          2
                                          
                                             −
                                             l
                                             1
                                          
                                       
                                    
                                 
                              
                              
                                 16
                                 π
                              
                           
                        , where 
                           π
                           =
                           
                              
                                 
                                    
                                       q
                                       
                                          K
                                          1
                                       
                                       +
                                       
                                          q
                                          
                                             p
                                             r
                                             s
                                          
                                       
                                    
                                 
                                 
                                    
                                       q
                                       
                                          K
                                          1
                                       
                                       +
                                       
                                          q
                                          
                                             p
                                             r
                                             s
                                          
                                       
                                       +
                                       1
                                    
                                 
                              
                              2
                           
                        , which means that B obtains a useful pair (R
                        
                           o
                        ,
                        r
                        0′…,
                        r
                        
                           z
                           ′
                           −1,
                        c
                        0′,{x
                        
                           u
                        }0≤
                        u
                        ≤
                        
                           z
                           −1,
                        x
                        
                           o
                        ,
                        m,
                        ω) and (R
                        
                           o
                        ,
                        r
                        0′…,
                        r
                        
                           z
                           ′
                           −1,
                        c
                        0′,{x
                        
                           u
                        }0≤
                        u
                        ≤
                        z
                        −1,
                        x
                        
                           o
                        ,
                        m,
                        ω). Since the query 
                           
                              Q
                              u
                           
                           =
                           
                              
                                 
                                    R
                                    v
                                 
                                 H
                                 
                                    
                                       
                                          I
                                          
                                             D
                                             v
                                          
                                       
                                    
                                    
                                       c
                                       v
                                    
                                 
                                 
                                    R
                                    o
                                 
                                 H
                                 
                                    
                                       
                                          I
                                          
                                             D
                                             o
                                          
                                       
                                    
                                    
                                       c
                                       o
                                    
                                 
                                 |
                                 |
                                 ID
                                 |
                                 |
                                 
                                    ID
                                    ˜
                                 
                                 |
                                 |
                                 I
                                 
                                    D
                                    v
                                 
                                 |
                                 |
                                 w
                                 |
                                 |
                                 m
                                 |
                                 |
                                 11
                              
                           
                         was made to the oracle K
                        1 before query 
                           
                              Q
                              v
                           
                           =
                           
                              
                                 
                                    R
                                    
                                       v
                                       −
                                       1
                                    
                                 
                                 H
                                 
                                    
                                       
                                          I
                                          
                                             D
                                             
                                                v
                                                −
                                                1
                                             
                                          
                                       
                                    
                                    
                                       c
                                       v
                                    
                                 
                                 
                                    R
                                    o
                                 
                                 H
                                 
                                    
                                       
                                          I
                                          
                                             D
                                             o
                                          
                                       
                                    
                                    
                                       c
                                       o
                                    
                                 
                                 |
                                 |
                                 ID
                                 |
                                 |
                                 
                                    ID
                                    ˜
                                 
                                 |
                                 |
                                 I
                                 
                                    D
                                    
                                       v
                                       −
                                       1
                                    
                                 
                                 |
                                 |
                                 w
                                 |
                                 |
                                 m
                                 |
                                 |
                                 11
                              
                           
                        , we have
                           
                              
                                 
                                    R
                                    
                                       v
                                       −
                                       1
                                    
                                 
                                 H
                                 
                                    
                                       
                                          I
                                          
                                             D
                                             
                                                v
                                                −
                                                1
                                             
                                          
                                       
                                    
                                    
                                       c
                                       v
                                    
                                 
                                 
                                    R
                                    o
                                 
                                 H
                                 
                                    
                                       
                                          I
                                          
                                             D
                                             o
                                          
                                       
                                    
                                    
                                       c
                                       o
                                    
                                 
                                 =
                                 
                                    R
                                    
                                       v
                                    
                                    ′
                                 
                                 H
                                 
                                    
                                       
                                          I
                                          
                                             D
                                             
                                                v
                                                −
                                                1
                                             
                                          
                                       
                                    
                                    
                                       c
                                       v
                                       ′
                                    
                                 
                                 
                                    R
                                    o
                                 
                                 H
                                 
                                    
                                       
                                          I
                                          
                                             D
                                             o
                                          
                                       
                                    
                                    
                                       c
                                       o
                                    
                                 
                                 ,
                              
                           
                        where c
                        
                           v
                        
                        ≠
                        c
                        
                           v
                        ′ and R
                        
                           v
                        
                        =
                        r
                        
                           v
                        
                        
                           e
                        .

With rearranging the above equation, we obtain 
                           
                              
                                 
                                    
                                       x
                                       v
                                       
                                          
                                             c
                                             v
                                          
                                          −
                                          
                                             c
                                             v
                                             ′
                                          
                                       
                                    
                                    
                                       
                                          r
                                          v
                                       
                                       
                                          r
                                          v
                                          ′
                                       
                                    
                                 
                              
                              e
                           
                           =
                           
                              y
                              
                                 
                                    
                                       c
                                       v
                                       ′
                                    
                                    −
                                    
                                       c
                                       v
                                    
                                 
                              
                           
                           mod
                           N
                        .

Since c
                        
                           v
                        
                        ≠
                        c
                        
                           v
                        ′∈{0,1}
                           l1 and e is a prime of length strictly greater than l
                        1, we have e
                        >(c
                        
                           v
                        ′−
                        c
                        
                           v
                        ) and therefore gcd(e,(c
                        
                           v
                        ′−
                        c
                        
                           v
                        ))=1. Using the extended Euclidean algorithm, one can find a, b ∈ ℤ such that ae
                        +
                        b(c
                        
                           v
                        ′−
                        c
                        
                           v
                        )=1. Hence, we have 
                           y
                           =
                           
                              y
                              
                                 a
                                 e
                                 +
                                 b
                                 
                                    
                                       
                                          c
                                          v
                                          ′
                                       
                                       −
                                       
                                          c
                                          v
                                       
                                    
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       y
                                       a
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   v
                                                
                                                
                                                   
                                                      c
                                                      v
                                                   
                                                   −
                                                   
                                                      c
                                                      v
                                                      ′
                                                   
                                                
                                             
                                             
                                                
                                                   r
                                                   v
                                                
                                                
                                                   r
                                                   v
                                                   ′
                                                
                                             
                                          
                                       
                                       b
                                    
                                 
                              
                              e
                           
                         mod N. Therefore, algorithm B can output 
                           
                              
                                 
                                    y
                                    a
                                 
                                 
                                    
                                       
                                          
                                             
                                                x
                                                v
                                             
                                             
                                                
                                                   c
                                                   v
                                                
                                                −
                                                
                                                   c
                                                   v
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                r
                                                v
                                             
                                             
                                                r
                                                v
                                                ′
                                             
                                          
                                       
                                    
                                    b
                                 
                              
                           
                         as the RSA inversion of y with probability ϵ'.

Algorithm B's run-time t' is twice of AIII
                        's run-time, t, plus the time required to respond to hash queries, qE
                         KeyExtract and qprs
                         ProxyRingSign queries. To estimate the required time of signature simulation, it is assumed that a (multi-) exponentiation in ℤN
                         takes te
                         time, while all other operations take zero time. Since each random oracle H or KeyExtract query takes at most one exponentiation, a ProxyRingSign simulation takes (2z
                        +1) exponentiations, B's run-time is t′≤2(t
                        +
                        qH
                        +
                        qE
                        +(2z
                        +1)q
                        
                           prs
                        )t
                        
                           e
                        . This completes the proof.
                           Theorem 3
                           
                              The identity-based proxy ring signature scheme is 
                              
                                 
                                    
                                       t
                                       ,
                                       
                                          q
                                          H
                                       
                                       ,
                                       q
                                       
                                          K
                                          0
                                       
                                       ,
                                       q
                                       
                                          K
                                          1
                                       
                                       ,
                                       q
                                       E
                                       ,
                                       
                                          q
                                          d
                                       
                                       ,
                                       
                                          q
                                          
                                             p
                                             r
                                             s
                                          
                                       
                                       ,
                                       
                                          1
                                          2
                                       
                                    
                                 
                              
                              -PPSI-secure since the probability of D in guessing the identity of the proxy signer for a given signature θ, Pr[D(θ)=
                              IDj] (where 
                              
                                 I
                                 
                                    D
                                    j
                                 
                                 ∈
                                 
                                    ID
                                    ˜
                                 
                                 =
                                 
                                    
                                       I
                                       
                                          D
                                          0
                                       
                                       ,
                                       I
                                       
                                          D
                                          1
                                       
                                    
                                 
                              
                              ), is 
                              
                                 
                                    1
                                    2
                                 
                               
                              against (t,
                              q
                              
                                 H
                              ,
                              qK
                              0,
                              qK
                              1,
                              qE,
                              q
                              
                                 d
                              ,
                              q
                              
                                 prs
                              ,ϵ)-bounded adversary D.
                           

The distinguisher D issues a polynomially bounded number of random oracle, KeyExtract, DelegationGen and ProxyRingSign queries adaptively as explained in the proof of Theorems 1 and 2.

Then, D chooses two honest identities ID
                        0 and ID
                        1 for proxy ring (D never make KeyExtract query for these two identities), and makes a DelegationGen and ProxyRingSign query on (ω,ID) under an identity ID
                        0 and on the message IDo
                         under the identity set m ϵ w, respectively. In response, C chooses 
                           j
                           
                              ←
                              $
                           
                           
                              0
                              1
                           
                        , runs DelegationGen on (w,ID) under an identity ID
                        0 to obtain σo
                         and returns 
                           θ
                           ←
                           ProxyRingSign
                           
                              
                                 Para
                                 ,
                                 
                                 m
                                 p
                                 k
                                 ,
                                 
                                 I
                                 
                                    D
                                    o
                                 
                                 ,
                                 ID
                                 ,
                                 
                                    ID
                                    ˜
                                 
                                 ,
                                 
                                    w
                                    m
                                    
                                       σ
                                       o
                                    
                                 
                                 ,
                                 
                                    x
                                    j
                                 
                              
                           
                         to D. Finally, the distinguisher D outputs j′=
                        j with probability 
                           
                              1
                              2
                           
                        . To show the value of this probability, we compute the probability that IDj
                         generates valid values for R
                        0 and R
                        1 of θ which are pairwise different. The probability of choosing different values for R
                        0 and R
                        1 is 
                           
                              1
                              
                                 
                                    2
                                    l
                                 
                                 N
                              
                           
                           
                              1
                              
                                 
                                    2
                                    l
                                 
                                 N
                              
                           
                        . Then, θ is computed from random numbers ru
                         for u
                        ≠
                        j in Ru
                         and r employed in Rj
                        . The probability of generation of the proxy ring signature θ
                        =(R
                        
                           o
                        ,
                        r
                        
                           o
                        ,
                        r
                        1,
                        c
                        
                           o
                        ) is independent from the identity of the real signer IDj
                        , then, this probability is the same for two members in the set of proxy signers. Therefore, the probability of D in guessing the real signer is 
                           
                              1
                              2
                           
                        .

Although our scheme is the first short identity-based proxy ring signature which is efficient (due to the not relying on bilinear pairings), it is proved secure in the random oracle model. In fact, an identity-based proxy ring signature without bilinear pairings is sequential aggregation of an identity-based standard signature without bilinear pairings (a non-interactive proof of knowledge of the secret key of an original signer) and an identity-based ring signature without bilinear pairings (a non-interactive proof of knowledge of the secret key of one of the proxy signers in the proxy ring). On the other hand, to the best of our knowledge, Fiat–Shamir heuristic is used to implement a non-interactive proof of knowledge, and therefore its security relies on the randomness of the underlying hash function. So far there is no scheme for identity-based proxy ring signatures without bilinear pairings with provable security in the standard model, and hence this leads to the difficulty of achieving identity-based proxy ring signatures without bilinear pairings in the standard model, which is an interesting future research problem.

The comparison for some provably secure (identity-based) proxy ring signature schemes is summarized in Table 1
                     . The comparison is in terms of DeleGen-Cost, DeleVer-Cost, PRSign-Cost and PRVer-Cost, dominating computational cost in delegation generation, delegation verification, proxy ring signature generation and proxy ring signature verification, respectively. In Table 1, exp denotes exponentiation in Z
                     
                        N
                     
                     ⁎. For the sake of comparison, it is assumed that other operations take zero time and z
                     =
                     n which means that 
                        
                           ID
                           ˜
                        
                        =
                        ID
                     .

Since previous identity-based proxy ring signature schemes ([20–22,19,23–26]) do not support provable security, they are not considered in comparison. As shown in Table 1, our scheme compared to Asaar et al.'s provably secure proxy ring signature scheme [27] has a proper advantage in signature-size. In a nutshell, since l
                     1
                     ≪|ℤ
                     
                        N
                     | (for example, l
                     1 is about 160bits, while (|ℤ
                     
                        N
                     |=1024), the signature-size is improved by a factor |ℤ
                     
                        N
                     |−
                     l
                     1. On the one hand, since the probability of solving the RSA problem as shown in Theorem 2 is nearly 
                        
                           
                              ϵ
                              2
                           
                           
                              
                                 
                                    q
                                    
                                       K
                                       1
                                    
                                    +
                                    
                                       q
                                       
                                          p
                                          r
                                          s
                                       
                                    
                                 
                              
                              2
                           
                        
                        ,
                      and so is independent of the number of proxy signers.

On the other hand, the probability of solving the RSA problem is approximately 
                        
                           
                              ϵ
                              2
                           
                           
                              
                                 
                                    q
                                    
                                       K
                                       1
                                    
                                    +
                                    
                                       q
                                       
                                          p
                                          r
                                          s
                                       
                                    
                                 
                              
                              n
                           
                        
                        ,
                      as shown in [27], so it is a function of the number of proxy signers in a proxy ring, n. Therefore, the security reduction is improved.

Furthermore, since the total number of exponentiations in proxy ring signature generation and verification for the two schemes are the same, the new scheme is as efficient as the old one.

In this paper, we proposed a provably secure proxy ring signature scheme from RSA assumption. This scheme is the first short one for this type of signature from RSA. In addition, the security reduction of the proposal has been improved compared to the ones from RSA since it is independent of the number of proxy signers in the proxy ring. We should highlight that the proposed scheme has a proper advantage in efficiency due to the avoiding pairing computations since the cost of each pairing computation is roughly that of 2.3 exponentiations. Furthermore, the proxy key exposure attack is not applicable to our scheme since it is generated based on sequential aggregation paradigm.

Although our scheme is the first short identity-based proxy ring signature scheme which is efficient (due to the not relying on bilinear pairings), it is proved secure in the random oracle model. According to Section 4, there is no identity-based proxy ring signature scheme without bilinear pairing with provable security in the standard model. As a result, presenting an identity-based proxy ring signature scheme from traditional assumptions such as RSA and discrete logarithm with provable security in the standard model is an open problem, and proposing a scheme with the aforementioned features will be considered as a future work.

@&#REFERENCES@&#

