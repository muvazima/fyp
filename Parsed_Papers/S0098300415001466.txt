@&#MAIN-TITLE@&#A Matlab© toolbox for calculating spring indices from daily meteorological data

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Spring indices can be used to characterize spring onset across a wide range of spatial scales.


                        
                        
                           
                           These indices are based on phenological models, but can be computed from meteorological data.


                        
                        
                           
                           We present software and documentation for calculating spring indices.


                        
                        
                           
                           Some basic examples of the potential uses and extensions of the spring indices are also shown.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Global climate change

Climate variability

Phenology

@&#ABSTRACT@&#


               
                  Graphical abstract
                  
                     
                        
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

Understanding the impacts of global climate change on ecosystems requires systematic development and use of metrics to track seasonal transitions clearly and consistently across broad spatial scales and through time. Phenology – the study of seasonally recurrent biological events and their relation to climate – can help to guide the development of such metrics because many phenological events are sensitive to variations of weather and climate (Lieth, 1974). Accordingly, worldwide efforts to collect, monitor, and synthesize phenological data offer a unique perspective on how global climate change is affecting organisms across a wide range of spatial scales (Vliet et al., 2003; IPCC, 2007; Janetos et al., 2012; Schwartz et al., 2012). Although in the past phenological observations were collected by individual observers at relatively small scales, developments in information and communication technologies are presenting new opportunities for overcoming these historical limitations. Today phenological data collection is “crowd-sourced” to the general public (Vliet et al., 2003; Schwartz et al., 2012), and observed from space (e.g., White et al., 2009; Zurita-Milla et al., 2013). As these networks of volunteers and remote sensing operations grow in scale and scope, interpretation of the sheer volume of data will be greatly improved if it can be readily compared with clearly defined markers of seasonal evolution.

The spring indices (SI) “suite of metrics” (Schwartz et al., 2006) are a prominent example of phenological indices that have been widely used to characterize the transition from winter into spring in a clear and consistent way across continental scales and through time. These metrics include indices of “first leaf” and “first bloom,” as well as “last freeze” and the “damage index,” which records the anomalous amount of time from the appearance of foliage to the last freeze (e.g., Schwartz and Marotz, 1986, 1988; Schwartz, 1999; Schwartz and Reiter, 2000; Schwartz et al., 2006, 2013). Here, we present a 
                        
                           
                              MATLAB
                           
                           
                              ©
                           
                        
                      toolbox called ml_si that calculates the most recent version of SI, which were originally developed by M.D. Schwartz almost 25 years ago. This toolbox consists of six core functions to calculate spring indices from daily values of temperature minima (T
                     
                        min
                     ) and maxima (T
                     
                        max
                     ) from any arbitrary location in the Northern Hemisphere. The toolbox is distributed as a single zipped tarball through the “
                        
                           
                              MATLAB
                           
                           
                              ©
                           
                        
                      Central” file exchange (http://www.mathworks.com/matlabcentral/fileexchange/), and also as Supplementary material to this document. It will be updated periodically as new versions are released to extend its functionality.

In the 1950s Joe Caprio of Montana State University initiated a program to monitor the phenological responses of Lilac (Syringa vulgaris) with the aid of a large network of volunteers (e.g., Schwartz and Reiter, 2000; Cayan et al., 2001; Schwartz et al., 2012). At its peak, the network consisted of several hundred citizen scientists making observations across 12 western states. The project lasted more than 40 years, and even today, certain elements of these early efforts continue to be supported by the USA National Phenological Network (USA-NPN: http://www.usanpn.org/), which also coordinates large scale monitoring projects of a much wider diversity of plant and animal species (Schwartz et al., 2012).

Similar observations to those in the Caprio network were also made in the Eastern US, and this continental-scale coverage of phenological data over several decades allowed Schwartz (1985) to develop models of Lilac (Syringa) and Honeysuckle (Lonicera) phenology using observed meteorological variables (minimum and maximum temperatures, in this case). These models were optimized for use at continental-scales, meaning that they reliably indicate the same event (e.g., first leaf) whether they are calculated from meteorological data in Arizona or British Columbia. Such consistency has allowed for the spring indices to be used for a variety of applications, including characterizing the impacts of global change (Schwartz et al., 2006), interpreting satellite observations of land-surface phenology (White et al., 2009), and understanding interannual variations in spring onset and its impacts (Ault et al., 2011; McCabe et al., 2011; Schwartz et al., 2013; Ault et al., 2013; Peterson and Abatzoglou, 2014).

Translating daily temperature fluctuations into indices of spring onset is motivated by two features of this seasonal transition. First, variations in the timing of many phenological events vary considerably on interannual timescales, meaning that the day of year when spring foliage first appears on a given plant typically differs from one year to the next. Second, the start of the growing season for many species occurs coherently across large spatial scales. Taken together, these two attributes of spring onset motivate a climate-oriented (as opposed to plant-oriented) approach to characterizing spring onset: interannual variations by themselves could be explained by assuming that the timing of plant events is stochastic, while large-scale correlations could arise from deterministic elements of the environment (e.g., the length of the day). From a climatic perspective, however, these two features are interpreted as the hallmark of weather variations on interannual timescales, which are themselves correlated across large spatial scales. This “climate-centric” perspective on spring onset is the starting point for the spring indices.

To translate meteorological data (T
                        
                           min
                         and T
                        
                           max
                        ) into indices that track the timing of spring in a consistent way through time and across large spatial scales, the calculation of the SI makes the following assumptions, which are valid for most temperate regions:
                           
                              1.
                              Phenological observations from a few key indicator species can be used to characterize spring onset in a way that is relevant to a wide range of ecological and climatic transitions at the start of spring.

Where moisture availability is not a factor, plant phenological responses reflect the accumulated effects of temperature fluctuations in conjunction with increasing day length.

Near surface temperatures in temperate regions do not increase monotonically during springtime, but instead fluctuate as a consequence of large-scale (e.g., 
                                    ∽
                                    1000
                                  km) physical processes. These phenomena are typically synoptic-scale weather patterns that drive multi-day warm episodes by advecting warm air masses in from the south.

Synoptic-scale weather events can be detected from meteorological observations of daily T
                                 
                                    min
                                  and T
                                 
                                    max
                                 .

@&#METHODS@&#

The models underpinning SI are based upon linear relationships between phenological events and meteorological variables. That is, suppose a given event (e.g., first leaf) for a given plant (say lilac) has been observed at n stations for q years. Pooling the years and the stations together gives us 
                           k
                           =
                           n
                           ⁎
                           q
                         total observations of this event (
                           
                              
                                 
                                    Y
                                 
                                 
                                    k
                                 
                              
                           
                        ) for a single species of plant across space and through time. Each entry of 
                           
                              
                                 
                                    Y
                                 
                                 
                                    k
                                 
                              
                           
                         is the day of the phenological event of interest, rendered as an integer enumerating the “day of the year” (DOY) from January first (DOY=1) onward. To model this event, we next consider a matrix 
                           
                              
                                 
                                    X
                                 
                                 
                                    m
                                    ,
                                    k
                                 
                              
                           
                         of M potential predictor variables (e.g., temperature, growing degree accumulations, day length, etc.) that are also be obtained from the k observations of the event of interest. A standard linear regression model might simply relate the 
                           
                              
                                 
                                    Y
                                 
                                 
                                    k
                                 
                              
                           
                         dependent variables to the 
                           
                              
                                 
                                    X
                                 
                                 
                                    m
                                    ,
                                    k
                                 
                              
                           
                         predictors as
                           
                              (1)
                              
                                 Y
                                 =
                                 XA
                              
                           
                        where 
                           
                              
                                 
                                    A
                                 
                                 
                                    m
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    M
                                 
                              
                           
                         is a vector of the M coefficients for each predictor variable in X and the subscripts have been dropped. Such a formulation is not suitable for our purposes, however, because different values of the predictors (X) will correspond to the same values of the predictands (Y), because the same phenological events may occur at the same temperature thresholds but at different times of the year. For example, “first leaf” might occur corresponding to a growing degree hour accumulation of 600. At station I, this accumulation might be reached on day 100, whereas at station J it might occur on day 110 (Schwartz, 1985). A regression model of the form above would necessarily predict different phenological dates for different values of X, leading to erroneous differences between observations and predictions at stations I and J, even if the underlying regression were perfect.

To circumvent the limitation above, the inverse day of year values (
                           
                              
                                 date
                              
                              
                                 −
                                 1
                              
                           
                        ) of each element in Y are used as the predictands, so that the kth element of the target 
                           
                              
                                 Y
                              
                              
                                 ′
                              
                           
                         is defined as 
                           
                              
                                 
                                    Y
                                 
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                           
                           =
                           1
                           /
                           (
                           
                              
                                 
                                    Y
                                 
                                 
                                    k
                                 
                              
                           
                           )
                         (Schwartz, 1985). Each of the predictor variables in X that are a function of the day of the year is also divided by the corresponding Y
                        
                           k
                         dates so that 
                           
                              
                                 
                                    X
                                 
                                 
                                    k
                                    ,
                                    m
                                 
                                 
                                    ′
                                 
                              
                           
                           =
                           
                              
                                 
                                    X
                                 
                                 
                                    k
                                    ,
                                    m
                                 
                              
                           
                           /
                           
                              
                                 
                                    Y
                                 
                                 
                                    k
                                 
                              
                           
                        . This yields a regression of the form
                           
                              (2)
                              
                                 
                                    
                                       Y
                                    
                                    
                                       ′
                                    
                                 
                                 ⁎
                                 1000
                                 =
                                 
                                    
                                       
                                          A
                                       
                                       
                                          0
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          X
                                       
                                       
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       
                                          X
                                       
                                       
                                          m
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                           
                        where the value 1000 is an arbitrary constant (chosen as a four digit integer to minimize roundoff error for historical reasons), A
                        0 is a regression constant, and 
                           
                              
                                 
                                    X
                                 
                                 
                                    1
                                    ,
                                    …
                                    ,
                                    M
                                 
                                 
                                    ′
                                 
                              
                           
                         are the vectors of predictor variables at the time of the phenological event normalized by event date. An additional advantage of this formulation is that dividing the predictors by their corresponding phenological date prevents larger predictor values, corresponding to later dates but associated with the same events, from unduly biasing the regression.

Once the 
                           
                              
                                 
                                    A
                                 
                                 
                                    0
                                    ,
                                    …
                                    ,
                                    M
                                 
                              
                           
                         coefficients have been estimated for each plant for each event, Eq. (2) can be used operationally by multiplying through by the actual date (t). Note that this step recovers the original X predictor variables as they evolve through time, allowing us to calculate a quantity we will term 
                           
                              
                                 C
                              
                              
                                 ^
                              
                           
                           (
                           t
                           )
                        . This quantity will increase through time and reach a constant value (1000) at the predicted day of year for each event for each plant:
                           
                              (3)
                              
                                 
                                    
                                       C
                                    
                                    
                                       ^
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 (
                                 
                                    
                                       
                                          A
                                       
                                       
                                          0
                                       
                                    
                                 
                                 )
                                 t
                                 +
                                 
                                    
                                       
                                          X
                                       
                                       
                                          1
                                       
                                    
                                 
                                 (
                                 t
                                 )
                                 
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       
                                          X
                                       
                                       
                                          m
                                       
                                    
                                 
                                 (
                                 t
                                 )
                                 
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                 
                                 ,
                                 
                                 0
                                 ≤
                                 t
                                 ≤
                                 T
                                 .
                              
                           
                        
                     

The date of a given phenological event for a given plant is then predicted if 
                           
                              
                                 C
                              
                              
                                 ^
                              
                           
                           (
                           t
                           )
                         is greater than 1000. In this way, the SI resemble traditional heat accumulation models because 
                           
                              
                                 C
                              
                              
                                 ^
                              
                           
                           (
                           t
                           )
                         grows with time until the prediction date of a given event is achieved. In order to express multiple equations for the same event occurring in different plants in the form of (3), we combine the accumulation models in matrix notation
                           
                              (4)
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                      ,
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                          
                                             ⋱
                                          
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                   
                                                   
                                                      t
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                   
                                                   
                                                      t
                                                      ,
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                                 =
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                      ,
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                          
                                             ⋱
                                          
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                      ,
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      t
                                                      ,
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      1
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      1
                                                      ,
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                          
                                             ⋱
                                          
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      1
                                                      ,
                                                      m
                                                   
                                                
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      m
                                                      ,
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                                 ,
                              
                           
                        where the first column in the matrix on the left hand side is just the day of the year (t), and the first row in the second matrix is composed of each regression constant from each plant. The matrix 
                           C
                         is defined as having columns that are outputs from each of the accumulation models for each event/plant target, and rows (
                           t
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           T
                        ) that are the values of those accumulation models at each time (days in this case). The next step is to identify the date on which each of the accumulation models is greater than 1000, and assign that (raw) date to the vector 
                           
                              
                                 
                                    S
                                 
                                 
                                    p
                                 
                                 
                                    ′
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             if
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                   
                                                   
                                                      tp
                                                   
                                                
                                             
                                             ≥
                                             C
                                          
                                       
                                       
                                          
                                             undefined
                                          
                                          
                                             otherwise.
                                          
                                       
                                    
                                 
                                 for
                                 
                                 p
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 N
                                 ;
                                 
                                 and
                                 
                                 t
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 T
                                 .
                              
                           
                        
                     

For a given event, in this case “first leaf” and “first bloom,” at a given location during a given year, the spring indices of those events are simply defined as the average value of 
                           
                              
                                 
                                    S
                                 
                                 
                                    p
                                 
                                 
                                    ′
                                 
                              
                           
                        .

Here we define the M predictors comprising X and the coefficients A for each plant type and event. Stepwise linear regression was used to select the predictors in X and estimate the A coefficients. As all stations from all years are pooled, the regression is tailored for continental-scale phenological monitoring. Importantly, not all predictors were required to model all phenological events/plants. For clarity, we will use the subscripts “lf” and “bl” to refer to the equations for the first leaf and first bloom indices, respectively.

The following table describes the predictors used by, e.g., Schwartz et al. (2006) for the leaf index (
                           
                              
                                 
                                    X
                                 
                                 
                                    lf
                                 
                              
                           
                        ): 
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          Predictor abbreviation
                                       
                                       
                                          Description
                                       
                                    
                                 
                                 
                                    
                                       MDS0
                                       Days since January 1
                                    
                                    
                                       SYNOP
                                       Number of high-energy synoptic events
                                    
                                    
                                       DD57
                                       5–7 day degree-hour accumulations
                                    
                                    
                                       DDE2
                                       0–2 day degree-hour accumulations
                                    
                                 
                              
                           
                        
                     

The values of SYNOP, DD57 and DDE2 are defined as follows (again, for the leaf index):
                           
                              (6)
                              
                                 SYNOP
                                 (
                                 t
                                 )
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             0
                                          
                                          
                                             if
                                             
                                             t
                                             =
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             SYNOP
                                             (
                                             t
                                             −
                                             1
                                             )
                                             +
                                             1
                                          
                                          
                                             if
                                             
                                             DDE
                                             2
                                             ≥
                                             637
                                          
                                       
                                       
                                          
                                             SYNOP
                                             (
                                             t
                                             −
                                             1
                                             )
                                          
                                          
                                             otherwise
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 DDE
                                 2
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       0
                                    
                                    
                                       2
                                    
                                 
                                 GDH
                                 (
                                 t
                                 −
                                 l
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (8)
                              
                                 DD
                                 57
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       5
                                    
                                    
                                       7
                                    
                                 
                                 GDH
                                 (
                                 t
                                 −
                                 l
                                 )
                                 ,
                              
                           
                        where t again is used as a temporal index of days from January 1 onward (
                           t
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           T
                           ,
                        ). The quantity GDH is a vector of growing degree hours determined by first modeling hourly temperature (D
                        
                           temp
                        (h)) from daily 
                           
                              
                                 
                                    T
                                 
                                 
                                    min
                                 
                              
                           
                         and 
                           
                              
                                 
                                    T
                                 
                                 
                                    max
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          temp
                                       
                                    
                                 
                                 (
                                 h
                                 )
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      max
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      min
                                                   
                                                
                                             
                                             )
                                             sin
                                             (
                                             
                                                
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         L
                                                         +
                                                         4
                                                      
                                                   
                                                
                                                h
                                             
                                             )
                                             +
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      min
                                                   
                                                
                                             
                                          
                                          
                                             for
                                             
                                             h
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   L
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               T
                                                            
                                                            
                                                               min
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      log
                                                      (
                                                      24
                                                      −
                                                      L
                                                      )
                                                      )
                                                      ⁎
                                                      log
                                                      (
                                                      h
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             for
                                             
                                             h
                                             =
                                             
                                                
                                                   L
                                                
                                                
                                                   ′
                                                
                                             
                                             +
                                             1
                                             ,
                                             …
                                             ,
                                             24
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        where L is the length of the day (in hours) and 
                           
                              
                                 L
                              
                              
                                 ′
                              
                           
                         the nearest integer value of L. The term D
                        
                           s
                        , the temperature at sunset, is given by 
                           
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          s
                                       
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       
                                          T
                                       
                                       
                                          max
                                       
                                    
                                 
                                 −
                                 
                                    
                                       
                                          T
                                       
                                       
                                          min
                                       
                                    
                                 
                                 )
                                 sin
                                 (
                                 
                                    
                                       
                                          π
                                       
                                       
                                          L
                                          +
                                          4
                                       
                                    
                                    L
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          T
                                       
                                       
                                          min
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

This formulation assumes a sinusoidal temperature curve during the day that begins at T
                        
                           min
                         just before sunrise and attains a maximum value of T
                        
                           max
                        . Temperatures after sunset are modeled as a logarithmic decay. An illustration of this method for modeling daily temperature evolution is shown in Fig. 1
                        .

The growing degree hours are therefore given as
                           
                              (10)
                              
                                 GDH
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       =
                                       
                                          
                                             h
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       h
                                       ″
                                    
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          temp
                                       
                                    
                                 
                                 (
                                 h
                                 )
                                 .
                              
                           
                        
                     

Where the quantities 
                           
                              
                                 h
                              
                              
                                 ′
                              
                           
                         and 
                           h
                           ″
                         are the first and last hours above the base temperature threshold (31°F/−0.5556°C).

We are now prepared to define the matrix 
                           
                              
                                 
                                    A
                                 
                                 
                                    lf
                                 
                              
                           
                         of predictor coefficients in Eq. (4) for the three plants used in the leaf index:
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                          MDS
                                          0
                                          
                                          SYNOP
                                          
                                          DDE
                                          2
                                          
                                          DD
                                          57
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   lf
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   Lilac
                                                
                                             
                                             
                                                
                                                   Arnold
                                                   
                                                   Red
                                                
                                             
                                             
                                                
                                                   Zabeli
                                                
                                             
                                          
                                          [
                                          
                                             
                                                
                                                   
                                                      3.306
                                                   
                                                   
                                                      13.878
                                                   
                                                   
                                                      0.201
                                                   
                                                   
                                                      0.153
                                                   
                                                
                                                
                                                   
                                                      4.266
                                                   
                                                   
                                                      20.899
                                                   
                                                   
                                                      0.00
                                                   
                                                   
                                                      0.248
                                                   
                                                
                                                
                                                   
                                                      2.802
                                                   
                                                   
                                                      21.433
                                                   
                                                   
                                                      0.266
                                                   
                                                   
                                                      0.00
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                        
                     

Development of the bloom index proceeds in a similar way, with 
                           
                              
                                 
                                    X
                                 
                                 
                                    bl
                                 
                              
                           
                         composed of the following predictors: 
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          Predictor abbreviation
                                       
                                       
                                          Description
                                       
                                    
                                 
                                 
                                    
                                       MDS0
                                       Days since leaf index was achieved
                                    
                                    
                                       AGDH
                                       Accumulated growing degree hours
                                    
                                 
                              
                           
                        
                     

with AGDH is defined as the summation of growing degree hours at some time t from some initial time t
                        
                           o
                        
                        
                           
                              (12)
                              
                                 AGDH
                                 (
                                 t
                                 )
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             AGDH
                                             (
                                             t
                                             −
                                             1
                                             )
                                             +
                                             GDH
                                             (
                                             t
                                             )
                                          
                                          
                                             if
                                             
                                             t
                                             >
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      o
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             otherwise
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In this case, t
                        
                           o
                         is taken to be the date of the first leaf index, ensuring that the bloom index will always occur later in the year.

Finally, 
                           
                              
                                 
                                    A
                                 
                                 
                                    bl
                                 
                              
                           
                         is defined as
                           
                              (13)
                              
                                 
                                 
                                 
                                 MDS
                                 0
                                 
                                 AGDH
                                 
                                    
                                       
                                          A
                                       
                                       
                                          bl
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          Lilac
                                       
                                    
                                    
                                       
                                          Arnold
                                          
                                          Red
                                       
                                    
                                    
                                       
                                          Zabeli
                                       
                                    
                                 
                                 [
                                 
                                    
                                       
                                          
                                             −
                                             23.934
                                          
                                          
                                             0.116
                                          
                                       
                                       
                                          
                                             −
                                             24.825
                                          
                                          
                                             0.127
                                          
                                       
                                       
                                          
                                             −
                                             11.368
                                          
                                          
                                             0.096
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        
                     

The ml_si toolbox is distributed as a single zipped tarball. When unzipped and untarred, it will create a main directory called ML_SI with five subdirectories: data/, docs/, figs/, scripts/ and si_funcs/. The actual calculation of SI, however, only requires one function (calc_si) and its five dependencies (calc_daylen, calc_soldec, growdh, synval, leaf), all of which are in the directory si_funcs/. One therefore only needs to add the path to si_funcs to have a fully functional implementation of ml_si. Nonetheless, we supply a number of additional utilities and datasets with the distribution of ml_si, all of which are documented in the User's Guide in the folder docs/. It is worth noting here, however, that in the folder scripts/ there is a script called setup_ml_si.m which will add the appropriate paths and test the functionality of si_ml. It is recommended that this script be run first.

The function calc_si takes as an input three arguments: Tmin, Tmax and lat. The variables Tmin and Tmax can be 2D matrices or 3D arrays, so long as their dimensions are ordered as follows: years, days, stations, where the dimension 
                        years is the total time domain of years for which SI is to be calculated; the dimension 
                        days is the number of days from January 1 onward (366 total, with NaN filling in the last day of all non-leap years); and stations is a dimension that can be filled by data from one or more stations. It is easiest to think of calc_si taking as input a stack of daily Tmin and Tmax records, with each of the layers in the stack being individual stations or sites. The input values of Tmin and Tmax should be in units of Fahrenheit, but they need not be derived from station data. The matrices 
                           
                              
                                 
                                    A
                                 
                                 
                                    lf
                                 
                              
                           
                         and 
                           
                              
                                 
                                    A
                                 
                                 
                                    bl
                                 
                              
                           
                         are specified in the function leaf, but these could be modified in this function, or the function itself could be easily adapted to take these matrices as an input.

All data used here to illustrate the functionality of ml_si are publicly available. They include “global historical climatology network” (GHCN) daily data from the National Climatic Data Center (ftp://ftp.ncdc.noaa.gov/pub/data/ghcn/daily/gsn/), as well as observational phenological datasets archived online by the USA-NPN (https://www.usanpn.org/) and provided as part of this toolkit. Examples of how the various metrics are computed from a single GHCN station use daily T
                        
                           min
                         and T
                        
                           max
                         values from station “USC00405187” (Lewisburg, TN, USA).

Values of T
                        
                           min
                         and T
                        
                           max
                         from a single station for a single year are shown with all derived predictor variables (the time evolving rows of X
                        
                           lf
                        (t)) in Fig. 2
                        . The day of leaf index output is also shown for that year. A similar example is shown in Fig. 3
                         for the bloom index. Both figures illustrate how daily weather fluctuations are translated into a single day-of-year (DOY) value at a given site for a given year for both indices. All data and routines needed to generate these two figures are included in the ml_si distribution, and indeed the figures themselves can be reproduced by running the file ml_si_demo_1.m in the scripts/ folder.


                        Fig. 4
                         shows simulated leaf (panel a) and bloom (panel b) events from the three plants comprising the SI models, calculated from a single station for all available years. The values of these time series are average together for each year to produce the leaf and bloom indices shown in Fig. 5
                        .

In addition to the leaf and bloom indices, the full suite of spring indices includes the day of last freeze for each year and the damage index, which records the anomalous amount of time between first leaf and last freeze. Anomalies are used because last freeze typically occurs after the leaf date, but if it happens quite late then presumably the plants have had an unusual amount of time to grow and render themselves vulnerable to frost damage (e.g., Ault et al., 2013). All four SI are shown in Fig. 5. Both Figs. 4 and 5 are generated using the script ml_si_demo_2.m.

The accuracy of the leaf and bloom indices has been documented elsewhere (see, for example, Schwartz and Reiter, 2000; Schwartz et al., 2006, 2013). Moreover, the ml_si code has been validated using the original FORTRAN implementations used in previous studies. Here, nonetheless, we show a qualitative comparison of the leaf and bloom index values (the averages of three plants) with some of the most extensive phenological observations available for the continental United States (Fig. 6
                        ). To generate these scatter plots, spring indices were calculated from a subset GHCND stations that were employed in earlier studies (McCabe et al., 2011; Schwartz et al., 2013; Ault et al., 2013) because of their high data quality and coverage over the 20th century. In Fig. 6 the GHCND sites that were within 10km of a lilac observing site are plotted against the phenological events themselves. This figure and all supporting analysis can be generated with the script ml_si_demo_3.m, although the user will also need to obtain the raw daily GHCN data (ftp://ftp.ncdc.noaa.gov/pub/data/ghcn/daily/ghcnd_all.tar.gz), and store it in the appropriate directory (e.g., ML_SI/data/ghcnd_all/).

Regionally varying trends in global SI are explored extensively by Schwartz et al. (2006), and interannual variations in North America are documented in Ault et al. (2011) and McCabe et al. (2011), as well as an earlier study documenting variations in observational lilac data (Cayan et al., 2001). In this example, we are interested only in showing how mean dates and trends of the leaf and bloom indices can be calculated from the subset of GHCN sites used in the previous example (Fig. 8
                        ). In panel (a), the overall (1956–2009) mean for each station is shown; trends in these records are shown in panel (b). These maps differ from those presented in Schwartz et al. (2013) and Peterson and Abatzoglou (2014) in that no “warming hole” is present in the US southeast: this result is from using fewer records analyzed by Schwartz et al. (2013), and hence continuous coverage in many sites was not available for the full period investigated in the earlier study (1900–2010). Also, only the sites close to the lilac stations are shown here. Fig. 8 can be generated using the script si_demo_4.m, although GHCN daily data will first need to be downloaded as with the previous example.

@&#DISCUSSION@&#

We have illustrated the underlying conceptual motivation and implementation of the spring indices along with their calculation using the ml_si toolbox. These indices underpin a number of recent studies examining the timing of spring onset (Ault et al., 2011; McCabe et al., 2011; Schwartz et al., 2013; McCabe et al., 2013; Peterson and Abatzoglou, 2014), yet researchers have only begun to scratch the surface of what should be possible with broader use and accessibility of the spring indices. We therefore envision that this software will be of broad use to the ecological and climate science communities. Further, although there are a few other data products like the spring indices that track the transition of boreal winter into the growing season (e.g., Jolly et al., 2005), the routines we document here are unique in that they provide researchers with new tools to develop consistent metrics of spring onset through time, across space, and from a wide array of data products. Such products could include observational datasets of gridded T
                     
                        min
                      and T
                     
                        max
                      or output from climate change simulations using global climate models.

Several examples using daily GHCN data should give the user a sense for the kinds of analyses that this toolbox makes possible. For instance, in a straightforward way, one could obtain daily station data for a given location where phenological observations have been made, calculate SI, and compare the results with the observed data. Likewise, if daily Tmin and Tmax values have been recorded at a given plot or phenological monitoring site, they too could be ingested into ml_si. However, given the number of missing days in some GHCND stations, we suggest imposing a similar quality control measure to that employed by Schwartz et al. (2006). In that study, stations were only included if they had fewer than 10 missing days of data per 30 day period for at least 25 years out of a 30 year reference period (1961–1990).

Some of the limitations of ml_si are obvious, while others need to be investigated more extensively in future work. For example, the current implementation of SI is only valid in the Northern Hemisphere because of how day lengths are calculated; future developments will include making Southern Hemisphere SI possible. Another drawback is that the models exclude information about precipitation and snow cover; yet, these variables may be critical in governing plant responses at some locations or during some years. By the same token, the detection of synoptic-scale warm weather events is based on T
                     
                        min
                      and T
                     
                        max
                     , but should (ideally) use metrics that record more information about the underlying dynamics of the atmosphere (such as sea level pressure or geopotential height anomalies). Because such variables are often not available when working with international datasets (as in Schwartz et al., 2006), they have been deliberately excluded from the calculation of SI for simplicity and flexibility.

Two more subtle, and perhaps more serious, limitations of SI are worth mentioning. First, the extension of SI into lower latitudes was achieved by removing the plant “chilling” requirements as explained in Schwartz et al. (2013), which had been a key feature of the model before that time. Although this step extended the geographic domain where SI can be calculated, its overall implications remain relatively under-explored. Nonetheless, Schwartz et al. (2013) show good agreement between the extended SI and existing (non-Lilac and non-Honeysuckle) observational datasets in warmer temperate regions, suggesting that even in these lower latitudes the SI pick up key features of spring onset. Second, the SI are composed of average simulated leaf out and bloom dates from just three indicator species. Although the phenologies of these three species are perhaps the most widely observed in the continental US, it would be desirable at some future time to populate the SI plant models with a richer “ecology” of indicator species. Despite these limitations, the SI have consistently and demonstrably been useful in tracking interannual variations in spring onset and trends across an impressive number of spatial domains and types of variables (Schwartz and Reiter, 2000; White et al., 2009; McCabe et al., 2011; Schwartz et al., 2013). In our view, the SI are therefore best used to characterize interannual variations in temperature-driven phenological and physical responses to spring onset.

Finally, the use and utility of the SI can be thought of in an analogous way to that of the “Palmer Drought Severity Index” (PDSI) and its many variants (e.g., Dai, 2011). The PDSI was developed for a very narrow purpose in a limited geographic domain nearly 50 years ago. Nonetheless, it manages to capture something essential about the nature of moisture balances and deficits across a wide range of spatial and temporal scales, making it one of the most widely used drought indices even today, and in spite of its many limitations (see Alley, 1984; McKee et al., 1993; Guttman, 1999; Redmond, 2002; Dai, 2011). In our view, the SI are conceptually similar to drought indices because they attempt to translate noisy local weather fluctuations into a consistent indicator of climatic conditions across space and through time. By producing and distributing ml_si, it is hoped that the wider research community will continue to explore its usefulness and limitations, as well as develop new, alternative indices to characterize spring onset in our changing climate.

@&#ACKNOWLEDGMENTS@&#

Coordination and effort to develop this project was made possible in part by the USA National Phenology Network, including J.L. Betancourt and J.F. Weltzin who provided helpful discussions during the development of this toolkit. We are especially grateful to Alyssa Rosemartin and the National Coordinating Office of the USA-NPN for supplying quality-controlled versions of the historical Lilac phenology datasets from the Eastern and Western US. The project described in this publication was supported by Grant/Cooperative Agreement no. G13AC00248 from the United States Geological Survey. Its contents are solely the responsibility of the authors and do not necessarily represent the official views of the USGS.

Complete documentation of the si_ml toolbox may be found in the User's Guide (ML_SI/docs/users_guide.pdf). Here, we note a few additional functions and datasets that are distributed in the package. First, the script setup_ml_si.m will add the appropriate path to the SI functions and test various options, including the functionality of wget to retrieve station data as well as the routines needed to import GHCN metadata, GHCN daily data, and the North American lilac data. None of these options are needed, however, for the core functions comprising ml_si to work properly.

Second, the function read_ghcnd_dly_file (in si_funcs/) will read a GHCN file with daily station data and return a structure with appropriate metadata and data attached to it. This function is called by si_demo_3.m, si_demo_4.m.

Lastly, the data found in ML_SI/data/mds/mds_verification_data/ includes SI-x_1981_2010_norms25_noWBAN.xls and SI-x_select6_optimized_output.xls. 
                        The
                        
                        first
                        
                        
                           
                              Excel
                           
                           
                              ©
                           
                        
                      file contains the list of the 733 quality-controlled GHCND sites (first column) as well as some metadata and output from the original FORTRAN code written by M.D. Schwartz. This file is used by si_demo_3.m to calculate spring indices for each of the 733 sites; si_demo_4.m uses the output from si_demo_3.m and maps out the trends and means for these sites. A second file (SI-x_select6_optimized_output.xls) contains the output from Schwartz's original FORTRAN code to calculate SI from a “Select 6” subset of the GHCN database. The output has also been formatted for 
                        
                           
                              Excel
                           
                           
                              ©
                           
                        
                     . If modifications are made to any of the core functions comprising ml_si, it is recommended that the new results be verified against this dataset (an example of this verification process is found in setup_ml_si). It is not necessary, in our view, that new output be exactly 1-to-1 with the original FORTRAN output because truncation differences between MATLAB© and FORTRAN can introduce up to 1 day of random error during some years. However, any errors should be uncorrelated and not systematically biased in any one direction.

Supplementary data associated with this paper can be found in the online version at doi:10.1016/j.cageo.2015.06.015.


                     
                        
                           Application 1
                           
                        
                     
                     
                        
                           Application 2
                           
                        
                     
                  

@&#REFERENCES@&#

