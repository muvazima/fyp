@&#MAIN-TITLE@&#Exploiting projective geometry for view-invariant monocular human motion analysis in man-made environments

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We model body poses and silhouettes using a reduced set of training views.


                        
                        
                           
                           We exploit projective geometry and assume that people move on a known ground plane.


                        
                        
                           
                           We compensate for changes in silhouette due to a novel viewpoint using a homography.


                        
                        
                           
                           The homography can be used in a bottom-up or a top-down manner.


                        
                        
                           
                           The homographic alignment outperforms the commonly used similarity alignment.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Human motion analysis

Projective geometry

View-invariance

Video-surveillance

@&#ABSTRACT@&#


               
               
                  Example-based approaches have been very successful for human motion analysis but their accuracy strongly depends on the similarity of the viewpoint in testing and training images. In practice, roof-top cameras are widely used for video surveillance and are usually placed at a significant angle from the floor, which is different from typical training viewpoints. We present a methodology for view-invariant monocular human motion analysis in man-made environments in which we exploit some properties of projective geometry and the presence of numerous easy-to-detect straight lines. We also assume that observed people move on a known ground plane. First, we model body poses and silhouettes using a reduced set of training views. Then, during the online stage, the homography that relates the selected training plane to the input image points is calculated using the dominant 3D directions of the scene, the location on the ground plane and the camera view in both training and testing images. This homographic transformation is used to compensate for the changes in silhouette due to the novel viewpoint. In our experiments, we show that it can be employed in a bottom-up manner to align the input image to the training plane and process it with the corresponding view-based silhouette model, or top-down to project a candidate silhouette and match it in the image. We present qualitative and quantitative results on the CAVIAR dataset using both bottom-up and top-down types of framework and demonstrate the significant improvements of the proposed homographic alignment over a commonly used similarity transform.
               
            

@&#INTRODUCTION@&#

In recent years, the number of cameras deployed for surveillance and safety in urban environments has increased considerably in part due to their falling cost. The potential benefit of an automatic video understanding system in surveillance applications has stimulated much research in computer vision, especially in the areas related to human motion analysis. The hope is that an automatic video understanding system would enable a single operator to monitor many cameras over wide areas more reliably.

Example-based approaches have been very successful in the different stages of human motion analysis: detection, pose estimation and tracking. Some consist of comparing the observed image with a data base of stored samples as in [1–3]. In some other cases, the training examples are used to learn a mapping between image feature space and 3D pose space [4–7]. Such mappings can be used in a bottom-up discriminative way [8] to directly infer a pose from an appearance descriptor or in a top-down generative manner [7] through a framework (e.g., a particle filter) where pose hypotheses are made and their appearances aligned with the image to evaluate the corresponding observation likelihood or cost function. The exemplars can also be used to train binary human detectors [9–12], multi-class pose classifiers [13–15] or part-based detectors [16–20] that are later employed to scan images. The main disadvantage of all these example-based techniques is their direct dependence on the point of view: the accuracy of the result strongly depends on the similarity of the camera viewpoint between testing and training images.

Ideally, to deal with viewpoint dependency, one could generate training data from infinitely many camera viewpoints, ensuring that any possible camera viewpoint could be handled. Unfortunately, this set-up is physically impossible and makes the use of real data infeasible. It could, however, be simulated by using synthetic data, but using a large number of views would drastically increase the size of the training data. This would make the analysis much more complicated; furthermore, the problem is exacerbated when considering more actions.

In practice, roof-top cameras are widely used for video surveillance applications and are usually placed at a significant angle from the floor (see Fig. 1
                     a), which is different from typical training viewpoints as shown in the examples in Fig. 1c. Perspective effects can deform the human appearance (e.g., silhouette features) in ways that prevent traditional techniques from being applied correctly. Freeing algorithms from the viewpoint dependency and solving the problem of perspective deformations is an urgent requirement for further practical applications in video-surveillance.

The goal of this work is to track and estimate the pose of multiple people independently of the point of view from which the scene is observed (see Fig. 1b), even in cases of high tilt angles and perspective distortion. The idea is to model body pose manifold and image features (e.g., shape) using as few training views as possible. The challenge is then to make use of these models successfully on any possible sequence taken from a single fixed camera with an arbitrary viewing angle. A solution is proposed to the paradigm of “View-insensitive process using view-based tools” for video-surveillance applications in man-made environments: supposing that the observed person walks on a planar ground in a calibrated environment, we propose to compute the homography relating the image points to the training plane of the selected viewpoint. This homographic transformation can potentially be used in a bottom-up manner to align the input image to the training plane and process it with the corresponding view-based model, or top-down to project a candidate silhouette and match it in the image. In the presented work, we focus on specific motion sequences (walking), although our algorithm can be generalized for any action.

@&#RELATED WORK@&#

Viewpoint dependence has been one of the bottlenecks for research development of human motion analysis as indicated in a recent survey [23]. Most of the early surveillance systems which can be found in the literature, e.g. 
                           
                              
                                 
                                    W
                                 
                                 
                                    4
                                 
                              
                           
                         
                        [24], BraMBLe [25] or ADVISOR [26], only considered data where multiple people were distributed horizontally in the image, i.e., with a camera axis parallel to the ground and without any type of distortion. More recently, some work has focused on the problem of viewpoint dependency.

There have been successful efforts to build view-invariant features. The approach proposed in [27] exploits the invariances of Hu moments and the concept of “virtual cameras” which allows for the reconstruction of synthetic 2D features from any camera location. In [28], a calibrated approach was used in order to avoid perspective distortion of the extracted features while a method was proposed in [29] to build features that are highly stable under change of camera viewpoint and recognize action from new views.

Methods using ideas from model based invariance theory have been gaining popularity in recent years. In [30], the authors presented a method to calculate the 3D positions of various body landmarks given an uncalibrated perspective image and point correspondences in the image of the body landmarks. They also addressed the problem of view-invariance for action recognition in [31]. Recently, a motion estimation algorithm for projective cameras explicitly enforced articulation constraints and presented pose tracking results for binocular sequences [32]. In [33], the authors proposed a reconstruction method to rectify and normalize gait features recorded from different viewpoints into the side-view plane, exploiting such data for human recognition. The rectification method was based on the anthropometric properties of human limbs and the characteristics of the gait action [34].

The problem of comparing an input image (or a sequence of images) with a database of stored training examples captured from different camera views has also been studied. Recently, view-invariant action recognition was achieved in [35] by associating a few motion capture examples using a novel Dynamic Manifold Warping (DMW) alignment algorithm. A solution for inferring a 3D shape from a single input silhouette with an unknown camera viewpoint was proposed in [36]: the model was learnt by collecting multi-view silhouette examples from a calibrated camera ring and the visual hull inference consisted in finding the shape hypotheses most likely to have generated the observed 2D contour. We also collect silhouette examples from a camera ring but consider much fewer training views and instead propose to exploit the projective geometry of the scenes to improve the analysis of the input silhouette.

A few previous efforts have been made to exploit this projective geometry. In [37], a method was proposed for view invariant gait recognition: considering a person walking along a straight line (making a constant angle with the image plane), a side-view was synthesized using a homography. In [38], we proposed an algorithm that projected both shape model and input image in a canonical vertical view, orthogonal or parallel to the direction of motion. In the same spirit, a homographic transformation was later employed in [39] to improve human detection in images presenting perspective distortion. They reported an improvement in detection rate from 38.3% to 87.2% using 3D scene information instead of scanning over 2D (plus in-plane rotation) on the CAVIAR dataset [21]. The main difference between our proposed approach and these previous methods is that all three only consider the projection to a simple canonical vertical view while we propose to select the closest training view from a given input image and compute the projective transformation between them. Another difference is that we tackle the more complicated task of articulated human pose estimation and propose an extensive numerical evaluation on challenging sequences.

Recent approaches to articulated tracking increasingly more often rely on detailed 3D body models [40,41]. For these methods, novel camera views do not pose particular problems, as they can generate body appearance for any view through rendering a 3D model. Their main drawback is the computational cost of fitting the thousands of triangles of the mesh models, which makes them less suitable for practical real-time applications such as surveillance. Other existing motion analysis systems [5,7,15] usually assume that the camera axis is parallel to the ground and that the observed people are vertically displayed, i.e., elevation angle 
                           
                              φ
                              =
                              0
                           
                         and rotation angle 
                           
                              γ
                              =
                              0
                           
                         (see Fig. 1b for angle definition), thus making the problem substantially easier. Many authors proposed to discretize the camera viewpoint in a circle around the subjects, selecting a set of training values for the azimuth 
                           
                              θ
                           
                        : 36 orientations in [7], 16 in [42,43], 12 in [5] and 8 in [13,15,44–46]. Although qualitative results have been presented for street views [7,15], numerical evaluation is usually conducted using standard testing datasets in laboratory type environments (e.g., HumanEva [47]), and training and testing images are generally captured with a similar camera tilt angle. Very few tackle the problem of pose tracking in surveillance scenarios with low resolution and high perspective distortion as we do. Most of these state-of-the-art systems follow a common basic flowchart (Fig. 2
                        a) with an offline learning stage which consists in building a model of the human appearance from a set of training views, and an online process where the humans are tracked and their pose estimated. These methods explicitly [13,48] or implicitly [7,15] apply a similarity transformation between their models and the processed images, most of the time with only scale and translation elements (no in-plane rotation). Few pose tracking algorithms exploit the key constraints provided by scene calibration. Apart from our previous work [49], the only example of tracking results in crowded video-surveillance sequences with perspective effect was presented in [50] but no body pose was estimated.

Even though many new types of image features have recently been developed, silhouette-based approaches are still receiving much attention. These approaches focus on the use of the binary silhouette of the human body as a feature for detection [20,51], tracking [48,52–55], pose estimation [2,5–7,46,56] or action recognition [57,58] to cite a few. They rely on the observation that most human gestures can be recognized using only the outline shape of the body silhouette. The most important advantage of these features is their ease of extraction from raw video frames using low-level processing tasks like background subtraction or edge detection algorithms. However, in presence of perspective effect, the distortion will cause the parts of the subject that are closer to the lens to appear abnormally large, thus deforming the shape of the human contour in ways that can prevent a correct analysis as discussed in [59]. In this paper, we show how projective geometry can be exploited to improve silhouette-based approaches in such cases.

We present a methodology for view-invariant monocular human motion analysis in man-made environments in which we assume that observed people move on a known ground plane, a valid assumption in most surveillance scenarios. Considering the framework depicted in Fig. 2a, in this paper we focus on the pose estimation block (B). In our previous work, we dealt with the other two blocks (modelling and tracking). Interested readers are encouraged to consult [13,46] for bottom-up methods and [49] for our top-down tracking framework, or [60] for a more complete discussion.

The basic idea of this paper is that projective geometry could be exploited to compensate for the difference of camera view between input and training images. In our earlier work [38], we gave a first insight on how the use of a projective transformation for shape registration improves silhouette-based pose estimation. In this paper, we consider a wider range of possible viewpoints and propose to estimate the homography transformation between training and test views. This homography is used to compensate for changes in silhouette due to the novel unseen viewpoint. First, the position of the camera with respect to the observed object, the view, is parameterized with two angles, latitude 
                        
                           
                              φ
                           
                         and longitude 
                        
                           
                              θ
                           
                        , that define the upper viewing hemisphere as shown in Fig. 1b. Our proposal then relies on two separate stages: The off-line stage consists in discretizing the viewing hemisphere into a reduced number of training viewpoints. In this paper, we use the MoBo dataset for training and consider 8 training viewpoints uniformly distributed around the subject. For each view, body poses and silhouettes are labelled (Fig. 3
                        ) and used to train a model/mapping between view-based silhouette shape and pose. Camera and scene calibrations are also performed in training and testing views.

Given a test image, the online stage consists in selecting the closest training view on the viewing hemisphere and computing the homography that relates the corresponding training plane to the image points using the dominant 3D directions of the scene, the location on the ground plane and the camera view in both training and input images. This transformation can potentially compensate for the effect of both discretization along 
                           
                              θ
                           
                         and variations along 
                           
                              φ
                           
                        , and removes part of the perspective effect. This homographic transformation can be used (1) in a bottom-up manner to align an input image to a selected training plane for a view-based processing (see Fig. 2b) or (2) top-down to project a candidate silhouette and match it directly in the image (see Fig. 2c). The work presented in this paper can be seen as an extension of [61]. We take steps toward detailing and generalizing the algorithm and analyze the improvement obtained when the proposed projective transformation is included within two different type of motion analysis frameworks [46,49]. We have also carried out an exhaustive experimentation to validate our approach with a numerical evaluation and present a comparison with the state-of-the-art approach which consists in using a four-parameter similarity transform. Standard testing data sets for pose estimation (e.g., HumanEva [47]) do not consider perspective distortion and cannot be used in this paper to offer a comparison with state-of-the-art work. We instead employ the CAVIAR dataset [21] that presents very challenging sequences with perspective distortion (see Fig. 3a). Our qualitative and quantitative results on this dataset, in both bottom-up and top-down frameworks, demonstrate the significant improvements of the proposed homographic alignment for silhouette-based human motion analysis.

The rest of the paper is organized as follows. First, some geometrical considerations are explained in Section 2. The computation of the projective transformation is then described in Section 3 while the qualitative and quantitative evaluations are presented in Section 4. Finally, conclusions are drawn in Section 5.

We propose to exploit camera and scene knowledge when working in a man-made environments which is the case of most video-surveillance scenarios.

In the following sections upper case letters, e.g., X or 
                           X
                        , will be used to indicate quantities in space whereas image quantities will be indicated with lower case letters, e.g., x or x. Euclidean vectors are denoted with upright boldface letters, e.g. x or X, while slanted letters denote their cartesian coordinates, e.g., 
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         or 
                           
                              (
                              X
                              ,
                              Y
                              )
                           
                        .

Following notations used in [62], underlined fonts 
                           
                              
                                 
                                    •
                                 
                                 
                                    ̲
                                 
                              
                           
                         indicate homogeneous coordinates in projective spaces, e.g. 
                           
                              
                                 
                                    x
                                 
                                 
                                    ̲
                                 
                              
                           
                         or 
                           
                              
                                 
                                    X
                                 
                                 
                                    ̲
                                 
                              
                           
                        . A homogeneous point 
                           
                              
                                 
                                    x
                                 
                                 
                                    ̲
                                 
                              
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    n
                                 
                              
                           
                         is composed of a vector 
                           
                              m
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                         and a scalar 
                           
                              ρ
                           
                         (usually referred to as the homogeneous part):
                           
                              (1)
                              
                                 
                                    
                                       x
                                    
                                    
                                       ̲
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                
                                             
                                             
                                                
                                                   ρ
                                                
                                             
                                          
                                       
                                    
                                 
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       n
                                    
                                 
                                 ⊂
                                 
                                    
                                       R
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 ,
                              
                           
                        where the choice 
                           
                              ρ
                              =
                              1
                           
                         is the original Euclidean point representation while 
                           
                              ρ
                              =
                              0
                           
                         defines the points at infinity. The homogeneous point 
                           
                              
                                 
                                    x
                                 
                                 
                                    ̲
                                 
                              
                           
                         thus refers to the Euclidean point 
                           
                              x
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                        :
                           
                              (2)
                              
                                 x
                                 =
                                 m
                                 /
                                 ρ
                                 .
                              
                           
                        By definition, all the homogeneous points 
                           
                              
                                 
                                    {
                                    
                                       
                                          [
                                          ρ
                                          
                                             
                                                x
                                             
                                             
                                                T
                                             
                                          
                                          ,
                                          ρ
                                          ]
                                       
                                       
                                          T
                                       
                                    
                                    }
                                 
                                 
                                    ρ
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          ∗
                                       
                                    
                                 
                              
                           
                         represent the same Euclidean point 
                           
                              x
                           
                         (see [63]) and, for homogeneous coordinates, “=” means an assignment or an equivalence up to a non-zero scale factor.

Supposing observed humans are walking on a planar ground floor with a vertical posture, camera model and ground plane assumptions provide useful geometric constraints that help reducing the search space as in [20,50,64], instead of searching for all scales, all orientations and all positions. During the scene calibration two 3×3 homography matrices are calculated: 
                           
                              
                                 
                                    H
                                 
                                 
                                    g
                                 
                              
                           
                         which characterizes the mapping between the ground plane in the image and the real world ground plane 
                           
                              
                                 
                                    Π
                                 
                                 
                                    gd
                                 
                              
                              and
                              
                              
                                 
                                    H
                                 
                                 
                                    h
                                 
                              
                           
                         relating the head plane in the image with 
                           
                              
                                 
                                    Π
                                 
                                 
                                    gd
                                 
                              
                           
                        . In this work, the homography matrices are estimated by the least-squares method using four or more pairs of manually preannotated points in several frames. The 2 homography mappings are illustrated in Fig. 4
                        . Note that when surveillance cameras with a high field of view are used (as with [21]), a previous lens calibration is required to correct the optical distortion.

Given an estimate of the subject’s location 
                           
                              (
                              X
                              ,
                              Y
                              )
                           
                         on the world ground plane 
                           
                              
                                 
                                    Π
                                 
                                 
                                    gd
                                 
                              
                           
                        , the planar homographies 
                           
                              
                                 
                                    H
                                 
                                 
                                    g
                                 
                              
                              
                              and
                              
                              
                                 
                                    H
                                 
                                 
                                    h
                                 
                              
                           
                         are used to evaluate the location of the subject’s head 
                           
                              
                                 
                                    x
                                 
                                 
                                    H
                                 
                              
                           
                         and “feet” 
                           
                              
                                 
                                    x
                                 
                                 
                                    F
                                 
                              
                           
                         in the image 
                           
                              I
                           
                        :
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ̲
                                          
                                       
                                    
                                    
                                       H
                                    
                                 
                                 =
                                 
                                    
                                       H
                                    
                                    
                                       h
                                    
                                 
                                 ·
                                 
                                    
                                       [
                                       X
                                       ,
                                       Y
                                       ,
                                       1
                                       ]
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ̲
                                          
                                       
                                    
                                    
                                       F
                                    
                                 
                                 =
                                 
                                    
                                       H
                                    
                                    
                                       g
                                    
                                 
                                 ·
                                 
                                    
                                       [
                                       X
                                       ,
                                       Y
                                       ,
                                       1
                                       ]
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        where points in the projective space 
                           
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                           
                         are expressed in homogeneous coordinates.

In this work, we want to compensate for the difference of camera view between input and training images using the dominant 3D directions of the scenes. We suppose that the camera model is known and people walk in a structured man-made environment where straight lines and planar walls are plentiful. The transformation matrices introduced in the next section are calculated online using the vanishing points 
                           1
                           A vanishing point is the intersection of the projections in the image of a set of parallel world lines. Any set of parallel lines on a plane define a vanishing point and the union of all these vanishing points is the vanishing line of that plane [65].
                        
                        
                           1
                         evaluated in an off-line stage: the positions of the vertical vanishing point 
                           
                              
                                 
                                    v
                                 
                                 
                                    Z
                                 
                              
                              
                              and
                              
                              l
                           
                        , the vanishing line of the ground plane, are directly obtained after a manual annotation of the parallel lines (on the ground and walls) in the image. An example of vertical vanishing point localization is given in Fig. 4. This method makes sense only for man-made environments because of the presence of numerous easy-to-detect straight lines. Previous work for vanishing points detection [66] could be used to automate the process.

Once we have calibrated the camera in the scene, the camera cannot be moved, which is a limitation of the proposal. In practice, the orientation of the camera could change, for example, due to the lack of stability of the camera support. A little change in orientation has a great influence in the image coordinates, and therefore invalidates previous calibration. However, if the camera is not changed in position, or position change is small with respect to the depth of the observed scene, the homography can easily be re-calibrated automatically. An automatic method to compute homographies and line matching between image pairs like the one presented in [67] can then be used.

As demonstrated in [37], for objects far enough from the camera, we can approximate the actual 3D object as being represented by a planar object. In other words, a person can be approximated by a planar object if he or she is far enough from the camera.
                        2
                        This hypothesis is obviously not strictly true as it does not depend solely on the distance to the camera but also on the pose and orientation of the person w.r.t. the camera.
                     
                     
                        2
                      As shown in [59], in the presence of perspective distortion neither similarity nor affine model provide reasonable approximation for the transformation between a prior shape and a shape to segment. The authors demonstrated that a planar projective transformation is a better approximation even though the object shape contour is roughly planar (e.g., a toy elephant). Following these two observations, we propose to find a projective transformation, i.e., a homography, between training and testing camera views to compensate for the effect of both discretization along 
                        
                           θ
                        
                      and variations along 
                        
                           φ
                        
                     , thus alleviating the effect of perspective distortion on silhouette-based human motion analysis.

Following the classical notation of 3D projective geometry [63], a 3D point 
                           
                              (
                              X
                              ,
                              Y
                              ,
                              Z
                              )
                           
                         is related to its 2D image projection 
                           
                              x
                           
                         via a 
                           
                              3
                              ×
                              4
                           
                         projection matrix 
                           
                              M
                           
                        :
                           
                              (5)
                              
                                 
                                    
                                       x
                                    
                                    
                                       ̲
                                    
                                 
                                 =
                                 M
                                 ·
                                 
                                    
                                       [
                                       X
                                       ,
                                       Y
                                       ,
                                       Z
                                       ,
                                       1
                                       ]
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    x
                                 
                                 
                                    ̲
                                 
                              
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                           
                        . The projective transformation matrix 
                           
                              M
                           
                         can be determined with a series of intrinsic and extrinsic parameters or, as shown in [65], it can be defined as a function of the vanishing points of the dominant 3D directions.

Suppose we want to relate the image 
                           
                              I
                           
                         with a vertical plane 
                           
                              Π
                           
                         (
                           
                              Π
                              ⊥
                              
                                 
                                    Π
                                 
                                 
                                    gd
                                 
                              
                           
                        ), whose intersection with the ground plane 
                           
                              
                                 
                                    Π
                                 
                                 
                                    gd
                                 
                              
                           
                         is 
                           
                              G
                           
                        . The plane 
                           
                              Π
                           
                         is thus spanned by the vertical Z-axis and horizontal G-axis. In that sense, (5) becomes:
                           
                              (6)
                              
                                 
                                    
                                       x
                                    
                                    
                                       ̲
                                    
                                 
                                 =
                                 
                                    
                                       H
                                    
                                    
                                       I
                                       ←
                                       Π
                                    
                                 
                                 ·
                                 
                                    
                                       [
                                       G
                                       ,
                                       Z
                                       ,
                                       1
                                       ]
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        with G a coordinate on the G-axis and 
                           
                              
                                 
                                    H
                                 
                                 
                                    I
                                    ←
                                    Π
                                 
                              
                           
                         a 
                           
                              3
                              ×
                              3
                           
                         homography matrix that can be computed from the vanishing points of the dominant 3D directions of 
                           
                              Π
                           
                         :
                           
                              (7)
                              
                                 
                                    
                                       H
                                    
                                    
                                       I
                                       ←
                                       Π
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       v
                                    
                                    
                                       G
                                    
                                 
                                 
                                 α
                                 
                                    
                                       v
                                    
                                    
                                       Z
                                    
                                 
                                 
                                 
                                 o
                                 ]
                                 .
                              
                           
                        where 
                           
                              
                                 
                                    v
                                 
                                 
                                    Z
                                 
                              
                           
                         is the vertical vanishing point, 
                           
                              o
                           
                         is the origin of the world coordinate system and 
                           
                              α
                           
                         is a scale factor. 
                           
                              
                                 
                                    v
                                 
                                 
                                    G
                                 
                              
                           
                         is the horizontal vanishing point of plane 
                           
                              Π
                           
                         in 
                           
                              I
                           
                         i.e., the vanishing point along the horizontal direction 
                           
                              G
                           
                         in image 
                           
                              I
                           
                        . This vanishing point 
                           
                              
                                 
                                    v
                                 
                                 
                                    G
                                 
                              
                           
                         can be localized as the intersection of line 
                           
                              g
                           
                        , the projection of 
                           
                              G
                           
                         in the image 
                           
                              I
                              
                              and
                              
                              l
                           
                        , the horizontal vanishing line in 
                           
                              I
                           
                        :
                           
                              (8)
                              
                                 
                                    
                                       v
                                    
                                    
                                       G
                                    
                                 
                                 =
                                 l
                                 ×
                                 g
                                 ,
                              
                           
                        where 
                           
                              ×
                           
                         represents the vector product, and 
                           
                              l
                           
                         is the vanishing line of the ground plane (see [63] for details). Two examples of horizontal vanishing point localizations are given in Fig. 5
                        .

The 
                           
                              3
                              ×
                              3
                           
                         transformation 
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          2
                                       
                                    
                                    Π
                                    
                                       
                                          I
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           
                         between two images 
                           
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                              
                              and
                              
                              
                                 
                                    I
                                 
                                 
                                    2
                                 
                              
                           
                         through a vertical plane 
                           
                              ∏
                           
                         observed in both images can be obtained as the product of 2 homographies defined up to a rotational ambiguity. The first one, 
                           
                              
                                 
                                    H
                                 
                                 
                                    Π
                                    ←
                                    
                                       
                                          I
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           
                        , projects the 2D image points in 
                           
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                           
                         to the vertical plane 
                           
                              Π
                           
                         and the other one, 
                           
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          2
                                       
                                    
                                    ←
                                    Π
                                 
                              
                           
                        , relates this vertical plane to the image 
                           
                              I
                              
                                 
                                    
                                 
                                 
                                    2
                                 
                              
                           
                        . We thus obtain the following equation that relates the points 
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                           
                         from 
                           
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                           
                         with image points 
                           
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                           
                         from 
                           
                              
                                 
                                    I
                                 
                                 
                                    2
                                 
                              
                           
                        :
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ̲
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       I
                                       
                                          
                                             
                                          
                                          
                                             2
                                          
                                       
                                       Π
                                       I
                                       
                                          
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ̲
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                           
                         and with:
                           
                              (10)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   I
                                                   
                                                      
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   Π
                                                   I
                                                   
                                                      
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   H
                                                
                                                
                                                   I
                                                   
                                                      
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ←
                                                   Π
                                                
                                             
                                             ·
                                             
                                                
                                                   H
                                                
                                                
                                                   Π
                                                   ←
                                                   I
                                                   
                                                      
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             =
                                             
                                                
                                                   H
                                                
                                                
                                                   I
                                                   
                                                      
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ←
                                                   Π
                                                
                                             
                                             ·
                                             
                                                
                                                   (
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         I
                                                         
                                                            
                                                               
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         ←
                                                         Π
                                                      
                                                   
                                                   )
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Following Eq. (7), the two homographies 
                           
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          1
                                       
                                    
                                    ←
                                    Π
                                 
                              
                              
                              and
                              
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          2
                                       
                                    
                                    ←
                                    Π
                                 
                              
                           
                         can be computed from the vanishing points of the 3D directions spanning the vertical plane 
                           
                              Π
                           
                         i.e., the vertical Z-axis and the reference horizontal line 
                           
                              G
                              =
                              Π
                              ∧
                              
                                 
                                    Π
                                 
                                 
                                    gd
                                 
                              
                           
                        , intersection of 
                           
                              Π
                           
                         and ground plane 
                           
                              
                                 
                                    Π
                                 
                                 
                                    gd
                                 
                              
                           
                        .

In the same way, we now want to relate 2 images, e.g., training and testing images, observing two different calibrated scenes with 2 different subjects performing the same action from two similar viewing angles. These images can potentially be related through a vertical plane centered in the human body following Eq. (9). The problem is to select the vertical plane that will optimize the 2D shape correspondence between the 2 images. We choose to select this vertical plane in the training image, where the azimuth angle 
                           
                              θ
                           
                         is known and the camera is in an approximately horizontal position (i.e., elevation angle 
                           
                              φ
                              ≈
                              0
                           
                        ), and consider the closest vertical plane centered on the human body: if a camera view 
                           
                              Φ
                           
                         is defined by its azimuth and elevation angles 
                           
                              (
                              θ
                              ,
                              φ
                              )
                           
                         on the viewing hemisphere (Fig. 3a), the closest vertical plane 
                           
                              Π
                           
                         is the plane defined as 
                           
                              (
                              θ
                              ,
                              0
                              )
                           
                        .

Thus, considering a set of training views 
                           
                              
                                 
                                    {
                                    
                                       
                                          Φ
                                       
                                       
                                          v
                                       
                                    
                                    }
                                 
                                 
                                    v
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          v
                                       
                                    
                                 
                              
                           
                        , the associated homographies 
                           
                              
                                 
                                    {
                                    
                                       
                                          H
                                       
                                       
                                          
                                             
                                                Φ
                                             
                                             
                                                v
                                             
                                          
                                          ←
                                          
                                             
                                                Π
                                             
                                             
                                                v
                                             
                                          
                                       
                                    
                                    }
                                 
                                 
                                    v
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          v
                                       
                                    
                                 
                              
                           
                         relating each view and its closest vertical plane 
                           
                              
                                 
                                    Π
                                 
                                 
                                    v
                                 
                              
                           
                         centered on the human body are computed during the off-line stage (following Eq. (7)) and stored for online use.
                           3
                           The training views considered in this work are not exactly frontal explaining why 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          
                                             
                                                Π
                                             
                                             
                                                v
                                             
                                          
                                          ←
                                          
                                             
                                                Φ
                                             
                                             
                                                v
                                             
                                          
                                       
                                    
                                 
                               are taken into account.
                        
                        
                           3
                         Each vertical plane 
                           
                              
                                 
                                    Π
                                 
                                 
                                    v
                                 
                              
                           
                         is spanned by the vertical 
                           
                              Z
                           
                        -axis and a reference horizontal vector 
                           
                              
                                 
                                    G
                                 
                                 
                                    v
                                 
                              
                              ∈
                              (
                              
                                 
                                    Π
                                 
                                 
                                    v
                                 
                              
                              ∧
                              
                                 
                                    Π
                                 
                                 
                                    gd
                                 
                              
                              )
                           
                        . Examples of projection on a vertical plane are given for 3 of the 8 MoBo training views in Fig. 6
                        . The perspective distortion, particularly severe in the front view (large head and short legs), is corrected: the image appears distorted but the global figure recovers real morphological proportions in the front view (Fig. 6a) while we can observe how the transformation tends to place the feet at the same vertical position and remove the perspective effect for the rear-diagonal (Fig. 6b) view.

Given a test image 
                           
                              I
                           
                         with an observed human at location 
                           
                              (
                              X
                              ,
                              Y
                              )
                           
                         on the ground plane 
                           
                              
                                 
                                    Π
                                 
                                 
                                    gd
                                 
                              
                           
                        , the azimuth 
                           
                              θ
                              ∈
                              [
                              -
                              π
                              ,
                              π
                              ]
                           
                         (i.e., camera viewpoint or the subject’s orientation w.r.t. the camera) is defined on the ground as:
                           
                              (11)
                              
                                 θ
                                 =
                                 
                                    
                                       CV
                                    
                                    
                                       ^
                                    
                                 
                                 ,
                              
                           
                        where vectors 
                           
                              C
                              
                              and
                              
                              V
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                         are the projections on the ground plane 
                           
                              
                                 
                                    Π
                                 
                                 
                                    gd
                                 
                              
                           
                         of the camera viewing direction and the orientation vector respectively.
                           4
                           The angle 
                                 
                                    θ
                                 
                               is 
                                 
                                    π
                                 
                               when the subject is facing the camera and 
                                 
                                    θ
                                 
                               is 0 when facing away.
                        
                        
                           4
                         The viewing direction is defined as the line connecting the subject and camera (originating from the camera center) and the orientation direction is a vector perpendicular to the shoulder line of the subject pointing in the direction he or she is facing (see Fig. 6). Note that 
                           
                              C
                           
                         is easily evaluated as:
                           
                              (12)
                              
                                 C
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                   -
                                                   X
                                                   
                                                      
                                                         
                                                      
                                                      
                                                         C
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   Y
                                                   -
                                                   Y
                                                   
                                                      
                                                         
                                                      
                                                      
                                                         C
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              (
                              
                                 
                                    X
                                 
                                 
                                    C
                                 
                              
                              ,
                              
                                 
                                    Y
                                 
                                 
                                    C
                                 
                              
                              )
                           
                         is the projection on the ground plane of the camera center.
                           5
                           As indicated in [63], the vanishing point is the image of the vertical “footprint” of the camera centre on the ground plane, i.e., 
                                 
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                ̲
                                             
                                          
                                       
                                       
                                          C
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                H
                                             
                                             
                                                g
                                             
                                          
                                          )
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    ·
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                ̲
                                             
                                          
                                       
                                       
                                          Z
                                       
                                    
                                 
                               with 
                                 
                                    
                                       
                                          X
                                       
                                       
                                          C
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          C
                                       
                                    
                                    ,
                                    
                                       
                                          Y
                                       
                                       
                                          C
                                       
                                    
                                    )
                                 
                              .
                        
                        
                           5
                         The direction of 
                           
                              V
                           
                         can be found by rotating 
                           
                              C
                           
                         around the Z-axis if 
                           
                              θ
                           
                         is known:
                           
                              (13)
                              
                                 V
                                 ∝
                                 R
                                 (
                                 θ
                                 )
                                 ·
                                 C
                                 ,
                              
                           
                        where 
                           
                              R
                              (
                              ·
                              )
                           
                         denotes a 
                           
                              2
                              ×
                              2
                           
                         rotation matrix.

Given 
                           
                              
                                 
                                    {
                                    
                                       
                                          θ
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                v
                                             
                                          
                                          V
                                       
                                       
                                          ^
                                       
                                    
                                    }
                                 
                                 
                                    v
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          v
                                       
                                    
                                 
                              
                           
                         the 
                           
                              
                                 
                                    N
                                 
                                 
                                    v
                                 
                              
                           
                         training values for 
                           
                              θ
                           
                         (c.f. Table 1
                        ) and given an estimation of 
                           
                              θ
                           
                         for the observed subject, a training view 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    v
                                 
                              
                           
                         is selected so that:
                           
                              (14)
                              
                                 v
                                 =
                                 arg
                                 
                                    
                                       
                                          min
                                       
                                       
                                          v
                                          ∈
                                          {
                                          1
                                          ,
                                          
                                             
                                                N
                                             
                                             
                                                v
                                             
                                          
                                          }
                                       
                                    
                                 
                                 |
                                 θ
                                 -
                                 
                                    
                                       θ
                                    
                                    
                                       v
                                    
                                 
                                 |
                                 .
                              
                           
                        The transformation 
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          Φ
                                       
                                       
                                          v
                                       
                                    
                                    
                                       
                                          Π
                                       
                                       
                                          v
                                       
                                    
                                    I
                                 
                              
                           
                         (illustrated in Fig. 6) between input image 
                           
                              I
                              
                              and
                              
                              
                                 
                                    Φ
                                 
                                 
                                    v
                                 
                              
                           
                         through the vertical plane 
                           
                              
                                 
                                    Π
                                 
                                 
                                    v
                                 
                              
                           
                         can then potentially be obtained as the product:
                           
                              (15)
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             v
                                          
                                       
                                       
                                          
                                             Π
                                          
                                          
                                             v
                                          
                                       
                                       I
                                    
                                 
                                 =
                                 
                                    
                                       H
                                    
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             v
                                          
                                       
                                       ←
                                       
                                          
                                             Π
                                          
                                          
                                             v
                                          
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       H
                                    
                                    
                                       
                                          
                                             Π
                                          
                                          
                                             v
                                          
                                       
                                       ←
                                       I
                                    
                                 
                                 ,
                              
                           
                        up to a rotational ambiguity. The problem now consists of finding the plane 
                           
                              
                                 
                                    Π
                                 
                                 
                                    v
                                 
                              
                           
                         in the image 
                           
                              I
                           
                        , i.e., the vanishing points of the 3D directions, and compute 
                           
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          Π
                                       
                                       
                                          v
                                       
                                    
                                    ←
                                    I
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          I
                                          ←
                                          
                                             
                                                Π
                                             
                                             
                                                v
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                         from Eq. (7). The plane 
                           
                              
                                 
                                    Π
                                 
                                 
                                    v
                                 
                              
                           
                         is spanned by the vertical Z-axis and a horizontal axis 
                           
                              G
                              =
                              
                                 
                                    G
                                 
                                 
                                    v
                                 
                              
                           
                         which can be found in the real 3D world by rotating 
                           
                              V
                           
                         about the Z-axis:
                           
                              (16)
                              
                                 G
                                 ∝
                                 R
                                 (
                                 
                                    
                                       
                                          
                                             VG
                                          
                                          
                                             v
                                          
                                       
                                    
                                    
                                       ^
                                    
                                 
                                 )
                                 ·
                                 V
                                 .
                              
                           
                        The training values for 
                           
                              
                                 
                                    
                                       
                                          VG
                                       
                                       
                                          v
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                         are given in Table 1. Two real world 3D points 
                           
                              
                                 
                                    X
                                 
                                 
                                    L
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    R
                                 
                              
                           
                         are then selected on the ground floor along the G-axis at each side of the subject (see Fig. 7
                        a). In practice, we select 2 points at 50cm from the subject. 
                           
                              
                                 
                                    X
                                 
                                 
                                    L
                                 
                              
                              
                              and
                              
                              
                                 
                                    X
                                 
                                 
                                    R
                                 
                              
                           
                         are then reprojected in the image 
                           
                              I
                           
                         obtaining 
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    L
                                 
                              
                              =
                              
                                 
                                    H
                                 
                                 
                                    g
                                 
                              
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    L
                                 
                              
                              
                              and
                              
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    R
                                 
                              
                              =
                              
                                 
                                    H
                                 
                                 
                                    g
                                 
                              
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    R
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    L
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    R
                                 
                              
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                           
                         are expressed in the ground plane coordinates. These two image points can be used to localize the vanishing point 
                           
                              
                                 
                                    v
                                 
                                 
                                    G
                                 
                              
                           
                         along real-world G-axis in the image (Fig. 7b) as follows:
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             ̲
                                          
                                       
                                    
                                    
                                       G
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ̲
                                          
                                       
                                    
                                    
                                       L
                                    
                                 
                                 ×
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ̲
                                          
                                       
                                    
                                    
                                       R
                                    
                                 
                                 )
                                 ×
                                 l
                                 ,
                              
                           
                        where 
                           
                              ×
                           
                         represents the vector product, and 
                           
                              l
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                           
                         is the vanishing line of the ground plane (see [63] for details).

The computation of 
                           
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          Π
                                       
                                       
                                          v
                                       
                                    
                                    ←
                                    I
                                 
                              
                           
                         relating the input image with the selected vertical plane is then obtained following Eq. (7). The scale factor 
                           
                              α
                           
                         in Eq. (7) is evaluated using four known coplanar points
                           6
                           Note that even if four points have been considered in our implementation, three points would be sufficient.
                        
                        
                           6
                         in the real-world vertical plane 
                           
                              
                                 
                                    Π
                                 
                                 
                                    v
                                 
                              
                              :
                              
                                 
                                    X
                                 
                                 
                                    L
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    R
                                 
                              
                           
                         (from above), the subject’s ground floor location 
                           
                              
                                 
                                    X
                                 
                                 
                                    F
                                 
                              
                              
                              and
                              
                              
                                 
                                    X
                                 
                                 
                                    H
                                 
                              
                           
                        , the center of the subject’s head, i.e., the vertical projection on the head plane 
                           
                              
                                 
                                    Π
                                 
                                 
                                    h
                                 
                              
                           
                         of the ground floor location (see Fig. 7a). The images 
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    L
                                 
                              
                              =
                              
                                 
                                    H
                                 
                                 
                                    g
                                 
                              
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    L
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    R
                                 
                              
                              =
                              
                                 
                                    H
                                 
                                 
                                    g
                                 
                              
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    R
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    F
                                 
                              
                              =
                              
                                 
                                    H
                                 
                                 
                                    g
                                 
                              
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    F
                                 
                              
                              
                              and
                              
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    H
                                 
                              
                              =
                              
                                 
                                    H
                                 
                                 
                                    h
                                 
                              
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    H
                                 
                              
                           
                         of these four points in 
                           
                              I
                           
                         (Fig. 7b) are reprojected in the plane 
                           
                              
                                 
                                    Π
                                 
                                 
                                    v
                                 
                              
                           
                         using 
                           
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          Π
                                       
                                       
                                          v
                                       
                                    
                                    ←
                                    I
                                 
                              
                           
                         obtaining 
                           
                              
                                 
                                    X
                                 
                                 
                                    L
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    R
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    F
                                 
                                 
                                    ′
                                 
                              
                              
                              and
                              
                              
                                 
                                    X
                                 
                                 
                                    H
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                         (Fig. 7c). The scale factor 
                           
                              α
                           
                         in 
                           
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          Π
                                       
                                       
                                          v
                                       
                                    
                                    ←
                                    I
                                 
                              
                           
                         is then computed so that the height to width ratio stays constant between the set of reprojected points 
                           
                              {
                              
                                 
                                    X
                                 
                                 
                                    L
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    R
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    F
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    H
                                 
                                 
                                    ′
                                 
                              
                              }
                           
                         and the original real-world points 
                           
                              {
                              
                                 
                                    X
                                 
                                 
                                    L
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    R
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    F
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    H
                                 
                              
                              }
                           
                        , i.e.,
                           
                              (18)
                              
                                 
                                    
                                       |
                                       |
                                       
                                          
                                             X
                                          
                                          
                                             H
                                          
                                       
                                       -
                                       
                                          
                                             X
                                          
                                          
                                             F
                                          
                                       
                                       |
                                       |
                                    
                                    
                                       |
                                       |
                                       
                                          
                                             X
                                          
                                          
                                             R
                                          
                                       
                                       -
                                       
                                          
                                             X
                                          
                                          
                                             L
                                          
                                       
                                       |
                                       |
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       |
                                       
                                          
                                             X
                                          
                                          
                                             H
                                          
                                          
                                             ′
                                          
                                       
                                       -
                                       
                                          
                                             X
                                          
                                          
                                             F
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                       |
                                    
                                    
                                       |
                                       |
                                       
                                          
                                             X
                                          
                                          
                                             R
                                          
                                          
                                             ′
                                          
                                       
                                       -
                                       
                                          
                                             X
                                          
                                          
                                             L
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                       |
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       |
                                       
                                          
                                             h
                                          
                                          
                                             α
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             H
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       -
                                       
                                          
                                             h
                                          
                                          
                                             α
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             F
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       |
                                       |
                                    
                                    
                                       |
                                       |
                                       
                                          
                                             h
                                          
                                          
                                             α
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             R
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       -
                                       
                                          
                                             h
                                          
                                          
                                             α
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             L
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       |
                                       |
                                    
                                 
                                 ,
                              
                           
                        where for ease of notation, we define the one-to-one mapping function 
                           
                              
                                 
                                    h
                                 
                                 
                                    α
                                 
                              
                              :
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              
                              ↦
                              
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                         which transforms image points to plane 
                           
                              
                                 
                                    Π
                                 
                                 
                                    v
                                 
                              
                           
                         using the homography 
                           
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          Π
                                       
                                       
                                          v
                                       
                                    
                                    ←
                                    I
                                 
                              
                           
                        : 
                           
                              X
                              =
                              
                                 
                                    h
                                 
                                 
                                    α
                                 
                              
                              (
                              x
                              )
                              ⇔
                              
                                 
                                    X
                                 
                                 
                                    ̲
                                 
                              
                              =
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          Π
                                       
                                       
                                          v
                                       
                                    
                                    ←
                                    I
                                 
                              
                              ·
                              
                                 
                                    x
                                 
                                 
                                    ̲
                                 
                              
                           
                        . In our case, we assume the head is at 170cm from the floor (average human height) and select 
                           
                              
                                 
                                    X
                                 
                                 
                                    L
                                 
                              
                              
                              and
                              
                              
                                 
                                    X
                                 
                                 
                                    R
                                 
                              
                           
                         to be 100cm apart, we thus have to find 
                           
                              α
                           
                         which minimizes:
                           
                              (19)
                              
                                 E
                                 (
                                 α
                                 )
                                 
                                 ≜
                                 
                                 
                                    
                                       
                                          1.7
                                          -
                                          
                                             
                                                |
                                                |
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      α
                                                   
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      H
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                -
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      α
                                                   
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      F
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                |
                                                |
                                             
                                             
                                                |
                                                |
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      α
                                                   
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      R
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                -
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      α
                                                   
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      L
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                |
                                                |
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        i.e., a convex optimization problem which is easily solved by gradient descent search.

Finally, once 
                           
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          Π
                                       
                                       
                                          v
                                       
                                    
                                    ←
                                    I
                                 
                              
                           
                         has been calculated, 
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          Φ
                                       
                                       
                                          v
                                       
                                    
                                    
                                       
                                          Π
                                       
                                       
                                          v
                                       
                                    
                                    I
                                 
                              
                           
                         can be computed using Eq. (15). The rotational ambiguity in choosing the coordinate system is resolved using the same four points and checking that the vectors 
                           
                              U
                              ,
                              
                                 
                                    U
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                           
                         resulting from the two cross products 
                           
                              U
                              =
                              
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             L
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             R
                                          
                                       
                                    
                                 
                              
                              ×
                              
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             F
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             H
                                          
                                       
                                    
                                 
                              
                              
                              and
                              
                              
                                 
                                    U
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             L
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             R
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                              ×
                              
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             F
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             H
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           
                         point in the same direction, otherwise the G-axis is flipped in matrix 
                           
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          Π
                                       
                                       
                                          v
                                       
                                    
                                    ←
                                    I
                                 
                              
                           
                        . Eq. (15) becomes:
                           
                              (20)
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             v
                                          
                                       
                                       
                                          
                                             Π
                                          
                                          
                                             v
                                          
                                       
                                       I
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               v
                                                            
                                                         
                                                         ←
                                                         
                                                            
                                                               Π
                                                            
                                                            
                                                               v
                                                            
                                                         
                                                      
                                                   
                                                   ·
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         
                                                            
                                                               Π
                                                            
                                                            
                                                               v
                                                            
                                                         
                                                         ←
                                                         I
                                                      
                                                   
                                                   
                                                   if
                                                   
                                                   U
                                                   ·
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ⩾
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               v
                                                            
                                                         
                                                         ←
                                                         
                                                            
                                                               Π
                                                            
                                                            
                                                               v
                                                            
                                                         
                                                      
                                                   
                                                   ·
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     -
                                                                     1
                                                                  
                                                                  
                                                                     0
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                               
                                                                  
                                                                     0
                                                                  
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                               
                                                                  
                                                                     0
                                                                  
                                                                  
                                                                     0
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ·
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         
                                                            
                                                               Π
                                                            
                                                            
                                                               v
                                                            
                                                         
                                                         ←
                                                         I
                                                      
                                                   
                                                   
                                                   otherwise.
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The entire process leading to the computation of the projective transformation 
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          Φ
                                       
                                       
                                          v
                                       
                                    
                                    
                                       
                                          Π
                                       
                                       
                                          v
                                       
                                    
                                    I
                                 
                              
                           
                         is summarized in Algorithm 1.
                           Algorithm 1
                           Projection Image to Training View. 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: Triplet 
                                                   
                                                      (
                                                      X
                                                      ,
                                                      Y
                                                      ,
                                                      θ
                                                      )
                                                   
                                                .
                                          
                                          
                                             
                                                Output: Projective Transformation 
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            
                                                               
                                                                  Φ
                                                               
                                                               
                                                                  v
                                                               
                                                            
                                                            
                                                               
                                                                  Π
                                                               
                                                               
                                                                  v
                                                               
                                                            
                                                            I
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             
                                                
                                                   
                                                      •
                                                      Select the training view 
                                                            
                                                               
                                                                  
                                                                     Φ
                                                                  
                                                                  
                                                                     v
                                                                  
                                                               
                                                            
                                                          (Eq. (14));
                                                   
                                                   
                                                      •
                                                      Compute camera viewing direction 
                                                            
                                                               C
                                                            
                                                          (Eq. (12));
                                                   
                                                   
                                                      •
                                                      Find orientation vector 
                                                            
                                                               V
                                                            
                                                          (Eq. (13));
                                                   
                                                   
                                                      •
                                                      Find the real-world G-axis defining 
                                                            
                                                               
                                                                  
                                                                     Π
                                                                  
                                                                  
                                                                     v
                                                                  
                                                               
                                                            
                                                          (Eq. (16));
                                                   
                                                   
                                                      •
                                                      Localize the vanishing point 
                                                            
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     G
                                                                  
                                                               
                                                            
                                                          using Eq. (17);
                                                   
                                                   
                                                      •
                                                      Calculate 
                                                            
                                                               
                                                                  
                                                                     H
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           Π
                                                                        
                                                                        
                                                                           v
                                                                        
                                                                     
                                                                     ←
                                                                     I
                                                                  
                                                               
                                                               =
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           H
                                                                        
                                                                        
                                                                           I
                                                                        
                                                                     
                                                                     ←
                                                                     
                                                                        
                                                                           Π
                                                                        
                                                                        
                                                                           v
                                                                        
                                                                     
                                                                     )
                                                                  
                                                                  
                                                                     -
                                                                     1
                                                                  
                                                               
                                                            
                                                          using Eq. (7);
                                                   
                                                   
                                                      •
                                                      Compute the scale factor 
                                                            
                                                               α
                                                            
                                                          (Eq. (19));
                                                   
                                                   
                                                      •
                                                      Calculate 
                                                            
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           Φ
                                                                        
                                                                        
                                                                           v
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           Π
                                                                        
                                                                        
                                                                           v
                                                                        
                                                                     
                                                                     I
                                                                  
                                                               
                                                            
                                                          using Eq. (20).
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

@&#EXPERIMENTS@&#

We now experimentally validate the proposed projective transformation within two different types of motion analysis framework. In Section 4.1, we consider a bottom-up image analysis scheme where the ground plane position 
                        
                           (
                           X
                           ,
                           Y
                           )
                        
                      and the camera viewpoint 
                        
                           θ
                        
                      are estimated deterministically using a Kalman filter. Our transformation 
                        
                           
                              
                                 P
                              
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       v
                                    
                                 
                                 
                                    
                                       Π
                                    
                                    
                                       v
                                    
                                 
                                 I
                              
                           
                        
                      is then used to align the input image to one of the training planes and process it with the corresponding view-based silhouette model. In Section 4.2, we employ our homography based alignment within a top-down pose tracking framework where 
                        
                           X
                           ,
                           Y
                           ,
                           θ
                        
                      and a body pose parameter are sampled and estimated stochastically. The corresponding candidate silhouettes are then transformed using the inverse projection 
                        
                           
                              
                                 P
                              
                              
                                 I
                                 
                                    
                                       Π
                                    
                                    
                                       v
                                    
                                 
                                 
                                    
                                       Φ
                                    
                                    
                                       v
                                    
                                 
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             v
                                          
                                       
                                       
                                          
                                             Π
                                          
                                          
                                             v
                                          
                                       
                                       I
                                    
                                 
                                 )
                              
                              
                                 -
                                 1
                              
                           
                        
                      and matched in the original input image. In both cases, we use the 8 training viewpoints from the Mobo dataset for training and the annotated sequences from Caviar [21] for testing.

One of the bottlenecks of deterministic frameworks is that the estimation of the location can be relatively noisy. First, in Section 4.1.1, we analyze how well our projective transformation can potentially work in case of a perfect tracker that we simulate using ground truth data. We conduct a qualitative evaluation employing manually labelled head locations to generate ground truth data for triplets 
                           
                              (
                              X
                              ,
                              Y
                              ,
                              θ
                              )
                           
                         in several sequences. Next, we apply our homography within a real bottom-up framework from [46] in Section 4.1.2. Finally, we numerically evaluate how well our homographic alignment can work with a noisy tracker in Section 4.1.3 and discuss the different results in Section 4.1.4.

A series of gait sequences are first selected from Caviar: in these sequences people are walking in various directions and the changing perspective effect can be observed. For each sequence, the trajectory 
                              
                                 
                                    
                                       {
                                       
                                          
                                             X
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             Y
                                          
                                          
                                             t
                                          
                                       
                                       }
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                            on the ground floor is directly recovered from the manual labelling using 
                              
                                 
                                    
                                       H
                                    
                                    
                                       h
                                    
                                 
                              
                            which relates the head plane in the image with the ground plane 
                              
                                 
                                    
                                       Π
                                    
                                    
                                       gd
                                    
                                 
                              
                           . Supposing that the subject is facing in the direction of motion, we estimate the direction 
                              
                                 
                                    
                                       V
                                    
                                    
                                       t
                                    
                                 
                              
                            and consequently the viewpoint angle 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       t
                                    
                                 
                              
                            at time t from the trajectory 
                              
                                 
                                    
                                       {
                                       
                                          
                                             X
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             Y
                                          
                                          
                                             t
                                          
                                       
                                       }
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           :
                              
                                 (21)
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    arccos
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   ·
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                                
                                                   |
                                                   |
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   |
                                                   |
                                                   ·
                                                   |
                                                   |
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   |
                                                   |
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           with 
                              
                                 
                                    
                                       V
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             X
                                          
                                          
                                             t
                                          
                                       
                                       -
                                       
                                          
                                             X
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             Y
                                          
                                          
                                             t
                                          
                                       
                                       -
                                       
                                          
                                             Y
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                       ]
                                    
                                    
                                       T
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                              
                            from Eq. (12). Projections on training plane obtained using the resulting data 
                              
                                 
                                    
                                       {
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             Y
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             t
                                          
                                       
                                       )
                                       }
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                            are given in Fig. 8
                           . For each presented sequence, we show (from top to bottom) the trajectory in the image and its projection on the real-world ground plane 
                              
                                 
                                    
                                       {
                                       
                                          
                                             X
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             Y
                                          
                                          
                                             t
                                          
                                       
                                       }
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           , the extracted subimages, the viewpoints 
                              
                                 
                                    
                                       {
                                       
                                          
                                             θ
                                          
                                          
                                             t
                                          
                                       
                                       }
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                            with corresponding training views and, finally, the transformed sub-images 
                              
                                 
                                    
                                       I
                                    
                                    
                                       θ
                                       ,
                                       X
                                       ,
                                       Y
                                    
                                 
                              
                            for several selected frames. We can observe the smoothness of the different trajectories and how the viewpoint 
                              
                                 θ
                              
                            slowly changes along the sequences. The regions of interest around the subjects are normalized and projected onto the adequate model plane and the perspective distortion seems corrected. The resulting warped images could be processed using a view-based model.

Instead of employing the manual labelling to generate ground truth data for triplets 
                              
                                 (
                                 X
                                 ,
                                 Y
                                 ,
                                 θ
                                 )
                              
                            as we previously did in Section 4.1.1, we use a head-tracker based on Kalman filter to estimate the head location in consecutive frames and ensure an automatic and reliable estimation of the ground plane trajectory 
                              
                                 
                                    
                                       {
                                       
                                          
                                             X
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             Y
                                          
                                          
                                             t
                                          
                                       
                                       }
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           . Because of its low shape variability and its top position in the body, the human head is relatively easy to detect, especially in overhead camera views where it is usually less likely to be occluded. Many authors propose computing the vertical histogram of the foreground blob and scanning it, searching for peaks as possible head candidates [26,64]. This approach is not robust against occlusions and cannot detect the heads “inside” a detection blob as in Fig. 9
                           a. In [68], the authors extend this head candidates search by using a head-shoulder model. Following this approach, we train a similar head shape model and, when given a selected blob (filtered w.r.t its size, position and area), we compute the possible head candidates by searching for local peaks (local maxima) in the direction towards the vertical vanishing point 
                              
                                 
                                    
                                       v
                                    
                                    
                                       Z
                                    
                                 
                              
                           . We also compute the feet candidates (local minima) and the corresponding probable head location (see Fig. 9b) using the scene calibration, i.e 
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ̲
                                          
                                       
                                    
                                    
                                       H
                                    
                                 
                                 =
                                 
                                    
                                       H
                                    
                                    
                                       h
                                    
                                 
                                 ·
                                 
                                    
                                       H
                                    
                                    
                                       g
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ̲
                                          
                                       
                                    
                                    
                                       F
                                    
                                 
                              
                           . The head shape model is then applied to all the selected head candidates and the confidence weight of each hypothesis is evaluated by edge matching error. Non-human blobs resulting from shadows and reflections are dismissed. An example is given in Fig. 9c.

The system is initialized in the first frames, estimating 
                              
                                 
                                    
                                       x
                                    
                                    
                                       H
                                    
                                 
                              
                            by a rough fitting of the silhouette model as in [68]. A tracking is then applied, the state of the each pedestrian, i.e., the ground plane position 
                              
                                 (
                                 X
                                 ,
                                 Y
                                 )
                              
                           , being estimated at each time step using a Kalman filter. This view-invariant head tracker has shown to be robust, even with difficult cases such as people moving in groups and partial occlusions (see example in Fig. 9d). Again, we suppose that the subject is facing in the direction of motion and estimate the direction 
                              
                                 
                                    
                                       V
                                    
                                    
                                       t
                                    
                                 
                              
                            and consequently the viewpoint angle 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       t
                                    
                                 
                              
                            at time t from the trajectory following Eq. (21). This allows the selection of a training view 
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       v
                                    
                                 
                              
                            and the computation of the projective transformation 
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             v
                                          
                                       
                                       
                                          
                                             Π
                                          
                                          
                                             v
                                          
                                       
                                       I
                                    
                                 
                              
                            following Algorithm 1. The input image is projected and the resulting warped image 
                              
                                 
                                    
                                       I
                                    
                                    
                                       θ
                                       ,
                                       X
                                       ,
                                       Y
                                    
                                 
                              
                            is processed to estimate a pose applying the corresponding view-based pose-shape model from our previous work [46]. The system flowchart is presented in Fig. 10
                           .

We processed the gait sequences from Caviar and obtained good results for the sequences where a single individual is walking. As expected, the system fails with stationary cases because the viewpoint angle is estimated from the direction of motion. An example of a processed sequence is presented in Fig. 11
                            where for each presented frame, we show the candidate Region of Interest in the image, the resulting warped image 
                              
                                 
                                    
                                       I
                                    
                                    
                                       θ
                                       ,
                                       X
                                       ,
                                       Y
                                    
                                 
                              
                            and the obtained pose and silhouette represented on top of 
                              
                                 
                                    
                                       I
                                    
                                    
                                       θ
                                       ,
                                       X
                                       ,
                                       Y
                                    
                                 
                              
                           . We can observe how the direction of motion slowly changes along the sequence and how the images are projected on the selected model plane. The resulting shapes and poses are reasonably good given the complexity of the task (low resolution and perspective effect). However, the reliability of the warping, and consequently the accuracy of the silhouette and pose estimate, seem to strongly depend on the precision with which both ground plane position 
                              
                                 (
                                 X
                                 ,
                                 Y
                                 )
                              
                            and orientation 
                              
                                 θ
                              
                            are estimated.

To numerically evaluate this dependence, independently of the possible errors inherent to the tracking algorithm or to the pose estimation technique (e.g., bad initialization or bad model fitting), we conduct a series of simulations using a set of testing ground truth poses 
                              
                                 {
                                 
                                    
                                       k
                                    
                                    
                                       1
                                    
                                    
                                       GT
                                    
                                 
                                 …
                                 
                                    
                                       k
                                    
                                    
                                       NGT
                                    
                                    
                                       GT
                                    
                                 
                                 }
                              
                            and a set of sampled training poses 
                              
                                 
                                    
                                       {
                                       
                                          
                                             {
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                                
                                                   v
                                                
                                             
                                             }
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                       }
                                    
                                    
                                       v
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             v
                                          
                                       
                                    
                                 
                              
                            (i.e., 
                              
                                 
                                    
                                       N
                                    
                                    
                                       T
                                    
                                 
                              
                            poses for each training view 
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       v
                                    
                                 
                              
                           ). Each pose is made of 13 hand-labelled 2D joints: 
                              
                                 k
                                 =
                                 [
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             13
                                          
                                       
                                    
                                 
                                 ]
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       2
                                       ×
                                       13
                                    
                                 
                              
                           . For each tested frame 
                              
                                 t
                                 ∈
                                 {
                                 1
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       GT
                                    
                                 
                                 }
                              
                           , we compute the projective transformation 
                              
                                 
                                    
                                       P
                                    
                                    
                                       I
                                       
                                          
                                             Π
                                          
                                          
                                             v
                                          
                                       
                                       
                                          
                                             Φ
                                          
                                          
                                             v
                                          
                                       
                                    
                                 
                              
                            using ground truth location 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       t
                                    
                                 
                                 )
                              
                            and viewpoint 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       t
                                    
                                 
                              
                            from above with additive Gaussian white noises (
                              
                                 
                                    
                                       η
                                    
                                    
                                       XY
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       η
                                    
                                    
                                       θ
                                    
                                 
                              
                            of variance 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       XY
                                    
                                    
                                       2
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                              
                            respectively) and align the 
                              
                                 
                                    
                                       N
                                    
                                    
                                       T
                                    
                                 
                              
                            training poses 
                              
                                 {
                                 
                                    
                                       k
                                    
                                    
                                       1
                                    
                                    
                                       v
                                    
                                 
                                 …
                                 
                                    
                                       k
                                    
                                    
                                       NT
                                    
                                    
                                       v
                                    
                                 
                                 }
                              
                            from the selected viewpoint 
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       v
                                    
                                 
                              
                           , obtaining 
                              
                                 {
                                 
                                    
                                       k
                                    
                                    
                                       1
                                       ,
                                       t
                                    
                                    
                                       Hom
                                    
                                 
                                 …
                                 
                                    
                                       k
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                       t
                                    
                                    
                                       Hom
                                    
                                 
                                 }
                              
                            with 
                              
                                 ∀
                                 i
                                 ∈
                                 {
                                 1
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       T
                                    
                                 
                                 }
                              
                           :
                              
                                 (22)
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ̲
                                             
                                          
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          i
                                          ,
                                          t
                                       
                                       
                                          Hom
                                       
                                    
                                    =
                                    
                                       
                                          P
                                       
                                       
                                          I
                                          
                                             
                                                Π
                                             
                                             
                                                v
                                             
                                          
                                          
                                             
                                                Φ
                                             
                                             
                                                v
                                             
                                          
                                       
                                    
                                    ·
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ̲
                                             
                                          
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          i
                                          ,
                                          t
                                       
                                    
                                    ,
                                    ∀
                                    j
                                    ∈
                                    {
                                    1
                                    ,
                                    13
                                    }
                                    .
                                 
                              
                           We then compute the average pose error over the testing set taking the closest aligned pose for each frame t:
                              
                                 (23)
                                 
                                    
                                       
                                          ∊
                                       
                                       
                                          Hom
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                GT
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   GT
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             min
                                          
                                          
                                             i
                                             ∈
                                             {
                                             1
                                             ,
                                             
                                                
                                                   N
                                                
                                                
                                                   T
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          k
                                       
                                       
                                          t
                                       
                                       
                                          GT
                                       
                                    
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          i
                                          ,
                                          t
                                       
                                       
                                          Hom
                                       
                                    
                                    )
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       d
                                    
                                    
                                       k
                                    
                                 
                              
                           , defined as:
                              
                                 (24)
                                 
                                    
                                       
                                          d
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    k
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    
                                    ≜
                                    
                                    
                                       
                                          1
                                       
                                       
                                          13
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             13
                                          
                                       
                                    
                                    |
                                    |
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    |
                                    |
                                 
                              
                           is the average Root Mean Square Error over the 13 2D-joints (called RMS 2D Pose Error from now on).

We repeat the same operation considering a Euclidean 2D similarity transformation 
                              
                                 T
                              
                            to align training poses to the tested images as in [48,13,5,7,15] and compute:
                              
                                 (25)
                                 
                                    
                                       
                                          ∊
                                       
                                       
                                          Sim
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                GT
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   GT
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             min
                                          
                                          
                                             i
                                             ∈
                                             {
                                             1
                                             ,
                                             
                                                
                                                   N
                                                
                                                
                                                   T
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          k
                                       
                                       
                                          t
                                       
                                       
                                          GT
                                       
                                    
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          i
                                          ,
                                          t
                                       
                                       
                                          Sim
                                       
                                    
                                    )
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       k
                                    
                                    
                                       Sim
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       Sim
                                    
                                 
                                 ,
                                 …
                                 .
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             13
                                          
                                       
                                    
                                    
                                       Sim
                                    
                                 
                                 ]
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       2
                                       ×
                                       13
                                    
                                 
                              
                            with:
                              
                                 (26)
                                 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          Sim
                                       
                                    
                                    =
                                    T
                                    ·
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    ,
                                    ∀
                                    j
                                    ∈
                                    {
                                    1
                                    ,
                                    13
                                    }
                                    .
                                 
                              
                           The similarity is defined as:
                              
                                 (27)
                                 
                                    T
                                    ·
                                    x
                                    =
                                    u
                                    +
                                    s
                                    R
                                    (
                                    γ
                                    )
                                    ·
                                    x
                                    ,
                                    ∀
                                    x
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                           in which 
                              
                                 (
                                 u
                                 ,
                                 γ
                                 ,
                                 s
                                 )
                              
                            are offset, rotation angle and scaling factor respectively. These parameters are readily calculated using head center 
                              
                                 
                                    
                                       x
                                    
                                    
                                       H
                                    
                                 
                              
                            and “feet” location on the ground floor 
                              
                                 
                                    
                                       x
                                    
                                    
                                       F
                                    
                                 
                              
                            in training and testing images.

The results obtained when varying 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       XY
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       θ
                                    
                                 
                              
                            are given in Fig. 12
                           . The first observation is that for lower level of noise the proposed homographic alignment outperforms the similarity alignment. If a good localization and viewpoint estimation are provided by the trackking algorithm, the pose estimation is more accurate using the projective transformation (3.5pixels) instead of the similairy transform (4pixels). The average pose error almost linearly increases with increasing localization noise 
                              
                                 
                                    
                                       η
                                    
                                    
                                       XY
                                    
                                 
                              
                            for both alignment methods, slightly more for the proposed homographic alignment (Fig. 12a). A slight noise in the viewpoint estimation 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       θ
                                    
                                 
                                 ⩽
                                 
                                    
                                       π
                                    
                                    
                                       16
                                    
                                 
                              
                            does not seem to affect any of the 2 alignment methods (Fig. 12b). However, while the error with similarity seems to linearly increase with increasing viewpoint noise 
                              
                                 
                                    
                                       η
                                    
                                    
                                       θ
                                    
                                 
                              
                            for higher noise levels, the effect is much more pronounced for the projective alignment. By augmenting 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       θ
                                    
                                 
                              
                           , we slowly increase the possibility of picking the wrong view which has more important consequences when a homography is employed between training and testing view planes instead of a simple Euclidean transformation. The benefit of using a homographic alignment rapidly decreases with the amount of added noise in viewpoint estimation 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       θ
                                    
                                 
                                 ⩾
                                 
                                    
                                       π
                                    
                                    
                                       8
                                    
                                 
                              
                            and the error even gets larger than the one obtained with a similarity transformation for 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       θ
                                    
                                 
                                 ⩾
                                 
                                    
                                       π
                                    
                                    
                                       6
                                    
                                 
                              
                           .

@&#DISCUSSION@&#

Acceptable results have been obtained for sequences with a single walking subject but we identified two main drawbacks: (1) estimating the viewpoint from the trajectory does not allow to handle static cases and (2), more importantly, the pose estimation result greatly depends on the accuracy achieved when estimating both location 
                              
                                 (
                                 X
                                 ,
                                 Y
                                 )
                              
                            and orientation 
                              
                                 θ
                              
                           . This first framework performs sufficiently well when an accurate estimation of both ground plane location and orientation (i.e., viewpoint) can be made but, with high levels of noise, the effect on pose estimation is much more pronounced for our proposed projective alignment.

Our numerical experiments show that if a good estimation can be made of both ground plane location 
                              
                                 (
                                 X
                                 ,
                                 Y
                                 )
                              
                            and viewpoint 
                              
                                 θ
                              
                           , the proposed projective transformation outperforms the commonly employed similarity transform. Other types of detector which incorporate an estimation of the orientation 
                              
                                 θ
                              
                            could be considered in future work to avoid estimating it from the trajectory. For example, multi-class detector such as [13,14] or head-shoulder detector could be combined with [39] to track people and estimate the orientation 
                              
                                 θ
                              
                            in perspective video sequences.

We now show how our proposed projective transformation can be used to deform a candidate silhouette, in a particular filter paradigm, before its top-down matching in the image. We evaluate this homographic alignment when employed within the tracking framework that we proposed in [49]. In this section, we show that our method works better than the commonly used similarity alignment which was used in [7,13,15,48].


                           Fig. 13
                            shows how the proposed projective transformation fits in a whole human motion analysis framework. A stochastic approach is followed for estimating both location and viewpoint, and the optimum projective transformation for pose recognition is estimated by sampling multiple possible values for 
                              
                                 θ
                              
                            at multiple locations 
                              
                                 (
                                 X
                                 ,
                                 Y
                                 )
                              
                           . Applying a different projective transformation to the input image for each sampled triplet 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       (
                                       n
                                       )
                                    
                                 
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       (
                                       n
                                       )
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       (
                                       n
                                       )
                                    
                                 
                                 )
                              
                            and processing each resulting warped image in a bottom-up manner as in the previous section would be computationally inefficient. Instead a top-down approach is followed where for each triplet, a silhouette 
                              
                                 
                                    
                                       s
                                    
                                    
                                       t
                                    
                                    
                                       (
                                       n
                                       )
                                    
                                 
                              
                            is sampled, transformed using the inverse projection 
                              
                                 
                                    
                                       P
                                    
                                    
                                       I
                                       
                                          
                                             Π
                                          
                                          
                                             v
                                          
                                       
                                       
                                          
                                             Φ
                                          
                                          
                                             v
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             
                                                
                                                   Φ
                                                
                                                
                                                   v
                                                
                                             
                                             
                                                
                                                   Π
                                                
                                                
                                                   v
                                                
                                             
                                             I
                                          
                                       
                                       )
                                    
                                    
                                       -
                                       1
                                    
                                 
                              
                            and later matched in the original input image. A low dimensional torus manifold for camera viewpoint and pose parameter is used to model 3D walking poses as in [5]. This manifold is mapped to the view-based silhouette manifolds using kernel-based regressors, which are learnt using a Relevance Vector Machine (RVM). Given a point on the surface of the torus, the resulting generative model can regress the corresponding pose and view-based silhouette.

During the online stage, 3D body poses are thus tracked using a recursive Bayesian sampling conducted jointly over the scene’s ground plane and this pose-viewpoint torus manifold, in a 4-dimensional state space defined as:
                              
                                 (28)
                                 
                                    
                                       
                                          χ
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    [
                                    
                                       
                                          X
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          t
                                       
                                    
                                    ]
                                    ,
                                 
                              
                           consisting of the ground plane location 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       t
                                    
                                 
                                 )
                              
                            and the coordinates on the torus surface 
                              
                                 (
                                 
                                    
                                       μ
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 ∈
                                 [
                                 0
                                 ,
                                 1
                                 )
                                 ×
                                 [
                                 -
                                 π
                                 ,
                                 π
                                 ]
                              
                           . For each sample n, the homography 
                              
                                 
                                    
                                       P
                                    
                                    
                                       I
                                       
                                          
                                             Π
                                          
                                          
                                             v
                                          
                                       
                                       
                                          
                                             Φ
                                          
                                          
                                             v
                                          
                                       
                                    
                                 
                              
                            relating the corresponding training plane to the image points, calculated following Algorithm 1, is thus employed to project the associated regressed silhouette shape 
                              
                                 
                                    
                                       s
                                    
                                    
                                       t
                                    
                                    
                                       (
                                       n
                                       )
                                    
                                 
                              
                            obtaining 
                              
                                 
                                    
                                       s
                                    
                                    
                                       t
                                    
                                    
                                       ′
                                       (
                                       n
                                       )
                                    
                                 
                              
                            which is later matched in the image to estimate its likelihood and consequently the importance weight 
                              
                                 
                                    
                                       π
                                    
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                              
                           .

The state 
                              
                                 
                                    
                                       
                                          
                                             χ
                                          
                                          
                                             t
                                          
                                       
                                    
                                    
                                       ^
                                    
                                 
                              
                            is computed at each time step by using a Monte Carlo approximation of the expectation of the posterior pdf, i.e., a weighted sum over the set of samples: 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   χ
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       MC
                                    
                                 
                                 =
                                 E
                                 [
                                 
                                    
                                       χ
                                    
                                    
                                       t
                                    
                                 
                                 ]
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       χ
                                    
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                              
                           , where 
                              
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                              
                            stands for the normalized weight assigned to each particle n. This leads to the estimation of a 2D pose 
                              
                                 
                                    
                                       
                                          
                                             k
                                          
                                          
                                             t
                                          
                                       
                                    
                                    
                                       ^
                                    
                                 
                              
                            which is used for numerical evaluation in the next section. To deal with multiple targets, we instantiate several independent 1-subject trackers and model each subject’s 3-D occupancy on the ground floor with a Gaussian probability function centered on the subject’s estimated location that is employed to downweight the particles from the other targets. The approach proposed in [69] could be employed to deal with more severe occlusions.

To demonstrate the efficiency of the proposed projective transformation, we process a set of 11 sequences from the Caviar dataset [21] and present a numerical evaluation for 
                              
                                 
                                    
                                       N
                                    
                                    
                                       GT
                                    
                                 
                                 =
                                 2784
                              
                            poses 
                              
                                 
                                    
                                       k
                                    
                                    
                                       t
                                    
                                    
                                       GT
                                    
                                 
                              
                            which have been manually labelled. More details on this test dataset can be found in [49]. Since randomness is involved in the sampling procedure, to gain statistical significance, we perform the same experiments 20 times and compute numerical result as the average over these 20 runs. We consider that a target has been lost and the localization is not valid if the minimum distance (in the set of particles) to ground truth location exceeds 1 meter, i.e., 
                              
                                 
                                    
                                       min
                                    
                                    
                                       n
                                       ∈
                                       {
                                       1
                                       ,
                                       N
                                       }
                                    
                                 
                                 (
                                 |
                                 |
                                 
                                    
                                       χ
                                    
                                    
                                       t
                                    
                                    
                                       GT
                                    
                                 
                                 -
                                 
                                    
                                       χ
                                    
                                    
                                       t
                                    
                                    
                                       (
                                       n
                                       )
                                    
                                 
                                 |
                                 
                                    
                                       |
                                    
                                    
                                       gd
                                    
                                 
                                 )
                                 ⩾
                                 100
                                 
                                 cm
                              
                           , where 
                              
                                 |
                                 |
                                 ·
                                 |
                                 
                                    
                                       |
                                    
                                    
                                       gd
                                    
                                 
                              
                            is the Euclidean distance on the ground floor. We believe that a pose estimation does not make sense if the nearest particle is 1 meter away. A track is then considered lost when then the target has been lost during 20 frames or more and has not been recovered in the last frame of the sequence.

Numerical results show that the proposed homographic alignment reduces the average percentage of lost tracks as can be observed in Fig. 14
                           a. The percentage of lost tracks decreases with the number of particles employed in the filter for both methods, but we reach 0% of lost tracks with 1000 particles and over while 5% of the tracks are still lost when considering 2000 particles and a similarity transformation. The perspective correction allows for better shape matching and consequently a more efficient shape-based tracking. If we compute the number of valid localizations, defined as the cases where the distance between the nearest particle and ground truth location is below 1m, the tracker loses fewer targets when a homographic alignment is used rather than a similarity alignment (see Fig. 14b). We even reach an average of 99% of valid localizations above 1000 particles.

The pose estimation performances, computed as the RMS distance 
                              
                                 
                                    
                                       d
                                    
                                    
                                       k
                                    
                                 
                              
                            in pixels (see Eq. (24)) between evaluated 2D poses 
                              
                                 
                                    
                                       
                                          
                                             k
                                          
                                          
                                             t
                                          
                                       
                                    
                                    
                                       ^
                                    
                                 
                              
                            and ground truth poses 
                              
                                 
                                    
                                       k
                                    
                                    
                                       t
                                    
                                    
                                       GT
                                    
                                 
                              
                           , are depicted in Fig. 14c. We can observe how the 2D pose error decreases with the number of particles and how the framework, again, performs better when a projective transformation is used and allows for a more accurate pose estimation.

We then carry out a deeper analysis of the different results and compute the different rates in function of the distance between the subject and the camera. In Table 2
                           , we present the average percentage of missed localizations, the average 2D pose error 
                              
                                 
                                    
                                       d
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       k
                                    
                                    
                                       t
                                    
                                    
                                       GT
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             k
                                          
                                          
                                             t
                                          
                                       
                                    
                                    
                                       ^
                                    
                                 
                                 )
                              
                            and the average ground plane location error 
                              
                                 |
                                 |
                                 
                                    
                                       χ
                                    
                                    
                                       t
                                    
                                    
                                       GT
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             χ
                                          
                                          
                                             t
                                          
                                       
                                    
                                    
                                       ^
                                    
                                 
                                 |
                                 
                                    
                                       |
                                    
                                    
                                       gd
                                    
                                 
                              
                            varying the size of the particles sets. Results are presented for 3 different maximum distances 
                              
                                 
                                    
                                       D
                                    
                                    
                                       max
                                    
                                 
                              
                            to the camera
                              7
                              The distance to the camera D is computed a the Euclidean distance between 
                                    
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             C
                                          
                                       
                                       ,
                                       
                                          
                                             Y
                                          
                                          
                                             C
                                          
                                       
                                       )
                                    
                                 , the projection on the ground plane of the camera center, and 
                                    
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             GT
                                          
                                       
                                       ,
                                       
                                          
                                             Y
                                          
                                          
                                             GT
                                          
                                       
                                       )
                                    
                                  the ground truth location.
                           
                           
                              7
                           : 5, 10 and 15m. Note that the different values are computed using the poses from 0m up to the given distance 
                              
                                 
                                    
                                       D
                                    
                                    
                                       max
                                    
                                 
                              
                           . In the middle row, we can observe that, given a set of particles, the average pose error globally decreases as we augment the maximum distance to the camera 
                              
                                 
                                    
                                       D
                                    
                                    
                                       max
                                    
                                 
                              
                            and add new poses further away. The opposite happens with the ground plane location error (bottom row). This is expected because when people move away from the camera their size in the image gets smaller. Thus, the 2D pose gets smaller when moving away from the camera leading to a consecutive lower 2D pose error while an accurate localization on the ground plane becomes more difficult with the distance. We also want to point out that this numerical evaluation is computed using ground truth data obtained from manual labelling whose accuracy and reliability also decrease with the distance to the camera. The improvement achieved by the proposed homographic alignment is more pronounced when the subjects are close to the camera (
                              
                                 
                                    
                                       D
                                    
                                    
                                       max
                                    
                                 
                                 =
                                 5
                              
                           ). This makes sense since the viewpoint changes when a subject moves far away from the camera and tends to a tilt angle 
                              
                                 φ
                                 =
                                 0
                              
                            which is similar to the training viewpoint employed in this paper.

We now present qualitative results using the framework with our proposed homographic alignment and 1000 particles, for 2 complex sequences with multiple interacting subjects in Fig. 15
                           . For each sequence, we can observe the trajectories of the subjects in the image and the tracked silhouettes for a few frames as well as the 2D poses on top of the image and the estimated 3D poses which have been successfully tracked. We can observe how the system is robust to occlusions and static phases as in both sequences, the subjects walk, meet and stop to talk and then, walk together. Experiments show that the framework, when associated with the proposed homographic alignment, successfully tracks walking pedestrians and estimate their poses in cases where a small number of people move together, have occlusion, and cast shadow.

@&#CONCLUSIONS@&#

In this paper, we have presented a method for view invariant monocular human motion analysis in man-made environments. We have assumed that the camera is calibrated w.r.t. the scene and that observed people move on a known ground plane, which are realistic assumptions in surveillance scenarios. Then, we have proposed to discretize the camera viewpoint into a series of training viewpoints and align input and training images. We have demonstrated that exploiting projective geometry alleviates the problems caused by roof-top and overhead cameras with high tilt angles, and have shown that using 8 training views was enough to produce acceptable results when using the proposed projective alignment in a silhouette-based motion analysis framework.

We have analyzed the results obtained when this homographic transformation is included within two different frameworks: (1) a bottom-up image analysis system where the homography is used to align an input image to a selected training plane for a view-based processing, and (2) a top-down tracking framework where the inverse homography is employed to transform and project candidate silhouettes in the image.

We have conducted a series of experiments to quantitatively and qualitatively evaluate this projective alignment for a variety of sequences with perspective distortion, some with multiple interacting subjects and occlusions. In our experimental evaluation, we have demonstrated the significant improvements of the proposed projective alignment over a commonly used similarity alignment and have provided numerical pose tracking results which demonstrate that the incorporation of this perspective correction in the top-down pose tracking framework results in a higher tracking rate and allows for a better estimation of body poses under wide viewpoint variations.

We have also analyzed the limitations of the proposed method in the bottom-up framework by evaluating its sensitivity to noisy measurements. We have observed that the result depends on the accuracy achieved when estimating both location on the ground floor and the orientation of the subject with respect to the camera. This problem does not appear when following a stochastic approach for estimating the optimum projective transformation by sampling multiple possible values for the camera viewpoint at multiple locations. Even if our results show that the top-down framework outperforms the bottom-up one, we believe that bottom-up techniques could benefit from a more sophisticated tracker and might outperform top-down approaches as different types of image features could then be employed.

Even if all the presented experiments are specific to the walking activity (due to the higher availability of training and evaluation datasets), our method is general enough to extend to other activities. The limited number of required training views makes our work easily extendable to more activities and makes more feasible the development of future action recognition software in real surveillance applications.

@&#ACKNOWLEDGMENTS@&#

Part of this work was conducted while the first and last authors were respectively Research Fellow and Professor with Oxford Brookes University, Oxford, UK. Financial Support was provided by ERC grant ERC-2012-AdG 321162-HELIOS. This work was also supported by Spanish grants TIN2010-20177, DPI2012-31781, FEDER and by the regional government DGA-FSE. Prof. Torr is in receipt of a Royal Society Wolfson Research Merit Award. Dr. Rogez is currently funded by the European Commission under a Marie Curie Fellowship.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.cviu.2013.12.012.


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

