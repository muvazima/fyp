@&#MAIN-TITLE@&#Optimizing conformality of NURBS surfaces by general bilinear transformations

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We give explicit representations of the general bilinear reparameterized surfaces.


                        
                        
                           
                           A scheme is given to construct the general bilinear reparameterized NURBS surfaces.


                        
                        
                           
                           An optimization method is given to improve the conformality of NURBS surfaces.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

NURBS surfaces

General bilinear transformation

Conformal mapping

Rendering

Tessellation

@&#ABSTRACT@&#


               
               
                  The conformality of NURBS surfaces greatly affects the results of rendering and tessellation applications. To improve the conformality of NURBS surfaces, an optimization algorithm using general bilinear transformations is presented in this paper. The conformality energy is first formulated and its numerical approximation is then constructed using the composite simpson’s rule. The initial general bilinear transformation is obtained by approximating the conformal mapping of its 3D discretized mesh using a least square method, which is further optimized by the Levenberg–Marquardt method. Examples are given to show the performance of our algorithm for rendering and tessellation applications.
               
            


                        
                           
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             −
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             −
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             −
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             −
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             −
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             −
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             −
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             −
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             −
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   M
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                     

@&#INTRODUCTION@&#

Freeform surfaces play an increasingly important role in contemporary Computer Aided Design (CAD). The results of most surface algorithms  [1–13] for surface rendering (e.g. texture mapping), tessellation and blending applications are highly dependent on the surface parameterization. A NURBS surface has an intrinsic rational piecewise polynomial mapping from the 3D surface to the 2D parameter domain (see Fig. 1
                     ). By surface reparameterizations  [14,11–13], the surface may have infinitely many different parameterizations. Depending on where and how it will be used, one may need to find a suitable or optimal parameterization out of the infinitely many, or to convert the given parameterization into another (more) suitable one  [14,11–13]. In many applications, such as texture mapping, surface tessellation, surface matching and registration, it is highly desirable that the parameterization is shape preserving (conformal) i.e. maps an elementary circle of the parameter domain to an elementary circle of the surface. At the same time, the surface modifications (changing the surface control points and/or weights) and surface fitting in reverse engineering both may introduce NURBS surfaces with parameterizations far from being conformal. From our point of view, the lack of conformal parameterizations is the bottleneck for NURBS surfaces to achieve high quality results for rendering and tessellation applications. Moreover, a conformal parameterization will lead to more robust and stable computations for derivative based algorithms such as surface intersection, curvature computation, and so on  [1,6,9,11].

@&#RELATED WORKS@&#

We focus on reviewing on NURBS curve and surface parameterization methods. For triangle meshes and subdivision surfaces, we concentrate on analyzing the difference between their parameterization and freeform surface parameterization, a detailed review of mesh and subdivision surface parameterization techniques being beyond the scope of this article. For the details of mesh parameterization, the reader is recommended to see the survey paper by Floater and Hormann  [15] and the references therein. For the details of subdivision surface parameterization, see the papers by He et al.  [16,17] for the latest progress.

In the past twenty years, how to achieve optimal parameterization of Bézier curves has been studied extensively in the literatures such as  [18–28]. Farouki  [19] identified arc-length parameterization as the optimal parameterization of Bézier curves. By minimizing an integral which measures the deviation from arc-length parameterization, the optimal representation is obtained by solving a quadratic equation. Jüttler  [20] presented a simplified approach to Farouki’s result by using a back substitution in the integral. Costantini et al.  [18] obtained closer approximations to the arc-length parameterization by applying composite reparameterizations to Bézier curves. Farin  [29] showed that for a circular arc represented by its rational quadratic representation, its parameterization is a chord length one. Motivated by Farin’s work, Lu  [30] identified a family of curves that can be parameterized by chord length. Yang et al.  [31] presented a reparameterization method to approximate the arc-angle parameterization of any planar curve by 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         piecewise Möbius transformations.

The parameterization of triangle meshes has been studied extensively in the last decade and still remains as a hot topic until now  [15,32–35]. The main purpose of the research on the parameterization of triangle meshes is to construct a suitable, bijective mapping between the triangle mesh embedded in 3D and a simple 2D domain, referred to as the parameter space or parameter domain. To minimize the parameterization distortion in either angles or areas, many different algorithms have been proposed in the literature  [15,33,35]. Also He et al. presented algorithms for parameterizing subdivision surfaces in  [16,17]. As the NURBS surface already has an intrinsic rational polynomial mapping (see Fig. 1) from the 2D parameter domain (a rectangle) to the 3D surface, its parameterization has some specific properties different from the parameterization of triangle meshes and subdivision surfaces. Firstly the NURBS surface has an intrinsic mapping already and we do not need to construct an initial surface mapping from the 3D surface to the 2D parameter domain, which is the case for triangle meshes and subdivision surfaces. Secondly the parameterization of NURBS surface is a continuous rational polynomial mapping while those of triangle meshes and subdivision surfaces are discrete, usually defined by the correspondence between their vertices and the correspondence of points inside the triangles/quads is obtained from the vertices correspondence by interpolation techniques. If we convert the NURBS surface into a triangle mesh and apply the mesh parameterization method, some parameterization results can be obtained subsequently. However, there is one main drawback for this kind of methods. The resultant surface representation is not NURBS anymore, which is problematic for subsequent CAD algorithms designed for freeform surfaces. Though we can reconstruct the NURBS surface by traditional least-square fitting methods from the triangle parameterization, neither the surface shape nor the triangle parameterization are preserved precisely during the fitting procedure, which is not allowed for high accurate CAD applications.

The aim of this paper is to optimize the conformality of given NURBS surfaces for CAD applications such as surface visualization, surface tessellation, surface intersection, curvature computation and so on. Most of all, we want to keep the surface geometry (the surface shape) unchanged and let the resultant surfaces represented as NURBS surfaces, which is preferable and convenient for the algorithms designed for the Computer Aided Design applications mentioned above. The method presented in this paper utilizes the general bilinear transformation, which satisfies both the surface shape and representation requirements.

Compared with the quantitative study of NURBS curve, triangle mesh and subdivision surface parameterization  [18,19,15–17,20,21,33,22–28,35], little attention has been paid to the NURBS surface parameterization until now. The results of rendering and tessellation applications for NURBS surfaces largely depend on the parameterization quality. To perform texture mappings on a NURBS surface, the parametric coordinate of the surface is usually reused as the texture coordinate. If the parameterization is far from being conformal, there will be large distortion of the texture image on the surface (see Fig. 2
                        (b)). To tessellate a NURBS surface, most existing algorithms [4,6,7] map a triangulation of the parameter domain onto the surface. Similar to texture mapping, the final tessellation results largely depend on the surface parameterization (see Fig. 2(c)). A conformal surface parameterization not only preserves the appearance of texture, but also avoids degenerate elements for the tessellation application. Moreover, a conformal parameterization will lead to more robust and stable computations for derivative based algorithms such as surface intersection, curvature computation, and so on  [1,6,9,11].

Yang et al.  [36] presented an algorithm to improve the Bézier surface parameterization based on Möbius transformations [37,36], which can change only the distribution of iso-parametric curves, but not the shape of them. To obtain more uniform iso-parametric curves, a rational bilinear reparameterization algorithm was also presented in  [36]. However, only the uniformity of iso-parametric curves was considered. Furthermore, the rational bilinear reparameterization coefficients are determined by a trivial interpolation method, which is only suitable for a special surface case. To obtain more uniform and orthogonal iso-parametric curves for rational Bézier surfaces, Yang et al.  [38] presented an optimization algorithm to minimize the nonlinear energy measuring uniformity and orthogonality deviations using the rational bilinear reparameterizations, which produces a better parameterization with the cost of degree elevation. However both the Möbius transformation and rational bilinear transformation presented in  [36,38] suffer from the fact that they always map the four surface boundary curves to themselves in the transformation. As a result, the angles between partial derivative vectors at the four corner points remain unchanged. The surface parameterization can only be improved to some extent using the Möbius transformations and rational bilinear transformations.

To remove the boundary constraints of the Möbius transformation and the rational bilinear transformation, a general rational bilinear transformation is presented in this paper. Based on the general rational bilinear transformation, we present an optimization algorithm to improve the conformality of given NURBS surfaces. In the optimization procedure, a nonlinear energy measuring the conformality deviations is first formulated and its discrete version is then constructed using the composite simpson’s rule  [39]. The coefficients of the initial general bilinear transformation is obtained by approximating the conformal mapping of its 3D discretized mesh using a least square method, which is further optimized numerically by the Levenberg–Marquardt method  [40]. In practice, the algorithm produces significantly better surface parameterizations than the methods presented in  [36,38]. Furthermore, the degree of the resultant surface is the same as the surfaces generated by  [38]. The main contributions of this paper are as follows. 
                           
                              1.
                              This paper gives the explicit representation of the general rational bilinear reparameterized Bézier surfaces and a scheme to construct the general rational bilinear reparameterized NURBS surfaces.

An optimization method is presented to improve the conformality of NURBS surfaces using the presented general rational bilinear transformations.

The Möbius transformations as well as the rational bilinear transformations presented in  [36,38] always map the rectangle parameter domain to itself. As a result, the four boundary curves as well as the orthogonality at the four corners remain unchanged during the transformations. In this section, we first review the Möbius and rational bilinear transformations presented in  [36,38] and then present a general rational bilinear transformation without the above constraints. Finally, we give a scheme to construct the general bilinear reparameterized NURBS surfaces.

A rational Bézier surface can be represented in the following form 
                           
                              (1)
                              
                                 
                                    X
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             m
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             0
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             m
                                          
                                       
                                       
                                          (
                                          u
                                          )
                                       
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                          
                                             n
                                          
                                       
                                       
                                          (
                                          v
                                          )
                                       
                                       
                                          
                                             ω
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             m
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             0
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             m
                                          
                                       
                                       
                                          (
                                          u
                                          )
                                       
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                          
                                             n
                                          
                                       
                                       
                                          (
                                          v
                                          )
                                       
                                       
                                          
                                             ω
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 u
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 ,
                                 
                                 v
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         are the control points, 
                           
                              
                                 ω
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         are the weights, 
                           
                              
                                 B
                              
                              
                                 i
                              
                              
                                 m
                              
                           
                           
                              (
                              u
                              )
                           
                         and 
                           
                              
                                 B
                              
                              
                                 j
                              
                              
                                 n
                              
                           
                           
                              (
                              v
                              )
                           
                         are the Bernstein polynomials. For a rational Bézier surface, each parameter is subjected to a Möbius transformation as follows. 
                           
                              (2)
                              
                                 u
                                 =
                                 u
                                 
                                    (
                                    s
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          α
                                          −
                                          1
                                          )
                                       
                                       s
                                    
                                    
                                       2
                                       α
                                       s
                                       −
                                       s
                                       −
                                       α
                                    
                                 
                                 ,
                                 
                                 α
                                 ∈
                                 
                                    (
                                    0
                                    ,
                                    1
                                    )
                                 
                              
                           
                         and 
                           
                              (3)
                              
                                 v
                                 =
                                 v
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          β
                                          −
                                          1
                                          )
                                       
                                       t
                                    
                                    
                                       2
                                       β
                                       t
                                       −
                                       t
                                       −
                                       β
                                    
                                 
                                 ,
                                 
                                 β
                                 ∈
                                 
                                    (
                                    0
                                    ,
                                    1
                                    )
                                 
                                 .
                              
                           
                         Applying the transformations (2) and (3) to surface (1) results in the rational Bézier surface 
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                    
                                    
                                       ˜
                                    
                                 
                                 
                                    (
                                    s
                                    ,
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             m
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             0
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             m
                                          
                                       
                                       
                                          (
                                          s
                                          )
                                       
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                          
                                             n
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             m
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             0
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             m
                                          
                                       
                                       
                                          (
                                          s
                                          )
                                       
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                          
                                             n
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 s
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 ,
                                 
                                 t
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    
                                       ω
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           =
                           
                              
                                 ω
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           
                              
                                 
                                    (
                                    1
                                    −
                                    α
                                    )
                                 
                              
                              
                                 i
                              
                           
                           
                              
                                 α
                              
                              
                                 m
                                 −
                                 i
                              
                           
                           
                              
                                 
                                    (
                                    1
                                    −
                                    β
                                    )
                                 
                              
                              
                                 j
                              
                           
                           
                              
                                 β
                              
                              
                                 n
                                 −
                                 j
                              
                           
                           [37]. Linear Möbius transformations cannot change the shape of the iso-parametric curves. What changes is the distribution of the iso-parametric curves.

To introduce the rational bilinear reparameterization  [36,38], 
                           α
                         and 
                           β
                         in Eqs. (2) and (3) are not constants any more. They are redefined as linear interpolations of another set of parameters as follows. 
                           
                              (4)
                              
                                 
                                    {
                                    
                                       
                                          
                                             α
                                             =
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                             t
                                             +
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                t
                                                )
                                             
                                             ,
                                             
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                             ∈
                                             
                                                (
                                                0
                                                ,
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          
                                             β
                                             =
                                             
                                                
                                                   β
                                                
                                                
                                                   1
                                                
                                             
                                             s
                                             +
                                             
                                                
                                                   β
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                s
                                                )
                                             
                                             ,
                                             
                                             
                                                
                                                   β
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   β
                                                
                                                
                                                   2
                                                
                                             
                                             ∈
                                             
                                                (
                                                0
                                                ,
                                                1
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           α
                         in Eq. (2) is defined as a linear function of 
                           t
                        , with coefficients 
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                        , and 
                           β
                         in Eq. (3) is defined as a linear function of 
                           s
                        , with coefficients 
                           
                              
                                 β
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 β
                              
                              
                                 2
                              
                           
                        . As a result of more freedom, the surface degree will be raised accordingly. Applying the bilinear transformations (2), (3) and (4) to surface (1) results in a rational Bézier surface of degree 
                           m
                           +
                           n
                         in both 
                           s
                        -direction and 
                           t
                        -direction  [12]. As a consequence of introducing additional free parameters, bilinear reparameterization can change the shape of the iso-parametric curves as well as their distribution. In fact the bilinear reparameterization is a linear interpolation of Möbius transformations imposed on the opposite boundaries. Similar to Möbius transformation, the bilinear transformation cannot change the four boundary curves as well as the orthogonality at the four corners during the transformations. To remove the boundary constraints, a general bilinear transformation is presented in the next subsection.

In a general rational bilinear reparameterization 
                           
                              (
                              u
                              ,
                              v
                              )
                           
                           =
                           ψ
                           
                              (
                              s
                              ,
                              t
                              )
                           
                         of a rational Bézier surface, the parameters are subjected to the following transformations 
                           
                              
                                 (5)
                                 
                                    u
                                    =
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                1
                                             
                                          
                                          s
                                          t
                                          +
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          s
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          t
                                          +
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                2
                                             
                                          
                                          s
                                          t
                                          +
                                          
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                          s
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          t
                                          +
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                              
                                 (6)
                                 
                                    v
                                    =
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                3
                                             
                                          
                                          s
                                          t
                                          +
                                          
                                             
                                                b
                                             
                                             
                                                3
                                             
                                          
                                          s
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                3
                                             
                                          
                                          t
                                          +
                                          
                                             
                                                d
                                             
                                             
                                                3
                                             
                                          
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                4
                                             
                                          
                                          s
                                          t
                                          +
                                          
                                             
                                                b
                                             
                                             
                                                4
                                             
                                          
                                          s
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                4
                                             
                                          
                                          t
                                          +
                                          
                                             
                                                d
                                             
                                             
                                                4
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                         For the power basis form in Eqs. (5) and (6), there always exists the following mathematically equivalent Bernstein basis form 
                           
                              
                                 (7)
                                 
                                    u
                                    =
                                    
                                       
                                          
                                             
                                                e
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          
                                             (
                                             1
                                             −
                                             s
                                             )
                                          
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                          +
                                          
                                             
                                                e
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          
                                             (
                                             1
                                             −
                                             s
                                             )
                                          
                                          t
                                          +
                                          
                                             
                                                e
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          s
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                          +
                                          
                                             
                                                e
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          s
                                          t
                                       
                                       
                                          
                                             
                                                f
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          
                                             (
                                             1
                                             −
                                             s
                                             )
                                          
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                          +
                                          
                                             
                                                f
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          
                                             (
                                             1
                                             −
                                             s
                                             )
                                          
                                          t
                                          +
                                          
                                             
                                                f
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          s
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                          +
                                          
                                             
                                                f
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          s
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                0
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                          
                                             (
                                             s
                                             )
                                          
                                          
                                             
                                                B
                                             
                                             
                                                j
                                             
                                             
                                                1
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          
                                             
                                                ζ
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          
                                             
                                                η
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                0
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                          
                                             (
                                             s
                                             )
                                          
                                          
                                             
                                                B
                                             
                                             
                                                j
                                             
                                             
                                                1
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          
                                             
                                                η
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    where
                                    
                                    
                                       
                                          ζ
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    /
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    
                                      and  
                                    
                                    
                                       
                                          η
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    ,
                                 
                              
                              
                                 (8)
                                 
                                    v
                                    =
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          
                                             (
                                             1
                                             −
                                             s
                                             )
                                          
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                          +
                                          
                                             
                                                g
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          
                                             (
                                             1
                                             −
                                             s
                                             )
                                          
                                          t
                                          +
                                          
                                             
                                                g
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          s
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                          +
                                          
                                             
                                                g
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          s
                                          t
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          
                                             (
                                             1
                                             −
                                             s
                                             )
                                          
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                          +
                                          
                                             
                                                h
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          
                                             (
                                             1
                                             −
                                             s
                                             )
                                          
                                          t
                                          +
                                          
                                             
                                                h
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          s
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                          +
                                          
                                             
                                                h
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          s
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                0
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                          
                                             (
                                             s
                                             )
                                          
                                          
                                             
                                                B
                                             
                                             
                                                j
                                             
                                             
                                                1
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          
                                             
                                                ι
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          
                                             
                                                κ
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                0
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                          
                                             (
                                             s
                                             )
                                          
                                          
                                             
                                                B
                                             
                                             
                                                j
                                             
                                             
                                                1
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          
                                             
                                                κ
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                       
                                    
                                    ,
                                    
                                      where  
                                    
                                       
                                          ι
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          g
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    /
                                    
                                       
                                          h
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    
                                      and  
                                    
                                    
                                       
                                          κ
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          h
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                                =
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      0
                                                      ,
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      1
                                                      ,
                                                      0
                                                   
                                                
                                                =
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      1
                                                      ,
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    and
                                    
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                                =
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      0
                                                      ,
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                      ,
                                                      0
                                                   
                                                
                                                =
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                      ,
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                                =
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      0
                                                      ,
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      3
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      1
                                                      ,
                                                      0
                                                   
                                                
                                                =
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      3
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      1
                                                      ,
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      3
                                                   
                                                
                                                +
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      3
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      3
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                      and  
                                    
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                                =
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      0
                                                      ,
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      4
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      1
                                                      ,
                                                      0
                                                   
                                                
                                                =
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      4
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      1
                                                      ,
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      4
                                                   
                                                
                                                +
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      4
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      4
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      4
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                         Also, for the Bernstein basis form in Eqs. (7) and (8), there always exists a mathematically equivalent power basis form. The ability to represent general bilinear transformations is the same for the power basis form and the Bernstein basis form. Although mathematically equivalent, the Bernstein basis form is better suited to represent and manipulate the transformations. Without explicit explanation, we always utilize the Bernstein basis form in the reminder of the paper.

Substituting Eqs. (7) and (8) into Eq. (1) results in a rational Bézier surface 
                           
                              
                                 
                                    X
                                 
                              
                              
                                 ˜
                              
                           
                           
                              (
                              s
                              ,
                              t
                              )
                           
                         defined in Eq. (9). 
                           
                              (9)
                              
                                 
                                    
                                       
                                          X
                                       
                                    
                                    
                                       ˜
                                    
                                 
                                 
                                    (
                                    s
                                    ,
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             0
                                          
                                          
                                             m
                                             +
                                             n
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             0
                                          
                                          
                                             m
                                             +
                                             n
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             m
                                             +
                                             n
                                          
                                       
                                       
                                          (
                                          s
                                          )
                                       
                                       
                                          
                                             B
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             m
                                             +
                                             n
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                Q
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             0
                                          
                                          
                                             m
                                             +
                                             n
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             0
                                          
                                          
                                             m
                                             +
                                             n
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             m
                                             +
                                             n
                                          
                                       
                                       
                                          (
                                          s
                                          )
                                       
                                       
                                          
                                             B
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             m
                                             +
                                             n
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 s
                                 ,
                                 t
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Q
                                                   
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               5
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               5
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               6
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               6
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               7
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               7
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               9
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               9
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               10
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               10
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               11
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               11
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               13
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               13
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               13
                                                            
                                                         
                                                      
                                                   
                                                   R
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               5
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               5
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               6
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               6
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               7
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               7
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               9
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               9
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               10
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               10
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               11
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               11
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               13
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               13
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               13
                                                            
                                                         
                                                      
                                                   
                                                   R
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   0
                                                
                                                
                                                   m
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   0
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   0
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   =
                                                   0
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   =
                                                   0
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         5
                                                      
                                                   
                                                   =
                                                   0
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         5
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                   =
                                                   0
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         7
                                                      
                                                   
                                                   =
                                                   0
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         7
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         9
                                                      
                                                   
                                                   =
                                                   0
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         9
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         10
                                                      
                                                   
                                                   =
                                                   0
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         10
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                   =
                                                   0
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         13
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         13
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         13
                                                      
                                                   
                                                
                                             
                                             R
                                             
                                                
                                                   ω
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                         and 
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             R
                                             =
                                             
                                                
                                                   R
                                                
                                                
                                                   1
                                                
                                             
                                             ⋅
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            11
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            11
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            1
                                                            ,
                                                            0
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            1
                                                            ,
                                                            0
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            0
                                                            ,
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            0
                                                            ,
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            0
                                                            ,
                                                            0
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            0
                                                            ,
                                                            0
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   11
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         5
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   10
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   01
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         7
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   00
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            11
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            11
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         9
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            10
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            10
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         10
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            01
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            01
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            00
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            00
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   11
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         13
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   10
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         14
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   01
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         15
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   00
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         16
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   4
                                                
                                             
                                             =
                                             m
                                             −
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   8
                                                
                                             
                                             =
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   5
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   6
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   7
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   12
                                                
                                             
                                             =
                                             n
                                             −
                                             
                                                
                                                   j
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   9
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   10
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   11
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   14
                                                
                                             
                                             =
                                             
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   5
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   6
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   9
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   10
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   13
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   15
                                                
                                             
                                             =
                                             
                                                
                                                   k
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   3
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   5
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   7
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   9
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   11
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   13
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   16
                                                
                                             
                                             =
                                             
                                                
                                                   j
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   13
                                                
                                             
                                             −
                                             
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   k
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             2
                                             
                                                
                                                   p
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   3
                                                
                                             
                                             +
                                             2
                                             
                                                
                                                   p
                                                
                                                
                                                   5
                                                
                                             
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   6
                                                
                                             
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   7
                                                
                                             
                                             +
                                             2
                                             
                                                
                                                   p
                                                
                                                
                                                   9
                                                
                                             
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   10
                                                
                                             
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   11
                                                
                                             
                                             +
                                             2
                                             
                                                
                                                   p
                                                
                                                
                                                   13
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             min
                                             
                                                (
                                                m
                                                −
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             min
                                             
                                                (
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                m
                                                −
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   3
                                                
                                             
                                             =
                                             min
                                             
                                                (
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                m
                                                −
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   5
                                                
                                             
                                             =
                                             min
                                             
                                                (
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   6
                                                
                                             
                                             =
                                             min
                                             
                                                (
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      5
                                                   
                                                
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      5
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   7
                                                
                                             
                                             =
                                             min
                                             
                                                (
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      5
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      6
                                                   
                                                
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      3
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      5
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   9
                                                
                                             
                                             =
                                             min
                                             
                                                (
                                                n
                                                −
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      5
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      6
                                                   
                                                
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      3
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      5
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      7
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   10
                                                
                                             
                                             =
                                             min
                                             
                                                (
                                                n
                                                −
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      9
                                                   
                                                
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      5
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      6
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      9
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   11
                                                
                                             
                                             =
                                             min
                                             
                                                (
                                                n
                                                −
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      9
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      10
                                                   
                                                
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      3
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      5
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      7
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      9
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   13
                                                
                                             
                                             =
                                             max
                                             
                                                (
                                                0
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                2
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      3
                                                   
                                                
                                                −
                                                2
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      5
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      6
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      7
                                                   
                                                
                                                −
                                                2
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      9
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      10
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      11
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   13
                                                
                                             
                                             =
                                             min
                                             
                                                (
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      5
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      6
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      9
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      10
                                                   
                                                
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      3
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      5
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      7
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      9
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      11
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         m
                                                         −
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         m
                                                         −
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         m
                                                         −
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               5
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               5
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               6
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               5
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               6
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               7
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         n
                                                         −
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               9
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         n
                                                         −
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               9
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               10
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         n
                                                         −
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               9
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               10
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               11
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               13
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             /
                                             
                                                (
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            m
                                                            +
                                                            n
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            m
                                                            +
                                                            n
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                         The new surface is of degree 
                           
                              (
                              m
                              +
                              n
                              )
                           
                           ×
                           
                              (
                              m
                              +
                              n
                              )
                           
                         where 
                           m
                         and 
                           n
                         are the degrees of the original Bézier surface in the 
                           u
                        -direction and 
                           v
                        -direction, respectively. Letting 
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             =
                                             0
                                             ,
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   0
                                                   ,
                                                   1
                                                
                                             
                                             =
                                             0
                                             ,
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                
                                             
                                             =
                                             1
                                             −
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             =
                                             1
                                             −
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             =
                                             0
                                             ,
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   0
                                                   ,
                                                   1
                                                
                                             
                                             =
                                             0
                                             ,
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                
                                             
                                             =
                                             1
                                             −
                                             
                                                
                                                   β
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             =
                                             1
                                             −
                                             
                                                
                                                   β
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             =
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   0
                                                   ,
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                
                                             
                                             =
                                             1
                                             −
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             =
                                             1
                                             −
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             =
                                             
                                                
                                                   β
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   h
                                                
                                                
                                                   0
                                                   ,
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   β
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                
                                             
                                             =
                                             1
                                             −
                                             
                                                
                                                   β
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             =
                                             1
                                             −
                                             
                                                
                                                   β
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         we obtain the bilinear transformation introduced in  [36,38], which is a degenerate case under the above constraints. The degree of the general bilinear reparameterized surface is the same as the degree of the bilinear reparameterized surface generated by  [36,38]. The benefit introduced by the general bilinear transformation over the bilinear transformation presented in  [36,38] is that the boundaries of the parameter domain are not necessarily mapped to themselves any more. An example is given in Fig. 3
                        , where we optimize the conformality of the given surface using bilinear and general bilinear transformations, respectively. The iso-parametric curves as well as the texture mapping are illustrated. From Fig. 3, compared with the bilinear transformation presented in  [36,38], there is no boundary constraint in the general bilinear transformation presented in this paper. As a result, additional freedom is gained to obtain much better results over the bilinear transformations. Also we illustrate the general bilinear transformation in Fig. 4
                        , where boundaries as well as iso-parametric curves of the reparameterized surface are drawn in solid black curves and boundaries of the original surface are plotted in dash blue curves. From Fig. 4, we can see that the four boundary curves of the reparameterized surface are transformed to four hyperbolic curves (see Appendix B for the demonstration) in the original surface parameter domain under the general bilinear transformation. For the reparameterized surface, the control points and their weights are expressed as linear interpolations of the original control points and weights, whose linear scaling factors are determined by the general rational bilinear reparameterization coefficients. To give a better understanding of how the control net changes in a rational bilinear reparameterization, an example is given in Fig. 5
                        . From Fig. 5, we can see that iso-parametric curves and the control net have similar shapes, which may involve certain kind of distortion, especially on the four boundary curves. In fact, the control net is a coarse approximation of the surface and its iso-parametric curves. After surface subdivisions by adding more knots, the control net will converge to the surface and its iso-parametric curves.

After describing the general bilinear reparameterization of rational Bézier surfaces, we give the scheme to construct the general bilinear reparameterization of NURBS surfaces in this subsection. First, the NURBS surface is subdivided into rational Bézier surfaces by knot insertion, which are then extended according to the located parameter domain of the subsurface such that the new surface has a unit parameter domain. The new surface is then reparameterized to obtain the reparameterized surfaces according to coefficients of the general bilinear transformation. For each Bézier subsurface, the boundary curves correspond to four hyperbolic curves lying in the new parameter domain. Next, for each Bézier subsurface, the reparameterized surface (maybe further extended) is trimmed by the boundary curves of the original surface (four hyperbolic curves in the new parameter domain). Finally, by combining all the trimmed surfaces together, we obtain the final general bilinear reparameterized surfaces for the given NURBS surface. The pipeline of the general bilinear transformation for the NURBS surface is given in Fig. 6
                        . To illustrate the general bilinear transformation of NURBS surfaces, an example is given in Fig. 7
                         where the given degree 3×3 NURBS surface has the 
                           u
                        -knot 
                           
                              (
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              )
                           
                        , the 
                           v
                        -knot 
                           
                              (
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0.5
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              )
                           
                         and two Bézier patches. The NURBS surface as well as its parameter domain are shown in Figs. 7(a) and (e), respectively. The extended surface of the lower Bézier patch and its parameter domain are given in Figs. 7(b) and (f). The general bilinear transformation as well as the trimming results are illustrated in Figs. 7(c), (d), (g) and (h). The 3D entities are plotted using the same colors and patterns as their corresponding 2D parameter items. It should be mentioned that the composite reparameterized surfaces have the same parametric continuity as the original NURBS surface.

Conformal parameterization of NURBS surfaces has several special properties, which are extremely valuable for visualization, tessellation and other derivative-based applications. First, conformal parameterization is angle-preserving. Intuitively, suppose 
                        
                           
                              γ
                           
                           
                              1
                           
                        
                     , 
                        
                           
                              γ
                           
                           
                              2
                           
                        
                     
                     
                        ⊂
                     
                     
                        
                           [
                           0
                           ,
                           1
                           ]
                        
                        ×
                        
                           [
                           0
                           ,
                           1
                           ]
                        
                      are two arbitrary intersecting curves in the parameter domain, with the intersection point 
                        p
                        =
                        
                           
                              γ
                           
                           
                              1
                           
                        
                        ∩
                        
                           
                              γ
                           
                           
                              2
                           
                        
                     . Then they are mapped to intersection curves on the 3D NURBS surface 
                        
                           X
                        
                     , 
                        
                           X
                        
                        
                           (
                           p
                           )
                        
                        =
                        
                           X
                        
                        
                           (
                           
                              
                                 γ
                              
                              
                                 1
                              
                           
                           )
                        
                        ∩
                        
                           X
                        
                        
                           (
                           
                              
                                 γ
                              
                              
                                 2
                              
                           
                           )
                        
                     . Suppose the intersection angle between the tangent vectors 
                        d
                        
                           
                              γ
                           
                           
                              1
                           
                        
                     , 
                        d
                        
                           
                              γ
                           
                           
                              2
                           
                        
                      at the intersection point 
                        p
                      is 
                        θ
                     . 
                        
                           X
                        
                      is conformal, if and only if the intersection angle between the tangent vectors 
                        d
                        f
                        
                           (
                           
                              
                                 γ
                              
                              
                                 1
                              
                           
                           )
                        
                      and 
                        d
                        f
                        
                           (
                           
                              
                                 γ
                              
                              
                                 2
                              
                           
                           )
                        
                      is also 
                        θ
                     , therefor it is shape preserving. For each 
                        
                           (
                           u
                           ,
                           v
                           )
                        
                     , the tangent vectors to the two iso-parametric curves are orthogonal and have the same norm. In other words, a conformal map is locally isotropic, i.e. maps an elementary circle of the 
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      domain to an elementary circle of the surface. Second, a conformal parameterization will lead to more robust and stable computations for derivative based algorithms such as surface intersection, curvature computation, and so on  [1,6,9,11].

Given a NURBS surface, this section presents an optimization algorithm to improve its conformality using general bilinear transformations. To measure the deviation of the current parameterization from conformal parameterizations, the following integral function is adopted 
                        
                           (10)
                           
                              J
                              
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    J
                                 
                                 
                                    o
                                    r
                                    t
                                    h
                                 
                              
                              +
                              
                                 
                                    J
                                 
                                 
                                    i
                                    s
                                    o
                                    t
                                 
                              
                              ,
                              
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    j
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    j
                                 
                                 
                                    2
                                 
                              
                              =
                              0
                              …
                              3
                              ,
                           
                        
                      where 
                        
                           
                              
                                 
                                    
                                       J
                                    
                                    
                                       o
                                       r
                                       t
                                       h
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    s
                                    ,
                                    t
                                    )
                                 
                                 d
                                 s
                                 d
                                 t
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       J
                                    
                                    
                                       i
                                       s
                                       o
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          (
                                          E
                                          
                                             (
                                             s
                                             ,
                                             t
                                             )
                                          
                                          −
                                          G
                                          
                                             (
                                             s
                                             ,
                                             t
                                             )
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 d
                                 s
                                 d
                                 t
                                 ,
                              
                           
                        
                      and 
                        
                           
                              E
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                              =
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    s
                                 
                              
                              ⋅
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    s
                                 
                              
                              ,
                              
                              F
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                              =
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    s
                                 
                              
                              ⋅
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                              G
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                              =
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    t
                                 
                              
                              ⋅
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    t
                                 
                              
                              .
                           
                        
                      The objective function used here is the isothermal metric of a parameterization surface, which has been studied in  [41–43]. 
                        
                           
                              J
                           
                           
                              o
                              r
                              t
                              h
                           
                        
                      measures the deviation of the current parameterization from parameterizations with orthogonal iso-parametric curves, while 
                        
                           
                              J
                           
                           
                              i
                              s
                              o
                              t
                           
                        
                      measures the deviation of the current parameterization from parameterizations with partially isotropic iso-parametric curves. If the formulated energy is zero, then the iso-parametric curve net becomes an isothermal net, which are level curves of two conjugate harmonic functions. In general, Eq. (10) is highly non-linear, and there is no closed-form solution for the general bilinear transformations. Thus we solve this optimization problem using the following numerical method.

The terms in Eq. (10) are approximated by a discrete version of the energy using the composite simpson’s rule  [39]. To apply the composite simpson’s rule, we divide the parameter domain by partitioning the 
                           s
                         and 
                           t
                         interval into 
                           2
                           l
                         and 
                           2
                           k
                         subintervals, respectively, 
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             0
                                             =
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             <
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             <
                                             
                                                
                                                   s
                                                
                                                
                                                   2
                                                
                                             
                                             <
                                             ⋯
                                             <
                                             
                                                
                                                   s
                                                
                                                
                                                   2
                                                   l
                                                
                                             
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             0
                                             =
                                             
                                                
                                                   t
                                                
                                                
                                                   0
                                                
                                             
                                             <
                                             
                                                
                                                   t
                                                
                                                
                                                   1
                                                
                                             
                                             <
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             <
                                             ⋯
                                             <
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                   k
                                                
                                             
                                             =
                                             1
                                             .
                                          
                                       
                                    
                                 
                              
                           
                         These subdivisions determine the step sizes 
                           h
                           =
                           1
                           /
                           
                              (
                              2
                              l
                              )
                           
                         and 
                           p
                           =
                           1
                           /
                           
                              (
                              2
                              k
                              )
                           
                        . For the orthogonality term 
                           
                              
                                 J
                              
                              
                                 o
                                 r
                                 t
                                 h
                              
                           
                        , the resulting approximation has the form 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                o
                                                r
                                                t
                                                h
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                o
                                                r
                                                t
                                                h
                                             
                                          
                                          +
                                          
                                             
                                                E
                                             
                                             
                                                e
                                                r
                                                r
                                                o
                                                r
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         J
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   o
                                                   r
                                                   t
                                                   h
                                                
                                             
                                             =
                                             
                                                
                                                   4
                                                   h
                                                   p
                                                
                                                
                                                   9
                                                
                                             
                                             
                                                {
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                2
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                4
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      3
                                                   
                                                
                                                +
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      4
                                                   
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   e
                                                   r
                                                   r
                                                   o
                                                   r
                                                
                                             
                                             =
                                             −
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                            
                                                            
                                                               4
                                                            
                                                         
                                                         
                                                            
                                                               F
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  s
                                                               
                                                               ¯
                                                            
                                                            ,
                                                            
                                                               
                                                                  t
                                                               
                                                               ¯
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               4
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                            
                                                            
                                                               4
                                                            
                                                         
                                                         
                                                            
                                                               F
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  s
                                                               
                                                               
                                                                  ̂
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  ̂
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               4
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   180
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                             
                                             +
                                             2
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   l
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      2
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                             +
                                             4
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   l
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      2
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      2
                                                      l
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                      j
                                                   
                                                
                                                )
                                             
                                             +
                                             2
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   l
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      2
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                      j
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                             +
                                             4
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   l
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      2
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                      j
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      2
                                                      l
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                      j
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   3
                                                
                                             
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                             +
                                             2
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   l
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      2
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                             +
                                             4
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   l
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      2
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      2
                                                      l
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   4
                                                
                                             
                                             =
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                      k
                                                   
                                                
                                                )
                                             
                                             +
                                             2
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   l
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      2
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                             +
                                             4
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   l
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      2
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                      k
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      2
                                                      l
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                         for some 
                           
                              (
                              
                                 
                                    s
                                 
                                 ¯
                              
                              ,
                              
                                 
                                    t
                                 
                                 ¯
                              
                              )
                           
                         and 
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    ̂
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    ̂
                                 
                              
                              )
                           
                         in the parameter domain. We can increase the sampling density 
                           l
                         and 
                           k
                         to decrease the error term 
                           
                              
                                 E
                              
                              
                                 e
                                 r
                                 r
                                 o
                                 r
                              
                           
                        . We suggest to use 
                           l
                           ,
                           k
                           ≥
                           10
                         for a good approximation precision. Similarly, we can compute another energy term 
                           
                              
                                 J
                              
                              
                                 u
                                 n
                                 i
                                 f
                              
                           
                         by the composite simpson’s method. The energy function in Eq. (10) is then discretized as
                           
                              
                                 
                                    
                                       J
                                    
                                    
                                       ˜
                                    
                                 
                                 
                                    (
                                    
                                       
                                          e
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          g
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          h
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       o
                                       r
                                       t
                                       h
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                       s
                                       o
                                       t
                                    
                                 
                                 .
                              
                           
                         This leads to the following optimization problem 
                           
                              (11)
                              
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             e
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             f
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             g
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             h
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       J
                                    
                                    
                                       ˜
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       j
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       j
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                                 …
                                 3
                                 ,
                              
                           
                         which is a nonlinear least square problem. This target function can be minimized numerically using the Levenberg–Marquardt method, which enjoys robust global convergence property to a local minimum. Each iteration of the Levenberg–Marquardt method needs to evaluate the gradient of functions 
                           
                              
                                 F
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         and 
                           
                              
                                 
                                    (
                                    E
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    −
                                    G
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    )
                                 
                              
                              
                                 2
                              
                           
                         with respect to the coefficients of the general bilinear transformation. These explicit derivatives can be derived from Eq. (10) using the chain rule. For numerical optimization, it is advisable to start from an initial point which is not far away from a local minimum, which is computed in the next subsection.

In this subsection, we determine the initial transformation by the following least square method. First, we uniformly sample a grid in the parameter domain of the NURBS surface and obtain the 2D conformal mapping of their corresponding 3D discretized mesh on the NURBS surface by the least square method presented by Lévy  [42]. When computing the parameterization of the 3D discretized mesh using the least square method by Lévy, the conformal mappings are not unique. They differ by a Möbius transformation. The Möbius ambiguity can be removed by first determining the parametric locations of any two user-prescribed points. As the rotation (a Möbius transformation) of the 2D parameterization always keep the conformality of the surface mapping, we rotate the parameterization by its inclination angle to make it horizontally arranged such that we can extract the rotation from the initial general bilinear transformation. After the 2D conformal mapping is obtained, the initial general bilinear transformation can then be constructed by approximating the conformal mapping of the discretized mesh using a least square method (see Fig. 8
                        ). The coefficients of the general bilinear transformation in Eqs. (7) and (8) can be solved separately. We first show how to obtain the coefficients 
                           
                              
                                 e
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         and the coefficients 
                           
                              
                                 g
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         and 
                           
                              
                                 h
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         can be solved similarly. For a valid general bilinear transformation, at least one denominator coefficient 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       j
                                    
                                    
                                       1
                                    
                                 
                              
                           
                         is non-zero. Scaling the coefficients 
                           
                              
                                 e
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         by the non-zero 
                           1
                           /
                           
                              
                                 f
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       j
                                    
                                    
                                       1
                                    
                                 
                              
                           
                         will not alter the transformation in Eq. (7). Thus we normalize the transformation by setting 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       j
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           =
                           1
                           ,
                           
                              
                                 i
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 j
                              
                              
                                 1
                              
                           
                           =
                           0
                           ,
                           1
                        , which will lead to four different optimization problems and correspond to four different general bilinear transformations. Among them, we select the general bilinear transformation with the minimal deviation energy. Here we only illustrate how to minimize the energy with 
                           
                              
                                 f
                              
                              
                                 0
                                 ,
                                 0
                              
                           
                           =
                           1
                        . The other three minimization problems can be solved similarly. To compute the initial general bilinear transformation with 
                           
                              
                                 f
                              
                              
                                 0
                                 ,
                                 0
                              
                           
                           =
                           1
                        , we have the following least square minimization problem 
                           
                              
                                 min
                                 ξ
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                N
                                             
                                             
                                                k
                                             
                                          
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                D
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             
                                                
                                                   e
                                                
                                                
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   e
                                                
                                                
                                                   0
                                                   ,
                                                   1
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   e
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                
                                             
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   e
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             
                                                (
                                                1
                                                −
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   0
                                                   ,
                                                   1
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                
                                             
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           ξ
                         is a scalar-valued function of 7 variables. Now we apply the standard technique of least square method to minimize 
                           ξ
                         by setting the derivatives of 
                           ξ
                         with respect to the 7 variables equal to zero. The derivative is 
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   ξ
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                             2
                                             
                                                (
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      k
                                                   
                                                
                                                −
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   j
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             =
                                             0
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∂
                                                   ξ
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                             2
                                             
                                                (
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      k
                                                   
                                                
                                                −
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                −
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   j
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             =
                                             0
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         which implies that 
                           
                              (12)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   ξ
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      M
                                                   
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   −
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                ]
                                             
                                             =
                                             0
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∂
                                                   ξ
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      M
                                                   
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   −
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      M
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                             =
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                         Eq. (12) is a linear system in the unknowns 
                           
                              
                                 e
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        , 
                           
                              
                                 f
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        . Letting 
                           i
                           =
                           0
                           ,
                           1
                         and 
                           j
                           =
                           0
                           ,
                           1
                         yields the system of 7 equations in 7 unknowns 
                           
                              
                                 
                                    
                                       
                                          N
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    N
                                 
                                 ⋅
                                 x
                                 =
                                 b
                                 ,
                              
                           
                         where 
                           x
                         is the vector of 7 variables 
                           
                              
                                 x
                                 =
                                 
                                    
                                       
                                          [
                                          
                                             
                                                e
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                             
                                          
                                             
                                                e
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                             
                                          
                                             
                                                e
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                             
                                          
                                             
                                                e
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                             
                                          
                                             
                                                f
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                             
                                          
                                             
                                                f
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                             
                                          
                                             
                                                f
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        
                        
                           b
                         is equal to the following vector 
                           
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                         and 
                           
                              N
                           
                         is the 7×7 matrix of scalars given in Box I
                        .

After the initial general bilinear transformation is obtained, we optimize the non-linear least square problem in Eq. (11) using the Levenberg–Marquardt method. The Levenberg–Marquardt algorithm is a popular method for nonlinear least square optimization. It is more robust than the Gauss–Newton algorithm, and is guaranteed to converge to a local minimum  [40]. The Levenberg–Marquardt method interpolates between the Gauss–Newton algorithm and the method of gradient descent. The Levenberg–Marquardt method is more robust than the Gauss–Newton algorithm, which means that in many cases it finds a solution even if it starts very far off the final minimum. Levenberg–Marquardt method can also be viewed as Gauss–Newton using a trust region approach. There is no guarantee that it will converge to a global minimum. To find the global minima, we need to use global optimization algorithms, which require a global search approach and are usually time-consuming  [44]. Instead, our method selects a good initial point for the Levenberg–Marquardt algorithm, so that it can converge to a local minimum nearby. Such strategy has been successfully applied to other geometric modeling problems involving nonlinear least square optimization  [45,46,38]. The initial transformation can be obtained using a traditional linear system solver and the non-linear least square problem can be solved with tens of iterations using Levenberg–Marquardt method.

@&#EXPERIMENTAL RESULTS@&#

Our algorithm is implemented on a PC with Intel Duo CPU 3.06 GHz, 2G Memory and Microsoft Visual Studio 2008. To show the performance of our algorithm, several examples are given as follows. Here we adopt the sampling density 
                        l
                        ,
                        k
                        =
                        10
                      (see Section  3.1) for all the examples.


                     Fig. 9
                      illustrates the optimization result of a car top NURBS surface with 34 by 34 control points. To show the performance, each surface is illustrated using three methods: iso-parametric curves, texture mapping and color-coded conformality. The iso-parametric curve networks can also be seen as quad tessellations of the given freeform surfaces. Let 
                        N
                        
                           (
                           δ
                           ,
                           ζ
                           )
                        
                      denote the unit normal to the surface. In the color-coded images, we measure for a parameterization 
                        
                           X
                        
                        
                           (
                           δ
                           ,
                           ζ
                           )
                        
                      the following conformality function across the surface
                        
                           
                              E
                              
                                 (
                                 δ
                                 ,
                                 ζ
                                 )
                              
                              =
                              
                                 ‖
                                 N
                                 
                                    (
                                    δ
                                    ,
                                    ζ
                                    )
                                 
                                 ×
                                 
                                    
                                       ∂
                                       X
                                    
                                    
                                       ∂
                                       δ
                                    
                                 
                                 
                                    (
                                    δ
                                    ,
                                    ζ
                                    )
                                 
                                 −
                                 
                                    
                                       ∂
                                       X
                                    
                                    
                                       ∂
                                       ζ
                                    
                                 
                                 
                                    (
                                    δ
                                    ,
                                    ζ
                                    )
                                 
                                 ‖
                              
                              ,
                           
                        
                      and use colors to illustrate the value of 
                        E
                        
                           (
                           δ
                           ,
                           ζ
                           )
                        
                      (blue is good conformality and red is bad conformality). The surface parameterization 
                        
                           X
                        
                        
                           (
                           δ
                           ,
                           ζ
                           )
                        
                      is conformal at a point 
                        
                           (
                           δ
                           ,
                           ζ
                           )
                        
                      if and only if 
                        E
                        
                           (
                           δ
                           ,
                           ζ
                           )
                        
                        =
                        0
                     .

As shown in Fig. 9, the car top NURBS surface with 34 by 34 control points is optimized using our presented method. From Fig. 9, it can be seen that the original surface parameterization is far from being conformal. Texture mapping of the original parameterization involves a lot of shape distortion and color-coded image of the original parameterization is almost red. By the least-square method in  [42], we compute the conformal mapping of its discretized mesh (see Fig. 10
                     (a)). By approximating the conformal mapping using the least square method in Section  3.2, we obtain the initial bilinear transformation, which is further optimized by the Levenberg–Marquardt method (see Fig. 10(b) and (c)). From the iso-parametric curves, the texture mapping and color-coded conformality in Fig. 9, we can see that the conformality of the resultant surface has been greatly improved. Texture mapping of the optimized parameterization better keeps the local shape and the color-coded conformality image of the optimized parameterization is almost blue.

Another example is given in Fig. 11
                     , where a face surface with 21 by 19 control points is optimized using our method. The conformal mapping of its 3D discretized mesh and the final general bilinear transformation are illustrated in Fig. 12
                     . From the results in Fig. 11, we can see evidently that the conformality of the given face surface has been improved to a large extent.

Both the above car top and face examples have regular surface boundaries (almost a rectangle). To show the ability of our method to handle NURBS surfaces with irregular boundaries, a terrain NURBS surface is given in Fig. 13
                     . In Example 3, we measure the data near the interesting mountain area and reconstruct the NURBS surface from its triangle mesh using a least square method in  [8]. From Fig. 13, partially due to its irregular boundaries, the results of rendering and tessellation applications are far from being satisfied. Using the optimization method presented in this paper, the boundaries of the original surface and the result surface do not coincide anymore (see Fig. 14
                     ). As a result, the conformality of the resultant surface has been promoted to an acceptable level for rendering and tessellation applications. Also to show the efficiency and effectiveness of our method to improve the conformality of complex and multiple freeform surfaces, an example of the bunny model with 316 patches is given in Fig. 15
                     . The layout of the subsurface is illustrated in Fig. 15(a) and the conformality of the bunny model before and after the optimization are given in Fig. 15(b) and (d), respectively. Finally the texture mapping result by 3D painting system is illustrated in Fig. 15(c). From Fig. 15, we can see that the conformality is improved evidently by our presented method in this paper and the texture mapping result using the optimized parameterization demonstrates its effectiveness.

The above four examples show that our method can improve the conformality of given freeform surfaces to a large extent. Compared with the bilinear transformations, no boundary constraints exist anymore. As a result, our method can deal with more surface cases with non-rectangle boundaries (see Fig. 13). Also the parameterization quality of the resultant surface is much better over the previous results in  [38].

In order to improve conformality of given NURBS surface, an optimization algorithm is presented in this paper based on general bilinear transformations. A nonlinear energy measuring the conformality deviations and its numerical approximation are formulated. To minimize the discretized version of the conformal energy, the initial general bilinear transformation is first obtained by approximating the conformal mapping of the 3D discretized mesh, which is computed using Lévy’s least square method. From the good starting point, the initial general bilinear transformation is then optimized by the Levenberg–Marquardt method. Several examples are given to show the performance of our algorithm for rendering and tessellation applications.

Our method can gain an acceptable results for most rendering and tessellation applications at a relatively low cost of the surface degree elevation. It should be mentioned that high degree freeform surfaces will introduce the problems of intensive computation and numerical instability, which should be avoided in practical Computer-Aided Design systems. In order to achieve better results, we may consider the piece-wise 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      continuous general bilinear methods in future. Also our algorithm can be generalized to deal with surfaces with holes by performing the energy discretization (the numerical method) and computing the initial transformation only in the valid surface area (the surface outside the holes), which is left as a future work.

@&#ACKNOWLEDGMENTS@&#

This work was supported by the China National Natural Science Foundation (61202146, 61272243, and 61472225), the China National Science and Technology Support Program (2013BAH39F00), Shandong Province Outstanding Young Scientist Research Award Foundation (BS2012DX014) and Scientific Research Foundation for the Returned Overseas Chinese Scholars, State Education Ministry (SRF for ROCS, SEM).

The control points and weights of general bilinear reparameterized surface for surface of degree 1×1 are as follows. 
                        
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    
                                       0
                                       ,
                                       0
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             e
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             g
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          e
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             g
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             e
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       
                                          g
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          e
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    
                                       
                                          g
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    }
                                 
                                 /
                                 
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    }
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    
                                       0
                                       ,
                                       1
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       [
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       [
                                       
                                          
                                             e
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                 
                                 
                                    +
                                    
                                       [
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       
                                          
                                             g
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          
                                             g
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    +
                                    
                                       [
                                       
                                          
                                             e
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       
                                          
                                             g
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       
                                          
                                             g
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    }
                                 
                                 /
                                 
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          f
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    }
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    
                                       0
                                       ,
                                       2
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             e
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             g
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          e
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             g
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             e
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       
                                          g
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          e
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    
                                       
                                          g
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    }
                                 
                                 /
                                 
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    }
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    
                                       1
                                       ,
                                       0
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       [
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       [
                                       
                                          
                                             e
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                 
                                 
                                    +
                                    
                                       [
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       
                                          
                                             g
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       
                                          
                                             g
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    +
                                    
                                       [
                                       
                                          
                                             e
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       
                                          
                                             g
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       
                                          
                                             g
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    }
                                 
                                 /
                                 
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          f
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    }
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       [
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                 
                                 
                                    +
                                    
                                       [
                                       
                                          
                                             e
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                 
                                 
                                    +
                                    
                                       [
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       
                                          
                                             g
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          
                                             g
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          
                                             g
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       
                                          
                                             g
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                 
                                 
                                    +
                                    
                                       [
                                       
                                          
                                             e
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       
                                          
                                             g
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       
                                          
                                             g
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       
                                          
                                             g
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       
                                          
                                             g
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    }
                                 
                                 /
                                 
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          f
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          f
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          f
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    }
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       [
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       [
                                       
                                          
                                             e
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                 
                                 
                                    +
                                    
                                       [
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          
                                             g
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          
                                             g
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    +
                                    
                                       [
                                       
                                          
                                             e
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       
                                          
                                             g
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       
                                          
                                             g
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    }
                                 
                                 /
                                 
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          f
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    }
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    
                                       2
                                       ,
                                       0
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             e
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             g
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          e
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                    
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             g
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             e
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       
                                          g
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          e
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                    
                                       
                                          g
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    }
                                 
                                 /
                                 
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                    }
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    
                                       2
                                       ,
                                       1
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       [
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       [
                                       
                                          
                                             e
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       [
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          )
                                       
                                       
                                          
                                             g
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          
                                             g
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    +
                                    
                                       [
                                       
                                          
                                             e
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       
                                          
                                             g
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       
                                          
                                             g
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    }
                                 
                                 /
                                 
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          f
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                    }
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    
                                       2
                                       ,
                                       2
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             e
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             g
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          e
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             g
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          1
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             e
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       
                                          g
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          e
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    
                                       
                                          g
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    }
                                 
                                 /
                                 
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    }
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       0
                                       ,
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       0
                                       ,
                                       0
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       0
                                       ,
                                       0
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       0
                                       ,
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       0
                                       ,
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       0
                                       ,
                                       1
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       0
                                       ,
                                       1
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       1
                                       ,
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             0
                                             ,
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                    
                                    
                                       4
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       2
                                       ,
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       1
                                       ,
                                       0
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       1
                                       ,
                                       0
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       2
                                       ,
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             1
                                             ,
                                             0
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       2
                                       ,
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                 
                                 .
                              
                           
                        
                     
                  


                     
                        Theorem 1
                        
                           Each iso-parameter line in the parameter domain of the general bilinear reparameterized surface corresponds to a hyperbolic curve in the parameter domain of the original surface and vice versa.
                        


                     
                        Proof
                        We first examine the 
                              u
                            iso-parameter line (
                              v
                              =
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                            is a constant) in the parameter domain of the original surface as follows. From Eq. (6), we have
                              
                                 (13)
                                 
                                    
                                       
                                          m
                                       
                                       
                                          1
                                       
                                    
                                    s
                                    t
                                    +
                                    
                                       
                                          m
                                       
                                       
                                          2
                                       
                                    
                                    s
                                    +
                                    
                                       
                                          m
                                       
                                       
                                          3
                                       
                                    
                                    t
                                    +
                                    
                                       
                                          m
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    0
                                    ,
                                 
                              
                            where 
                              
                                 
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         0
                                                         ,
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         1
                                                         ,
                                                         0
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         1
                                                         ,
                                                         0
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         0
                                                         ,
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         0
                                                         ,
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         1
                                                         ,
                                                         0
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         1
                                                         ,
                                                         0
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         0
                                                         ,
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The above equation is a hyperbolic curve in the 
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                            domain. Similarly, we can obtain the implicit representation of the hyperbolic curve for the 
                              v
                            iso-parameter line. Secondly, we examine the 
                              t
                            iso-parameter line (
                              s
                              =
                              
                                 
                                    s
                                 
                                 
                                    0
                                 
                              
                            is a constant) in the parameter domain of the general bilinear reparameterized surface as follows. From Eqs. (5) and (6), we have 
                              
                                 (14)
                                 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    u
                                    v
                                    +
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    u
                                    +
                                    
                                       
                                          n
                                       
                                       
                                          3
                                       
                                    
                                    v
                                    +
                                    
                                       
                                          n
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    0
                                    ,
                                 
                              
                            where 
                              
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   )
                                                
                                                −
                                                
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      2
                                                   
                                                
                                                =
                                                
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                −
                                                
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      3
                                                   
                                                
                                                =
                                                
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                −
                                                
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      4
                                                   
                                                
                                                =
                                                
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                                −
                                                
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                                −
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      0
                                                      ,
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      1
                                                      ,
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      1
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      1
                                                      ,
                                                      0
                                                   
                                                
                                                −
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      0
                                                      ,
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                   
                                                
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                                −
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      0
                                                      ,
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                      ,
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      2
                                                   
                                                
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                      ,
                                                      0
                                                   
                                                
                                                −
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      0
                                                      ,
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      3
                                                   
                                                
                                                =
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                                −
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      0
                                                      ,
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      1
                                                      ,
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      1
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      3
                                                   
                                                
                                                =
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      1
                                                      ,
                                                      0
                                                   
                                                
                                                −
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      3
                                                   
                                                
                                                =
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      0
                                                      ,
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      3
                                                   
                                                
                                                =
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      4
                                                   
                                                
                                                =
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                                −
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      0
                                                      ,
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      1
                                                      ,
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      1
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      4
                                                   
                                                
                                                =
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      1
                                                      ,
                                                      0
                                                   
                                                
                                                −
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      4
                                                   
                                                
                                                =
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      0
                                                      ,
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      4
                                                   
                                                
                                                =
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      0
                                                      ,
                                                      0
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                            Also the above equation is a hyperbolic curve in the 
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                            domain. Similarly, we can obtain the implicit representation of the hyperbolic curve for the 
                              s
                            iso-parametric line. □

@&#REFERENCES@&#

