@&#MAIN-TITLE@&#
               Requiem for the Miller–Tucker–Zemlin subtour elimination constraints?

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Miller–Tucker–Zemlin (MTZ) and Desrochers–Laporte (DL) SECs are studied.


                        
                        
                           
                           A systematic way of deriving MTZ and DL SECs is presented.


                        
                        
                           
                           The approach is based on analyzing the convex hull of small polyhedra and facets.


                        
                        
                           
                           A generalization of the DL SECs implying 3-node CLIQUE constraints is shown.


                        
                        
                           
                           Generalizations for larger node sets are unlikely to exist.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Asymmetric traveling salesman problem

Vehicle routing

Miller–Tucker–Zemlin constraints

Projection

Subtour elimination constraints

@&#ABSTRACT@&#


               
               
                  The Miller–Tucker–Zemlin (MTZ) Subtour Elimination Constraints (SECs) and the improved version by Desrochers and Laporte (DL) have been and are still in regular use to model a variety of routing problems. This paper presents a systematic way of deriving inequalities that are more complicated than the MTZ and DL inequalities and that, in a certain way, “generalize” the underlying idea of the original inequalities. We present a polyhedral approach that studies and analyses the convex hull of feasible sets for small dimensions. This approach allows us to generate generalizations of the MTZ and DL inequalities, which are “good” in the sense that they define facets of these small polyhedra. It is well known that DL inequalities imply a subset of Dantzig–Fulkerson–Johnson (DFJ) SECs for two-node subsets. Through the approach presented, we describe a generalization of these inequalities which imply DFJ SECs for three-node subsets and show that generalizations for larger subsets are unlikely to exist. Our study presents a similar analysis with generalizations of MTZ inequalities and their relation with the lifted circuit inequalities for three node subsets.
               
            

@&#INTRODUCTION@&#

Given a loop-free directed graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           A
                           )
                        
                      where 
                        
                           V
                           =
                           {
                           1
                           ,
                           …
                           ,
                           n
                           }
                        
                      is the set of nodes, 
                        
                           A
                           =
                           {
                           (
                           i
                           ,
                           j
                           )
                           :
                           i
                           ,
                           j
                           ∈
                           V
                           ,
                           i
                           
                           ≠
                           
                           j
                           }
                        
                      is the set of arcs and c
                     
                        ij
                      is the cost (e.g., distance) associated with each arc 
                        
                           (
                           i
                           ,
                           j
                           )
                           ∈
                           A
                        
                     , the asymmetric traveling salesman problem (ATSP) consists of finding the least cost Hamiltonian circuit, i.e., an elementary circuit traversing all nodes contained in the graph (Lawler, Lenstra, Rinnooy Kann, & Shmoys, 1985). Several known formulations for the ATSP are based on the following general scheme (see, for instance, Langevin, Soumis, & Desrosiers, 1990):
                        
                           (1.1)
                           
                              (
                              ATSP
                              )
                              
                              minimize
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ∈
                                       A
                                    
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    ij
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (1.2)
                           
                              subject
                              
                              to
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       V
                                       :
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ∈
                                       A
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              =
                              1
                              
                              ∀
                              j
                              ∈
                              V
                              ,
                           
                        
                     
                     
                        
                           (1.3)
                           
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       V
                                       :
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ∈
                                       A
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              =
                              1
                              
                              ∀
                              i
                              ∈
                              V
                              ,
                           
                        
                     
                     
                        
                           (1.4)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                          {
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          :
                                          
                                             
                                                x
                                             
                                             
                                                ij
                                             
                                          
                                          =
                                          1
                                          }
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          do
                                          
                                          not
                                          
                                          contain
                                          
                                          subtours
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1.5)
                           
                              
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              
                              ∀
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              A
                              ,
                           
                        
                     where x
                     
                        ij
                      is a binary variable equal to 1 if arc (i, j) is in the tour, or equal to 0 otherwise. Node 1 is the depot where the salesman begins and ends the tour. Constraints (1.2), (1.3) and (1.5) define the usual assignment relaxation for the ATSP. Constraints (1.4) prevent the formation of subtours not containing node 1 and can be written in several different forms. We will refer to these constraints as Subtour Elimination Constraints (SECs) and elaborate on such constraints shortly. Given an integer linear programming formulation 
                        
                           P
                        
                     , we shall henceforth denote by 
                        
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                        
                      its linear programming (LP) relaxation and by 
                        
                           v
                           (
                           P
                           )
                        
                      the value of its optimal solution. The LP relaxation of any of the models discussed in this paper is defined by replacing constraints (1.5) with
                        
                           (1.6)
                           
                              0
                              ⩽
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              (
                              ⩽
                              1
                              )
                              ,
                              
                              ∀
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              A
                              .
                           
                        
                     
                  

Different ways of modeling constraints (1.4) have been proposed in the literature. These can be divided into two families. The first family of natural formulations uses inequalities involving only the x
                     
                        ij
                      variables, as they contain one and only one variable corresponding to each arc included in the underlying graph. The other family uses inequalities that involve additional variables and formulations in this class are usually referred to as extended formulations. The information attached to these additional variables may considerably reduce the number of constraints involved in the model and quite often allow for deriving compact formulations (i.e., formulations involving a polynomial number of constraints and variables). By projecting the set of feasible solutions of the LP relaxation of an extended formulation into the subspace defined by the x
                     
                        ij
                      variables, one obtains a natural formulation which is equivalent to the former in the sense that both formulations produce the same LP bound. However, such natural formulations usually involve an exponential number of constraints. The reader is referred to Padberg and Sung (1991), Wong (1980), Langevin et al. (1990), Gouveia and Pires (1999), Öncan, Altinel, and Laporte (2009) and Roberti and Toth (2012), who describe and introduce several extended formulation together with the corresponding “equivalent” natural formulations. Some examples to these formulations will be given in the following sections.

One of the strongest and well known representations of (1.4) is due to Dantzig, Fulkerson, and Johnson (1954), who proposed the following inequalities:
                        
                           (1.7)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       S
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       S
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              ⩽
                              |
                              S
                              |
                              -
                              1
                              
                              ∀
                              S
                              ⊆
                              {
                              2
                              ,
                              …
                              ,
                              n
                              }
                              ,
                              
                              |
                              S
                              |
                              ⩾
                              2
                              .
                           
                        
                     
                  

These constraints are exponential in number and are known to be facet defining for the ATSP polytope under mild conditions (see Grötschel & Padberg, 1985). These inequalities imply that the number of arcs which can be packed in the clique defined by the set of nodes 
                        
                           S
                        
                      cannot exceed 
                        
                           |
                           S
                           |
                           -
                           1
                        
                     . We will refer to constraints (1.7) as CLIQUE constraints. A weaker version of constraints (1.7) are the CIRCUIT inequalities which are given as follows:
                        
                           (1.8)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ∈
                                       C
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              ⩽
                              |
                              C
                              |
                              -
                              1
                              
                              ∀
                              C
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 G
                              
                              
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                              
                           
                        
                      is the complete graph induced by the set of nodes 
                        
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           =
                           2
                           ,
                           …
                           ,
                           n
                        
                      and 
                        
                           C
                        
                      is any set of arcs defining an elementary circuit (i.e., no nodes are repeated in the circuit) in 
                        
                           
                              
                                 G
                              
                              
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                              
                           
                        
                     . These constraints have been described by Grötschel and Padberg (1985) and state that the number of arcs which can be packed in a given circuit 
                        
                           C
                        
                      cannot exceed 
                        
                           |
                           C
                           |
                           -
                           1
                        
                     .

A well-known example of an extended formulation for the ATSP is due to Miller, Tucker, and Zemlin (1960), who proposed the following Subtour Elimination Constraints (SECs):
                           
                              (1.9)
                              
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 +
                                 (
                                 n
                                 -
                                 1
                                 )
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 ⩽
                                 n
                                 -
                                 2
                                 
                                 ∀
                                 i
                                 
                                 ≠
                                 
                                 j
                                 =
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                              
                           
                        
                        
                           
                              (1.10)
                              
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 R
                                 
                                 ∀
                                 i
                                 =
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 .
                              
                           
                        
                     

Formulation ATSP where (1.4) is replaced by (1.9) and (1.10) will henceforth be referred to as F(MTZ) and constraints (1.9) by MTZ. The additional variables u
                        
                           i
                         in these constraints are used to give an ordering to all nodes excluding the depot to prevent the formation of illegal subtours. This is ensured by having u
                        
                           j
                        
                        ⩾
                        u
                        
                           i
                        
                        +1 when x
                        
                           ij
                        
                        =1. Notice also that constraints (1.10) can be replaced by
                           
                              (1.11)
                              
                                 0
                                 ⩽
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ⩽
                                 n
                                 -
                                 2
                                 
                                 ∀
                                 i
                                 =
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                              
                           
                        without altering v(F(MTZ)
                           L
                        ). Constraints (1.11) help to give a precise meaning to each variable u
                        
                           i
                        , i.e., with the inclusion of (1.11), the value given by u
                        
                           i
                         indicates the position of node i in the tour, or more precisely the number of intermediate nodes in the path between node 1 and node i in the optimal tour.

It is known that F(MTZ) has a weak LP relaxation (Gouveia & Pires, 1999; Langevin et al., 1990) and that the projection of the set of feasible solutions defined by F(MTZ)
                           L
                         into the space defined by the x variables is given by (1.2), (1.3) and (1.6) (Padberg & Sung, 1991) and the following inequalities
                           
                              (1.12)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          C
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 ⩽
                                 |
                                 C
                                 |
                                 -
                                 
                                    
                                       |
                                       C
                                       |
                                    
                                    
                                       n
                                       -
                                       1
                                    
                                 
                                 
                                 ∀
                                 C
                                 ∈
                                 
                                    
                                       G
                                    
                                    
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        which are weaker versions of the CIRCUIT inequalities (since 
                           
                              |
                              C
                              |
                              ⩽
                              n
                              -
                              1
                           
                        ).

One ingenious way of improving MTZ constraints is due to Desrochers and Laporte (1991), who proposed the following lifted version of (1.9):
                           
                              (1.13)
                              
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 +
                                 (
                                 n
                                 -
                                 1
                                 )
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 +
                                 (
                                 n
                                 -
                                 3
                                 )
                                 
                                    
                                       x
                                    
                                    
                                       ji
                                    
                                 
                                 ⩽
                                 n
                                 -
                                 2
                                 
                                 ∀
                                 i
                                 
                                 ≠
                                 
                                 j
                                 =
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 .
                              
                           
                        
                     

We will further refer to inequalities (1.13) as DL. These constraints are interesting for two reasons: (i) they make the relation between the u
                        
                           i
                         and x
                        
                           ij
                         variables stronger since when x
                        
                           ij
                        
                        =1, a combined use of constraints (1.13) for pairs (i, j) and (j, i) imply u
                        
                           j
                        
                        =
                        u
                        
                           i
                        
                        +1, and (ii) they imply the CLIQUE constraints for sets 
                           
                              S
                           
                         with two nodes. This is easy to see by adding two DL inequalities, one for a given pair (i, j) and the other for the reversed pair (j, i), which results in the CLIQUE constraint for the set {i, j}.

Reformulation techniques using other sets of variables and which imply MTZ and DL constraints have been proposed in Gouveia and Pires (1999, 2001), Sherali and Driscoll (2002), Marcotte, Savard, and Semet (2004), Sarin, Sherali, and Bhootra (2005), Gouveia and Pesneau (2006), Sherali, Sarin, and Tsai (2006) and Yaman (2006).

Of the one that is relevant to our discussion here is by Sherali and Driscoll (2002), who propose an integer linear programming formulation of the TSP obtained by applying a Reformulation–Linearization Technique (RLT), which we will refer to as SD. They show that formulation SD implies the Desrochers and Laporte (1991) for two-node subsets. Their formulation uses, in addition to the u
                        
                           i
                         variables, new variables y
                        
                           ij
                         representing the position of arc 
                           
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              A
                           
                         in the tour. Later, Godinho, Gouveia, and Pesneau (2011, chap. 7) showed that the SD formulation is the flow-based formulation by Gavish and Graves (1978) augmented with several sets of constraints. An interesting application of the RLT presented by Sherali and Driscoll (2002) is to extend the idea to three-node subsets, similar to the aims of this paper. The application results in the following MTZ-like valid inequalities for the ATSP:
                           
                              (1.14)
                              
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                                 ⩾
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 2
                                 -
                                 (
                                 n
                                 -
                                 1
                                 )
                                 (
                                 2
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       jk
                                    
                                 
                                 )
                                 +
                                 (
                                 n
                                 -
                                 2
                                 )
                                 (
                                 1
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 )
                                 (
                                 1
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       jk
                                    
                                 
                                 )
                                 +
                                 (
                                 n
                                 -
                                 1
                                 )
                                 
                                    
                                       x
                                    
                                    
                                       ik
                                    
                                 
                                 +
                                 (
                                 n
                                 -
                                 4
                                 )
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ki
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       jk
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ki
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       kj
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ji
                                    
                                 
                                 )
                                 
                                 ∀
                                 i
                                 
                                 ≠
                                 
                                 j
                                 
                                 ≠
                                 
                                 k
                                 =
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 .
                              
                           
                        
                     

Inequalities (1.14) are interesting in that they provide information on the relationship between the u
                        
                           i
                         and u
                        
                           k
                         variables, in a same way as (1.13), but for three nodes. In particular, the constraints imply u
                        
                           k
                        
                        =
                        u
                        
                           i
                        
                        +2 when x
                        
                           ij
                        
                        =
                        x
                        
                           jk
                        
                        =1 for i
                        ≠
                        j
                        ≠
                        k
                        =2,…,
                        n. However, as it is clear from their structure, constraints (1.14) are multilinear (quadratic).

@&#MOTIVATION@&#

MTZ-like constraints, such as (1.9) and (1.13), although originally proposed for the ATSP, have also extensions to a variety of Vehicle Routing Problems. A brief overview of the recent literature indicates that, even though these constraints produce weak relaxations, they are still popular and are being used to model various types of conditions for similar problems. One reason for this situation is the flexibility of these constraints, whereas another reason can be stated as their capability in solving small to medium sized problems to optimality via general easily available linear integer programming codes.

However, as mentioned before we should not ignore that these constraints produce weak relaxations. Also, since the work by Desrochers and Laporte (1991) no significant improvement has been done with respect to MTZ-like formulations in the space of the (u, x) variables. This motivates the main research question that we try to answer here:
                           
                              Can we find generalizations of the DL inequalities in the (x, u) space that would imply all CLIQUE inequalities?
                           
                        
                     

We emphasize that an affirmative answer to question would lead to a model with a strong LP relaxation, at least as strong as CLIQUE. Furthermore, we think that such a model would be attractive to the past users of MTZ like formulations even though this hypothetical model may turn out to be exponential in size and may need routines for constraint separation to be used in practice. On the other hand we should note that this question is not straightforward to address. In particular, it is not easy to find a systematic method that shows how to generalize the MTZ and DL inequalities or, alternatively, show that it cannot be done. Furthermore, generalizing DL inequalities “by hand” in such a way that by projection we would obtain CLIQUE inequalities for sets of cardinality as small as three nodes already appears to be a nontrivial task.

In this paper, we provide and illustrate a “polyhedral approach” that corresponds to finding all (or at least, interesting) facet defining inequalities of several polyhedra that are obtained by considering the integer solutions for a sequence of problems defined in increasingly larger subsets of nodes and arcs involving the two sets of variables. We first show that this approach, when used for two node sets, allows us to reinvent the MTZ and DL inequalities. This positive outcome suggests that extending the approach for larger sets might reveal what we are looking for.

As we shall show in our investigations, we will be able to answer affirmatively to the question in the case of three nodes by presenting linear inequalities. We will also give some valid arguments to conclude that such inequalities do not exist for bigger sets showing that the hypothetical good model is unlikely to exist. Our conclusion is that although the MTZ and DL like inequalities definitely have a most deserved Oscar for the most compact and easier to handle category in the TSP extended formulations awards, it is not clear whether much more can be done with the sets of variables u
                        
                           i
                         and x
                        
                           ij
                         in terms of improving the model further.

The rest of the paper is structured as follows. In Section 2, we describe the polyhedral approach to “reinvent” the DL inequalities. In Section 3 we use the same approach to discover more complicated inequalities that in a certain sense generalize the DL inequalities. Section 4 presents projection results with the new inequalities. Computational results are presented in Section 5. Conclusions are stated in Section 6.

One way of viewing and motivating the MTZ constraints is as follows. It is well known that inequalities (1.9) guarantee that, for two arcs (i, j) and (j, i), i, j
                     =2,…,
                     n; i
                     ≠
                     j and for two variables 0⩽
                     u
                     
                        i
                     , u
                     
                        j
                     
                     ⩽
                     n
                     −2, the following conditions hold:
                        
                           •
                           (A1) if x
                              
                                 ij
                              
                              =1 and x
                              
                                 ji
                              
                              =0 then u
                              
                                 j
                              
                              ⩾
                              u
                              
                                 i
                              
                              +1,

(A2) if x
                              
                                 ij
                              
                              =0 and x
                              
                                 ji
                              
                              =1 then u
                              
                                 i
                              
                              ⩾
                              u
                              
                                 j
                              
                              +1,

(A3) if x
                              
                                 ij
                              
                              =0 and x
                              
                                 ji
                              
                              =0 then ∣u
                              
                                 i
                              
                              −
                              u
                              
                                 j
                              ∣⩽
                              n
                              −2,

(A4) 0⩽
                              u
                              
                                 i
                              
                              ⩽
                              n
                              −2, 0⩽
                              u
                              
                                 j
                              
                              ⩽
                              n
                              −2, x
                              
                                 ij
                              , x
                              
                                 ji
                              
                              ∈{0,1}.

In this section, we will examine the reversed argument. Suppose we consider a polyhedron 
                        
                           
                              
                                 P
                              
                              
                                 MTZ
                              
                              
                                 2
                              
                           
                        
                      on the four variables u
                     
                        i
                     , u
                     
                        j
                     , x
                     
                        ij
                      and x
                     
                        ji
                      and defined by the convex hull of the set of points satisfying conditions (A1)–(A4). Several questions arise at this point: Which set of inequalities describe this polyhedron? Does this set include the previous known MTZ constraints? Or can we do better?

In fact, for small sets of nodes (n
                     =4,…,7) we can easily give a complete description of 
                        
                           
                              
                                 P
                              
                              
                                 MTZ
                              
                              
                                 2
                              
                           
                        
                      using PORTA (Christof & Löbel, 2004):
                        
                           (2.1)
                           
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    ji
                                 
                              
                              ⩾
                              0
                              ,
                           
                        
                     
                     
                        
                           (2.2)
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              ⩾
                              
                                 
                                    x
                                 
                                 
                                    ji
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (2.3)
                           
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                              ⩾
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (2.4)
                           
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              +
                              
                                 
                                    x
                                 
                                 
                                    ji
                                 
                              
                              ⩽
                              1
                              ,
                           
                        
                     
                     
                        
                           (2.5)
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              ⩽
                              n
                              -
                              2
                              ,
                           
                        
                     
                     
                        
                           (2.6)
                           
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                              +
                              
                                 
                                    x
                                 
                                 
                                    ji
                                 
                              
                              ⩽
                              n
                              -
                              2
                              ,
                           
                        
                     
                     
                        
                           (2.7)
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                              +
                              (
                              n
                              -
                              1
                              )
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              ⩽
                              n
                              -
                              2
                              ,
                           
                        
                     
                     
                        
                           (2.8)
                           
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                              -
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              +
                              (
                              n
                              -
                              1
                              )
                              
                                 
                                    x
                                 
                                 
                                    ji
                                 
                              
                              ⩽
                              n
                              -
                              2
                              .
                           
                        
                     
                  

We note that this description was obtained for small values of n and we have no proof of completeness for any value of n. However, the listed inequalities are valid for any value of n. We denote by 
                        
                           
                              
                                 F
                              
                              
                                 MTZ
                              
                              
                                 2
                              
                           
                        
                      the model (2.1)–(2.8). In 
                        
                           
                              
                                 F
                              
                              
                                 MTZ
                              
                              
                                 2
                              
                           
                        
                     , besides rediscovering the MTZ constraints (2.7) and (2.8), constraints (2.2) and (2.3) give lower bounds on the values of the two node variables u
                     
                        i
                      and u
                     
                        j
                     , depending on the inclusion, or not, of arcs (j, i) and (i, j), respectively. Similarly, constraints (2.5) and (2.6) provide upper bounds on the same variables. We note that similar constraints have already been proposed in the literature (Desrochers & Laporte, 1991; Gouveia, 1996). Constraints (2.1) are the boundary conditions on variables x
                     
                        ij
                      and x
                     
                        ji
                     . One interesting aspect of the polyhedron 
                        
                           
                              
                                 P
                              
                              
                                 MTZ
                              
                              
                                 2
                              
                           
                        
                      is constraints (2.4), which are two-node versions of CLIQUE constraints (1.7). In fact, as the following proposition shows, these inequalities are facet defining for 
                        
                           
                              
                                 P
                              
                              
                                 MTZ
                              
                              
                                 2
                              
                           
                        
                     :
                        Proposition 1
                        
                           Let F
                           
                              2CLIQUE
                            
                           denote a face of 
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       MTZ
                                    
                                    
                                       2
                                    
                                 
                              
                            
                           shown as 
                           
                              
                                 {
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       ji
                                    
                                 
                                 )
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       MTZ
                                    
                                    
                                       2
                                    
                                 
                                 :
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       ji
                                    
                                 
                                 =
                                 1
                                 }
                              
                           
                           . Then, F
                           
                              2CLIQUE
                            
                           is a facet of 
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       MTZ
                                    
                                    
                                       2
                                    
                                 
                              
                            
                           for n
                           ⩾
                           4.
                        

It is easy to see that F
                           2CLIQUE
                            is a valid inequality for and a proper face of 
                              
                                 
                                    
                                       P
                                    
                                    
                                       MTZ
                                    
                                    
                                       2
                                    
                                 
                              
                           . We now observe that 
                              
                                 
                                    
                                       P
                                    
                                    
                                       MTZ
                                    
                                    
                                       2
                                    
                                 
                              
                            is full-dimensional as (n
                           −2−2∊, n
                           −2−2∊, ∊, ∊) is a set of interior points for a sufficiently small constant ∊
                           >0. Therefore, 
                              
                                 dim
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       MTZ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 4
                              
                            and dim (F
                           2CLIQUE
                           )⩽3. To prove that F
                           2CLIQUE
                            defines a facet of the underlying polyhedron, it suffices to show the existence of four affinely independent points satisfying this constraint as an equality. Consider the set of points (u
                           
                              1
                           , u
                           
                              2
                           , u
                           
                              3
                           , u
                           
                              4
                           )={(u
                           
                              i
                           , u
                           
                              i
                           
                           +1, 1, 0), (u
                           
                              i
                           , u
                           
                              i
                           
                           +2, 1, 0), (u
                           
                              i
                           
                           +1, u
                           
                              i
                           , 0, 1), (u
                           
                              i
                           
                           +2, u
                           
                              i
                           , 0, 1)} for 0⩽
                           u
                           
                              i
                           
                           ⩽
                           n
                           −2. For scalars λ
                           
                              i
                           , i
                           =1,…,4, λ
                           1
                           u
                           
                              1
                           
                           +
                           λ
                           2
                           u
                           
                              2
                           
                           +
                           λ
                           3
                           u
                           
                              3
                           
                           +
                           λ
                           4 
                           u
                           
                              4
                           
                           =0 and 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 0
                              
                            result in the unique solution λ
                           
                              i
                           
                           =0 for i
                           =1,…,4, hence proving that the four points are affinely independent. Then, dim (F
                           2CLIQUE
                           )⩾3 which implies dim (F
                           2CLIQUE
                           )=3 and the proof follows.□

Consider, now, the case where we complicate the original polyhedron by considering the following conditions, resulting in polyhedron 
                        
                           
                              
                                 P
                              
                              
                                 DL
                              
                              
                                 2
                              
                           
                        
                      on two nodes i and j, as the convex hull of the points satisfying the conditions below:
                        
                           •
                           (A5) if x
                              
                                 ij
                              
                              =1 and x
                              
                                 ji
                              
                              =0 then u
                              
                                 j
                              
                              =
                              u
                              
                                 i
                              
                              +1,

(A6) if x
                              
                                 ij
                              
                              =0 and x
                              
                                 ji
                              
                              =1 then u
                              
                                 i
                              
                              =
                              u
                              
                                 j
                              
                              +1,

(A7) if x
                              
                                 ij
                              
                              =0 and x
                              
                                 ji
                              
                              =0 then ∣u
                              
                                 i
                              
                              −
                              u
                              
                                 j
                              ∣⩽
                              n
                              −2,

(A8) 0⩽
                              u
                              
                                 i
                              
                              ⩽
                              n
                              −2, 0⩽
                              u
                              
                                 j
                              
                              ⩽
                              n
                              −2, x
                              
                                 ij
                              , x
                              
                                 ji
                              
                              ∈{0,1}.

The four conditions (A5)–(A8) are very similar to (A1)–(A4) apart from the relationship between variables u
                     
                        i
                      and u
                     
                        j
                      being stated as an equality, rather than an inequality. Let 
                        
                           
                              
                                 F
                              
                              
                                 DL
                              
                              
                                 2
                              
                           
                        
                      denote the following model:
                        
                           (2.9)
                           
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    ji
                                 
                              
                              ⩾
                              0
                              ,
                           
                        
                     
                     
                        
                           (2.10)
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              ⩾
                              
                                 
                                    x
                                 
                                 
                                    ji
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (2.11)
                           
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                              ⩾
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (2.12)
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              ⩽
                              n
                              -
                              2
                              ,
                           
                        
                     
                     
                        
                           (2.13)
                           
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                              +
                              
                                 
                                    x
                                 
                                 
                                    ji
                                 
                              
                              ⩽
                              n
                              -
                              2
                              ,
                           
                        
                     
                     
                        
                           (2.14)
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                              +
                              (
                              n
                              -
                              1
                              )
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              +
                              (
                              n
                              -
                              3
                              )
                              
                                 
                                    x
                                 
                                 
                                    ji
                                 
                              
                              ⩽
                              n
                              -
                              2
                              ,
                           
                        
                     
                     
                        
                           (2.15)
                           
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                              -
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              +
                              (
                              n
                              -
                              1
                              )
                              
                                 
                                    x
                                 
                                 
                                    ji
                                 
                              
                              +
                              (
                              n
                              -
                              3
                              )
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              ⩽
                              n
                              -
                              2
                              .
                           
                        
                     
                  

Based on an analysis with PORTA, 
                        
                           
                              
                                 F
                              
                              
                                 DL
                              
                              
                                 2
                              
                           
                        
                      gives a complete description of 
                        
                           
                              
                                 P
                              
                              
                                 DL
                              
                              
                                 2
                              
                           
                        
                      for n
                     =4,…,7. 
                        
                           
                              
                                 F
                              
                              
                                 DL
                              
                              
                                 2
                              
                           
                        
                      includes similar inequalities to 
                        
                           
                              
                                 F
                              
                              
                                 MTZ
                              
                              
                                 2
                              
                           
                        
                      as well as the “reinvented” DL inequalities (1.13) listed as (2.14) and (2.15). Note that this description does not include the CLIQUE constraints (1.7) for S
                     ={i, j}, which, although valid for 
                        
                           
                              
                                 P
                              
                              
                                 DL
                              
                              
                                 2
                              
                           
                        
                     , are implied by the DL inequalities (2.14) and (2.15). Thus, we conclude that specifying u
                     
                        j
                     
                     =
                     u
                     
                        i
                     
                     +1, instead of the weaker version u
                     
                        j
                     
                     ⩾
                     u
                     
                        i
                     
                     +1, when x
                     
                        ij
                     
                     =1 has a strong effect on the description of the corresponding polyhedron.

We now show that inequalities (2.14) define facets of 
                        
                           
                              
                                 P
                              
                              
                                 DL
                              
                              
                                 2
                              
                           
                        
                     .
                        Proposition 2
                        
                           Let F
                           
                              DL
                            
                           denote a face of 
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       DL
                                    
                                    
                                       2
                                    
                                 
                              
                            
                           shown as 
                           
                              
                                 {
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       ji
                                    
                                 
                                 )
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       DL
                                    
                                    
                                       2
                                    
                                 
                                 :
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 +
                                 (
                                 n
                                 -
                                 1
                                 )
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 +
                                 (
                                 n
                                 -
                                 3
                                 )
                                 
                                    
                                       x
                                    
                                    
                                       ji
                                    
                                 
                                 =
                                 n
                                 -
                                 2
                                 }
                              
                           
                           . Then, F
                           
                              DL
                            
                           is a facet of 
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       DL
                                    
                                    
                                       2
                                    
                                 
                              
                            
                           for n
                           ⩾
                           4.
                        

It is easy to see that F
                           
                              DL
                            is a (proper) face of 
                              
                                 
                                    
                                       P
                                    
                                    
                                       DL
                                    
                                    
                                       2
                                    
                                 
                              
                            by checking for all points satisfying conditions (A5)–(A8) and that F
                           
                              DL
                            holds with equality for at least one point in 
                              
                                 
                                    
                                       P
                                    
                                    
                                       DL
                                    
                                    
                                       2
                                    
                                 
                              
                           , e.g., (u
                           
                              i
                           , u
                           
                              j
                           , x
                           
                              ij
                           , x
                           
                              ji
                           )=(n
                           −2, n
                           −1, 1, 0). Similar to Proposition 1, it is easy to see that 
                              
                                 
                                    
                                       P
                                    
                                    
                                       DL
                                    
                                    
                                       2
                                    
                                 
                              
                            is full-dimensional so 
                              
                                 dim
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                DL
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 =
                                 4
                              
                            and dim (F
                           
                              DL
                           )⩽3. To prove that (2.14) define facets of the underlying polyhedron, notice that (u
                           
                              i
                           , u
                           
                              j
                           , x
                           
                              ij
                           , x
                           
                              ji
                           )={(0, 1, 1, 0), (n
                           −3, n
                           −2, 1, 0), (n
                           −2, n
                           −3, 0, 1), (n
                           −2, 0, 0, 0)} are four affinely independent points satisfying F
                           
                              DL
                            at equality, hence dim (F
                           
                              DL
                           )⩾3. This implies dim (F
                           
                              DL
                           )=3.□

Before concluding the section we review and compare, from a theoretical point of view, the two polyhedra 
                        
                           
                              
                                 P
                              
                              
                                 MTZ
                              
                              
                                 2
                              
                           
                        
                      and 
                        
                           
                              
                                 P
                              
                              
                                 DL
                              
                              
                                 2
                              
                           
                        
                     . First, we observe that allowing u
                     
                        j
                     
                     =
                     u
                     
                        i
                     
                     +1 leads to the strong DL constraints (2.14) and (2.15) which imply CLIQUE constraints (1.7) for 
                        
                           S
                           =
                           {
                           i
                           ,
                           j
                           }
                        
                     . The DL inequalities are not valid for 
                        
                           
                              
                                 P
                              
                              
                                 MTZ
                              
                              
                                 2
                              
                           
                        
                      and therefore CLIQUE constraints for two nodes need to be included in its description.

The analysis of the polyhedra 
                        
                           
                              
                                 P
                              
                              
                                 MTZ
                              
                              
                                 2
                              
                           
                        
                      and 
                        
                           
                              
                                 P
                              
                              
                                 DL
                              
                              
                                 2
                              
                           
                        
                      presented in this section for a subset of two nodes i and j produce inequalities which are already known, namely the MTZ and the DL inequalities, for a subset of two nodes i and j. In order to find generalizations of these inequalities, we complicate the previous polyhedra by “enlarging” the set of nodes and arcs in our initial polyhedron. This is presented in the next section.

This section extends the analysis in the previous section to three and four node sets.

In the previous section, we have distinguished between the “⩽” polyhedron (where the relationship between the u variables is an inequality) named 
                           
                              
                                 
                                    P
                                 
                                 
                                    MTZ
                                 
                                 
                                    2
                                 
                              
                           
                         and the “=” polyhedron named 
                           
                              
                                 
                                    P
                                 
                                 
                                    DL
                                 
                                 
                                    2
                                 
                              
                           
                         (where the relationship between the u variables is an equality), and we have shown that stronger inequalities can be obtained by using the latter. It is for this reason that the analysis presented in the following will only consider the “=” polyhedra, although for comparison purposes we will comment on the “⩽” at the end of this section.

We now extend the previous analysis to a set with three nodes S
                        ={i, j, k}. Let 
                           
                              x
                              (
                              S
                              :
                              
                                 
                                    S
                                 
                                 
                                    ′
                                 
                              
                              )
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    ∈
                                    S
                                    ,
                                    j
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                           
                        . For notational convenience, we will write x(S) instead of x(S: S). Consider now the polyhedron 
                           
                              
                                 
                                    P
                                 
                                 
                                    DL
                                 
                                 
                                    3
                                 
                              
                           
                         defined by the convex hull of the set of points satisfying the conditions below, with x
                        
                           ab
                        
                        ∈{0,1} for all distinct a, b
                        ∈
                        S and 0⩽
                        u
                        
                           a
                        
                        ⩽
                        n
                        −2 for all a
                        ∈
                        S:
                           
                              •
                              
                                 x({t}: S⧹{t})⩽1, for t
                                 ∈
                                 S,


                                 x(S⧹{t}:{t})⩽1, for t
                                 ∈
                                 S,

for all a
                                 ≠
                                 b
                                 ≠
                                 c
                                 ∈{i, j, k}, if x
                                 
                                    ab
                                 
                                 +
                                 x
                                 
                                    bc
                                 
                                 =2 then u
                                 
                                    c
                                 
                                 =
                                 u
                                 
                                    a
                                 
                                 +2 and u
                                 
                                    b
                                 
                                 =
                                 u
                                 
                                    a
                                 
                                 +1, otherwise ∣u
                                 
                                    c
                                 
                                 −
                                 u
                                 
                                    a
                                 ∣⩽
                                 n
                                 −2.

for all a
                                 ≠
                                 b
                                 ∈{i, j, k}, if x
                                 
                                    ab
                                 
                                 =1 then u
                                 
                                    b
                                 
                                 =
                                 u
                                 
                                    a
                                 
                                 +1, otherwise ∣u
                                 
                                    b
                                 
                                 −
                                 u
                                 
                                    a
                                 ∣⩽
                                 n
                                 −2.

We started our analysis by using PORTA (Christof & Löbel, 2004) for 4⩽
                        n
                        ⩽7 to list a complete description of the convex hull of solutions satisfying the conditions above. Unfortunately, even for these small values of n the list turned out to be too long. However, a “search” of the list has provided some interesting inequalities, presented below.

The first set of constraints (3.1) are similar in structure to DL inequalities in that they include two variables u
                           
                              i
                            and u
                           
                              k
                            along with a set of variables associated with every arc in the three-node set:
                              
                                 (3.1)
                                 
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    (
                                    n
                                    -
                                    1
                                    )
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          ij
                                       
                                    
                                    +
                                    
                                       
                                          x
                                       
                                       
                                          jk
                                       
                                    
                                    )
                                    +
                                    (
                                    n
                                    -
                                    3
                                    )
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          kj
                                       
                                    
                                    +
                                    
                                       
                                          x
                                       
                                       
                                          ji
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          nx
                                       
                                       
                                          ik
                                       
                                    
                                    +
                                    (
                                    n
                                    -
                                    4
                                    )
                                    
                                       
                                          x
                                       
                                       
                                          ki
                                       
                                    
                                    ⩽
                                    2
                                    n
                                    -
                                    4
                                    .
                                 
                              
                           
                        

These constraints are clearly valid for 4⩽
                           n
                           ⩽7 (as we obtained them by using PORTA) and here we provide a proof of their validity for any value of n:
                              Proposition 3
                              
                                 For every node triple i
                                 ≠
                                 j
                                 ≠
                                 k
                                 ≠
                                 1, constraints 
                                 (3.1) 
                                 are valid for the polyhedron 
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             DL
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 .
                              

To see that constraints (3.1) are valid we consider the six maximal mutually exclusive cases:
                                    
                                       1.
                                       
                                          x
                                          
                                             ij
                                          
                                          =
                                          x
                                          
                                             jk
                                          
                                          =1 and x
                                          
                                             ab
                                          
                                          =0 for the four remaining arcs (a, b) where a, b
                                          ∈
                                          S implies u
                                          
                                             i
                                          
                                          −
                                          u
                                          
                                             k
                                          
                                          +2(n
                                          −1)⩽2n
                                          −4 leading to u
                                          
                                             i
                                          
                                          −
                                          u
                                          
                                             k
                                          
                                          ⩽−2 which is valid.


                                          x
                                          
                                             jk
                                          
                                          =
                                          x
                                          
                                             ki
                                          
                                          =1 and x
                                          
                                             ab
                                          
                                          =0 for the four remaining arcs (a, b) where a, b
                                          ∈
                                          S implies u
                                          
                                             i
                                          
                                          −
                                          u
                                          
                                             k
                                          
                                          ⩽1 which is valid.


                                          x
                                          
                                             ki
                                          
                                          =
                                          x
                                          
                                             ij
                                          
                                          =1 and x
                                          
                                             ab
                                          
                                          =0 for the four remaining arcs (a, b) where a, b
                                          ∈
                                          S is similar to Case 2 above implying u
                                          
                                             i
                                          
                                          −
                                          u
                                          
                                             k
                                          
                                          ⩽1.


                                          x
                                          
                                             ik
                                          
                                          =
                                          x
                                          
                                             kj
                                          
                                          =1 and x
                                          
                                             ab
                                          
                                          =0 for the four remaining arcs (a, b) where a, b
                                          ∈
                                          S implies u
                                          
                                             i
                                          
                                          −
                                          u
                                          
                                             k
                                          
                                          ⩽−1.


                                          x
                                          
                                             ji
                                          
                                          =
                                          x
                                          
                                             ik
                                          
                                          =1 and x
                                          
                                             ab
                                          
                                          =0 for the four remaining arcs (a, b) where a, b
                                          ∈
                                          S implies u
                                          
                                             i
                                          
                                          −
                                          u
                                          
                                             k
                                          
                                          ⩽−1.


                                          x
                                          
                                             kj
                                          
                                          =
                                          x
                                          
                                             ji
                                          
                                          =1 and x
                                          
                                             ab
                                          
                                          =0 for the four remaining arcs (a, b) where a, b
                                          ∈
                                          S implies u
                                          
                                             i
                                          
                                          −
                                          u
                                          
                                             k
                                          
                                          ⩽
                                          −2. □

A few interesting remarks on these inequalities are given next:
                              
                                 •
                                 We first observe that these inequalities are also valid for the ATSP polyhedron. This follows from the result of Proposition 3.

Constraints (3.1) imply CLIQUE constraints for three node sets. Such a constraint for the set {i, j, k} results from adding up two inequalities (3.1) for the triples (i, j, k) and (k, j, i). In fact, the same inequality can also be obtained by adding three of such constraints, namely for the triples (i, j, k), (k, i, j) and (j, k, i). Thus, the new constraints (3.1) can be considered as a generalization of DL inequalities for three nodes. Fig. 1
                                     shows the support graph of constraints (3.1).

Combining inequality (3.1) for the triples {i, j, k} and {k, j, i} when x
                                    
                                       ij
                                    
                                    =1 and x
                                    
                                       jk
                                    
                                    =1 (or x
                                    
                                       kj
                                    
                                    =1 and x
                                    
                                       ji
                                    
                                    =1) we obtain the intended interpretation u
                                    
                                       i
                                    
                                    −
                                    u
                                    
                                       k
                                    
                                    =2. However, in contrast to the DL inequalities, constraints (3.1) alone in place of (1.4) do not provide a valid model for the ATSP since they only guarantee u
                                    
                                       i
                                    
                                    −
                                    u
                                    
                                       k
                                    
                                    ⩽
                                    n
                                    −4 when x
                                    
                                       ik
                                    
                                    =1. Thus, they provide the correct information on the u variables for paths of length two, but not for a single arc. Therefore, these constraints must only be considered as valid inequalities to an already valid formulation, such as DL. In fact, the DL inequalities also appear in the description obtained by PORTA which guarantee the correct information on the u
                                    
                                       i
                                     variables for single arcs.

We can also give some intuition on how to obtain inequality (3.1) using the ones obtained from the two node analysis presented in the previous section. We start by adding two DL constraints for the pairs (i, j) and (j, k) leading to,
                              
                                 (3.2)
                                 
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    (
                                    n
                                    -
                                    1
                                    )
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          ij
                                       
                                    
                                    +
                                    
                                       
                                          x
                                       
                                       
                                          jk
                                       
                                    
                                    )
                                    +
                                    (
                                    n
                                    -
                                    3
                                    )
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          kj
                                       
                                    
                                    +
                                    
                                       
                                          x
                                       
                                       
                                          ji
                                       
                                    
                                    )
                                    ⩽
                                    2
                                    n
                                    -
                                    4
                                    .
                                 
                              
                           
                        

Now, consider the lifting of inequality (3.2) by inclusion of the term α
                           
                              ik
                           
                           x
                           
                              ik
                           , as a result of which we obtain α
                           
                              ik
                           
                           =
                           n as a valid lifting coefficient for x
                           
                              ik
                           . Next, we consider the inclusion of the term α
                           
                              ki
                           
                           x
                           
                              ki
                            to the lifted version of inequality (3.2). Again, one can easily compute α
                           
                              ki
                           
                           =
                           n
                           −4 as a valid lifting coefficient for x
                           
                              ik
                           . Note that this procedure gives an alternate proof of the validity of (3.2). The proof that the lifting coefficient are correct is omitted, but a sketch follows setting x
                           
                              ki
                           
                           =1 and calculating the maximum value for α
                           
                              ik
                            for all possible cases. We note, however, that when producing these constraints by the described procedure, the lifting sequence is not unique and that different sequences would result in different constraints. The reason why we mention this alternative derivation here is that it might suggest how to derive “similar” inequalities for larger subsets.

We now show that (3.1) are facets of 
                              
                                 
                                    
                                       P
                                    
                                    
                                       DL
                                    
                                    
                                       3
                                    
                                 
                              
                           .
                              Proposition 4
                              
                                 Let F
                                 
                                    3DL
                                  
                                 denote a face of 
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             DL
                                          
                                          
                                             3
                                          
                                       
                                    
                                  
                                 shown as 
                                 
                                    
                                       {
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             jk
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             kj
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             ji
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             ik
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             ki
                                          
                                       
                                       )
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             DL
                                          
                                          
                                             3
                                          
                                       
                                       :
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             u
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       (
                                       n
                                       -
                                       1
                                       )
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                          
                                       
                                       +
                                       
                                          
                                             x
                                          
                                          
                                             jk
                                          
                                       
                                       )
                                       +
                                       (
                                       n
                                       -
                                       3
                                       )
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             kj
                                          
                                       
                                       +
                                       
                                          
                                             x
                                          
                                          
                                             ji
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             nx
                                          
                                          
                                             ik
                                          
                                       
                                       +
                                       (
                                       n
                                       -
                                       4
                                       )
                                       
                                          
                                             x
                                          
                                          
                                             ki
                                          
                                       
                                       =
                                       2
                                       n
                                       -
                                       4
                                       }
                                    
                                 
                                 . Then, F
                                 
                                    3DL
                                  
                                 is a facet of 
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             DL
                                          
                                          
                                             3
                                          
                                       
                                    
                                  
                                 for n
                                 ⩾
                                 6.
                              

We first observe that F
                                 3DL
                                  is a face of 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             DL
                                          
                                          
                                             3
                                          
                                       
                                    
                                  using the result of Proposition 3, which also provides three points satisfying F
                                 3DL
                                  with equality. It is easy to see that 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             DL
                                          
                                          
                                             3
                                          
                                       
                                    
                                  is full-dimensional by considering any point with x
                                 
                                    ab
                                 
                                 =
                                 x
                                 
                                    bc
                                 
                                 =
                                 x
                                 
                                    ca
                                 
                                 =
                                 x
                                 
                                    ba
                                 
                                 =
                                 x
                                 
                                    cb
                                 
                                 =
                                 x
                                 
                                    ac
                                 
                                 =
                                 ∊ for small enough ∊
                                 >0 and with u
                                 
                                    a
                                 , u
                                 
                                    b
                                 , u
                                 
                                    c
                                 
                                 >0 satisfying ∣u
                                 
                                    b
                                 
                                 −
                                 u
                                 
                                    a
                                 ∣<
                                 n
                                 −2 for all a, b, c
                                 ∈{i, j, k}. Therefore, 
                                    
                                       dim
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      DL
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       =
                                       8
                                    
                                  and dim (F
                                 3DL
                                 )⩽7. Consider, now the following set of points induced by all possible two-cycles 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                    
                                  on 
                                    
                                       S
                                       =
                                       {
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                       }
                                    
                                 , i.e., 
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             a
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             b
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             jk
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             kj
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             ji
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             ik
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             ki
                                          
                                       
                                       )
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             DL
                                          
                                          
                                             3
                                          
                                       
                                    
                                  such that, if x
                                 
                                    ab
                                 
                                 =1 for 
                                    
                                       a
                                       ,
                                       b
                                       ,
                                       c
                                       ∈
                                       S
                                    
                                  then u
                                 
                                    b
                                 
                                 =
                                 u
                                 
                                    a
                                 
                                 +1 and if x
                                 
                                    ab
                                 
                                 +
                                 x
                                 
                                    bc
                                 
                                 =2 then u
                                 
                                    c
                                 
                                 =
                                 u
                                 
                                    a
                                 
                                 +2. It is easy to see that there are six of these points corresponding to the six two-cycles on S. Consider, now, the two points induced by x
                                 
                                    ij
                                 
                                 =1 or x
                                 
                                    jk
                                 
                                 =0 with all other x
                                 
                                    ab
                                 
                                 =0 for a, b
                                 ∈
                                 S. The former implies u
                                 
                                    i
                                 
                                 ⩽
                                 n
                                 −3 as node i cannot be the last node in a route and induces the point (n
                                 −3, 0, 1, 0, 0, 0, 0, 0). The latter implies u
                                 
                                    k
                                 
                                 ⩾1 as node k cannot be the first node on a route and induces the point (n
                                 −2, 1, 0, 1, 0, 0, 0, 0). It is easy to prove that the eight points just defined are affinely independent (see Lemma A.1 for a full description of these points and its proof in Appendix A). Hence dim (F
                                 3DL
                                 )⩾7, which implies dim (F
                                 3DL
                                 )=7, and the proof follows. □

The constraints we will now present, also taken from the list generated by PORTA, are somewhat more radical in that they include all the three variables u
                           
                              i
                           , u
                           
                              j
                           , and u
                           
                              k
                           , which is not usual and is in contrast to most MTZ-based constraints which only include two.
                              Proposition 5
                              
                                 The following set of constraints are valid constraints for the polyhedron 
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             DL
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 :
                                 
                                    
                                       (3.3)
                                       
                                          2
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                          -
                                          
                                             
                                                u
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          (
                                          2
                                          n
                                          -
                                          2
                                          )
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                ij
                                             
                                          
                                          +
                                          
                                             
                                                x
                                             
                                             
                                                ik
                                             
                                          
                                          )
                                          +
                                          (
                                          2
                                          n
                                          -
                                          8
                                          )
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                ji
                                             
                                          
                                          +
                                          
                                             
                                                x
                                             
                                             
                                                ki
                                             
                                          
                                          )
                                          +
                                          (
                                          2
                                          n
                                          -
                                          5
                                          )
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                jk
                                             
                                          
                                          +
                                          
                                             
                                                x
                                             
                                             
                                                kj
                                             
                                          
                                          )
                                          ⩽
                                          4
                                          n
                                          -
                                          10
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       (3.4)
                                       
                                          -
                                          2
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          (
                                          2
                                          n
                                          -
                                          8
                                          )
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                ij
                                             
                                          
                                          +
                                          
                                             
                                                x
                                             
                                             
                                                ik
                                             
                                          
                                          )
                                          +
                                          (
                                          2
                                          n
                                          -
                                          2
                                          )
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                ji
                                             
                                          
                                          +
                                          
                                             
                                                x
                                             
                                             
                                                ki
                                             
                                          
                                          )
                                          +
                                          (
                                          2
                                          n
                                          -
                                          5
                                          )
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                jk
                                             
                                          
                                          +
                                          
                                             
                                                x
                                             
                                             
                                                kj
                                             
                                          
                                          )
                                          ⩽
                                          4
                                          n
                                          -
                                          10
                                          .
                                       
                                    
                                 
                              

To prove the validity of constraint (3.3) we consider the three maximal cases stated below associated with all the possible traversal of 3-node paths:
                                    
                                       1.
                                       
                                          x
                                          
                                             ij
                                          
                                          =
                                          x
                                          
                                             jk
                                          
                                          =1 or x
                                          
                                             ik
                                          
                                          =
                                          x
                                          
                                             kj
                                          
                                          =1: In this case, the right hand side of constraint (3.3) becomes −3. Since u
                                          
                                             j
                                          
                                          +
                                          u
                                          
                                             k
                                          
                                          =2u
                                          
                                             i
                                          
                                          +3, 2u
                                          
                                             i
                                          
                                          −
                                          u
                                          
                                             j
                                          
                                          −
                                          u
                                          
                                             k
                                          
                                          =−3⩽−3 which is valid.


                                          x
                                          
                                             ji
                                          
                                          =
                                          x
                                          
                                             ik
                                          
                                          =1 or x
                                          
                                             ki
                                          
                                          =
                                          x
                                          
                                             ij
                                          
                                          =1: In this case, the right hand side of constraint (3.3) becomes 0. Since u
                                          
                                             j
                                          
                                          +
                                          u
                                          
                                             k
                                          
                                          =2u
                                          
                                             i
                                          , 2u
                                          
                                             i
                                          
                                          −
                                          u
                                          
                                             j
                                          
                                          −
                                          u
                                          
                                             k
                                          
                                          =0⩽0 which is valid.


                                          x
                                          
                                             jk
                                          
                                          =
                                          x
                                          
                                             ki
                                          
                                          =1 or x
                                          
                                             kj
                                          
                                          =
                                          x
                                          
                                             ji
                                          
                                          =1: In this case, the right hand side of constraint (3.3) becomes 3. Since u
                                          
                                             j
                                          
                                          +
                                          u
                                          
                                             k
                                          
                                          =2u
                                          
                                             i
                                          
                                          −3, 2u
                                          
                                             i
                                          
                                          −
                                          u
                                          
                                             j
                                          
                                          −
                                          u
                                          
                                             k
                                          
                                          =3⩽3 which is valid.

Note that two node paths with only one variable equal to 1 are trivially satisfied by constraint (3.3). This proves the validity of constraint (3.3). The validity of constraint (3.4) can be proved in a similar manner.□

The support graph of these constraints is slightly different as compared to the previous one and is as shown in Fig. 2
                           .

Again, we observe that these inequalities are also valid for the ATSP polyhedron. This follows from the previously stated result. One can easily see that by adding up (3.3) for the triple (i, j, k) to (3.4) for the same triple gives the CLIQUE constraints for the set ∣S∣=3. Thus, these constraints may also be considered as a generalization of the DL inequalities, although in a more radical way. However, unlike constraints (3.1), a lifting procedure that will result in constraints (3.3) is far from obvious.

Similar to what happens with constraints (3.1), the new constraints (3.3) and (3.4) alone in place of (1.4) do not provide a valid model for the ATSP. The set of constraints presented in the next subsection, however, do.

A different class of inequalities obtained from the listing provided by PORTA is presented below.
                              Proposition 6
                              
                                 The following set of constraints, named 2PATH constraints, are valid constraints for the polyhedron 
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             DL
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 :
                                 
                                    
                                       (3.5)
                                       
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                u
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          (
                                          2
                                          n
                                          -
                                          3
                                          )
                                          
                                             
                                                x
                                             
                                             
                                                ik
                                             
                                          
                                          +
                                          (
                                          n
                                          -
                                          4
                                          )
                                          
                                             
                                                x
                                             
                                             
                                                ki
                                             
                                          
                                          +
                                          (
                                          n
                                          -
                                          1
                                          )
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                ij
                                             
                                          
                                          +
                                          
                                             
                                                x
                                             
                                             
                                                jk
                                             
                                          
                                          )
                                          ⩽
                                          2
                                          n
                                          -
                                          4
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       (3.6)
                                       
                                          
                                             
                                                u
                                             
                                             
                                                k
                                             
                                          
                                          -
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          (
                                          2
                                          n
                                          -
                                          7
                                          )
                                          
                                             
                                                x
                                             
                                             
                                                ik
                                             
                                          
                                          +
                                          (
                                          n
                                          -
                                          1
                                          )
                                          
                                             
                                                x
                                             
                                             
                                                ki
                                             
                                          
                                          +
                                          (
                                          n
                                          -
                                          4
                                          )
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                ij
                                             
                                          
                                          +
                                          
                                             
                                                x
                                             
                                             
                                                jk
                                             
                                          
                                          )
                                          ⩽
                                          2
                                          n
                                          -
                                          6
                                          .
                                       
                                    
                                 
                              

We only show the validity of (3.5). The proof for (3.6) is similar. For constraints (3.5) we consider the three maximal mutually exclusive cases:
                                    
                                       1.
                                       
                                          x
                                          
                                             ik
                                          
                                          =1 and x
                                          
                                             ki
                                          
                                          =
                                          x
                                          
                                             ij
                                          
                                          =
                                          x
                                          
                                             jk
                                          
                                          =0 implies u
                                          
                                             i
                                          
                                          −
                                          u
                                          
                                             k
                                          
                                          ⩽−1 which is valid.


                                          x
                                          
                                             ij
                                          
                                          =
                                          x
                                          
                                             jk
                                          
                                          =1 and x
                                          
                                             ik
                                          
                                          =
                                          x
                                          
                                             ki
                                          
                                          =0 implies u
                                          
                                             i
                                          
                                          −
                                          u
                                          
                                             k
                                          
                                          ⩽−2 which is valid.


                                          x
                                          
                                             ki
                                          
                                          =
                                          x
                                          
                                             ij
                                          
                                          =1, x
                                          
                                             jk
                                          
                                          =
                                          x
                                          
                                             ik
                                          
                                          =0 or x
                                          
                                             ki
                                          
                                          =
                                          x
                                          
                                             jk
                                          
                                          =1, x
                                          
                                             jk
                                          
                                          =
                                          x
                                          
                                             ik
                                          
                                          =0 both imply u
                                          
                                             i
                                          
                                          −
                                          u
                                          
                                             k
                                          
                                          ⩽1 which is valid. □

A few interesting remarks on these inequalities are given next:
                              
                                 •
                                 As before, these inequalities are also valid for the ATSP polyhedron.

Constraints (3.5) and (3.6) imply a lifted version of the circuit inequalities (1.8) that are not implied by the CLIQUE inequalities (1.7). As mentioned before, the CLIQUE inequalities (1.7) can be seen as lifted versions of (1.8). However, as pointed out by Grötschel and Padberg (1985) and Fischetti (1991), sequential lifting can be used to obtain “asymmetric” lifted versions of the CIRCUIT inequalities (1.8). For sets of three nodes, there is only one such inequality given by 2x
                                    
                                       ik
                                    
                                    +
                                    x
                                    
                                       ij
                                    
                                    +
                                    x
                                    
                                       jk
                                    
                                    +
                                    x
                                    
                                       ki
                                    
                                    ⩽2 which results from lifting the circuit inequality x
                                    
                                       ij
                                    
                                    +
                                    x
                                    
                                       jk
                                    
                                    +
                                    x
                                    
                                       ki
                                    
                                    ⩽2. In fact by adding (3.5) and (3.6) for {i, j, k}, we obtain the lifted CIRCUIT inequalities (1.8) as described above for these three nodes. Support graphs of lifted CIRCUIT and the 2PATH inequalities for three nodes are given in Figs. 3 and 4
                                    
                                    , respectively.

Constraints (3.5) can be obtained by adding two MTZ constraints of (2.7) for an arc pair (i, j) and (j, k) and lifting with x
                                    
                                       ik
                                     and x
                                    
                                       ki
                                     in the given order. A similar observation holds for the second set of constraints. We can view them as generalizations of the DL inequalities in the sense they provide the right information on the u variables not only for two consecutive arcs, as with constraints (3.1), but, at the same time, also on a single arc, which constraints (3.1) alone do not guarantee. In other words, for a solution with x
                                    
                                       ij
                                    
                                    =
                                    x
                                    
                                       jk
                                    
                                    =1 (x
                                    
                                       ik
                                    
                                    =
                                    x
                                    
                                       ki
                                    
                                    =0), the same constraints imply u
                                    
                                       k
                                    
                                    =
                                    u
                                    
                                       i
                                    
                                    +2. Similarly, for a solution with x
                                    
                                       ik
                                    
                                    =1 (x
                                    
                                       ki
                                    
                                    =
                                    x
                                    
                                       ij
                                    
                                    =
                                    x
                                    
                                       jk
                                    
                                    =0), constraints (3.5) and (3.6) imply u
                                    
                                       k
                                    
                                    =
                                    u
                                    
                                       i
                                    
                                    +1. Furthermore, considering only the x
                                    
                                       ik
                                     term on the left-hand side of (3.5) one obtains a MTZ like constraint (1.9) albeit with weaker coefficients 2n
                                    −3 and 2n
                                    −4 as opposed to n
                                    −1 and n
                                    −2, but which still guarantee u
                                    
                                       k
                                    
                                    ⩾
                                    u
                                    
                                       i
                                    
                                    +1 when arc (i, k) appears in the solution. Thus, subtours are prevented and we may conclude that these constraints, when used in place of (1.4) in the generic model ATSP, result in a valid model for the ATSP.

For a subset of three nodes {i, j, k}, constraints (3.5) provide the same information as constraints (1.14) proposed by Sherali and Driscoll (2002). This is easy to see by checking the three maximal mutually exclusive cases shown in the proof of Proposition 6 in constraints (1.14). However, constraints (3.5) represent this information as a linear set of inequalities whereas constraints (1.14) are quadratic.

We conclude this section by referring to a similar analysis of a polyhedron on three nodes with a “⩽” relationship between the u variables. This analysis, together with the provided analysis for the “=” polyhedron, yields the following observations: (i) the new inequalities described in this section are not valid for the “⩽” polyhedron, which is easy to see since these inequalities are derived from the assumptions that equalities between the u
                           
                              i
                            variables hold and (ii) the “⩽” polyhedron has, in place of the new inequalities, CLIQUE constraints and lifted CIRCUIT inequalities for three nodes (which are only defined in the x
                           
                              ij
                            subspace). Note that this phenomenon is exactly the same as the one observed in the two node set polyhedral analysis presented in Section 2. However, this does not extend itself in an analysis for four nodes, as discussed in the following section.

The polyhedral approach for three node sets is worth using but is already complicated since it needs an exhaustive and a tedious analysis of a long list of inequalities even for small values of n. A similar polyhedral approach for four node sets proved to be rather impractical due to the number of points needed to be generated in order to be able to use PORTA to generate the full description of the corresponding polytope. Despite this difficulty, we were able to produce a complete list of inequalities with four node sets and “=” conditions for n
                        =4. Such a list contains just over 25,500 inequalities and an exhaustive search of the inequalities in it would prove to be quite complicated in order to find generalizations of the inequalities (3.1), (3.5) and (3.6). Unfortunately or fortunately (depending on the point of view), and remarkably at the same time, the list contained the easier to find CLIQUE constraints and the whole set of lifted CIRCUIT inequalities for four nodes in the x
                        
                           ij
                         subspace. This is remarkable because when the analysis is extended from two or three node sets for bigger sets, there is not a similar behavior to what was observed in the previous section. CLIQUE constraints for two or three nodes sets were obtained in the “⩽” polyhedra. The corresponding analysis for the “=” polyhedra provides more information and produces the MTZ-based inequalities described previously in this paper that imply these small CLIQUE constraints. For four node subsets, the “=” analysis for n
                        =4 already includes the corresponding CLIQUE inequalities and, as we shall show next, CLIQUE constraints for four nodes turn out to be facets of the corresponding equality polyhedron for any value of n. To see this, consider the following polyhedron 
                           
                              
                                 
                                    P
                                 
                                 
                                    DL
                                 
                                 
                                    4
                                 
                              
                           
                         on the node set S
                        ={i, j, k, l}, defined by the convex hull of the set of points satisfying the conditions below:
                           
                              •
                              
                                 x({t}: S⧹{t})⩽1, for t
                                 ∈
                                 S,


                                 x(S⧹{t}:{t})⩽1, for t
                                 ∈
                                 S,

for all a
                                 ≠
                                 b
                                 ≠
                                 c
                                 ≠
                                 d
                                 ∈{i, j, k}, if x
                                 
                                    ab
                                 
                                 +
                                 x
                                 
                                    bc
                                 
                                 +
                                 x
                                 
                                    cd
                                 
                                 =3 then u
                                 
                                    d
                                 
                                 =
                                 u
                                 
                                    a
                                 
                                 +3, u
                                 
                                    c
                                 
                                 =
                                 u
                                 
                                    a
                                 
                                 +2 and u
                                 
                                    b
                                 
                                 =
                                 u
                                 
                                    a
                                 
                                 +1, otherwise ∣u
                                 
                                    d
                                 
                                 −
                                 u
                                 
                                    a
                                 ∣⩽
                                 n
                                 −2,

for all a
                                 ≠
                                 b
                                 ≠
                                 c
                                 ∈{i, j, k}, if x
                                 
                                    ab
                                 
                                 +
                                 x
                                 
                                    bc
                                 
                                 =2 then u
                                 
                                    c
                                 
                                 =
                                 u
                                 
                                    a
                                 
                                 +2 and u
                                 
                                    b
                                 
                                 =
                                 u
                                 
                                    a
                                 
                                 +1, otherwise ∣u
                                 
                                    c
                                 
                                 −
                                 u
                                 
                                    a
                                 ∣⩽
                                 n
                                 −2,

for all a
                                 ≠
                                 b
                                 ∈{i, j, k}, if x
                                 
                                    ab
                                 
                                 =1 then u
                                 
                                    b
                                 
                                 =
                                 u
                                 
                                    a
                                 
                                 +1, otherwise ∣u
                                 
                                    b
                                 
                                 −
                                 u
                                 
                                    a
                                 ∣⩽
                                 n
                                 −2.

We now show how CLIQUE inequalities (1.7) written for four nodes are related to 
                           
                              
                                 
                                    P
                                 
                                 
                                    DL
                                 
                                 
                                    4
                                 
                              
                           
                        .
                           Proposition 7
                           
                              Let (u, x) denote a point in 
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          DL
                                       
                                       
                                          4
                                       
                                    
                                 
                               
                              and F
                              
                                 4CLIQUE
                               
                              be a face of 
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          DL
                                       
                                       
                                          4
                                       
                                    
                                 
                               
                              shown as 
                              
                                 
                                    
                                       
                                          
                                             (
                                             u
                                             ,
                                             x
                                             )
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   DL
                                                
                                                
                                                   4
                                                
                                             
                                             :
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   ij
                                                
                                             
                                             =
                                             |
                                             S
                                             |
                                             -
                                             1
                                          
                                       
                                    
                                 
                               
                              for S
                              
                              =
                              {i, j, k, l}. Then, F
                              
                                 4CLIQUE
                               
                              is a facet of 
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          DL
                                       
                                       
                                          4
                                       
                                    
                                 
                               
                              for n
                              ⩾
                              5.
                           

We first note that 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          DL
                                       
                                       
                                          4
                                       
                                    
                                 
                               is full-dimensional therefore 
                                 
                                    dim
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   DL
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                    
                                    =
                                    16
                                 
                              , hence and dim (F
                              4CLIQUE
                              )⩽15. Consider the fully connected graph K
                              4 on S and let 
                                 
                                    P
                                    =
                                    {
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          24
                                       
                                    
                                    }
                                 
                               bet the set of all directed simple paths of length three on K
                              4, where each path is characterized by a sequence of four nodes {a, b, c, d}. We will denote the generalized incidence vector 
                                 
                                    (
                                    
                                       
                                          χ
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                4
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          υ
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                4
                                             
                                          
                                       
                                    
                                    )
                                 
                               induced by path P
                              
                                 i
                              , i
                              =1,…,24, where 
                                 
                                    
                                       
                                          χ
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    (
                                    {
                                    a
                                    ,
                                    b
                                    }
                                    )
                                    =
                                    1
                                 
                               for any edge {a, b}∈
                              P
                              
                                 i
                               and 
                                 
                                    
                                       
                                          υ
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          a
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          b
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          c
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    =
                                    (
                                    u
                                    ,
                                    u
                                    +
                                    1
                                    ,
                                    u
                                    +
                                    2
                                    ,
                                    u
                                    +
                                    3
                                    )
                                 
                               for 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    P
                                 
                               and u
                              ⩽
                              n
                              −5. A full characterization of the matrix A of the set of these 24 points is given in Appendix B. It can be verified through any numerical package (e.g., Matlab) that rank (A)=15, which shows the existence of 15 linearly independent points satisfying F
                              4CLIQUE
                               at equality, hence dim (F
                              4CLIQUE
                              )⩾15 and the proof follows. □

The result of Proposition 4 does not mean that several generalized DL-like inequalities cannot be obtained for larger sets of four nodes or more. In fact, the reason why we have provided ways of obtaining constraints (3.1) and (3.5) based on adding smaller inequalities and then use lifting is so that similar ideas can be applied to bigger sets. What Proposition 4 does imply, however, is that one will not be able to obtain inequalities for larger sets that would, at the same time, imply inequalities (1.7) for ∣S∣=4. At this time we conjecture that the same applies for larger sets and in fact, our new inequalities (3.1), (3.5) and (3.6) and the corresponding projection result could be considered as an exception and not the rule.

In this section we give a framework for obtaining all the interesting projected inequalities in the space of the x
                     
                        ij
                      variables from the linear programming feasible set of many of the MTZ-like models described before. In order for our framework to be valid, all the MTZ inequalities in these models must be of the form u
                     
                        i
                     
                     +
                     Exp(X)⩽
                     u
                     
                        j
                      where Exp(X) is an expression involving some x
                     
                        ij
                      variables and possibly a constant. Note that for a given pair (i, j) there may be more than one such inequality, e.g., the model with 2PATH inequalities includes several such constraints.

For the purpose of describing the framework we also define a multigraph 
                        
                           MG
                           =
                           (
                           V
                           ,
                           A
                           )
                        
                      where 
                        
                           V
                        
                      corresponds to the node set of the original graph and A is built as follows: Any inequality of the form u
                     
                        i
                     
                     +
                     Exp(X)⩽
                     u
                     
                        j
                      gives rise to an arc (i, j). This is the reason that such a construction may lead to a multigraph.

Now we claim that for a model under these conditions, all interesting projected inequalities are obtained by adding the inequalities associated to the arcs defining an elementary circuit in MG.

We give some examples starting from the simplest model:
                        
                           •
                           Consider the MTZ inequalities (1.9). In this case the projected inequalities are of the following form,
                                 
                                    (4.1)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                C
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                          
                                       
                                       ⩽
                                       |
                                       C
                                       |
                                       -
                                       
                                          
                                             |
                                             C
                                             |
                                          
                                          
                                             n
                                             -
                                             1
                                          
                                       
                                       
                                       ∀
                                       C
                                       ∈
                                       
                                          
                                             G
                                          
                                          
                                             
                                                
                                                   V
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

Consider the DL inequalities (1.13). We obtain the 2-CLIQUE constraints x
                              
                                 ij
                              
                              +
                              x
                              
                                 ji
                              
                              ⩽1 when we consider 2-circuits in the corresponding multigraph MG and the following more general set of inequalities,
                                 
                                    (4.2)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                C
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                      -
                                                      3
                                                   
                                                   
                                                      n
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                          
                                       
                                       ⩽
                                       |
                                       C
                                       |
                                       -
                                       
                                          
                                             |
                                             C
                                             |
                                          
                                          
                                             n
                                             -
                                             1
                                          
                                       
                                       
                                       ∀
                                       C
                                       ∈
                                       
                                          
                                             G
                                          
                                          
                                             
                                                
                                                   V
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              obtained by considering k-circuits in MG with k
                              >2, where 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          R
                                       
                                    
                                 
                               denotes the reversed circuit in which arc 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    
                                       
                                          C
                                       
                                       
                                          R
                                       
                                    
                                 
                               if and only if 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    C
                                 
                              .

In the previous two cases, the associated MG is a simple graph since we only have a single inequality for each pair (i, j). Next, we consider more complicated cases.
                        
                           •
                           Consider one of the 2PATH inequalities, namely (3.5). For this case, we have a multigraph since for each pair (i, k) there are n
                              −3 different inequalities obtained by choosing a different middle node from 
                                 
                                    j
                                    ∈
                                    V
                                    ⧹
                                    {
                                    i
                                    ,
                                    k
                                    }
                                 
                              . Thus two different k-circuits in the multigraph MG for the same value of k lead to different inequalities. Consider the case k
                              =2; here it is important to distinguish the case where the two inequalities generated from a given pair (i, k) and (k, i) have the same middle node, leading to the following inequalities for triples {i, j, k},
                                 
                                    (4.3)
                                    
                                       (
                                       3
                                       n
                                       -
                                       7
                                       )
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             ik
                                          
                                       
                                       +
                                       
                                          
                                             x
                                          
                                          
                                             ki
                                          
                                       
                                       )
                                       +
                                       (
                                       n
                                       -
                                       1
                                       )
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                          
                                       
                                       +
                                       
                                          
                                             x
                                          
                                          
                                             jk
                                          
                                       
                                       +
                                       
                                          
                                             x
                                          
                                          
                                             kj
                                          
                                       
                                       +
                                       
                                          
                                             x
                                          
                                          
                                             ji
                                          
                                       
                                       )
                                       ⩽
                                       4
                                       n
                                       -
                                       8
                                       ,
                                    
                                 
                              or having a different middle node, leading to the following different inequalities for 4-tuples {i, j, l, k}
                                 
                                    (4.4)
                                    
                                       (
                                       3
                                       n
                                       -
                                       7
                                       )
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             ik
                                          
                                       
                                       +
                                       
                                          
                                             x
                                          
                                          
                                             ki
                                          
                                       
                                       )
                                       +
                                       (
                                       n
                                       -
                                       1
                                       )
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                          
                                       
                                       +
                                       
                                          
                                             x
                                          
                                          
                                             jk
                                          
                                       
                                       +
                                       
                                          
                                             x
                                          
                                          
                                             kl
                                          
                                       
                                       +
                                       
                                          
                                             x
                                          
                                          
                                             li
                                          
                                       
                                       )
                                       ⩽
                                       4
                                       n
                                       -
                                       8
                                       .
                                    
                                 
                              The case with k
                              =3 leads to several inequalities. The following example in Fig. 5
                               shows an elementary circuit defined on three nodes {i, j, k} on a multigraph MG. Fig. 6
                               shows all possible “mappings” of this elementary circuit on the original graph 
                                 
                                    G
                                 
                               where the middle nodes of inequalities (3.5) are chosen from the set {a, b}. The general expression for the projected inequalities in the 2PATH model is given by
                                 
                                    (4.5)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                i
                                                ,
                                                k
                                                )
                                                ∈
                                                C
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ik
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                      -
                                                      4
                                                   
                                                   
                                                      2
                                                      n
                                                      -
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                i
                                                ,
                                                k
                                                )
                                                ∈
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ik
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                      -
                                                      1
                                                   
                                                   
                                                      2
                                                      n
                                                      -
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                i
                                                ,
                                                k
                                                )
                                                ∈
                                                C
                                             
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             
                                                
                                                   iv
                                                
                                                
                                                   ik
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             x
                                          
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   ik
                                                
                                             
                                             k
                                          
                                       
                                       )
                                       ⩽
                                       |
                                       C
                                       |
                                       -
                                       
                                          
                                             |
                                             C
                                             |
                                          
                                          
                                             2
                                             n
                                             -
                                             3
                                          
                                       
                                       ,
                                    
                                 
                              where 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ik
                                       
                                    
                                    ∈
                                    V
                                    ⧹
                                    {
                                    i
                                    ,
                                    k
                                    }
                                 
                               for each 
                                 
                                    (
                                    i
                                    ,
                                    k
                                    )
                                    ∈
                                    C
                                 
                              .

One particular case of the inequalities (4.5) is
                                 
                                    (4.6)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                i
                                                ,
                                                k
                                                )
                                                ∈
                                                C
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ik
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      3
                                                      n
                                                      -
                                                      6
                                                   
                                                   
                                                      2
                                                      n
                                                      -
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                i
                                                ,
                                                k
                                                )
                                                ∈
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ik
                                          
                                       
                                       ⩽
                                       |
                                       C
                                       |
                                       -
                                       
                                          
                                             |
                                             C
                                             |
                                          
                                          
                                             2
                                             n
                                             -
                                             3
                                          
                                       
                                       .
                                    
                                 
                              Inequalities (4.6) can be obtained from the previous set (4.5) by considering a circuit 
                                 
                                    C
                                 
                               where for each 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    C
                                 
                              , the middle node 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ij
                                       
                                    
                                    ∈
                                    V
                                    ⧹
                                    {
                                    i
                                    ,
                                    k
                                    }
                                 
                               is identical, e.g., a unique node j.
                                 
                                    (4.7)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                i
                                                ,
                                                k
                                                )
                                                ∈
                                                C
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ik
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                      -
                                                      4
                                                   
                                                   
                                                      2
                                                      n
                                                      -
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                i
                                                ,
                                                k
                                                )
                                                ∈
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ik
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                      -
                                                      1
                                                   
                                                   
                                                      2
                                                      n
                                                      -
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                i
                                                ,
                                                k
                                                )
                                                ∈
                                                C
                                             
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             
                                                
                                                   iv
                                                
                                                
                                                   ik
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             x
                                          
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   ik
                                                
                                             
                                             k
                                          
                                       
                                       )
                                       ⩽
                                       |
                                       C
                                       |
                                       -
                                       
                                          
                                             |
                                             C
                                             |
                                          
                                          
                                             2
                                             n
                                             -
                                             3
                                          
                                       
                                       ,
                                    
                                 
                              which, after rearranging the terms, yields (4.6). Note that if we remove the second summation on the lefthand side of (4.6), we obtain a cycle breaking constraint similar to the cycle constraints (4.1) projected from the MTZ inequalities but with a weaker right-hand side. This gives an alternative proof that one of the 2PATH inequalities (3.5) in the place of (1.4) also yield a valid model for the ATSP (recall that an alternative and similar argument using the 2PATH inequalities directly was given in Section 3.1).

This process of obtaining projected inequalities can become more complicated, but would still be within the same framework, if we consider the second family of 2PATH inequalities (3.5) together with the inequalities (3.6) (in which case the multigraph MG has more parallel arcs) or if we consider other sets of unrelated inequalities such as the DL inequalities. For instance, in the corresponding multigraph MG, one inequality corresponding to a 2-circuit may be obtained by adding the DL inequality for (i, k) with a 2PATH inequality for (k, i) with node j in the middle. Another inequality corresponding to a 3-circuit can be obtained by adding the DL inequalities for the pairs (i, j) and (j, k) and a 2PATH inequality for the pair (k, i). Here depending on the middle node of the 2PATH inequality, a different inequality is obtained.

Other similar examples can be obtained with the CLIQUE inequalities for ∣S∣=3 alone or combined with the DL or the 2PATH inequalities. Adding to the models under study, inequalities defined in the x
                              
                                 ij
                               space do not alter the framework. For instance, if we include the assignment constraints in the original model, then these inequalities will also appear in the projected model (recall the projection characterization of MTZ given in Section 1).

Inequalities obtained in this circuit fashion are clearly implied by the given model and that non-elementary cycles lead to implied inequalities. The hard part is to prove “sufficiency”.

We will provide now a proof for this general case. Let us assume that the generic model 
                        
                           G
                        
                      contains Q
                     
                        ij
                      inequalities for each ordered pair i, j, as follows:
                        
                           (4.8)
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       (
                                       k
                                       ,
                                       l
                                       )
                                       ∈
                                       A
                                    
                                 
                              
                              
                                 
                                    α
                                 
                                 
                                    kl
                                 
                                 
                                    q
                                    ,
                                    ij
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    kl
                                 
                              
                              ⩽
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                              +
                              
                                 
                                    β
                                 
                                 
                                    q
                                    ,
                                    ij
                                 
                              
                              
                              ∀
                              i
                              ,
                              j
                              ,
                              q
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    Q
                                 
                                 
                                    ij
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 α
                              
                              
                                 kl
                              
                              
                                 q
                                 ,
                                 ij
                              
                           
                        
                      is the coefficient of variable x
                     
                        ij
                      in the qth constraint associated to the pair i, j and β
                     
                        q,ij
                      is the corresponding right-hand side. We assume that the constraints are ordered for each pair i, j. As noted for many of the cases described before, for a given index (q, ij), many of the coefficients are equal to zero.

Each of the projected inequalities is obtained by adding several of the previous inequalities in circuit fashion as explained above. Thus, a generic projected inequality is as follows:
                        
                           (4.9)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ∈
                                       C
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       (
                                       k
                                       ,
                                       l
                                       )
                                       ∈
                                       A
                                    
                                 
                              
                              
                                 
                                    α
                                 
                                 
                                    kl
                                 
                                 
                                    q
                                    ,
                                    ij
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    kl
                                 
                              
                              ⩽
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ∈
                                       C
                                    
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    q
                                    ,
                                    ij
                                 
                              
                              ,
                           
                        
                     where C is a cycle in the multigraph MG.
                        Proposition 8
                        
                           All the inequalities of the form 
                           (4.9) 
                           are sufficient to describe the projection of 
                           (4.8) 
                           into the space of the x
                           
                              ij
                            
                           variables.
                        

Consider any assignment of values A
                           
                              ij
                            to the variables x
                           
                              ij
                            satisfying all the inequalities following the generic form (4.9) as well as (1.6). One has to show that there exist variables u
                           
                              i
                           , i
                           =2,…,
                           n such that:
                              
                                 (4.10)
                                 
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    ⩽
                                    
                                       
                                          β
                                       
                                       
                                          q
                                          ,
                                          ij
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             k
                                             ,
                                             l
                                             )
                                             ∈
                                             A
                                          
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          kl
                                       
                                       
                                          q
                                          ,
                                          ij
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          kl
                                       
                                    
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ,
                                    q
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          Q
                                       
                                       
                                          ij
                                       
                                    
                                    .
                                 
                              
                           By assigning nonnegative dual variables 
                              
                                 
                                    
                                       v
                                    
                                    
                                       ij
                                    
                                    
                                       q
                                    
                                 
                              
                            to each constraint (4.10) Farkas lemma shows that the system (4.10) has a solution if and only if
                              
                                 (4.11)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ,
                                             j
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   Q
                                                
                                                
                                                   ij
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   q
                                                   ,
                                                   ij
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      (
                                                      k
                                                      ,
                                                      l
                                                      )
                                                      ∈
                                                      A
                                                   
                                                
                                             
                                             
                                                
                                                   α
                                                
                                                
                                                   kl
                                                
                                                
                                                   q
                                                   ,
                                                   ij
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   kl
                                                
                                             
                                          
                                       
                                    
                                    ⩾
                                    0
                                 
                              
                           for
                              
                                 (4.12)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   Q
                                                
                                                
                                                   ij
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          v
                                       
                                       
                                          ij
                                       
                                       
                                          q
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   Q
                                                
                                                
                                                   ij
                                                
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          v
                                       
                                       
                                          ji
                                       
                                       
                                          q
                                       
                                    
                                    =
                                    0
                                    
                                    ∀
                                    j
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (4.13)
                                 
                                    
                                    
                                       
                                          v
                                       
                                       
                                          ij
                                       
                                       
                                          q
                                       
                                    
                                    ⩾
                                    0
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ,
                                    q
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          Q
                                       
                                       
                                          ij
                                       
                                    
                                    .
                                 
                              
                           
                        

We observe that constraints (4.12) and (4.13) are those associated to a flow problem on the corresponding multigraph MG. Any feasible solution in this multigraph can be decomposed into elementary circuits in such a way that each arc of each circuit has the same value of flow V. Consider such a circuit 
                              
                                 C
                              
                            with cost (value) given by
                              
                                 (4.14)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ,
                                             j
                                             ∈
                                             C
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   q
                                                   ,
                                                   ij
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      (
                                                      k
                                                      ,
                                                      l
                                                      )
                                                      ∈
                                                      A
                                                   
                                                
                                             
                                             
                                                
                                                   α
                                                
                                                
                                                   kl
                                                
                                                
                                                   q
                                                   ,
                                                   ij
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   kl
                                                
                                             
                                          
                                       
                                    
                                    V
                                    .
                                 
                              
                           
                        

Since (4.13) implies that V is nonnegative and the inequality (4.9) associated to the same circuit implies that 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ,
                                       j
                                       ∈
                                       C
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                q
                                                ,
                                                ij
                                             
                                          
                                          -
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                k
                                                ,
                                                l
                                                )
                                                ∈
                                                A
                                             
                                          
                                          
                                             
                                                α
                                             
                                             
                                                kl
                                             
                                             
                                                q
                                                ,
                                                ij
                                             
                                          
                                          
                                             
                                                A
                                             
                                             
                                                kl
                                             
                                          
                                       
                                    
                                 
                              
                            is nonnegative, we con conclude that (4.14) is nonnegative for the same circuit. Thus the contribution of (4.14) to the left-hand side of (4.11) is nonnegative. Since this holds for any circuit obtained after decomposing any feasible solution of (4.12) and (4.13) we conclude that (4.11) always holds.

Now, since (4.11) holds for any solution satisfying (4.12) and (4.13) iff (4.9) holds for all cycles 
                              
                                 C
                              
                            and by Farkas lemma, (4.11) holds for any solution satisfying (4.11) and (4.11) iff the values A
                           
                              ij
                            satisfy the inequalities (4.10) we obtain the desired result.□

Although the main emphasis of this paper is a theoretical treatment of the MTZ constraints and to present ways in which they can (or cannot) be extended and generalized, we provide some computational results in this section to assess the strength of the LP relaxation of the new constraints and to compare their use with the use of corresponding projected inequalities. Besides the TSP, we also provide a set of similar experiments with the precedence-constrained TSP (PCTSP) (see, e.g., Sherali & Driscoll, 2002 for a description). The reason for this choice is that the PCTSP is easily modeled with the new set of variables, and permits us to evaluate the behaviour of the new inequalities in a different setting.

We emphasize that our aim behind the computational experiments is not to show the superiority of the new constraints or to use them in solving the TSP or the PCTSP to optimality (for which there exists a wide range of specialized methods), but rather to support and numerically confirm the theoretical findings. The following sections present the results obtained on the TSP and the PCTSP, respectively.

The first set of experiments aims to computationally test the difference between 
                           
                              
                                 
                                    P
                                 
                                 
                                    MTZ
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    DL
                                 
                                 
                                    2
                                 
                              
                           
                        . The tests are conducted on a number of asymmetric TSPLIB (1997) instances with the number of nodes ranging from 34 to 171. The LP relaxations are solved using CPLEX 12 using a computing cluster with 2.4gigahertz and 64gigabytes RAM (single core). The first set of results are presented in Table 1
                         in which two formulations are compared: (i) ATSP using constraints (1.9) coupled with two node CLIQUE constraints in place of constraints (1.4), denoted by F(MTZ+2CLQ) and (ii) formulation ATSP using constraints (1.13) instead of (1.4), denoted F(DL). The first two columns of this table show the instances tested and the number n of nodes contained in each. The remaining columns show the % improvement in LP relaxation each constraint brings over formulation ATSP using MTZ constraints alone. In particular, the improvement is calculated as 
                           
                              100
                              
                                 
                                    v
                                    (
                                    F
                                    
                                       
                                          (
                                          MTZ
                                          +
                                          2
                                          CLQ
                                          )
                                       
                                       
                                          L
                                       
                                    
                                    )
                                    -
                                    v
                                    (
                                    F
                                    
                                       
                                          (
                                          MTZ
                                          )
                                       
                                       
                                          L
                                       
                                    
                                    )
                                 
                                 
                                    v
                                    (
                                    F
                                    
                                       
                                          (
                                          MTZ
                                          )
                                       
                                       
                                          L
                                       
                                    
                                    )
                                 
                              
                           
                         for formulation F(MTZ+2CLQ) and similarly for F(DL). For simplicity, the columns are titled with the names of the constraints rather than those of the full formulations. Computational times (in seconds) required to solve the corresponding LP relaxation to optimality is denoted T(·).

As seen in Table 1, the average improvement of the use of CLIQUE constraints for 
                           
                              |
                              S
                              |
                              =
                              2
                           
                         over the classical MTZ formulation is 4.73%, whereas the same value for the DL constraints is 4.74%. No major difference is seen with respect to computational times required by both formulations despite the fact that F(DL) uses one set of constraints (1.13) instead of two as in the model F(MTZ+2CLQ).

The second set of experiments aims to measure the strength of the LP relaxations with the new constraints as compared to the value of the optimal solution for the instances at hand. The results of these experiments are presented in Tables 2 and 3
                        
                        . The first two columns indicate, as before, the instance and the corresponding number of nodes. The following columns indicate the various constraints that formulation ATSP is supplemented with. Apart from the ones already mentioned in previous sections, 3CLQ denotes constraints (1.8) written for three nodes. NR (from non-radical) and R (from radical) denote the new sets of constraints (3.1) and (3.3), respectively. L3 denotes the lifted CIRCUIT inequalities written for three nodes and 2P is the short-hand notation for 2PATH inequalities (3.5) and (3.6). The figures reported in Table 2 shows the deviations of the LP relaxations from the optimal solution value. Table 3 shows the computational time (in seconds) required to solve the LP relaxations to optimality.

The results presented in Tables 2 and 3 have a number of interesting implications. First, DL inequalities supplemented with CLIQUE for three nodes is only slightly worse than DL supplemented with either (or both) of the new inequalities NR and R. From a theoretical perspective the bound cannot be better. Similarly, DL+2P brings some improvements over DL+L3, albeit with a slight increase in the computational time. In summary, however, the results indicate that only marginal improvements are obtained by using the MTZ-like constraints, when compared with corresponding projected constraints in the x
                        
                           ij
                         space. These results conveniently fit with the theoretical findings.

We have also conducted experiments with the SD formulation and to see the amount by which the new constraints are able to improve this formulation. In particular, the SD formulation is supplemented with 3CLQ, NR, R, 2P and L3. The resulting gaps from best known or optimal solutions are presented in Table 4
                        , and the associated computational time required to solve the LP relaxations to optimality are shown in Table 5
                        .

The results presented in Tables 4 and 5 can be interpreted from two different perspectives: (i) they show that by using the polyhedral approach discussed in the previous sections it is easy to derive MTZ-based inequalities that significantly improve the LP bounds of formulation SD or (ii) unfortunately they yield similar conclusions as with the previous set of experiments in that the improvements obtained by new MTZ-like inequalities can also be obtained using their projected versions. It is worth noting that there are cases where NR and R perform slightly better than 3CLQ, and 2P slightly better than L3, although this comes at the expense of more computational time.

Our theoretical findings explain the reasons behind case (ii). In particular, our efforts focused on studying the polyhedra associated with the MTZ as well as in the x
                        
                           ij
                         space, showed how MTZ inequalities imply the corresponding inequalities in the x space.

The PCTSP is an extension of the TSP in that, for certain pairs of nodes 
                           
                              i
                              ,
                              j
                              ∈
                              V
                           
                        , there is an additional restriction that node i should precede node j. Using MTZ-based constraints, this requirement can easily be incorporated into formulation ATSP by the constraint u
                        
                           j
                        
                        ⩾
                        u
                        
                           i
                        
                        +1 for every 
                           
                              i
                              ∈
                              V
                           
                         that should precede 
                           
                              j
                              ∈
                              V
                              ⧹
                              {
                              i
                              }
                           
                        . Tables 6 and 7
                        
                         show the results associated with the LP relaxations, in the same way as Tables 2 and 3. Not all the optimal solutions are available for the PCTSP, and for those instances we have compared the lower bounds with the best known upper bound that are available in the TSPLIB (1997).

The results presented for the PCTSP show that similar conclusions apply as in the previous section. In particular, the results confirm that improvements obtained by the generalized MTZ or DL constraints are marginally better than the improvements obtained by supplementing the two-node DL constraints with two or three node CLIQUE inequalities in the space of the x-variables only.

@&#CONCLUSIONS@&#

In this paper we have presented a systematic way of deriving inequalities that are more complicated than the MTZ and DL inequalities and that in a certain way “generalize” the underlying idea of the original inequalities. We described a polyhedral approach that studies and analyzes the convex hull of feasible sets for small dimensions and that allowed us to generate generalizations of the MTZ and DL inequalities, and which are “good” in the sense that they define facets of these small polyhedra. Our approach produced a generalization of these inequalities which imply CLIQUE constraints for three-node subsets. We also claim that generalizations of these inequalities implying CLIQUE inequalities for larger subsets are unlikely to exist. This claim follows the assertion that, had there been generalizations of these inequalities implying CLIQUE inequalities for four-nodes, then the CLIQUE inequalities themselves would not have been facet-defining for the corresponding polyhedron. This paper provides theoretical proofs that CLIQUE inequalities in fact define facets for the polyhedron defined on four nodes, which contradicts this assertion.

Some computational results indicate that only marginal improvements are obtained when using the new the MTZ-like constraints when compared with corresponding projected constraints in the x
                     
                        ij
                      space. These results could be regarded as a note of “warning” in the sense that any improvements on the MTZ constraints could also be obtained by using similar constraints in the x
                     
                        ij
                      space alone (if one knows which ones they are).

@&#ACKNOWLEDGEMENTS@&#

Thanks are due to three anonymous reviewers for their useful comments on the initial version of the paper. The work of the second author was supported by project PEst-OE/MAT/UI0152.


                     
                        Lemma A.1
                        
                           The following eight points 
                           u
                           
                              i
                           
                           , i
                           
                           =
                           
                           1,
                           …
                           ,
                           
                           8,
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ij
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   jk
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   kj
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ji
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ik
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ki
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            5
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            6
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            7
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      u
                                                   
                                                   
                                                      u
                                                   
                                                   
                                                      u
                                                   
                                                   
                                                      u
                                                   
                                                   
                                                      u
                                                   
                                                   
                                                      u
                                                   
                                                   
                                                      n
                                                      -
                                                      3
                                                   
                                                   
                                                      n
                                                      -
                                                      2
                                                   
                                                
                                                
                                                   
                                                   
                                                      u
                                                      +
                                                      2
                                                   
                                                   
                                                      u
                                                      +
                                                      1
                                                   
                                                   
                                                      u
                                                      -
                                                      1
                                                   
                                                   
                                                      u
                                                      +
                                                      1
                                                   
                                                   
                                                      u
                                                      -
                                                      1
                                                   
                                                   
                                                      u
                                                      -
                                                      2
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           are affinely independent for a given 
                           
                              
                                 u
                                 ∈
                                 
                                    
                                       Z
                                    
                                    
                                       +
                                    
                                 
                              
                            
                           such that 2 
                           ⩽
                           u
                           ⩽
                           n
                           −
                           4.
                        

Consider the following system of equations defined by the scalars λ
                           
                              i
                            and vectors u
                           
                              i
                           , i
                           =1,…,8:
                              
                                 (A.1)
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          8
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    0
                                    ,
                                 
                              
                           
                           
                              
                                 (A.2)
                                 
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          4
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          5
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          6
                                       
                                    
                                    )
                                    u
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          7
                                       
                                    
                                    (
                                    n
                                    -
                                    3
                                    )
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          8
                                       
                                    
                                    (
                                    n
                                    -
                                    2
                                    )
                                    =
                                    0
                                    ,
                                 
                              
                           
                           
                              
                                 (A.3)
                                 
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          4
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          5
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          6
                                       
                                    
                                    )
                                    u
                                    +
                                    2
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          4
                                       
                                    
                                    -
                                    
                                       
                                          λ
                                       
                                       
                                          5
                                       
                                    
                                    -
                                    2
                                    
                                       
                                          λ
                                       
                                       
                                          6
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          8
                                       
                                    
                                    =
                                    0
                                    ,
                                 
                              
                           
                           
                              
                                 (A.4)
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          5
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          7
                                       
                                    
                                    =
                                    0
                                    ,
                                 
                              
                           
                           
                              
                                 (A.5)
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          8
                                       
                                    
                                    =
                                    0
                                    ,
                                 
                              
                           
                           
                              
                                 (A.6)
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          6
                                       
                                    
                                    =
                                    0
                                    ,
                                 
                              
                           
                           
                              
                                 (A.7)
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          4
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          6
                                       
                                    
                                    =
                                    0
                                    ,
                                 
                              
                           
                           
                              
                                 (A.8)
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    0
                                    ,
                                 
                              
                           
                           
                              
                                 (A.9)
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          5
                                       
                                    
                                    =
                                    0
                                    .
                                 
                              
                           Eqs. (A.4) and (A.5) imply λ
                           5
                           +
                           λ
                           7
                           =−λ
                           1 and λ
                           3
                           +
                           λ
                           8
                           =−λ
                           1, together with Eq. (A.1) yield λ
                           1
                           =
                           λ
                           8. Using Eqs. (A.6), (A.7) and (A.8), one calculates λ
                           1
                           =
                           λ
                           2
                           =
                           λ
                           4
                           =
                           λ
                           6
                           =0. These values inserted into Eq. (A.3) yields (λ
                           3
                           +
                           λ
                           5)u
                           −
                           λ
                           5(n
                           −3)−
                           λ
                           3(n
                           −2), which, together with (A.9) imply λ
                           3
                           =
                           λ
                           5
                           =0. Finally, it is easy to calculate λ
                           7
                           =
                           λ
                           8
                           =0 using (A.4) and (A.5). □

Matrix A mentioned in Proposition 7 is shown below, where each column corresponds to the column vector
                        
                           
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          ij
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          ji
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          ik
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          ki
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          jk
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          kj
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          il
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          li
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          jl
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          lj
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          kl
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          lk
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          l
                                       
                                    
                                    )
                                 
                                 
                                    T
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           
                              A
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                          
                                          
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                             
                                          
                                          
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                          
                                          
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                             
                                          
                                          
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                          
                                          
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                                3
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                             
                                             
                                                u
                                             
                                             
                                                u
                                                +
                                                1
                                             
                                             
                                                u
                                                +
                                                2
                                             
                                             
                                                u
                                                +
                                                3
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  

@&#REFERENCES@&#

