@&#MAIN-TITLE@&#An interactive analysis of harmonic and diffusion equations on discrete 3D shapes

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We study the discretization of harmonic, Laplacian, diffusion maps and distances.


                        
                        
                           
                           We generate spectral distances in a unified way.


                        
                        
                           
                           We focus on different Laplacian matrices, initial conditions, and shapes.


                        
                        
                           
                           The user can perform a large set of experiments on maps and spectral distances.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Spectral methods

Harmonic and bi-harmonic functions

Heat diffusion equation

Bi-harmonic and diffusion distances

@&#ABSTRACT@&#


               
                  Graphical abstract
                  Robustness of the biharmonic distance from a source (black) point, which has been computed using the linear FEM mass matrix as weight, with respect to (b) tiny and missing triangles, (c) noise, (d) holes of an irregularly sampled surface (a) with local shape artifacts. 
                        
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

Three main classes of functions are associated to the Laplace–Beltrami operator 
                        Δ
                        :
                        
                           
                              C
                           
                           
                              2
                           
                        
                        (
                        N
                        )
                        →
                        
                           
                              C
                           
                           
                              0
                           
                        
                        (
                        N
                        )
                     , where 
                        
                           
                              C
                           
                           
                              k
                           
                        
                        (
                        N
                        )
                      is the class of maps defined on the manifold 
                        N
                      and with order k of differentiability: the harmonic maps, the Laplacian eigenfunctions, and the solutions to the heat diffusion equation [56]. The spectral properties of this operator have also several applications in geometry processing and shape analysis, such as parameterization, remeshing, segmentation, and comparison. In this context, our work addresses the main discretizations and properties of the harmonic functions and the solutions to the heat diffusion equation. We also take into account the corresponding distances and provide a unified characterization based on the filtered spectral distances, thus providing a simple way to generate new distances on 3D shapes.

For the discretization of the heat diffusion kernel [51], in the space 
                        F
                        (
                        M
                        )
                      of piecewise linear scalar maps defined on a triangle mesh 
                        M
                      we consider the weighted scalar product 
                     
                        〈
                        f
                        ,
                        g
                        
                           
                              〉
                           
                           
                              B
                           
                        
                        ≔
                        
                           
                              f
                           
                           
                              T
                           
                        
                        B
                        g
                     , 
                        f
                        ,
                        g
                        ∈
                        F
                        (
                        M
                        )
                     , where 
                        f
                        ≔
                        
                           
                              (
                              f
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              )
                              )
                           
                           
                              i
                              =
                              1
                           
                           
                              n
                           
                        
                      is the array of the f-values at the mesh vertices 
                        
                           
                              {
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           
                              n
                           
                        
                     . This product is induced by the symmetric and positive-definite matrix B associated to the linear FEM discretization 
                        
                           
                              L
                           
                           
                              ˜
                           
                        
                        ≔
                        
                           
                              B
                           
                           
                              −
                              1
                           
                        
                        L
                      of the Laplace–Beltrami operator [55,73]. Here, the stiffness matrix L is the Laplacian matrix with cotangent weights and the mass matrix B, or its lumped version, encodes the areas of the triangles, or of the Voronoi regions, of 
                        M
                     . The product 
                        〈
                        ·
                        ,
                        ·
                        
                           
                              〉
                           
                           
                              B
                           
                        
                      generalizes the Euclidean product (i.e., 
                        B
                        ≔
                        I
                     ); is intrinsic to the surface on which the scalar maps are defined; and is adapted to the local sampling of 
                        M
                      through the variation of the triangle areas. Under this formulation, the generalized eigenproblem for (L,B) is 
                        LX
                        =
                        BX
                        Γ
                      
                     [25], where 
                        X
                        ≔
                        [
                        
                           
                              x
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              x
                           
                           
                              n
                           
                        
                        ]
                     , 
                        Γ
                        ≔
                        diag
                        
                           
                              (
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           
                              i
                              =
                              1
                           
                           
                              n
                           
                        
                      are the eigenvalues’ and eigenvectors’ matrices.

In 
                        F
                        (
                        M
                        )
                     , we derive the wFEM heat kernel 
                     
                        
                           
                              K
                           
                           
                              t
                           
                        
                        ≔
                        
                           
                              XD
                           
                           
                              t
                           
                        
                        
                           
                              X
                           
                           
                              T
                           
                        
                        B
                      and an intrinsic, multi-scale scalar product 
                        〈
                        ·
                        ,
                        ·
                        
                           
                              〉
                           
                           
                              t
                           
                        
                     , which makes K
                     
                        t
                      self-adjoint and induces the corresponding wFEM diffusion distances. If the mass matrix B is lumped to the positive diagonal matrix D, then the wFEM heat kernel 
                        
                           
                              K
                           
                           
                              t
                           
                        
                        ≔
                        
                           
                              XD
                           
                           
                              t
                           
                        
                        
                           
                              X
                           
                           
                              T
                           
                        
                        B
                      becomes equal to the discretization 
                        
                           
                              K
                           
                           
                              t
                           
                           
                              ⋆
                           
                        
                        ≔
                        
                           
                              XD
                           
                           
                              t
                           
                        
                        
                           
                              X
                           
                           
                              T
                           
                        
                        D
                     , which holds for Laplacians of type 
                        L
                        ≔
                        
                           
                              D
                           
                           
                              −
                              1
                           
                        
                        W
                      
                     [9,49,59,70,74]. Here, W has the mask of the mesh adjacency matrix and the diagonal entries of D are the areas of the Voronoi regions associated to the vertices of 
                        M
                     . If B is equal to the identity matrix, then K
                     
                        t
                      reduces to the spectral representation of the heat diffusion kernel 
                        
                           
                              
                                 
                                    K
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              t
                           
                        
                        ≔
                        
                           
                              XD
                           
                           
                              t
                           
                        
                        
                           
                              X
                           
                           
                              T
                           
                        
                      with cotangent weights [10,14,23,75]. Using the mass matrix B instead of its lumped version D, or the identity matrix, allows us to accurately encode the geometry of the input surface through the area of its triangles instead of its Voronoi regions. In this way, the wFEM heat kernel and the corresponding FEM diffusion distances have a higher robustness against topological and scale changes, irregular sampling, and noise. Finally, this choice guarantees that the induced wFEM heat kernel is intrinsically scale-covariant and scale-invariant through a normalization of the Laplacian eigenvalues.

The Laplacian spectrum is also fundamental to define the diffusion [5,13,37], commute time, and biharmonic [60] distances. For shape analysis, these distances must be a metric (i.e., nullity, symmetry, triangular inequality hold) and satisfy additional properties, such as local and global shape-awareness, isometry invariance, robustness to surface sampling, topological and geometric noise. Noting that these distances are related to each others by applying a different weighting to the Laplacian eigenvalues, they are represented in a unified way through the filtered spectral distance 
                     
                        
                           
                              d
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                              
                              )
                              ≔
                              
                                 
                                    [
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                p
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          
                                             
                                                |
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          φ
                                          (
                                          
                                             
                                                λ
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                    ]
                                 
                                 
                                    1
                                    /
                                    2
                                 
                              
                              ,
                              
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                              
                              ∈
                              M
                              .
                           
                        
                     Here, 
                        
                           
                              x
                           
                           
                              k
                           
                        
                        (
                        
                           
                              p
                           
                           
                              i
                           
                        
                        )
                      is the ith component of the vector 
                        
                           
                              x
                           
                           
                              k
                           
                        
                      and 
                        φ
                        :
                        R
                        →
                        R
                      is a strictly positive map, which is applied to the Laplacian eigenvalues. Specific filters provide well-known or new spectral distances on 
                        M
                     ; for instance, the linear 
                        φ
                        (
                        s
                        )
                        ≔
                        s
                     , quadratic 
                        φ
                        (
                        s
                        )
                        ≔
                        
                           
                              s
                           
                           
                              2
                           
                        
                     , or exponential 
                        
                           
                              φ
                           
                           
                              t
                           
                        
                        (
                        s
                        )
                        ≔
                        exp
                        (
                        st
                        )
                      maps induce the commute time [53], bi-harmonic [60], or diffusion distances [9], respectively. In [6], the filter map 
                        φ
                        (
                        s
                        )
                        ≔
                        exp
                        (
                        −
                        is
                        )
                     , 
                        s
                        ∈
                        [
                        0
                        ,
                        2
                        π
                        ]
                     , defines the wave kernel signature 
                        S
                        (
                        
                           
                              p
                           
                           
                              i
                           
                        
                        )
                        ≔
                        
                           
                              ∑
                           
                           
                              j
                              =
                              1
                           
                           
                              n
                           
                        
                        φ
                        (
                        
                           
                              λ
                           
                           
                              j
                           
                        
                        )
                        
                           
                              x
                           
                           
                              j
                           
                           
                              2
                           
                        
                        (
                        
                           
                              p
                           
                           
                              i
                           
                        
                        )
                      and the filter values 
                        
                           
                              {
                              φ
                              (
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              )
                              }
                           
                           
                              i
                              =
                              1
                           
                           
                              n
                           
                        
                      are the frequency responses induced by the Schroedinger equation. In this case, the corresponding solution 
                        F
                        (
                        ·
                        ,
                        t
                        )
                        ≔
                        
                           
                              ∑
                           
                           
                              j
                              =
                              1
                           
                           
                              n
                           
                        
                        φ
                        (
                        
                           
                              λ
                           
                           
                              j
                           
                        
                        t
                        )
                        〈
                        f
                        ,
                        
                           
                              x
                           
                           
                              j
                           
                        
                        
                           
                              〉
                           
                           
                              2
                           
                        
                        
                           
                              x
                           
                           
                              j
                           
                        
                      is associated to a complex filter, whose values belong to the interval 
                        [
                        −
                        1
                        ,
                        1
                        ]
                     . In our discussion, we focus on the spectral distances, together with its relation with the generalized Green kernel, instead of kernel signatures; consider only positive maps that converge to zero, as 
                        s
                        →
                        +
                        ∞
                     ; and derive the discretization induced by a scalar product intrinsic to the input shape instead of the Euclidean product.

Starting from these filters, we can design new distances; the only constraint is that 
                        φ
                      is a strictly positive map. The capability of locally or globally characterizing the input shape depends on the convergence of the filtered eigenvalues 
                        
                           
                              (
                              φ
                              (
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              )
                              )
                           
                           
                              i
                              =
                              1
                           
                           
                              n
                           
                        
                      to zero. Furthermore, the condition 
                        
                           
                              lim
                           
                           
                              s
                              →
                              +
                              ∞
                           
                        
                        φ
                        (
                        s
                        )
                        =
                        0
                      guarantees a smooth spectral distance and a good approximation accuracy through the truncated approximation (c.f., Eq. (13)). Increasing the filter decay to zero, the effects of the eigenvalues of largest magnitude and of the corresponding eigenvectors on the filtered spectral distance are negligible with respect to the contribution of the lower eigenvalues. The resulting distance characterizes the global properties of the input shape, while poorly identifying its local properties. Reducing the filter decay to zero, local shape features are better characterized. A trade-off between the measure of both local and global properties can be achieved by selecting 
                        φ
                      as a convex combination between the filters associated to the diffusion and bi-harmonic distances, respectively.

As main applications of the filtered spectral distances, we focus on shape segmentation into 0-genus patches with respect to generalized auto-diffusion functions and shape embeddings. For instance, selecting the filter 
                        φ
                      we compute a family of segmentations into 0-genus patches (Fig. 1
                     (a,b)) and embed 3D shapes in abstract representations (Fig. 1(c, d)). For a more detailed description of the main applications of the filtered spectral distances and related shape descriptors, we refer the reader to Section 2.

Through the executable paper, the reader will be able to compute the harmonic functions and the solutions to the heat diffusion equation, by selecting (i) a specific set of weights for the Laplacian matrix (e.g., cot, Voronoi-cot, linear FEM weights); (ii) the input shapes, which are represented as triangle meshes; and (iii) the initial boundary conditions. Among the main properties, we discuss their robustness to shape discretization and noise, smoothness, scale-invariance, dependence on the discretization of the Laplace–Beltrami operator, and computational stability. The resulting scalar functions and distances are visualized using a color coding of the function values, the evolution of the corresponding level sets and critical points. Finally, the filtered spectral distances are computed through the selection of the spectrum of different Laplacian matrices, filter maps, and source points. For our tests, we have selected 3D shapes that are (i) characterized by a different sampling density and geometric/topological complexity; (ii) modified through isometric and non-rigid almost inelastic deformations, global and local scaling; and (iii) affected by noise of different magnitude.

The paper is organized as follows. After a brief overview on previous work (Section 2), we introduce the discretization and pro-perties of the harmonic map, the Laplacian eigenfunctions (Section 3), and the solutions to the heat diffusion equation (Section 4). Then (Section 5), we discuss the FEM heat diffusion distances and propose a unified view on the definition of distances on 3D shapes induced by the Laplacian spectrum.

We briefly review previous work on the harmonic maps, the Laplacian eigenfunctions, the heat diffusion kernel, and the corresponding distances.


                     Harmonic maps and Laplacian eigenfunctions: Mesh Laplacian operators were initially developed for shape filtering [72]; spectral partitioning [33] and analysis [80]. Successively, Laplacian operators have been associated to a set of differential coordinates for surface deformation [65,68] and quadrangulation with harmonic maps and Laplacian eigenfunctions [4,19,18,38,46]. The eigenvector corresponding to the smallest non-zero eigenvalue of the Laplacian graph (i.e., the Fielder vector) has been applied to graph partitioning [1,21,43]; to sparse matrices for reducing their bandwidth [3]; to clustering [61, Section 14] and dimensionality reduction [4]; to graph/mesh layout [17,36] and image segmentation [62].

In digital geometry processing, low-pass filters [71] have been designed using the spectral properties of the uniform discrete Laplacian and encoding the local geometry of the input surface [15,34,52]. Further applications include implicit mesh fairing [15,34,78], mesh watermarking [48,47], and geometry compression [33,67]. Moreover, the spectral properties of the Laplacian matrix are at the basis of the definition of fairing functionals [35,40], which optimize the triangles’ shape and/or the surface smoothnesss [44].

The Laplacian eigenvectors were also used for embedding a surface of arbitrary genus into the plane [81,83] and mapping a closed 0-genus surface into a spherical domain [26]. In the frequency space, shape segmentation [39,79], correspondence [30,31], and comparison [30,55] have been successfully addressed. Recent applications of the Laplacian spectrum include shape segmentation and analysis through nodal domains [54] and constrained smoothing of scalar functions [50]. Finally, theoretical results on the sensitivity of the Laplacian spectrum against geometry changes, irregular sampling density, and connectivity variations were discussed in [20,32,77].


                     Heat diffusion maps and diffusion distances: In geometry processing and shape analysis, several problems have been addressed through the properties of the heat diffusion kernel on a 3D shape. The discrete heat diffusion kernel has been applied to shape segmentation [14] and comparison [9,10,16,23,49] through heat kernel shape descriptors and auto-diffusion maps [23]; dimensionality reduction [4,76] with spectral embeddings; the computation of the gradient of discrete maps [75] and the multi-scale approximation of functions [51]. In [74], prolongation operators extend the values of the heat diffusion kernel computed on a low resolution representation of the input shape to higher resolutions, through the hierarchy associated to multiresolutive simplification algorithms.

Recently, the heat equation and the associated diffusion metric have been used to define multi-scale shape signatures [70], compare 3D shapes [41], and approximate the gradients of scalar functions defined on triangulated surfaces and point sets [75]. The heat diffusion kernel on manifolds also plays a central role in Machine Learning [13,24,27,28,37,61,63]; dimensionality reduction with spectral embeddings [4,76]; data visualization [4,28,57], representation [11,64,82], and classification [45,62,69].

We briefly recall the discretization of the Laplace–Beltrami operator, the classification of the critical points for piecewise scalar functions defined on triangulated surfaces, and the main properties of the harmonic functions.


                     Laplacian matrix: Let us consider a triangle mesh 
                        M
                        ≔
                        (
                        P
                        ,
                        T
                        )
                     , which discretizes a manifold 
                        N
                     , where 
                        P
                        ≔
                        
                           
                              {
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           
                              n
                           
                        
                      is the set of n vertices and T is the connectivity graph. The piecewise linear scalar function 
                        f
                        :
                        M
                        →
                        R
                      is defined by linearly interpolating the values 
                        f
                        ≔
                        
                           
                              (
                              f
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              )
                              )
                           
                           
                              i
                              =
                              1
                           
                           
                              n
                           
                        
                      of f at the vertices using barycentric coordinates. Then, the Laplacian matrix is defined as 
                        
                           
                              L
                           
                           
                              ˜
                           
                        
                        ≔
                        
                           
                              B
                           
                           
                              −
                              1
                           
                        
                        L
                     , where 
                        
                           
                              L
                              (
                              i
                              ,
                              j
                              )
                              ≔
                              {
                              
                                 
                                    
                                       w
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ≔
                                       
                                          
                                             
                                                cot
                                                
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                +
                                                cot
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      ij
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       j
                                       ∈
                                       N
                                       (
                                       i
                                       )
                                       ,
                                    
                                 
                                 
                                    
                                       −
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∈
                                             N
                                             (
                                             i
                                             )
                                          
                                       
                                       w
                                       (
                                       i
                                       ,
                                       k
                                       )
                                    
                                    
                                       i
                                       =
                                       j
                                       ,
                                    
                                 
                                 
                                    
                                       0
                                    
                                    
                                       else
                                       .
                                    
                                 
                              
                           
                        
                     is the Laplacian matrix with cotangent weights; here, N(i) is the set of the indices of the vertices incident to 
                        
                           
                              p
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              α
                           
                           
                              ij
                           
                        
                     , 
                        
                           
                              β
                           
                           
                              ij
                           
                        
                      are the angles that are opposite to the edge (i,j). The weight matrix B is the diagonal matrix whose entries are the areas of the Voronoi regions of the mesh vertices (Voronoi-cot weights) [15] 
                     
                        
                           
                              B
                              ≔
                              diag
                              
                                 
                                    (
                                    a
                                    (
                                    i
                                    )
                                    )
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              ,
                              
                              a
                              (
                              i
                              )
                              ≔
                              
                                 
                                    1
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    t
                                    ∈
                                    N
                                    (
                                    i
                                    )
                                 
                              
                              area
                              (
                              t
                              )
                              .
                           
                        
                     Alternatively, B is the FEM mass matrix [55,73] (linear FEM weights), which codes the variation of the triangle areas 
                        
                           
                              B
                              (
                              i
                              ,
                              j
                              )
                              ≔
                              {
                              
                                 
                                    
                                       
                                          
                                             |
                                             
                                                
                                                   t
                                                
                                                
                                                   a
                                                
                                             
                                             |
                                             +
                                             |
                                             
                                                
                                                   t
                                                
                                                
                                                   b
                                                
                                             
                                             |
                                          
                                          
                                             12
                                          
                                       
                                    
                                    
                                       j
                                       ∈
                                       N
                                       (
                                       i
                                       )
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   ∈
                                                   T
                                                   (
                                                   i
                                                   )
                                                
                                             
                                             |
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                             |
                                          
                                          
                                             6
                                          
                                       
                                    
                                    
                                       i
                                       =
                                       j
                                       ,
                                    
                                 
                                 
                                    
                                       0
                                    
                                    
                                       else
                                       ,
                                    
                                 
                              
                           
                        
                     where area(t) is the area of the triangle t, T(i) is the set of triangles that have 
                        {
                        i
                        }
                      among their vertices, and t
                     
                        a
                     , t
                     
                        b
                      are the triangles that share the edge (i,j). If the FEM mass matrix is lumped to the diagonal matrix, then the FEM Laplacian matrix becomes equal to the Voronoi-cot Laplacian matrix. If 
                        B
                        ≔
                        I
                     , then we get the Laplacian matrix with cot weights [52].

If the input surface is bordered (e.g., Fig. 13), then we symmetrize 
                        
                           
                              L
                           
                           
                              ˜
                           
                        
                      as 
                        (
                        
                           
                              L
                           
                           
                              ˜
                           
                        
                        +
                        
                           
                              
                                 
                                    L
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              T
                           
                        
                        )
                        /
                        2
                     ; since our approach works mainly on matrices, this symmetrization is enough to guarantee that the computation of the filtered spectral distances is not affected by surface holes and local shape artifacts.


                     Critical points: In the discrete case, the behavior of a piecewise linear scalar function 
                        f
                        :
                        M
                        →
                        R
                      is conveyed by the corresponding level sets 
                        
                           
                              f
                           
                           
                              −
                              1
                           
                        
                        (
                        α
                        )
                      and the critical points of f, at which the number of connected components of the level sets changes. Let us assume that 
                        f
                        :
                        M
                        →
                        R
                      is general, i.e., 
                        f
                        (
                        
                           
                              p
                           
                           
                              i
                           
                        
                        )
                        ≠
                        f
                        (
                        
                           
                              p
                           
                           
                              j
                           
                        
                        )
                     , for each edge (i,j). Then, the critical points of 
                        f
                        :
                        M
                        →
                        R
                      are computed by analyzing the distribution of the f-values on the neighborhood of each vertex [2]. Under the assumption that f is a regular map, the Euler formula
                     
                        
                           (1)
                           
                              χ
                              (
                              M
                              )
                              =
                              m
                              −
                              s
                              +
                              M
                              ,
                              
                              g
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              (
                              2
                              −
                              χ
                              (
                              M
                              )
                              )
                              ,
                           
                        
                     gives the link between the critical points of 
                        (
                        M
                        ,
                        f
                        )
                     , the Euler characteristic 
                        χ
                        (
                        M
                        )
                      of 
                        M
                      
                     [2,42], and the genus g of 
                        M
                     . Here, m and M are the number of minima and maxima, respectively; the 
                        s
                        ≔
                        
                           
                              ∑
                           
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              
                              saddle
                           
                        
                        
                           
                              m
                           
                           
                              i
                           
                        
                      saddle points of f are counted with their multiplicity m
                     
                        i
                     .


                     Harmonic maps: The harmonic function 
                     
                        h
                        :
                        N
                        →
                        R
                      is the solution of the Laplace equation 
                        Δ
                        h
                        =
                        0
                      with Dirichlet boundary conditions 
                        h
                        
                           
                              |
                           
                           
                              S
                           
                        
                        =
                        
                           
                              h
                           
                           
                              0
                           
                        
                     , 
                        S
                        ⊂
                        N
                     , where h
                     0 is the initial condition. The locality property guarantees that if p and q are two distinct points, then 
                        Δ
                        h
                        (
                        p
                        )
                      is not affected by the value of h at q. According to the maximum principle 
                     [56], a harmonic map has no local extrema other than at constrained vertices. In the case that all constrained minima are assigned the same global minimum value and all constrained maxima are assigned the same global maximum value, all the constraints will be extrema in the resulting field.

The harmonic equation is approximated at the vertices of 
                        M
                      as the homogeneous linear system 
                        L
                        f
                        =
                        0
                     , with Dirichlet boundary conditions 
                        B
                        ≔
                        
                           
                              {
                              f
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              }
                           
                           
                              i
                              ∈
                              I
                           
                        
                     , 
                        I
                        ⊆
                        {
                        1
                        ,
                        …
                        ,
                        n
                        }
                     . According to the Euler formula (1), the number of critical points of a harmonic map depends on the number of Dirichlet boundary conditions, which determine the maxima and minima of the resulting harmonic map. In particular, a harmonic function with one maximum and one minimum has a minimal number of 2g saddle points, which are located on the topological handles of 
                        M
                     .


                     Fig. 2
                      shows a family of harmonic functions achieved by increasing the number of Dirichlet boundary conditions. In (a), we have selected two boundary conditions, which identify the maximum and minimum of f; in (b), we have added two new boundary conditions, while maintaining the previous ones. According to the locality property, the resulting harmonic function and its level sets remain unchanged in a neighborhood of the Dirichlet points related to the previous step. An analogous remark applies to (b,c), where in (c) we added two constraints to the set of Dirichlet conditions used in (b). While the position of the extrema is determined a priori by the Dirichlet boundary conditions, only the number of saddles and not their locations on the input surface are determined through the Euler formula. Fig. 3
                      shows an analogous example on a high resolu-tion model.


                     Executable paper
                     
                        1
                     
                     
                        1
                        
                           https://collage.elsevier.com/collage/template?doi=10.0000/1352475983201
                        
                     : For the experiments presented in the paper, the user can select the input surface among 30 triangle meshes, which have been stored in off format as shape-i.off, 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        30
                     . For the tests in Figs. 2 and 3, the reader can run the experiment Harmonic_function.exp.xml, which asks to select the off file of the input shape. The default file is 3torus.off; the acquarius models at low (Fig. 2) and high resolution (Fig. 3) are stored in acquarius-5Kv.off and acquarius-26Kv.off, respectively. The routine computes three harmonic functions with two, four, and six Dirichlet boundary conditions and displays the corresponding M maxima, m minima, and s saddles. The first two initial conditions are placed at the vertices with minimum and maximum x-coordinates; the corresponding f-values are 0 and 1. For four and six initial conditions, we also consider the vertices of minimum and maximum y- and z-coordinates. The input shape, the colormap, and the level sets of each harmonic function are stored in harmonic-map-i.wrl and displayed in harmonic-map-i.png, i=1,2,3. The colormap varies the hue component of the hue-saturation-value color model; the colors begin with red, pass through yellow, green, cyan, blue, magenta, and return to red. Finally, the array of the values of each harmonic map at the mesh vertices is stored in harmonic-field-i.txt, i=1,2,3. For the visualization of the wrl file, the user can use View3DScene
                     
                        2
                     
                     
                        2
                        
                           http://castle-engine.sourceforge.net/view3dscene.php.
                      or analogous visualization tools.

We briefly address the discretization of the heat diffusion kernel with respect to linear finite elements [51] (Section 4.1), its properties (Section 4.2), and its computation (Section 4.3). Then (Section 4.4), we discuss the main features of this discretization with respect to previous work. Among them, we focus on the multi-scale property; the stability under shape perturbations (e.g., sampling, connectivity, topological noise); and the invariance to isometries and inelastic deformations.

The scale-based representation 
                        
                           H
                           :
                           N
                           ×
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                           →
                           R
                         of the map 
                           h
                           :
                           N
                           →
                           R
                         is the solution to the heat diffusion equation
                        
                           
                              (2)
                              
                                 
                                    
                                       ∂
                                    
                                    
                                       t
                                    
                                 
                                 H
                                 (
                                 p
                                 ,
                                 t
                                 )
                                 =
                                 −
                                 Δ
                                 H
                                 (
                                 p
                                 ,
                                 t
                                 )
                                 ,
                                 
                                 H
                                 (
                                 p
                                 ,
                                 0
                                 )
                                 =
                                 h
                                 (
                                 p
                                 )
                                 ,
                              
                           
                        
                        
                           (
                           p
                           ,
                           t
                           )
                           ∈
                           N
                           ×
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                         and it can be written through the convolution operator 
                           ⋆
                         as 
                           H
                           (
                           p
                           ,
                           t
                           )
                           ≔
                           
                              
                                 k
                              
                              
                                 t
                              
                           
                           (
                           p
                           ,
                           ·
                           )
                           ⋆
                           h
                           =
                           
                              
                                 ∫
                              
                              
                                 N
                              
                           
                           
                              
                                 k
                              
                              
                                 t
                              
                           
                           (
                           p
                           ,
                           q
                           )
                           h
                           (
                           q
                           )
                           d
                           q
                        , where 
                           
                              
                                 k
                              
                              
                                 t
                              
                           
                           (
                           p
                           ,
                           q
                           )
                           ≔
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 +
                                 ∞
                              
                           
                           exp
                           (
                           −
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           t
                           )
                           
                              
                                 φ
                              
                              
                                 i
                              
                           
                           (
                           p
                           )
                           
                              
                                 φ
                              
                              
                                 i
                              
                           
                           (
                           q
                           )
                         is the heat diffusion kernel.

To derive the discretization to Eq. (2), we replace the space 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                           (
                           N
                           )
                         of square integrable functions defined on 
                           N
                         with the finite dimensional subspace 
                           
                              
                                 F
                                 (
                                 M
                                 )
                                 ≔
                                 {
                                 f
                                 :
                                 M
                                 →
                                 R
                                 ,
                                 
                                 f
                                 
                                 PL
                                 ,
                                 f
                                 ≔
                                 
                                    
                                       (
                                       f
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                                 }
                                 ,
                              
                           
                        of piecewise linear (PL, for short) scalar functions defined on the triangle mesh 
                           M
                        . In 
                           F
                           (
                           M
                           )
                        , the piecewise linear scalar function 
                           F
                           (
                           ·
                           ,
                           t
                           )
                           :
                           M
                           →
                           R
                         is uniquely identified by the F-values 
                           F
                           (
                           t
                           )
                           ≔
                           
                              
                                 (
                                 F
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 t
                                 )
                                 )
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                         at the vertices of the input triangle mesh. In 
                           F
                           (
                           M
                           )
                        , let 
                           
                              
                                 ψ
                              
                              
                                 i
                              
                           
                         be the map that takes value 1 at 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                         and 0 at the other vertices. To re-write the solution 
                           F
                           (
                           t
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                           F
                           (
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                           ,
                           t
                           )
                           
                              
                                 ψ
                              
                              
                                 i
                              
                           
                         to the heat diffusion equation in terms of the basis of 
                           F
                           (
                           M
                           )
                        , let us multiply both sides of the equation 
                           
                              
                                 ∂
                              
                              
                                 t
                              
                           
                           F
                           (
                           ·
                           ,
                           t
                           )
                           +
                           Δ
                           F
                           (
                           ·
                           ,
                           t
                           )
                           =
                           0
                         with the test functions in 
                           F
                           (
                           M
                           )
                        ; integrating this equation over 
                           M
                        , we get that
                           
                              (3)
                              
                                 0
                                 =
                                 〈
                                 
                                    
                                       ∂
                                    
                                    
                                       t
                                    
                                 
                                 F
                                 (
                                 ·
                                 ,
                                 t
                                 )
                                 +
                                 Δ
                                 F
                                 (
                                 ·
                                 ,
                                 t
                                 )
                                 ,
                                 
                                    
                                       ψ
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       〉
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       ∂
                                    
                                    
                                       t
                                    
                                 
                                 F
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 t
                                 )
                                 〈
                                 
                                    
                                       ψ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       ψ
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       〉
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 F
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 t
                                 )
                                 〈
                                 Δ
                                 
                                    
                                       ψ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       ψ
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       〉
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       ∂
                                    
                                    
                                       t
                                    
                                 
                                 F
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 t
                                 )
                                 B
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 F
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 t
                                 )
                                 L
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 .
                              
                           
                        for j=1,…,n. In matrix form, Eq. (3) is rewritten as 
                           
                              
                                 B
                                 ∂
                                 F
                                 (
                                 t
                                 )
                                 +
                                 L
                                 F
                                 (
                                 t
                                 )
                                 =
                                 0
                                 ,
                                 
                                 F
                                 (
                                 0
                                 )
                                 =
                                 f
                                 .
                              
                           
                        Let us now consider the generalized eigensystem 
                           
                              
                                 
                                    
                                       {
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       }
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                 L
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 B
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 B
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                              
                           
                        of the couple (L,B), which defines the linear FEM discretization 
                           
                              
                                 L
                              
                              
                                 ˜
                              
                           
                           ≔
                           
                              
                                 B
                              
                              
                                 −
                                 1
                              
                           
                           L
                         of the Laplace–Beltrami operator (Section 3), or in matrix form
                           
                              (4)
                              
                                 LX
                                 =
                                 BX
                                 Γ
                                 ,
                                 
                                 Γ
                                 ≔
                                 diag
                                 
                                    
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       X
                                    
                                    
                                       T
                                    
                                 
                                 BX
                                 =
                                 I
                                 ,
                              
                           
                        where 
                           Γ
                         is the diagonal matrix of the Laplacian eigenvalues and 
                           X
                           ≔
                           [
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 n
                              
                           
                           ]
                         is the matrix of the eigenvectors. Since the unknown function 
                           F
                           :
                           M
                           ×
                           R
                           →
                           R
                         is a 
                           n
                           ×
                           1
                         vector for each value of the parameter t, the solution 
                           F
                           (
                           t
                           )
                           ≔
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                           (
                           t
                           )
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                         to the discrete heat diffusion equation is expressed as a linear combination of the eigensystem of (L,B), where 
                           α
                           (
                           t
                           )
                           ≔
                           (
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                           
                              
                                 (
                                 t
                                 )
                                 )
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                         is the unknown vector. Since B is positive-definite, the space 
                           F
                           (
                           M
                           )
                         is endowed with the weighted inner product
                        
                           
                              (5)
                              
                                 〈
                                 f
                                 ,
                                 g
                                 
                                    
                                       〉
                                    
                                    
                                       B
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       T
                                    
                                 
                                 B
                                 g
                                 ,
                                 
                                 f
                                 ≔
                                 
                                    
                                       (
                                       f
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                 g
                                 ≔
                                 
                                    
                                       (
                                       g
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 ,
                              
                           
                        which is intrinsic to the geometry underlying 
                           M
                         and adapted to its discretization. Using the invertibility of the matrix B, the linear independence of the Laplacian eigenfunctions, and the identity 
                           f
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                           〈
                           f
                           ,
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           
                              
                                 〉
                              
                              
                                 B
                              
                           
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        , each component 
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                           (
                           t
                           )
                         satisfies the differential equation 
                           
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 t
                                 )
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 0
                                 ,
                                 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 0
                                 )
                                 =
                                 〈
                                 f
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       〉
                                    
                                    
                                       B
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 .
                              
                           
                        Indeed, the scale-based representation of 
                        
                           f
                           :
                           M
                           →
                           R
                         is
                           
                              (6)
                              
                                 F
                                 (
                                 ·
                                 ,
                                 t
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 exp
                                 (
                                 −
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 t
                                 )
                                 〈
                                 f
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       〉
                                    
                                    
                                       B
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 t
                                 ∈
                                 R
                                 ,
                              
                           
                        which is re-written in matrix form as 
                           F
                           (
                           ·
                           ,
                           t
                           )
                           =
                           
                              
                                 K
                              
                              
                                 t
                              
                           
                           f
                        , where
                           
                              (7)
                              
                                 
                                    
                                       K
                                    
                                    
                                       t
                                    
                                 
                                 ≔
                                 
                                    
                                       XD
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       T
                                    
                                 
                                 B
                                 ,
                                 
                                 
                                    
                                       D
                                    
                                    
                                       t
                                    
                                 
                                 ≔
                                 diag
                                 
                                    
                                       (
                                       exp
                                       (
                                       −
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       t
                                       )
                                       )
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 ,
                              
                           
                        is the weighted linear FEM (wFEM) heat kernel matrix.

Lumping the mass matrix B, we get the diagonal matrix 
                           D
                           ≔
                           diag
                           
                              
                                 (
                                 d
                                 (
                                 i
                                 )
                                 )
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                        , whose entries 
                           d
                           (
                           i
                           )
                           ≔
                           1
                           /
                           3
                           
                              
                                 ∑
                              
                              
                                 t
                                 ∈
                                 N
                                 (
                                 i
                                 )
                              
                           
                           |
                           t
                           |
                         are the areas of the Voronoi regions of 
                           M
                         and 
                           |
                           t
                           |
                         is the area of the triangle t. Then, K
                        
                           t
                         in Eq. (7) becomes equal to the Voronoi-cot (or lumped FEM) heat kernel 
                        [9,49,59,70,74] 
                        
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       t
                                    
                                    
                                       ⋆
                                    
                                 
                                 ≔
                                 
                                    
                                       XD
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       T
                                    
                                 
                                 D
                                 ,
                                 
                                 LX
                                 =
                                 DX
                                 Γ
                                 ,
                              
                           
                        Choosing 
                           B
                           ≔
                           I
                         in Eq. (7), we get the linear FEM heat kernel matrix 
                        
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 t
                              
                           
                           ≔
                           
                              
                                 XD
                              
                              
                                 t
                              
                           
                           
                              
                                 X
                              
                              
                                 T
                              
                           
                        . Using the mass matrix B instead of its lumped version D allows us to accurately encode the geometry of the input surface through the area of its triangles instead of its Voronoi regions.

Comparing the kernels 
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 t
                              
                           
                         and K
                        
                           t
                        , we notice that 
                           
                              
                                 K
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 t
                              
                           
                           B
                         and that the wFEM discretization explicitly involves the mass matrix B. In this case, 
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 t
                              
                           
                         is scale-dependent, i.e., rescaling 
                           M
                         to 
                           α
                           M
                        , 
                           α
                           >
                           0
                        , the corresponding kernels satisfy the relation 
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 t
                              
                           
                           (
                           α
                           M
                           )
                           =
                           
                              
                                 α
                              
                              
                                 −
                                 2
                              
                           
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 
                                    
                                       α
                                    
                                    
                                       −
                                       2
                                    
                                 
                                 t
                              
                           
                           (
                           M
                           )
                        . It follows that the geometric and temporal components of 
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 t
                              
                           
                           (
                           α
                           M
                           )
                         are affected by the surface rescaling and the corresponding heat kernel shape descriptors cannot be directly used for matching. On the contrary, K
                        
                           t
                         and 
                           
                              
                                 K
                              
                              
                                 t
                              
                              
                                 ⋆
                              
                           
                         are intrinsically scale-covariant (i.e., without shape or kernel normalization) and scale-invariant through a normalization of the Laplacian eigenvalues. In [7,8], these properties and the robustness of the wFEM heat kernel against shape transformation, sampling, and noise have been verified by testing the matching performances of the wFEM heat kernel descriptors on the SHREC'10 data set. Finally, Table 1
                         summarizes the properties of different discretizations of the heat kernel.

Once the Laplacian eigensystem has been computed in super-linear time [73], 
                           F
                           (
                           ·
                           ,
                           t
                           )
                         is evaluated in O(n)-time. However, using the whole spectrum is computationally unfeasible in terms of computational cost and storage of full n×n matrices. Since the exponential decay of the filter factor 
                        
                           
                              
                                 σ
                              
                              
                                 i
                              
                           
                           ≔
                           exp
                           (
                           −
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           t
                           )
                         increases with 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                        , we consider only a part of the Laplacian spectrum. To this end, the sum in (6) is truncated by considering only the contribution related to the first k eigenpairs, i.e.,
                           
                              (8)
                              
                                 
                                    
                                       F
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 ·
                                 ,
                                 t
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 exp
                                 (
                                 −
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 t
                                 )
                                 〈
                                 f
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       〉
                                    
                                    
                                       B
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       t
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       k
                                    
                                    
                                       T
                                    
                                 
                                 B
                                 f
                                 ,
                                 
                                 t
                                 ∈
                                 R
                                 ,
                              
                           
                        where 
                           
                              
                                 X
                              
                              
                                 k
                              
                           
                           ≔
                           [
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           ]
                         is the 
                           n
                           ×
                           k
                         matrix of Laplacian eigenfunctions and 
                           
                              
                                 D
                              
                              
                                 t
                              
                              
                                 (
                                 k
                                 )
                              
                           
                           ≔
                           diag
                           
                              
                                 (
                                 exp
                                 (
                                 −
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 t
                                 )
                                 )
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 k
                              
                           
                         is the diagonal matrix with the filter factors. If 
                           t
                           ≔
                           0
                        , then 
                           
                              
                                 F
                              
                              
                                 k
                              
                           
                           (
                           ·
                           ,
                           0
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 k
                              
                           
                           〈
                           f
                           ,
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           
                              
                                 〉
                              
                              
                                 B
                              
                           
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                         is the least-squares approximation of f in the linear space generated by the first k eigenfunctions and with respect to 
                           ∥
                           ·
                           
                              
                                 ∥
                              
                              
                                 B
                              
                           
                        .

We notice that both the parameters k and t define the hierarchy of approximations. In fact, reducing the number of Laplacian eigenfunctions results in a smoothing of the input map and a further simplification of its critical points, with more emphasis on those with a low persistence value. Furthermore, the eigenpairs related to the low frequencies code the global structure of the input shape [54,55]; on the contrary, the highest frequencies code noise and local details. Finally, the choice of the number k of Laplacian eigenpairs is up-to the user and its effects on the final approximation accuracy cannot be a priori estimated.

Exploiting the isomorphism between 
                           F
                           (
                           M
                           )
                         and 
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        , we interpret the canonical basis 
                           E
                           ≔
                           
                              
                                 {
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                         of 
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                         as the set of trivial maps that take value one at a given vertex of 
                           M
                         and zero otherwise. Then, 
                           B
                           ≔
                           
                              
                                 {
                                 
                                    
                                       K
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                         is a counterpart of 
                           E
                         in 
                           F
                           (
                           M
                           )
                        , where each piecewise linear map 
                           
                              
                                 K
                              
                              
                                 t
                              
                           
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                         is achieved by applying the diffusion process to the function that takes value one at the anchor 
                        
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                         and zero otherwise. For shape analysis and comparison, as anchors of a 3D shape we can select the maxima and minima of the Laplacian eigenfunctions related to the smallest eigenvalues [58] or of the auto-diffusion maps [23], without/with simplification based on persistence homology [84]. The map 
                           
                              
                                 K
                              
                              
                                 t
                              
                           
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                         summarizes the shape distribution in a neighbor of 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                        , in a way similar to the local point signatures [12] and geodesic-based descriptors [22,29]. This basis is a multi-scale version of the geometry-aware functions [66]; however, the definition and properties of 
                           B
                         are driven by the geometry of 
                           M
                         and not uniquely by its connectivity. It is also intrinsic to the input shape, multi-scale, and localized, according to the values of the time parameter.

Increasing t, the map 
                           
                              
                                 K
                              
                              
                                 t
                              
                           
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                         changes from the Dirichlet function (
                           t
                           ≔
                           0
                        ) to a constant map. In fact, recalling that the first eigenpair is 
                           (
                           0
                           ,
                           1
                           )
                         and using the relation 
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 〈
                                 1
                                 ,
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       〉
                                    
                                    
                                       B
                                    
                                 
                                 1
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       2
                                    
                                    
                                       n
                                    
                                 
                                 exp
                                 (
                                 −
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 t
                                 )
                                 〈
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       〉
                                    
                                    
                                       B
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       →
                                    
                                    
                                       t
                                       →
                                       +
                                       ∞
                                    
                                 
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 B
                                 1
                                 )
                                 1
                                 ,
                              
                           
                        we get that, as 
                           t
                           →
                           +
                           ∞
                        , 
                           
                              
                                 K
                              
                              
                                 t
                              
                           
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                         converges to the constant function 
                           
                              
                                 K
                              
                              
                                 +
                                 ∞
                              
                           
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 n
                              
                           
                           B
                           (
                           i
                           ,
                           j
                           )
                        . To better characterize these asymptotic properties and analyze different discretizations of the heat diffusion kernel, we compare the basis function 
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       t
                                    
                                    
                                       D
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 ≔
                                 
                                    
                                       XD
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       T
                                    
                                 
                                 D
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       K
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 ≔
                                 
                                    
                                       XD
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       T
                                    
                                 
                                 B
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 ,
                              
                           
                        which are induced by the Voronoi-cot and wFEM heat kernel, respectively.

The linear FEM Laplacian eigensystem (Fig. 4
                        (b,c)), together with the induced B-scalar product (c.f., Eq. (5)) in 
                           F
                           (
                           M
                           )
                        , provides smooth level sets that are well-distributed around the anchor point 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                        . On the contrary (Fig. 4(a)), irregularly sampled data badly affect the smoothness of the standard discretization of the diffusion kernel, thus showing the higher robustness and stability of the proposed discretization with respect to the data sampling.

The behavior of the level sets (Fig. 5
                        (g–j)) and their uniform distribution around the anchor point confirm that the wFEM heat kernel is not affected by a different sampling, or noise, of the input surface. As a matter of the uneven sampling of 
                           M
                         and the wide variation of the areas of its triangles, the quality of the approximation provided by the Voronoi-cot weights is lower (Fig. 5(c–f)). Irregularly sampled patches on 
                           M
                         generally affect the smoothness of 
                           
                              
                                 K
                              
                              
                                 t
                              
                              
                                 D
                              
                           
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                         at smaller scales; increasing t improves the distribution and smoothness of the level sets. We also notice that the smoothness of the weighted diffusion kernel is preserved among all the scales. Decreasing the time parameter t reduces the support size of 
                           
                              
                                 F
                              
                              
                                 k
                              
                           
                           (
                           ·
                           ,
                           t
                           )
                         (c.f., Eq. (8)). A higher resolution of 
                           M
                         improves the quality of the level sets of the solution, which are uniformly distributed around the anchor point p. On the contrary, the smoothness of the solution computed with respect to the weighted scalar product is guaranteed through all the scales in spite of the discretization of 
                           M
                        . Finally, Fig. 6
                         shows the behavior of the basis function 
                           
                              
                                 K
                              
                              
                                 t
                              
                           
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                         on almost isometric shapes.


                        Executable paper
                        
                           3
                        
                        
                           3
                           
                              https://collage.elsevier.com/collage/template?doi=10.0000/1352476045780.
                        : For the tests in Figs. 4–6, the reader can run the experiment Diffusion_basis.exp.xml, which computes the approximation 
                           
                              
                                 F
                              
                              
                                 k
                              
                           
                           (
                           ·
                           ,
                           t
                           )
                         in Eq. (8) associated to a pre-defined anchor point 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                        . As input, the user must select the off file of the input shape; a discretization of the Laplace–Beltrami operator among three possible choices (i.e., cotangent, Voronoi-cot, FEM weights); the value t of the time parameter; and the k number of Laplacian eigenfunctions. The default experiment computes the basis function on the 3-torus with 100 linear FEM Laplacian eigenpairs and t=0.5. The level sets and colormap of the basis function are displayed in diffusion-basis.png and stored in diffusion-basis.wrl. Finally, the diffusion basis function is stored in diffusion-basis.txt.

Analyzing the spectral representation of the commute time, bi-harmonic, and heat diffusion distances, we show that they can be represented in a unified way through the definition of the filtered spectral distance (Section 5.1). Then, we focus our discussion on the linear FEM heat diffusion distances (Section 5.2).

Using the generalized eigensystem 
                           
                              
                                 {
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                         of the couple (L,B) and a positive filter map 
                        
                           φ
                           :
                           R
                           →
                           R
                        , we introduce the matrix operator 
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       φ
                                    
                                 
                                 :
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                                 ⟶
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 f
                                 ↦
                                 
                                    
                                       L
                                    
                                    
                                       φ
                                    
                                 
                                 f
                                 ≔
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 φ
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 〈
                                 f
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       〉
                                    
                                    
                                       B
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 .
                              
                           
                        
                     

For any 
                           f
                           ∈
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        , 
                           
                              
                                 L
                              
                              
                                 φ
                              
                           
                           f
                         is a filtered version of the input map f, where the filter coefficients 
                        
                           
                              
                                 (
                                 φ
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 )
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                         in Eq. (9) are the values of the filter map at the Laplacian eigenvalues. Since 
                           
                              
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                         is an orthonormal basis with respect to the scalar product induced by the mass matrix B, any function f is uniquely represented as 
                           f
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                           〈
                           f
                           ,
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           
                              
                                 〉
                              
                              
                                 B
                              
                           
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                         and 
                           L
                           f
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           〈
                           f
                           ,
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           
                              
                                 〉
                              
                              
                                 B
                              
                           
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                         is the spectral representation of 
                           L
                           f
                        . According to these relations, choosing 
                           φ
                           (
                           t
                           )
                           ≔
                           1
                         or 
                           φ
                           (
                           t
                           )
                           ≔
                           t
                         the (discrete) operator 
                           
                              
                                 L
                              
                              
                                 φ
                              
                           
                         is equal to the identity operator or to the Laplacian matrix. Indeed, the filter map acts on the Laplacian eigenvalues in such a way that specific aspects of f are enhanced, smoothed, or removed.

Given the operator 
                           
                              
                                 L
                              
                              
                                 φ
                              
                           
                         in Eq. (9) and the input function 
                           f
                           :
                           M
                           →
                           R
                        , let us introduce the generalized inhomogeneous problem 
                        
                           
                              
                                 L
                              
                              
                                 φ
                              
                           
                           u
                           =
                           f
                        . This equation reduces to the harmonic equation by selecting 
                           φ
                           (
                           t
                           )
                           ≔
                           t
                        , 
                           f
                           ≔
                           0
                        , and 
                           
                              
                                 L
                              
                              
                                 φ
                              
                           
                         allows us to introduce the generalized Green kernel, together with the corresponding distances on 
                           M
                        . Using the relations 
                           
                              
                                 u
                                 ≔
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 f
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 〈
                                 f
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       〉
                                    
                                    
                                       B
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                              
                           
                        the generalized inhomogeneous problem is rewritten as 
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 φ
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 〈
                                 f
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       〉
                                    
                                    
                                       B
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 .
                              
                           
                        Computing the B-scalar product of both sides of this equation with the Laplacian eigenvectors, we get that each coefficient is 
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                           =
                           〈
                           f
                           ,
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           
                              
                                 〉
                              
                              
                                 B
                              
                           
                           /
                           φ
                           (
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           )
                        , i=1,…,n. Then, the spectral representation of the solution to the generalized inhomogeneous problem is 
                           
                              
                                 u
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       〈
                                       f
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             〉
                                          
                                          
                                             B
                                          
                                       
                                    
                                    
                                       φ
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 GB
                                 f
                                 ,
                              
                           
                        where the generalized Green kernel matrix is defined as
                           
                              (10)
                              
                                 G
                                 ≔
                                 X
                                 
                                    
                                       Γ
                                    
                                    
                                       †
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       T
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       Γ
                                    
                                    
                                       †
                                    
                                 
                                 ≔
                                 diag
                                 
                                    
                                       (
                                       
                                          
                                             φ
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 .
                              
                           
                        Assuming that 
                           φ
                           :
                           R
                           →
                           R
                         is a strictly positive function, let us now introduce the filtered spectral distance
                        
                           
                              (11)
                              
                                 d
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 ≔
                                 
                                    
                                       [
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             |
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             
                                                
                                                   |
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             φ
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                       ]
                                    
                                    
                                       1
                                       /
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 ∈
                                 M
                                 ,
                              
                           
                        where 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           :
                           M
                           →
                           R
                         is the piecewise linear map associated to the Laplacian eigenvector 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           ≔
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                 
                                 )
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                        , i.e., 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           (
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                           )
                           =
                           
                              
                                 x
                              
                              
                                 k
                              
                              
                                 (
                                 i
                                 )
                              
                           
                        .

According to the representation (11), diffusion, commute time, and bi-harmonic distances are achieved by selecting the following filters (Fig. 7
                        ):
                           
                              (12)
                              
                                 φ
                                 (
                                 s
                                 )
                                 ≔
                                 {
                                 
                                    
                                       
                                          exp
                                          (
                                          −
                                          st
                                          )
                                       
                                       
                                          diffusion
                                          
                                          distance
                                          ,
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          commute
                                          
                                          time
                                          
                                          distance
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          bi
                                          -
                                          harmonic
                                          
                                          distance
                                          .
                                       
                                    
                                 
                              
                           
                        Our interest on this formulation is motivated by its generalization of spectral distances and the possibility of adapting the filter function 
                           φ
                         to the distribution of the Laplacian eigenvalues. Through specific choices of 
                           φ
                        , local and global details of 
                           M
                         at different scales are identified in a way similar to the selection of the exponential and bi-harmonic weights.

Firstly, we show that 
                           d
                           (
                           ·
                           ,
                           ·
                           )
                         is a metric on 
                           M
                        . The positivity and symmetry of this distance are a direct consequence of the definition. For the nullity property, we notice that 
                           
                              
                                 d
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 =
                                 0
                                 ⟺
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 ,
                                 
                                 ∀
                                 k
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             e
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 0
                                 ,
                                 ∀
                                 k
                                 ,
                                 ⟺
                                 i
                                 =
                                 j
                                 .
                              
                           
                        The triangular inequality is verified as follows:
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       |
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       
                                          
                                             |
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       φ
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                                 ≤
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       [
                                       |
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       r
                                       )
                                       
                                          
                                             |
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       |
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       r
                                       )
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       
                                          
                                             |
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                    
                                       φ
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 r
                                 )
                                 +
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 r
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 ,
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 r
                                 ∈
                                 N
                                 .
                              
                           
                        Rewriting the generalized Green kernel matrix as 
                           
                              
                                 G
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 ≔
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       φ
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                                 ,
                                 
                                 i
                                 ,
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                           
                        The distance (11) is expressed in terms of G as
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 ≔
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       |
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       
                                          
                                             |
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       φ
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       |
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       
                                          
                                             |
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       φ
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                 
                                 −
                                 2
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       φ
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       |
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       
                                          
                                             |
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       φ
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       =
                                    
                                    
                                       (
                                       10
                                       )
                                    
                                 
                                 G
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 −
                                 2
                                 G
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 +
                                 G
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 .
                              
                           
                        Considering the embedding 
                           
                              
                                 E
                                 :
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 ⟶
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ↦
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             φ
                                          
                                          
                                             1
                                             /
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                        of the vertices of 
                           M
                         to 
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        , the filtered spectral distance between 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                         is equal to the B-norm of the embedded points 
                           E
                           (
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                           )
                        , 
                           E
                           (
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                           )
                        , i.e., 
                           d
                           (
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                           )
                           =
                           ∥
                           E
                           (
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                           )
                           −
                           E
                           (
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                           )
                           
                              
                                 ∥
                              
                              
                                 B
                              
                           
                        . Finally, the generalized spectral function is defined as 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                           ∈
                           M
                           ↦
                           G
                           (
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                           )
                        ; if 
                           φ
                         is the exponential map, then we get the auto-diffusion functions introduced in [23] for shape analysis.


                        Computation of the filtered spectral distance: To make the computation of the generalized filtered distance feasible and tractable in real applications, the sum (11) is truncated by considering only the contribution related to the first k eigenpairs, i.e.,
                           
                              (13)
                              
                                 d
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 ≔
                                 
                                    
                                       [
                                       
                                          
                                             ∑
                                          
                                          
                                             l
                                             =
                                             1
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             |
                                             
                                                
                                                   x
                                                
                                                
                                                   l
                                                
                                             
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   l
                                                
                                             
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             
                                                
                                                   |
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             φ
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   l
                                                
                                             
                                             )
                                          
                                       
                                       ]
                                    
                                    
                                       1
                                       /
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 ∈
                                 M
                                 .
                              
                           
                        Indeed, the discretization of the Laplace–Beltrami operator, the filter 
                           φ
                        , the number k of the eigenpairs, and the points 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                        , 
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                         will affect the value 
                           d
                           (
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                           )
                        .


                        Selection of the filter map: Comparing the results on the smooth and irregularly sampled data highlights that the diffusion (Fig. 8
                        ), bi-harmonic (Fig. 9
                        ), and commute time (Fig. 10
                        ) distances have an analogous behavior, in terms of the shape and distribution of the corresponding level sets and colormaps. A similar discussion applies to the stability of the diffusion function and distance with respect to a change in the number of the eigenfunctions used in Eq. (13), noisy and irregularly sampled data (Fig. 11
                        ). All these results confirm that the generalized eigensystem provides good results in terms of smoothness and distribution of the level sets with respect to uneven sampling densities, which are not affected by different resolutions of local areas of the input shape. Furthermore, increasing the number of generalized eigenvectors improves the quality of the approximation; on the contrary, a larger number of standard eigenvectors result in a noisy map without improvements on the approximation accuracy and smoothness. In Fig. 12
                        , we compare the 
                           
                              
                                 L
                              
                              
                                 ∞
                              
                           
                         error 
                           
                              
                                 ϵ
                              
                              
                                 ∞
                              
                           
                         (y-axis) between the analytical heat diffusion kernel on the torus with different discretizations of the Laplace–Beltrami operator and number k (x-axis) of eigenpairs. For small values of t, increasing k reduces the approximation error 
                           
                              
                                 ϵ
                              
                              
                                 ∞
                              
                           
                         until it becomes almost constant and close to zero. In fact, in this case the behavior of the kernel is mainly influenced by the Laplacian eigenvectors related to smaller eigenvalues. Fig. 13
                         shows the robustness of the biharmonic distance from a source (black) point, which has been computed using the linear FEM mass matrix as weight, with respect to tiny and locally missing triangles, noise, holes.

Starting from the filter functions in Eq. (12), we can design new distances; the main constraint is that 
                           φ
                         is strictly positive. The condition 
                           
                              
                                 lim
                              
                              
                                 s
                                 →
                                 +
                                 ∞
                              
                           
                           φ
                           (
                           s
                           )
                           =
                           0
                         guarantees the smoothness of the resulting distance and a good approximation accuracy with the truncated approximation (13). On one hand, the effects of the Laplacian eigenvalues of larger magnitude are enhanced by selecting 
                           φ
                         as an increasing function such as a polynomial map 
                           φ
                           (
                           s
                           )
                           ≔
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                        , 
                           k
                           ≥
                           1
                        . On the other hand, 
                           φ
                           (
                           s
                           )
                           ≔
                           
                              
                                 [
                                 
                                    
                                       ∏
                                    
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 (
                                 s
                                 −
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ]
                              
                              
                                 −
                                 1
                              
                           
                         suppresses the contribution of the eigenvectors related to a specific set 
                           
                              
                                 {
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                                 }
                              
                              
                                 k
                                 ∈
                                 I
                              
                           
                        , 
                           I
                           ⊆
                           {
                           1
                           ,
                           …
                           ,
                           n
                           }
                        , of eigenvalues. The filter map 
                           φ
                           :
                           R
                           →
                           R
                         must be chosen in such a way that the effects of the Laplacian eigenvalues and eigenfunctions are balanced in order to measure both local and global properties of the input shape. A simple way to generate new filters is to compute a convex combination of the maps in Eq. (12). For instance (Fig. 14
                        ), 
                           
                              
                                 φ
                              
                              
                                 t
                              
                           
                           (
                           s
                           )
                           ≔
                           (
                           1
                           −
                           λ
                           )
                           exp
                           (
                           −
                           st
                           )
                           +
                           λ
                           
                              
                                 s
                              
                              
                                 2
                              
                           
                        , 
                           0
                           ≤
                           λ
                           ≤
                           1
                        , is associated to a set of spectral distances that are closer to the diffusion or the bi-harmonic distance as much as 
                           λ
                         is closer to 0 or 1.


                        Executable paper
                        
                           4
                        
                        
                           4
                           
                              https://collage.elsevier.com/collage/template?doi=10.0000/1352476136186.
                        : For the tests in Figs. 8–10, the reader can run the experiment Spectral_distances.exp.xml, which computes the approximation 
                           d
                           (
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                           )
                        , j=1,…,n, in Eq. (13) between a pre-defined anchor point 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                         and all the points of the input triangle mesh. The user must select the off file of the input shape; one spectral distance among three possible choices (i.e., diffusion, bi-harmonic, commute time distances); the value t of the time parameter for the diffusion distance; and the k number of Laplacian eigenpairs. The default experiment computes the bi-harmonic distance on the 3-torus with 100 linear FEM Laplacian eigenpairs. Then, the colormap and level sets of the computed distance are stored in filtered-spectral-distance.wrl and displayed in filtered-spectral-distance.png. The array of the values of the spectral distance is stored in filtered-spectral-distance.txt.

For the wFEM heat kernel, the diffusion distances cannot be defined by decomposing K
                        
                           t
                         as 
                           
                              
                                 Y
                              
                              
                                 T
                              
                           
                           Y
                         or 
                           
                              
                                 Y
                              
                              
                                 T
                              
                           
                           BY
                        ; in fact, K
                        
                           t
                         is no longer symmetric. However, the self-adjointness of K
                        
                           t
                         with respect to the scalar product 
                           〈
                           ·
                           ,
                           ·
                           
                              
                                 〉
                              
                              
                                 B
                              
                           
                         allows us to introduce a time-depending scalar product 
                           〈
                           ·
                           ,
                           ·
                           
                              
                                 〉
                              
                              
                                 t
                              
                           
                        , which is induced by a symmetric, positive definite matrix S
                        
                           t
                        . To this end, the entries of the matrix S
                        
                           t
                         are rewritten as 
                           
                              
                                 S
                              
                              
                                 t
                              
                           
                           (
                           i
                           ,
                           j
                           )
                           ≔
                           〈
                           
                              
                                 h
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 h
                              
                              
                                 j
                              
                              
                                 t
                              
                           
                           
                              
                                 〉
                              
                              
                                 B
                              
                           
                        .

In 
                           F
                           (
                           M
                           )
                        , we introduce the time-depending scalar product
                           
                              (14)
                              
                                 〈
                                 f
                                 ,
                                 g
                                 
                                    
                                       〉
                                    
                                    
                                       t
                                    
                                 
                                 ≔
                                 〈
                                 
                                    
                                       K
                                    
                                    
                                       t
                                    
                                 
                                 f
                                 ,
                                 g
                                 
                                    
                                       〉
                                    
                                    
                                       B
                                    
                                 
                                 =
                                 〈
                                 f
                                 ,
                                 
                                    
                                       K
                                    
                                    
                                       t
                                    
                                 
                                 g
                                 
                                    
                                       〉
                                    
                                    
                                       B
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       BXD
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       T
                                    
                                 
                                 B
                                 g
                                 ,
                              
                           
                        
                        
                           f
                           ,
                           g
                           ∈
                           F
                           (
                           M
                           )
                        . Firstly, we show that 
                           
                              
                                 K
                              
                              
                                 t
                              
                           
                           ≔
                           
                              
                                 XD
                              
                              
                                 t
                              
                           
                           
                              
                                 X
                              
                              
                                 T
                              
                           
                           B
                         is self-adjoint with respect to 
                           〈
                           ·
                           ,
                           ·
                           
                              
                                 〉
                              
                              
                                 B
                              
                           
                         (i.e., 
                           〈
                           
                              
                                 K
                              
                              
                                 t
                              
                           
                           f
                           ,
                           g
                           
                              
                                 〉
                              
                              
                                 B
                              
                           
                           =
                           〈
                           f
                           ,
                           
                              
                                 K
                              
                              
                                 t
                              
                           
                           g
                           
                              
                                 〉
                              
                              
                                 B
                              
                           
                        , 
                           f
                           ,
                           g
                           ∈
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        ). In fact, for any 
                           f
                           ,
                           g
                           ∈
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                         
                        
                           
                              
                                 〈
                                 f
                                 ,
                                 g
                                 
                                    
                                       〉
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 〈
                                 
                                    
                                       K
                                    
                                    
                                       t
                                    
                                 
                                 f
                                 ,
                                 g
                                 
                                    
                                       〉
                                    
                                    
                                       B
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       BXD
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       T
                                    
                                 
                                 B
                                 g
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       BK
                                    
                                    
                                       t
                                    
                                 
                                 g
                                 =
                                 〈
                                 f
                                 ,
                                 
                                    
                                       K
                                    
                                    
                                       t
                                    
                                 
                                 g
                                 
                                    
                                       〉
                                    
                                    
                                       B
                                    
                                 
                                 .
                              
                           
                        To verify that the scalar product in (14) is well-posed, we show that the matrix 
                           
                              
                                 S
                              
                              
                                 t
                              
                           
                           ≔
                           
                              
                                 BXD
                              
                              
                                 t
                              
                           
                           
                              
                                 X
                              
                              
                                 T
                              
                           
                           B
                         is symmetric and positive definite. From the identity 
                           
                              
                                 S
                              
                              
                                 t
                              
                           
                           
                              
                                 =
                              
                              
                                 (
                                 4
                                 )
                              
                           
                           
                              
                                 X
                              
                              
                                 −
                                 T
                              
                           
                           
                              
                                 D
                              
                              
                                 t
                              
                           
                           
                              
                                 X
                              
                              
                                 −
                                 1
                              
                           
                        , we get that S
                        
                           t
                         is symmetric with strictly positive eigenvalues 
                           
                              
                                 (
                                 exp
                                 (
                                 −
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 t
                                 )
                                 )
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                        ; indeed, S
                        
                           t
                         is also positive definite.

The self-adjointness of K
                        
                           t
                         with respect to the mass matrix B allows us to rewrite the entries of the matrix S
                        
                           t
                         in terms of the scalar product 
                           〈
                           ·
                           ,
                           ·
                           
                              
                                 〉
                              
                              
                                 B
                              
                           
                         as 
                           
                              
                                 S
                              
                              
                                 t
                              
                           
                           (
                           i
                           ,
                           j
                           )
                           =
                           〈
                           
                              
                                 h
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 h
                              
                              
                                 j
                              
                              
                                 t
                              
                           
                           
                              
                                 〉
                              
                              
                                 B
                              
                           
                        , 
                           
                              
                                 h
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 K
                              
                              
                                 t
                                 /
                                 2
                              
                           
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                        , where the wFEM diffusion maps 
                           
                              
                                 h
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           :
                           M
                           →
                           R
                         is induced by the wFEM heat kernel K
                        
                           t
                         (c.f., Section 4.2). In fact,
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       BXD
                                    
                                    
                                       t
                                       /
                                       2
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       t
                                       /
                                       2
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       T
                                    
                                 
                                 B
                                 =
                                 
                                    
                                    
                                       (
                                       4
                                       )
                                    
                                 
                                 
                                    
                                       BXD
                                    
                                    
                                       t
                                       /
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       T
                                    
                                 
                                 BX
                                 )
                                 
                                    
                                       D
                                    
                                    
                                       t
                                       /
                                       2
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       T
                                    
                                 
                                 B
                                 =
                                 
                                    
                                       Y
                                    
                                    
                                       T
                                    
                                 
                                 BY
                                 ,
                                 Y
                                 ≔
                                 
                                    
                                       XD
                                    
                                    
                                       t
                                       /
                                       2
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       T
                                    
                                 
                                 B
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       t
                                       /
                                       2
                                    
                                 
                                 ,
                              
                           
                        and therefore 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 〈
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       〉
                                    
                                    
                                       B
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 ≔
                                 
                                    
                                       K
                                    
                                    
                                       t
                                       /
                                       2
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 .
                              
                           
                        Indeed, the wFEM diffusion distances
                           
                              (15)
                              
                                 ∥
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 −
                                 
                                    
                                       h
                                    
                                    
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       t
                                       /
                                       2
                                    
                                 
                                 (
                                 i
                                 ,
                                 i
                                 )
                                 −
                                 2
                                 
                                    
                                       K
                                    
                                    
                                       t
                                       /
                                       2
                                    
                                 
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 +
                                 
                                    
                                       K
                                    
                                    
                                       t
                                       /
                                       2
                                    
                                 
                                 (
                                 j
                                 ,
                                 j
                                 )
                              
                           
                        are uniquely defined by the entries of the matrix K
                        
                           t
                        . Finally, we show that the wFEM diffusion distance of the Laplacian eigenfunctions 
                           
                              
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                         is 
                           ∥
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           −
                           
                              
                                 x
                              
                              
                                 j
                              
                           
                           
                              
                                 ∥
                              
                              
                                 t
                              
                              
                                 2
                              
                           
                           =
                           exp
                           (
                           −
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           t
                           )
                           +
                           exp
                           (
                           −
                           
                              
                                 λ
                              
                              
                                 j
                              
                           
                           t
                           )
                        , 
                           i
                           ≠
                           j
                        . To this end, we notice that 
                           
                              
                                 〈
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       〉
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 〈
                                 
                                    
                                       K
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       〉
                                    
                                    
                                       B
                                    
                                 
                                 =
                                 〈
                                 exp
                                 (
                                 −
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 t
                                 )
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       〉
                                    
                                    
                                       B
                                    
                                 
                                 =
                                 exp
                                 (
                                 −
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 t
                                 )
                                 
                                    
                                       δ
                                    
                                    
                                       ij
                                    
                                 
                                 .
                              
                           
                        
                     

It follows that the entry 
                           
                              
                                 S
                              
                              
                                 t
                              
                           
                           (
                           i
                           ,
                           j
                           )
                         can be interpreted as the scalar product between the (discrete) embedding 
                           
                              
                                 h
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                        , 
                           
                              
                                 h
                              
                              
                                 j
                              
                              
                                 t
                              
                           
                         of 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                        , 
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                         in 
                           F
                           (
                           M
                           )
                         induced by the wFEM heat diffusion matrix. Furthermore, the distance (15) is uniquely determined by the entries of the kernel matrix. The aforementioned properties apply to the wFEM heat kernel and are analogous to those that hold in the continuous case. This analogy confirms that the proposed discretization and the choice of the intrinsic scalar product 
                           〈
                           ·
                           ,
                           ·
                           
                              
                                 〉
                              
                              
                                 B
                              
                           
                         in 
                           F
                           (
                           M
                           )
                         maintain the main features of the heat diffusion kernel, together with a higher robustness to data discretization with respect to previous work.

@&#CONCLUSIONS AND FUTURE WORK@&#

Through the executable paper, we have provided a set of experiments on the discretization and main properties of the harmonic and bi-harmonic functions, the Laplacian eigenfunctions, and the solution to the heat diffusion equation, together with the corresponding bi-harmonic, commute time, and diffusion distances. This analysis has been based on the selection of different Laplacian weights, input shapes, transformations, initial boundary conditions, and source points. Analyzing the spectral representation of the aforementioned distances, we have shown that they can be represented in a unified way through a filtering of the Laplacian eigenpairs. Finally, adapting this filtering to the distribution of the Laplacian eigenvalues allow us to identify local and global details the input shape.

@&#ACKNOWLEDGMENTS@&#

Special thanks are given to the anonymous Reviewers for their valuable comments, which helped us to improve the presentation and content of the paper, and to the Collage Support Team, in particular to Daniel Harezlak, for their help in the preparation of the experiments included in the paper. This work has been partially supported by the Research Project “Methods and Techniques for the Development of Innovative Systems for Modeling and Analyzing Biomedical Data for Supporting Assisted Diagnosis”, PO CRO Programme, European Social Funding Scheme, Regione Liguria, and the FP7 Marie Curie Initial Training Networks MultiScaleHuman – “Multi-scale Biological Modalities for Physiological Human Articulation”. 3D shapes are courtesy of the AIM@SHAPE Repository and the EPFL Computer Graphics and Geometry Laboratory.

Supplementary data associated with this article can be found in the online version at 10.1016/j.cag.2013.03.006.

Note from publisher: this material was originally submitted as part of the Collage Executable Paper pilot, please visit http://www.elsevier.com/executablepaper for more information.


                     
                        
                           
                              Note from publisher: this material was originally submitted as part of the Collage Executable Paper pilot, please visit http://www.elsevier.com/executablepaper for more information.
                           
                           
                        
                     
                  


                     
                        
                           
                              Note from publisher: this material was originally submitted as part of the Collage Executable Paper pilot, please visit http://www.elsevier.com/executablepaper for more information.
                           
                           
                        
                     
                  


                     
                        
                           
                              Note from publisher: this material was originally submitted as part of the Collage Executable Paper pilot, please visit http://www.elsevier.com/executablepaper for more information.
                           
                           
                        
                     
                  


                     
                        
                           
                              Note from publisher: this material was originally submitted as part of the Collage Executable Paper pilot, please visit http://www.elsevier.com/executablepaper for more information.
                           
                           
                        
                     
                  

@&#REFERENCES@&#

