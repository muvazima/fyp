@&#MAIN-TITLE@&#A dynamic paired comparisons model: Who is the greatest tennis player?

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We derive a closed-form for Stern’s continuum of paired comparisons models.


                        
                        
                           
                           We allow for time-varying strength in our model using barycentric rational interpolants (BRIs).


                        
                        
                           
                           We show that BRIs perform better than spline interpolation.


                        
                        
                           
                           We fit our dynamic paired comparisons model to results of tennis Grand Slam tournaments.


                        
                        
                           
                           Results suggest the greatest tennis player of the Open-Era is Roger Federer with Bjorn Borg and Jimmy Connors close behind.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in sports

Ranking

Rating

Bradley–Terry

Thurstone–Mosteller

Barycentric interpolation

@&#ABSTRACT@&#


               
               
                  We present a methodology for fitting time-varying paired comparisons models in which the parameters are allowed to vary deterministically, as opposed to stochastically, with time. Our dynamic paired comparisons model is based on a new closed-form for Stern’s continuum of paired comparisons models which include the Bradley–Terry model and the Thurstone–Mosteller model. The dynamic element of our model is facilitated by utilising barycentric rational interpolants BRIs. An incidental result of our work is to show that BRIs often provide a better fit to data than the obvious alternative of spline interpolation. We use our model to shed light on the debate of who is the greatest tennis player of the Open Era of men’s professional tennis since 1968. Constructing a single rankings list from our model is not trivial as there are many alternative metrics that could be used to identify which player was the best ever. We present three alternative rankings lists derived from our model. In general our rankings lists largely agree with the rankings list based on number of Grand Slam titles won, which, to some extent, validates our choice of metrics. So who is the greatest tennis player of the Open Era? Roger Federer seems like the most likely candidate, with Bjorn Borg and Jimmy Connors close behind.
               
            

@&#INTRODUCTION@&#

Rankings models arise in many applications in quantitative analysis. From assessing University league tables, to modelling individual choice behaviour (Luce, 1959) to rankings of rival candidates in elections (Gormley & Murphy, 2008) to ranking countries’ performances at the Olympics (Sitarz, 2012), applications of rankings models are widespread. In this paper we concentrate on models for paired comparisons (when many competitors compete in a series of head-to-head competitions) and extend these models to allow for time-varying competitor strengths.

Paired comparisons models are formulated so that each competitor being compared is associated with a strength parameter, 
                        
                           α
                        
                     . The probability of one competitor beating another is then given by a function of the ratio of the strength parameters of the two competitors in question. More generally, the probability, 
                        
                           
                              
                                 p
                              
                              
                                 ij
                              
                           
                        
                     , that competitor i beats competitor j, is given by 
                        
                           
                              
                                 p
                              
                              
                                 ij
                              
                           
                           =
                           F
                           (
                           
                              
                                 μ
                              
                              
                                 i
                              
                           
                           -
                           
                              
                                 μ
                              
                              
                                 j
                              
                           
                           )
                        
                     , where 
                        
                           
                              
                                 μ
                              
                              
                                 i
                              
                           
                           =
                           ln
                           (
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                           )
                        
                     , and F is a distribution function. The Bradley–Terry (BT) model (Bradley & Terry, 1952) assumes a logistic distribution for F, and the Thurstone–Mosteller (TM) model (Thurstone, 1927) uses a normal distribution. In terms of the strength parameters, the formulae are respectively 
                        
                           
                              
                                 p
                              
                              
                                 ij
                              
                           
                           =
                           
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                           
                        
                     , and 
                        
                           
                              
                                 p
                              
                              
                                 ij
                              
                           
                           =
                           Φ
                           
                              
                                 
                                    ln
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     , where 
                        
                           Φ
                        
                      is the standard normal distribution function.


                     Stern (1990) gives a formula for the probability of a ranking based on a gamma distribution for the underlying times to an event. These times can be thought of as the time for each competitor to run a race in which the quickest wins. One can also consider the random variable to be a score, where the player with the lowest score wins, as in golf. For Stern’s model,
                        
                           (1)
                           
                              
                                 
                                    p
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    ∞
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              (
                              x
                              )
                              
                                 
                                    S
                                 
                                 
                                    j
                                 
                              
                              (
                              x
                              )
                              
                              d
                              x
                              =
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    ∞
                                 
                              
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              (
                              x
                              )
                              
                                 
                                    f
                                 
                                 
                                    j
                                 
                              
                              (
                              x
                              )
                              
                              d
                              x
                              ,
                           
                        
                     where f is the pdf 
                        
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                           (
                           x
                           )
                           =
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                           
                              
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 x
                                 )
                              
                              
                                 β
                                 -
                                 1
                              
                           
                           exp
                           (
                           -
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                           x
                           )
                           /
                           Γ
                           (
                           β
                           )
                        
                      of the gamma distribution, 
                        
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                        
                      the survival function and 
                        
                           
                              
                                 F
                              
                              
                                 i
                              
                           
                        
                      the distribution function. When 
                        
                           β
                           =
                           1
                        
                      the model reduces to the BT model. Stern (1990) shows how his ‘gamma comparison model’ interpolates between the BT model and the TM model as 
                        
                           β
                           →
                           ∞
                        
                      and refers to the model as a continuum of paired comparison models. This is clearly a useful model, but Stern (1992) concludes that for samples of the size usually encountered, predictions are not sensitive to the value of 
                        
                           β
                        
                     . However, as we will see, given our large dataset, we can revisit this problem and see whether it is now possible to determine which value of 
                        
                           β
                        
                      fits the data best.

The gamma comparison model given in (1) is static in that the strengths of the competitors do not change over time. However, in many applications, time invariant strengths are not appropriate. For example, when modelling in sport, it is unreasonable to assume that team (or player) strengths are constant. Similarly when modelling consumer preferences for brands, changing fashions dictate brand strengths and they are unlikely to be constant over time. In response, more recent work on modelling paired comparisons has concentrated on extending models to allow for time-varying, or dynamic, paired comparisons. For example, Glickman (1999) presents an approximate Bayesian updating algorithm for estimating dynamic strength parameters of the Bradley–Terry model. The parameters evolve stochastically and he uses the model to construct a list of the best chess players of all time, together with a rankings table of the then current tennis players. Knorr-Held (2000) presents a methodology, based on a model that is more general than the Bradley–Terry model, to estimate stochastically evolving team strengths.

All previous work on dynamic paired-comparisons models employs a stochastic evolution of the strength parameters. There are however, situations when one can justify modelling the evolution of strength parameters deterministically. For individual sports such as tennis, where players compete as individuals, there is clearly a strong systematic component to the evolution of their strength. Typically, as we shall see, a player’s strength increases in the early part of their career, reaches a peak and then slowly declines until the player withdraws from competing. We believe it is more appropriate to model this strength so that it varies smoothly over a player’s career and hence a deterministic evolution is applicable. Undoubtedly a stochastic element is present, for example when a player is injured. However, injured players normally stop competing until largely recovered. In either case, the contribution of the deterministic component to strength evolution surely outweighs that of the stochastic element.

When modelling in individual sports, we therefore propose using a paired comparisons model that allows for a deterministic evolution of player strengths. In this paper we first present a closed form for Stern’s gamma comparison model and then extend it to allow for time-varying strength parameters for each competitor utilising barycentric rational interpolants. We choose to demonstrate our model using a rich and interesting data set: the results of tennis matches from men’s professional tennis Grand Slam tournaments since 1968, and look for an answer to the question: who is the greatest player of all-time?

The paper is organised as follows: Section 2 presents a closed form for Stern’s gamma comparison model. Section 3 describes our time-varying paired comparisons model with two tennis-motivated extensions to the model given in Section 4. Results from fitting the model to tennis data are given in Section 5, and Section 6 concludes the paper with some closing remarks.


                     Stern (1990) presents a model that generalises the BT and TM paired comparisons models in two aspects: first, it incorporates both the BT and TM models and all models inbetween, and second, it generalises paired comparisons to the case of multiple comparisons, of which the Plackett–Luce model (Plackett, 1975) is a notable member. In this paper we consider the case of paired comparisons only and show that, for this special case of Stern’s model, that it is possible to obtain the probability that player i wins as the distribution function of a symmetric beta distribution. We generalise Stern’s model slightly first, to allow players i and j to have different shape parameters 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                        
                      and 
                        
                           
                              
                                 β
                              
                              
                                 j
                              
                           
                        
                     . The result we use to derive our closed form parameterisation is that the ratio of two gamma-distributed random variables follows a modified beta distribution (see Johnson, Kotz, & Balakrishnan, 1994).

On standardising the random variables in (1), we have
                        
                           
                              
                                 
                                    p
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    ∞
                                 
                              
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                    /
                                    
                                       
                                          α
                                       
                                       
                                          j
                                       
                                    
                                    s
                                 
                              
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          
                                             
                                                β
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          1
                                       
                                    
                                    exp
                                    (
                                    -
                                    z
                                    )
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                β
                                             
                                             
                                                j
                                             
                                          
                                          -
                                          1
                                       
                                    
                                    exp
                                    (
                                    -
                                    s
                                    )
                                    
                                    d
                                    z
                                    
                                    d
                                    s
                                 
                                 
                                    Γ
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    Γ
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                              .
                           
                        
                     Now set 
                        
                           z
                           =
                           ts
                        
                     ; the Jacobian of the transformation is s, so
                        
                           
                              
                                 
                                    p
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    ∞
                                 
                              
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                    /
                                    
                                       
                                          α
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                β
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                β
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                β
                                             
                                             
                                                j
                                             
                                          
                                          -
                                          1
                                       
                                    
                                    exp
                                    (
                                    -
                                    (
                                    1
                                    +
                                    t
                                    )
                                    s
                                    )
                                    
                                    d
                                    t
                                    
                                    d
                                    s
                                 
                                 
                                    Γ
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    Γ
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                              .
                           
                        
                     We now change the order of integration, which is allowed, as Fubini’s theorem is satisfied. Integrating over s we obtain
                        
                           
                              
                                 
                                    p
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    Γ
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 
                                    Γ
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    Γ
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                    /
                                    
                                       
                                          α
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                β
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          1
                                       
                                    
                                    
                                    d
                                    t
                                 
                                 
                                    
                                       
                                          (
                                          1
                                          +
                                          t
                                          )
                                       
                                       
                                          
                                             
                                                β
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                β
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     and changing variable to 
                        
                           y
                           =
                           t
                           /
                           (
                           1
                           +
                           t
                           )
                        
                      so that 
                        
                           t
                           =
                           y
                           /
                           (
                           1
                           -
                           y
                           )
                        
                      and 
                        
                           d
                           t
                           /
                           d
                           y
                           =
                           
                              
                                 (
                                 1
                                 -
                                 y
                                 )
                              
                              
                                 -
                                 2
                              
                           
                        
                      we obtain
                        
                           (2)
                           
                              
                                 
                                    p
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    Γ
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 
                                    Γ
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    Γ
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                    /
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          α
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    1
                                 
                              
                              
                                 
                                    (
                                    1
                                    -
                                    y
                                    )
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    -
                                    1
                                 
                              
                              
                              d
                              y
                              ,
                           
                        
                     i.e. the probability that player i beats player j is the distribution function of the beta distribution. For Stern’s model, 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 β
                              
                              
                                 j
                              
                           
                           ≡
                           β
                        
                      so that 
                        
                           
                              
                                 p
                              
                              
                                 ij
                              
                           
                        
                      is the distribution function of the symmetric beta distribution. This form of Stern’s model is excellent for computation, as the incomplete beta ratio is a special function that is widely available from software platforms such as fortran, MatLab or R. We believe that analysts fitting paired comparisons models could adopt this generalised model in (2), rather than choosing between the BT or TM model.

We note that it would be possible to fit an individual shape parameter 
                        
                           β
                        
                      for each player, so departing from the class of linear models, for which F must be a symmetric distribution, i.e. 
                        
                           F
                           (
                           -
                           x
                           )
                           =
                           1
                           -
                           F
                           (
                           x
                           )
                        
                     . However, for the present we restrict ourselves to a common value of 
                        
                           β
                        
                      for all players.

Our approach to allow for time-varying strengths, such that 
                        
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                           →
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                           (
                           t
                           )
                        
                      in (2), is to estimate strength parameters at each of several nodes for every player and then interpolate between the nodes to obtain values of a player’s strength at any point during his career. The choice of the number of nodes is described below. The obvious methodology to adopt for the interpolation would be spline interpolation. However, we find that barycentric rational interpolants (BRI) (Floater & Hormann, 2007; Press, Teukolsky, Vetterling, & Flannery, 2007) provide a more accurate fit in general, and have the added advantage of being simpler.

The time-varying strength is modelled using the barycentric rational interpolant, so that the strength of player i at time t is given by
                        
                           (3)
                           
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          ik
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          ik
                                       
                                    
                                    /
                                    (
                                    t
                                    -
                                    
                                       
                                          t
                                       
                                       
                                          ik
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          ik
                                       
                                    
                                    /
                                    (
                                    t
                                    -
                                    
                                       
                                          t
                                       
                                       
                                          ik
                                       
                                    
                                    )
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 λ
                              
                              
                                 ik
                              
                           
                        
                      is the kth fitted strength of player i, i.e. the strength at time 
                        
                           
                              
                                 t
                              
                              
                                 ik
                              
                           
                        
                     . There are 
                        
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                        
                      such nodes for player i, and we discuss the weights 
                        
                           
                              
                                 w
                              
                              
                                 ik
                              
                           
                        
                      next.


                     Berrut (1988) gave weights for a barycentric rational interpolant, where a ratio of polynomials is used to interpolate between the points 
                        
                           
                              
                                 λ
                              
                              
                                 ik
                              
                           
                        
                     . Berrut’s interpolant was free of poles, a potential problem with ratios of polynomials. This approach was developed further by Floater and Hormann (2007) who derived sets of weights giving accuracies of 
                        
                           
                              
                                 h
                              
                              
                                 d
                                 +
                                 1
                              
                           
                        
                      where d is the order of the interpolant and h the largest step size. The weights of order zero are 
                        
                           
                              
                                 w
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 (
                                 -
                                 1
                                 )
                              
                              
                                 k
                              
                           
                        
                     , and weights of order one are
                        
                           
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    (
                                    -
                                    1
                                    )
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                             -
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             -
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     with terms with out-of-range values 
                        
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                        
                      or 
                        
                           
                              
                                 x
                              
                              
                                 n
                                 +
                                 1
                              
                           
                        
                      omitted. For equally-spaced values of 
                        
                           
                              
                                 y
                              
                              
                                 ik
                              
                           
                        
                      the weights are again 
                        
                           
                              
                                 w
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 (
                                 -
                                 1
                                 )
                              
                              
                                 k
                              
                           
                        
                     , but now the end nodes have weight halved. This resembles the halving of end-point weights in the trapezoidal rule for integration formula. The general formula for constructing weights is
                        
                           
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    (
                                    -
                                    1
                                    )
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       k
                                       -
                                       d
                                    
                                    
                                       k
                                    
                                 
                              
                              
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       j
                                       =
                                       i
                                       ,
                                       j
                                       ≠
                                       k
                                    
                                    
                                       i
                                       +
                                       d
                                    
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    |
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    -
                                    
                                       
                                          t
                                       
                                       
                                          j
                                       
                                    
                                    |
                                 
                              
                              ,
                           
                        
                     and Press et al. (2007) give C++ code which is easily adapted to other programming languages. We found that taking 
                        
                           d
                           =
                           0
                        
                      for 
                        
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                           ⩽
                           5
                        
                      and 
                        
                           d
                           =
                           1
                        
                      for 
                        
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                           >
                           5
                        
                      maximised the likelihood of the model fit to data.

It remains to discuss the choice of node positions and number of nodes. This is the same problem faced when fitting spline curves, where knots are usually equally spaced, or sometimes placed at quantiles of the distribution of the variable. We spaced nodes equally over a player’s career, but omitted a node if it had no support, i.e. no matches played within a year either side of it. After some experimentation the formula
                        
                           
                              
                                 
                                    n
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                              +
                              
                                 
                                    Δ
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              +
                              (
                              
                                 
                                    Δ
                                 
                                 
                                    i
                                 
                              
                              /
                              M
                              )
                              (
                              1
                              -
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        
                     was used for the number of nodes for player i, where 
                        
                           
                              
                                 Δ
                              
                              
                                 i
                              
                           
                           +
                           1
                        
                      is the number of playing years for player 
                        
                           i
                           ,
                           M
                           =
                           4
                        
                     , and
                        
                           
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    1
                                    -
                                    exp
                                    (
                                    
                                       
                                          kg
                                       
                                       
                                          i
                                       
                                    
                                    /
                                    
                                       
                                          Δ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    +
                                    exp
                                    (
                                    
                                       
                                          kg
                                       
                                       
                                          i
                                       
                                    
                                    /
                                    
                                       
                                          Δ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 g
                              
                              
                                 i
                              
                           
                        
                      is the total number of games player i played. The choice of a logistic-type function means that 
                        
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                        
                      goes from 0 for players who never play to 1 for players who play a lot and so that 
                        
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                        
                      progresses smoothly from 1 every 4years for players who played few matches, to annual nodes for those who played frequently. 
                        
                           k
                           ≃
                           0.05
                        
                      was chosen to minimise the AIC. This formula is empirical but worked well.

Barycentric rational interpolation will be an unfamiliar technique to many, who will feel that a regression spline is the obvious technique to use. Barycentric rational interpolation, like splines, was developed by numerical analysts seeking to interpolate accurately in tables, and like splines can be used in statistical work. Polynomial interpolants such as the Lagrangian interpolant can be put into barycentric form (e.g., Berrut, 1988). In order to demonstrate the power of BRIs, we performed a series of experiments, fitting both splines and BRIs to a series of simulated data sets. These Monte-Carlo studies on least-squares problems show that BRIs give an accuracy comparable with regression splines, but slightly better. Table 1
                         shows errors for a natural cubic regression spline fit and a 
                           
                              d
                              =
                              1
                           
                         BRI fit to 10 functions to which normally-distributed random errors had been added. BRIs nearly always give a slightly lower error than the spline fit.

In addition to providing a superior fit in our experiment, the barycentric rational interpolation formula is also much simpler than those needed for spline fitting. We believe that BRIs will eventually become the method of choice for statisticians.

Estimation was done using a purpose-written fortran program, that made Newton–Raphson steps using the analytic first and second derivatives of the log-likelihood with respect to each parameter. For this purpose, the (very large) Hessian matrix is taken as diagonal, and so need not be computed. The proposed step size was scaled back from the Newton step, with large steps trimmed back, and backtracking was used if the step did not increase the log-likelihood. The step size was then halved until the likelihood increased.

Because the Hessian is assumed diagonal, the iteration steps are not optimal, and the second-order convergence that prevails near the maximum for Newton-type methods does not hold; we have only first order convergence. Nevertheless, the 
                           
                              p
                              ≃
                              2000
                           
                         parameters could be optimised in only a few minutes. The method is fast because each evaluation of the log-likelihood and its derivatives with respect to the tabulated strengths takes only time of order p. The algorithm performs much better than commercially available programs like the NAG (Numerical Algorithms Group) routine E04VHF, which uses a limited-memory version of the Hessian, storing a few update vectors rather than a matrix. The improvement follows from using analytic second derivatives, which is seldom done in function optimisation. Iteration restarts from random parameter values were used to ensure that the iteration did not get stuck at a local maximum, but that the global maximum was attained.

The approximation of the Hessian as diagonal was only made during the parameter optimisation. Since the inverse of the Hessian, the covariance matrix on the fitted model parameters, is not known, the parametric bootstrap was used to generate 100 bootstrap resamples, and standard errors and significance tests were based on the bootstrap results. The accurate Hessian could have been computed and inverted, but this can be very inaccurate when the matrix is large, as well as being slow.

Because (3) is linear in the tabulated strengths 
                           
                              
                                 
                                    λ
                                 
                                 
                                    ik
                                 
                              
                           
                        , it is straightforward to differentiate the strengths 
                           
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                           
                         and hence the log-likelihood 
                           
                              ℓ
                           
                         with respect to these parameters. We do not give the formulae for the first and second derivatives, as the algebra is trivial although messy. The second derivative need not be computed exactly, and in fact it is better to omit terms that can be positive and so produce a step in the wrong direction; this only happens far from the likelihood maximum.

The parameter 
                           
                              β
                           
                         was determined by a grid-search to be 
                           
                              
                                 
                                    β
                                 
                                 
                                    ˆ
                                 
                              
                              ≃
                              2
                           
                        . Clearly, Stern’s model gives a better fit to the data (higher likelihood function). Subsequent inference was conditioned on this value of 
                           
                              β
                           
                        ; strictly speaking one should maximise the likelihood for 
                           
                              β
                           
                         at each bootstrap resample, but this is computationally difficult, and 
                           
                              β
                           
                         is anyway well determined by the data.

The model presented in Eqs. (2) and (3) can be used to estimate time-varying strengths of objects competing in paired comparisons. We now make two additions to the model to take account of the specifics of tennis and our data.

A tennis match between two players consists of winning points in order to win games, and winning games in order to win sets. In the Grand Slam tournaments that we are analysing here, each match is ‘best-of-5 sets’ and we have information on the games won by both players in each set played. As such, we can model the strength of a player in terms of the final result (win or loss) as would be the norm for a Bradley–Terry model, or, by adapting the model in the same way as McHale and Morton (2011) did, use the game score, or the set score. It seems wasteful to not use the information we have because, for example, a match being won 6-1, 6-0, 6-2 (a large margin of victory) is different from a match being won 7-6, 7-6, 6-7, 6-7, 7-5 (a very close match). However, using the game as the unit of victory can lead to some counter-intuitive results. For example, suppose a player wins a match 7-6, 7-6, 2-6, 7-6. In terms of sets, the player won by 3 sets to 1, but the winner of the match has actually won fewer games than the loser. Although McHale and Morton (2011) found that a games based model performed well for forecasting in the short term (over a year or two), we believe a sets based model for estimating the greatest ever player in tennis is more appropriate. Not least is this because it is often the case in a tennis match that a player will ‘ease up’ for a set and lose it by a large margin so as to conserve energy for the next set. In our example above then, we use the information that the player won the match by 3 sets to 1. Thus, the contribution to the likelihood of the kth match in which the winning player, 
                           
                              
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                           
                        , won 
                           
                              
                                 
                                    s
                                 
                                 
                                    ik
                                 
                              
                           
                         sets and the losing player, 
                           
                              
                                 
                                    j
                                 
                                 
                                    k
                                 
                              
                           
                        , won 
                           
                              
                                 
                                    s
                                 
                                 
                                    ik
                                 
                              
                           
                         sets is
                           
                              
                                 L
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       ij
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ik
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       ji
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             jk
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

As a consequence of the strength of each player being estimated with some error, errors in estimation are ‘reinforced’ as each player’s estimated strength depends on the value of the strength of his competitors. As such, the estimated strengths follow a random walk. To see this, consider a simplified scenario, in which player A plays n matches with player B, who then a time t later plays n matches with C, and so on. If B wins m of the n matches, the strength ratio of B–A is estimated as 
                           
                              m
                              /
                              (
                              n
                              -
                              m
                              )
                           
                        . If C wins s matches, his strength is estimated as 
                           
                              (
                              s
                              /
                              (
                              n
                              -
                              s
                              )
                              )
                              /
                              (
                              m
                              /
                              (
                              n
                              -
                              m
                              )
                              )
                           
                        , and so on. The logarithm of player C’s estimated strength is 
                           
                              ln
                              (
                              s
                              /
                              (
                              n
                              -
                              s
                              )
                              )
                              -
                              ln
                              (
                              m
                              /
                              (
                              n
                              -
                              m
                              )
                              )
                           
                         and this is the start of a random walk of the logarithm of estimated strength with cumulative variance being approximately equal to 
                           
                              n
                              /
                              (
                              m
                              (
                              n
                              -
                              m
                              )
                              )
                              +
                              n
                              /
                              (
                              s
                              (
                              n
                              -
                              s
                              )
                              )
                           
                        . To remove the problem of drift, a small ‘prior’ term was introduced. This could be done in several ways, but to make the meaning of the prior parameter clear, we imagined that each player, at his tabulated strength, played 
                           
                              2
                              δ
                           
                         sets against a hypothetical player having a strength equal to the global average strength. In these contests, each player had won half his sets. Given n tabulated strengths 
                           
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                           
                        , parameter drift is coped with by increasing the log-likelihood 
                           
                              ℓ
                           
                         by
                           
                              
                                 Δ
                                 ℓ
                                 =
                                 δ
                                 (
                                 ln
                                 (
                                 F
                                 (
                                 ln
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 ln
                                 
                                    
                                       λ
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 )
                                 +
                                 ln
                                 (
                                 1
                                 -
                                 F
                                 (
                                 ln
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 ln
                                 
                                    
                                       λ
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 )
                                 )
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    λ
                                 
                                 
                                    ¯
                                 
                              
                           
                         is the mean strength 
                           
                              
                                 
                                    λ
                                 
                                 
                                    ¯
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              /
                              n
                           
                        . To estimate 
                           
                              δ
                           
                        , we increased its value until the average strength per year had stabilised, which was achieved when 
                           
                              δ
                              =
                              0.05
                           
                        .

‘Who is the greatest?’ is an often asked question in sports. In individual sports like tennis and golf, the debate is usually focussed around who has won the most major titles. In tennis, like golf, there are four major tournaments, the Grand Slams, held each year: the Australian Open (now played on a hard court), the French Open (played on a clay court), Wimbledon (played on a grass court) and the US Open (played on a hard court). Table 2
                      shows the all-time list of male players with the most Grand Slam titles.

Roger Federer is clearly a strong candidate for the title of the best ever tennis player, with Pete Sampras in second place. It is worth noting that as a consequence of the Grand Slams being held on different surfaces, and of players specialising in certain surfaces, several of the greats never won a particular tournament. For example, Pete Sampras never won the French Open (a clay court tournament). Despite these complications regarding surface, few tennis fans would argue with the rankings in Table 2.

However, using the number of Grand Slams as the determining factor in identifying the greatest player of all time is problematic for several reasons. The first problem to overcome when comparing players across eras is that each player will have entered a different number of events. For example, in the early part of the 20th Century, travelling to all four tournaments, played on other sides of the world, was no easy task. As such, players in that era played very few of the Grand Slams whilst nowadays the top players will compete in all four of the Grand Slams. This effect is further exacerbated by the fact that until 1968 the Grand Slam tournaments were for amateur tennis players only. As such, prior to the Open Era (post-1968), top players wishing to make a living from tennis would turn professional and not enter the Grand Slam events. The final column of Table 2 gives the total Grand Slam titles per Grand Slam event entered. This is a simple method to try to account for this bias in Table 2.

Other sources of bias are likely to be present in the rankings in Table 2. For example, some players will have played in an era when competition was extremely tough, preventing that player from winning more titles. Conversely, competitors may have been of lower quality than in other eras, so that the strongest player of the era would have won more titles than his ability suggested he should do. Or perhaps a great player had his career cut short by an unfortunate injury, yet for a short period, while he was fit, he was playing the best tennis ever. Correcting for these potential sources of bias is not trivial.

Next we use our time-varying paired comparisons model to investigate the problem of identifying tennis’ all-time greatest player. Using the model has several advantages over Table 2. First, the biases discussed above are automatically corrected for. Second, by using information on margin of victory, the model-based rankings should be able to produce a more accurate table of tennis’ greatest players. Further, our model can be used to identify exactly when, in a player’s career, they were at their peak. Lastly, our model can be used to calculate the inferred probability of one player beating another, even though the two players never played against each other. However, there are additional difficulties in identifying which criteria to use to decide on who is the greatest ever. Before we discuss these, we introduce our data set.

We obtained data from the Grand Slam Tennis Archive, http://www.tennis.ukf.net/, on the results and score lines of all four of men’s Grand Slam events since the Open Era began in 1968 and Wimbledon, the US Open, the Australian Open and the French Open all agreed to allow professional tennis players to compete against amateurs, to the US Open in 2012. Until then the game was somewhat fragmented since top players wanting to earn a living from the game were not allowed to enter the Grand Slam tournaments. This totalled 20,640 matches, 1163 players, and a total of 74,722 sets. For players who played five matches or fewer, we created a single hypothetical player whose career lasts from 1968 to 2012. This universal player has increased his strength slightly over this time – perhaps reflecting the rising strength in-depth of tennis professionals.

Assessing model fit is not straightforward for our model since no standard diagnostics are readily available. Instead, we measure goodness of fit by examining observed and predicted marginal distributions of matches, not sets, won. Hence it is necessary to convert the probability of winning a set into the probability of winning a match. The probability of a player winning a match is the sum 
                           
                              Pr
                              (
                              3
                              -
                              0
                              )
                              +
                              Pr
                              (
                              3
                              -
                              1
                              )
                              +
                              Pr
                              (
                              3
                              -
                              2
                              )
                           
                         where each term can be evaluated using the binomial distribution to give
                           
                              (4)
                              
                                 Pr
                                 (
                                 win match
                                 )
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 10
                                 -
                                 15
                                 p
                                 +
                                 6
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 .
                              
                           
                        where p is the probability of the player winning a set.

We examined the proportion of matches won by the top 50 players (in terms of lifetime achievement, see below) over the 15-year period centred on their maximum predicted strength. The variance of the predicted proportion of matches won was found using the bootstrapped data. The chi-squared goodness-of-fit test statistic was 54.9 with 50 degrees of freedom. This shows that the agreement between observed and predicted marginal distributions of matches won is good. Fig. 1
                         shows the predicted proportions, with 95% confidence interval, and the observed proportions of matches won.

Our model can be used to estimate the strength of a player at any time during that player’s career. As for the Bradley–Terry model, the Thurstone–Mosteller model and Stern’s gamma comparison model, the parameters of our dynamic model can be used to estimate the probability of one player beating another player. One might then consider the player with the largest maximum estimated strength as the strongest, and hence best player of all time. The first three columns of Table 3
                         gives the top 25 all-time greatest tennis players according to maximum strength. In addition to using our model to calculate a player’s one-off maximum strength, one can compute the maximum average strength over a period of any length, e.g. 5, 10years or total strength over the whole playing career. As such, we also present two alternatives measures by which to rank players: maximum 5-year average strength and total lifetime strength.

It is pleasing, in terms of the model, that the players listed in Table 3 read as a who’s who of tennis since 1968. Further, there is considerable overlap with the players featuring in Table 2. It appears then that Roger Federer is the greatest player of the Open Era according to all three measures of greatness. Bjorn Borg and Jimmy Connors are close behind. It is of course worth noting that there is a lack of a statistical significant difference in the strengths achieved by the top nine players. However, this does not invalidate the rankings, rather we can say that based on the data observed, the model estimates that Roger Federer attained the highest strength of any player.

We note here that using the model to generate rankings such as those presented in Table 3 has some potential problems, and one may need to be cautious if using this model elsewhere. For example, consider a player who played very few matches, but won the ones he did play, resulting in very large estimated strength but with similarly large standard errors. Declaring a player as the greatest ever, despite that player only playing a handful of tournaments is clearly unattractive and unintuitive from a fans perspective. A simple solution might be to say a player must play in a minimum number of tournaments to be listed in the final rankings table. This was not needed here, but may be needed if this model is applied in other situations. A second solution would be to considered weighting a player’s strength using the number of times they played. This ‘manifest strength’ highlights players who are observed performing well on a frequent basis, as opposed to a player who, for example, played in just one tournament and won it (easily).


                        Fig. 2
                         shows the estimated strength trajectories for the top five players in the Open Era. Fig. 2 shows how players’ careers tend to follow similar trajectories in the Open Era: a rise to a maximum strength then a slight decline before retirement. For the entire data set, the mean time from a player’s first Grand Slam appearance to his peak strength is 6.7years (with a standard deviation of 3.3years). Further, the distribution of time to peak strength is very roughly normal and there is no correlation between time to peak and ranking (ranking as calculated under our model), i.e. better players do not reach their peak any sooner or later than more average players. Similarly, time from peak strength to a player’s last appearance in a Grand Slam is 7.2years (with a standard deviation of 5.9years). This distribution is somewhat skewed, but again there is no correlation between time to last appearance from peak strength.

One interesting note is the trajectory for Rod Laver. He was winning Grand Slam titles in the early 1960s. By the time 1968 arrives he was very much coming to the end of his career. Despite this, he achieves the fourth highest maximum strength. Perhaps if our data were to include results from before the Open Era, he may well climb the rankings further. As it is, Roger Federer tops the rankings.

Observing that players’ strengths tend to rise from their first appearance, reach a peak and then decline towards retirement is not unexpected, but what we have noticed is an additional feature of the very top players: they quite often seem to have a second peak in performance. We can only speculate as to why this is so: perhaps they have dips in form following having children only to return to the top of their game once they adjust to their new roles.

Tennis professionals in the Open Era have tended to specialise: each player’s style has been more suited to a particular surface. Rafael Nadal for example, has proven almost unbeatable at the French Open (clay surface) during the last 8years. Bjorn Borg was similar during his peak, whilst Pete Sampras was dominant on grass at Wimbledon, but failed to win a single French Open. It is interesting thus to look at the greatest players by surface. Table 4
                         presents the greatest players in the Open Era for clay, hard court and grass court. It is interesting to see how no one player dominates all three surfaces. Nadal and Federer are head and shoulders ahead of the rest on clay and grass respectively, whilst John McEnroe leads the rankings on hard courts. Perhaps some readers would be surprised to see Pete Sampras down in 7th position in the grass rankings list. We can only surmise but it is noticeable that very few of Sampras’ contemporaries are in any of the lists – he may have played in an era of particularly poor strength in depth.

A common use of a paired comparisons model is to estimate the probability of one competitor beating another. For the continuum of paired comparisons models used here, see (2), this may not seem as simple as it would be for using the Bradley–Terry model, for example. However, our final model is the 
                           
                              β
                              =
                              2
                           
                         model. From (2), we get that the probability of winning a set is
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 3
                                 -
                                 2
                                 r
                                 )
                              
                           
                        where 
                           
                              r
                              =
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                              /
                              (
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    α
                                 
                                 
                                    j
                                 
                              
                              )
                           
                        . The probability of winning a match can then easily be calculated using (4). Using these equations, we can calculate the probability of one player beating another. For example, if tennis fans were treated to a match between the two strongest players of all-time, at their peak strengths: Roger Federer in 2006 and Bjorn Borg in 1977 (see Table 3), then Federer 2006 would win the match with probability 57.2%.

@&#CONCLUSIONS@&#

In this paper we first present a closed form for the special case of Stern’s gamma comparison model for paired comparisons. Next we give a general method to allow the strength parameters of Stern’s gamma comparison model to vary over time. Our model assumes that the strengths vary deterministically rather than stochastically, and we describe why this may, in some circumstances, be more appropriate than allowing for stochastic evolution of strength parameters. To model the evolution of the strength parameters we adopt the technique of barycentric rational interpolation. Indeed, we believe we have pioneered the use of barycentric interpolation in statistical inference, demonstrating that it should routinely be used in preference to spline interpolation.

One might use this model for forecasting the results of head-to-head competitions, but we choose to demonstrate the application of our model on a large and rich dataset consisting of the results of tennis matches at Grand Slam tournaments starting in 1968. Fitting the model to this dataset enables us to attempt to answer the question: who is the greatest tennis player of the Open Era? We note here, that there are no doubt numerous other ways to produce rankings lists and that it is unlikely that any one rankings list would satisfy all aspects of the ‘all-time greatest’ debate, but the rankings presented here are intuitive and come from a well-defined mathematical model.

Finally, in answer to the question “who is the greatest?”, as measured over players entire careers, it appears that in the Open Era, since 1968, Roger Federer looks like the most likely candidate, with Bjorn Borg and Jimmy Connors close behind.

@&#REFERENCES@&#

